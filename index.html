<!-- 

///////////////////////////////////////////////
/////Code được viết bởi Chauhuynh0104/////////
////http://fb.com/chauhuynh0104//////////////
/////////////079.567.9350///////////////////
///Vui lòng tôn trọng bản quyền tác giả////
/////////Không xoá dòng này //////////////
/////////////////////////////////////////

!-->
<!DOCTYPE html>
<html lang="vi">
<head><meta charset="UTF-8"><title>Thủ Thuật</title></head>
<body>
<script>
  const base64 = "PCEtLSANCi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8NCi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLw0KLy8vLy8vLy8vLy8vLy9Db2RlIMSRxrDhu6NjIHZp4bq/dCBi4bufaSBDaGF1aHV5bmgwMTA0Ly8vLy8vLy8vLy8vLy8vLw0KLy8vLy8vLy8vLy8vL2h0dHA6Ly9mYi5jb20vY2hhdWh1eW5oMDEwNC8vLy8vLy8vLy8vLy8vLy8vLy8vLw0KLy8vLy8vLy8vLy8vLy8vLy8vLy8vLzA3OS41NjcuOTM1MC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vDQovLy8vLy8vLy8vLy9WdWkgbMOybmcgdMO0biB0cuG7jW5nIGLhuqNuIHF1eeG7gW4gdMOhYyBnaeG6oy8vLy8vLy8vLy8vDQovLy8vLy8vLy8vLy8vLy8vLy9LaMO0bmcgeG/DoSBkw7JuZyBuw6B5IC8vLy8vLy8vLy8vLy8vLy8vLy8vLw0KLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vDQovLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLw0KIS0tPg0KPCFET0NUWVBFIGh0bWw+DQoNCjxodG1sIGxhbmc9InZpIj4NCjxoZWFkPg0KPGxpbmsgaHJlZj0iaHR0cHM6Ly9mb250cy5nb29nbGVhcGlzLmNvbS9jc3MyP2ZhbWlseT1JbnRlcjp3Z2h0QDQwMDs2MDA7NzAwJmFtcDtkaXNwbGF5PXN3YXAiIHJlbD0ic3R5bGVzaGVldCIvPg0KPGxpbmsgaHJlZj0iaHR0cHM6Ly9jZG5qcy5jbG91ZGZsYXJlLmNvbS9hamF4L2xpYnMvZm9udC1hd2Vzb21lLzYuNC4wL2Nzcy9hbGwubWluLmNzcyIgcmVsPSJzdHlsZXNoZWV0Ii8+DQo8bWV0YSBjaGFyc2V0PSJ1dGYtOCIvPg0KPG1ldGEgY29udGVudD0id2lkdGg9ZGV2aWNlLXdpZHRoLCBpbml0aWFsLXNjYWxlPTEuMCIgbmFtZT0idmlld3BvcnQiLz4NCjx0aXRsZT5LaeG7g20gVHJhIFRo4bunIFRodeG6rXQ8L3RpdGxlPg0KPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSJodHRwczovL2NoYXVodXluaDAxMDQuZ2l0aHViLmlvL2d5bS9naWFvZGllbi5jc3MiPg0KPCEtLSBFbWFpbEpTIFNESyAtLT4NCjxzY3JpcHQgc3JjPSJodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvbnBtL0BlbWFpbGpzL2Jyb3dzZXJANC9kaXN0L2VtYWlsLm1pbi5qcyI+PC9zY3JpcHQ+DQo8c2NyaXB0Pg0KICAoZnVuY3Rpb24oKXsNCiAgICBlbWFpbGpzLmluaXQoIi1ZRkZtSEpQOXpVSmFucXVLIik7IC8vIPCfkYggdGhheSBi4bqxbmcgUHVibGljIEtleSBj4bunYSBi4bqhbg0KICB9KSgpOw0KPC9zY3JpcHQ+DQo8c2NyaXB0Pg0KICAgIGFzeW5jIGZ1bmN0aW9uIGNoZWNrQWNjZXNzKCkgew0KICAgICAgICBjb25zdCBqc29uVXJsID0gJ2h0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9jaGF1aHV5bmgwMTA0L2NoYXVodXluaDAxMDQudHh0L3JlZnMvaGVhZHMvbWFpbi9kcmNoYXUuanNvbic7DQogICAgICAgIHRyeSB7DQogICAgICAgICAgICBjb25zdCByZXMgPSBhd2FpdCBmZXRjaChqc29uVXJsKTsNCiAgICAgICAgICAgIGlmICghcmVzLm9rKSB0aHJvdyBuZXcgRXJyb3IoJ0tow7RuZyB0aOG7gyB04bqjaSBmaWxlIEpTT04nKTsNCiAgICAgICAgICAgIGNvbnN0IGNvbmZpZyA9IGF3YWl0IHJlcy5qc29uKCk7DQoNCiAgICAgICAgICAgIGlmICghY29uZmlnLkFDQ0VTU19BTExPV0VEKSB7DQogICAgICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5pbm5lckhUTUwgPSBgPGRpdiBzdHlsZT0icGFkZGluZzo1MHB4O3RleHQtYWxpZ246Y2VudGVyO2NvbG9yOnJlZDtmb250LXNpemU6MjBweCI+DQogICAgICAgICAgICAgICAgICAgIDxoMj5C4bqiTyBUUsOMIEjhu4YgVEjhu5BORzwvaDI+DQogICAgICAgICAgICAgICAgICAgIDxwPiR7Y29uZmlnLk1FU1NBR0V9PC9wPg0KICAgICAgICAgICAgICAgICAgICAke2NvbmZpZy5SRURJUkVDVF9VUkwgPyBgPHA+U+G6vSBjaHV54buDbiBoxrDhu5tuZyBzYXUgPHNwYW4gaWQ9J2NvdW50ZG93bic+NTwvc3Bhbj4gZ2nDonkuLi48L3A+YCA6ICcnfQ0KICAgICAgICAgICAgICAgIDwvZGl2PmA7DQogICAgICAgICAgICAgICAgaWYgKGNvbmZpZy5SRURJUkVDVF9VUkwpIHsNCiAgICAgICAgICAgICAgICAgICAgbGV0IHNlY29uZHMgPSA1Ow0KICAgICAgICAgICAgICAgICAgICBjb25zdCB0aW1lciA9IHNldEludGVydmFsKCgpID0+IHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHNlY29uZHMtLTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjb3VudGRvd24nKS5pbm5lclRleHQgPSBzZWNvbmRzOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNlY29uZHMgPD0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwodGltZXIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gY29uZmlnLlJFRElSRUNUX1VSTDsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfSwgMTAwMCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICB9IGNhdGNoIChlcnIpIHsNCiAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuaW5uZXJIVE1MID0gYDxkaXYgc3R5bGU9J3BhZGRpbmc6NTBweDt0ZXh0LWFsaWduOmNlbnRlcjtjb2xvcjpyZWQnPg0KICAgICAgICAgICAgICAgIDxoMj5LSMOUTkcgVOG6okkgxJDGr+G7okMgQ+G6pFUgSMOMTkg8L2gyPjxwPkzhu5dpIHRydXkgY+G6rXAga2hpIGvhur90IG7hu5FpIG3huqFuZy48YnIvPiBWdWkgbMOybmcga2nhu4NtIHRyYSBs4bqhaSDEkcaw4budbmcgdHJ1eeG7gW4gaW50ZXJuZXQuPC9wPg0KICAgICAgICAgICAgPC9kaXY+YDsNCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIGFzeW5jIGZ1bmN0aW9uIGxvYWRBY2NvdW50c0Zyb21UWFQoKSB7DQogICAgICAgIGNvbnN0IHR4dFVybCA9ICdodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vY2hhdWh1eW5oMDEwNC9jaGF1aHV5bmgwMTA0LnR4dC9yZWZzL2hlYWRzL21haW4vdGtrLnR4dCc7DQogICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IGZldGNoKHR4dFVybCk7DQogICAgICAgIGNvbnN0IHRleHQgPSBhd2FpdCByZXMudGV4dCgpOw0KICAgICAgICBjb25zdCBhY2NvdW50cyA9IHt9Ow0KICAgICAgICB0ZXh0LnNwbGl0KCdcbicpLmZvckVhY2gobGluZSA9PiB7DQogICAgICAgICAgICBjb25zdCBbdSwgcF0gPSBsaW5lLnRyaW0oKS5zcGxpdCgnOicpOw0KICAgICAgICAgICAgaWYgKHUgJiYgcCkgYWNjb3VudHNbdV0gPSBwOw0KICAgICAgICB9KTsNCiAgICAgICAgcmV0dXJuIGFjY291bnRzOw0KICAgIH0NCg0KICAgIGFzeW5jIGZ1bmN0aW9uIGVuYWJsZUxvZ2luKGFjY291bnRzKSB7DQogICAgICAgIGNvbnN0IGJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2dpbkJ0bicpOw0KICAgICAgICBjb25zdCB1c2VySW5wdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndXNlcm5hbWVJbnB1dCcpOw0KICAgICAgICBjb25zdCBwYXNzSW5wdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGFzc3dvcmRJbnB1dCcpOw0KICAgICAgICBjb25zdCBlcnJvckRpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2dpbkVycm9yJyk7DQoNCiAgICAgICAgYnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gew0KICAgICAgICAgICAgY29uc3QgdXNlciA9IHVzZXJJbnB1dC52YWx1ZS50cmltKCk7DQogICAgICAgICAgICBjb25zdCBwYXNzID0gcGFzc0lucHV0LnZhbHVlLnRyaW0oKTsNCiAgICAgICAgICAgIGlmIChhY2NvdW50c1t1c2VyXSAmJiBhY2NvdW50c1t1c2VyXSA9PT0gcGFzcykgew0KICAgICAgICAgICAgICAgIHNlc3Npb25TdG9yYWdlLnNldEl0ZW0oJ21lZFVzZXInLCB1c2VyKTsNCiAgICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC5yZW1vdmUoJ2xvZ2luLXBhZ2UnKTsNCiAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9naW5TZWN0aW9uJykuc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCiAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFpbkNvbnRlbnQnKS5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsNCiAgICAgICAgICAgICAgICBlcnJvckRpdi5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICBlcnJvckRpdi5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSk7DQogICAgfQ0KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKCkgew0KICAvLyBHw6FuIHPhu7Ega2nhu4duIGNobyBkcm9wZG93biBs4buNYyBtw6F5DQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hY2hpbmVPcGVyYXRvclNlbGVjdCcpLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIGZpbHRlck1hY2hpbmVFcnJvcnNCeU9wZXJhdG9yKTsNCiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFjaGluZUNvbmZsaWN0T3BlcmF0b3JTZWxlY3QnKS5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBmaWx0ZXJNYWNoaW5lQ29uZmxpY3RzQnlPcGVyYXRvcik7DQoJIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtaXNzaW5nTWFjaGluZU9wZXJhdG9yU2VsZWN0JykuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgZmlsdGVyTWlzc2luZ01hY2hpbmVCeU9wZXJhdG9yKTsNCg0KZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Nob3dNb3JlU3VnZ2VzdGlvbnNDaGVja2JveCcpLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIGZ1bmN0aW9uKCkgew0KICAgIGlmIChhbGxQcm9jZWR1cmVzLmxlbmd0aCA+IDApIHsNCiAgICAgICAgZ2VuZXJhdGVUaW1lU3VnZ2VzdGlvbnMoYWxsUHJvY2VkdXJlcyk7DQogICAgICAgIGZpbHRlckJ5T3BlcmF0b3IoKTsNCiAgICB9DQp9KTsNCn0pOw0KDQogd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBhc3luYyAoKSA9PiB7DQogIGNvbnN0IGFsbG93ID0gYXdhaXQgY2hlY2tBY2Nlc3MoKTsNCiAgaWYgKCFhbGxvdykgcmV0dXJuOw0KICAvLyBDaOG7iSBraeG7g20gdHJhIMSRxINuZyBuaOG6rXAgxJHDoyBsxrB1OyBLSMOUTkcgdOG6o2kgcnVsZS9wcm9jZWR1cmVzIOG7nyDEkcOieQ0KICBjaGVja1NhdmVkTG9naW4oKTsNCn0pOw0KDQo8L3NjcmlwdD4NCg0KDQoNCg0KPC9oZWFkPg0KPGJvZHk+DQoNCjwhLS0gVEhFTUUgUElDS0VSIC0tPg0KPGRpdiBpZD0idGhlbWVQaWNrZXIiIGNsYXNzPSJ0aGVtZS1waWNrZXIiIHRpdGxlPSJDaOG7jW4gbcOgdSBjaOG7pyDEkeG7gSBnaWFvIGRp4buHbiI+DQogDQogDQogIDxidXR0b24gdHlwZT0iYnV0dG9uIiBjbGFzcz0idGhlbWUtc3dhdGNoIiBkYXRhLXRoZW1lPSJkZWZhdWx0IiBzdHlsZT0iLS1zd2F0Y2g6IzM0OThkYiIgYXJpYS1sYWJlbD0iTeG6t2MgxJHhu4tuaCAoWGFuaCBkxrDGoW5nKSI+PC9idXR0b24+DQogIDxidXR0b24gdHlwZT0iYnV0dG9uIiBjbGFzcz0idGhlbWUtc3dhdGNoIiBkYXRhLXRoZW1lPSJvcmFuZ2UiICBzdHlsZT0iLS1zd2F0Y2g6I0ZGNjYwMCIgYXJpYS1sYWJlbD0iTcOgdSBjYW0iPjwvYnV0dG9uPg0KICA8YnV0dG9uIHR5cGU9ImJ1dHRvbiIgY2xhc3M9InRoZW1lLXN3YXRjaCIgZGF0YS10aGVtZT0icmVkIiAgICAgc3R5bGU9Ii0tc3dhdGNoOiNGRjAwMDAiIGFyaWEtbGFiZWw9Ik3DoHUgxJHhu48iPjwvYnV0dG9uPg0KICA8YnV0dG9uIHR5cGU9ImJ1dHRvbiIgY2xhc3M9InRoZW1lLXN3YXRjaCIgZGF0YS10aGVtZT0iZ3JlZW4iICAgc3R5bGU9Ii0tc3dhdGNoOiMwMEFBMDAiIGFyaWEtbGFiZWw9Ik3DoHUgeGFuaCBsw6EiPjwvYnV0dG9uPg0KICAgPGJ1dHRvbiB0eXBlPSJidXR0b24iIGlkPSJkYXJrVG9nZ2xlIiBjbGFzcz0idGhlbWUtZGFyay10b2dnbGUiIG9uY2xpY2s9InRvZ2dsZURhcmtNb2RlKCkiIGFyaWEtbGFiZWw9IkLhuq10L1Thuq90IGNo4bq/IMSR4buZIHThu5FpIj4NCiAgICA8c3BhbiBpZD0iZGFya0ljb24iPjxzbWFsbD7wn4yZPC9zbWFsbD48L3NwYW4+IDxzcGFuIGlkPSJkYXJrVGV4dCI+VOG7kWk8L3NwYW4+DQogIDwvYnV0dG9uPg0KICANCjwvZGl2Pg0KDQoNCg0KDQo8c2NyaXB0Pg0KICAgICAgZnVuY3Rpb24gdG9nZ2xlRGFya01vZGUoKSB7DQogICAgICAgIGNvbnN0IGJvZHkgPSBkb2N1bWVudC5ib2R5Ow0KICAgICAgICBjb25zdCBpY29uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImRhcmtJY29uIik7DQogICAgICAgIGNvbnN0IHRleHQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiZGFya1RleHQiKTsNCiAgICAgICAgYm9keS5jbGFzc0xpc3QudG9nZ2xlKCJkYXJrLW1vZGUiKTsNCiAgICAgICAgY29uc3QgaXNEYXJrID0gYm9keS5jbGFzc0xpc3QuY29udGFpbnMoImRhcmstbW9kZSIpOw0KICAgICAgICBpY29uLnRleHRDb250ZW50ID0gaXNEYXJrID8gIuKYgO+4jyIgOiAi8J+MmSI7DQogICAgICAgIHRleHQudGV4dENvbnRlbnQgPSBpc0RhcmsgPyAiU8OhbmciIDogIlThu5FpIjsNCiAgICAgIH0NCiAgICA8L3NjcmlwdD4NCjxzY3JpcHQ+DQpkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgKCkgPT4gew0KLy8gTOG6pXkgY8OhYyBwaOG6p24gdOG7rQ0KICAgICAgICAgICAgY29uc3QgdHJpZ2dlckJ1dHRvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0cmlnZ2VyQnV0dG9uJyk7DQogICAgICAgICAgICBjb25zdCBmaWxlSW5wdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZmlsZUlucHV0Jyk7DQoNCiAgICAgICAgICAgIC8vIEtp4buDbSB0cmEgeGVtIHBo4bqnbiB04butIGPDsyB04buTbiB04bqhaSBraMO0bmcNCiAgICAgICAgICAgIGlmICghdHJpZ2dlckJ1dHRvbiB8fCAhZmlsZUlucHV0KSB7DQogICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignTOG7l2k6IEtow7RuZyB0w6xtIHRo4bqleSB0cmlnZ2VyQnV0dG9uIGhv4bq3YyBmaWxlSW5wdXQnKTsNCiAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIC8vIFRow6ptIHPhu7Ega2nhu4duIGNsaWNrIGNobyBidXR0b24NCiAgICAgICAgICAgIHRyaWdnZXJCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7DQogICAgICAgICAgICAgICAgZmlsZUlucHV0LmNsaWNrKCk7IC8vIEvDrWNoIGhv4bqhdCBpbnB1dCBmaWxlDQogICAgICAgICAgICB9KTsNCg0KICAgICAgICB9KTsNCg0KPC9zY3JpcHQ+DQoNCg0KDQoNCg0KPCEtLSBQT1BVUCBNVUEgQuG6ok4gUVVZ4buATiAtLT4NCjxkaXYgaWQ9ImJ1eVBvcHVwIiBjbGFzcz0icG9wdXAtb3ZlcmxheSIgc3R5bGU9ImRpc3BsYXk6bm9uZTsiPg0KICA8ZGl2IGNsYXNzPSJwb3B1cC1jb250ZW50IGx1eHVyeSI+DQogICAgPGgyIGNsYXNzPSJwb3B1cC10aXRsZSI+QuG6ok5HIEdJw4EgQuG6ok4gUVVZ4buATjwvaDI+DQogICAgPGRpdiBjbGFzcz0icHJpY2luZy1ncmlkIj4NCiAgICAgIDxkaXYgY2xhc3M9InByaWNlLWNhcmQiPg0KICAgICAgICA8aDM+MSBUaMOhbmc8L2gzPg0KICAgICAgICA8cCBjbGFzcz0icHJpY2UiPjEuMDAwLjAwMCBWTsSQPC9wPg0KICAgICAgICA8YnV0dG9uIGNsYXNzPSJidXktYnRuIiBvbmNsaWNrPSJvcGVuUGF5bWVudCgnMSBUaMOhbmcnLCAnMS4wMDAuMDAwIFZOxJAnKSI+TXVhIG5nYXk8L2J1dHRvbj4NCiAgICAgIDwvZGl2Pg0KICAgICAgPGRpdiBjbGFzcz0icHJpY2UtY2FyZCI+DQogICAgICAgIDxoMz42IFRow6FuZzwvaDM+DQogICAgICAgIDxwIGNsYXNzPSJwcmljZSI+NS4wMDAuMDAwIFZOxJA8L3A+DQogICAgICAgIDxidXR0b24gY2xhc3M9ImJ1eS1idG4iIG9uY2xpY2s9Im9wZW5QYXltZW50KCc2IFRow6FuZycsICc1LjAwMC4wMDAgVk7EkCcpIj5NdWEgbmdheTwvYnV0dG9uPg0KICAgICAgPC9kaXY+DQogICAgICA8ZGl2IGNsYXNzPSJwcmljZS1jYXJkIj4NCiAgICAgICAgPGgzPjEgTsSDbTwvaDM+DQogICAgICAgIDxwIGNsYXNzPSJwcmljZSI+MTAuMDAwLjAwMCBWTsSQPC9wPg0KICAgICAgICA8YnV0dG9uIGNsYXNzPSJidXktYnRuIiBvbmNsaWNrPSJvcGVuUGF5bWVudCgnMSBOxINtJywgJzEwLjAwMC4wMDAgVk7EkCcpIj5NdWEgbmdheTwvYnV0dG9uPg0KICAgICAgPC9kaXY+DQogICAgICA8ZGl2IGNsYXNzPSJwcmljZS1jYXJkIj4NCiAgICAgICAgPGgzPjUgTsSDbTwvaDM+DQogICAgICAgIDxwIGNsYXNzPSJwcmljZSI+NDAuMDAwLjAwMCBWTsSQPC9wPg0KICAgICAgICA8YnV0dG9uIGNsYXNzPSJidXktYnRuIiBvbmNsaWNrPSJvcGVuUGF5bWVudCgnNSBOxINtJywgJzQwLjAwMC4wMDAgVk7EkCcpIj5NdWEgbmdheTwvYnV0dG9uPg0KICAgICAgPC9kaXY+DQogICAgPC9kaXY+DQogICAgPGJ1dHRvbiBjbGFzcz0iY2xvc2UtYnRuIiBvbmNsaWNrPSJjbG9zZUJ1eVBvcHVwKCkiPsSQw7NuZzwvYnV0dG9uPg0KICA8L2Rpdj4NCjwvZGl2Pg0KDQo8IS0tIFBPUFVQIFRIQU5IIFRPw4FOIC0tPg0KPGRpdiBpZD0icGF5bWVudFBvcHVwIiBjbGFzcz0icG9wdXAtb3ZlcmxheSIgc3R5bGU9ImRpc3BsYXk6bm9uZTsiPg0KICA8ZGl2IGNsYXNzPSJwb3B1cC1jb250ZW50IGZvcm0tcG9wdXAiPg0KICAgIDxoMj5Yw4FDIE5I4bqsTiBUSEFOSCBUT8OBTjwvaDI+PGJyLz4NCgk8bGFiZWw+PGZvbnQgY29sb3I9InJlZCI+PGI+VnVpIGzDsm5nIHRoYW5oIHRvw6FuIHRyxrDhu5tjIHbDoCDEkeG7o2kgYuG7mSBwaOG6rW4ga+G7uSB0aHXhuq10IGxpw6puIGjhu4c8L2I+PC9mb250PjwvbGFiZWw+PGJyLz48YnIvPg0KICAgIDxmb3JtIGlkPSJwYXltZW50Rm9ybSI+DQogICAgICA8bGFiZWw+U+G7kSB0w6BpIGtob+G6o24gdGjhu6UgaMaw4bufbmc6IDxiPjE3OTU2NzkzNTA8L2I+PC9sYWJlbD48YnIvPg0KCSAgIDxsYWJlbD5Uw6puIHTDoGkga2hv4bqjbjogPGI+SHXhu7NuaCBOZ+G7jWMgQ2jDonU8L2I+PC9sYWJlbD48YnIvPg0KICAgICAgPGxhYmVsPk5nw6JuIGjDoG5nOiA8Yj5WaWV0Y29tYmFuazwvYj48L2xhYmVsPjxici8+PGJyLz4NCiAgICAgIDxsYWJlbD5T4buRIHRp4buBbiBj4bqnbiB0aGFuaCB0b8Ohbjo8L2xhYmVsPg0KICAgICAgPGlucHV0IHR5cGU9InRleHQiIGlkPSJtb25leSIgcmVhZG9ubHk+PGJyLz4NCiAgICAgPGxhYmVsPlPhu5EgdMOgaSBraG/huqNuIG5nxrDhu51pIG11YTo8L2xhYmVsPg0KPGlucHV0IHR5cGU9InRleHQiIGlkPSJidXllckFjYyIgcmVxdWlyZWQ+PGJyLz4NCg0KPGxhYmVsPk5nw6JuIGjDoG5nIG5nxrDhu51pIG11YTo8L2xhYmVsPg0KPHNlbGVjdCBpZD0iYnV5ZXJCYW5rIiByZXF1aXJlZD4NCiAgPG9wdGlvbiB2YWx1ZT0iIj4tLSBDaOG7jW4gbmfDom4gaMOgbmcgLS08L29wdGlvbj4NCiAgPG9wdGlvbj5BZ3JpYmFuayAtIE5nw6JuIGjDoG5nIE7DtG5nIG5naGnhu4dwICYgUFROVCBWaeG7h3QgTmFtPC9vcHRpb24+DQogIDxvcHRpb24+VmlldGNvbWJhbmsgLSBOZ8OibiBow6BuZyBUTUNQIE5nb+G6oWkgdGjGsMahbmcgVmnhu4d0IE5hbTwvb3B0aW9uPg0KICA8b3B0aW9uPlZpZXRpbkJhbmsgLSBOZ8OibiBow6BuZyBUTUNQIEPDtG5nIFRoxrDGoW5nIFZp4buHdCBOYW08L29wdGlvbj4NCiAgPG9wdGlvbj5CSURWIC0gTmfDom4gaMOgbmcgVE1DUCDEkOG6p3UgdMawIHbDoCBQaMOhdCB0cmnhu4NuIFZp4buHdCBOYW08L29wdGlvbj4NCiAgPG9wdGlvbj5BQ0IgLSBOZ8OibiBow6BuZyDDgSBDaMOidTwvb3B0aW9uPg0KICA8b3B0aW9uPlNhY29tYmFuayAtIE5nw6JuIGjDoG5nIFRNQ1AgU8OgaSBHw7JuIFRoxrDGoW5nIFTDrW48L29wdGlvbj4NCiAgPG9wdGlvbj5UZWNoY29tYmFuayAtIE5nw6JuIGjDoG5nIFRNQ1AgS+G7uSB0aMawxqFuZyBWaeG7h3QgTmFtPC9vcHRpb24+DQogIDxvcHRpb24+TUJCYW5rIC0gTmfDom4gaMOgbmcgVE1DUCBRdcOibiDEkeG7mWk8L29wdGlvbj4NCiAgPG9wdGlvbj5UUEJhbmsgLSBOZ8OibiBow6BuZyBUTUNQIFRpw6puIFBob25nPC9vcHRpb24+DQogIDxvcHRpb24+VlBCYW5rIC0gTmfDom4gaMOgbmcgVE1DUCBWaeG7h3QgTmFtIFRo4buLbmggVsaw4bujbmc8L29wdGlvbj4NCiAgPG9wdGlvbj5IREJhbmsgLSBOZ8OibiBow6BuZyBUTUNQIFBow6F0IHRyaeG7g24gVFAgSOG7kyBDaMOtIE1pbmg8L29wdGlvbj4NCiAgPG9wdGlvbj5FeGltYmFuayAtIE5nw6JuIGjDoG5nIFRNQ1AgWHXhuqV0IE5o4bqtcCBraOG6qXUgVmnhu4d0IE5hbTwvb3B0aW9uPg0KICA8b3B0aW9uPlNIQiAtIE5nw6JuIGjDoG5nIFRNQ1AgU8OgaSBHw7JuIC0gSMOgIE7hu5lpPC9vcHRpb24+DQogIDxvcHRpb24+U2VBQmFuayAtIE5nw6JuIGjDoG5nIFRNQ1AgxJDDtG5nIE5hbSDDgTwvb3B0aW9uPg0KICA8b3B0aW9uPlNDQiAtIE5nw6JuIGjDoG5nIFRNQ1AgU8OgaSBHw7JuPC9vcHRpb24+DQogIDxvcHRpb24+T0NCIC0gTmfDom4gaMOgbmcgVE1DUCBQaMawxqFuZyDEkMO0bmc8L29wdGlvbj4NCiAgPG9wdGlvbj5WSUIgLSBOZ8OibiBow6BuZyBUTUNQIFF14buRYyB04bq/IFZp4buHdCBOYW08L29wdGlvbj4NCiAgPG9wdGlvbj5QVmNvbUJhbmsgLSBOZ8OibiBow6BuZyBUTUNQIMSQ4bqhaSBDaMO6bmcgVmnhu4d0IE5hbTwvb3B0aW9uPg0KICA8b3B0aW9uPk5hbUFCYW5rIC0gTmfDom4gaMOgbmcgVE1DUCBOYW0gw4E8L29wdGlvbj4NCiAgPG9wdGlvbj5PY2VhbkJhbmsgLSBOZ8OibiBow6BuZyBUTSBUTkhIIE1UViDEkOG6oWkgRMawxqFuZzwvb3B0aW9uPg0KICA8b3B0aW9uPkJhY0FCYW5rIC0gTmfDom4gaMOgbmcgVE1DUCBC4bqvYyDDgTwvb3B0aW9uPg0KICA8b3B0aW9uPkFCQkFOSyAtIE5nw6JuIGjDoG5nIFRNQ1AgQW4gQsOsbmg8L29wdGlvbj4NCiAgPG9wdGlvbj5C4bqjbyBWaeG7h3QgQmFuayAtIE5nw6JuIGjDoG5nIFRNQ1AgQuG6o28gVmnhu4d0PC9vcHRpb24+DQogIDxvcHRpb24+S2nDqm4gTG9uZyBCYW5rIC0gTmfDom4gaMOgbmcgVE1DUCBLacOqbiBMb25nPC9vcHRpb24+DQogIDxvcHRpb24+VmlldENhcGl0YWxCYW5rIC0gTmfDom4gaMOgbmcgVE1DUCBC4bqjbiBWaeG7h3Q8L29wdGlvbj4NCiAgPG9wdGlvbj5OQ0IgLSBOZ8OibiBow6BuZyBUTUNQIFF14buRYyBEw6JuPC9vcHRpb24+DQogIDxvcHRpb24+TFBCYW5rIC0gTmfDom4gaMOgbmcgVE1DUCBCxrB1IMSRaeG7h24gTGnDqm4gVmnhu4d0PC9vcHRpb24+DQogIDxvcHRpb24+UEcgQmFuayAtIE5nw6JuIGjDoG5nIFRNQ1AgWMSDbmcgZOG6p3UgUGV0cm9saW1leDwvb3B0aW9uPg0KICA8b3B0aW9uPlZpZXRCYW5rIC0gTmfDom4gaMOgbmcgVE1DUCBWaeG7h3QgTmFtIFRoxrDGoW5nIFTDrW48L29wdGlvbj4NCiAgPG9wdGlvbj5TYWlnb25CYW5rIC0gTmfDom4gaMOgbmcgVE1DUCBTw6BpIEfDsm4gQ8O0bmcgVGjGsMahbmc8L29wdGlvbj4NCiAgPG9wdGlvbj5DTy1PUCBCYW5rIC0gTmfDom4gaMOgbmcgSOG7o3AgdMOhYyB4w6MgVmnhu4d0IE5hbTwvb3B0aW9uPg0KICA8b3B0aW9uPlB1YmxpYyBCYW5rIFZpZXRuYW08L29wdGlvbj4NCiAgPG9wdGlvbj5TaGluaGFuIEJhbmsgVmlldG5hbTwvb3B0aW9uPg0KICA8b3B0aW9uPldvb3JpIEJhbmsgVmlldG5hbTwvb3B0aW9uPg0KICA8b3B0aW9uPlVPQiBWaWV0bmFtPC9vcHRpb24+DQogIDxvcHRpb24+U3RhbmRhcmQgQ2hhcnRlcmVkIEJhbmsgVmlldG5hbTwvb3B0aW9uPg0KICA8b3B0aW9uPkhvbmcgTGVvbmcgQmFuayBWaWV0bmFtPC9vcHRpb24+DQogIDxvcHRpb24+SFNCQyBWaWV0bmFtPC9vcHRpb24+DQogIDxvcHRpb24+Q0lNQiBCYW5rIFZpZXRuYW08L29wdGlvbj4NCiAgPG9wdGlvbj5DaXRpYmFuayBWaWV0bmFtPC9vcHRpb24+DQogIDxvcHRpb24+QU5aIFZpZXRuYW08L29wdGlvbj4NCjwvc2VsZWN0Pjxici8+DQoNCjxsYWJlbD5Uw6puIHTDoGkga2hv4bqjbiBuZ8aw4budaSBtdWE6PC9sYWJlbD4NCjxpbnB1dCB0eXBlPSJ0ZXh0IiBpZD0iYnV5ZXJOYW1lIiByZXF1aXJlZD48YnIvPg0KICAgICAgPGxhYmVsPlTDqm4gYuG7h25oIHZp4buHbiAvIHBow7JuZyBraMOhbTo8L2xhYmVsPg0KICAgICAgPGlucHV0IHR5cGU9InRleHQiIGlkPSJob3NwaXRhbCIgcmVxdWlyZWQ+PGJyLz4NCiAgICAgIDxsYWJlbD5HbWFpbCBjw6EgbmjDom4gaG/hurdjIMSRxqFuIHbhu4s8L2xhYmVsPg0KICAgICAgPGlucHV0IHR5cGU9ImVtYWlsIiBpZD0iYnV5ZXJNYWlsIiByZXF1aXJlZD48YnIvPg0KICAgICAgPGxhYmVsPlPhu5EgxJFp4buHbiB0aG/huqFpOjwvbGFiZWw+DQogICAgICA8aW5wdXQgdHlwZT0idGV4dCIgaWQ9ImJ1eWVyUGhvbmUiIHJlcXVpcmVkPjxici8+PGJyLz4NCiAgICAgIDxidXR0b24gdHlwZT0ic3VibWl0IiBjbGFzcz0iYnV5LWJ0biI+R+G7rWk8L2J1dHRvbj4NCiAgICAgIDxidXR0b24gdHlwZT0iYnV0dG9uIiBjbGFzcz0iY2xvc2UtYnRuIiBvbmNsaWNrPSJjbG9zZVBheW1lbnQoKSI+SOG7p3k8L2J1dHRvbj4NCiAgICA8L2Zvcm0+DQogIDwvZGl2Pg0KPC9kaXY+DQoNCjwhLS0gUE9QVVAgWMOBQyBOSOG6rE4gR+G7rEkgLS0+DQo8ZGl2IGlkPSJjb25maXJtUG9wdXAiIGNsYXNzPSJwb3B1cC1vdmVybGF5IiBzdHlsZT0iZGlzcGxheTpub25lOyI+DQogIDxkaXYgY2xhc3M9InBvcHVwLWNvbnRlbnQgY29uZmlybS1wb3B1cCI+DQogICAgPGgzPuKchSDEkMOjIGfhu61pIHThu5tpIGLhu5kgcGjhuq1uIHRp4bq/cCBuaOG6rW4uPC9oMz4NCiAgICA8cD5WdWkgbMOybmcgxJHhu6NpIGvhur90IHF14bqjIHjDoWMgbmjhuq1uIHThu6sgYuG7mSBwaOG6rW4ga+G7uSB0aHXhuq10LjwvcD4NCiAgICA8YnV0dG9uIGNsYXNzPSJjbG9zZS1idG4iIG9uY2xpY2s9ImNsb3NlQ29uZmlybSgpIj7EkMOzbmc8L2J1dHRvbj4NCiAgPC9kaXY+DQo8L2Rpdj4NCjwvYm9keT4NCjxzdHlsZT4NCi5mb3JtLXBvcHVwIHsNCiAgbWF4LWhlaWdodDogODB2aDsgICAgICAgICAgIC8qIGNoaeG6v20gdOG7kWkgxJFhIDgwJSBjaGnhu4F1IGNhbyBtw6BuIGjDrG5oICovDQogIG92ZXJmbG93LXk6IGF1dG87ICAgICAgICAgICAvKiBu4bq/dSBu4buZaSBkdW5nIGTDoGkgdGjDrCBjdeG7mW4gKi8NCiAgcGFkZGluZy1yaWdodDogMTVweDsgICAgICAgIC8qIHRyw6FuaCBj4bqvdCBjaOG7ryBraGkgY3Xhu5luICovDQogIHNjcm9sbGJhci13aWR0aDogdGhpbjsgICAgICAvKiB0aGFuaCBjdeG7mW4gbeG6o25oICovDQogIHNjcm9sbGJhci1jb2xvcjogZ29sZCB0cmFuc3BhcmVudDsNCn0NCg0KLyogbMOgbSDEkeG6uXAgdGhhbmggY3Xhu5luIHRyw6puIENocm9tZSwgRWRnZSwgU2FmYXJpICovDQouZm9ybS1wb3B1cDo6LXdlYmtpdC1zY3JvbGxiYXIgew0KICB3aWR0aDogNnB4Ow0KfQ0KLmZvcm0tcG9wdXA6Oi13ZWJraXQtc2Nyb2xsYmFyLXRodW1iIHsNCiAgYmFja2dyb3VuZC1jb2xvcjogZ29sZDsNCiAgYm9yZGVyLXJhZGl1czogNHB4Ow0KfQ0KLmZvcm0tcG9wdXA6Oi13ZWJraXQtc2Nyb2xsYmFyLXRyYWNrIHsNCiAgYmFja2dyb3VuZDogdHJhbnNwYXJlbnQ7DQp9DQoucG9wdXAtb3ZlcmxheSB7DQogIHBvc2l0aW9uOiBmaXhlZDsNCiAgaW5zZXQ6IDA7DQogIGJhY2tncm91bmQ6IHJnYmEoMCwwLDAsMC42KTsNCiAgZGlzcGxheTogZmxleDsNCiAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7DQogIHotaW5kZXg6IDk5OTk7DQogIGFuaW1hdGlvbjogZmFkZUluIDAuM3MgZWFzZTsNCn0NCg0KLnBvcHVwLWNvbnRlbnQgew0KICBiYWNrZ3JvdW5kOiAjZmZmOw0KICBib3JkZXItcmFkaXVzOiAyMHB4Ow0KICBwYWRkaW5nOiAzMHB4Ow0KICB0ZXh0LWFsaWduOiBjZW50ZXI7DQogIGZvbnQtZmFtaWx5OiAnSW50ZXInLCBzYW5zLXNlcmlmOw0KICBib3gtc2hhZG93OiAwIDAgMjVweCByZ2JhKDAsMCwwLDAuMyk7DQogIGFuaW1hdGlvbjogem9vbUluIDAuM3MgZWFzZTsNCn0NCi5wb3B1cC1jb250ZW50IHsNCiAgbWF4LXdpZHRoOiA3MDBweDsNCiAgd2lkdGg6IDkwJTsNCiAgYm94LXNpemluZzogYm9yZGVyLWJveDsNCn0NCg0KLmx1eHVyeSB7DQogIGJhY2tncm91bmQ6IGxpbmVhci1ncmFkaWVudCgxNDVkZWcsICMxMTEsICMyMjIpOw0KICBjb2xvcjogI2ZmZjsNCiAgbWF4LXdpZHRoOiA4MDBweDsNCn0NCg0KLnBvcHVwLXRpdGxlIHsNCiAgZm9udC1zaXplOiAyNHB4Ow0KICBtYXJnaW4tYm90dG9tOiAyMHB4Ow0KICBjb2xvcjogZ29sZDsNCiAgdGV4dC1zaGFkb3c6IDAgMCAxMHB4IGdvbGQ7DQp9DQoNCi5wcmljaW5nLWdyaWQgew0KICBkaXNwbGF5OiBmbGV4Ow0KICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsNCiAgYWxpZ24taXRlbXM6IHN0cmV0Y2g7DQogIGdhcDogMjVweDsNCiAgZmxleC13cmFwOiB3cmFwOyAvKiDEkeG7gyByZXNwb25zaXZlIGtoaSBtw6BuIGjDrG5oIG5o4buPICovDQogIG1hcmdpbi10b3A6IDIwcHg7DQp9DQoNCi5wcmljZS1jYXJkIHsNCiAgZmxleDogMSAxIDE4MHB4Ow0KICBtYXgtd2lkdGg6IDIwMHB4Ow0KICBiYWNrZ3JvdW5kOiByZ2JhKDI1NSwyNTUsMjU1LDAuMDgpOw0KICBib3JkZXI6IDJweCBzb2xpZCBnb2xkOw0KICBib3JkZXItcmFkaXVzOiAxOHB4Ow0KICBwYWRkaW5nOiAyMHB4IDE1cHg7DQogIHRyYW5zaXRpb246IGFsbCAwLjNzIGVhc2U7DQogIHRleHQtYWxpZ246IGNlbnRlcjsNCn0NCg0KLnByaWNlLWNhcmQ6aG92ZXIgew0KICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoLTEwcHgpIHNjYWxlKDEuMDUpOw0KICBib3gtc2hhZG93OiAwIDAgMjVweCBnb2xkOw0KfQ0KDQoucHJpY2UtY2FyZCBoMyB7DQogIGZvbnQtc2l6ZTogMjBweDsNCiAgY29sb3I6ICNmZmY7DQogIG1hcmdpbi1ib3R0b206IDEwcHg7DQogIHRleHQtc2hhZG93OiAwIDAgNXB4IGdvbGQ7DQp9DQoNCi5wcmljZS1jYXJkIC5wcmljZSB7DQogIGZvbnQtc2l6ZTogMThweDsNCiAgY29sb3I6ICNmZmViM2I7DQogIGZvbnQtd2VpZ2h0OiBib2xkOw0KICBtYXJnaW4tYm90dG9tOiAxNXB4Ow0KfQ0KDQoNCi5wcmljZSB7DQogIGZvbnQtc2l6ZTogMjBweDsNCiAgY29sb3I6ICNmZmViM2I7DQp9DQoNCi5idXktYnRuIHsNCiAgYmFja2dyb3VuZDogbGluZWFyLWdyYWRpZW50KDkwZGVnLCBnb2xkLCAjZjM5YzEyKTsNCiAgY29sb3I6ICMwMDA7DQogIGJvcmRlcjogbm9uZTsNCiAgYm9yZGVyLXJhZGl1czogMTJweDsNCiAgcGFkZGluZzogMTBweCAyMHB4Ow0KICBjdXJzb3I6IHBvaW50ZXI7DQogIGZvbnQtd2VpZ2h0OiBib2xkOw0KICB0cmFuc2l0aW9uOiAwLjNzOw0KfQ0KDQouYnV5LWJ0bjpob3ZlciB7DQogIGJhY2tncm91bmQ6IGxpbmVhci1ncmFkaWVudCg5MGRlZywgI2ZmZDcwMCwgI2ZmYTUwMCk7DQp9DQoNCi5jbG9zZS1idG4gew0KICBtYXJnaW4tdG9wOiAyMHB4Ow0KICBiYWNrZ3JvdW5kOiAjZTc0YzNjOw0KICBjb2xvcjogI2ZmZjsNCiAgYm9yZGVyOiBub25lOw0KICBib3JkZXItcmFkaXVzOiAxMHB4Ow0KICBwYWRkaW5nOiAxMHB4IDIwcHg7DQogIGN1cnNvcjogcG9pbnRlcjsNCn0NCg0KQGtleWZyYW1lcyBmYWRlSW4gew0KICBmcm9tIHsgb3BhY2l0eTogMDsgfSB0byB7IG9wYWNpdHk6IDE7IH0NCn0NCg0KQGtleWZyYW1lcyB6b29tSW4gew0KICBmcm9tIHsgdHJhbnNmb3JtOiBzY2FsZSgwLjkpOyBvcGFjaXR5OiAwOyB9IHRvIHsgdHJhbnNmb3JtOiBzY2FsZSgxKTsgb3BhY2l0eTogMTsgfQ0KfQ0KDQouZm9ybS1wb3B1cCBpbnB1dCB7DQogIHdpZHRoOiA5MCU7DQogIG1hcmdpbjogNXB4IDA7DQogIHBhZGRpbmc6IDhweDsNCiAgYm9yZGVyOiAxcHggc29saWQgI2FhYTsNCiAgYm9yZGVyLXJhZGl1czogOHB4Ow0KfQ0KDQouY29uZmlybS1wb3B1cCB7DQogIGJhY2tncm91bmQ6IGxpbmVhci1ncmFkaWVudCgxNDVkZWcsICM0Q0FGNTAsICMyRTdEMzIpOw0KICBjb2xvcjogI2ZmZjsNCiAgcGFkZGluZzogMjVweCA0MHB4Ow0KICBib3JkZXItcmFkaXVzOiAyMHB4Ow0KfS5mb3JtLXBvcHVwIHNlbGVjdCB7DQogIHdpZHRoOiA5MCU7DQogIG1hcmdpbjogNXB4IDA7DQogIHBhZGRpbmc6IDhweDsNCiAgYm9yZGVyOiAxcHggc29saWQgI2FhYTsNCiAgYm9yZGVyLXJhZGl1czogOHB4Ow0KICBiYWNrZ3JvdW5kOiAjZmZmOw0KfQ0KPC9zdHlsZT48c2NyaXB0Pg0KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigiRE9NQ29udGVudExvYWRlZCIsICgpID0+IHsNCiAgY29uc3QgYnV5QnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImJ1eSIpOw0KICBpZiAoYnV5QnRuKSB7DQogICAgYnV5QnRuLmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIiwgKCkgPT4gew0KICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImJ1eVBvcHVwIikuc3R5bGUuZGlzcGxheSA9ICJmbGV4IjsNCiAgICB9KTsNCiAgfQ0KfSk7DQoNCmZ1bmN0aW9uIGNsb3NlQnV5UG9wdXAoKSB7DQogIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJidXlQb3B1cCIpLnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7DQp9DQoNCmZ1bmN0aW9uIG9wZW5QYXltZW50KHBlcmlvZCwgcHJpY2UpIHsNCiAgY2xvc2VCdXlQb3B1cCgpOw0KICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgicGF5bWVudFBvcHVwIikuc3R5bGUuZGlzcGxheSA9ICJmbGV4IjsNCiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIm1vbmV5IikudmFsdWUgPSBgJHtwcmljZX0gKCR7cGVyaW9kfSlgOw0KfQ0KDQpmdW5jdGlvbiBjbG9zZVBheW1lbnQoKSB7DQogIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJwYXltZW50UG9wdXAiKS5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOw0KfQ0KDQpkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgicGF5bWVudEZvcm0iKS5hZGRFdmVudExpc3RlbmVyKCJzdWJtaXQiLCBhc3luYyAoZSkgPT4gew0KICBlLnByZXZlbnREZWZhdWx0KCk7DQogIGNvbnN0IGZvcm1EYXRhID0gew0KICAgIGFjYzogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImJ1eWVyQWNjIikudmFsdWUsDQoJICBiYW5rOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiYnV5ZXJCYW5rIikudmFsdWUsDQogICAgbmFtZTogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImJ1eWVyTmFtZSIpLnZhbHVlLA0KICAgIGhvc3BpdGFsOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiaG9zcGl0YWwiKS52YWx1ZSwNCiAgICBtYWlsOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiYnV5ZXJNYWlsIikudmFsdWUsDQogICAgcGhvbmU6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJidXllclBob25lIikudmFsdWUsDQogICAgbW9uZXk6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJtb25leSIpLnZhbHVlDQogIH07DQoNCiAgdHJ5IHsNCmVtYWlsanMuc2VuZCgic2VydmljZV9wZ29ia3E3IiwgInRlbXBsYXRlX200dWU4NWMiLCBmb3JtRGF0YSkNCiAgLnRoZW4oZnVuY3Rpb24ocmVzcG9uc2UpIHsNCiAgICBjb25zb2xlLmxvZygiR+G7rWkgdGjDoG5oIGPDtG5nOiIsIHJlc3BvbnNlLnN0YXR1cywgcmVzcG9uc2UudGV4dCk7DQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInBheW1lbnRQb3B1cCIpLnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7DQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImNvbmZpcm1Qb3B1cCIpLnN0eWxlLmRpc3BsYXkgPSAiZmxleCI7DQogIH0sIGZ1bmN0aW9uKGVycm9yKSB7DQogICAgY29uc29sZS5lcnJvcigiTOG7l2kgRW1haWxKUzoiLCBlcnJvcik7DQogIH0pOw0KICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJwYXltZW50UG9wdXAiKS5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOw0KICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJjb25maXJtUG9wdXAiKS5zdHlsZS5kaXNwbGF5ID0gImZsZXgiOw0KICB9IGNhdGNoIHsNCiAgfQ0KfSk7DQoNCmZ1bmN0aW9uIGNsb3NlQ29uZmlybSgpIHsNCiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImNvbmZpcm1Qb3B1cCIpLnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7DQp9DQo8L3NjcmlwdD4NCg0KDQo8ZGl2IGNsYXNzPSJjb250YWluZXIiPg0KPGRpdiBjbGFzcz0ibG9naW4tc2VjdGlvbiIgaWQ9ImxvZ2luU2VjdGlvbiI+DQo8aDIgY2xhc3M9ImxvZ2luLXRpdGxlIj7EkMSCTkcgTkjhuqxQIEjhu4YgVEjhu5BORzwvaDI+DQo8aW5wdXQgY2xhc3M9ImxvZ2luLWlucHV0IiBpZD0idXNlcm5hbWVJbnB1dCIgcGxhY2Vob2xkZXI9IlTDqm4gxJHEg25nIG5o4bqtcCIgdHlwZT0idGV4dCIvPg0KPGlucHV0IGNsYXNzPSJsb2dpbi1pbnB1dCIgaWQ9InBhc3N3b3JkSW5wdXQiIHBsYWNlaG9sZGVyPSJN4bqtdCBraOG6qXUiIHR5cGU9InBhc3N3b3JkIi8+DQo8YnIvPjxidXR0b24gY2xhc3M9ImJ0biIgaWQ9ImxvZ2luQnRuIj7EkMSDbmcgbmjhuq1wPC9idXR0b24+DQo8ZGl2IGNsYXNzPSJsb2dpbi1lcnJvciIgaWQ9ImxvZ2luRXJyb3IiPlTDqm4gxJHEg25nIG5o4bqtcCBob+G6t2MgbeG6rXQga2jhuql1IGtow7RuZyDEkcO6bmc8L2Rpdj4NCjxici8+PGJyLz48aHIvPjxici8+PGJ1dHRvbiBjbGFzcz0iYnRuIiBpZD0iYnV5Ij5NdWEgVMOgaSBLaG/huqNuIC0gS8OtY2ggSG/huqF0IELhuqNuIFF1eeG7gW48L2J1dHRvbj4NCg0KPC9kaXY+DQo8ZGl2IGNsYXNzPSJtYWluLWNvbnRlbnQiIGlkPSJtYWluQ29udGVudCI+DQo8ZGl2IGNsYXNzPSJ0b3AtYnV0dG9uLWdyb3VwIj48YnV0dG9uIGNsYXNzPSJidG4iIGlkPSJidXkiPk11YSBC4bqjbiBRdXnhu4FuPC9idXR0b24+PGJ1dHRvbiBvbmNsaWNrPSJvcGVuUHJvY2VkdXJlU2NoZWR1bGVyKCkiY2xhc3M9ImJ0biI+VOG6oW8gZ2nhu50gdGjhu6cgdGh14bqtdDwvYnV0dG9uPg0KICA8YnV0dG9uIG9uY2xpY2s9Im9wZW5DdXN0b21pemVQYW5lbCgpIiBjbGFzcz0iYnRuIj5UdeG7syBiaeG6v248L2J1dHRvbj4NCg0KDQoNCjxidXR0b24gb25jbGljaz0ic2hvd0Ryb3Bib3hQYW5lbCgpIiBjbGFzcz0iYnRuIj5QYW5lbDwvYnV0dG9uPg0KDQogIDxidXR0b24gb25jbGljaz0id2luZG93LmxvY2F0aW9uLnJlbG9hZCgpOyIgY2xhc3M9ImJ0biI+WG/DoSBDYWNoZTwvYnV0dG9uPg0KICA8YnV0dG9uIGNsYXNzPSJidG4iaWQ9ImxvZ291dEJ0biI+xJDEg25nIHh14bqldDwvYnV0dG9uPg0KPC9kaXY+DQoNCg0KPGgxPiA8YSBocmVmPSJodHRwczovL2ZiLmNvbS9jaGF1aHV5bmgwMTA0IiBzdHlsZT0iYWxsOiB1bnNldDsgY3Vyc29yOiBwb2ludGVyOyIgdGFyZ2V0PSJfYmxhbmsiPktp4buDbSBUcmEgVGjhu6cgVGh14bqtdDwvYT48L2gxPg0KPGRpdiBjbGFzcz0ibGlzdDEiIHN0eWxlPSJkaXNwbGF5OiBmbGV4OyBhbGlnbi1pdGVtczogY2VudGVyOyBnYXA6IDhweDsiPg0KPGkgY2xhc3M9ImZhIGZhLWJ1bGxob3JuIj48L2k+DQo8Yj48Zm9udCBjb2xvcj0icmVkIj5UaMO0bmcgYsOhbzo8L2ZvbnQ+PC9iPg0KPGRpdiBjbGFzcz0ic2Nyb2xsaW5nLXRleHQiIHN0eWxlPSJmbGV4OiAxOyBvdmVyZmxvdzogaGlkZGVuOyI+DQo8ZGl2IGNsYXNzPSJzY3JvbGxpbmctY29udGVudCIgaWQ9Im5vaWR1bmciPg0KDQo8L2Rpdj4NCjwvZGl2Pg0KPC9kaXY+DQo8c2NyaXB0Pg0KDQoNCmZldGNoKCdodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vY2hhdWh1eW5oMDEwNC9jaGF1aHV5bmgwMTA0LnR4dC9yZWZzL2hlYWRzL21haW4vdGhvbmdiYW8udHh0JykNCiAgLnRoZW4ocmVzcG9uc2UgPT4gcmVzcG9uc2UudGV4dCgpKQ0KICAudGhlbihkYXRhID0+IHsNCiAgICBjb25zdCBlbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdub2lkdW5nJyk7DQogICAgZWwuaW5uZXJIVE1MID0gZGF0YTsNCg0KICAgIC8vIFTEg25nIMSR4buZIGTDoGkgbuG7mWkgZHVuZyDEkeG7gyDEkeG6o20gYuG6o28gY3Xhu5luDQogICAgZWwuc3R5bGUuZGlzcGxheSA9ICdpbmxpbmUtYmxvY2snOw0KICAgIGVsLnN0eWxlLm1pbldpZHRoID0gJzEwMCUnOw0KDQogICAgLy8gUmVzZXQgYW5pbWF0aW9uIHRvIGZvcmNlIHJlZmxvdw0KICAgIGVsLnN0eWxlLmFuaW1hdGlvbiA9ICdub25lJzsNCiAgICB2b2lkIGVsLm9mZnNldFdpZHRoOw0KICAgIGVsLnN0eWxlLmFuaW1hdGlvbiA9ICdzY3JvbGwtbGVmdCAxMHMgbGluZWFyIGluZmluaXRlJzsNCiAgfSkNCiAgLmNhdGNoKGVycm9yID0+IHsNCiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbm9pZHVuZycpLnRleHRDb250ZW50ID0gJ0tow7RuZyB0aOG7gyB04bqjaSBu4buZaSBkdW5nLic7DQogICAgY29uc29sZS5lcnJvcihlcnJvcik7DQogIH0pOw0KDQoNCjwvc2NyaXB0Pg0KPGRpdiBjbGFzcz0idXBsb2FkLXNlY3Rpb24iPjxkaXYgY2xhc3M9Im1haW5ibG9rIj4NCg0KPGlucHV0IGFjY2VwdD0iLnhsc3gsIC54bHMsIC5jc3YiIGlkPSJmaWxlSW5wdXQiIHN0eWxlPSJkaXNwbGF5Om5vbmUiIHR5cGU9ImZpbGUiLz4NCjxidXR0b24gY2xhc3M9ImJ0biIgaWQ9InRyaWdnZXJCdXR0b24iPjxpIGNsYXNzPSJmYXMgZmEtZmlsZS11cGxvYWQiPjwvaT4gQ2jhu41uIGZpbGUgdGjhu6cgY8O0bmc8L2J1dHRvbj4NCjxici8+PGJyLz4NCjxpbnB1dCBkaXJlY3Rvcnk9IiIgaWQ9ImZvbGRlcklucHV0IiBtdWx0aXBsZT0iIiBzdHlsZT0iZGlzcGxheTpub25lIiB0eXBlPSJmaWxlIiB3ZWJraXRkaXJlY3Rvcnk9IiIvPg0KPGJ1dHRvbiBjbGFzcz0iYnRuIiBpZD0iZm9sZGVyQnRuIj48aSBjbGFzcz0iZmFzIGZhLWZvbGRlci1vcGVuIj48L2k+IENo4buNbiB0aMawIG3hu6VjIChU4buxIMSR4buZbmcgdMOsbSBmaWxlKTwvYnV0dG9uPg0KPGRpdiBpZD0ic2NhblN0YXR1cyIgc3R5bGU9Im1hcmdpbi10b3A6MTBweDtjb2xvcjojMzQ5OGRiO2ZvbnQtd2VpZ2h0OmJvbGQiPjwvZGl2Pg0KDQoNCjxsYWJlbD4NCjxpbnB1dCBuYW1lPSJ0aW1lT3B0aW9uIiB0eXBlPSJyYWRpbyIgdmFsdWU9Ijc6MDAiLz4gDQogICAgICAgICAgICAgICAgICAgICAgICBH4bujaSDDvSB04burIDA3OjAwDQogICAgICAgICAgICAgICAgICAgIDwvbGFiZWw+DQo8bGFiZWw+DQo8aW5wdXQgY2hlY2tlZD0iIiBuYW1lPSJ0aW1lT3B0aW9uIiB0eXBlPSJyYWRpbyIgdmFsdWU9Ijc6MzAiLz4gDQogICAgICAgICAgICAgICAgICAgICAgICBH4bujaSDDvSB04burIDA3OjMwDQogICAgICAgICAgICAgICAgICAgIDwvbGFiZWw+DQo8YnIvPjxici8+DQoNCiAgPGxhYmVsIHN0eWxlPSJtYXJnaW4tcmlnaHQ6IDEwcHg7Ij4NCjxpbnB1dCBjaGVja2VkPSIxIiBpZD0iaWdub3JlQWRqYWNlbnRDaGVja2JveCIgdHlwZT0iY2hlY2tib3giLz4NCjxzcGFuIGNsYXNzPSJjaHUtdGhpY2giPkLhu48gcXVhIHRo4bunIHRodeG6rXQgbGnhu4FuIGvhu4E8c3BhbiBjbGFzcz0ibm9pLWR1bmciPlZEOiA4aDAwLThoMzAgeG9hIGLDs3AuIDA4aDMwLTA4aDUwIMSRaeG7h24gY2jDom0uIGxpw6puIHRp4bq/cCBtw6Aga28gY8OhY2ggMSBwaMO6dCA8L3NwYW4+PC9zcGFuPg0KPC9sYWJlbD4NCg0KICA8bGFiZWwgc3R5bGU9Im1hcmdpbi1yaWdodDogMTBweDsiPg0KPGlucHV0IGlkPSJzaG93TW9yZVN1Z2dlc3Rpb25zQ2hlY2tib3giIHR5cGU9ImNoZWNrYm94Ii8+IA0KICAgICAgICBIaeG7g24gdGjhu4sgNiBraHVuZyBnaeG7nSBn4bujaSDDvSAgICAgICAgIA0KICAgIDwvbGFiZWw+DQoNCjxsYWJlbCBzdHlsZT0ibWFyZ2luLXJpZ2h0OiAxMHB4OyI+DQo8aW5wdXQgaWQ9InNob3dEb2N0b3JDaGVja2JveCIgdHlwZT0iY2hlY2tib3giLz4gDQogICAgICAgIEhp4buDbiB0aOG7iyBCw6FjIHPEqSBjaOG7iSDEkeG7i25oDQogICAgPC9sYWJlbD48bGFiZWw+DQogIDxpbnB1dCBpZD0ic2hvd0hlcmJFcnJvckRheXNDaGVja2JveCIgdHlwZT0iY2hlY2tib3giY2hlY2tlZC8+DQogIENo4buJIGhp4buDbiB0aOG7iyBuZ8OgeSBz4bqvYyB0aHXhu5FjIGzhu5dpDQo8L2xhYmVsPg0KPGJyLz48YnIvPg0KPGJ1dHRvbiBjbGFzcz0iYnRuIiBpZD0iYW5hbHl6ZUJ0biI+S2nhu4NtIFRyYTwvYnV0dG9uPg0KDQoNCg0KDQoNCg0KDQoNCg0KPHNjcmlwdD4NCmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmaWxlSW5wdXQnKS5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBmdW5jdGlvbiAoKSB7DQogICAgY29uc3QgZmlsZSA9IHRoaXMuZmlsZXNbMF07DQogICAgaWYgKGZpbGUpIHsNCiAgICAgICAgY29uc3Qgc3RhdHVzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NjYW5TdGF0dXMnKTsNCiAgICAgICAgc3RhdHVzLmlubmVySFRNTCA9IGA8aSBjbGFzcz0iZmFzIGZhLWZpbGUiPjwvaT7EkMOjIGNo4buNbiBmaWxlOiA8Yj4ke2ZpbGUubmFtZX08L2I+YDsNCiAgICAgICAgc3RhdHVzLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOw0KICAgICAgICBzdGF0dXMuc3R5bGUuY29sb3IgPSAnIzJjM2U1MCc7DQogICAgfQ0KfSk7DQoNCjwvc2NyaXB0Pg0KPGRpdiBpZD0ic2NhblN0YXR1cyIgc3R5bGU9Im1hcmdpbi10b3A6MTBweDsgY29sb3I6IzJjM2U1MDsgZm9udC13ZWlnaHQ6Ym9sZDsgZGlzcGxheTogbm9uZTsiPjwvZGl2Pg0KPGJyLz4NCjxzcGFuIHN0eWxlPSJmb250LXNpemU6IDEycHg7Ij48aT5QaOG6p24gbeG7gW0gxJHDtGkga2hpIGPDsyB0aOG7gyBt4bqvYyBs4buXaS4gWGluIGjDo3kga2nhu4NtIHRyYSBjw6FjIHRow7RuZyB0aW4gcXVhbiB0cuG7jW5nLjwvaT48L3NwYW4+DQo8ZGl2IGlkPSJmaWxlUmVxdWlyZW1lbnRzIj48L2Rpdj4NCjwvZGl2PjwvZGl2Pg0KDQoNCjwhLS0gQuG6rlQgxJDhuqZVOiBC4bqiTkcgR0nhu5wgVFLhu5BORyBU4buqTkcgTkfGr+G7nEkgLS0+DQogIDxidXR0b24gaWQ9ImhlcmJUb2dnbGVCdG4iIGNsYXNzPSJidG4iIG9uY2xpY2s9InRvZ2dsZUhlcmJMaXN0KCkic3R5bGU9ImRpc3BsYXk6bm9uZSI+U+G6r2MgdGh14buRYyB0aGFuZzwvYnV0dG9uPg0KICA8YnV0dG9uIGNsYXNzPSJidG4iIG9uY2xpY2s9InRvZ2dsZUF2YWlsYWJpbGl0eSgpIiBzdHlsZT0iZGlzcGxheTpub25lIj5HaeG7nSB0cuG7kW5nPC9idXR0b24+DQo8YnV0dG9uIGNsYXNzPSJidG4iIGlkPSJlcnJvclN1bW1hcnlCdG4iIG9uY2xpY2s9Im9wZW5FcnJvclN1bW1hcnkoKSIgc3R5bGU9ImRpc3BsYXk6bm9uZSI+DQogIFTDs20gVOG6r3QgTOG7l2kNCjwvYnV0dG9uPg0KPGRpdiBpZD0iYXZhaWxhYmlsaXR5VGFibGUiIHN0eWxlPSJkaXNwbGF5OiBub25lOyBtYXJnaW4tYm90dG9tOiAyMHB4OyI+DQogPGRpdiBjbGFzcz0ibWFpbmJsb2siIHN0eWxlPSJtYXJnaW4tYm90dG9tOiAxMHB4OyBkaXNwbGF5Om5vbmU7IiBpZD0iYXZhaWxhYmlsaXR5RmlsdGVyQmxvY2siPg0KICA8bGFiZWwgZm9yPSJmaWx0ZXJPcGVyYXRvciI+TmfGsOG7nWkgdGjhu7FjIGhp4buHbjo8L2xhYmVsPg0KICA8c2VsZWN0IGlkPSJmaWx0ZXJPcGVyYXRvciIgY2xhc3M9ImxvZ2luLWlucHV0IiBzdHlsZT0id2lkdGg6YXV0bzttYXJnaW4tcmlnaHQ6MjBweDsiPjwvc2VsZWN0Pg0KDQogIDxsYWJlbCBmb3I9ImZpbHRlckRhdGUiPk5nw6B5OjwvbGFiZWw+DQogIDxzZWxlY3QgaWQ9ImZpbHRlckRhdGUiIGNsYXNzPSJsb2dpbi1pbnB1dCIgc3R5bGU9IndpZHRoOmF1dG87Ij48L3NlbGVjdD4NCjwvZGl2Pg0KDQogIDx0YWJsZSBjbGFzcz0iZXJyb3ItdGFibGUgaGVyYi10YWJsZSI+DQogICAgPHRoZWFkPg0KICAgICAgPHRyPg0KICAgICAgICA8dGg+TmfGsOG7nWkgdGjhu7FjIGhp4buHbjwvdGg+DQogICAgICAgIDx0aD5OZ8OgeTwvdGg+DQogICAgICAgIA0KICAgICAgICA8dGg+S2h1bmcgZ2nhu50gdHLhu5FuZyBideG7lWkgc8Ohbmc8L3RoPg0KICAgICAgICA8dGg+S2h1bmcgZ2nhu50gdHLhu5FuZyBideG7lWkgY2hp4buBdTwvdGg+DQogICAgICA8L3RyPg0KICAgIDwvdGhlYWQ+DQogICAgPHRib2R5IGlkPSJhdmFpbGFiaWxpdHlCb2R5Ij48L3Rib2R5Pg0KICA8L3RhYmxlPg0KPC9kaXY+DQo8IS0tIEvhur5UIFRIw5pDOiBC4bqiTkcgR0nhu5wgVFLhu5BORyBU4buqTkcgTkfGr+G7nEkgLS0+DQoNCg0KDQoNCjwhLS0gTsOaVCBISeG7gk4gVEjhu4ogVEjhu6YgVEhV4bqsVCBT4bquQyBUSFXhu5BDIC0tPg0KDQoNCiAgDQo8IS0tIELhuqJORyBUSOG7piBUSFXhuqxUIFPhuq5DIFRIVeG7kEMgVEhBTkcgLS0+DQo8ZGl2IGlkPSJoZXJiUHJvY2VkdXJlVGFibGUiIHN0eWxlPSJkaXNwbGF5OiBub25lOyBtYXJnaW4tdG9wOiAyMHB4OyI+DQogIDxkaXYgY2xhc3M9Im1haW5ibG9rInN0eWxlPSJtYXJnaW4tYm90dG9tOiAxMHB4OyI+DQogICAgPGRpdj4NCiAgICA8c2VsZWN0IGlkPSJoZXJiRG9jdG9yRmlsdGVyIiBjbGFzcz0ibG9naW4taW5wdXQiIHN0eWxlPSJ3aWR0aDphdXRvOyBtYXJnaW4tbGVmdDogMjBweDsiPg0KICAgICAgPG9wdGlvbiB2YWx1ZT0iYWxsIj5U4bqldCBj4bqjIGLDoWMgc8SpPC9vcHRpb24+DQogICAgPC9zZWxlY3Q+DQogICAgPHNlbGVjdCBpZD0iaGVyYkRhdGVGaWx0ZXIiIGNsYXNzPSJsb2dpbi1pbnB1dCIgc3R5bGU9IndpZHRoOmF1dG87Ij48L3NlbGVjdD4NCiAgPC9kaXY+PC9kaXY+DQoNCjwhLS0gVMOTTSBU4bquVCBPVVRMSUVSIC0tPg0KPGRpdiBpZD0iaGVyYk91dGxpZXJTdW1tYXJ5IiBzdHlsZT0iZGlzcGxheTpub25lO21hcmdpbjo4cHggMjBweDtmb250LXNpemU6MTRweCI+DQogIDwhLS0gbuG7mWkgZHVuZyBz4bq9IMSRxrDhu6NjIEpTIGPhuq1wIG5o4bqtdCAtLT4NCjwvZGl2Pg0KICA8dGFibGUgY2xhc3M9ImVycm9yLXRhYmxlIj4NCiAgICA8dGhlYWQ+DQogICAgICA8dHI+DQogICAgICAgIDx0aD5I4buNIHTDqm4gYuG7h25oIG5ow6JuPC90aD4NCiAgICAgICAgPHRoPlRo4bunIHRodeG6rXQ8L3RoPg0KICAgICAgICA8dGg+TmfDoHk8L3RoPg0KICAgICAgICA8dGg+VGjhu51pIGdpYW48L3RoPg0KICAgICAgICA8dGg+TmfGsOG7nWkgdGjhu7FjIGhp4buHbjwvdGg+DQogICAgICA8L3RyPg0KICAgIDwvdGhlYWQ+DQogICAgPHRib2R5IGlkPSJoZXJiVGFibGVCb2R5Ij48L3Rib2R5Pg0KICA8L3RhYmxlPg0KPC9kaXY+DQoNCg0KPCEtLSBQT1BVUCBEQU5IIFPDgUNIIE9VVExJRVIgU+G6rkMgVEhV4buQQyBUSEFORyAtLT4NCjxkaXYgaWQ9ImhlcmJPdXRsaWVyTW9kYWwiIHN0eWxlPSJkaXNwbGF5Om5vbmU7cG9zaXRpb246Zml4ZWQ7aW5zZXQ6MDt6LWluZGV4OjExMDAwIj4NCiAgPGRpdiBpZD0iaGVyYk91dGxpZXJCYWNrZHJvcCIgc3R5bGU9InBvc2l0aW9uOmFic29sdXRlO2luc2V0OjA7YmFja2dyb3VuZDpyZ2JhKDAsMCwwLDAuNSkiPjwvZGl2Pg0KICA8ZGl2IHJvbGU9ImRpYWxvZyIgYXJpYS1tb2RhbD0idHJ1ZSINCiAgICAgICBzdHlsZT0icG9zaXRpb246YWJzb2x1dGU7dG9wOjEwJTtsZWZ0OjUwJTt0cmFuc2Zvcm06dHJhbnNsYXRlWCgtNTAlKTsNCiAgICAgICAgICAgICAgbWF4LXdpZHRoOjcwMHB4O21heC1oZWlnaHQ6ODB2aDtvdmVyZmxvdzphdXRvOw0KICAgICAgICAgICAgICBiYWNrZ3JvdW5kOiNmZmY7Y29sb3I6IzAwMDtwYWRkaW5nOjIwcHg7Ym9yZGVyLXJhZGl1czo4cHg7DQogICAgICAgICAgICAgIGJvcmRlcjoycHggc29saWQgI2QzMmYyZjtib3gtc2hhZG93OjAgNXB4IDIwcHggcmdiYSgwLDAsMCwwLjMpO2ZvbnQtZmFtaWx5OkludGVyLHNhbnMtc2VyaWYiPg0KICAgIDxoMz5EYW5oIHPDoWNoIGNhIGtow6FjIMSRYSBz4buRPC9oMz4NCiAgICA8ZGl2IHN0eWxlPSJtYXJnaW46MTBweCAwO2ZvbnQtc2l6ZToxM3B4IiBpZD0iaGVyYk91dGxpZXJNb2RhbEluZm8iPjwvZGl2Pg0KICAgIDx0YWJsZSBjbGFzcz0iZXJyb3ItdGFibGUiIHN0eWxlPSJtYXJnaW4tdG9wOjEwcHgiPg0KICAgICAgPHRoZWFkPg0KICAgICAgICA8dHI+DQogICAgICAgICAgPHRoPkjhu40gdMOqbiBi4buHbmggbmjDom48L3RoPg0KICAgICAgICAgIDx0aD5UaOG7pyB0aHXhuq10PC90aD4NCiAgICAgICAgICA8dGg+TmfDoHk8L3RoPg0KICAgICAgICAgIDx0aD5UaOG7nWkgZ2lhbjwvdGg+DQogICAgICAgICAgPHRoPk5nxrDhu51pIHRo4buxYyBoaeG7h248L3RoPg0KICAgICAgICA8L3RyPg0KICAgICAgPC90aGVhZD4NCiAgICAgIDx0Ym9keSBpZD0iaGVyYk91dGxpZXJNb2RhbEJvZHkiPjwvdGJvZHk+DQogICAgPC90YWJsZT4NCiAgICA8YnIvPg0KICAgIDxidXR0b24gY2xhc3M9ImJ0biIgdHlwZT0iYnV0dG9uIiBpZD0iaGVyYk91dGxpZXJDbG9zZUJ0biI+xJDDs25nPC9idXR0b24+DQogIDwvZGl2Pg0KPC9kaXY+DQoNCg0KDQoNCg0KDQo8YnIvPg0KPGJyLz4NCg0KDQo8ZGl2IGlkPSJlcnJvclNlY3Rpb24iIHN0eWxlPSJkaXNwbGF5OiBub25lOyI+DQo8YnIvPg0KPGgzIGlkPSJlcnJvclNlY3Rpb25UaXRsZSI+TOG7l2kgTmjhuq1wIFNhaSBUaOG7nWkgR2lhbjwvaDM+DQo8ZGl2IGlkPSJvcGVyYXRvckZpbHRlckVycm9yIiBzdHlsZT0ibWFyZ2luLXRvcDogMTVweDsgZGlzcGxheTogbm9uZTsiPg0KPGxhYmVsIGZvcj0ib3BlcmF0b3JTZWxlY3RFcnJvciI+TOG7jWMgdGhlbyBuZ8aw4budaSB0aOG7sWMgaGnhu4duOjwvbGFiZWw+DQo8c2VsZWN0IGNsYXNzPSJsb2dpbi1pbnB1dCIgaWQ9Im9wZXJhdG9yU2VsZWN0RXJyb3IiPg0KPG9wdGlvbiB2YWx1ZT0iYWxsIj5U4bqldCBj4bqjPC9vcHRpb24+DQo8L3NlbGVjdD4NCjwvZGl2Pg0KPGRpdiBpZD0iZXJyb3JMb2ciPjwvZGl2Pg0KPC9kaXY+DQo8YnIvPg0KDQo8ZGl2IGlkPSJyZXN1bHRTZWN0aW9uIiBzdHlsZT0iZGlzcGxheTogbm9uZTsiPg0KPGgzIGlkPSJyZXN1bHRTZWN0aW9uVGl0bGUiPlRyw7luZyBHaeG7nTwvaDM+IA0KDQo8ZGl2IGlkPSJvcGVyYXRvckZpbHRlciIgc3R5bGU9Im1hcmdpbi10b3A6IDE1cHg7IGRpc3BsYXk6IG5vbmU7Ij4NCjxsYWJlbCBmb3I9Im9wZXJhdG9yU2VsZWN0Ij5M4buNYyB0aGVvIG5nxrDhu51pIHRo4buxYyBoaeG7h246PC9sYWJlbD4NCjxzZWxlY3QgY2xhc3M9ImxvZ2luLWlucHV0IiBpZD0ib3BlcmF0b3JTZWxlY3QiPg0KPG9wdGlvbiB2YWx1ZT0iYWxsIj5U4bqldCBj4bqjPC9vcHRpb24+DQo8L3NlbGVjdD4NCjwvZGl2Pjxici8+DQoNCjx0YWJsZSBpZD0icmVzdWx0VGFibGUiPg0KPHRoZWFkPg0KPHRyPg0KPHRoPjxpIGNsYXNzPSJmYXMgZmEtdXNlciBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gVMOqbiBCTjwvdGg+DQo8dGg+PGkgY2xhc3M9ImZhcyBmYS1wcm9jZWR1cmVzIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBUaOG7pyB0aHXhuq10PC90aD4NCjx0aD48aSBjbGFzcz0iZmFyIGZhLWNhbGVuZGFyLWFsdCBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gTmfDoHk8L3RoPg0KPHRoIGNsYXNzPSJkb2N0b3ItY29sdW1uIj48aSBjbGFzcz0iZmFzIGZhLXVzZXItbWQgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IELDoWMgc+G7uSBjaOG7iSDEkeG7i25oPC90aD4NCjx0aD48aSBjbGFzcz0iZmFzIGZhLXVzZXItbnVyc2UgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IE5nxrDhu51pIHRo4buxYyBoaeG7h248L3RoPg0KPHRoPjxpIGNsYXNzPSJmYXIgZmEtY2xvY2sgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IEfhu6NpIMO9IGdp4budPC90aD4NCjwvdHI+DQo8L3RoZWFkPg0KPHRib2R5IGlkPSJyZXN1bHRCb2R5Ij48L3Rib2R5Pg0KPC90YWJsZT4NCg0KDQo8L2Rpdj4NCjwhLS0gQuG6ok5HIEfhuq5OIFNBSSBNw4FZIC0tPg0KPGRpdiBpZD0ibWFjaGluZUVycm9yU2VjdGlvbiIgc3R5bGU9ImRpc3BsYXk6IG5vbmU7Ij4NCiAgPGJyLz4NCiAgPGgzIGlkPSJtYWNoaW5lRXJyb3JTZWN0aW9uVGl0bGUiPkfhuq9uIFNhaSBNw6MgTcOheTwvaDM+DQogIDxkaXYgaWQ9Im1hY2hpbmVPcGVyYXRvckZpbHRlciIgc3R5bGU9Im1hcmdpbi10b3A6IDE1cHg7IGRpc3BsYXk6IG5vbmU7Ij4NCiAgICA8bGFiZWwgZm9yPSJtYWNoaW5lT3BlcmF0b3JTZWxlY3QiPkzhu41jIHRoZW8gbmfGsOG7nWkgdGjhu7FjIGhp4buHbjo8L2xhYmVsPg0KICAgIDxzZWxlY3QgY2xhc3M9ImxvZ2luLWlucHV0IiBpZD0ibWFjaGluZU9wZXJhdG9yU2VsZWN0Ij4NCiAgICAgIDxvcHRpb24gdmFsdWU9ImFsbCI+VOG6pXQgY+G6ozwvb3B0aW9uPg0KICAgIDwvc2VsZWN0Pg0KICA8L2Rpdj4NCiAgPGRpdiBpZD0ibWFjaGluZUVycm9yTG9nIj48L2Rpdj4NCjwvZGl2Pg0KPGJyLz4NCg0KPCEtLSBC4bqiTkcgWFVORyDEkOG7mFQgTcOBWSAtLT4NCjxkaXYgaWQ9Im1hY2hpbmVDb25mbGljdFNlY3Rpb24iIHN0eWxlPSJkaXNwbGF5OiBub25lOyI+DQogIDxici8+DQogIDxoMyBpZD0ibWFjaGluZUNvbmZsaWN0U2VjdGlvblRpdGxlIj5YdW5nIMSQ4buZdCBNw6F5PC9oMz4NCiAgPGRpdiBpZD0ibWFjaGluZUNvbmZsaWN0T3BlcmF0b3JGaWx0ZXIiIHN0eWxlPSJtYXJnaW4tdG9wOiAxNXB4OyBkaXNwbGF5OiBub25lOyI+DQogICAgPGxhYmVsIGZvcj0ibWFjaGluZUNvbmZsaWN0T3BlcmF0b3JTZWxlY3QiPkzhu41jIHRoZW8gbmfGsOG7nWkgdGjhu7FjIGhp4buHbjo8L2xhYmVsPg0KICAgIDxzZWxlY3QgY2xhc3M9ImxvZ2luLWlucHV0IiBpZD0ibWFjaGluZUNvbmZsaWN0T3BlcmF0b3JTZWxlY3QiPg0KICAgICAgPG9wdGlvbiB2YWx1ZT0iYWxsIj5U4bqldCBj4bqjPC9vcHRpb24+DQogICAgPC9zZWxlY3Q+DQogIDwvZGl2Pg0KICA8ZGl2IGlkPSJtYWNoaW5lQ29uZmxpY3RMb2ciPjwvZGl2Pg0KPC9kaXY+DQo8YnIvPg0KPCEtLSBC4bqiTkcgUVXDik4gR+G6rk4gTcODIE3DgVkgLS0+DQo8ZGl2IGlkPSJtaXNzaW5nTWFjaGluZVNlY3Rpb24iIHN0eWxlPSJkaXNwbGF5OiBub25lOyI+DQogIDxici8+DQogIDxoMyBpZD0ibWlzc2luZ01hY2hpbmVTZWN0aW9uVGl0bGUiPlF1w6puIEfhuq9uIE3DoyBNw6F5PC9oMz4NCiAgPGRpdiBpZD0ibWlzc2luZ01hY2hpbmVPcGVyYXRvckZpbHRlciIgc3R5bGU9Im1hcmdpbi10b3A6IDE1cHg7IGRpc3BsYXk6IG5vbmU7Ij4NCiAgICA8bGFiZWwgZm9yPSJtaXNzaW5nTWFjaGluZU9wZXJhdG9yU2VsZWN0Ij5M4buNYyB0aGVvIG5nxrDhu51pIHRo4buxYyBoaeG7h246PC9sYWJlbD4NCiAgICA8c2VsZWN0IGNsYXNzPSJsb2dpbi1pbnB1dCIgaWQ9Im1pc3NpbmdNYWNoaW5lT3BlcmF0b3JTZWxlY3QiPg0KICAgICAgPG9wdGlvbiB2YWx1ZT0iYWxsIj5U4bqldCBj4bqjPC9vcHRpb24+DQogICAgPC9zZWxlY3Q+DQogIDwvZGl2Pg0KICA8ZGl2IGlkPSJtaXNzaW5nTWFjaGluZUxvZyI+PC9kaXY+DQo8L2Rpdj4NCjxici8+DQoNCjwvZGl2Pg0KPC9kaXY+DQo8c2NyaXB0Pg0KLy8gVOG6o2kgWExTWCBjaOG7iSBraGkgY+G6p24NCmFzeW5jIGZ1bmN0aW9uIGVuc3VyZVhMU1goKSB7DQogIGlmICghd2luZG93LlhMU1gpIHsNCiAgICBhd2FpdCBpbXBvcnQoJ2h0dHBzOi8vY2RuanMuY2xvdWRmbGFyZS5jb20vYWpheC9saWJzL3hsc3gvMC4xOC41L3hsc3guZnVsbC5taW4uanMnKTsNCiAgfQ0KfQ0KDQovLyBU4bqjaSBEcm9wYm94IFNESyBjaOG7iSBraGkgY+G6p24NCmFzeW5jIGZ1bmN0aW9uIGVuc3VyZURyb3Bib3goKSB7DQogIGlmICghd2luZG93LkRyb3Bib3gpIHsNCiAgICBhd2FpdCBpbXBvcnQoJ2h0dHBzOi8vdW5wa2cuY29tL2Ryb3Bib3gvZGlzdC9Ecm9wYm94LXNkay5taW4uanMnKTsNCiAgfQ0KfQ0KDQoNCiAgICAgICAgLy8gRGFuaCBzw6FjaCB0aOG7pyB0aHXhuq10DQogICAgICAgbGV0IFBST0NFRFVSRVMgPSB7fTsNCg0KYXN5bmMgZnVuY3Rpb24gbG9hZFByb2NlZHVyZXMoKSB7DQogICAgdHJ5IHsNCiAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgZmV0Y2goJ2h0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9jaGF1aHV5bmgwMTA0L2NoYXVodXluaDAxMDQudHh0L3JlZnMvaGVhZHMvbWFpbi9jaGF1X3RodXRodWF0LnR4dCcpOw0KICAgICAgICBjb25zdCB0ZXh0ID0gYXdhaXQgcmVzLnRleHQoKTsNCiAgICAgICAgUFJPQ0VEVVJFUyA9IEpTT04ucGFyc2UodGV4dCk7DQogICAgfSBjYXRjaCAoZXJyKSB7DQogICAgICAgIGFsZXJ0KCdLaMO0bmcgdGjhu4MgdOG6o2kgZGFuaCBzw6FjaCB0aOG7pyB0aHXhuq10OiAnICsgZXJyLm1lc3NhZ2UpOw0KICAgICAgICBjb25zb2xlLmVycm9yKGVycik7DQogICAgfQ0KfQ0KDQoJCQ0KDQogICAgICAgIC8vIEJp4bq/biB0b8OgbiBj4bulYw0KICAgICAgICBsZXQgZXJyb3JMb2cgPSBbXTsNCiAgICAgICAgbGV0IGN1cnJlbnRVc2VyID0gbnVsbDsNCiAgICAgICAgbGV0IGFsbFByb2NlZHVyZXMgPSBbXTsNCiAgICAgICAvLyBCaeG6v24gY2hvIGtp4buDbSB0cmEgbcOheQ0KICAgICAgICBsZXQgbWFjaGluZUVycm9yTG9nID0gW107DQogICAgICAgIGxldCBtYWNoaW5lQ29uZmxpY3RMb2cgPSBbXTsNCgkJbGV0IG1pc3NpbmdNYWNoaW5lTG9nID0gW107DQogICAgICAgIC8vID09PSBL4bq+VCBUSMOaQyBDT0RFIE3hu5pJID09PQ0KDQpjb25zdCBEUk9QQk9YX0NPTkZJRyA9IHsNCiAgICByZWZyZXNoVG9rZW46ICJjdGdCdmozSXN0Y0FBQUFBQUFBQUFWRkNzSVhJdXpfQ1RRcEltYWtjQzRjdVFWOER1bWtmZ0RXSXM4VkdQdkZUIiwNCiAgICBjbGllbnRJZDogInc4YXdqMnF4bzNhaXY1ZSIsDQogICAgY2xpZW50U2VjcmV0OiAicWtxbzF1N2F0czdibDlnIg0KfTsNCg0KYXN5bmMgZnVuY3Rpb24gZ2V0QWNjZXNzVG9rZW4oKSB7DQogICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCgiaHR0cHM6Ly9hcGkuZHJvcGJveGFwaS5jb20vb2F1dGgyL3Rva2VuIiwgew0KICAgICAgICBtZXRob2Q6ICJQT1NUIiwNCiAgICAgICAgaGVhZGVyczogew0KICAgICAgICAgICAgIkF1dGhvcml6YXRpb24iOiAiQmFzaWMgIiArIGJ0b2EoYCR7RFJPUEJPWF9DT05GSUcuY2xpZW50SWR9OiR7RFJPUEJPWF9DT05GSUcuY2xpZW50U2VjcmV0fWApLA0KICAgICAgICAgICAgIkNvbnRlbnQtVHlwZSI6ICJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQiDQogICAgICAgIH0sDQogICAgICAgIGJvZHk6IGBncmFudF90eXBlPXJlZnJlc2hfdG9rZW4mcmVmcmVzaF90b2tlbj0ke0RST1BCT1hfQ09ORklHLnJlZnJlc2hUb2tlbn1gDQogICAgfSk7DQogICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTsNCiAgICByZXR1cm4gZGF0YS5hY2Nlc3NfdG9rZW47DQp9DQovLyBU4bqjaSBYTFNYIGNo4buJIGtoaSBj4bqnbg0KYXN5bmMgZnVuY3Rpb24gZW5zdXJlWExTWCgpIHsNCiAgaWYgKCF3aW5kb3cuWExTWCkgew0KICAgIGF3YWl0IGltcG9ydCgnaHR0cHM6Ly9jZG5qcy5jbG91ZGZsYXJlLmNvbS9hamF4L2xpYnMveGxzeC8wLjE4LjUveGxzeC5mdWxsLm1pbi5qcycpOw0KICB9DQp9DQoNCi8vIFThuqNpIERyb3Bib3ggU0RLIGNo4buJIGtoaSBj4bqnbg0KYXN5bmMgZnVuY3Rpb24gZW5zdXJlRHJvcGJveCgpIHsNCiAgaWYgKCF3aW5kb3cuRHJvcGJveCkgew0KICAgIGF3YWl0IGltcG9ydCgnaHR0cHM6Ly91bnBrZy5jb20vZHJvcGJveC9kaXN0L0Ryb3Bib3gtc2RrLm1pbi5qcycpOw0KICB9DQp9DQphc3luYyBmdW5jdGlvbiB1cGxvYWRUb0Ryb3Bib3goZmlsZSwga2hvYVZhbHVlLCBuZ2F5VmFsdWUsIHN0YXRzID0geyBoZXJiOiAwLCB0aW1lOiAwLCBjb25mbGljdDogMCB9KSB7DQogY29uc3QgY3VycmVudFVzZXIgPSBzZXNzaW9uU3RvcmFnZS5nZXRJdGVtKCdtZWRVc2VyJyk7DQogIGlmIChjdXJyZW50VXNlciAmJiBjdXJyZW50VXNlci50b0xvd2VyQ2FzZSgpID09PSAnZG9jdG9yJykgew0KICAgIHJldHVybjsgDQogIH0NCiAgYXdhaXQgZW5zdXJlRHJvcGJveCgpOyAvLyDEkeG6o20gYuG6o28gY8OzIERyb3Bib3ggU0RLDQogICAgY29uc3QgYWNjZXNzVG9rZW4gPSBhd2FpdCBnZXRBY2Nlc3NUb2tlbigpOw0KICAgIGNvbnN0IGRieCA9IG5ldyBEcm9wYm94LkRyb3Bib3goeyBhY2Nlc3NUb2tlbiB9KTsNCg0KICAgIGNvbnN0IHBjTmFtZSA9IG5hdmlnYXRvci51c2VyQWdlbnQ7DQogICAgY29uc3Qgbm93ID0gbmV3IERhdGUoKS50b0xvY2FsZVN0cmluZygndmktVk4nKTsNCiAgICBjb25zdCBmaWxlbmFtZSA9IGAke2ZpbGUubmFtZS5yZXBsYWNlKC9cLlteLy5dKyQvLCAiIil9XyR7RGF0ZS5ub3coKX0ueGxzeGA7DQoNCiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGRieC5maWxlc1VwbG9hZCh7DQogICAgICAgIHBhdGg6IGAvdGh1dGh1YXQvJHtmaWxlbmFtZX1gLA0KICAgICAgICBjb250ZW50czogZmlsZSwNCiAgICAgICAgbW9kZTogJ2FkZCcsDQogICAgICAgIGF1dG9yZW5hbWU6IHRydWUNCiAgICB9KTsNCg0KICAgIC8vIEdoaSBtZXRhZGF0YSB2w6BvIGZpbGUgSlNPTiB0cnVuZyB0w6JtIChk4bqhbmcgdGV4dCBhcHBlbmQpDQogICAgY29uc3QgbWV0YWRhdGEgPSB7DQogICAgICAgIHN0dDogRGF0ZS5ub3coKSwNCiAgICBraG9hOiBraG9hVmFsdWUsICAgICAgICAvLyDinIUgxJHDum5nIGJp4bq/bg0KICAgIG5nYXk6IG5nYXlWYWx1ZSwgICAgLy8g4pyFIMSRw7puZyBiaeG6v24NCiAgICAgICAgbGluazogImh0dHBzOi8vd3d3LmRyb3Bib3guY29tL2hvbWUvdGh1dGh1YXQ/cHJldmlldz0iICsgZW5jb2RlVVJJQ29tcG9uZW50KGZpbGVuYW1lKSwNCiAgICAgICAgcGM6IHBjTmFtZSwNCiAgICAgICAgdGltZTogbm93LA0KCQloZXJiX2Vycm9yczogTnVtYmVyKHN0YXRzLmhlcmIpIHx8IDAsDQogICAgdGltZV9lcnJvcnM6IE51bWJlcihzdGF0cy50aW1lKSB8fCAwLA0KICAgY29uZmxpY3RfZXJyb3JzOiBOdW1iZXIoc3RhdHMuY29uZmxpY3QpIHx8IDANCiAgICB9Ow0KDQogICAgYXdhaXQgYXBwZW5kRHJvcGJveExvZyhtZXRhZGF0YSk7DQp9DQoNCmFzeW5jIGZ1bmN0aW9uIGFwcGVuZERyb3Bib3hMb2cobG9nSXRlbSkgew0KICAgIGNvbnN0IGFjY2Vzc1Rva2VuID0gYXdhaXQgZ2V0QWNjZXNzVG9rZW4oKTsNCiAgICBjb25zdCBkYnggPSBuZXcgRHJvcGJveC5Ecm9wYm94KHsgYWNjZXNzVG9rZW4gfSk7DQoNCiAgICBjb25zdCBsb2dQYXRoID0gJy90aHV0aHVhdC9sb2cuanNvbic7DQogICAgbGV0IGxvZ3MgPSBbXTsNCg0KICAgIHRyeSB7DQogICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZGJ4LmZpbGVzRG93bmxvYWQoeyBwYXRoOiBsb2dQYXRoIH0pOw0KICAgICAgICBjb25zdCBibG9iID0gcmVzcG9uc2UucmVzdWx0LmZpbGVCbG9iOyAvLyDinIUgZMO5bmcgLnJlc3VsdC5maWxlQmxvYg0KICAgICAgICBjb25zdCB0ZXh0ID0gYXdhaXQgYmxvYi50ZXh0KCk7DQogICAgICAgIGxvZ3MgPSBKU09OLnBhcnNlKHRleHQpOw0KICAgIH0gY2F0Y2ggKGUpIHsNCiAgICAgICAgY29uc29sZS53YXJuKCJLaMO0bmcgdMOsbSB0aOG6pXkgbG9nLmpzb24gY8WpIGhv4bq3YyBs4buXaSDEkeG7jWM6IiwgZSk7DQogICAgICAgIGxvZ3MgPSBbXTsNCiAgICB9DQoNCiAgICAvLyBDaMOobiBt4bubaSBuaOG6pXQgbMOqbiDEkeG6p3UNCiAgICBsb2dzLnVuc2hpZnQobG9nSXRlbSk7DQoNCiAgICBhd2FpdCBkYnguZmlsZXNVcGxvYWQoew0KICAgICAgICBwYXRoOiBsb2dQYXRoLA0KICAgICAgICBjb250ZW50czogSlNPTi5zdHJpbmdpZnkobG9ncywgbnVsbCwgMiksDQogICAgICAgIG1vZGU6IHsgJy50YWcnOiAnb3ZlcndyaXRlJyB9LCAvLyDinIUgR2hpIMSRw6ggYuG6r3QgYnXhu5ljDQogICAgICAgIGF1dG9yZW5hbWU6IGZhbHNlDQogICAgfSk7DQp9DQoNCg0KYXN5bmMgZnVuY3Rpb24gaW5pdEFmdGVyTG9naW4oKSB7DQogIGF3YWl0IFByb21pc2UuYWxsKFsNCiAgICBsb2FkUHJvY2VkdXJlcygpLA0KICAgIGxvYWRDb25mbGljdFJ1bGVzKCkNCiAgXSk7DQp9DQoNCg0KDQogICAgICAgIC8vID09PT09PT09PT0gUEjhuqZOIMSQxIJORyBOSOG6rFAgPT09PT09PT09PSAvLw0KYXN5bmMgZnVuY3Rpb24gY2hlY2tTYXZlZExvZ2luKCkgew0KICAgIGNvbnN0IHNhdmVkVXNlciA9IHNlc3Npb25TdG9yYWdlLmdldEl0ZW0oJ21lZFVzZXInKTsNCiAgICBpZiAoc2F2ZWRVc2VyKSB7DQogICAgICAgIGN1cnJlbnRVc2VyID0gc2F2ZWRVc2VyOw0KICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9naW5TZWN0aW9uJykuc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21haW5Db250ZW50Jykuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7DQogICAgICAgIGluaXRBZnRlckxvZ2luKCk7IC8vIGF1dG8tbG9naW4gbeG7m2kgbG9hZCBk4buvIGxp4buHdQ0KICAgIH0NCn0NCg0KbGV0IGlzTG9naW5BY3Rpb24gPSBmYWxzZTsgLy8g4pyFIFRow6ptIGTDsm5nIG7DoHkNCmxldCBhbmFseXplUG9wdXBUaW1lcjsgLy8g4pyFIFRow6ptIGTDsm5nIG7DoHkNCmFzeW5jIGZ1bmN0aW9uIGNoZWNrTG9naW4oKSB7DQogIGNvbnN0IGJ0bkxvZ2luICAgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9naW5CdG4nKTsNCiAgY29uc3QgdXNlcm5hbWUgICA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd1c2VybmFtZUlucHV0JykudmFsdWUudHJpbSgpOw0KICBjb25zdCBwYXNzd29yZCAgID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Bhc3N3b3JkSW5wdXQnKS52YWx1ZS50cmltKCk7DQogIGNvbnN0IGxvZ2luRXJyb3IgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9naW5FcnJvcicpOw0KDQogIGJ0bkxvZ2luLmRpc2FibGVkID0gdHJ1ZTsNCiAgYnRuTG9naW4uaW5uZXJIVE1MID0gJzxpIGNsYXNzPSJmYXMgZmEtc3Bpbm5lciBmYS1zcGluIj48L2k+IMSQYW5nIMSRxINuZyBuaOG6rXAuLi4nOw0KDQogIGNvbnN0IHBvcHVwICAgICAgID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvYWRpbmdQb3B1cCcpOw0KICBjb25zdCBsb2FkaW5nVGV4dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2FkaW5nVGV4dCcpOw0KICBjb25zdCBwcm9ncmVzc0JhciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwcm9ncmVzc0JhcicpOw0KDQogIGxldCBsb2dpblBvcHVwU2hvd24gPSBmYWxzZTsNCg0KICAvLyBTYXUgMnMga2nhu4NtIHRyYTogduG6q24g4bufIHRyYW5nIMSRxINuZyBuaOG6rXAgJiDEkWFuZyBsb2FkaW5nPw0KY29uc3Qgc2xvd0xvZ2luVGltZXIgPSBzZXRUaW1lb3V0KCgpID0+IHsNCiAgICBpZiAoIWlzTG9naW5BY3Rpb24pIHJldHVybjsgLy8g4pyFIFRow6ptIGTDsm5nIG7DoHkNCiAgICBjb25zdCBsb2dpblNlY3Rpb25WaXNpYmxlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvZ2luU2VjdGlvbicpLnN0eWxlLmRpc3BsYXkgIT09ICdub25lJzsNCiAgICBjb25zdCBzdGlsbExvYWRpbmcgPSBidG5Mb2dpbi5pbm5lckhUTUwuaW5jbHVkZXMoJ8SQYW5nIMSRxINuZyBuaOG6rXAnKTsNCiAgICBpZiAobG9naW5TZWN0aW9uVmlzaWJsZSAmJiBzdGlsbExvYWRpbmcpIHsNCiAgICAgIGxvYWRpbmdUZXh0LmlubmVySFRNTCA9IGANCiAgICAgICAgPGkgY2xhc3M9ImZhcyBmYS1zYXRlbGxpdGUtZGlzaCBmYS1zcGluIiBzdHlsZT0iZm9udC1zaXplOjI0cHg7Y29sb3I6I2U2N2UyMjttYXJnaW4tYm90dG9tOjEwcHg7Ij48L2k+PGJyLz4NCiAgICAgICAgPHN0cm9uZz7EkMaw4budbmcgdHJ1eeG7gW4gZ2nDoW4gxJFv4bqhbjwvc3Ryb25nPjxici8+PGJyLz4NCiAgICAgICAgVnVpIGzDsm5nIMSR4bujaSB2w6BpIGdpw6J5IMSR4buDIGto4bufaSDEkeG7mW5nIG3DoXkgY2jhu6cgZOG7sSBwaMOybmcuLi4NCiAgICAgIGA7DQogICAgICBwcm9ncmVzc0Jhci5zdHlsZS53aWR0aCA9ICcwJSc7DQogICAgICBwb3B1cC5zdHlsZS5kaXNwbGF5ID0gJ2ZsZXgnOw0KICAgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKCgpID0+IHBvcHVwLmNsYXNzTGlzdC5hZGQoJ3Nob3cnKSk7DQogICAgICBsb2dpblBvcHVwU2hvd24gPSB0cnVlOw0KICAgIGxldCBwZXJjZW50ID0gMDsNCnByb2dyZXNzQmFyLnN0eWxlLnRyYW5zaXRpb24gPSAnd2lkdGggMC4ycyBsaW5lYXInOw0KY29uc3QgcHJvZ3Jlc3NUaW1lciA9IHNldEludGVydmFsKCgpID0+IHsNCiAgICBwZXJjZW50ICs9IDI7IC8vIHTEg25nIG3hu5dpIGzhuqduIDIlDQogICAgaWYgKHBlcmNlbnQgPiAxMDApIHsNCiAgICAgICAgcGVyY2VudCA9IDEwMDsNCiAgICAgICAgY2xlYXJJbnRlcnZhbChwcm9ncmVzc1RpbWVyKTsNCiAgICB9DQogICAgcHJvZ3Jlc3NCYXIuc3R5bGUud2lkdGggPSBwZXJjZW50ICsgJyUnOw0KfSwgNTAwKTsgLy8gMTAwbXMgY+G6rXAgbmjhuq10IDEgbOG6p24NCg0KCQ0KCX0NCiAgfSwgMjAwMCk7DQoNCiAgdHJ5IHsNCiAgICBjb25zdCBhY2NvdW50cyA9IGF3YWl0IGxvYWRBY2NvdW50c0Zyb21UWFQoKTsNCiAgICBpZiAoYWNjb3VudHNbdXNlcm5hbWVdICYmIGFjY291bnRzW3VzZXJuYW1lXSA9PT0gcGFzc3dvcmQpIHsNCiAgICAgIGN1cnJlbnRVc2VyID0gdXNlcm5hbWU7DQogICAgICBzZXNzaW9uU3RvcmFnZS5zZXRJdGVtKCdtZWRVc2VyJywgdXNlcm5hbWUpOw0KICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvZ2luU2VjdGlvbicpLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7DQogICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFpbkNvbnRlbnQnKS5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsNCiAgICAgIGxvZ2luRXJyb3Iuc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCiAgICAgIGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LnJlbW92ZSgnbG9naW4tcGFnZScpOw0KDQogICAgICBhd2FpdCBpbml0QWZ0ZXJMb2dpbigpOyAvLyBjaOG7iSBsb2FkIHNhdSBraGkgbG9naW4gdGjDoG5oIGPDtG5nDQogICAgfSBlbHNlIHsNCiAgICAgIGxvZ2luRXJyb3Iuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7DQogICAgfQ0KICB9IGNhdGNoIChlcnIpIHsNCiAgICBjb25zb2xlLmVycm9yKCdM4buXaSBraGkgxJHEg25nIG5o4bqtcDonLCBlcnIpOw0KICAgIGxvZ2luRXJyb3Iuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7DQogIH0gZmluYWxseSB7DQogICAgY2xlYXJUaW1lb3V0KHNsb3dMb2dpblRpbWVyKTsNCg0KICAgIC8vIE7hur91IHBvcHVwIGRvIGxvZ2luIG3hu58gdGjDrCDEkcOzbmcNCiAgICBpZiAobG9naW5Qb3B1cFNob3duICYmIHBvcHVwKSB7DQogICAgICBwb3B1cC5jbGFzc0xpc3QucmVtb3ZlKCdzaG93Jyk7DQogICAgICBzZXRUaW1lb3V0KCgpID0+IHsgcG9wdXAuc3R5bGUuZGlzcGxheSA9ICdub25lJzsgfSwgNDAwKTsNCiAgICB9DQoNCiAgICBidG5Mb2dpbi5kaXNhYmxlZCA9IGZhbHNlOw0KICAgIGJ0bkxvZ2luLmlubmVySFRNTCA9ICfEkMSDbmcgbmjhuq1wJzsNCiAgfQ0KfQ0KDQoNCiAgICAgICAgZnVuY3Rpb24gbG9nb3V0KCkgew0KICAgICAgICAgICAgY3VycmVudFVzZXIgPSBudWxsOw0KICAgICAgICAgICAgc2Vzc2lvblN0b3JhZ2UucmVtb3ZlSXRlbSgnbWVkVXNlcicpOw0KICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvZ2luU2VjdGlvbicpLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOw0KICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21haW5Db250ZW50Jykuc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd1c2VybmFtZUlucHV0JykudmFsdWUgPSAnJzsNCiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwYXNzd29yZElucHV0JykudmFsdWUgPSAnJzsNCiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2dpbkVycm9yJykuc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCiAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LmFkZCgnbG9naW4tcGFnZScpOw0KICAgICAgICB9DQoNCi8vID09PT09PT09PT0gSMOATSBMT0FEIERBTkggU8OBQ0ggS0hPQSBI4buiUCBM4buGID09PT09PT09PT0gLy8NCmFzeW5jIGZ1bmN0aW9uIGxvYWRWYWxpZERlcGFydG1lbnRzKCkgew0KICAgIGNvbnN0IHVybCA9ICdodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vY2hhdWh1eW5oMDEwNC9jaGF1aHV5bmgwMTA0LnR4dC9yZWZzL2hlYWRzL21haW4va2hvYS50eHQnOw0KICAgIHRyeSB7DQogICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IGZldGNoKHVybCk7DQogICAgICAgIGNvbnN0IHRleHQgPSBhd2FpdCByZXMudGV4dCgpOw0KICAgICAgICBjb25zdCBraG9hTGlzdCA9IHRleHQuc3BsaXQoJ1xuJykubWFwKGxpbmUgPT4gbGluZS50cmltKCkudG9Mb3dlckNhc2UoKSkuZmlsdGVyKEJvb2xlYW4pOw0KICAgICAgICByZXR1cm4ga2hvYUxpc3Q7DQogICAgfSBjYXRjaCAoZXJyKSB7DQogICAgICAgIGNvbnNvbGUuZXJyb3IoIktow7RuZyB0aOG7gyB04bqjaSBkYW5oIHPDoWNoIGtob2E6IiwgZXJyKTsNCiAgICAgICAgcmV0dXJuIFtdOw0KICAgIH0NCn0NCg0KICAgICAgICAvLyA9PT09PT09PT09IFBI4bqmTiBY4busIEzDnSBGSUxFID09PT09PT09PT0gLy8NCmZ1bmN0aW9uIGhhbmRsZUZpbGUoKSB7DQogICAgY29uc3QgZmlsZUlucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ZpbGVJbnB1dCcpOw0KICAgIGNvbnN0IGFuYWx5emVCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYW5hbHl6ZUJ0bicpOw0KICAgIGNvbnN0IGZpbGUgPSBmaWxlSW5wdXQuZmlsZXNbMF07DQoJDQppZiAoIWZpbGUpIHsNCiAgICBjb25zdCBwb3B1cCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2FkaW5nUG9wdXAnKTsNCiAgICBjb25zdCBsb2FkaW5nVGV4dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2FkaW5nVGV4dCcpOw0KICAgIGNvbnN0IHByb2dyZXNzQmFyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Byb2dyZXNzQmFyJyk7DQoNCiAgICBsb2FkaW5nVGV4dC5pbm5lckhUTUwgPSBgDQogICAgICAgIDxpIGNsYXNzPSJmYXMgZmEtZXhjbGFtYXRpb24tdHJpYW5nbGUiIHN0eWxlPSJmb250LXNpemU6MjRweDtjb2xvcjpyZWQ7bWFyZ2luLWJvdHRvbToxMHB4OyI+PC9pPjxici8+DQogICAgICAgIDxzdHJvbmc+VnVpIGzDsm5nIGNo4buNbiBmaWxlIHRyxrDhu5tjIGtoaSBraeG7g20gdHJhPC9zdHJvbmc+PGJyLz48YnIvPg0KICAgICAgICA8YnV0dG9uIGNsYXNzPSJidG4iIG9uY2xpY2s9ImRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2FkaW5nUG9wdXAnKS5zdHlsZS5kaXNwbGF5PSdub25lJyI+xJDDs25nPC9idXR0b24+DQogICAgYDsNCiAgICBwcm9ncmVzc0Jhci5zdHlsZS53aWR0aCA9ICcwJSc7DQogICAgDQogICAgcG9wdXAuc3R5bGUuZGlzcGxheSA9ICdmbGV4JzsNCiAgICBwb3B1cC5jbGFzc0xpc3QuYWRkKCdzaG93Jyk7DQogICAgcmV0dXJuOw0KfQ0KDQoNCiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZmlsZVJlcXVpcmVtZW50cycpLmNsYXNzTGlzdC5hZGQoJ2hpZGRlbicpOw0KICAgIGVycm9yTG9nID0gW107DQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlc3VsdFNlY3Rpb24nKS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOw0KICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdlcnJvclNlY3Rpb24nKS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOw0KICAgIGFuYWx5emVCdG4uZGlzYWJsZWQgPSB0cnVlOw0KICAgIGFuYWx5emVCdG4uaW5uZXJIVE1MID0gJzxpIGNsYXNzPSJmYXMgZmEtc3Bpbm5lciBmYS1zcGluIj48L2k+IMSQYW5nIGtp4buDbSB0cmEuLi4nOw0KICAgIC8vIOKchSBC4bqvdCDEkeG6p3UgxJHhur9tIDJzIMSR4buDIGhp4buHbiBwb3B1cCBu4bq/dSB24bqrbiDEkWFuZyAixJBhbmcga2nhu4NtIHRyYS4uLiINCmNsZWFyVGltZW91dChhbmFseXplUG9wdXBUaW1lcik7DQphbmFseXplUG9wdXBUaW1lciA9IHNldFRpbWVvdXQoKCkgPT4gew0KICAgIGNvbnN0IGJ0bkFuYWx5emUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYW5hbHl6ZUJ0bicpOw0KICAgIGlmIChidG5BbmFseXplLmlubmVySFRNTC5pbmNsdWRlcygnxJBhbmcga2nhu4NtIHRyYScpKSB7DQogICAgICAgIGNvbnN0IHBvcHVwID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvYWRpbmdQb3B1cCcpOw0KICAgICAgICBjb25zdCBsb2FkaW5nVGV4dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2FkaW5nVGV4dCcpOw0KICAgICAgICBjb25zdCBwcm9ncmVzc0JhciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwcm9ncmVzc0JhcicpOw0KDQogICAgICAgIGxvYWRpbmdUZXh0LmlubmVySFRNTCA9IGANCiAgICAgICAgICAgIDxpIGNsYXNzPSJmYXMgZmEtc2F0ZWxsaXRlLWRpc2ggaWNvbi1zcGluIiBzdHlsZT0iZm9udC1zaXplOjI0cHg7Y29sb3I6I2U2N2UyMjttYXJnaW4tYm90dG9tOjEwcHg7Ij48L2k+PGJyLz4NCiAgICAgICAgICAgIDxzdHJvbmc+xJDGsOG7nW5nIHRydXnhu4FuIGdpw6FuIMSRb+G6oW48L3N0cm9uZz48YnIvPg0KICAgICAgICAgICAgVnVpIGzDsm5nIMSR4bujaSB2w6BpIGdpw6J5IMSR4buDIGto4bufaSDEkeG7mW5nIG3DoXkgY2jhu6cgZOG7sSBwaMOybmcuLi4NCiAgICAgICAgYDsNCiAgICAgICAgcHJvZ3Jlc3NCYXIuc3R5bGUud2lkdGggPSAnMCUnOw0KICAgICAgICBwb3B1cC5zdHlsZS5kaXNwbGF5ID0gJ2ZsZXgnOw0KICAgICAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKCkgPT4gcG9wdXAuY2xhc3NMaXN0LmFkZCgnc2hvdycpKTsNCg0KICAgICAgICAvLyBDaOG6oXkgcHJvZ3Jlc3NCYXIgJQ0KICAgICAgICBsZXQgcGVyY2VudCA9IDA7DQogICAgICAgIHByb2dyZXNzQmFyLnN0eWxlLnRyYW5zaXRpb24gPSAnd2lkdGggMC4ycyBsaW5lYXInOw0KICAgICAgICBjb25zdCBwcm9ncmVzc1RpbWVyID0gc2V0SW50ZXJ2YWwoKCkgPT4gew0KICAgICAgICAgICAgcGVyY2VudCArPSAyOw0KICAgICAgICAgICAgaWYgKHBlcmNlbnQgPiAxMDApIHsNCiAgICAgICAgICAgICAgICBwZXJjZW50ID0gMTAwOw0KICAgICAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwocHJvZ3Jlc3NUaW1lcik7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBwcm9ncmVzc0Jhci5zdHlsZS53aWR0aCA9IHBlcmNlbnQgKyAnJSc7DQogICAgICAgIH0sIDEwMCk7DQogICAgfQ0KfSwgNTAwMCk7DQoNCiAgICBjb25zdCByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpOw0KICAgIA0KICAgIHJlYWRlci5vbmxvYWQgPSBhc3luYyBmdW5jdGlvbihlKSB7DQogICAgICAgIHRyeSB7DQogICAgICAgICAgICBjb25zdCBkYXRhID0gbmV3IFVpbnQ4QXJyYXkoZS50YXJnZXQucmVzdWx0KTsNCiAgICAgICAgICAgIGNvbnN0IHdvcmtib29rID0gWExTWC5yZWFkKGRhdGEsIHsgdHlwZTogJ2FycmF5JyB9KTsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgaWYgKHdvcmtib29rLlNoZWV0TmFtZXMubGVuZ3RoID09PSAwKSB7DQogICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdGaWxlIEV4Y2VsIGtow7RuZyBjw7Mgc2hlZXQgbsOgbycpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgDQogICAgICAgICAgICBjb25zdCBmaXJzdFNoZWV0ID0gd29ya2Jvb2suU2hlZXRzW3dvcmtib29rLlNoZWV0TmFtZXNbMV1dOw0KICAgICAgICAgICAgY29uc3QganNvbkRhdGEgPSBYTFNYLnV0aWxzLnNoZWV0X3RvX2pzb24oZmlyc3RTaGVldCwgeyANCiAgICAgICAgICAgICAgICBoZWFkZXI6IDEsIA0KICAgICAgICAgICAgICAgIGRlZnZhbDogIiIsIA0KICAgICAgICAgICAgICAgIGJsYW5rcm93czogdHJ1ZSANCiAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgY29uc3QgZG9uZzUgPSAoanNvbkRhdGFbNF0gJiYganNvbkRhdGFbNF1bMF0pID8ganNvbkRhdGFbNF1bMF0udG9TdHJpbmcoKS50cmltKCkgOiAiS2jDtG5nIHLDtSI7DQpjb25zdCBkb25nNiA9IChqc29uRGF0YVs1XSAmJiBqc29uRGF0YVs1XVswXSkgPyBqc29uRGF0YVs1XVswXS50b1N0cmluZygpLnRyaW0oKSA6ICJLaMO0bmcgcsO1IjsNCndpbmRvdy5uZ2F5VmFsdWUgPSBkb25nNTsgIC8vIOKshSBkw7JuZyA1ID0gTmfDoHkNCndpbmRvdy5raG9hVmFsdWUgPSBkb25nNjsgIC8vIOKshSBkw7JuZyA2ID0gS2hvYQ0KDQoNCgkJCS8vLy8gS2nhu4NtIHRyYSBraG9hIC8vLy8vDQovLyDinIUgTOG6pXkgZOG7ryBsaeG7h3UgZMOybmcgNiwgY+G7mXQgQQ0KY29uc3Qga2hvYVJvdyA9IGpzb25EYXRhWzVdOyAvLyBkw7JuZyA2DQpjb25zdCBraG9hVGV4dCA9IChraG9hUm93ICYmIGtob2FSb3dbMF0gfHwgIiIpLnRvU3RyaW5nKCkudHJpbSgpOw0KY29uc3Qga2hvYUxvd2VyID0ga2hvYVRleHQudG9Mb3dlckNhc2UoKTsNCg0KLy8g4pyFIEtp4buDbSB0cmEgdMOqbiBraG9hDQpjb25zdCB2YWxpZEtob2FMaXN0ID0gYXdhaXQgbG9hZFZhbGlkRGVwYXJ0bWVudHMoKTsNCmlmICghdmFsaWRLaG9hTGlzdC5zb21lKGtob2EgPT4ga2hvYUxvd2VyLmluY2x1ZGVzKGtob2EpKSkgew0KICAgICAgd2luZG93LmlzS2hvYUxvaSA9IHRydWU7DQogICAgY29uc3QgbXNnID0gYOKdjCBNw6F5IGNo4bunIHThu6sgY2jhu5FpICR7a2hvYVRleHQgfHwgJ0tow7RuZyB4w6FjIMSR4buLbmgnfSBz4butIGThu6VuZyBwaOG6p24gbeG7gW0uIDxici8+VnVpIGzDsm5nIG11YSBi4bqjbiBxdXnhu4FuIMSR4buDIHTDtG4gdHLhu41uZyB0w6FjIGdp4bqjLiBgOw0KDQogICAgLy8gSGnhu4NuIHBvcHVwIGNo4bupIGtow7RuZyBhbGVydA0KIC8vIEhp4buDbiB0aOG7iyBwb3B1cA0KICAgICAgY29uc3QgcG9wdXAgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9hZGluZ1BvcHVwJyk7DQogICAgY29uc3QgbG9hZGluZ1RleHQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9hZGluZ1RleHQnKTsNCiAgICBjb25zdCBwcm9ncmVzc0JhciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwcm9ncmVzc0JhcicpOw0KDQogICAgLy8gSGnhu4NuIHRo4buLIHRow7RuZyBiw6FvIGzhu5dpIHbEqW5oIHZp4buFbg0KICAgbG9hZGluZ1RleHQuaW5uZXJIVE1MID0gYA0KICAgIDxpIGNsYXNzPSJmYXMgZmEtYmFuIiBzdHlsZT0iZm9udC1zaXplOjI0cHg7Y29sb3I6cmVkO2ZvbnQtc2l6ZToyMHB4O21hcmdpbi1ib3R0b206MTBweDsiPjwvaT48YnIvPg0KICAgIDxzdHJvbmc+JHttc2d9PC9zdHJvbmc+PGJyLz48YnIvPg0KICAgIDxidXR0b24gY2xhc3M9ImJ0biIgaWQ9ImJ1eUxpY2Vuc2UiPk11YSBC4bqjbiBRdXnhu4FuPC9idXR0b24+PGJyLz48YnIvPg0KICAgIDxidXR0b24gY2xhc3M9ImJ0biIgb25jbGljaz0id2luZG93LmxvY2F0aW9uLnJlbG9hZCgpIj7EkMOzbmc8L2J1dHRvbj4NCmA7DQoNCi8vIFNhdSBraGkgcmVuZGVyIG7DunQsIHRow6ptIHPhu7Ega2nhu4duDQpzZXRUaW1lb3V0KCgpID0+IHsNCiAgY29uc3QgYnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImJ1eUxpY2Vuc2UiKTsNCiAgaWYgKGJ0bikgew0KICAgIGJ0bi5hZGRFdmVudExpc3RlbmVyKCJjbGljayIsICgpID0+IHsNCiAgICAgIC8vIOG6qG4gcG9wdXAgbOG7l2kNCiAgICAgIGNvbnN0IHBvcHVwID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImxvYWRpbmdQb3B1cCIpOw0KICAgICAgaWYgKHBvcHVwKSBwb3B1cC5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOw0KICAgICAgLy8gTeG7nyBwb3B1cCBi4bqjbmcgZ2nDoQ0KICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImJ1eVBvcHVwIikuc3R5bGUuZGlzcGxheSA9ICJmbGV4IjsNCiAgICB9KTsNCiAgfQ0KfSwgMjAwKTsNCiAgICBwcm9ncmVzc0Jhci5zdHlsZS53aWR0aCA9ICcwJSc7DQoNCiAgICBwb3B1cC5zdHlsZS5kaXNwbGF5ID0gJ2ZsZXgnOw0KICAgIHBvcHVwLmNsYXNzTGlzdC5hZGQoJ3Nob3cnKTsNCg0KICAgIC8vIOKchSBWw5QgSEnhu4ZVIEjDk0EgYuG6pXQga+G7syDEkW/huqFuIG7DoG8gY+G7kSBn4bqvbmcg4bqpbiBwb3B1cCBzYXUgxJHDsw0KICAgIHdpbmRvdy5pc0tob2FMb2kgPSB0cnVlOw0KDQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NjYW5TdGF0dXMnKS5pbm5lckhUTUwgPSBgPHNwYW4gc3R5bGU9ImNvbG9yOnJlZDtmb250LXdlaWdodDpib2xkIj4ke21zZ308L3NwYW4+YDsNCiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdWx0U2VjdGlvbicpLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7DQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Vycm9yU2VjdGlvbicpLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7DQogICAgcmV0dXJuOw0KfQ0KDQoNCg0KCQkJDQogICAgICAgICAgICBpZiAoanNvbkRhdGEubGVuZ3RoIDw9IDEpIHsNCiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ZpbGUgRXhjZWwga2jDtG5nIGPDsyBk4buvIGxp4buHdSAoY2jhu4kgY8OzIHRpw6p1IMSR4buBIGhv4bq3YyB0cuG7kW5nKScpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgDQogICAgICAgICAgIHByb2Nlc3NEYXRhKGpzb25EYXRhKTsNCiAgICAgICAgICBjb25zdCBzdGF0cyA9IHsNCiAgICAgICAgICAgIGhlcmI6IGdldEhlcmJPdXRsaWVyVG90YWwoKSwNCiAgICAgICAgICAgICAgdGltZTogZ2V0VGltZUVycm9yVG90YWwoKSwNCiAgICAgICAgICAgICBjb25mbGljdDogZ2V0Q29uZmxpY3RUb3RhbCgpDQogICAgICAgICAgfTsNCiAgICAgICAgICBjb25zdCB1cGxvYWRGaWxlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ZpbGVJbnB1dCcpLmZpbGVzWzBdOw0KIGF3YWl0IHVwbG9hZFRvRHJvcGJveCh1cGxvYWRGaWxlLCB3aW5kb3cua2hvYVZhbHVlLCB3aW5kb3cubmdheVZhbHVlLCBzdGF0cyk7DQogICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZmlsZVJlcXVpcmVtZW50cycpLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGRlbicpOw0KICAgICAgICAgICAgbG9nRXJyb3IoJ0zhu5dpIGtoaSDEkeG7jWMgZmlsZSBFeGNlbCcsIG51bGwsIGVycm9yLm1lc3NhZ2UpOw0KICAgICAgICAgICAgZGlzcGxheUVycm9ycygpOw0KICAgICAgICAgICAgYWxlcnQoJ0PDsyBs4buXaSB44bqjeSByYSBraGkgxJHhu41jIGZpbGU6ICcgKyBlcnJvci5tZXNzYWdlKTsNCiAgICAgICAgfSBmaW5hbGx5IHsNCgkJY2xlYXJUaW1lb3V0KGFuYWx5emVQb3B1cFRpbWVyKTsgLy8g4pyFIE5n4bqvdCB0aW1lciBwb3B1cA0KCQlpZiAoIXdpbmRvdy5pc0tob2FMb2kpIHsgIA0KCQlkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9hZGluZ1BvcHVwJykuY2xhc3NMaXN0LnJlbW92ZSgnc2hvdycpOyAvLyDinIUg4bqobiBwb3B1cA0KICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2FkaW5nUG9wdXAnKS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOyAgIC8vIOKchSDhuqhuIGjhurNuIHBvcHVwDQoJICB9DQogICAgICAgICAgICBhbmFseXplQnRuLmRpc2FibGVkID0gZmFsc2U7DQogICAgICAgICAgICBhbmFseXplQnRuLmlubmVySFRNTCA9ICc8aSBjbGFzcz0iZmFzIGZhLXNlYXJjaCBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gS2nhu4NtIFRyYSc7DQogICAgICAgIH0NCiAgICB9Ow0KICAgIA0KICAgIHJlYWRlci5vbmVycm9yID0gZnVuY3Rpb24oKSB7DQogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmaWxlUmVxdWlyZW1lbnRzJykuY2xhc3NMaXN0LnJlbW92ZSgnaGlkZGVuJyk7DQogICAgICAgIGxvZ0Vycm9yKCdM4buXaSBraGkgxJHhu41jIGZpbGUnLCBudWxsLCAnS2jDtG5nIHRo4buDIMSR4buNYyBu4buZaSBkdW5nIGZpbGUnKTsNCiAgICAgICAgZGlzcGxheUVycm9ycygpOw0KICAgICAgICBhbmFseXplQnRuLmRpc2FibGVkID0gZmFsc2U7DQogICAgICAgIGFuYWx5emVCdG4uaW5uZXJIVE1MID0gJzxpIGNsYXNzPSJmYXMgZmEtc2VhcmNoIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBLaeG7g20gVHJhJzsNCiAgICAgICAgYWxlcnQoJ0zhu5dpIGtoaSDEkeG7jWMgZmlsZS4gVnVpIGzDsm5nIHRo4butIGzhuqFpIHbhu5tpIGZpbGUga2jDoWMuJyk7DQogICAgfTsNCiAgICANCiAgICByZWFkZXIucmVhZEFzQXJyYXlCdWZmZXIoZmlsZSk7DQp9DQoNCiAgICAgICAgZnVuY3Rpb24gcHJvY2Vzc0RhdGEoZGF0YSkgew0KICAgIA0KICAgIHRyeSB7DQogICAgICAgIGNvbnN0IGhlYWRlckxpbmUxID0gZGF0YVs3XSB8fCBbXTsNCiAgICAgICAgY29uc3QgaGVhZGVyTGluZTIgPSBkYXRhWzhdIHx8IFtdOw0KICAgICAgICBjb25zdCBjb21iaW5lZEhlYWRlcnMgPSBoZWFkZXJMaW5lMS5tYXAoKGNvbCwgaW5kZXgpID0+IA0KICAgICAgICAgICAgKGNvbCArICcgJyArIChoZWFkZXJMaW5lMltpbmRleF0gfHwgJycpKS50cmltKCkNCiAgICAgICAgKTsNCg0KICAgICAgICANCiAgICAgICAgICAgICAgICBjb25zdCBwcm9jZWR1cmVJbmRleCA9IGNvbWJpbmVkSGVhZGVycy5maW5kSW5kZXgoaCA9PiBoLmluY2x1ZGVzKCJUaOG7pyB0aHXhuq10IikpOw0KCQkJCWNvbnN0IGRhdGVJbmRleCA9IGNvbWJpbmVkSGVhZGVycy5maW5kSW5kZXgoaCA9PiBoLmluY2x1ZGVzKCJOZ8OgeSB0aOG7sWMgaGnhu4duIikpOyAvLyBUaMOqbSBkw7JuZyBuw6B5DQogICAgICAgICAgICAgICAgY29uc3Qgc3RhcnRJbmRleCA9IGNvbWJpbmVkSGVhZGVycy5maW5kSW5kZXgoaCA9PiBoLmluY2x1ZGVzKCJUaOG7nWkgZ2lhbiBi4bqvdCDEkeG6p3UgdGjhu7FjIGhp4buHbiIpKTsNCiAgICAgICAgICAgICAgICBjb25zdCBlbmRJbmRleCA9IGNvbWJpbmVkSGVhZGVycy5maW5kSW5kZXgoaCA9PiBoLmluY2x1ZGVzKCJUaOG7nWkgZ2lhbiBr4bq/dCB0aMO6YyIpKTsNCiAgICAgICAgICAgICAgICBjb25zdCBvcGVyYXRvckluZGV4ID0gY29tYmluZWRIZWFkZXJzLmZpbmRJbmRleChoID0+IGguaW5jbHVkZXMoIlRo4bunIHRodeG6rXQgY2jDrW5oIikpOw0KICAgICAgICAgICAgICAgIGNvbnN0IG5hbWVJbmRleCA9IGNvbWJpbmVkSGVhZGVycy5maW5kSW5kZXgoaCA9PiBoLmluY2x1ZGVzKCJI4buNIHTDqm4iKSk7DQogICAgICAgICAgICAgICAgY29uc3QgcGF0aWVudElkSW5kZXggPSBjb21iaW5lZEhlYWRlcnMuZmluZEluZGV4KGggPT4gaC5pbmNsdWRlcygiTcOjIEJOIikpOw0KCQkJCWNvbnN0IHBhdGllbnRhZ2VJbmRleCA9IGNvbWJpbmVkSGVhZGVycy5maW5kSW5kZXgoaCA9PiBoLmluY2x1ZGVzKCJUdeG7lWkiKSk7DQogICAgICAgICAgICAgICAgY29uc3QgZG9jdG9ySW5kZXggPSBjb21iaW5lZEhlYWRlcnMuZmluZEluZGV4KGggPT4gaC5pbmNsdWRlcygiQsOhYyBz4bu5IGNo4buJIMSR4buLbmgiKSk7DQogICAgICAgICAgICAgICAgY29uc3QgbWlzc2luZ0NvbHVtbnMgPSBbXTsNCiAgICAgICAgICAgICAgICBpZiAocHJvY2VkdXJlSW5kZXggPT09IC0xKSBtaXNzaW5nQ29sdW1ucy5wdXNoKCdUaOG7pyB0aHXhuq10Jyk7DQogICAgICAgICAgICAgICAgaWYgKHN0YXJ0SW5kZXggPT09IC0xKSBtaXNzaW5nQ29sdW1ucy5wdXNoKCdUaOG7nWkgZ2lhbiBi4bqvdCDEkeG6p3UgdGjhu7FjIGhp4buHbicpOw0KICAgICAgICAgICAgICAgIGlmIChlbmRJbmRleCA9PT0gLTEpIG1pc3NpbmdDb2x1bW5zLnB1c2goJ1Ro4budaSBnaWFuIGvhur90IHRow7pjJyk7DQogICAgICAgICAgICAgICAgaWYgKG9wZXJhdG9ySW5kZXggPT09IC0xKSBtaXNzaW5nQ29sdW1ucy5wdXNoKCdUaOG7pyB0aHXhuq10IGNow61uaCcpOw0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIGlmIChtaXNzaW5nQ29sdW1ucy5sZW5ndGggPiAwKSB7DQogICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgS2jDtG5nIHTDrG0gdGjhuqV5IGPDoWMgY+G7mXQgYuG6r3QgYnXhu5ljOiAke21pc3NpbmdDb2x1bW5zLmpvaW4oJywgJyl9YCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIGNvbnN0IHJvd3MgPSBkYXRhLnNsaWNlKDkpOw0KICAgICAgICAgICAgICAgIGNvbnN0IHByb2NlZHVyZXMgPSBbXTsNCiAgICAgICAgICAgICAgICBjb25zdCBoZXJiUHJvY2VkdXJlcyA9IFtdOw0KICAgICAgICAgICAgICAgIGxldCBza2lwcGVkUm93cyA9IDA7DQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgcm93cy5mb3JFYWNoKChyb3csIGluZGV4KSA9PiB7DQogICAgICAgICAgICAgICAgICAgIGNvbnN0IHJvd051bWJlciA9IGluZGV4ICsgMTA7DQogICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICB0cnkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFyb3cgfHwgcm93Lmxlbmd0aCA9PT0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvZ0Vycm9yKCdEw7JuZyB0cuG7kW5nJywgcm93TnVtYmVyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBza2lwcGVkUm93cysrOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcHJvY2VkdXJlTmFtZSA9IHJvd1twcm9jZWR1cmVJbmRleF07DQogICAgICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghcHJvY2VkdXJlTmFtZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNraXBwZWRSb3dzKys7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIVBST0NFRFVSRVNbcHJvY2VkdXJlTmFtZV0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2dFcnJvcihgVGjhu6cgdGh14bqtdCBraMO0bmcgbuG6sW0gdHJvbmcgZGFuaCBzw6FjaCBraeG7g20gdHJhOiAke3Byb2NlZHVyZU5hbWV9YCwgcm93TnVtYmVyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBza2lwcGVkUm93cysrOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKFBST0NFRFVSRVNbcHJvY2VkdXJlTmFtZV0uc2tpcCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHN0YXJ0ID0gcGFyc2VEYXRlVGltZShyb3dbc3RhcnRJbmRleF0sIHJvd051bWJlcik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZW5kID0gcGFyc2VEYXRlVGltZShyb3dbZW5kSW5kZXhdLCByb3dOdW1iZXIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlcmJQcm9jZWR1cmVzLnB1c2goew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByb3dJbmRleDogcm93TnVtYmVyLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXRpZW50TmFtZTogbmFtZUluZGV4ICE9PSAtMSA/IHJvd1tuYW1lSW5kZXhdIHx8ICdLaMO0bmcgY8OzJyA6ICdLaMO0bmcgY8OzJywNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGF0aWVudElkOiBwYXRpZW50SWRJbmRleCAhPT0gLTEgPyByb3dbcGF0aWVudElkSW5kZXhdIHx8ICdLaMO0bmcgY8OzJyA6ICdLaMO0bmcgY8OzJywNCgkJCQkJCQkJcGF0aWVudEFnZTogcGF0aWVudGFnZUluZGV4ICE9PSAtMSA/IHJvd1twYXRpZW50YWdlSW5kZXhdIHx8ICdLaMO0bmcgY8OzJyA6ICdLaMO0bmcgY8OzJywNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvY2VkdXJlOiBwcm9jZWR1cmVOYW1lLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2N0b3I6IHJvd1tkb2N0b3JJbmRleF0gfHwgJ0tow7RuZyBjw7MnLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRlOiBzdGFydD8uZGF0ZUtleSB8fCAnS2jDtG5nIHjDoWMgxJHhu4tuaCcsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0OiBzdGFydD8uc2Vjb25kcyB8fCAwLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQ6IGVuZD8uc2Vjb25kcyB8fCAwLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaXNwbGF5U3RhcnQ6IHN0YXJ0Py5kaXNwbGF5VGltZSB8fCAnPz8nLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaXNwbGF5RW5kOiBlbmQ/LmRpc3BsYXlUaW1lIHx8ICc/PycsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wZXJhdG9yOiByb3dbb3BlcmF0b3JJbmRleF0gfHwgJ0tow7RuZyBjw7MnLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9jZWR1cmVJbmZvOiBQUk9DRURVUkVTW3Byb2NlZHVyZU5hbWVdDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzdGFydCA9IHBhcnNlRGF0ZVRpbWUocm93W3N0YXJ0SW5kZXhdLCByb3dOdW1iZXIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZW5kID0gcGFyc2VEYXRlVGltZShyb3dbZW5kSW5kZXhdLCByb3dOdW1iZXIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXN0YXJ0IHx8ICFlbmQpIHsNCiAgIA0KICAgIHNraXBwZWRSb3dzKys7DQogICAgcmV0dXJuOw0KfQ0KICAgICAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3RhcnQuZGF0ZUtleSAhPT0gZW5kLmRhdGVLZXkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2dFcnJvcignVGjhu6cgdGh14bqtdCBi4bqvdCDEkeG6p3UgdsOgIGvhur90IHRow7pjIGtow6FjIG5nw6B5Jywgcm93TnVtYmVyLCB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0RGF0ZTogc3RhcnQuZGF0ZUtleSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kRGF0ZTogZW5kLmRhdGVLZXksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhdGllbnROYW1lOiBuYW1lSW5kZXggIT09IC0xID8gcm93W25hbWVJbmRleF0gfHwgJ0tow7RuZyBjw7MnIDogJ0tow7RuZyBjw7MnLA0KCQkJCQkJCQlwYXRpZW50SWQ6IHBhdGllbnRJZEluZGV4ICE9PSAtMSA/IHJvd1twYXRpZW50SWRJbmRleF0gfHwgJ0tow7RuZyBjw7MnIDogJ0tow7RuZyBjw7MnLA0KCQkJCQkJCQlwYXRpZW50QWdlOiBwYXRpZW50YWdlSW5kZXggIT09IC0xID8gcm93W3BhdGllbnRhZ2VJbmRleF0gfHwgJ0tow7RuZyBjw7MnIDogJ0tow7RuZyBjw7MnLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9jZWR1cmU6IHByb2NlZHVyZU5hbWUNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBza2lwcGVkUm93cysrOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVuZC5zZWNvbmRzIDw9IHN0YXJ0LnNlY29uZHMpIHsNCiAgICBsb2dFcnJvcignVGjhu51pIGdpYW4ga+G6v3QgdGjDumMgcGjhuqNpIHNhdSB0aOG7nWkgZ2lhbiBi4bqvdCDEkeG6p3UnLCByb3dOdW1iZXIsIHsNCiAgICAgICAgc3RhcnRUaW1lOiBzdGFydC5kaXNwbGF5VGltZSwNCiAgICAgICAgZW5kVGltZTogZW5kLmRpc3BsYXlUaW1lLA0KICAgICAgICBzdGFydFZhbHVlOiByb3dbc3RhcnRJbmRleF0sDQogICAgICAgIGVuZFZhbHVlOiByb3dbZW5kSW5kZXhdLA0KICAgICAgICBwYXRpZW50TmFtZTogbmFtZUluZGV4ICE9PSAtMSA/IHJvd1tuYW1lSW5kZXhdIHx8ICdLaMO0bmcgY8OzJyA6ICdLaMO0bmcgY8OzJywNCgkJcGF0aWVudElkOiBwYXRpZW50SWRJbmRleCAhPT0gLTEgPyByb3dbcGF0aWVudElkSW5kZXhdIHx8ICdLaMO0bmcgY8OzJyA6ICdLaMO0bmcgY8OzJywNCgkJcGF0aWVudEFnZTogcGF0aWVudGFnZUluZGV4ICE9PSAtMSA/IHJvd1twYXRpZW50YWdlSW5kZXhdIHx8ICdLaMO0bmcgY8OzJyA6ICdLaMO0bmcgY8OzJywNCiAgICAgICAgcHJvY2VkdXJlOiBwcm9jZWR1cmVOYW1lLA0KICAgICAgICBuZ2F5VGh1Y0hpZW46IGRhdGVJbmRleCAhPT0gLTEgPyByb3dbZGF0ZUluZGV4XSA6ICdLaMO0bmcgeMOhYyDEkeG7i25oJw0KICAgIH0pOw0KICAgIHNraXBwZWRSb3dzKys7DQogICAgcmV0dXJuOw0KfQ0KICAgICAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBleHBlY3RlZER1cmF0aW9uID0gUFJPQ0VEVVJFU1twcm9jZWR1cmVOYW1lXT8uZHVyYXRpb24gfHwgMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGFjdHVhbER1cmF0aW9uTWludXRlcyA9IChlbmQuc2Vjb25kcyAtIHN0YXJ0LnNlY29uZHMpIC8gNjA7DQogICAgICAgICAgICAgICAgICAgICAgICANCmxldCBkdXJhdGlvbkRpZmYgPSBNYXRoLmFicyhhY3R1YWxEdXJhdGlvbk1pbnV0ZXMgLSBleHBlY3RlZER1cmF0aW9uKTsNCmxldCBpc0RvY3RvciA9IChzZXNzaW9uU3RvcmFnZS5nZXRJdGVtKCdtZWRVc2VyJykgfHwgJycpLnRvTG93ZXJDYXNlKCkgPT09ICdkb2N0b3InOw0KDQppZiAoDQogICAgZXhwZWN0ZWREdXJhdGlvbiA+IDAgJiYNCiAgICAoDQogICAgICAgIChpc0RvY3RvciAmJiBkdXJhdGlvbkRpZmYgPj0gMSkgfHwgICAvLyDinJQgdMOgaSBraG/huqNuIGRvY3Rvcg0KICAgICAgICAoIWlzRG9jdG9yICYmIGR1cmF0aW9uRGlmZiA+IDEpICAgICAgLy8g4pyUIHTDoGkga2hv4bqjbiBraMOhYw0KICAgICkNCikgew0KICAgIGxvZ0Vycm9yKGBgLCByb3dOdW1iZXIsIHsNCiAgICAgICAgcHJvY2VkdXJlOiBwcm9jZWR1cmVOYW1lLA0KICAgICAgICBleHBlY3RlZDogZXhwZWN0ZWREdXJhdGlvbiwNCiAgICAgICAgYWN0dWFsOiBhY3R1YWxEdXJhdGlvbk1pbnV0ZXMsDQogICAgICAgIHBhdGllbnROYW1lOiBuYW1lSW5kZXggIT09IC0xID8gcm93W25hbWVJbmRleF0gfHwgJ0tow7RuZyBjw7MnIDogJ0tow7RuZyBjw7MnLA0KCQlwYXRpZW50SWQ6IHBhdGllbnRJZEluZGV4ICE9PSAtMSA/IHJvd1twYXRpZW50SWRJbmRleF0gfHwgJ0tow7RuZyBjw7MnIDogJ0tow7RuZyBjw7MnLA0KCQlwYXRpZW50QWdlOiBwYXRpZW50YWdlSW5kZXggIT09IC0xID8gcm93W3BhdGllbnRhZ2VJbmRleF0gfHwgJ0tow7RuZyBjw7MnIDogJ0tow7RuZyBjw7MnLA0KICAgICAgICBvcGVyYXRvcjogcm93W29wZXJhdG9ySW5kZXhdID8gcm93W29wZXJhdG9ySW5kZXhdLnJlcGxhY2UoLywvZywgJycpIDogJ0tow7RuZyBjw7MnLA0KICAgICAgICBkYXRlOiBzdGFydC5kYXRlS2V5LA0KICAgICAgICBuZ2F5VGh1Y0hpZW46IGRhdGVJbmRleCAhPT0gLTEgPyByb3dbZGF0ZUluZGV4XSA6ICdLaMO0bmcgeMOhYyDEkeG7i25oJywNCiAgICAgICAgc3RhcnRUaW1lOiBzdGFydC5kaXNwbGF5VGltZSwNCiAgICAgICAgZW5kVGltZTogZW5kLmRpc3BsYXlUaW1lLA0KICAgICAgICBkb2N0b3I6IHJvd1tkb2N0b3JJbmRleF0gfHwgJ0tow7RuZyBjw7MnIC8vIFRow6ptIGTDsm5nIG7DoHkNCiAgICB9KTsNCn0NCg0KICAgICAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgICAgICBpZiAocHJvY2VkdXJlTmFtZSA9PT0gJ1Phuq9jIHRodeG7kWMgdGhhbmcnKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVyYlByb2NlZHVyZXMucHVzaChwcm9jZWR1cmVzW3Byb2NlZHVyZXMubGVuZ3RoIC0gMV0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcHJvY2VkdXJlcy5wdXNoKHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByb3dJbmRleDogcm93TnVtYmVyLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhdGllbnROYW1lOiBuYW1lSW5kZXggIT09IC0xID8gcm93W25hbWVJbmRleF0gfHwgJ0tow7RuZyBjw7MnIDogJ0tow7RuZyBjw7MnLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhdGllbnRJZDogcGF0aWVudElkSW5kZXggIT09IC0xID8gcm93W3BhdGllbnRJZEluZGV4XSB8fCAnS2jDtG5nIGPDsycgOiAnS2jDtG5nIGPDsycsDQoJCQkJCQkJcGF0aWVudEFnZTogcGF0aWVudGFnZUluZGV4ICE9PSAtMSA/IHJvd1twYXRpZW50YWdlSW5kZXhdIHx8ICdLaMO0bmcgY8OzJyA6ICdLaMO0bmcgY8OzJywNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9jZWR1cmU6IHByb2NlZHVyZU5hbWUsDQoJCQkJCQkJZG9jdG9yOiByb3dbZG9jdG9ySW5kZXhdIHx8ICdLaMO0bmcgY8OzJywNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRlOiBzdGFydC5kYXRlS2V5LA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0OiBzdGFydC5zZWNvbmRzLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZDogZW5kLnNlY29uZHMsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGxheVN0YXJ0OiBzdGFydC5kaXNwbGF5VGltZSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaXNwbGF5RW5kOiBlbmQuZGlzcGxheVRpbWUsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgb3BlcmF0b3I6IHJvd1tvcGVyYXRvckluZGV4XSB8fCAnS2jDtG5nIGPDsycsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uZmxpY3Q6IGZhbHNlLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbmZsaWN0UmVhc29uOiAnJywNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9jZWR1cmVJbmZvOiBQUk9DRURVUkVTW3Byb2NlZHVyZU5hbWVdLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1Z2dlc3Rpb246ICcnDQogICAgICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGxvZ0Vycm9yKGBM4buXaSB44butIGzDvSBkw7JuZzogJHtlcnJvci5tZXNzYWdlfWAsIHJvd051bWJlciwgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhdGllbnROYW1lOiBuYW1lSW5kZXggIT09IC0xID8gcm93W25hbWVJbmRleF0gfHwgJ0tow7RuZyBjw7MnIDogJ0tow7RuZyBjw7MnLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2NlZHVyZTogcm93W3Byb2NlZHVyZUluZGV4XSB8fCAnS2jDtG5nIGPDsycsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3JEZXRhaWxzOiBlcnJvci5zdGFjaw0KICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgICAgICBza2lwcGVkUm93cysrOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgaWYgKHByb2NlZHVyZXMubGVuZ3RoID09PSAwKSB7DQogICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignS2jDtG5nIGPDsyB0aOG7pyB0aHXhuq10IG7DoG8gaOG7o3AgbOG7hyDEkeG7gyBraeG7g20gdHJhLiBWdWkgbMOybmcga2nhu4NtIHRyYSBs4bqhaSBk4buvIGxp4buHdS4nKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgY2hlY2tDb25mbGljdHMocHJvY2VkdXJlcyk7DQogICAgICAgICAgICAgICAgZ2VuZXJhdGVUaW1lU3VnZ2VzdGlvbnMocHJvY2VkdXJlcyk7DQoJCQkJIC8vID09PSBUSMOKTSAzIETDkk5HIENoZWNrIG3DoyBtw6F5ID09PQ0KICAgICAgICBjaGVja01hY2hpbmVFcnJvcnMocHJvY2VkdXJlcywgZGF0YSk7DQogICAgICAgIGNoZWNrTWFjaGluZUNvbmZsaWN0cyhwcm9jZWR1cmVzLCBkYXRhKTsNCgkJY2hlY2tNaXNzaW5nTWFjaGluZUNvZGVzKHByb2NlZHVyZXMsIGRhdGEpOyANCiAgICAgICAgLy8gPT09IEvhur5UIFRIw5pDIFRIw4pNID09PQ0KICAgICAgICAgICAgICAgIGRpc3BsYXlSZXN1bHRzKHByb2NlZHVyZXMsIHNraXBwZWRSb3dzKTsNCiAgICAgICAgICAgICAgICB3aW5kb3cuYWxsSGVyYlByb2NlZHVyZXMgPSBoZXJiUHJvY2VkdXJlczsNCgkJCQkvLyAtLS0gQ+G6rXAgbmjhuq10IHPhu5EgY2Ega2jDoWMgxJFhIHPhu5EgdHLDqm4gbsO6dCAtLS0NCnNldFRpbWVvdXQoKCkgPT4gew0KICBpZiAodHlwZW9mIHVwZGF0ZUhlcmJCdXR0b25XaXRoT3V0bGllckNvdW50ID09PSAnZnVuY3Rpb24nKSB7DQogICAgdXBkYXRlSGVyYkJ1dHRvbldpdGhPdXRsaWVyQ291bnQoKTsNCiAgfQ0KfSwgMTAwKTsNCg0KICAgICAgICAgICAgICAgIGRpc3BsYXlFcnJvcnMoKTsNCgkJCQkgDQogICAgICAgIC8vID09PSBUSMOKTSAzIETDkk5HIGNoZWNrIG3DoyBtw6F5ID09PQ0KICAgICAgICBkaXNwbGF5TWFjaGluZUVycm9ycygpOw0KICAgICAgICBkaXNwbGF5TWFjaGluZUNvbmZsaWN0cygpOw0KCQlkaXNwbGF5TWlzc2luZ01hY2hpbmVFcnJvcnMoKTsNCiAgICAgICAgLy8gPT09IEvhur5UIFRIw5pDIFRIw4pNID09PQ0KICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgICAgICAgICBsb2dFcnJvcihlcnJvci5tZXNzYWdlLCBudWxsLCBlcnJvci5zdGFjayk7DQogICAgICAgICAgICAgICAgZGlzcGxheUVycm9ycygpOw0KICAgICAgICAgICAgICAgIGFsZXJ0KCdDw7MgbOG7l2kgeOG6o3kgcmEga2hpIHjhu60gbMO9IGThu68gbGnhu4d1OiAnICsgZXJyb3IubWVzc2FnZSk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KDQpsZXQgY29uZmxpY3RSdWxlc1RleHQgPSAnJzsNCg0KYXN5bmMgZnVuY3Rpb24gbG9hZENvbmZsaWN0UnVsZXMoKSB7DQogICAgdHJ5IHsNCiAgICAgICAgY29uc3QgdXJsID0gJ2h0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9jaGF1aHV5bmgwMTA0L2NoYXVodXluaDAxMDQudHh0L3JlZnMvaGVhZHMvbWFpbi9jaGF1X3hsdGh1dGh1YXQudHh0P3RzPScgKyBEYXRlLm5vdygpOw0KICAgICAgICBjb25zdCByZXMgPSBhd2FpdCBmZXRjaCh1cmwpOw0KICAgICAgICBpZiAoIXJlcy5vaykgdGhyb3cgbmV3IEVycm9yKCdLaMO0bmcgdOG6o2kgxJHGsOG7o2MgY2hhdV94bHRodXRodWF0LnR4dCcpOw0KICAgICAgICBjb25mbGljdFJ1bGVzVGV4dCA9IChhd2FpdCByZXMudGV4dCgpKS50cmltKCk7DQogICAgfSBjYXRjaCAoZSkgew0KICAgICAgICBjb25zb2xlLmVycm9yKCdM4buXaSB04bqjaSBjaGF1X3hsdGh1dGh1YXQudHh0OicsIGUpOw0KICAgICAgICBjb25mbGljdFJ1bGVzVGV4dCA9ICcnOyAvLyBmYWxsYmFjazogcuG7l25nIC0+IGNvaSBuaMawIGtow7RuZyBjw7Mgbmdv4bqhaSBs4buHDQogICAgfQ0KfQ0KDQoNCg0KDQogICAgICAgIGZ1bmN0aW9uIGNoZWNrQ29uZmxpY3RzKHByb2NlZHVyZXMpIHsNCiAgICAgICAgICAgIGNvbnN0IGlnbm9yZUFkamFjZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2lnbm9yZUFkamFjZW50Q2hlY2tib3gnKS5jaGVja2VkOw0KICAgICAgICAgICAgY29uc3QgZ3JvdXBzID0ge307DQogICAgICAgICAgICANCiAgICAgICAgICAgIHByb2NlZHVyZXMuZm9yRWFjaChwcm9jID0+IHsNCiAgICAgICAgICAgICAgICBjb25zdCBrZXkgPSBgJHtwcm9jLm9wZXJhdG9yfV8ke3Byb2MuZGF0ZX1gOw0KICAgICAgICAgICAgICAgIGlmICghZ3JvdXBzW2tleV0pIHsNCiAgICAgICAgICAgICAgICAgICAgZ3JvdXBzW2tleV0gPSBbXTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZ3JvdXBzW2tleV0ucHVzaChwcm9jKTsNCiAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgDQogICAgICAgICAgICBPYmplY3QudmFsdWVzKGdyb3VwcykuZm9yRWFjaChncm91cCA9PiB7DQogICAgICAgICAgICAgICAgZ3JvdXAuc29ydCgoYSwgYikgPT4gYS5zdGFydCAtIGIuc3RhcnQpOw0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAxOyBpIDwgZ3JvdXAubGVuZ3RoOyBpKyspIHsNCiAgICAgICAgICAgICAgICAgICAgY29uc3QgcHJldiA9IGdyb3VwW2kgLSAxXTsNCiAgICAgICAgICAgICAgICAgICAgY29uc3QgY3VycmVudCA9IGdyb3VwW2ldOw0KICAgICAgICAgICAgICAgICAgICBjb25zdCBwcmV2RW5kV2l0aEJ1ZmZlciA9IHByZXYuZW5kICsgKHByZXYucHJvY2VkdXJlSW5mbz8uYnVmZmVyIHx8IDApICogNjA7DQogICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICBjb25zdCBpc0FkamFjZW50ID0gaWdub3JlQWRqYWNlbnQgJiYgY3VycmVudC5zdGFydCA9PT0gcHJldi5lbmQ7DQogICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICBpZiAoY3VycmVudC5zdGFydCA8IHByZXZFbmRXaXRoQnVmZmVyICYmICFpc0FkamFjZW50KSB7DQogICAgICAgICAgICAgICAgIA0KDQpsZXQgaXNDb25mbGljdCA9IHRydWU7DQogICAgdHJ5IHsNCiAgICAgICAgaWYgKGNvbmZsaWN0UnVsZXNUZXh0ICYmIGNvbmZsaWN0UnVsZXNUZXh0LnRyaW0oKSkgew0KICAgICAgICAgICAgY29uc3QgY29uZmxpY3RDb25kaXRpb24gPSBuZXcgRnVuY3Rpb24oJ3ByZXYnLCdjdXJyZW50JywncmV0dXJuICcgKyBjb25mbGljdFJ1bGVzVGV4dC50cmltKCkpOw0KICAgICAgICAgICAgLy8gY29uZmxpY3RDb25kaXRpb24oKSBUUuG6oiBW4buAIHRydWUgbuG6v3UgKsSRxrDhu6NjIG1p4buFbiB4dW5nIMSR4buZdCoNCiAgICAgICAgICAgIGNvbnN0IGFsbG93ZWQgPSBjb25mbGljdENvbmRpdGlvbihwcmV2LCBjdXJyZW50KTsNCiAgICAgICAgICAgIGlzQ29uZmxpY3QgPSAhYWxsb3dlZDsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIGlzQ29uZmxpY3QgPSB0cnVlOyAvLyBraMO0bmcgY8OzIHJ1bGUgLT4gY+G7qSBiw6FvIHh1bmcgxJHhu5l0DQogICAgICAgIH0NCiAgICB9IGNhdGNoIChlcnIpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcignTOG7l2kga2hpIMSRw6FuaCBnacOhIHh1bmcgxJHhu5l0IHRo4budaSBnaWFuOicsIGVycik7DQogICAgICAgIGlzQ29uZmxpY3QgPSB0cnVlOw0KICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlzQ29uZmxpY3QpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50LmNvbmZsaWN0ID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50LmNvbmZsaWN0UmVhc29uID0gYCR7cHJldi5wcm9jZWR1cmV9PGJyPuKAoiBC4buHbmggbmjDom46ICR7cHJldi5wYXRpZW50TmFtZX08YnI+4oCiIE5nw6B5OiAke3ByZXYuZGF0ZX08YnI+4oCiIFRo4budaSBnaWFuOiAke3ByZXYuZGlzcGxheVN0YXJ0fS0ke3ByZXYuZGlzcGxheUVuZH1gOw0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJldi5jb25mbGljdCA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFwcmV2LmNvbmZsaWN0UmVhc29uLmluY2x1ZGVzKGN1cnJlbnQucHJvY2VkdXJlKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmV2LmNvbmZsaWN0UmVhc29uICs9IChwcmV2LmNvbmZsaWN0UmVhc29uID8gJzxicj48YnI+JyA6ICcnKSArIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYCAke2N1cnJlbnQucHJvY2VkdXJlfTxicj7igKIgQuG7h25oIG5ow6JuOiAke2N1cnJlbnQucGF0aWVudE5hbWV9PGJyPuKAoiBOZ8OgeTogJHtjdXJyZW50LmRhdGV9PGJyPuKAoiBUaOG7nWkgZ2lhbjogJHtjdXJyZW50LmRpc3BsYXlTdGFydH0tJHtjdXJyZW50LmRpc3BsYXlFbmR9YDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9KTsNCiAgICAgICAgfQ0KDQoNCi8vIEjDoG0ga2nhu4NtIHRyYSBn4bqvbiBzYWkgbcOheQ0KZnVuY3Rpb24gY2hlY2tNYWNoaW5lRXJyb3JzKHByb2NlZHVyZXMsIGpzb25EYXRhKSB7DQogICAgbWFjaGluZUVycm9yTG9nID0gW107DQogICAgDQogICAgY29uc3QgaGVhZGVyTGluZTEgPSBqc29uRGF0YVs3XSB8fCBbXTsNCiAgICBjb25zdCBoZWFkZXJMaW5lMiA9IGpzb25EYXRhWzhdIHx8IFtdOw0KICAgIGNvbnN0IGNvbWJpbmVkSGVhZGVycyA9IGhlYWRlckxpbmUxLm1hcCgoY29sLCBpbmRleCkgPT4gDQogICAgICAgIChjb2wgKyAnICcgKyAoaGVhZGVyTGluZTJbaW5kZXhdIHx8ICcnKSkudHJpbSgpDQogICAgKTsNCg0KICAgIC8vIFTDrG0gY+G7mXQgbcOjIG3DoXkNCiAgICBjb25zdCBtYWNoaW5lQ29kZUluZGV4ID0gY29tYmluZWRIZWFkZXJzLmZpbmRJbmRleChoID0+IA0KICAgICAgICBoLmluY2x1ZGVzKCJNw6MgbcOheSIpIHx8IGguaW5jbHVkZXMoIk3DoyBtw6F5IHRoZW8gdGjhu6cgdGh14bqtdCIpDQogICAgKTsNCiAgICANCiAgICBpZiAobWFjaGluZUNvZGVJbmRleCA9PT0gLTEpIHsNCiAgICAgICAgY29uc29sZS5sb2coIktow7RuZyB0w6xtIHRo4bqleSBj4buZdCBtw6MgbcOheSB0cm9uZyBmaWxlIEV4Y2VsIik7DQogICAgICAgIHJldHVybjsNCiAgICB9DQoNCiAgICAvLyBUw6xtIGPDoWMgY+G7mXQga2jDoWMgY+G6p24gdGhp4bq/dA0KICAgIGNvbnN0IHByb2NlZHVyZUluZGV4ID0gY29tYmluZWRIZWFkZXJzLmZpbmRJbmRleChoID0+IGguaW5jbHVkZXMoIlRo4bunIHRodeG6rXQiKSk7DQogICAgY29uc3QgbmFtZUluZGV4ID0gY29tYmluZWRIZWFkZXJzLmZpbmRJbmRleChoID0+IGguaW5jbHVkZXMoIkjhu40gdMOqbiIpKTsNCgljb25zdCBwYXRpZW50SWRJbmRleCA9IGNvbWJpbmVkSGVhZGVycy5maW5kSW5kZXgoaCA9PiBoLmluY2x1ZGVzKCJNw6MgQk4iKSk7DQoJY29uc3QgcGF0aWVudGFnZUluZGV4ID0gY29tYmluZWRIZWFkZXJzLmZpbmRJbmRleChoID0+IGguaW5jbHVkZXMoIlR14buVaSIpKTsNCiAgICBjb25zdCBvcGVyYXRvckluZGV4ID0gY29tYmluZWRIZWFkZXJzLmZpbmRJbmRleChoID0+IGguaW5jbHVkZXMoIlRo4bunIHRodeG6rXQgY2jDrW5oIikpOw0KICAgIGNvbnN0IHN0YXJ0SW5kZXggPSBjb21iaW5lZEhlYWRlcnMuZmluZEluZGV4KGggPT4gaC5pbmNsdWRlcygiVGjhu51pIGdpYW4gYuG6r3QgxJHhuqd1IHRo4buxYyBoaeG7h24iKSk7DQogICAgY29uc3QgZW5kSW5kZXggPSBjb21iaW5lZEhlYWRlcnMuZmluZEluZGV4KGggPT4gaC5pbmNsdWRlcygiVGjhu51pIGdpYW4ga+G6v3QgdGjDumMiKSk7DQoNCiAgICBjb25zdCByb3dzID0ganNvbkRhdGEuc2xpY2UoOSk7DQogICAgDQogICAgcm93cy5mb3JFYWNoKChyb3csIGluZGV4KSA9PiB7DQogICAgICAgIGNvbnN0IHJvd051bWJlciA9IGluZGV4ICsgMTA7DQogICAgICAgIA0KICAgICAgICB0cnkgew0KICAgICAgICAgICAgaWYgKCFyb3cgfHwgcm93Lmxlbmd0aCA9PT0gMCkgcmV0dXJuOw0KICAgICAgICAgICAgDQogICAgICAgICAgICBjb25zdCBwcm9jZWR1cmVOYW1lID0gcm93W3Byb2NlZHVyZUluZGV4XTsNCiAgICAgICAgICAgIGlmICghcHJvY2VkdXJlTmFtZSB8fCAhUFJPQ0VEVVJFU1twcm9jZWR1cmVOYW1lXSkgcmV0dXJuOw0KICAgICAgICAgICAgDQogICAgICAgICAgICBjb25zdCBtYWNoaW5lQ29kZSA9IChyb3dbbWFjaGluZUNvZGVJbmRleF0gfHwgJycpLnRvU3RyaW5nKCkudHJpbSgpOw0KICAgICAgICAgICAgY29uc3QgcHJvY2VkdXJlSW5mbyA9IFBST0NFRFVSRVNbcHJvY2VkdXJlTmFtZV07DQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIENo4buJIGtp4buDbSB0cmEgMyB0aOG7pyB0aHXhuq10IGPDsyBtYWNoaW5lQ29kZQ0KICAgICAgICAgICAgaWYgKCFwcm9jZWR1cmVJbmZvLm1hY2hpbmVDb2RlKSByZXR1cm47DQogICAgICAgICAgICANCiAgICAgICAgICAgIGNvbnN0IGV4cGVjdGVkQ29kZXMgPSBBcnJheS5pc0FycmF5KHByb2NlZHVyZUluZm8ubWFjaGluZUNvZGUpIA0KICAgICAgICAgICAgICAgID8gcHJvY2VkdXJlSW5mby5tYWNoaW5lQ29kZSANCiAgICAgICAgICAgICAgICA6IFtwcm9jZWR1cmVJbmZvLm1hY2hpbmVDb2RlXTsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gS2nhu4NtIHRyYSB4ZW0gbcOjIG3DoXkgY8OzIGNo4bupYSBi4bqldCBr4buzIG3DoyBleHBlY3RlZCBuw6BvIGtow7RuZw0KICAgICAgICAgICAgY29uc3QgaXNWYWxpZE1hY2hpbmUgPSBleHBlY3RlZENvZGVzLnNvbWUoY29kZSA9PiANCiAgICAgICAgICAgICAgICBtYWNoaW5lQ29kZS50b1VwcGVyQ2FzZSgpLmluY2x1ZGVzKGNvZGUudG9VcHBlckNhc2UoKSkNCiAgICAgICAgICAgICk7DQogICAgICAgICAgICANCiAgICAgICAgICAgIGlmICghaXNWYWxpZE1hY2hpbmUgJiYgbWFjaGluZUNvZGUgIT09ICcnKSB7DQogICAgICAgICAgICAgICAgY29uc3Qgc3RhcnQgPSBwYXJzZURhdGVUaW1lKHJvd1tzdGFydEluZGV4XSwgcm93TnVtYmVyKTsNCiAgICAgICAgICAgICAgICBjb25zdCBlbmQgPSBwYXJzZURhdGVUaW1lKHJvd1tlbmRJbmRleF0sIHJvd051bWJlcik7DQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgLy8gWMOhYyDEkeG7i25oIHRow7RuZyBiw6FvIGzhu5dpIGPhu6UgdGjhu4MgZOG7sWEgdHLDqm4gbcOjIG3DoXkgbmjhuq1wIHNhaQ0KICAgICAgICAgICAgICAgIGxldCBlcnJvck1lc3NhZ2UgPSAnR+G6r24gbmjhuqdtIG3DoXkgY2jGsGEgeMOhYyDEkeG7i25oJzsNCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICBpZiAobWFjaGluZUNvZGUudG9VcHBlckNhc2UoKS5pbmNsdWRlcygnTcSQQycpKSB7DQogICAgICAgICAgICAgICAgICAgIGVycm9yTWVzc2FnZSA9ICdH4bqvbiBuaOG6p20gbcOheSDEkWnhu4duIGNow6JtIHLhu5NpJzsNCiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKG1hY2hpbmVDb2RlLnRvVXBwZXJDYXNlKCkuaW5jbHVkZXMoJ8SQSE4nKSkgew0KICAgICAgICAgICAgICAgICAgICBlcnJvck1lc3NhZ2UgPSAnR+G6r24gbmjhuqdtIMSRw6huIGjhu5NuZyBuZ2/huqFpIHLhu5NpJzsNCiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKG1hY2hpbmVDb2RlLnRvVXBwZXJDYXNlKCkuaW5jbHVkZXMoJ0dIJykgfHwgbWFjaGluZUNvZGUudG9VcHBlckNhc2UoKS5pbmNsdWRlcygnT0dIJykpIHsNCiAgICAgICAgICAgICAgICAgICAgZXJyb3JNZXNzYWdlID0gJ0fhuq9uIG5o4bqnbSBtw6F5IGdpw6FjIGjGoWkgcuG7k2knOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICBtYWNoaW5lRXJyb3JMb2cucHVzaCh7DQogICAgICAgICAgICAgICAgICAgIHJvd051bWJlcjogcm93TnVtYmVyLA0KICAgICAgICAgICAgICAgICAgICBwYXRpZW50TmFtZTogbmFtZUluZGV4ICE9PSAtMSA/IHJvd1tuYW1lSW5kZXhdIHx8ICdLaMO0bmcgY8OzJyA6ICdLaMO0bmcgY8OzJywNCiAgICAgICAgICAgICAgICAgICAgcGF0aWVudElkOiBwYXRpZW50SWRJbmRleCAhPT0gLTEgPyByb3dbcGF0aWVudElkSW5kZXhdIHx8ICdLaMO0bmcgY8OzJyA6ICdLaMO0bmcgY8OzJywNCiAgICAgICAgICAgICAgICAgICAgcGF0aWVudEFnZTogcGF0aWVudGFnZUluZGV4ICE9PSAtMSA/IHJvd1twYXRpZW50YWdlSW5kZXhdIHx8ICdLaMO0bmcgY8OzJyA6ICdLaMO0bmcgY8OzJywgICAgIA0KCQkJCQlwcm9jZWR1cmU6IHByb2NlZHVyZU5hbWUsDQogICAgICAgICAgICAgICAgICAgIG9wZXJhdG9yOiBvcGVyYXRvckluZGV4ICE9PSAtMSA/IHJvd1tvcGVyYXRvckluZGV4XSB8fCAnS2jDtG5nIGPDsycgOiAnS2jDtG5nIGPDsycsDQogICAgICAgICAgICAgICAgICAgIGRhdGU6IHN0YXJ0Py5kYXRlS2V5IHx8ICdLaMO0bmcgeMOhYyDEkeG7i25oJywNCiAgICAgICAgICAgICAgICAgICAgc3RhcnRUaW1lOiBzdGFydD8uZGlzcGxheVRpbWUgfHwgJz8/JywNCiAgICAgICAgICAgICAgICAgICAgZW5kVGltZTogZW5kPy5kaXNwbGF5VGltZSB8fCAnPz8nLA0KICAgICAgICAgICAgICAgICAgICBtYWNoaW5lQ29kZTogbWFjaGluZUNvZGUsDQogICAgICAgICAgICAgICAgICAgIGV4cGVjdGVkQ29kZXM6IGV4cGVjdGVkQ29kZXMuam9pbignIGhv4bq3YyAnKSwNCiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogZXJyb3JNZXNzYWdlIC8vIFPhu60gZOG7pW5nIHRow7RuZyBiw6FvIGPhu6UgdGjhu4MNCiAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYEzhu5dpIGtp4buDbSB0cmEgbcOheSBkw7JuZyAke3Jvd051bWJlcn06YCwgZXJyb3IpOw0KICAgICAgICB9DQogICAgfSk7DQp9DQoNCi8vIEjDoG0ga2nhu4NtIHRyYSB4dW5nIMSR4buZdCBtw6F5DQpmdW5jdGlvbiBjaGVja01hY2hpbmVDb25mbGljdHMocHJvY2VkdXJlcywganNvbkRhdGEpIHsNCiAgICBtYWNoaW5lQ29uZmxpY3RMb2cgPSBbXTsNCiAgICANCiAgICBjb25zdCBoZWFkZXJMaW5lMSA9IGpzb25EYXRhWzddIHx8IFtdOw0KICAgIGNvbnN0IGhlYWRlckxpbmUyID0ganNvbkRhdGFbOF0gfHwgW107DQogICAgY29uc3QgY29tYmluZWRIZWFkZXJzID0gaGVhZGVyTGluZTEubWFwKChjb2wsIGluZGV4KSA9PiANCiAgICAgICAgKGNvbCArICcgJyArIChoZWFkZXJMaW5lMltpbmRleF0gfHwgJycpKS50cmltKCkNCiAgICApOw0KDQogICAgLy8gVMOsbSBj4buZdCBtw6MgbcOheQ0KICAgIGNvbnN0IG1hY2hpbmVDb2RlSW5kZXggPSBjb21iaW5lZEhlYWRlcnMuZmluZEluZGV4KGggPT4gDQogICAgICAgIGguaW5jbHVkZXMoIk3DoyBtw6F5IikgfHwgaC5pbmNsdWRlcygiTcOjIG3DoXkgdGhlbyB0aOG7pyB0aHXhuq10IikNCiAgICApOw0KICAgIA0KICAgIGlmIChtYWNoaW5lQ29kZUluZGV4ID09PSAtMSkgew0KICAgICAgICBjb25zb2xlLmxvZygiS2jDtG5nIHTDrG0gdGjhuqV5IGPhu5l0IG3DoyBtw6F5Iik7DQogICAgICAgIHJldHVybjsNCiAgICB9DQoNCiAgICBjb25zdCByb3dzID0ganNvbkRhdGEuc2xpY2UoOSk7DQogICAgY29uc3QgbWFjaGluZVByb2NlZHVyZXMgPSBbXTsNCiAgICANCiAgICAvLyBM4buNYyBjw6FjIHRo4bunIHRodeG6rXQgY8OzIHPhu60gZOG7pW5nIG3DoXkNCiAgICByb3dzLmZvckVhY2goKHJvdywgaW5kZXgpID0+IHsNCiAgICAgICAgY29uc3Qgcm93TnVtYmVyID0gaW5kZXggKyAxMDsNCiAgICAgICAgDQogICAgICAgIHRyeSB7DQogICAgICAgICAgICBpZiAoIXJvdyB8fCByb3cubGVuZ3RoID09PSAwKSByZXR1cm47DQogICAgICAgICAgICANCiAgICAgICAgICAgIGNvbnN0IHByb2NlZHVyZU5hbWUgPSByb3dbY29tYmluZWRIZWFkZXJzLmZpbmRJbmRleChoID0+IGguaW5jbHVkZXMoIlRo4bunIHRodeG6rXQiKSldOw0KICAgICAgICAgICAgaWYgKCFwcm9jZWR1cmVOYW1lIHx8ICFQUk9DRURVUkVTW3Byb2NlZHVyZU5hbWVdKSByZXR1cm47DQogICAgICAgICAgICANCiAgICAgICAgICAgIGNvbnN0IHByb2NlZHVyZUluZm8gPSBQUk9DRURVUkVTW3Byb2NlZHVyZU5hbWVdOw0KICAgICAgICAgICAgaWYgKCFwcm9jZWR1cmVJbmZvLm1hY2hpbmVDb2RlKSByZXR1cm47DQogICAgICAgICAgICANCiAgICAgICAgICAgIGNvbnN0IG1hY2hpbmVDb2RlID0gKHJvd1ttYWNoaW5lQ29kZUluZGV4XSB8fCAnJykudG9TdHJpbmcoKS50cmltKCk7DQogICAgICAgICAgICBpZiAoIW1hY2hpbmVDb2RlKSByZXR1cm47DQogICAgIA0KICAgICAgICAgICAgY29uc3QgbmFtZUluZGV4ID0gY29tYmluZWRIZWFkZXJzLmZpbmRJbmRleChoID0+IGguaW5jbHVkZXMoIkjhu40gdMOqbiIpKTsNCgkJICAgIGNvbnN0IHBhdGllbnRJZEluZGV4ID0gY29tYmluZWRIZWFkZXJzLmZpbmRJbmRleChoID0+IGguaW5jbHVkZXMoIk3DoyBCTiIpKTsNCgkJCWNvbnN0IHBhdGllbnRhZ2VJbmRleCA9IGNvbWJpbmVkSGVhZGVycy5maW5kSW5kZXgoaCA9PiBoLmluY2x1ZGVzKCJUdeG7lWkiKSk7DQogICAgICAgICAgICBjb25zdCBvcGVyYXRvckluZGV4ID0gY29tYmluZWRIZWFkZXJzLmZpbmRJbmRleChoID0+IGguaW5jbHVkZXMoIlRo4bunIHRodeG6rXQgY2jDrW5oIikpOw0KICAgICAgICAgICAgY29uc3Qgc3RhcnRJbmRleCA9IGNvbWJpbmVkSGVhZGVycy5maW5kSW5kZXgoaCA9PiBoLmluY2x1ZGVzKCJUaOG7nWkgZ2lhbiBi4bqvdCDEkeG6p3UgdGjhu7FjIGhp4buHbiIpKTsNCiAgICAgICAgICAgIGNvbnN0IGVuZEluZGV4ID0gY29tYmluZWRIZWFkZXJzLmZpbmRJbmRleChoID0+IGguaW5jbHVkZXMoIlRo4budaSBnaWFuIGvhur90IHRow7pjIikpOw0KICAgICAgICAgICAgDQogICAgICAgICAgICBjb25zdCBzdGFydCA9IHBhcnNlRGF0ZVRpbWUocm93W3N0YXJ0SW5kZXhdLCByb3dOdW1iZXIpOw0KICAgICAgICAgICAgY29uc3QgZW5kID0gcGFyc2VEYXRlVGltZShyb3dbZW5kSW5kZXhdLCByb3dOdW1iZXIpOw0KICAgICAgICAgICAgDQogICAgICAgICAgICBpZiAoc3RhcnQgJiYgZW5kKSB7DQogICAgICAgICAgICAgICAgbWFjaGluZVByb2NlZHVyZXMucHVzaCh7DQogICAgICAgICAgICAgICAgICAgIHJvd051bWJlcjogcm93TnVtYmVyLA0KICAgICAgICAgICAgICAgICAgICBwYXRpZW50TmFtZTogbmFtZUluZGV4ICE9PSAtMSA/IHJvd1tuYW1lSW5kZXhdIHx8ICdLaMO0bmcgY8OzJyA6ICdLaMO0bmcgY8OzJywNCgkJCQkJcGF0aWVudElkOiBwYXRpZW50SWRJbmRleCAhPT0gLTEgPyByb3dbcGF0aWVudElkSW5kZXhdIHx8ICdLaMO0bmcgY8OzJyA6ICdLaMO0bmcgY8OzJywNCgkJCQkJcGF0aWVudEFnZTogcGF0aWVudGFnZUluZGV4ICE9PSAtMSA/IHJvd1twYXRpZW50YWdlSW5kZXhdIHx8ICdLaMO0bmcgY8OzJyA6ICdLaMO0bmcgY8OzJywNCiAgICAgICAgICAgICAgICAgICAgcHJvY2VkdXJlOiBwcm9jZWR1cmVOYW1lLA0KICAgICAgICAgICAgICAgICAgICBvcGVyYXRvcjogb3BlcmF0b3JJbmRleCAhPT0gLTEgPyByb3dbb3BlcmF0b3JJbmRleF0gfHwgJ0tow7RuZyBjw7MnIDogJ0tow7RuZyBjw7MnLA0KICAgICAgICAgICAgICAgICAgICBkYXRlOiBzdGFydC5kYXRlS2V5LA0KICAgICAgICAgICAgICAgICAgICBzdGFydDogc3RhcnQuc2Vjb25kcywNCiAgICAgICAgICAgICAgICAgICAgZW5kOiBlbmQuc2Vjb25kcywNCiAgICAgICAgICAgICAgICAgICAgZGlzcGxheVN0YXJ0OiBzdGFydC5kaXNwbGF5VGltZSwNCiAgICAgICAgICAgICAgICAgICAgZGlzcGxheUVuZDogZW5kLmRpc3BsYXlUaW1lLA0KICAgICAgICAgICAgICAgICAgICBtYWNoaW5lQ29kZTogbWFjaGluZUNvZGUsDQogICAgICAgICAgICAgICAgICAgIHByb2NlZHVyZUluZm86IHByb2NlZHVyZUluZm8NCiAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYEzhu5dpIHjhu60gbMO9IG3DoXkgZMOybmcgJHtyb3dOdW1iZXJ9OmAsIGVycm9yKTsNCiAgICAgICAgfQ0KICAgIH0pOw0KICAgIA0KICAgIC8vIEtp4buDbSB0cmEgeHVuZyDEkeG7mXQgdGhlbyB04burbmcgbcOheSBWw4AgdOG7q25nIG5nw6B5DQogICAgY29uc3QgbWFjaGluZUdyb3VwcyA9IHt9Ow0KICAgIA0KICAgIG1hY2hpbmVQcm9jZWR1cmVzLmZvckVhY2gocHJvYyA9PiB7DQogICAgICAgIGNvbnN0IGtleSA9IGAke3Byb2MubWFjaGluZUNvZGV9XyR7cHJvYy5kYXRlfWA7IC8vIEvhur90IGjhu6NwIG3DoyBtw6F5ICsgbmfDoHkNCiAgICAgICAgaWYgKCFtYWNoaW5lR3JvdXBzW2tleV0pIHsNCiAgICAgICAgICAgIG1hY2hpbmVHcm91cHNba2V5XSA9IFtdOw0KICAgICAgICB9DQogICAgICAgIG1hY2hpbmVHcm91cHNba2V5XS5wdXNoKHByb2MpOw0KICAgIH0pOw0KICAgIA0KICAgIE9iamVjdC52YWx1ZXMobWFjaGluZUdyb3VwcykuZm9yRWFjaChwcm9jZWR1cmVzID0+IHsNCiAgICAgICAgaWYgKHByb2NlZHVyZXMubGVuZ3RoIDwgMikgcmV0dXJuOw0KICAgICAgICANCiAgICAgICAgcHJvY2VkdXJlcy5zb3J0KChhLCBiKSA9PiBhLnN0YXJ0IC0gYi5zdGFydCk7DQogICAgICAgIA0KICAgICAgICBmb3IgKGxldCBpID0gMTsgaSA8IHByb2NlZHVyZXMubGVuZ3RoOyBpKyspIHsNCiAgICAgICAgICAgIGNvbnN0IHByZXYgPSBwcm9jZWR1cmVzW2kgLSAxXTsNCiAgICAgICAgICAgIGNvbnN0IGN1cnJlbnQgPSBwcm9jZWR1cmVzW2ldOw0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyBLaeG7g20gdHJhIHhlbSBjw7MgeHVuZyDEkeG7mXQgdGjhu51pIGdpYW4ga2jDtG5nDQogICAgICAgICAgICBpZiAoY3VycmVudC5zdGFydCA8IHByZXYuZW5kKSB7DQogICAgICAgICAgICAgICAgbWFjaGluZUNvbmZsaWN0TG9nLnB1c2goew0KICAgICAgICAgICAgICAgICAgICBtYWNoaW5lQ29kZTogcHJldi5tYWNoaW5lQ29kZSwNCiAgICAgICAgICAgICAgICAgICAgZGF0ZTogcHJldi5kYXRlLCAvLyBUaMOqbSBuZ8OgeSDEkeG7gyBoaeG7g24gdGjhu4sNCiAgICAgICAgICAgICAgICAgICAgY29uZmxpY3RQcm9jZWR1cmVzOiBbcHJldiwgY3VycmVudF0sDQogICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IGBNw6F5ICR7cHJldi5tYWNoaW5lQ29kZX0gxJHGsOG7o2Mgc+G7rSBk4bulbmcgxJHhu5NuZyB0aOG7nWkgY2hvIG5oaeG7gXUgYuG7h25oIG5ow6JuIHRyb25nIG5nw6B5ICR7cHJldi5kYXRlfWANCiAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0pOw0KfQ0KZnVuY3Rpb24gY2hlY2tNaXNzaW5nTWFjaGluZUNvZGVzKHByb2NlZHVyZXMsIGpzb25EYXRhKSB7DQogICAgbWlzc2luZ01hY2hpbmVMb2cgPSBbXTsNCiAgICANCiAgICBjb25zdCBoZWFkZXJMaW5lMSA9IGpzb25EYXRhWzddIHx8IFtdOw0KICAgIGNvbnN0IGhlYWRlckxpbmUyID0ganNvbkRhdGFbOF0gfHwgW107DQogICAgY29uc3QgY29tYmluZWRIZWFkZXJzID0gaGVhZGVyTGluZTEubWFwKChjb2wsIGluZGV4KSA9PiANCiAgICAgICAgKGNvbCArICcgJyArIChoZWFkZXJMaW5lMltpbmRleF0gfHwgJycpKS50cmltKCkNCiAgICApOw0KDQogICAgLy8gVMOsbSBj4buZdCBtw6MgbcOheQ0KICAgIGNvbnN0IG1hY2hpbmVDb2RlSW5kZXggPSBjb21iaW5lZEhlYWRlcnMuZmluZEluZGV4KGggPT4gDQogICAgICAgIGguaW5jbHVkZXMoIk3DoyBtw6F5IikgfHwgaC5pbmNsdWRlcygiTcOjIG3DoXkgdGhlbyB0aOG7pyB0aHXhuq10IikNCiAgICApOw0KICAgIA0KICAgIGlmIChtYWNoaW5lQ29kZUluZGV4ID09PSAtMSkgew0KICAgICAgICBjb25zb2xlLmxvZygiS2jDtG5nIHTDrG0gdGjhuqV5IGPhu5l0IG3DoyBtw6F5IHRyb25nIGZpbGUgRXhjZWwiKTsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCg0KICAgIC8vIFTDrG0gY8OhYyBj4buZdCBraMOhYyBj4bqnbiB0aGnhur90DQogICAgY29uc3QgcHJvY2VkdXJlSW5kZXggPSBjb21iaW5lZEhlYWRlcnMuZmluZEluZGV4KGggPT4gaC5pbmNsdWRlcygiVGjhu6cgdGh14bqtdCIpKTsNCiAgICBjb25zdCBuYW1lSW5kZXggPSBjb21iaW5lZEhlYWRlcnMuZmluZEluZGV4KGggPT4gaC5pbmNsdWRlcygiSOG7jSB0w6puIikpOw0KCWNvbnN0IHBhdGllbnRJZEluZGV4ID0gY29tYmluZWRIZWFkZXJzLmZpbmRJbmRleChoID0+IGguaW5jbHVkZXMoIk3DoyBCTiIpKTsNCgljb25zdCBwYXRpZW50YWdlSW5kZXggPSBjb21iaW5lZEhlYWRlcnMuZmluZEluZGV4KGggPT4gaC5pbmNsdWRlcygiVHXhu5VpIikpOw0KICAgIGNvbnN0IG9wZXJhdG9ySW5kZXggPSBjb21iaW5lZEhlYWRlcnMuZmluZEluZGV4KGggPT4gaC5pbmNsdWRlcygiVGjhu6cgdGh14bqtdCBjaMOtbmgiKSk7DQogICAgY29uc3Qgc3RhcnRJbmRleCA9IGNvbWJpbmVkSGVhZGVycy5maW5kSW5kZXgoaCA9PiBoLmluY2x1ZGVzKCJUaOG7nWkgZ2lhbiBi4bqvdCDEkeG6p3UgdGjhu7FjIGhp4buHbiIpKTsNCiAgICBjb25zdCBlbmRJbmRleCA9IGNvbWJpbmVkSGVhZGVycy5maW5kSW5kZXgoaCA9PiBoLmluY2x1ZGVzKCJUaOG7nWkgZ2lhbiBr4bq/dCB0aMO6YyIpKTsNCiAgICBjb25zdCBkYXRlSW5kZXggPSBjb21iaW5lZEhlYWRlcnMuZmluZEluZGV4KGggPT4gaC5pbmNsdWRlcygiTmfDoHkgdGjhu7FjIGhp4buHbiIpKTsNCg0KICAgIGNvbnN0IHJvd3MgPSBqc29uRGF0YS5zbGljZSg5KTsNCiAgICANCiAgICAvLyBEYW5oIHPDoWNoIHRo4bunIHRodeG6rXQgY+G6p24ga2nhu4NtIHRyYSBtw6MgbcOheQ0KICAgIGNvbnN0IHByb2NlZHVyZXNUb0NoZWNrID0gWw0KICAgICAgICAixJFp4buHbiBjaMOibSBba2ltIG5n4bqvbl0iLA0KICAgICAgICAixJFp4buBdSB0cuG7iyBi4bqxbmcgdGlhIGjhu5NuZyBuZ2/huqFpIiwgDQogICAgICAgICJnacOhYyBoxqFpIg0KICAgIF07DQogICAgDQogICAgcm93cy5mb3JFYWNoKChyb3csIGluZGV4KSA9PiB7DQogICAgICAgIGNvbnN0IHJvd051bWJlciA9IGluZGV4ICsgMTA7DQogICAgICAgIA0KICAgICAgICB0cnkgew0KICAgICAgICAgICAgaWYgKCFyb3cgfHwgcm93Lmxlbmd0aCA9PT0gMCkgcmV0dXJuOw0KICAgICAgICAgICAgDQogICAgICAgICAgICBjb25zdCBwcm9jZWR1cmVOYW1lID0gKHJvd1twcm9jZWR1cmVJbmRleF0gfHwgJycpLnRvU3RyaW5nKCkudHJpbSgpOw0KICAgICAgICAgICAgaWYgKCFwcm9jZWR1cmVOYW1lKSByZXR1cm47DQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIEtp4buDbSB0cmEgeGVtIHRo4bunIHRodeG6rXQgY8OzIHRyb25nIGRhbmggc8OhY2ggY+G6p24ga2nhu4NtIHRyYSBraMO0bmcNCiAgICAgICAgICAgIGNvbnN0IHNob3VsZENoZWNrID0gcHJvY2VkdXJlc1RvQ2hlY2suc29tZShwcm9jID0+IA0KICAgICAgICAgICAgICAgIHByb2NlZHVyZU5hbWUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhwcm9jLnRvTG93ZXJDYXNlKCkpDQogICAgICAgICAgICApOw0KICAgICAgICAgICAgDQogICAgICAgICAgICBpZiAoIXNob3VsZENoZWNrKSByZXR1cm47DQogICAgICAgICAgICANCiAgICAgICAgICAgIGNvbnN0IG1hY2hpbmVDb2RlID0gKHJvd1ttYWNoaW5lQ29kZUluZGV4XSB8fCAnJykudG9TdHJpbmcoKS50cmltKCk7DQogICAgICAgICAgICBjb25zdCBwcm9jZWR1cmVEYXRlID0gZGF0ZUluZGV4ICE9PSAtMSA/IChyb3dbZGF0ZUluZGV4XSB8fCAnJykudG9TdHJpbmcoKS50cmltKCkgOiAnJzsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gTuG6v3UgbcOjIG3DoXkgdHLhu5FuZyB0aMOsIGLDoW8gbOG7l2kNCiAgICAgICAgICAgIGlmICghbWFjaGluZUNvZGUpIHsNCiAgICAgICAgICAgICAgICBjb25zdCBzdGFydCA9IHBhcnNlRGF0ZVRpbWUocm93W3N0YXJ0SW5kZXhdLCByb3dOdW1iZXIpOw0KICAgICAgICAgICAgICAgIGNvbnN0IGVuZCA9IHBhcnNlRGF0ZVRpbWUocm93W2VuZEluZGV4XSwgcm93TnVtYmVyKTsNCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICBtaXNzaW5nTWFjaGluZUxvZy5wdXNoKHsNCiAgICAgICAgICAgICAgICAgICAgcm93TnVtYmVyOiByb3dOdW1iZXIsDQogICAgICAgICAgICAgICAgICAgIHBhdGllbnROYW1lOiBuYW1lSW5kZXggIT09IC0xID8gcm93W25hbWVJbmRleF0gfHwgJ0tow7RuZyBjw7MnIDogJ0tow7RuZyBjw7MnLA0KCQkJCQlwYXRpZW50SWQ6IHBhdGllbnRJZEluZGV4ICE9PSAtMSA/IHJvd1twYXRpZW50SWRJbmRleF0gfHwgJ0tow7RuZyBjw7MnIDogJ0tow7RuZyBjw7MnLA0KCQkJCQlwYXRpZW50QWdlOiBwYXRpZW50YWdlSW5kZXggIT09IC0xID8gcm93W3BhdGllbnRhZ2VJbmRleF0gfHwgJ0tow7RuZyBjw7MnIDogJ0tow7RuZyBjw7MnLA0KICAgICAgICAgICAgICAgICAgICBwcm9jZWR1cmU6IHByb2NlZHVyZU5hbWUsDQogICAgICAgICAgICAgICAgICAgIG9wZXJhdG9yOiBvcGVyYXRvckluZGV4ICE9PSAtMSA/IHJvd1tvcGVyYXRvckluZGV4XSB8fCAnS2jDtG5nIGPDsycgOiAnS2jDtG5nIGPDsycsDQogICAgICAgICAgICAgICAgICAgIGRhdGU6IHByb2NlZHVyZURhdGUgfHwgc3RhcnQ/LmRhdGVLZXkgfHwgJ0tow7RuZyB4w6FjIMSR4buLbmgnLA0KICAgICAgICAgICAgICAgICAgICBzdGFydFRpbWU6IHN0YXJ0Py5kaXNwbGF5VGltZSB8fCAnPz8nLA0KICAgICAgICAgICAgICAgICAgICBlbmRUaW1lOiBlbmQ/LmRpc3BsYXlUaW1lIHx8ICc/PycsDQogICAgICAgICAgICAgICAgICAgIG1hY2hpbmVDb2RlOiBtYWNoaW5lQ29kZQ0KICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYEzhu5dpIGtp4buDbSB0cmEgbcOjIG3DoXkgZMOybmcgJHtyb3dOdW1iZXJ9OmAsIGVycm9yKTsNCiAgICAgICAgfQ0KICAgIH0pOw0KfQ0KDQovLyBIw6BtIGhp4buDbiB0aOG7iyBs4buXaSBn4bqvbiBzYWkgbcOheQ0KZnVuY3Rpb24gZGlzcGxheU1hY2hpbmVFcnJvcnMoKSB7DQogICAgY29uc3QgbWFjaGluZUVycm9yTG9nRGl2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hY2hpbmVFcnJvckxvZycpOw0KICAgIGNvbnN0IG1hY2hpbmVFcnJvclNlY3Rpb24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFjaGluZUVycm9yU2VjdGlvbicpOw0KICAgIA0KICAgIGlmIChtYWNoaW5lRXJyb3JMb2cubGVuZ3RoID09PSAwKSB7DQogICAgICAgIG1hY2hpbmVFcnJvckxvZ0Rpdi5pbm5lckhUTUwgPSAnPHA+S2jDtG5nIGPDsyBs4buXaSBn4bqvbiBzYWkgbcOheSBuw6BvIMSRxrDhu6NjIGdoaSBuaOG6rW48L3A+JzsNCiAgICAgICAgbWFjaGluZUVycm9yU2VjdGlvbi5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOw0KICAgICAgICByZXR1cm47DQogICAgfQ0KICAgIA0KICAgIGxldCBodG1sID0gYA0KICAgIDx0YWJsZSBjbGFzcz0iZXJyb3ItdGFibGUiPg0KICAgICAgICA8dGhlYWQ+DQogICAgICAgICAgICA8dHI+DQogICAgICAgICAgICAgICAgPHRoPjxpIGNsYXNzPSJmYXMgZmEtdXNlciBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gVMOqbiBCTjwvdGg+DQogICAgICAgICAgICAgICAgPHRoPjxpIGNsYXNzPSJmYXMgZmEtcHJvY2VkdXJlcyBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gVGjhu6cgdGh14bqtdDwvdGg+DQogICAgICAgICAgICAgICAgPHRoPjxpIGNsYXNzPSJmYXMgZmEtdXNlci1udXJzZSBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gTmfGsOG7nWkgdGjhu7FjIGhp4buHbjwvdGg+DQogICAgICAgICAgICAgICAgPHRoPjxpIGNsYXNzPSJmYXIgZmEtY2xvY2sgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IFRo4budaSBnaWFuPC90aD4NCiAgICAgICAgICAgICAgICA8dGg+PGkgY2xhc3M9ImZhcyBmYS1taWNyb2NoaXAgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IE3DoyBtw6F5PC90aD4NCiAgICAgICAgICAgICAgICA8dGg+PGkgY2xhc3M9ImZhcyBmYS1leGNsYW1hdGlvbi10cmlhbmdsZSBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gTOG7l2k8L3RoPg0KICAgICAgICAgICAgPC90cj4NCiAgICAgICAgPC90aGVhZD4NCiAgICAgICAgPHRib2R5PmA7DQogICAgDQogICAgbWFjaGluZUVycm9yTG9nLmZvckVhY2goZXJyb3IgPT4gew0KICAgICAgICBodG1sICs9IGANCiAgICAgICAgPHRyIGNsYXNzPSJlcnJvci1yb3ciPg0KICAgICAgICAgICAgPHRkPiR7ZXJyb3IucGF0aWVudE5hbWV9IFs8Zm9udCBjb2xvcj0icmVkIj4ke2Vycm9yLnBhdGllbnRBZ2V9PC9mb250Pl08YnIvPiR7ZXJyb3IucGF0aWVudElkfTwvdGQ+DQogICAgICAgICAgICA8dGQ+JHtlcnJvci5wcm9jZWR1cmV9PC90ZD4NCiAgICAgICAgICAgIDx0ZD4ke2Vycm9yLm9wZXJhdG9yLnJlcGxhY2UoLywvZywgJycpfTwvdGQ+DQogICAgICAgICAgICA8dGQ+PGNlbnRlcj4ke2Vycm9yLmRhdGV9PGJyLz4ke2Vycm9yLnN0YXJ0VGltZX0g4oaSICR7ZXJyb3IuZW5kVGltZX08L2NlbnRlcj48L3RkPg0KICAgICAgICAgICAgPHRkPiR7ZXJyb3IubWFjaGluZUNvZGV9PC90ZD4NCiAgICAgICAgICAgIDx0ZCBjbGFzcz0iZXJyb3ItZGV0YWlsIj4NCiAgICAgICAgICAgICAgICAke2Vycm9yLm1lc3NhZ2V9IDwhLS0gxJDDoyDEkcaw4bujYyBj4bqtcCBuaOG6rXQgduG7m2kgdGjDtG5nIGLDoW8gY+G7pSB0aOG7gyAtLT4NCiAgICAgICAgICAgIDwvdGQ+DQogICAgICAgIDwvdHI+YDsNCiAgICB9KTsNCiAgICANCiAgICBodG1sICs9IGA8L3Rib2R5PjwvdGFibGU+YDsNCiAgICANCiAgICBtYWNoaW5lRXJyb3JMb2dEaXYuaW5uZXJIVE1MID0gaHRtbDsNCiAgICBtYWNoaW5lRXJyb3JTZWN0aW9uLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOw0KICAgIA0KICAgIC8vIEPhuq1wIG5o4bqtdCBkcm9wZG93biBs4buNYw0KICAgIHVwZGF0ZU1hY2hpbmVPcGVyYXRvckZpbHRlcigpOw0KfQ0KDQovLyBIw6BtIGhp4buDbiB0aOG7iyB4dW5nIMSR4buZdCBtw6F5DQpmdW5jdGlvbiBkaXNwbGF5TWFjaGluZUNvbmZsaWN0cygpIHsNCiAgICBjb25zdCBtYWNoaW5lQ29uZmxpY3RMb2dEaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFjaGluZUNvbmZsaWN0TG9nJyk7DQogICAgY29uc3QgbWFjaGluZUNvbmZsaWN0U2VjdGlvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYWNoaW5lQ29uZmxpY3RTZWN0aW9uJyk7DQogICAgDQogICAgaWYgKG1hY2hpbmVDb25mbGljdExvZy5sZW5ndGggPT09IDApIHsNCiAgICAgICAgbWFjaGluZUNvbmZsaWN0TG9nRGl2LmlubmVySFRNTCA9ICc8cD5LaMO0bmcgY8OzIHh1bmcgxJHhu5l0IG3DoXkgbsOgbyDEkcaw4bujYyBnaGkgbmjhuq1uPC9wPic7DQogICAgICAgIG1hY2hpbmVDb25mbGljdFNlY3Rpb24uc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCiAgICANCiAgICBsZXQgaHRtbCA9IGANCiAgICA8dGFibGUgY2xhc3M9ImVycm9yLXRhYmxlIj4NCiAgICAgICAgPHRoZWFkPg0KICAgICAgICAgICAgPHRyPg0KICAgICAgICAgICAgICAgIDx0aD48aSBjbGFzcz0iZmFzIGZhLW1pY3JvY2hpcCBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gTcOheTwvdGg+DQogICAgICAgICAgICAgICAgPHRoPjxpIGNsYXNzPSJmYXMgZmEtdXNlciBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gVMOqbiBCTjwvdGg+DQogICAgICAgICAgICAgICAgPHRoPjxpIGNsYXNzPSJmYXMgZmEtcHJvY2VkdXJlcyBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gVGjhu6cgdGh14bqtdDwvdGg+DQogICAgICAgICAgICAgICAgPHRoPjxpIGNsYXNzPSJmYXIgZmEtY2xvY2sgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IFRo4budaSBnaWFuPC90aD4NCiAgICAgICAgICAgICAgICA8dGg+PGkgY2xhc3M9ImZhcyBmYS11c2VyLW51cnNlIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBOZ8aw4budaSB0aOG7sWMgaGnhu4duPC90aD4NCgkJCQk8dGg+PGkgY2xhc3M9ImZhciBmYS1jbG9jayBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gR+G7o2kgw70gZ2nhu508L3RoPg0KICAgICAgICAgICAgPC90cj4NCiAgICAgICAgPC90aGVhZD4NCiAgICAgICAgPHRib2R5PmA7DQogICAgDQogICAgbWFjaGluZUNvbmZsaWN0TG9nLmZvckVhY2goY29uZmxpY3QgPT4gew0KICAgICAgICANCgkJLy9UaMOqbSBkw7JuZyB0aMO0bmcgdGluIHbhu4EgbcOheSB2w6AgbmfDoHkgeHVuZyDEkeG7mXQgY2jGsGEgbOG7jWMNCiAgICAgICAvLyBodG1sICs9IGANCiAgICAgLy8gPHRyIGNsYXNzPSJlcnJvci1yb3ciIHN0eWxlPSJiYWNrZ3JvdW5kLWNvbG9yOiAjZmZmM2NkOyI+DQogICAgICAvLyAgICAgPHRkIGNvbHNwYW49IjUiIHN0eWxlPSJ0ZXh0LWFsaWduOiBjZW50ZXI7IGZvbnQtd2VpZ2h0OiBib2xkOyBjb2xvcjogIzg1NjQwNDsiPg0KICAgICAgIC8vICAgICAgIDxpIGNsYXNzPSJmYXMgZmEtZXhjbGFtYXRpb24tdHJpYW5nbGUiPjwvaT4gDQogICAgICAgLy8gICAgICBYVU5HIMSQ4buYVCBNw4FZOiAke2NvbmZsaWN0Lm1hY2hpbmVDb2RlfSAtIE5Hw4BZOiAke2NvbmZsaWN0LmRhdGV9DQogICAgIC8vICAgICAgIDwvdGQ+DQogICAgIC8vLyAgIDwvdHI+YDsNCiAgICAgICANCiAgICAgICAgY29uZmxpY3QuY29uZmxpY3RQcm9jZWR1cmVzLmZvckVhY2goKHByb2MsIGluZGV4KSA9PiB7DQogICAgICAgICAgICBodG1sICs9IGANCiAgICAgICAgICAgIDx0ciBjbGFzcz0iZXJyb3Itcm93Ij4NCiAgICAgICAgICAgICAgICAke2luZGV4ID09PSAwID8gYDx0ZCByb3dzcGFuPSIke2NvbmZsaWN0LmNvbmZsaWN0UHJvY2VkdXJlcy5sZW5ndGh9Ij4ke2NvbmZsaWN0Lm1hY2hpbmVDb2RlfTwvdGQ+YCA6ICcnfQ0KICAgICAgICAgICAgICAgIDx0ZD4ke3Byb2MucGF0aWVudE5hbWV9IFs8Zm9udCBjb2xvcj0icmVkIj4ke3Byb2MucGF0aWVudEFnZX08L2ZvbnQ+XTxici8+JHtwcm9jLnBhdGllbnRJZH08L3RkPg0KICAgICAgICAgICAgICAgIDx0ZD4ke3Byb2MucHJvY2VkdXJlfTwvdGQ+DQogICAgICAgICAgICAgICAgPHRkPjxjZW50ZXI+JHtjb25mbGljdC5kYXRlfSA8YnIvPiR7cHJvYy5kaXNwbGF5U3RhcnR9IOKGkiAke3Byb2MuZGlzcGxheUVuZH08L2NlbnRlcj48L3RkPg0KICAgICAgICAgICAgICAgIDx0ZD4ke3Byb2Mub3BlcmF0b3IucmVwbGFjZSgvLC9nLCAnJyl9PC90ZD4NCiAgICAgICAgICAgJHtpbmRleCA9PT0gMCA/IGA8dGQgcm93c3Bhbj0iJHtjb25mbGljdC5jb25mbGljdFByb2NlZHVyZXMubGVuZ3RofSIgY2xhc3M9InRpbWUtc3VnZ2VzdGlvbiIgaWQ9Im1hY2hpbmVTdWdnZXN0aW9uLSR7Y29uZmxpY3QubWFjaGluZUNvZGV9LSR7Y29uZmxpY3QuZGF0ZX0iPg0KICAgICAgICAgIA0KICAgICAgICAgICAgPC90ZD5gIDogJyd9DQogICAgICAgICAgICA8L3RyPmA7DQogICAgICAgIH0pOw0KICAgICAgICANCiAgICAgICAgLy8gVGjDqm0gZMOybmcgcGjDom4gY8OhY2ggZ2nhu69hIGPDoWMgbmjDs20geHVuZyDEkeG7mXQNCiAgICAgICAgaHRtbCArPSBgPHRyPjx0ZCBjb2xzcGFuPSI1IiBjbGFzcz0iZ3JvdXAtc2VwYXJhdG9yIj48L3RkPjwvdHI+YDsNCiAgICB9KTsNCiAgICANCiAgICBodG1sICs9IGA8L3Rib2R5PjwvdGFibGU+YDsNCiAgICANCiAgICBtYWNoaW5lQ29uZmxpY3RMb2dEaXYuaW5uZXJIVE1MID0gaHRtbDsNCiAgICBtYWNoaW5lQ29uZmxpY3RTZWN0aW9uLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOw0KICAgIA0KICAgIC8vIEPhuq1wIG5o4bqtdCBkcm9wZG93biBs4buNYw0KICAgIHVwZGF0ZU1hY2hpbmVDb25mbGljdE9wZXJhdG9yRmlsdGVyKCk7DQoJDQoJICBzZXRUaW1lb3V0KCgpID0+IHsNCiAgICAgICAgZ2VuZXJhdGVNYWNoaW5lVGltZVN1Z2dlc3Rpb25zKCk7DQogICAgfSwgMTAwKTsNCgkNCn0NCg0KLy8gQ+G6rXAgbmjhuq10IGRyb3Bkb3duIGzhu41jIGNobyBs4buXaSBtw6F5DQpmdW5jdGlvbiB1cGRhdGVNYWNoaW5lT3BlcmF0b3JGaWx0ZXIoKSB7DQogICAgY29uc3Qgb3BlcmF0b3JzID0gWy4uLm5ldyBTZXQobWFjaGluZUVycm9yTG9nLm1hcChlcnJvciA9PiBlcnJvci5vcGVyYXRvcikpXTsNCiAgICBjb25zdCBvcGVyYXRvclNlbGVjdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYWNoaW5lT3BlcmF0b3JTZWxlY3QnKTsNCiAgICANCiAgICBvcGVyYXRvclNlbGVjdC5pbm5lckhUTUwgPSAnPG9wdGlvbiB2YWx1ZT0iYWxsIj5U4bqldCBj4bqjPC9vcHRpb24+JyArIA0KICAgICAgICBvcGVyYXRvcnMubWFwKG9wID0+IGA8b3B0aW9uIHZhbHVlPSIke29wfSI+JHtvcC5yZXBsYWNlKC8sL2csICcnKX08L29wdGlvbj5gKS5qb2luKCcnKTsNCiAgICANCiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFjaGluZU9wZXJhdG9yRmlsdGVyJykuc3R5bGUuZGlzcGxheSA9IG9wZXJhdG9ycy5sZW5ndGggPiAwID8gJ2Jsb2NrJyA6ICdub25lJzsNCn0NCg0KLy8gQ+G6rXAgbmjhuq10IGRyb3Bkb3duIGzhu41jIGNobyB4dW5nIMSR4buZdCBtw6F5DQpmdW5jdGlvbiB1cGRhdGVNYWNoaW5lQ29uZmxpY3RPcGVyYXRvckZpbHRlcigpIHsNCiAgICBjb25zdCBvcGVyYXRvcnMgPSBbLi4ubmV3IFNldChtYWNoaW5lQ29uZmxpY3RMb2cuZmxhdE1hcChjb25mbGljdCA9PiANCiAgICAgICAgY29uZmxpY3QuY29uZmxpY3RQcm9jZWR1cmVzLm1hcChwcm9jID0+IHByb2Mub3BlcmF0b3IpDQogICAgKSldOw0KICAgIGNvbnN0IG9wZXJhdG9yU2VsZWN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hY2hpbmVDb25mbGljdE9wZXJhdG9yU2VsZWN0Jyk7DQogICAgDQogICAgb3BlcmF0b3JTZWxlY3QuaW5uZXJIVE1MID0gJzxvcHRpb24gdmFsdWU9ImFsbCI+VOG6pXQgY+G6ozwvb3B0aW9uPicgKyANCiAgICAgICAgb3BlcmF0b3JzLm1hcChvcCA9PiBgPG9wdGlvbiB2YWx1ZT0iJHtvcH0iPiR7b3AucmVwbGFjZSgvLC9nLCAnJyl9PC9vcHRpb24+YCkuam9pbignJyk7DQogICAgDQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hY2hpbmVDb25mbGljdE9wZXJhdG9yRmlsdGVyJykuc3R5bGUuZGlzcGxheSA9IG9wZXJhdG9ycy5sZW5ndGggPiAwID8gJ2Jsb2NrJyA6ICdub25lJzsNCn0NCg0KLy8gTOG7jWMgbOG7l2kgbcOheSB0aGVvIG5nxrDhu51pIHRo4buxYyBoaeG7h24NCmZ1bmN0aW9uIGZpbHRlck1hY2hpbmVFcnJvcnNCeU9wZXJhdG9yKCkgew0KICAgIGNvbnN0IG9wZXJhdG9yID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hY2hpbmVPcGVyYXRvclNlbGVjdCcpLnZhbHVlOw0KICAgIGNvbnN0IGZpbHRlcmVkRXJyb3JzID0gb3BlcmF0b3IgPT09ICdhbGwnIA0KICAgICAgICA/IG1hY2hpbmVFcnJvckxvZyANCiAgICAgICAgOiBtYWNoaW5lRXJyb3JMb2cuZmlsdGVyKGVycm9yID0+IGVycm9yLm9wZXJhdG9yLnJlcGxhY2UoLywvZywgJycpID09PSBvcGVyYXRvci5yZXBsYWNlKC8sL2csICcnKSk7DQogICAgDQogICAgZGlzcGxheUZpbHRlcmVkTWFjaGluZUVycm9ycyhmaWx0ZXJlZEVycm9ycyk7DQp9DQoNCi8vIEzhu41jIHh1bmcgxJHhu5l0IG3DoXkgdGhlbyBuZ8aw4budaSB0aOG7sWMgaGnhu4duDQpmdW5jdGlvbiBmaWx0ZXJNYWNoaW5lQ29uZmxpY3RzQnlPcGVyYXRvcigpIHsNCiAgICBjb25zdCBvcGVyYXRvciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYWNoaW5lQ29uZmxpY3RPcGVyYXRvclNlbGVjdCcpLnZhbHVlOw0KICAgIGNvbnN0IGZpbHRlcmVkQ29uZmxpY3RzID0gb3BlcmF0b3IgPT09ICdhbGwnIA0KICAgICAgICA/IG1hY2hpbmVDb25mbGljdExvZyANCiAgICAgICAgOiBtYWNoaW5lQ29uZmxpY3RMb2cuZmlsdGVyKGNvbmZsaWN0ID0+IA0KICAgICAgICAgICAgY29uZmxpY3QuY29uZmxpY3RQcm9jZWR1cmVzLnNvbWUocHJvYyA9PiANCiAgICAgICAgICAgICAgICBwcm9jLm9wZXJhdG9yLnJlcGxhY2UoLywvZywgJycpID09PSBvcGVyYXRvci5yZXBsYWNlKC8sL2csICcnKQ0KICAgICAgICAgICAgKQ0KICAgICAgICApOw0KICAgIA0KICAgIGRpc3BsYXlGaWx0ZXJlZE1hY2hpbmVDb25mbGljdHMoZmlsdGVyZWRDb25mbGljdHMpOw0KfQ0KDQovLyBIaeG7g24gdGjhu4sgbOG7l2kgbcOheSDEkcOjIGzhu41jDQpmdW5jdGlvbiBkaXNwbGF5RmlsdGVyZWRNYWNoaW5lRXJyb3JzKGZpbHRlcmVkRXJyb3JzKSB7DQogICAgY29uc3QgbWFjaGluZUVycm9yTG9nRGl2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hY2hpbmVFcnJvckxvZycpOw0KICAgIA0KICAgIGlmIChmaWx0ZXJlZEVycm9ycy5sZW5ndGggPT09IDApIHsNCiAgICAgICAgbWFjaGluZUVycm9yTG9nRGl2LmlubmVySFRNTCA9ICc8cD5LaMO0bmcgY8OzIGzhu5dpIGfhuq9uIHNhaSBtw6F5IG7DoG8gxJHGsOG7o2MgZ2hpIG5o4bqtbjwvcD4nOw0KICAgICAgICByZXR1cm47DQogICAgfQ0KICAgIA0KICAgIGxldCBodG1sID0gYA0KICAgIDx0YWJsZSBjbGFzcz0iZXJyb3ItdGFibGUiPg0KICAgICAgICA8dGhlYWQ+DQogICAgICAgICAgICA8dHI+DQogICAgICAgICAgICAgICAgPHRoPjxpIGNsYXNzPSJmYXMgZmEtdXNlciBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gVMOqbiBCTjwvdGg+DQogICAgICAgICAgICAgICAgPHRoPjxpIGNsYXNzPSJmYXMgZmEtcHJvY2VkdXJlcyBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gVGjhu6cgdGh14bqtdDwvdGg+DQogICAgICAgICAgICAgICAgPHRoPjxpIGNsYXNzPSJmYXMgZmEtdXNlci1udXJzZSBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gTmfGsOG7nWkgdGjhu7FjIGhp4buHbjwvdGg+DQogICAgICAgICAgICAgICAgPHRoPjxpIGNsYXNzPSJmYXIgZmEtY2xvY2sgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IFRo4budaSBnaWFuPC90aD4NCiAgICAgICAgICAgICAgICA8dGg+PGkgY2xhc3M9ImZhcyBmYS1taWNyb2NoaXAgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IE3DoyBtw6F5PC90aD4NCiAgICAgICAgICAgICAgICA8dGg+PGkgY2xhc3M9ImZhcyBmYS1leGNsYW1hdGlvbi10cmlhbmdsZSBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gTOG7l2k8L3RoPg0KICAgICAgICAgICAgPC90cj4NCiAgICAgICAgPC90aGVhZD4NCiAgICAgICAgPHRib2R5PmA7DQogICAgDQogICAgZmlsdGVyZWRFcnJvcnMuZm9yRWFjaChlcnJvciA9PiB7DQogICAgICAgIGh0bWwgKz0gYA0KICAgICAgICA8dHIgY2xhc3M9ImVycm9yLXJvdyI+DQogICAgICAgICAgICA8dGQ+JHtlcnJvci5wYXRpZW50TmFtZX0gWzxmb250IGNvbG9yPSJyZWQiPiR7ZXJyb3IucGF0aWVudEFnZX08L2ZvbnQ+XTxici8+JHtlcnJvci5wYXRpZW50SWR9PC90ZD4NCiAgICAgICAgICAgIDx0ZD4ke2Vycm9yLnByb2NlZHVyZX08L3RkPg0KICAgICAgICAgICAgPHRkPiR7ZXJyb3Iub3BlcmF0b3IucmVwbGFjZSgvLC9nLCAnJyl9PC90ZD4NCiAgICAgICAgICAgIDx0ZD48Y2VudGVyPiR7ZXJyb3IuZGF0ZX08YnIvPiR7ZXJyb3Iuc3RhcnRUaW1lfSDihpIgJHtlcnJvci5lbmRUaW1lfTwvY2VudGVyPjwvdGQ+DQogICAgICAgICAgICA8dGQ+JHtlcnJvci5tYWNoaW5lQ29kZX08L3RkPg0KICAgICAgICAgICAgPHRkIGNsYXNzPSJlcnJvci1kZXRhaWwiPg0KICAgICAgICAgICAgICAgICR7ZXJyb3IubWVzc2FnZX0gPCEtLSDEkMOjIMSRxrDhu6NjIGPhuq1wIG5o4bqtdCB24bubaSB0aMO0bmcgYsOhbyBj4bulIHRo4buDIC0tPg0KICAgICAgICAgICAgPC90ZD4NCiAgICAgICAgPC90cj5gOw0KICAgIH0pOw0KICAgIA0KICAgIGh0bWwgKz0gYDwvdGJvZHk+PC90YWJsZT5gOw0KICAgIA0KICAgIG1hY2hpbmVFcnJvckxvZ0Rpdi5pbm5lckhUTUwgPSBodG1sOw0KfQ0KDQovLyBIaeG7g24gdGjhu4sgeHVuZyDEkeG7mXQgbcOheSDEkcOjIGzhu41jDQpmdW5jdGlvbiBkaXNwbGF5RmlsdGVyZWRNYWNoaW5lQ29uZmxpY3RzKGZpbHRlcmVkQ29uZmxpY3RzKSB7DQogICAgY29uc3QgbWFjaGluZUNvbmZsaWN0TG9nRGl2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hY2hpbmVDb25mbGljdExvZycpOw0KICAgIA0KICAgIGlmIChmaWx0ZXJlZENvbmZsaWN0cy5sZW5ndGggPT09IDApIHsNCiAgICAgICAgbWFjaGluZUNvbmZsaWN0TG9nRGl2LmlubmVySFRNTCA9ICc8cD5LaMO0bmcgY8OzIHh1bmcgxJHhu5l0IG3DoXkgbsOgbyDEkcaw4bujYyBnaGkgbmjhuq1uPC9wPic7DQogICAgICAgIHJldHVybjsNCiAgICB9DQogICAgDQogICAgbGV0IGh0bWwgPSBgDQogICAgPHRhYmxlIGNsYXNzPSJlcnJvci10YWJsZSI+DQogICAgICAgIDx0aGVhZD4NCiAgICAgICAgICAgIDx0cj4NCiAgICAgICAgICAgICAgICA8dGg+PGkgY2xhc3M9ImZhcyBmYS1taWNyb2NoaXAgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IE3DoXk8L3RoPg0KICAgICAgICAgICAgICAgIDx0aD48aSBjbGFzcz0iZmFzIGZhLXVzZXIgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IFTDqm4gQk48L3RoPg0KICAgICAgICAgICAgICAgIDx0aD48aSBjbGFzcz0iZmFzIGZhLXByb2NlZHVyZXMgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IFRo4bunIHRodeG6rXQ8L3RoPg0KICAgICAgICAgICAgICAgIDx0aD48aSBjbGFzcz0iZmFyIGZhLWNsb2NrIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBUaOG7nWkgZ2lhbjwvdGg+DQogICAgICAgICAgICAgICAgPHRoPjxpIGNsYXNzPSJmYXMgZmEtdXNlci1udXJzZSBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gTmfGsOG7nWkgdGjhu7FjIGhp4buHbjwvdGg+DQogICAgICAgICAgICA8L3RyPg0KICAgICAgICA8L3RoZWFkPg0KICAgICAgICA8dGJvZHk+YDsNCiAgICANCiAgICBmaWx0ZXJlZENvbmZsaWN0cy5mb3JFYWNoKGNvbmZsaWN0ID0+IHsNCiAgICAgICAgLy8gVGjDqm0gZMOybmcgdGjDtG5nIHRpbiB24buBIG3DoXkgdsOgIG5nw6B5IHh1bmcgxJHhu5l0DQogICAgICAvLyAgaHRtbCArPSBgDQogICAgICAvLyAgPHRyIGNsYXNzPSJlcnJvci1yb3ciIHN0eWxlPSJiYWNrZ3JvdW5kLWNvbG9yOiAjZmZmM2NkOyI+DQogICAgICAgIC8vICAgIDx0ZCBjb2xzcGFuPSI1IiBzdHlsZT0idGV4dC1hbGlnbjogY2VudGVyOyBmb250LXdlaWdodDogYm9sZDsgY29sb3I6ICM4NTY0MDQ7Ij4NCiAgICAgICAgLy8gICAgICAgIDxpIGNsYXNzPSJmYXMgZmEtZXhjbGFtYXRpb24tdHJpYW5nbGUiPjwvaT4gDQogICAgICAgICAgLy8gICAgICBYVU5HIMSQ4buYVCBNw4FZOiAke2NvbmZsaWN0Lm1hY2hpbmVDb2RlfSAtIE5Hw4BZOiAke2NvbmZsaWN0LmRhdGV9DQogICAgICAgICAvLyAgIDwvdGQ+DQogICAgICAvLyAgPC90cj5gOw0KICAgICAgICANCiAgICAgICAgY29uZmxpY3QuY29uZmxpY3RQcm9jZWR1cmVzLmZvckVhY2goKHByb2MsIGluZGV4KSA9PiB7DQogICAgICAgICAgICBodG1sICs9IGANCiAgICAgICAgICAgIDx0ciBjbGFzcz0iZXJyb3Itcm93Ij4NCiAgICAgICAgICAgICAgICAke2luZGV4ID09PSAwID8gYDx0ZCByb3dzcGFuPSIke2NvbmZsaWN0LmNvbmZsaWN0UHJvY2VkdXJlcy5sZW5ndGh9Ij4ke2NvbmZsaWN0Lm1hY2hpbmVDb2RlfTwvdGQ+YCA6ICcnfQ0KICAgICAgICAgICAgICAgIDx0ZD4ke3Byb2MucGF0aWVudE5hbWV9IFs8Zm9udCBjb2xvcj0icmVkIj4ke3Byb2MucGF0aWVudEFnZX08L2ZvbnQ+XTxici8+JHtwcm9jLnBhdGllbnRJZH08L3RkPg0KICAgICAgICAgICAgICAgIDx0ZD4ke3Byb2MucHJvY2VkdXJlfTwvdGQ+DQogICAgICAgICAgICAgICAgPHRkPjxjZW50ZXI+JHtjb25mbGljdC5kYXRlfTxici8+JHtwcm9jLmRpc3BsYXlTdGFydH0g4oaSICR7cHJvYy5kaXNwbGF5RW5kfTwvY2VudGVyPjwvdGQ+DQogICAgICAgICAgICAgICAgPHRkPiR7cHJvYy5vcGVyYXRvci5yZXBsYWNlKC8sL2csICcnKX08L3RkPg0KICAgICAgICAgICAgPC90cj5gOw0KICAgICAgICB9KTsNCiAgICAgICAgDQogICAgICAgIGh0bWwgKz0gYDx0cj48dGQgY29sc3Bhbj0iNSIgY2xhc3M9Imdyb3VwLXNlcGFyYXRvciI+PC90ZD48L3RyPmA7DQogICAgfSk7DQogICAgDQogICAgaHRtbCArPSBgPC90Ym9keT48L3RhYmxlPmA7DQogICAgDQogICAgbWFjaGluZUNvbmZsaWN0TG9nRGl2LmlubmVySFRNTCA9IGh0bWw7DQp9DQoNCg0KLy8vR+G7o2kgw70gZ2nhu50geHVuZyDEkeG7mXQgbcOheS8vLy8vDQovLyBIw6BtIHThuqFvIGfhu6NpIMO9IGdp4budIGNobyB4dW5nIMSR4buZdCBtw6F5DQpmdW5jdGlvbiBnZW5lcmF0ZU1hY2hpbmVUaW1lU3VnZ2VzdGlvbnMoKSB7DQogICAgY29uc3QgdGltZU9wdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2lucHV0W25hbWU9InRpbWVPcHRpb24iXTpjaGVja2VkJykudmFsdWU7DQogICAgY29uc3Qgc3RhcnRIb3VyID0gdGltZU9wdGlvbiA9PT0gJzc6MzAnID8gNy41IDogNzsNCiAgICBjb25zdCBzaG93TW9yZVN1Z2dlc3Rpb25zID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Nob3dNb3JlU3VnZ2VzdGlvbnNDaGVja2JveCcpLmNoZWNrZWQ7DQogICAgDQogICAgLy8gU+G7kSBraHVuZyBnaeG7nSB04buRaSDEkWEgbeG7l2kgYnXhu5VpDQogICAgY29uc3QgbWF4TW9ybmluZyA9IHNob3dNb3JlU3VnZ2VzdGlvbnMgPyAzIDogMjsNCiAgICBjb25zdCBtYXhBZnRlcm5vb24gPSBzaG93TW9yZVN1Z2dlc3Rpb25zID8gMyA6IDE7DQoNCiAgICBtYWNoaW5lQ29uZmxpY3RMb2cuZm9yRWFjaChjb25mbGljdCA9PiB7DQogICAgICAgIGNvbnN0IHByb2NlZHVyZXMgPSBjb25mbGljdC5jb25mbGljdFByb2NlZHVyZXM7DQogICAgICAgIGNvbnN0IG1hY2hpbmVDb2RlID0gY29uZmxpY3QubWFjaGluZUNvZGU7DQogICAgICAgIGNvbnN0IGRhdGUgPSBjb25mbGljdC5kYXRlOw0KICAgICAgICANCiAgICAgICAgLy8gTOG6pXkgdOG6pXQgY+G6oyB0aOG7pyB0aHXhuq10IGPDuW5nIG5nw6B5LCBjw7luZyBtw6F5DQogICAgICAgIGNvbnN0IHNhbWVNYWNoaW5lUHJvY2VkdXJlcyA9IGdldEFsbFByb2NlZHVyZXNGb3JNYWNoaW5lKG1hY2hpbmVDb2RlLCBkYXRlKTsNCiAgICAgICAgDQogICAgICAgIC8vIFTDrG0ga2h1bmcgZ2nhu50gdHLhu5FuZyBjaG8gdOG7q25nIHRo4bunIHRodeG6rXQgdHJvbmcgeHVuZyDEkeG7mXQNCiAgICAgICAgcHJvY2VkdXJlcy5mb3JFYWNoKHByb2MgPT4gew0KICAgICAgICAgICAgY29uc3QgZHVyYXRpb25TZWNvbmRzID0gcHJvYy5lbmQgLSBwcm9jLnN0YXJ0Ow0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyBUw6xtIGtodW5nIGdp4budIGJ14buVaSBzw6FuZw0KICAgICAgICAgICAgY29uc3QgbW9ybmluZ1Nsb3RzID0gZmluZEF2YWlsYWJsZU1hY2hpbmVTbG90cygNCiAgICAgICAgICAgICAgICBzdGFydEhvdXIgKiAzNjAwLCANCiAgICAgICAgICAgICAgICAxMS41ICogMzYwMCwgDQogICAgICAgICAgICAgICAgZHVyYXRpb25TZWNvbmRzLCANCiAgICAgICAgICAgICAgICBzYW1lTWFjaGluZVByb2NlZHVyZXMsDQogICAgICAgICAgICAgICAgcHJvY2VkdXJlcywgLy8gbG/huqFpIHRy4burIGPDoWMgdGjhu6cgdGh14bqtdCDEkWFuZyB4dW5nIMSR4buZdA0KICAgICAgICAgICAgICAgIG1heE1vcm5pbmcsDQogICAgICAgICAgICAgICAgcHJvYy5vcGVyYXRvciwNCiAgICAgICAgICAgICAgICBkYXRlDQogICAgICAgICAgICApOw0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyBUw6xtIGtodW5nIGdp4budIGJ14buVaSBjaGnhu4F1DQogICAgICAgICAgICBjb25zdCBhZnRlcm5vb25TbG90cyA9IGZpbmRBdmFpbGFibGVNYWNoaW5lU2xvdHMoDQogICAgICAgICAgICAgICAgMTMuNSAqIDM2MDAsIA0KICAgICAgICAgICAgICAgIDE3ICogMzYwMCwgDQogICAgICAgICAgICAgICAgZHVyYXRpb25TZWNvbmRzLCANCiAgICAgICAgICAgICAgICBzYW1lTWFjaGluZVByb2NlZHVyZXMsDQogICAgICAgICAgICAgICAgcHJvY2VkdXJlcywNCiAgICAgICAgICAgICAgICBtYXhBZnRlcm5vb24sDQogICAgICAgICAgICAgICAgcHJvYy5vcGVyYXRvciwNCiAgICAgICAgICAgICAgICBkYXRlDQogICAgICAgICAgICApOw0KDQogICAgICAgICAgICAvLyBGb3JtYXQga+G6v3QgcXXhuqMNCiAgICAgICAgICAgIGxldCBzdWdnZXN0aW9ucyA9IFtdOw0KICAgICAgICAgICAgaWYgKG1vcm5pbmdTbG90cy5sZW5ndGggPiAwKSB7DQogICAgICAgICAgICAgICAgc3VnZ2VzdGlvbnMucHVzaCgnPHN0cm9uZz5Tw6FuZzo8L3N0cm9uZz48YnI+JyArIA0KICAgICAgICAgICAgICAgICAgICBtb3JuaW5nU2xvdHMubWFwKHNsb3QgPT4gYCR7c2xvdC5zdGFydH0gLSAke3Nsb3QuZW5kfWApLmpvaW4oJzxicj4nKSk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBpZiAoYWZ0ZXJub29uU2xvdHMubGVuZ3RoID4gMCkgew0KICAgICAgICAgICAgICAgIHN1Z2dlc3Rpb25zLnB1c2goJzxzdHJvbmc+Q2hp4buBdTo8L3N0cm9uZz48YnI+JyArIA0KICAgICAgICAgICAgICAgICAgICBhZnRlcm5vb25TbG90cy5tYXAoc2xvdCA9PiBgJHtzbG90LnN0YXJ0fSAtICR7c2xvdC5lbmR9YCkuam9pbignPGJyPicpKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgLy8gTMawdSBn4bujaSDDvQ0KICAgICAgICAgICAgcHJvYy5tYWNoaW5lU3VnZ2VzdGlvbiA9IHN1Z2dlc3Rpb25zLmxlbmd0aCA+IDAgPyBzdWdnZXN0aW9ucy5qb2luKCc8YnI+JykgOiANCiAgICAgICAgICAgICAgICAnPHNwYW4gY2xhc3M9Im5vLXN1Z2dlc3Rpb24iPktow7RuZyBjw7Mga2h1bmcgZ2nhu50gdHLhu5FuZzwvc3Bhbj4nOw0KICAgICAgICB9KTsNCg0KICAgICAgICAvLyBD4bqtcCBuaOG6rXQgVUkNCiAgICAgICAgdXBkYXRlTWFjaGluZVN1Z2dlc3Rpb25VSShtYWNoaW5lQ29kZSwgZGF0ZSwgcHJvY2VkdXJlcyk7DQogICAgfSk7DQp9DQoNCi8vIEjDoG0gbOG6pXkgdOG6pXQgY+G6oyB0aOG7pyB0aHXhuq10IGPDuW5nIG3DoXksIGPDuW5nIG5nw6B5DQpmdW5jdGlvbiBnZXRBbGxQcm9jZWR1cmVzRm9yTWFjaGluZShtYWNoaW5lQ29kZSwgZGF0ZSkgew0KICAgIGNvbnN0IGFsbFByb2NzID0gW107DQogICAgDQogICAgbWFjaGluZUNvbmZsaWN0TG9nLmZvckVhY2goY29uZmxpY3QgPT4gew0KICAgICAgICBpZiAoY29uZmxpY3QubWFjaGluZUNvZGUgPT09IG1hY2hpbmVDb2RlICYmIGNvbmZsaWN0LmRhdGUgPT09IGRhdGUpIHsNCiAgICAgICAgICAgIGFsbFByb2NzLnB1c2goLi4uY29uZmxpY3QuY29uZmxpY3RQcm9jZWR1cmVzKTsNCiAgICAgICAgfQ0KICAgIH0pOw0KICAgIA0KICAgIC8vIFRow6ptIGPDoWMgdGjhu6cgdGh14bqtdCBraMO0bmcgeHVuZyDEkeG7mXQgbmjGsG5nIGPDuW5nIG3DoXksIG5nw6B5DQogICAgaWYgKHdpbmRvdy5hbGxQcm9jZWR1cmVzKSB7DQogICAgICAgIHdpbmRvdy5hbGxQcm9jZWR1cmVzLmZvckVhY2gocHJvYyA9PiB7DQogICAgICAgICAgICBpZiAocHJvYy5tYWNoaW5lQ29kZSA9PT0gbWFjaGluZUNvZGUgJiYgcHJvYy5kYXRlID09PSBkYXRlKSB7DQogICAgICAgICAgICAgICAgYWxsUHJvY3MucHVzaChwcm9jKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSk7DQogICAgfQ0KICAgIA0KICAgIHJldHVybiBhbGxQcm9jczsNCn0NCg0KLy8gSMOgbSB0w6xtIGtodW5nIGdp4budIHRy4buRbmcgY2hvIG3DoXkNCmZ1bmN0aW9uIGZpbmRBdmFpbGFibGVNYWNoaW5lU2xvdHMoc3RhcnRUaW1lLCBlbmRUaW1lLCBkdXJhdGlvbiwgbWFjaGluZVByb2NlZHVyZXMsIGNvbmZsaWN0UHJvY2VkdXJlcywgbWF4U2xvdHMsIG9wZXJhdG9yLCBkYXRlKSB7DQogICAgY29uc3Qgc2xvdHMgPSBbXTsNCiAgICBsZXQgY3VycmVudFRpbWUgPSBzdGFydFRpbWU7DQogICAgDQogICAgd2hpbGUgKGN1cnJlbnRUaW1lICsgZHVyYXRpb24gPD0gZW5kVGltZSAmJiBzbG90cy5sZW5ndGggPCBtYXhTbG90cykgew0KICAgICAgICBpZiAoIWhhc01hY2hpbmVUaW1lQ29uZmxpY3QoY3VycmVudFRpbWUsIGR1cmF0aW9uLCBtYWNoaW5lUHJvY2VkdXJlcywgY29uZmxpY3RQcm9jZWR1cmVzLCBvcGVyYXRvciwgZGF0ZSkpIHsNCiAgICAgICAgICAgIHNsb3RzLnB1c2goew0KICAgICAgICAgICAgICAgIHN0YXJ0OiBzZWNvbmRzVG9UaW1lU3RyKGN1cnJlbnRUaW1lKSwNCiAgICAgICAgICAgICAgICBlbmQ6IHNlY29uZHNUb1RpbWVTdHIoY3VycmVudFRpbWUgKyBkdXJhdGlvbikNCiAgICAgICAgICAgIH0pOw0KICAgICAgICB9DQogICAgICAgIGN1cnJlbnRUaW1lICs9IDE1ICogNjA7IC8vIEtp4buDbSB0cmEgbeG7l2kgMTUgcGjDunQNCiAgICB9DQogICAgDQogICAgcmV0dXJuIHNsb3RzOw0KfQ0KDQovLyBIw6BtIGtp4buDbSB0cmEgeHVuZyDEkeG7mXQgdGjhu51pIGdpYW4gY2hvIG3DoXkNCmZ1bmN0aW9uIGhhc01hY2hpbmVUaW1lQ29uZmxpY3Qoc3RhcnRUaW1lLCBkdXJhdGlvbiwgbWFjaGluZVByb2NlZHVyZXMsIGNvbmZsaWN0UHJvY2VkdXJlcywgb3BlcmF0b3IsIGRhdGUpIHsNCiAgICBjb25zdCBlbmRUaW1lID0gc3RhcnRUaW1lICsgZHVyYXRpb247DQogICAgDQogICAgLy8gS2nhu4NtIHRyYSB4dW5nIMSR4buZdCBtw6F5DQogICAgZm9yIChjb25zdCBwcm9jIG9mIG1hY2hpbmVQcm9jZWR1cmVzKSB7DQogICAgICAgIGlmIChwcm9jLnN0YXJ0IDwgZW5kVGltZSAmJiBwcm9jLmVuZCA+IHN0YXJ0VGltZSkgew0KICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgIH0NCiAgICB9DQogICAgDQogICAgLy8gS2nhu4NtIHRyYSB4dW5nIMSR4buZdCBuZ8aw4budaSB0aOG7sWMgaGnhu4duDQogICAgaWYgKHdpbmRvdy5hbGxQcm9jZWR1cmVzKSB7DQogICAgICAgIGNvbnN0IG9wZXJhdG9yUHJvY2VkdXJlcyA9IHdpbmRvdy5hbGxQcm9jZWR1cmVzLmZpbHRlcihwID0+IA0KICAgICAgICAgICAgcC5vcGVyYXRvciA9PT0gb3BlcmF0b3IgJiYgDQogICAgICAgICAgICBwLmRhdGUgPT09IGRhdGUgJiYNCiAgICAgICAgICAgICFjb25mbGljdFByb2NlZHVyZXMuaW5jbHVkZXMocCkNCiAgICAgICAgKTsNCiAgICAgICAgDQogICAgICAgIGZvciAoY29uc3QgcHJvYyBvZiBvcGVyYXRvclByb2NlZHVyZXMpIHsNCiAgICAgICAgICAgIGNvbnN0IHByb2NTdGFydCA9IHByb2Muc3RhcnQ7DQogICAgICAgICAgICBjb25zdCBwcm9jRW5kID0gcHJvYy5lbmQgKyAocHJvYy5wcm9jZWR1cmVJbmZvPy5idWZmZXIgfHwgMCkgKiA2MDsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgaWYgKChzdGFydFRpbWUgPj0gcHJvY1N0YXJ0ICYmIHN0YXJ0VGltZSA8IHByb2NFbmQpIHx8IA0KICAgICAgICAgICAgICAgIChlbmRUaW1lID4gcHJvY1N0YXJ0ICYmIGVuZFRpbWUgPD0gcHJvY0VuZCkgfHwNCiAgICAgICAgICAgICAgICAoc3RhcnRUaW1lIDw9IHByb2NTdGFydCAmJiBlbmRUaW1lID49IHByb2NFbmQpKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9DQogICAgDQogICAgcmV0dXJuIGZhbHNlOw0KfQ0KDQovLyBIw6BtIGPhuq1wIG5o4bqtdCBVSSBn4bujaSDDvQ0KLy8gSMOgbSBj4bqtcCBuaOG6rXQgVUkgZ+G7o2kgw70NCmZ1bmN0aW9uIHVwZGF0ZU1hY2hpbmVTdWdnZXN0aW9uVUkobWFjaGluZUNvZGUsIGRhdGUsIHByb2NlZHVyZXMpIHsNCiAgICBjb25zdCBzdWdnZXN0aW9uQ2VsbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGBtYWNoaW5lU3VnZ2VzdGlvbi0ke21hY2hpbmVDb2RlfS0ke2RhdGV9YCk7DQogICAgaWYgKHN1Z2dlc3Rpb25DZWxsKSB7DQogICAgICAgIC8vIEzhuqV5IGfhu6NpIMO9IHThu6sgdGjhu6cgdGh14bqtdCDEkeG6p3UgdGnDqm4gKHbDrCB04bqldCBj4bqjIMSR4buBdSBnaeG7kW5nIG5oYXUpDQogICAgICAgIGNvbnN0IGZpcnN0UHJvYyA9IHByb2NlZHVyZXNbMF07DQogICAgICAgIGlmIChmaXJzdFByb2MgJiYgZmlyc3RQcm9jLm1hY2hpbmVTdWdnZXN0aW9uKSB7DQogICAgICAgICAgICBzdWdnZXN0aW9uQ2VsbC5pbm5lckhUTUwgPSBmaXJzdFByb2MubWFjaGluZVN1Z2dlc3Rpb247DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICBzdWdnZXN0aW9uQ2VsbC5pbm5lckhUTUwgPSAnPHNwYW4gY2xhc3M9Im5vLXN1Z2dlc3Rpb24iPktow7RuZyBjw7Mga2h1bmcgZ2nhu50gdHLhu5FuZzwvc3Bhbj4nOw0KICAgICAgICB9DQogICAgfQ0KfQ0KDQoNCg0KDQoNCi8vIEjDoG0gaGnhu4NuIHRo4buLIGzhu5dpIHF1w6puIGfhuq9uIG3DoyBtw6F5DQpmdW5jdGlvbiBkaXNwbGF5TWlzc2luZ01hY2hpbmVFcnJvcnMoKSB7DQogICAgY29uc3QgbWlzc2luZ01hY2hpbmVMb2dEaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWlzc2luZ01hY2hpbmVMb2cnKTsNCiAgICBjb25zdCBtaXNzaW5nTWFjaGluZVNlY3Rpb24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWlzc2luZ01hY2hpbmVTZWN0aW9uJyk7DQogICAgDQogICAgaWYgKG1pc3NpbmdNYWNoaW5lTG9nLmxlbmd0aCA9PT0gMCkgew0KICAgICAgICBtaXNzaW5nTWFjaGluZUxvZ0Rpdi5pbm5lckhUTUwgPSAnPHA+S2jDtG5nIGPDsyBs4buXaSBxdcOqbiBn4bqvbiBtw6MgbcOheSBuw6BvIMSRxrDhu6NjIGdoaSBuaOG6rW48L3A+JzsNCiAgICAgICAgbWlzc2luZ01hY2hpbmVTZWN0aW9uLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7DQogICAgICAgIHJldHVybjsNCiAgICB9DQogICAgDQogICAgbGV0IGh0bWwgPSBgDQogICAgPHRhYmxlIGNsYXNzPSJlcnJvci10YWJsZSI+DQogICAgICAgIDx0aGVhZD4NCiAgICAgICAgICAgIDx0cj4NCiAgICAgICAgICAgICAgICA8dGg+PGkgY2xhc3M9ImZhcyBmYS11c2VyIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBUw6puIEJOPC90aD4NCiAgICAgICAgICAgICAgICA8dGg+PGkgY2xhc3M9ImZhcyBmYS1wcm9jZWR1cmVzIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBUaOG7pyB0aHXhuq10PC90aD4NCiAgICAgICAgICAgICAgICA8dGg+PGkgY2xhc3M9ImZhcyBmYS11c2VyLW51cnNlIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBOZ8aw4budaSB0aOG7sWMgaGnhu4duPC90aD4NCiAgICAgICAgICAgICAgICA8dGg+PGkgY2xhc3M9ImZhciBmYS1jbG9jayBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gVGjhu51pIGdpYW48L3RoPg0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgPC90cj4NCiAgICAgICAgPC90aGVhZD4NCiAgICAgICAgPHRib2R5PmA7DQogICAgDQogICAgbWlzc2luZ01hY2hpbmVMb2cuZm9yRWFjaChlcnJvciA9PiB7DQogICAgICAgIGh0bWwgKz0gYA0KICAgICAgICA8dHIgY2xhc3M9ImVycm9yLXJvdyI+DQogICAgICAgICAgICA8dGQ+JHtlcnJvci5wYXRpZW50TmFtZX0gWzxmb250IGNvbG9yPSJyZWQiPiR7ZXJyb3IucGF0aWVudEFnZX08L2ZvbnQ+XTxici8+JHtlcnJvci5wYXRpZW50SWR9PC90ZD4NCiAgICAgICAgICAgIDx0ZD4ke2Vycm9yLnByb2NlZHVyZX08L3RkPg0KICAgICAgICAgICAgPHRkPiR7ZXJyb3Iub3BlcmF0b3IucmVwbGFjZSgvLC9nLCAnJyl9PC90ZD4NCiAgICAgICAgICAgIDx0ZD48Y2VudGVyPiR7ZXJyb3IuZGF0ZX08YnIvPiR7ZXJyb3Iuc3RhcnRUaW1lfSDihpIgJHtlcnJvci5lbmRUaW1lfTwvY2VudGVyPjwvdGQ+DQogICAgICAgICAgIA0KICAgICAgICA8L3RyPmA7DQogICAgfSk7DQogICAgDQogICAgaHRtbCArPSBgPC90Ym9keT48L3RhYmxlPmA7DQogICAgDQogICAgbWlzc2luZ01hY2hpbmVMb2dEaXYuaW5uZXJIVE1MID0gaHRtbDsNCiAgICBtaXNzaW5nTWFjaGluZVNlY3Rpb24uc3R5bGUuZGlzcGxheSA9ICdibG9jayc7DQogICAgDQogICAgLy8gQ+G6rXAgbmjhuq10IGRyb3Bkb3duIGzhu41jDQogICAgdXBkYXRlTWlzc2luZ01hY2hpbmVPcGVyYXRvckZpbHRlcigpOw0KfQ0KDQovLyBD4bqtcCBuaOG6rXQgZHJvcGRvd24gbOG7jWMgY2hvIHF1w6puIGfhuq9uIG3DoyBtw6F5DQpmdW5jdGlvbiB1cGRhdGVNaXNzaW5nTWFjaGluZU9wZXJhdG9yRmlsdGVyKCkgew0KICAgIGNvbnN0IG9wZXJhdG9ycyA9IFsuLi5uZXcgU2V0KG1pc3NpbmdNYWNoaW5lTG9nLm1hcChlcnJvciA9PiBlcnJvci5vcGVyYXRvcikpXTsNCiAgICBjb25zdCBvcGVyYXRvclNlbGVjdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtaXNzaW5nTWFjaGluZU9wZXJhdG9yU2VsZWN0Jyk7DQogICAgDQogICAgb3BlcmF0b3JTZWxlY3QuaW5uZXJIVE1MID0gJzxvcHRpb24gdmFsdWU9ImFsbCI+VOG6pXQgY+G6ozwvb3B0aW9uPicgKyANCiAgICAgICAgb3BlcmF0b3JzLm1hcChvcCA9PiBgPG9wdGlvbiB2YWx1ZT0iJHtvcH0iPiR7b3AucmVwbGFjZSgvLC9nLCAnJyl9PC9vcHRpb24+YCkuam9pbignJyk7DQogICAgDQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21pc3NpbmdNYWNoaW5lT3BlcmF0b3JGaWx0ZXInKS5zdHlsZS5kaXNwbGF5ID0gb3BlcmF0b3JzLmxlbmd0aCA+IDAgPyAnYmxvY2snIDogJ25vbmUnOw0KfQ0KDQovLyBM4buNYyBxdcOqbiBn4bqvbiBtw6MgbcOheSB0aGVvIG5nxrDhu51pIHRo4buxYyBoaeG7h24NCmZ1bmN0aW9uIGZpbHRlck1pc3NpbmdNYWNoaW5lQnlPcGVyYXRvcigpIHsNCiAgICBjb25zdCBvcGVyYXRvciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtaXNzaW5nTWFjaGluZU9wZXJhdG9yU2VsZWN0JykudmFsdWU7DQogICAgY29uc3QgZmlsdGVyZWRFcnJvcnMgPSBvcGVyYXRvciA9PT0gJ2FsbCcgDQogICAgICAgID8gbWlzc2luZ01hY2hpbmVMb2cgDQogICAgICAgIDogbWlzc2luZ01hY2hpbmVMb2cuZmlsdGVyKGVycm9yID0+IGVycm9yLm9wZXJhdG9yLnJlcGxhY2UoLywvZywgJycpID09PSBvcGVyYXRvci5yZXBsYWNlKC8sL2csICcnKSk7DQogICAgDQogICAgZGlzcGxheUZpbHRlcmVkTWlzc2luZ01hY2hpbmVFcnJvcnMoZmlsdGVyZWRFcnJvcnMpOw0KfQ0KDQovLyBIaeG7g24gdGjhu4sgbOG7l2kgcXXDqm4gZ+G6r24gbcOjIG3DoXkgxJHDoyBs4buNYw0KZnVuY3Rpb24gZGlzcGxheUZpbHRlcmVkTWlzc2luZ01hY2hpbmVFcnJvcnMoZmlsdGVyZWRFcnJvcnMpIHsNCiAgICBjb25zdCBtaXNzaW5nTWFjaGluZUxvZ0RpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtaXNzaW5nTWFjaGluZUxvZycpOw0KICAgIA0KICAgIGlmIChmaWx0ZXJlZEVycm9ycy5sZW5ndGggPT09IDApIHsNCiAgICAgICAgbWlzc2luZ01hY2hpbmVMb2dEaXYuaW5uZXJIVE1MID0gJzxwPktow7RuZyBjw7MgbOG7l2kgcXXDqm4gZ+G6r24gbcOjIG3DoXkgbsOgbyDEkcaw4bujYyBnaGkgbmjhuq1uPC9wPic7DQogICAgICAgIHJldHVybjsNCiAgICB9DQogICAgDQogICAgbGV0IGh0bWwgPSBgDQogICAgPHRhYmxlIGNsYXNzPSJlcnJvci10YWJsZSI+DQogICAgICAgIDx0aGVhZD4NCiAgICAgICAgICAgIDx0cj4NCiAgICAgICAgICAgICAgICA8dGg+PGkgY2xhc3M9ImZhcyBmYS11c2VyIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBUw6puIEJOPC90aD4NCiAgICAgICAgICAgICAgICA8dGg+PGkgY2xhc3M9ImZhcyBmYS1wcm9jZWR1cmVzIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBUaOG7pyB0aHXhuq10PC90aD4NCiAgICAgICAgICAgICAgICA8dGg+PGkgY2xhc3M9ImZhcyBmYS11c2VyLW51cnNlIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBOZ8aw4budaSB0aOG7sWMgaGnhu4duPC90aD4NCiAgICAgICAgICAgICAgICA8dGg+PGkgY2xhc3M9ImZhciBmYS1jbG9jayBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gVGjhu51pIGdpYW48L3RoPg0KICAgICAgICAgICAgICAgDQogICAgICAgICAgICA8L3RyPg0KICAgICAgICA8L3RoZWFkPg0KICAgICAgICA8dGJvZHk+YDsNCiAgICANCiAgICBmaWx0ZXJlZEVycm9ycy5mb3JFYWNoKGVycm9yID0+IHsNCiAgICAgICAgaHRtbCArPSBgDQogICAgICAgIDx0ciBjbGFzcz0iZXJyb3Itcm93Ij4NCiAgICAgICAgICAgIDx0ZD4ke2Vycm9yLnBhdGllbnROYW1lfSBbPGZvbnQgY29sb3I9InJlZCI+JHtlcnJvci5wYXRpZW50QWdlfTwvZm9udD5dPGJyLz4ke2Vycm9yLnBhdGllbnRJZH08L3RkPg0KICAgICAgICAgICAgPHRkPiR7ZXJyb3IucHJvY2VkdXJlfTwvdGQ+DQogICAgICAgICAgICA8dGQ+JHtlcnJvci5vcGVyYXRvci5yZXBsYWNlKC8sL2csICcnKX08L3RkPg0KICAgICAgICAgICAgPHRkPjxjZW50ZXI+JHtlcnJvci5kYXRlfTxici8+JHtlcnJvci5zdGFydFRpbWV9IOKGkiAke2Vycm9yLmVuZFRpbWV9PC9jZW50ZXI+PC90ZD4NCiAgICAgICAgICAgIA0KICAgICAgICA8L3RyPmA7DQogICAgfSk7DQogICAgDQogICAgaHRtbCArPSBgPC90Ym9keT48L3RhYmxlPmA7DQogICAgDQogICAgbWlzc2luZ01hY2hpbmVMb2dEaXYuaW5uZXJIVE1MID0gaHRtbDsNCn0NCmZ1bmN0aW9uIGdlbmVyYXRlVGltZVN1Z2dlc3Rpb25zKHByb2NlZHVyZXMpIHsNCiAgICBjb25zdCB0aW1lT3B0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignaW5wdXRbbmFtZT0idGltZU9wdGlvbiJdOmNoZWNrZWQnKS52YWx1ZTsNCiAgICBjb25zdCBzdGFydEhvdXIgPSB0aW1lT3B0aW9uID09PSAnNzozMCcgPyA3LjUgOiA3Ow0KICAgIGNvbnN0IGlnbm9yZUFkamFjZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2lnbm9yZUFkamFjZW50Q2hlY2tib3gnKS5jaGVja2VkOw0KICAgIGNvbnN0IGJ1ZmZlck1pbnV0ZXMgPSBpZ25vcmVBZGphY2VudCA/IDAgOiAxOw0KICAgIGNvbnN0IHNob3dNb3JlU3VnZ2VzdGlvbnMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2hvd01vcmVTdWdnZXN0aW9uc0NoZWNrYm94JykuY2hlY2tlZDsNCiAgICANCiAgICAvLyBT4buRIGtodW5nIGdp4budIHThu5FpIMSRYSBt4buXaSBideG7lWkgKG7hur91IGNo4buNbiA2IGtodW5nIHRow6wgMyBzw6FuZyArIDMgY2hp4buBdSkNCiAgICBjb25zdCBtYXhNb3JuaW5nID0gc2hvd01vcmVTdWdnZXN0aW9ucyA/IDMgOiAyOw0KICAgIGNvbnN0IG1heEFmdGVybm9vbiA9IHNob3dNb3JlU3VnZ2VzdGlvbnMgPyAzIDogMTsNCg0KICAgIHByb2NlZHVyZXMuZm9yRWFjaChwcm9jID0+IHsNCiAgICAgICAgaWYgKCFwcm9jLmNvbmZsaWN0KSByZXR1cm47DQoNCiAgICAgICAgY29uc3Qgc2FtZURheVByb2NlZHVyZXMgPSBwcm9jZWR1cmVzLmZpbHRlcihwID0+IA0KICAgICAgICAgICAgcC5kYXRlID09PSBwcm9jLmRhdGUgJiYgDQogICAgICAgICAgICBwLm9wZXJhdG9yID09PSBwcm9jLm9wZXJhdG9yICYmDQogICAgICAgICAgICBwLnJvd0luZGV4ICE9PSBwcm9jLnJvd0luZGV4DQogICAgICAgICk7DQoNCiAgICAgICAgY29uc3QgZHVyYXRpb25TZWNvbmRzID0gcHJvYy5lbmQgLSBwcm9jLnN0YXJ0ICsgKGJ1ZmZlck1pbnV0ZXMgKiA2MCk7DQogICAgICAgIA0KICAgICAgICAvLyBUw6xtIGtodW5nIGdp4budIGJ14buVaSBzw6FuZw0KICAgICAgICBjb25zdCBtb3JuaW5nU2xvdHMgPSBmaW5kQXZhaWxhYmxlU2xvdHMoDQogICAgICAgICAgICBzdGFydEhvdXIgKiAzNjAwLCANCiAgICAgICAgICAgIDExLjUgKiAzNjAwLCANCiAgICAgICAgICAgIGR1cmF0aW9uU2Vjb25kcywgDQogICAgICAgICAgICBzYW1lRGF5UHJvY2VkdXJlcywgDQogICAgICAgICAgICBtYXhNb3JuaW5nDQogICAgICAgICk7DQogICAgICAgIA0KICAgICAgICAvLyBUw6xtIGtodW5nIGdp4budIGJ14buVaSBjaGnhu4F1DQogICAgICAgIGNvbnN0IGFmdGVybm9vblNsb3RzID0gZmluZEF2YWlsYWJsZVNsb3RzKA0KICAgICAgICAgICAgMTMuNSAqIDM2MDAsIA0KICAgICAgICAgICAgMTcgKiAzNjAwLCANCiAgICAgICAgICAgIGR1cmF0aW9uU2Vjb25kcywgDQogICAgICAgICAgICBzYW1lRGF5UHJvY2VkdXJlcywgDQogICAgICAgICAgICBtYXhBZnRlcm5vb24NCiAgICAgICAgKTsNCg0KICAgICAgICAvLyBGb3JtYXQga+G6v3QgcXXhuqMNCiAgICAgICAgbGV0IHN1Z2dlc3Rpb25zID0gW107DQogICAgICAgIGlmIChtb3JuaW5nU2xvdHMubGVuZ3RoID4gMCkgew0KICAgICAgICAgICAgc3VnZ2VzdGlvbnMucHVzaCgnPHN0cm9uZz5Tw6FuZzo8L3N0cm9uZz48YnI+JyArIA0KICAgICAgICAgICAgICAgIG1vcm5pbmdTbG90cy5tYXAoc2xvdCA9PiBgJHtzbG90LnN0YXJ0fSAtICR7c2xvdC5lbmR9YCkuam9pbignPGJyPicpKTsNCiAgICAgICAgfQ0KICAgICAgICBpZiAoYWZ0ZXJub29uU2xvdHMubGVuZ3RoID4gMCkgew0KICAgICAgICAgICAgc3VnZ2VzdGlvbnMucHVzaCgnPHN0cm9uZz5DaGnhu4F1Ojwvc3Ryb25nPjxicj4nICsgDQogICAgICAgICAgICAgICAgYWZ0ZXJub29uU2xvdHMubWFwKHNsb3QgPT4gYCR7c2xvdC5zdGFydH0gLSAke3Nsb3QuZW5kfWApLmpvaW4oJzxicj4nKSk7DQogICAgICAgIH0NCg0KICAgICAgICANCmlmIChtb3JuaW5nU2xvdHMubGVuZ3RoICsgYWZ0ZXJub29uU2xvdHMubGVuZ3RoID4gMCkgew0KICAgIHByb2Muc3VnZ2VzdGlvbiA9IHN1Z2dlc3Rpb25zLmpvaW4oJzxicj4nKTsNCn0gZWxzZSB7DQogICAgcHJvYy5zdWdnZXN0aW9uID0gJzxzcGFuIGNsYXNzPSJuby1zdWdnZXN0aW9uIj5LaMO0bmcgY8OzIGtodW5nIGdp4budIHRy4buRbmc8L3NwYW4+JzsNCn0NCg0KICAgIH0pOw0KfQ0KLy8gSMOgbSBraeG7g20gdHJhIHh1bmcgxJHhu5l0IHRo4budaSBnaWFuDQpmdW5jdGlvbiBoYXNUaW1lQ29uZmxpY3Qoc3RhcnRUaW1lLCBkdXJhdGlvbiwgcHJvY2VkdXJlcykgew0KICAgIGNvbnN0IGVuZFRpbWUgPSBzdGFydFRpbWUgKyBkdXJhdGlvbjsNCiAgICANCiAgICBmb3IgKGNvbnN0IHByb2Mgb2YgcHJvY2VkdXJlcykgew0KICAgICAgICBjb25zdCBwcm9jU3RhcnQgPSBwcm9jLnN0YXJ0Ow0KICAgICAgICBjb25zdCBwcm9jRW5kID0gcHJvYy5lbmQgKyAocHJvYy5wcm9jZWR1cmVJbmZvPy5idWZmZXIgfHwgMCkgKiA2MDsNCiAgICAgICAgDQogICAgICAgIGlmICgoc3RhcnRUaW1lID49IHByb2NTdGFydCAmJiBzdGFydFRpbWUgPCBwcm9jRW5kKSB8fCANCiAgICAgICAgICAgIChlbmRUaW1lID4gcHJvY1N0YXJ0ICYmIGVuZFRpbWUgPD0gcHJvY0VuZCkgfHwNCiAgICAgICAgICAgIChzdGFydFRpbWUgPD0gcHJvY1N0YXJ0ICYmIGVuZFRpbWUgPj0gcHJvY0VuZCkpIHsNCiAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICB9DQogICAgfQ0KICAgIA0KICAgIHJldHVybiBmYWxzZTsNCn0NCi8vIEjDoG0gdMOsbSBraHVuZyBnaeG7nSB0cuG7kW5nDQpmdW5jdGlvbiBmaW5kQXZhaWxhYmxlU2xvdHMoc3RhcnRUaW1lLCBlbmRUaW1lLCBkdXJhdGlvbiwgcHJvY2VkdXJlcywgbWF4U2xvdHMpIHsNCiAgICBjb25zdCBzbG90cyA9IFtdOw0KICAgIGxldCBjdXJyZW50VGltZSA9IHN0YXJ0VGltZTsNCiAgICBjb25zdCBpZ25vcmVBZGphY2VudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdpZ25vcmVBZGphY2VudENoZWNrYm94JykuY2hlY2tlZDsNCiAgICBjb25zdCBidWZmZXJNaW51dGVzID0gaWdub3JlQWRqYWNlbnQgPyAwIDogMTsNCiAgICANCiAgICB3aGlsZSAoY3VycmVudFRpbWUgKyBkdXJhdGlvbiA8PSBlbmRUaW1lICYmIHNsb3RzLmxlbmd0aCA8IG1heFNsb3RzKSB7DQogICAgICAgIGlmICghaGFzVGltZUNvbmZsaWN0KGN1cnJlbnRUaW1lLCBkdXJhdGlvbiwgcHJvY2VkdXJlcykpIHsNCiAgICAgICAgICAgIHNsb3RzLnB1c2goew0KICAgICAgICAgICAgICAgIHN0YXJ0OiBzZWNvbmRzVG9UaW1lU3RyKGN1cnJlbnRUaW1lKSwNCiAgICAgICAgICAgICAgICBlbmQ6IHNlY29uZHNUb1RpbWVTdHIoY3VycmVudFRpbWUgKyAoZHVyYXRpb24gLSAoYnVmZmVyTWludXRlcyAqIDYwKSkpIC8vIFRy4burIGJ1ZmZlciDEkeG7gyBoaeG7g24gdGjhu4sNCiAgICAgICAgICAgIH0pOw0KICAgICAgICB9DQogICAgICAgIGN1cnJlbnRUaW1lICs9IDE1ICogNjA7IC8vIEtp4buDbSB0cmEgbeG7l2kgMTUgcGjDunQNCiAgICB9DQogICAgDQogICAgcmV0dXJuIHNsb3RzOw0KfQ0KDQogICAgICAgIGZ1bmN0aW9uIHNlY29uZHNUb1RpbWVTdHIoc2Vjb25kcykgew0KICAgICAgICAgICAgY29uc3QgaG91cnMgPSBNYXRoLmZsb29yKHNlY29uZHMgLyAzNjAwKTsNCiAgICAgICAgICAgIGNvbnN0IG1pbnV0ZXMgPSBNYXRoLmZsb29yKChzZWNvbmRzICUgMzYwMCkgLyA2MCk7DQogICAgICAgICAgICByZXR1cm4gYCR7aG91cnMudG9TdHJpbmcoKS5wYWRTdGFydCgyLCAnMCcpfToke21pbnV0ZXMudG9TdHJpbmcoKS5wYWRTdGFydCgyLCAnMCcpfWA7DQogICAgICAgIH0NCg0KDQovLyDEkOG6v20gdOG7lW5nIGNhICJz4bqvYyB0aHXhu5FjIiBraMOhYyDEkWEgc+G7kSAob3V0bGllcikNCmZ1bmN0aW9uIGdldEhlcmJPdXRsaWVyVG90YWwoKSB7DQogIGNvbnN0IGhlcmJzID0gQXJyYXkuaXNBcnJheSh3aW5kb3cuYWxsSGVyYlByb2NlZHVyZXMpID8gd2luZG93LmFsbEhlcmJQcm9jZWR1cmVzIDogW107DQogIGNvbnN0IGNvdW50c0J5RGF0ZSA9IHt9Ow0KICBoZXJicy5mb3JFYWNoKGggPT4gew0KICAgIGNvbnN0IGQgPSBoLmRhdGU7DQogICAgY29uc3QgbiA9IChoLm9wZXJhdG9yIHx8ICdLaMO0bmcgY8OzJykudHJpbSgpLnRvTG93ZXJDYXNlKCk7DQogICAgaWYgKCFjb3VudHNCeURhdGVbZF0pIGNvdW50c0J5RGF0ZVtkXSA9IHt9Ow0KICAgIGNvdW50c0J5RGF0ZVtkXVtuXSA9IChjb3VudHNCeURhdGVbZF1bbl0gfHwgMCkgKyAxOw0KICB9KTsNCiAgbGV0IG91dGxpZXJzID0gMDsNCiAgT2JqZWN0LnZhbHVlcyhjb3VudHNCeURhdGUpLmZvckVhY2gobWFwID0+IHsNCiAgICBjb25zdCBlbnRyaWVzID0gT2JqZWN0LmVudHJpZXMobWFwKS5zb3J0KChhLGIpPT5iWzFdLWFbMV0pOw0KICAgIGNvbnN0IHRvcCA9IGVudHJpZXNbMF07IGlmICghdG9wKSByZXR1cm47DQogICAgY29uc3QgdG9wTmFtZSA9IHRvcFswXTsNCiAgICBlbnRyaWVzLmZvckVhY2goKFtuYW1lLCBjbnRdKSA9PiB7IGlmIChuYW1lICE9PSB0b3BOYW1lKSBvdXRsaWVycyArPSBjbnQ7IH0pOw0KICB9KTsNCiAgcmV0dXJuIG91dGxpZXJzOw0KfQ0KDQovLyDEkOG6v20gbOG7l2kgc2FpIHRo4budaSBnaWFuIChr4bq/dCB0aMO6YyA8PSBi4bqvdCDEkeG6p3UsIMSR4buLbmggZOG6oW5nIHNhaSwgc2FpIHBow7p0IHNvIHbhu5tpIHF1eSDEkeG7i25oLC4uLikNCmZ1bmN0aW9uIGdldFRpbWVFcnJvclRvdGFsKCkgew0KICAvLyDEkOG6v20gxJHDum5nIHRoZW8gc+G7kSBow6BuZyBs4buXaSDEkWFuZyBoaeG7g24gdGjhu4sNCiAgY29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Vycm9yTG9nJyk7IC8vIHbDuW5nIGLhuqNuZyBs4buXaSB0aOG7nWkgZ2lhbg0KICBpZiAoIWNvbnRhaW5lcikgcmV0dXJuIDA7DQogIHJldHVybiBjb250YWluZXIucXVlcnlTZWxlY3RvckFsbCgndHIuZXJyb3Itcm93JykubGVuZ3RoOw0KfQ0KDQpmdW5jdGlvbiBnZXRDb25mbGljdFRvdGFsKCkgew0KICAvLyDEkOG6v20gxJHDum5nIHRoZW8gc+G7kSBow6BuZyB4dW5nIMSR4buZdCB0cm9uZyBr4bq/dCBxdeG6ow0KICBjb25zdCB0Ym9keSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN1bHRCb2R5Jyk7IC8vIHRib2R5IGPhu6dhIGLhuqNuZyBr4bq/dCBxdeG6ow0KICBpZiAoIXRib2R5KSByZXR1cm4gMDsNCiAgcmV0dXJuIHRib2R5LnF1ZXJ5U2VsZWN0b3JBbGwoJ3RyLmNvbmZsaWN0LXJvdycpLmxlbmd0aDsNCn0NCg0KDQoNCg0KDQoNCg0KDQogICAgICAgZnVuY3Rpb24gZGlzcGxheVJlc3VsdHMocHJvY2VkdXJlcywgc2tpcHBlZFJvd3MgPSAwKSB7DQogICAgYWxsUHJvY2VkdXJlcyA9IHByb2NlZHVyZXM7DQogICAgDQogICAgY29uc3Qgb3BlcmF0b3JzID0gWy4uLm5ldyBTZXQocHJvY2VkdXJlcy5tYXAocCA9PiBwLm9wZXJhdG9yKSldOw0KICAgIGNvbnN0IG9wZXJhdG9yU2VsZWN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ29wZXJhdG9yU2VsZWN0Jyk7DQogICAgY29uc3Qgb3BlcmF0b3JTZWxlY3RFcnJvciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdvcGVyYXRvclNlbGVjdEVycm9yJyk7DQogICAgDQogICAgb3BlcmF0b3JTZWxlY3QuaW5uZXJIVE1MID0gJzxvcHRpb24gdmFsdWU9ImFsbCI+VOG6pXQgY+G6ozwvb3B0aW9uPicgKyANCiAgICAgICAgb3BlcmF0b3JzLm1hcChvcCA9PiBgPG9wdGlvbiB2YWx1ZT0iJHtvcH0iPiR7b3AucmVwbGFjZSgvLC9nLCAnJyl9PC9vcHRpb24+YCkuam9pbignJyk7DQogICAgDQogICAgb3BlcmF0b3JTZWxlY3RFcnJvci5pbm5lckhUTUwgPSBvcGVyYXRvclNlbGVjdC5pbm5lckhUTUw7IC8vIMSQ4buTbmcgYuG7mSBu4buZaSBkdW5nDQogICAgDQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ29wZXJhdG9yRmlsdGVyJykuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7DQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ29wZXJhdG9yRmlsdGVyRXJyb3InKS5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgY29uc3QgY29uZmxpY3RQcm9jZWR1cmVzID0gcHJvY2VkdXJlcy5maWx0ZXIocCA9PiBwLmNvbmZsaWN0KTsNCiAgICAgICAgICAgIGNvbnN0IGNvbmZsaWN0Q291bnQgPSBjb25mbGljdFByb2NlZHVyZXMubGVuZ3RoOw0KICAgICAgICAgICAgDQogICAgICAgICAgICANCiAgICAgICAgICAgIA0KICAgICAgICAgICAgZmlsdGVyQnlPcGVyYXRvcigpOw0KICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN1bHRTZWN0aW9uJykuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7DQogICAgDQogICAgLy8gTuG6v3Uga2jDtG5nIGPDsyBs4buXaSwgY3Xhu5luIHh14buRbmcgcGjhuqduIGvhur90IHF14bqjDQogICAgaWYgKGVycm9yTG9nLmxlbmd0aCA9PT0gMCkgew0KICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsNCiAgICAgICAgICAgIGNvbnN0IHJlc3VsdFNlY3Rpb24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdWx0U2VjdGlvbicpOw0KICAgICAgICAgICAgaWYgKHJlc3VsdFNlY3Rpb24pIHsNCiAgICAgICAgICAgICAgICBzbW9vdGhTY3JvbGxUbyhyZXN1bHRTZWN0aW9uLCAtNDApOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9LCAzMDApOw0KICAgIH0NCn0NCg0KZnVuY3Rpb24gZmlsdGVyQnlPcGVyYXRvcigpIHsNCiAgICBjb25zdCBvcGVyYXRvciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdvcGVyYXRvclNlbGVjdCcpLnZhbHVlOw0KDQogY29uc3Qgc2hvd0RvY3RvciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzaG93RG9jdG9yQ2hlY2tib3gnKS5jaGVja2VkOw0KICAgIGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LnRvZ2dsZSgnc2hvdy1kb2N0b3InLCBzaG93RG9jdG9yKTsNCiAgICAvLyA9PT09PSAxLiBM4buMQyBWw4AgSEnhu4JOIFRI4buKIELhuqJORyBL4bq+VCBRVeG6oiBLSeG7gk0gVFJBIFhVTkcgxJDhu5hUID09PT09DQogICAgY29uc3QgZmlsdGVyZWRQcm9jZWR1cmVzID0gb3BlcmF0b3IgPT09ICdhbGwnIA0KICAgICAgICA/IGFsbFByb2NlZHVyZXMuZmlsdGVyKHAgPT4gcC5jb25mbGljdCkgDQogICAgICAgIDogYWxsUHJvY2VkdXJlcy5maWx0ZXIocCA9PiBwLm9wZXJhdG9yLnJlcGxhY2UoLywvZywgJycpID09PSBvcGVyYXRvci5yZXBsYWNlKC8sL2csICcnKSAmJiBwLmNvbmZsaWN0KTsNCg0KICAgIGNvbnN0IHJlc3VsdEJvZHkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdWx0Qm9keScpOw0KICAgIHJlc3VsdEJvZHkuaW5uZXJIVE1MID0gJyc7DQoNCiAgICAvLyBOaMOzbSBjw6FjIHRo4bunIHRodeG6rXQgeHVuZyDEkeG7mXQgduG7m2kgbmhhdQ0KICAgIGNvbnN0IGNvbmZsaWN0R3JvdXBzID0gW107DQogICAgY29uc3QgcHJvY2Vzc2VkUm93cyA9IG5ldyBTZXQoKTsNCg0KICAgIGZpbHRlcmVkUHJvY2VkdXJlcy5mb3JFYWNoKHByb2MgPT4gew0KICAgICAgICBpZiAoIXByb2Nlc3NlZFJvd3MuaGFzKHByb2Mucm93SW5kZXgpKSB7DQogICAgICAgICAgICBjb25zdCBncm91cCA9IFtwcm9jXTsNCiAgICAgICAgICAgIHByb2Nlc3NlZFJvd3MuYWRkKHByb2Mucm93SW5kZXgpOw0KDQogICAgICAgICAgICAvLyBUw6xtIHRo4bunIHRodeG6rXQgbGnDqm4gcXVhbiB0cm9uZyB4dW5nIMSR4buZdA0KICAgICAgICAgICAgaWYgKHByb2MuY29uZmxpY3RSZWFzb24pIHsNCiAgICAgICAgICAgICAgICBjb25zdCBjb25mbGljdE1hdGNoZXMgPSBwcm9jLmNvbmZsaWN0UmVhc29uLm1hdGNoKC9C4buHbmggbmjDom46ICguKj8pPGJyPuKAoiBOZ8OgeTogKC4qPyk8YnI+4oCiIFRo4budaSBnaWFuOiAoLio/KS0vZyk7DQogICAgICAgICAgICAgICAgaWYgKGNvbmZsaWN0TWF0Y2hlcykgew0KICAgICAgICAgICAgICAgICAgICBjb25mbGljdE1hdGNoZXMuZm9yRWFjaChtYXRjaCA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwYXRpZW50TmFtZSA9IG1hdGNoLm1hdGNoKC9C4buHbmggbmjDom46ICguKj8pPGJyPi8pWzFdOw0KICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZGF0ZSA9IG1hdGNoLm1hdGNoKC9OZ8OgeTogKC4qPyk8YnI+LylbMV07DQogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB0aW1lID0gbWF0Y2gubWF0Y2goL1Ro4budaSBnaWFuOiAoLio/KS0vKVsxXTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY29uZmxpY3RQcm9jID0gZmlsdGVyZWRQcm9jZWR1cmVzLmZpbmQocCA9PiANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwLnBhdGllbnROYW1lID09PSBwYXRpZW50TmFtZSAmJiANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwLmRhdGUgPT09IGRhdGUgJiYgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcC5kaXNwbGF5U3RhcnQgPT09IHRpbWUgJiYNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAhcHJvY2Vzc2VkUm93cy5oYXMocC5yb3dJbmRleCkNCiAgICAgICAgICAgICAgICAgICAgICAgICk7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjb25mbGljdFByb2MpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBncm91cC5wdXNoKGNvbmZsaWN0UHJvYyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvY2Vzc2VkUm93cy5hZGQoY29uZmxpY3RQcm9jLnJvd0luZGV4KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgY29uZmxpY3RHcm91cHMucHVzaChncm91cCk7DQogICAgICAgIH0NCiAgICB9KTsNCg0KICAgLy8gSGnhu4NuIHRo4buLIGvhur90IHF14bqjDQogICAgY29uZmxpY3RHcm91cHMuZm9yRWFjaChncm91cCA9PiB7DQogICAgICAgIGdyb3VwLmZvckVhY2gocHJvYyA9PiB7DQogICAgICAgICAgICBjb25zdCByb3cgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0cicpOw0KICAgICAgICAgICAgcm93LmNsYXNzTGlzdC5hZGQoImhlcmItcm93Iik7DQogICAgICAgICAgICByb3cuY2xhc3NMaXN0LmFkZCgnY29uZmxpY3Qtcm93Jyk7DQogICAgICAgICAgICByb3cuaW5uZXJIVE1MID0gYA0KICAgICAgICAgICAgICAgIDx0ZD4ke3Byb2MucGF0aWVudE5hbWV9IFs8Zm9udCBjb2xvcj0icmVkIj4ke3Byb2MucGF0aWVudEFnZX08L2ZvbnQ+XSA8YnIvPiAke3Byb2MucGF0aWVudElkfTwvdGQ+DQogICAgICAgICAgICAgICAgPHRkPiR7cHJvYy5wcm9jZWR1cmV9PC90ZD4NCiAgICAgICAgICAgICAgICA8dGQ+PGNlbnRlcj4ke3Byb2MuZGF0ZX08YnIvPiR7cHJvYy5kaXNwbGF5U3RhcnR9IC0gJHtwcm9jLmRpc3BsYXlFbmR9PC9jZW50ZXI+PC90ZD4NCiAgICAgICAgICAgICAgICA8dGQgY2xhc3M9ImRvY3Rvci1jb2x1bW4iPiR7cHJvYy5kb2N0b3J9PC90ZD4NCiAgICAgICAgICAgICAgICA8dGQ+JHtwcm9jLm9wZXJhdG9yLnJlcGxhY2UoLywvZywgJycpfTwvdGQ+DQogICAgICAgICAgICAgICAgPHRkIGNsYXNzPSJ0aW1lLXN1Z2dlc3Rpb24iPiR7cHJvYy5zdWdnZXN0aW9uIHx8ICdLaMO0bmcgY8OzIHh1bmcgxJHhu5l0J308L3RkPg0KICAgICAgICAgICAgYDsNCiAgICAgICAgICAgIHJlc3VsdEJvZHkuYXBwZW5kQ2hpbGQocm93KTsNCiAgICAgICAgfSk7DQoNCiAgICAgICAgLy8gVGjDqm0gZMOybmcgcGjDom4gY8OhY2gNCiAgICAgICAgaWYgKGdyb3VwLmxlbmd0aCA+IDApIHsNCiAgICAgICAgICAgIGNvbnN0IHNlcGFyYXRvciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RyJyk7DQogICAgICAgICAgICBzZXBhcmF0b3IuaW5uZXJIVE1MID0gJzx0ZCBjb2xzcGFuPSI4IiBjbGFzcz0iZ3JvdXAtc2VwYXJhdG9yIj48L3RkPic7DQogICAgICAgICAgICByZXN1bHRCb2R5LmFwcGVuZENoaWxkKHNlcGFyYXRvcik7DQogICAgICAgIH0NCiAgICB9KTsNCg0KICAgIC8vIE7hur91IGtow7RuZyBjw7MgbmjDs20gbsOgbyB0aMOsIHRow6ptIGTDsm5nIGLDoW8gIktow7RuZyBjw7MgbOG7l2kiDQogICAgaWYgKGNvbmZsaWN0R3JvdXBzLmxlbmd0aCA9PT0gMCkgew0KICAgICAgICBjb25zdCByb3cgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0cicpOw0KICAgICAgICByb3cuaW5uZXJIVE1MID0gYA0KICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgPHRkIGNvbHNwYW49IjUiY2xhc3M9ImhlcmItcm93IGNvbmZsaWN0LXJvdyI+S2jDtG5nIGPDsyBs4buXaSBuw6BvIMSRxrDhu6NjIGdoaSBuaOG6rW48L3RkPg0KICAgICAgICBgOw0KICAgICAgICByZXN1bHRCb2R5LmFwcGVuZENoaWxkKHJvdyk7DQogICAgfQ0KDQogICAgLy8gPT09PT0gMi4gTOG7jEMgVsOAIEhJ4buCTiBUSOG7iiBC4bqiTkcgTOG7lkkgPT09PT0NCmNvbnN0IG9wZXJhdG9yRXJyb3IgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnb3BlcmF0b3JTZWxlY3RFcnJvcicpLnZhbHVlOw0KIGNvbnN0IGZpbHRlcmVkRXJyb3JzID0gb3BlcmF0b3JFcnJvciA9PT0gJ2FsbCcgDQogICA/IGVycm9yTG9nIA0KICAgOiBlcnJvckxvZy5maWx0ZXIoZXJyb3IgPT4NCiAgICAgICBlcnJvci5kZXRhaWxzICYmDQogICAgICBlcnJvci5kZXRhaWxzLm9wZXJhdG9yICYmDQogICAgICAgZXJyb3IuZGV0YWlscy5vcGVyYXRvci5yZXBsYWNlKC8sL2csICcnKSA9PT0gb3BlcmF0b3JFcnJvci5yZXBsYWNlKC8sL2csICcnKQ0KICAgICk7DQoNCiAgICAvLyBIaeG7g24gdGjhu4sgbOG7l2kgxJHDoyBs4buNYw0KICAgIGNvbnN0IGVycm9yTG9nRGl2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Vycm9yTG9nJyk7DQogICAgaWYgKGZpbHRlcmVkRXJyb3JzLmxlbmd0aCA9PT0gMCkgew0KICAgICAgICBlcnJvckxvZ0Rpdi5pbm5lckhUTUwgPSBgPHRhYmxlIGNsYXNzPSJlcnJvci10YWJsZSI+DQogICAgICAgIDx0aGVhZD4NCiAgICAgICAgICAgIDx0cj4NCiAgICAgICAgICAgICAgPHRoPjxpIGNsYXNzPSJmYXMgZmEtdXNlciBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gVMOqbiBCTjwvdGg+DQogICAgICAgICAgICA8dGg+PGkgY2xhc3M9ImZhcyBmYS1wcm9jZWR1cmVzIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBUaOG7pyB0aHXhuq10PC90aD4NCiAgICAgICAgICAgIDx0aD48aSBjbGFzcz0iZmFzIGZhLXVzZXItbnVyc2UgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IE5nxrDhu51pIHRo4buxYyBoaeG7h248L3RoPg0KICAgICAgICAgICAgPHRoPjxpIGNsYXNzPSJmYXIgZmEtY2xvY2sgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IFRo4budaSBnaWFuPC90aD4NCiAgICAgICAgICAgIDx0aD48aSBjbGFzcz0iZmFzIGZhLWV4Y2xhbWF0aW9uLXRyaWFuZ2xlIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBM4buXaTwvdGg+DQogICAgICAgICAgICA8L3RyPg0KICAgICAgICA8L3RoZWFkPg0KICAgICAgICA8dGJvZHk+IDx0ciBjbGFzcz0iZXJyb3Itcm93Ij4NCiAgICAgICAgICAgICAgICA8dGQgY29sc3Bhbj0iNSIgY2xhc3M9ImVycm9yLWRldGFpbCI+S2jDtG5nIGPDsyBs4buXaSBuw6BvIMSRxrDhu6NjIGdoaSBuaOG6rW48L3RkPjwvdHI+PC90Ym9keT48L3RhYmxlPmA7DQogICAgICAgIHJldHVybjsNCiAgICB9DQoNCiAgICBsZXQgaHRtbCA9IGANCiAgICA8dGFibGUgY2xhc3M9ImVycm9yLXRhYmxlIj4NCiAgICAgICAgPHRoZWFkPg0KICAgICAgICAgICAgPHRyPg0KICAgICAgICAgICAgICA8dGg+PGkgY2xhc3M9ImZhcyBmYS11c2VyIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBUw6puIEJOPC90aD4NCiAgICAgICAgICAgIDx0aD48aSBjbGFzcz0iZmFzIGZhLXByb2NlZHVyZXMgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IFRo4bunIHRodeG6rXQ8L3RoPg0KICAgICAgICAgICAgPHRoIGNsYXNzPSJkb2N0b3ItY29sdW1uIj48aSBjbGFzcz0iZmFzIGZhLXVzZXItbWQgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IELDoWMgc+G7uSBjaOG7iSDEkeG7i25oPC90aD4NCiAgICAgICAgICAgIDx0aD48aSBjbGFzcz0iZmFzIGZhLXVzZXItbnVyc2UgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IE5nxrDhu51pIHRo4buxYyBoaeG7h248L3RoPg0KICAgICAgICAgICAgPHRoPjxpIGNsYXNzPSJmYXIgZmEtY2xvY2sgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IFRo4budaSBnaWFuPC90aD4NCiAgICAgICAgICAgIDx0aD48aSBjbGFzcz0iZmFzIGZhLWV4Y2xhbWF0aW9uLXRyaWFuZ2xlIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBM4buXaTwvdGg+DQogICAgICAgICAgICA8L3RyPg0KICAgICAgICA8L3RoZWFkPg0KICAgICAgICA8dGJvZHk+YDsNCi8vLy8vLy8vQuG6o25nIGzhu41jLy8vLy8vLy8vLy8NCiAgICBmaWx0ZXJlZEVycm9ycy5mb3JFYWNoKGVycm9yID0+IHsNCiAgICAgICAgaWYgKGVycm9yLmRldGFpbHMpIHsNCiAgICAgICAgICAgIGh0bWwgKz0gYA0KICAgICAgICAgICAgPHRyIGNsYXNzPSJlcnJvci1yb3ciPg0KICAgICAgICAgICAgICAgIDx0ZD4ke2Vycm9yLmRldGFpbHMucGF0aWVudE5hbWUgfHwgJ0tow7RuZyBjw7MnfSBbPGZvbnQgY29sb3I9InJlZCI+JHtlcnJvci5kZXRhaWxzLnBhdGllbnRBZ2UgfHwgJzAwJ308L2ZvbnQ+XTxici8+ICR7ZXJyb3IuZGV0YWlscy5wYXRpZW50SWQgfHwgJzAwMDAwMCd9PC90ZD4NCiAgICAgICAgICAgICAgICA8dGQ+JHtlcnJvci5kZXRhaWxzLnByb2NlZHVyZSB8fCAnS2jDtG5nIGPDsyd9PC90ZD4NCgkJCQk8dGQgY2xhc3M9ImRvY3Rvci1jb2x1bW4iPiR7ZXJyb3IuZGV0YWlscy5kb2N0b3IgfHwgJ0tow7RuZyBjw7MnfTwvdGQ+DQogICAgICAgICAgICAgICAgPHRkPiR7ZXJyb3IuZGV0YWlscy5vcGVyYXRvciA/IGVycm9yLmRldGFpbHMub3BlcmF0b3IucmVwbGFjZSgvLC9nLCAnJykgOiAnS2jDtG5nIGPDsyd9PC90ZD4NCiAgICAgICAgICAgICAgICA8dGQ+PGNlbnRlcj4ke2Vycm9yLmRldGFpbHMubmdheVRodWNIaWVuIHx8IChlcnJvci5kZXRhaWxzLmRhdGUgfHwgJ0tow7RuZyBjw7MnKX0gPGJyLz4kew0KICAgICAgICAgICAgICAgICAgICBlcnJvci5kZXRhaWxzLnN0YXJ0VGltZSA/IGAke2Vycm9yLmRldGFpbHMuc3RhcnRUaW1lfSAtICR7ZXJyb3IuZGV0YWlscy5lbmRUaW1lfWAgOiAnS2jDtG5nIGPDsycNCiAgICAgICAgICAgICAgICB9PC9jZW50ZXI+PC90ZD4NCiAgICAgICAgICAgICAgICA8dGQgY2xhc3M9ImVycm9yLWRldGFpbCI+DQogICAgICAgICAgICAgICAgICAgICR7ZXJyb3IubWVzc2FnZX0NCiAgICAgICAgICAgICAgICAgICA8Yj48Zm9udCBjb2xvcj0icmVkIj4ke2Vycm9yLmRldGFpbHMuZXhwZWN0ZWQgPyBgJHtlcnJvci5kZXRhaWxzLmFjdHVhbH0gcGjDunQ8L2ZvbnQ+PC9iPiAoVOG7kWkgdGhp4buDdTogJHtlcnJvci5kZXRhaWxzLmV4cGVjdGVkfSBwaMO6dClgIDogJyd9DQogICAgICAgICAgICAgICAgPC90ZD4NCiAgICAgICAgICAgIDwvdHI+YDsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIGh0bWwgKz0gYA0KICAgICAgICAgICAgPHRyIGNsYXNzPSJlcnJvci1yb3ciPg0KICAgICAgICAgICAgICAgIDx0ZCBjb2xzcGFuPSI1IiBjbGFzcz0iZXJyb3ItZGV0YWlsIj4NCiAgICAgICAgICAgICAgICAgICAgJHtlcnJvci5tZXNzYWdlfSAke2Vycm9yLnJvdyA/ICcoRMOybmcgJyArIGVycm9yLnJvdyArICcpJyA6ICcnfQ0KICAgICAgICAgICAgICAgIDwvdGQ+DQogICAgICAgICAgICA8L3RyPmA7DQogICAgICAgIH0NCiAgICB9KTsNCg0KICAgIGh0bWwgKz0gYDwvdGJvZHk+PC90YWJsZT5gOw0KICAgIGVycm9yTG9nRGl2LmlubmVySFRNTCA9IGh0bWw7DQp9DQoNCg0KDQogICAgICAgIGZ1bmN0aW9uIGxvZ0Vycm9yKG1lc3NhZ2UsIHJvdyA9IG51bGwsIGRldGFpbHMgPSBudWxsKSB7DQogICAgICAgICAgICBlcnJvckxvZy5wdXNoKHsNCiAgICAgICAgICAgICAgICBtZXNzYWdlLA0KICAgICAgICAgICAgICAgIHJvdywNCiAgICAgICAgICAgICAgICBkZXRhaWxzLA0KICAgICAgICAgICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0xvY2FsZVRpbWVTdHJpbmcoKSwNCiAgICAgICAgICAgICAgICB1c2VyOiBjdXJyZW50VXNlcg0KICAgICAgICAgICAgfSk7DQogICAgICAgIH0NCg0KZnVuY3Rpb24gZGlzcGxheUVycm9ycygpIHsNCiAgICBjb25zdCBlcnJvckxvZ0RpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdlcnJvckxvZycpOw0KICAgIA0KICAgIGlmIChlcnJvckxvZy5sZW5ndGggPT09IDApIHsNCiAgICAgICAgZXJyb3JMb2dEaXYuaW5uZXJIVE1MID0gJzxwPktow7RuZyBjw7MgbOG7l2kgbsOgbyDEkcaw4bujYyBnaGkgbmjhuq1uPC9wPic7DQogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdlcnJvclNlY3Rpb24nKS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOw0KICAgICAgICANCiAgICAgICAgLy8gTuG6v3Uga2jDtG5nIGPDsyBs4buXaSwgY3Xhu5luIHh14buRbmcgcGjhuqduIEvhur90IFF14bqjIEtp4buDbSBUcmENCiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7DQogICAgICAgICAgICBjb25zdCByZXN1bHRTZWN0aW9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlc3VsdFNlY3Rpb24nKTsNCiAgICAgICAgICAgIGlmIChyZXN1bHRTZWN0aW9uICYmIHJlc3VsdFNlY3Rpb24uc3R5bGUuZGlzcGxheSAhPT0gJ25vbmUnKSB7DQogICAgICAgICAgICAgICAgc21vb3RoU2Nyb2xsVG8ocmVzdWx0U2VjdGlvbiwgLTQwKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwgMzAwKTsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCiAgICANCiAgICBsZXQgaHRtbCA9IGANCiAgICA8dGFibGUgY2xhc3M9ImVycm9yLXRhYmxlIj4NCiAgICAgICAgPHRoZWFkPg0KICAgICAgICAgICAgPHRyPg0KICAgICAgICAgICAgIDx0aD48aSBjbGFzcz0iZmFzIGZhLXVzZXIgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IFTDqm4gQk48L3RoPg0KICAgICAgICAgICAgPHRoPjxpIGNsYXNzPSJmYXMgZmEtcHJvY2VkdXJlcyBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gVGjhu6cgdGh14bqtdDwvdGg+DQogICAgICAgICAgICA8dGggY2xhc3M9ImRvY3Rvci1jb2x1bW4iPjxpIGNsYXNzPSJmYXMgZmEtdXNlci1tZCBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gQsOhYyBz4bu5IGNo4buJIMSR4buLbmg8L3RoPg0KICAgICAgICAgICAgPHRoPjxpIGNsYXNzPSJmYXMgZmEtdXNlci1udXJzZSBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gTmfGsOG7nWkgdGjhu7FjIGhp4buHbjwvdGg+DQogICAgICAgICAgICA8dGg+PGkgY2xhc3M9ImZhciBmYS1jbG9jayBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gVGjhu51pIGdpYW48L3RoPg0KICAgICAgICAgICAgPHRoPjxpIGNsYXNzPSJmYXMgZmEtZXhjbGFtYXRpb24tdHJpYW5nbGUgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IEzhu5dpPC90aD4NCiAgICAgICAgICAgIDwvdHI+DQogICAgICAgIDwvdGhlYWQ+DQogICAgICAgIDx0Ym9keT5gOw0KICAgIA0KICAgIC8vIEhp4buDbiB0aOG7iyB04burbmcgbOG7l2kNCiAgICBlcnJvckxvZy5mb3JFYWNoKGVycm9yID0+IHsNCiAgICAgICAgaWYgKGVycm9yLmRldGFpbHMpIHsNCiAgICAgICAgICAgIGh0bWwgKz0gYA0KICAgICAgICAgICAgPHRyIGNsYXNzPSJlcnJvci1yb3ciPg0KICAgICAgICAgICAgICAgIDx0ZD4ke2Vycm9yLmRldGFpbHMucGF0aWVudE5hbWUgfHwgJ0tow7RuZyBjw7MnfSBbPGZvbnQgY29sb3I9InJlZCI+JHtlcnJvci5kZXRhaWxzLnBhdGllbnRBZ2UgfHwgJzAwJ308L2ZvbnQ+XTxici8+ICR7ZXJyb3IuZGV0YWlscy5wYXRpZW50SWQgfHwgJzAwMDAwMCd9PC90ZD4NCiAgICAgICAgICAgICAgICA8dGQ+JHtlcnJvci5kZXRhaWxzLnByb2NlZHVyZSB8fCAnS2jDtG5nIGPDsyd9PC90ZD4NCiAgICAgICAgICAgICAgICA8dGQgY2xhc3M9ImRvY3Rvci1jb2x1bW4iPiR7ZXJyb3IuZGV0YWlscy5kb2N0b3IgfHwgJ0tow7RuZyBjw7MnfTwvdGQ+DQogICAgICAgICAgICAgICAgPHRkPiR7ZXJyb3IuZGV0YWlscy5vcGVyYXRvciA/IGVycm9yLmRldGFpbHMub3BlcmF0b3IucmVwbGFjZSgvLC9nLCAnJykgOiAnS2jDtG5nIGPDsyd9PC90ZD4NCiAgICAgICAgICAgICAgICA8dGQ+PGNlbnRlcj4ke2Vycm9yLmRldGFpbHMubmdheVRodWNIaWVuIHx8IChlcnJvci5kZXRhaWxzLmRhdGUgfHwgJ0tow7RuZyBjw7MnKX0gPGJyLz4ke2Vycm9yLmRldGFpbHMuc3RhcnRUaW1lID8gYCR7ZXJyb3IuZGV0YWlscy5zdGFydFRpbWV9IC0gJHtlcnJvci5kZXRhaWxzLmVuZFRpbWV9YCA6ICdLaMO0bmcgY8OzJ308L2NlbnRlcj48L3RkPg0KICAgICAgICAgICAgICAgIDx0ZCBjbGFzcz0iZXJyb3ItZGV0YWlsIj4NCiAgICAgICAgICAgICAgICAgICAgJHtlcnJvci5tZXNzYWdlfQ0KICAgICAgICAgICAgICAgICAgICA8Yj48Zm9udCBjb2xvcj0icmVkIj4ke2Vycm9yLmRldGFpbHMuZXhwZWN0ZWQgPyBgJHtlcnJvci5kZXRhaWxzLmFjdHVhbH0gcGjDunQ8L2ZvbnQ+PC9iPiAgIChU4buRaSB0aGnhu4N1OiAke2Vycm9yLmRldGFpbHMuZXhwZWN0ZWR9IHBow7p0KWAgOiAnJ30NCiAgICAgICAgICAgICAgICA8L3RkPg0KICAgICAgICAgICAgPC90cj5gOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgaHRtbCArPSBgDQogICAgICAgICAgICA8dHIgY2xhc3M9ImVycm9yLXJvdyI+DQogICAgICAgICAgICAgICAgPHRkIGNvbHNwYW49IjYiIGNsYXNzPSJlcnJvci1kZXRhaWwiPg0KICAgICAgICAgICAgICAgICAgICAke2Vycm9yLm1lc3NhZ2V9ICR7ZXJyb3Iucm93ID8gJyhEw7JuZyAnICsgZXJyb3Iucm93ICsgJyknIDogJyd9DQogICAgICAgICAgICAgICAgPC90ZD4NCiAgICAgICAgICAgIDwvdHI+YDsNCiAgICAgICAgfQ0KICAgIH0pOw0KICAgIA0KICAgIGh0bWwgKz0gYDwvdGJvZHk+PC90YWJsZT5gOw0KICAgIA0KICAgIGVycm9yTG9nRGl2LmlubmVySFRNTCA9IGh0bWw7DQogICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZXJyb3JTZWN0aW9uJykuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7DQogICAgDQogICAgLy8gQ3Xhu5luIHh14buRbmcgcGjhuqduIGzhu5dpIG7hur91IGPDsw0KICAgIHNldFRpbWVvdXQoKCkgPT4gew0KICAgICAgICBjb25zdCBlcnJvclNlY3Rpb24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZXJyb3JTZWN0aW9uJyk7DQogICAgICAgIGlmIChlcnJvclNlY3Rpb24pIHsNCiAgICAgICAgICAgIHNtb290aFNjcm9sbFRvKGVycm9yU2VjdGlvbiwgLTEzMCk7DQogICAgICAgIH0NCiAgICB9LCAzMDApOw0KfQ0KDQovLyBIw6BtIGN14buZbiBtxrDhu6N0IHThu5VuZyBxdcOhdA0KZnVuY3Rpb24gc21vb3RoU2Nyb2xsVG8oZWxlbWVudCwgb2Zmc2V0ID0gMCkgew0KICAgIGVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnaGlnaGxpZ2h0LWVycm9yLXNlY3Rpb24nKTsNCiAgICANCiAgICBjb25zdCBlbGVtZW50UG9zaXRpb24gPSBlbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLnRvcDsNCiAgICBjb25zdCBvZmZzZXRQb3NpdGlvbiA9IGVsZW1lbnRQb3NpdGlvbiArIHdpbmRvdy5wYWdlWU9mZnNldCAtIG9mZnNldDsNCiAgICANCiAgICBjb25zdCBkdXJhdGlvbiA9IDE1MDA7DQogICAgY29uc3Qgc3RhcnQgPSB3aW5kb3cucGFnZVlPZmZzZXQ7DQogICAgY29uc3Qgc3RhcnRUaW1lID0gcGVyZm9ybWFuY2Uubm93KCk7DQogICAgDQogICAgZnVuY3Rpb24gc2Nyb2xsU3RlcCh0aW1lc3RhbXApIHsNCiAgICAgICAgY29uc3QgZWxhcHNlZCA9IHRpbWVzdGFtcCAtIHN0YXJ0VGltZTsNCiAgICAgICAgY29uc3QgcHJvZ3Jlc3MgPSBNYXRoLm1pbihlbGFwc2VkIC8gZHVyYXRpb24sIDEpOw0KICAgICAgICBjb25zdCBlYXNpbmcgPSBlYXNlSW5PdXRDdWJpYyhwcm9ncmVzcyk7DQogICAgICAgIHdpbmRvdy5zY3JvbGxUbygwLCBzdGFydCArIChvZmZzZXRQb3NpdGlvbiAtIHN0YXJ0KSAqIGVhc2luZyk7DQogICAgICAgIA0KICAgICAgICBpZiAocHJvZ3Jlc3MgPCAxKSB7DQogICAgICAgICAgICB3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lKHNjcm9sbFN0ZXApOw0KICAgICAgICB9DQogICAgfQ0KICAgIA0KICAgIGZ1bmN0aW9uIGVhc2VJbk91dEN1YmljKHQpIHsNCiAgICAgICAgcmV0dXJuIHQgPCAwLjUgPyA0ICogdCAqIHQgKiB0IDogMSAtIE1hdGgucG93KC0yICogdCArIDIsIDMpIC8gMjsNCiAgICB9DQogICAgDQogICAgd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZShzY3JvbGxTdGVwKTsNCiAgICANCiAgICBzZXRUaW1lb3V0KCgpID0+IHsNCiAgICAgICAgZWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdoaWdobGlnaHQtZXJyb3Itc2VjdGlvbicpOw0KICAgIH0sIDIwMDApOw0KfQ0KDQoNCiAvLyA9PT09PT0gQuG6rlQgU+G7sCBLSeG7hk4gQ0hFQ0tCT1ggIkNo4buJIGhp4buDbiB0aOG7iyBuZ8OgeSBz4bqvYyB0aHXhu5FjIGzhu5dpIiA9PT09PT0NCmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzaG93SGVyYkVycm9yRGF5c0NoZWNrYm94JykuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgZnVuY3Rpb24gKCkgew0KICAgIGNvbnN0IHNob3dPbmx5RXJyb3JEYXlzID0gdGhpcy5jaGVja2VkOw0KDQogICAgLy8gMS4gTOG6pXkgdG/DoG4gYuG7mSBuZ8OgeSB04burIGFsbFByb2NlZHVyZXMNCiAgICBjb25zdCBhbGxEYXRlcyA9IFsuLi5uZXcgU2V0KGFsbFByb2NlZHVyZXMubWFwKHAgPT4gcC5kYXRlKSldOw0KDQogICAgLy8gMi4gTuG6v3UgYuG6rXQgY2hlY2tib3ggLT4gY2jhu4kgZ2nhu68gbmfDoHkgY8OzIHPhuq9jIHRodeG7kWMgbOG7l2kNCiAgICBsZXQgZGF0ZXNUb1Nob3cgPSBhbGxEYXRlczsNCiAgICBpZiAoc2hvd09ubHlFcnJvckRheXMpIHsNCiAgICAgICAgY29uc3QgaGVyYkRhdGVzID0gbmV3IFNldCgod2luZG93LmFsbEhlcmJQcm9jZWR1cmVzIHx8IFtdKS5tYXAoaCA9PiBoLmRhdGUpKTsNCiAgICAgICAgZGF0ZXNUb1Nob3cgPSBhbGxEYXRlcy5maWx0ZXIoZCA9PiBoZXJiRGF0ZXMuaGFzKGQpKTsNCiAgICB9DQoNCiAgICAvLyAzLiBD4bqtcCBuaOG6rXQgZHJvcGRvd24gR2nhu50gdHLhu5FuZyAoZmlsdGVyRGF0ZSkNCiAgICBjb25zdCBmaWx0ZXJEYXRlU2VsZWN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ZpbHRlckRhdGUnKTsNCiAgICBpZiAoZmlsdGVyRGF0ZVNlbGVjdCkgew0KICAgICAgICBmaWx0ZXJEYXRlU2VsZWN0LmlubmVySFRNTCA9IGA8b3B0aW9uIHZhbHVlPSJhbGwiPlThuqV0IGPhuqM8L29wdGlvbj5gICsNCiAgICAgICAgICAgIGRhdGVzVG9TaG93Lm1hcChkID0+IGA8b3B0aW9uIHZhbHVlPSIke2R9Ij4ke2R9PC9vcHRpb24+YCkuam9pbignJyk7DQogICAgfQ0KDQogICAgLy8gNC4gQ+G6rXAgbmjhuq10IGRyb3Bkb3duIFPhuq9jIHRodeG7kWMgdGhhbmcgKGhlcmJEYXRlRmlsdGVyKQ0KICAgIGNvbnN0IGhlcmJEYXRlU2VsZWN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2hlcmJEYXRlRmlsdGVyJyk7DQogICAgaWYgKGhlcmJEYXRlU2VsZWN0KSB7DQogICAgICAgIGhlcmJEYXRlU2VsZWN0LmlubmVySFRNTCA9IGA8b3B0aW9uIHZhbHVlPSJhbGwiPlThuqV0IGPhuqM8L29wdGlvbj5gICsNCiAgICAgICAgICAgIGRhdGVzVG9TaG93Lm1hcChkID0+IGA8b3B0aW9uIHZhbHVlPSIke2R9Ij4ke2R9PC9vcHRpb24+YCkuam9pbignJyk7DQogICAgfQ0KfSk7DQoNCg0KICAgICAgICBmdW5jdGlvbiBwYXJzZURhdGVUaW1lKGRhdGV0aW1lU3RyLCByb3dJbmRleCkgew0KICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgICBpZiAoIWRhdGV0aW1lU3RyKSB7DQogICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgZGF0ZXRpbWVTdHIgPT09ICdudW1iZXInKSB7DQogICAgICAgICAgICAgICAgICAgIGNvbnN0IGV4Y2VsRGF0ZSA9IG5ldyBEYXRlKE1hdGgucm91bmQoKGRhdGV0aW1lU3RyIC0gMjU1NjkpICogODY0MDAgKiAxMDAwKSk7DQogICAgICAgICAgICAgICAgICAgIGNvbnN0IGRheSA9IGV4Y2VsRGF0ZS5nZXREYXRlKCk7DQogICAgICAgICAgICAgICAgICAgIGNvbnN0IG1vbnRoID0gZXhjZWxEYXRlLmdldE1vbnRoKCkgKyAxOw0KICAgICAgICAgICAgICAgICAgICBjb25zdCB5ZWFyID0gZXhjZWxEYXRlLmdldEZ1bGxZZWFyKCk7DQogICAgICAgICAgICAgICAgICAgIGNvbnN0IGhvdXJzID0gZXhjZWxEYXRlLmdldEhvdXJzKCk7DQogICAgICAgICAgICAgICAgICAgIGNvbnN0IG1pbnV0ZXMgPSBleGNlbERhdGUuZ2V0TWludXRlcygpOw0KICAgICAgICAgICAgICAgICAgICBjb25zdCBzZWNvbmRzID0gZXhjZWxEYXRlLmdldFNlY29uZHMoKTsNCiAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgIHJldHVybiB7DQogICAgICAgICAgICAgICAgICAgICAgICBkYXRlT2JqOiBleGNlbERhdGUsDQogICAgICAgICAgICAgICAgICAgICAgICBkYXRlS2V5OiBgJHtkYXl9LyR7bW9udGh9LyR7eWVhcn1gLA0KICAgICAgICAgICAgICAgICAgICAgICAgbWludXRlczogaG91cnMgKiA2MCArIG1pbnV0ZXMsDQogICAgICAgICAgICAgICAgICAgICAgICBzZWNvbmRzOiBob3VycyAqIDM2MDAgKyBtaW51dGVzICogNjAgKyBzZWNvbmRzLA0KICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGxheVRpbWU6IGAke2hvdXJzLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgJzAnKX06JHttaW51dGVzLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgJzAnKX06JHtzZWNvbmRzLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgJzAnKX1gDQogICAgICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICAgICAgfSANCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGRhdGV0aW1lU3RyID09PSAnc3RyaW5nJykgew0KICAgICAgICAgICAgICAgICAgICBsZXQgZGF0ZVBhcnQsIHRpbWVQYXJ0ID0gJzAwOjAwOjAwJzsNCiAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGV0aW1lU3RyLmluY2x1ZGVzKCcgJykpIFtkYXRlUGFydCwgdGltZVBhcnRdID0gZGF0ZXRpbWVTdHIuc3BsaXQoJyAnKTsNCiAgICAgICAgICAgICAgICAgICAgZWxzZSBkYXRlUGFydCA9IGRhdGV0aW1lU3RyOw0KICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgbGV0IGRheSwgbW9udGgsIHllYXI7DQogICAgICAgICAgICAgICAgICAgIGlmIChkYXRlUGFydC5pbmNsdWRlcygnLycpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwYXJ0cyA9IGRhdGVQYXJ0LnNwbGl0KCcvJyk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAocGFydHMubGVuZ3RoID09PSAzKSBbZGF5LCBtb250aCwgeWVhcl0gPSBwYXJ0cy5tYXAoTnVtYmVyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKHBhcnRzLmxlbmd0aCA9PT0gMikgW2RheSwgbW9udGhdID0gcGFydHMubWFwKE51bWJlciksIHllYXIgPSBuZXcgRGF0ZSgpLmdldEZ1bGxZZWFyKCk7DQogICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZGF0ZVBhcnQuaW5jbHVkZXMoJy0nKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcGFydHMgPSBkYXRlUGFydC5zcGxpdCgnLScpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBhcnRzLmxlbmd0aCA9PT0gMykgW3llYXIsIG1vbnRoLCBkYXldID0gcGFydHMubWFwKE51bWJlcik7DQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChwYXJ0cy5sZW5ndGggPT09IDIpIFttb250aCwgZGF5XSA9IHBhcnRzLm1hcChOdW1iZXIpLCB5ZWFyID0gbmV3IERhdGUoKS5nZXRGdWxsWWVhcigpOw0KICAgICAgICAgICAgICAgICAgICB9IGVsc2UgdGhyb3cgbmV3IEVycm9yKCfEkOG7i25oIGThuqFuZyBuZ8OgeSBraMO0bmcgxJHGsOG7o2MgaOG7lyB0cuG7oycpOw0KICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgaWYgKGlzTmFOKGRheSkgfHwgaXNOYU4obW9udGgpIHx8IGlzTmFOKHllYXIpIHx8IGRheSA8IDEgfHwgZGF5ID4gMzEgfHwgbW9udGggPCAxIHx8IG1vbnRoID4gMTIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignR2nDoSB0cuG7iyBuZ8OgeSBraMO0bmcgaOG7o3AgbOG7hycpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICBsZXQgaG91cnMgPSAwLCBtaW51dGVzID0gMCwgc2Vjb25kcyA9IDA7DQogICAgICAgICAgICAgICAgICAgIGlmICh0aW1lUGFydC5pbmNsdWRlcygnOicpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB0aW1lUGFydHMgPSB0aW1lUGFydC5zcGxpdCgnOicpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaG91cnMgPSBwYXJzZUludCh0aW1lUGFydHNbMF0pIHx8IDA7DQogICAgICAgICAgICAgICAgICAgICAgICBtaW51dGVzID0gcGFyc2VJbnQodGltZVBhcnRzWzFdKSB8fCAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgc2Vjb25kcyA9IHBhcnNlSW50KHRpbWVQYXJ0c1syXSkgfHwgMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlzTmFOKGhvdXJzKSB8fCBpc05hTihtaW51dGVzKSB8fCBpc05hTihzZWNvbmRzKSB8fCANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBob3VycyA8IDAgfHwgaG91cnMgPiAyMyB8fCBtaW51dGVzIDwgMCB8fCBtaW51dGVzID4gNTkgfHwgc2Vjb25kcyA8IDAgfHwgc2Vjb25kcyA+IDU5KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9nRXJyb3IoJ0dpw6EgdHLhu4sgdGjhu51pIGdpYW4ga2jDtG5nIGjhu6NwIGzhu4cnLCByb3dJbmRleCwgeyB0aW1lOiB0aW1lUGFydCB9KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBob3VycyA9IDA7IG1pbnV0ZXMgPSAwOyBzZWNvbmRzID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgY29uc3QgZGF0ZU9iaiA9IG5ldyBEYXRlKHllYXIsIG1vbnRoIC0gMSwgZGF5LCBob3VycywgbWludXRlcywgc2Vjb25kcyk7DQogICAgICAgICAgICAgICAgICAgIGlmIChpc05hTihkYXRlT2JqLmdldFRpbWUoKSkpIHRocm93IG5ldyBFcnJvcignTmfDoHkga2jDtG5nIGjhu6NwIGzhu4cnKTsNCiAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgIGNvbnN0IHNlY29uZHNJbkRheSA9IGhvdXJzICogMzYwMCArIG1pbnV0ZXMgKiA2MCArIHNlY29uZHM7DQogICAgICAgICAgICAgICAgICAgIGNvbnN0IG1pbnV0ZXNJbkRheSA9IGhvdXJzICogNjAgKyBtaW51dGVzOw0KICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGVPYmosDQogICAgICAgICAgICAgICAgICAgICAgICBkYXRlS2V5OiBgJHtkYXl9LyR7bW9udGh9LyR7eWVhcn1gLA0KICAgICAgICAgICAgICAgICAgICAgICAgbWludXRlczogbWludXRlc0luRGF5LA0KICAgICAgICAgICAgICAgICAgICAgICAgc2Vjb25kczogc2Vjb25kc0luRGF5LA0KICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGxheVRpbWU6IGAke2hvdXJzLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgJzAnKX06JHttaW51dGVzLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgJzAnKX06JHtzZWNvbmRzLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgJzAnKX1gDQogICAgICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignxJDhu4tuaCBk4bqhbmcgdGjhu51pIGdpYW4ga2jDtG5nIMSRxrDhu6NjIGjhu5cgdHLhu6MnKTsNCiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgICAgICAgICAgbG9nRXJyb3IoYEzhu5dpIHBow6JuIHTDrWNoIHRo4budaSBnaWFuOiAke2Vycm9yLm1lc3NhZ2V9YCwgcm93SW5kZXgsIHsgDQogICAgICAgICAgICAgICAgICAgIHZhbHVlOiBkYXRldGltZVN0ciwNCiAgICAgICAgICAgICAgICAgICAgZXJyb3JEZXRhaWxzOiBlcnJvci5zdGFjayANCiAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIC8vID09PT09PT09PT0gS0jhu55JIFThuqBPIFPhu7AgS0nhu4ZOID09PT09PT09PT0gLy8NCiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKCkgew0KCQlkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndXNlcm5hbWVJbnB1dCcpLmZvY3VzKCk7DQogICAgICAgICAgICAvLyBLaGkgdHJhbmcgbG9hZA0KICAgICAgICAgICAgaWYgKCFzZXNzaW9uU3RvcmFnZS5nZXRJdGVtKCdtZWRVc2VyJykpIHsNCiAgICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC5hZGQoJ2xvZ2luLXBhZ2UnKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gS2nhu4NtIHRyYSDEkcSDbmcgbmjhuq1wIGtoaSB0cmFuZyB04bqjaQ0KCQkNCgkJCQ0KICAgICAgICAgICAgY2hlY2tTYXZlZExvZ2luKCk7DQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIEfDoW4gc+G7sSBraeG7h24gY2hvIG7DunQgxJHEg25nIG5o4bqtcA0KICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvZ2luQnRuJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7DQogICAgaXNMb2dpbkFjdGlvbiA9IHRydWU7IC8vIOKchSBUaMOqbSBkw7JuZyBuw6B5DQogICAgY2hlY2tMb2dpbigpOw0KfSk7DQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIEfDoW4gc+G7sSBraeG7h24gY2hvIG7DunQgxJHEg25nIHh14bqldA0KICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvZ291dEJ0bicpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gew0KICAgIGlzTG9naW5BY3Rpb24gPSBmYWxzZTsgLy8g4pyFIFRow6ptIGTDsm5nIG7DoHkNCiAgICBsb2dvdXQoKTsNCn0pOw0KDQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIMSQxINuZyBuaOG6rXAgYuG6sW5nIHBow61tIEVudGVyDQogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGFzc3dvcmRJbnB1dCcpLmFkZEV2ZW50TGlzdGVuZXIoJ2tleXVwJywgZnVuY3Rpb24oZXZlbnQpIHsNCiAgICAgICAgICAgICAgICBpZiAoZXZlbnQua2V5ID09PSAnRW50ZXInKSB7DQogICAgICAgICAgICAgICAgICAgIGNoZWNrTG9naW4oKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9KTsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gR8OhbiBz4buxIGtp4buHbiBjaG8gbsO6dCBwaMOibiB0w61jaCBmaWxlDQogICAgICAgICAgICANCmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhbmFseXplQnRuJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBhc3luYyAoKSA9PiB7DQogIGF3YWl0IGVuc3VyZVhMU1goKTsgLy8gbuG6oXAgWExTWCDEkcO6bmcgbMO6YyBkw7luZw0KICAgIGNvbnN0IGZpbGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZmlsZUlucHV0JykuZmlsZXNbMF07DQppZiAoIWZpbGUpIHsNCiAgICBjb25zdCBwb3B1cCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2FkaW5nUG9wdXAnKTsNCiAgICBjb25zdCBsb2FkaW5nVGV4dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2FkaW5nVGV4dCcpOw0KICAgIGNvbnN0IHByb2dyZXNzQmFyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Byb2dyZXNzQmFyJyk7DQoNCiAgICBsb2FkaW5nVGV4dC5pbm5lckhUTUwgPSBgDQogICAgICAgIDxpIGNsYXNzPSJmYXMgZmEtZXhjbGFtYXRpb24tdHJpYW5nbGUiIHN0eWxlPSJmb250LXNpemU6MjRweDtjb2xvcjpyZWQ7bWFyZ2luLWJvdHRvbToxMHB4OyI+PC9pPjxici8+DQogICAgICAgIDxzdHJvbmc+VnVpIGzDsm5nIGNo4buNbiBmaWxlIHRyxrDhu5tjIGtoaSBraeG7g20gdHJhPC9zdHJvbmc+PGJyLz48YnIvPg0KICAgICAgICA8YnV0dG9uIGNsYXNzPSJidG4iIG9uY2xpY2s9ImRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2FkaW5nUG9wdXAnKS5zdHlsZS5kaXNwbGF5PSdub25lJyI+xJDDs25nPC9idXR0b24+DQogICAgYDsNCiAgICBwcm9ncmVzc0Jhci5zdHlsZS53aWR0aCA9ICcwJSc7DQogICAgDQogICAgcG9wdXAuc3R5bGUuZGlzcGxheSA9ICdmbGV4JzsNCiAgICBwb3B1cC5jbGFzc0xpc3QuYWRkKCdzaG93Jyk7DQogICAgcmV0dXJuOw0KfQ0KDQoNCiAgICBjb25zdCBwb3B1cCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2FkaW5nUG9wdXAnKTsNCiAgICBjb25zdCBsb2FkaW5nVGV4dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2FkaW5nVGV4dCcpOw0KICAgIGNvbnN0IHByb2dyZXNzQmFyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Byb2dyZXNzQmFyJyk7DQoNCiAgICBwb3B1cC5zdHlsZS5kaXNwbGF5ID0gJ2ZsZXgnOw0KICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZSgoKSA9PiBwb3B1cC5jbGFzc0xpc3QuYWRkKCdzaG93JykpOw0KDQogICAgbG9hZGluZ1RleHQuaW5uZXJIVE1MID0gJzxpIGNsYXNzPSJmYXMgZmEtcGFwZXItcGxhbmUiIHN0eWxlPSJmb250LXNpemU6MjRweDtjb2xvcjojMzQ5OGRiO21hcmdpbi1ib3R0b206MTBweDsiPjwvaT48YnIvPsSQYW5nIGfhu61pIGThu68gbGnhu4d1IHbhu4EgbcOheSBjaOG7py4uLic7DQogICAgcHJvZ3Jlc3NCYXIuc3R5bGUud2lkdGggPSAnMzMlJzsNCgkNCgkNCgkNCgljb25zdCBwcm9ncmVzc0JhckNvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwcm9ncmVzc0JhckNvbnRhaW5lcicpOw0KDQovLyBDaOG7iSB04bqhbyAxIGzhuqduDQppZiAoIWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjcmVkaXRMaW5lQmVsb3cnKSkgew0KICBjb25zdCBjcmVkaXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsNCiAgY3JlZGl0LmlkID0gJ2NyZWRpdExpbmVCZWxvdyc7DQogIGNyZWRpdC5pbm5lclRleHQgPSAnwqkgVGhp4bq/dCBr4bq/ICYgcGjDoXQgdHJp4buDbiBi4bufaSBDaMOidSBIdeG7s25oJzsNCiAgY3JlZGl0LnN0eWxlLm1hcmdpblRvcCA9ICcxMHB4JzsNCiAgY3JlZGl0LnN0eWxlLmZvbnRTaXplID0gJzE2cHgnOw0KICBjcmVkaXQuc3R5bGUuY29sb3IgPSAnI0ZGMDAwMCc7DQogIGNyZWRpdC5zdHlsZS50ZXh0QWxpZ24gPSAnY2VudGVyJzsNCg0KICBwcm9ncmVzc0JhckNvbnRhaW5lci5wYXJlbnROb2RlLmluc2VydEJlZm9yZShjcmVkaXQsIHByb2dyZXNzQmFyQ29udGFpbmVyLm5leHRTaWJsaW5nKTsNCn0NCgkNCgkNCgkNCgkNCiAgICBhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHJlcXVlc3RBbmltYXRpb25GcmFtZSgoKSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIDUwKSkpOw0KICAgIGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCA3MDApKTsNCg0KICAgIHByb2dyZXNzQmFyLnN0eWxlLndpZHRoID0gJzY2JSc7DQoNCiAgICBsZXQgdG90YWwgPSAwOw0KICAgIHRyeSB7DQogICAgICAgIGNvbnN0IGZpbGVSZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpOw0KICAgICAgICBjb25zdCBkYXRhID0gYXdhaXQgbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4gew0KICAgICAgICAgICAgZmlsZVJlYWRlci5vbmxvYWQgPSBlID0+IHJlc29sdmUobmV3IFVpbnQ4QXJyYXkoZS50YXJnZXQucmVzdWx0KSk7DQogICAgICAgICAgICBmaWxlUmVhZGVyLm9uZXJyb3IgPSAoKSA9PiByZWplY3QobmV3IEVycm9yKCJM4buXaSDEkeG7jWMgZmlsZSIpKTsNCiAgICAgICAgICAgIGZpbGVSZWFkZXIucmVhZEFzQXJyYXlCdWZmZXIoZmlsZSk7DQogICAgICAgIH0pOw0KDQogICAgICAgIGNvbnN0IHdvcmtib29rID0gWExTWC5yZWFkKGRhdGEsIHsgdHlwZTogJ2FycmF5JyB9KTsNCiAgICAgICAgY29uc3QgZmlyc3RTaGVldCA9IHdvcmtib29rLlNoZWV0c1t3b3JrYm9vay5TaGVldE5hbWVzWzFdXTsNCiAgICAgICAgY29uc3QganNvbkRhdGEgPSBYTFNYLnV0aWxzLnNoZWV0X3RvX2pzb24oZmlyc3RTaGVldCwgew0KICAgICAgICAgICAgaGVhZGVyOiAxLA0KICAgICAgICAgICAgZGVmdmFsOiAiIiwNCiAgICAgICAgICAgIGJsYW5rcm93czogdHJ1ZQ0KICAgICAgICB9KTsNCg0KICAgICAgICBjb25zdCByb3dzID0ganNvbkRhdGEuc2xpY2UoOSk7DQogICAgICAgIHRvdGFsID0gcm93cy5sZW5ndGg7DQogICAgfSBjYXRjaCB7DQogICAgICAgIHRvdGFsID0gMTAwMDsNCiAgICB9DQoNCiAgICBjb25zdCBzdGVwID0gMTAwOw0KICAgIGNvbnN0IHN0ZXBzID0gTWF0aC5jZWlsKHRvdGFsIC8gc3RlcCk7DQogICAgY29uc3QgaW50ZXJ2YWwgPSAyNjAwIC8gc3RlcHM7DQoNCiAgICBmb3IgKGxldCBpID0gMTsgaSA8PSBzdGVwczsgaSsrKSB7DQogICAgICAgIGNvbnN0IGN1cnJlbnQgPSBNYXRoLm1pbihpICogc3RlcCwgdG90YWwpOw0KICAgICAgICBsb2FkaW5nVGV4dC5pbm5lckhUTUwgPSAnPGkgY2xhc3M9ImZhcyBmYS11c2VyLW1kIiBzdHlsZT0iZm9udC1zaXplOjI0cHg7Y29sb3I6IzI5ODBiOTttYXJnaW4tYm90dG9tOjEwcHg7Ij48L2k+PGJyLz7EkGFuZyBwaMOibiB0w61jaCBk4buvIGxp4buHdSB04burbmcgYuG7h25oIG5ow6JuLi4uPGJyPicgKyBjdXJyZW50ICsgJyAvICcgKyB0b3RhbDsNCiAgICAgICAgYXdhaXQgbmV3IFByb21pc2UociA9PiBzZXRUaW1lb3V0KHIsIGludGVydmFsKSk7DQogICAgfQ0KDQogICAgbG9hZGluZ1RleHQuaW5uZXJIVE1MID0gJzxpIGNsYXNzPSJmYXMgZmEtY2hlY2stY2lyY2xlIiBzdHlsZT0iZm9udC1zaXplOjI0cHg7Y29sb3I6Z3JlZW47bWFyZ2luLWJvdHRvbToxMHB4OyI+PC9pPjxici8+xJDDoyBraeG7g20gdHJhIHhvbmcuLi4nOw0KICAgIHByb2dyZXNzQmFyLnN0eWxlLndpZHRoID0gJzEwMCUnOw0KICAgIGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCAxMDAwKSk7DQoNCmlmICghd2luZG93LmlzS2hvYUxvaSkgew0KICAgIHBvcHVwLmNsYXNzTGlzdC5yZW1vdmUoJ3Nob3cnKTsNCiAgICBzZXRUaW1lb3V0KCgpID0+IHsgcG9wdXAuc3R5bGUuZGlzcGxheSA9ICdub25lJzsgfSwgNTAwKTsNCg0KDQp9DQoNCg0KDQogZWxzZSB7DQogICAgLy8gTuG6v3UgxJFhbmcgbOG7l2kgS2hvYSwgS0jDlE5HIMSRxrDhu6NjIOG6qW4gcG9wdXANCiAgICBwb3B1cC5jbGFzc0xpc3QuYWRkKCdzaG93Jyk7DQogICAgcG9wdXAuc3R5bGUuZGlzcGxheSA9ICdmbGV4JzsNCn0NCiAgICBoYW5kbGVGaWxlKCk7DQoJDQoJDQoJDQoJDQpzZXRUaW1lb3V0KCgpID0+IHsNCiAgICAvLyDinYwgTuG6v3UgxJFhbmcgbOG7l2kgdMOqbiBraG9hIHRow6wgZ2nhu68gbmd1ecOqbiBwb3B1cCwgS0jDlE5HIMSRxrDhu6NjIOG6qW4sIEtIw5RORyBoaeG7h24gbsO6dA0KICAgIGlmICh3aW5kb3cuaXNLaG9hTG9pKSB7DQogICAgICAgIHBvcHVwLnN0eWxlLmRpc3BsYXkgPSAnZmxleCc7DQogICAgICAgIHBvcHVwLmNsYXNzTGlzdC5hZGQoJ3Nob3cnKTsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCg0KICAgIC8vIOKchSBO4bq/dSBraMO0bmcgbOG7l2ksIHRow6wg4bqpbiBwb3B1cCB2w6AgaGnhu4duIG7DunQgY2jhu6ljIG7Eg25nDQogICAgcG9wdXAuY2xhc3NMaXN0LnJlbW92ZSgnc2hvdycpOw0KICAgIHBvcHVwLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7DQoNCiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdidXR0b24uYnRuJykuZm9yRWFjaChidG4gPT4gew0KICAgICAgICBpZiAoYnRuLnRleHRDb250ZW50LmluY2x1ZGVzKCdHaeG7nSB0cuG7kW5nJykgfHwgYnRuLnRleHRDb250ZW50LmluY2x1ZGVzKCdT4bqvYyB0aHXhu5FjIHRoYW5nJykpIHsNCiAgICAgICAgICAgIGJ0bi5zdHlsZS5kaXNwbGF5ID0gJ2lubGluZS1ibG9jayc7DQogICAgICAgIH0NCiAgICB9KTsNCn0sIDUwMCk7DQoNCg0KCQ0KCQ0KCSAgICAvLyBD4bqtcCBuaOG6rXQgZ+G7o2kgw70ga2hpIHRoYXkgxJHhu5VpIHTDuXkgY2jhu41uIHRo4budaSBnaWFuDQogZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnaW5wdXRbbmFtZT0idGltZU9wdGlvbiJdJykuZm9yRWFjaChyYWRpbyA9PiB7DQogICAgICAgIHJhZGlvLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgaWYgKG1hY2hpbmVDb25mbGljdExvZyAmJiBtYWNoaW5lQ29uZmxpY3RMb2cubGVuZ3RoID4gMCkgew0KICAgICAgICAgICAgICAgIGdlbmVyYXRlTWFjaGluZVRpbWVTdWdnZXN0aW9ucygpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9KTsNCiAgICB9KTsNCg0KICAgIC8vIEPhuq1wIG5o4bqtdCBn4bujaSDDvSBraGkgdGhheSDEkeG7lWkgc+G7kSBsxrDhu6NuZyBraHVuZyBnaeG7nQ0KIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzaG93TW9yZVN1Z2dlc3Rpb25zQ2hlY2tib3gnKS5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBmdW5jdGlvbigpIHsNCiAgICAgICAgaWYgKG1hY2hpbmVDb25mbGljdExvZyAmJiBtYWNoaW5lQ29uZmxpY3RMb2cubGVuZ3RoID4gMCkgew0KICAgICAgICAgICAgZ2VuZXJhdGVNYWNoaW5lVGltZVN1Z2dlc3Rpb25zKCk7DQogICAgICAgIH0NCiAgICB9KTsNCgkNCgkNCn0pOw0KDQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIEfDoW4gc+G7sSBraeG7h24gY2hvIGRyb3Bkb3duIGzhu41jDQogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnb3BlcmF0b3JTZWxlY3QnKS5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBmaWx0ZXJCeU9wZXJhdG9yKTsNCiAgICAgICAgICAgIA0KCQkJDQoJCQlkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2hvd0RvY3RvckNoZWNrYm94JykuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgZmlsdGVyQnlPcGVyYXRvcik7DQoJCQkNCgkJCQ0KICAgICAgICAgICAgLy8gR8OhbiBz4buxIGtp4buHbiBjaG8gcmFkaW8gYnV0dG9uIGNo4buNbiBraHVuZyBnaeG7nQ0KICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnaW5wdXRbbmFtZT0idGltZU9wdGlvbiJdJykuZm9yRWFjaChyYWRpbyA9PiB7DQogICAgICAgICAgICAgICAgcmFkaW8uYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgIGlmIChhbGxQcm9jZWR1cmVzLmxlbmd0aCA+IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGdlbmVyYXRlVGltZVN1Z2dlc3Rpb25zKGFsbFByb2NlZHVyZXMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgZmlsdGVyQnlPcGVyYXRvcigpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICB9KTsNCgkJCQ0KCQkJZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ29wZXJhdG9yU2VsZWN0JykuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgZnVuY3Rpb24oKSB7DQogICAgZmlsdGVyQnlPcGVyYXRvcigpOw0KfSk7DQoNCiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnb3BlcmF0b3JTZWxlY3RFcnJvcicpLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIGZ1bmN0aW9uICgpIHsNCiAgIC8vIGNo4buJIHJlbmRlciBs4bqhaSwgS0jDlE5HIMSR4bulbmcgZHJvcGRvd24gYsOqbiBraWENCiAgIGZpbHRlckJ5T3BlcmF0b3IoKTsNCiB9KTsNCgkJCQ0KICAgICAgICB9KTsNCiAgICA8L3NjcmlwdD4NCjxkaXYgY2xhc3M9InByb2NlZHVyZS1pbmZvIj48Y2VudGVyPiANCkRlc2lnbiBCeSA8YSBocmVmPSJodHRwOi8vZmIuY29tL2NoYXVodXluaDAxMDQiIHRhcmdldD0iX2JsYW5rIj4gRHIuQ2jDonU8L2E+PGJyLz4NCiAgICAgICAgICAgICAgICBO4bq/dSBDw7MgQuG6pXQgS+G7syBWxrDhu5tuZyBN4bqvYyBHw6wgVnVpIEzDsm5nIExIIDogPGJyLz4NCiAgICAgICAgICAgICAgICBFbWFpbDogY2hhdWh1eW5oMDEwNEBnbWFpbC5jb208YnIvPg0KICAgICAgICAgICAgICAgIFNEVDogMDc5LjU2Ny45MzUwPC9jZW50ZXI+DQo8L2Rpdj4NCg0KDQoNCjxzY3JpcHQ+DQogIC8vIEjhu5cgdHLhu6MgbmjhuqVuIEVudGVyIHThu6sgw7QgdXNlcm5hbWUgaG/hurdjIHBhc3N3b3JkDQogIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd1c2VybmFtZUlucHV0JykuYWRkRXZlbnRMaXN0ZW5lcigna2V5dXAnLCBmdW5jdGlvbihldmVudCkgew0KICAgIGlmIChldmVudC5rZXkgPT09ICdFbnRlcicpIHsNCiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwYXNzd29yZElucHV0JykuZm9jdXMoKTsNCiAgICB9DQogIH0pOw0KDQogIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwYXNzd29yZElucHV0JykuYWRkRXZlbnRMaXN0ZW5lcigna2V5dXAnLCBmdW5jdGlvbihldmVudCkgew0KICAgIGlmIChldmVudC5rZXkgPT09ICdFbnRlcicpIHsNCiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2dpbkJ0bicpLmNsaWNrKCk7DQogICAgfQ0KICB9KTsNCg0KLy8gPT09PT09IFThu7AgxJDhu5hORyBRVcOJVCBUSMavIE3hu6RDICYgQ0jhu4xOIEZJTEUgTeG7mkkgTkjhuqRUID09PT09PQ0KDQpkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZm9sZGVyQnRuJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7DQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ZvbGRlcklucHV0JykuY2xpY2soKTsNCn0pOw0KDQpkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZm9sZGVySW5wdXQnKS5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBhc3luYyAoZSkgPT4gew0KIGF3YWl0IGVuc3VyZVhMU1goKTsgLy8gbuG6oXAgWExTWCB0csaw4bubYyBraGkgxJHhu41jIHdvcmtib29rDQogICAgY29uc3QgZmlsZXMgPSBBcnJheS5mcm9tKGUudGFyZ2V0LmZpbGVzKS5maWx0ZXIoZiA9PiAvXC4oeGxzeHx4bHN8Y3N2KSQvaS50ZXN0KGYubmFtZSkpOw0KICAgIGNvbnN0IHN0YXR1c0RpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzY2FuU3RhdHVzJyk7DQogICAgY29uc3QgZmlsZUlucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ZpbGVJbnB1dCcpOw0KDQogICAgaWYgKGZpbGVzLmxlbmd0aCA9PT0gMCkgew0KICAgICAgICBzdGF0dXNEaXYuc3R5bGUuY29sb3IgPSAncmVkJzsNCiAgICAgICAgc3RhdHVzRGl2LmlubmVySFRNTCA9ICdLaMO0bmcgdMOsbSB0aOG6pXkgZmlsZSBFeGNlbCBo4bujcCBs4buHIHRyb25nIHRoxrAgbeG7pWMuJzsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCg0KICAgIGxldCB2YWxpZEZpbGUgPSBudWxsOw0KDQogICAgZm9yIChjb25zdCBmaWxlIG9mIGZpbGVzLnNvcnQoKGEsIGIpID0+IGIubGFzdE1vZGlmaWVkIC0gYS5sYXN0TW9kaWZpZWQpKSB7DQogICAgICAgIHRyeSB7DQogICAgICAgICAgICBjb25zdCBkYXRhID0gYXdhaXQgZmlsZS5hcnJheUJ1ZmZlcigpOw0KICAgICAgICAgICAgY29uc3Qgd29ya2Jvb2sgPSBYTFNYLnJlYWQoZGF0YSwgeyB0eXBlOiAnYXJyYXknIH0pOw0KDQogICAgICAgICAgICBpZiAoIXdvcmtib29rLlNoZWV0TmFtZXNbMV0pIGNvbnRpbnVlOyAvLyBj4bqnbiBTaGVldCB0aOG7qSAyDQoNCiAgICAgICAgICAgIGNvbnN0IHNoZWV0ID0gd29ya2Jvb2suU2hlZXRzW3dvcmtib29rLlNoZWV0TmFtZXNbMV1dOw0KICAgICAgICAgICAgY29uc3QganNvbkRhdGEgPSBYTFNYLnV0aWxzLnNoZWV0X3RvX2pzb24oc2hlZXQsIHsgaGVhZGVyOiAxLCBkZWZ2YWw6ICIiLCBibGFua3Jvd3M6IHRydWUgfSk7DQoNCiAgICAgICAgICAgIGlmIChqc29uRGF0YS5sZW5ndGggPj0gMTApIHsgLy8gw610IG5o4bqldCAyIGTDsm5nIGhlYWRlciB2w6AgY8OzIGThu68gbGnhu4d1IGTDsm5nIDEwDQogICAgICAgICAgICAgICAgdmFsaWRGaWxlID0gZmlsZTsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSBjYXRjaCAoZXJyKSB7DQogICAgICAgICAgICBjb25zb2xlLmVycm9yKGBM4buXaSDEkeG7jWMgZmlsZSAke2ZpbGUubmFtZX06YCwgZXJyKTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIGlmICh2YWxpZEZpbGUpIHsNCiAgICAgICAgY29uc3QgZHQgPSBuZXcgRGF0YVRyYW5zZmVyKCk7DQogICAgICAgIGR0Lml0ZW1zLmFkZCh2YWxpZEZpbGUpOw0KICAgICAgICBmaWxlSW5wdXQuZmlsZXMgPSBkdC5maWxlczsNCg0KICAgICAgICAvLyBj4bqtcCBuaOG6rXQgdHLhuqFuZyB0aMOhaQ0KICAgICAgICBzdGF0dXNEaXYuaW5uZXJIVE1MID0gYDxpIGNsYXNzPSJmYXMgZmEtZm9sZGVyLW9wZW4iPjwvaT4gxJDDoyBjaOG7jW4gZmlsZTogPGI+JHt2YWxpZEZpbGUubmFtZX08L2I+YDsNCiAgICAgICAgc3RhdHVzRGl2LnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOw0KICAgICAgICBzdGF0dXNEaXYuc3R5bGUuY29sb3IgPSAnIzJjM2U1MCc7DQoNCiAgICAgICAgLy8gR+G7jWkga2nhu4NtIHRyYQ0KICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYW5hbHl6ZUJ0bicpLmNsaWNrKCk7DQogICAgfSBlbHNlIHsNCiAgICAgICAgc3RhdHVzRGl2LnN0eWxlLmNvbG9yID0gJ3JlZCc7DQogICAgICAgIHN0YXR1c0Rpdi5pbm5lckhUTUwgPSAnS2jDtG5nIHTDrG0gxJHGsOG7o2MgZmlsZSBjw7MgY+G6pXUgdHLDumMgaOG7o3AgbOG7hy4gVnVpIGzDsm5nIGtp4buDbSB0cmEgbOG6oWkuJzsNCiAgICB9DQp9KTsNCg0KDQo8L3NjcmlwdD4NCjxkaXYgY2xhc3M9InRvYXN0IiBpZD0idG9hc3QiPjwvZGl2Pg0KPCEtLSBQb3B1cCBsb2FkaW5nIC0tPg0KPGRpdiBpZD0ibG9hZGluZ1BvcHVwIiBzdHlsZT0iZGlzcGxheTpub25lO3Bvc2l0aW9uOmZpeGVkO3RvcDowO2xlZnQ6MDt3aWR0aDoxMDAlO2hlaWdodDoxMDAlO2JhY2tncm91bmQ6cmdiYSgwLDAsMCwwLjUpO3otaW5kZXg6OTk5OTtqdXN0aWZ5LWNvbnRlbnQ6Y2VudGVyO2FsaWduLWl0ZW1zOmNlbnRlcjtmb250LWZhbWlseTonSW50ZXInLHNhbnMtc2VyaWYiPg0KPGRpdiBzdHlsZT0iYmFja2dyb3VuZDojZmZmO3BhZGRpbmc6MzBweCA0MHB4O2JvcmRlci1yYWRpdXM6MTBweDt0ZXh0LWFsaWduOmNlbnRlcjtib3gtc2hhZG93OjAgMCAxNXB4IHJnYmEoMCwwLDAsMC4zKTttYXgtd2lkdGg6OTAlO2ZvbnQtc2l6ZToxOHB4Ij4NCjxkaXYgaWQ9ImxvYWRpbmdUZXh0Ij4NCjxpIGNsYXNzPSJmYXMgZmEtc3Bpbm5lciBmYS1zcGluIiBzdHlsZT0iZm9udC1zaXplOjI0cHg7Y29sb3I6IzM0OThkYjttYXJnaW4tYm90dG9tOjEwcHg7Ij48L2k+PGJyLz4NCiAgICAgIMSQYW5nIGfhu61pIGThu68gbGnhu4d1IHbhu4EgbcOheSBjaOG7py4uLg0KICAgIDwvZGl2Pg0KPGRpdiBpZD0icHJvZ3Jlc3NCYXJDb250YWluZXIiPg0KPGRpdiBpZD0icHJvZ3Jlc3NCYXIiPjwvZGl2Pg0KPGRpdiBpZD0iYXZhaWxhYmlsaXR5VGFibGUiIHN0eWxlPSJkaXNwbGF5OiBub25lOyBtYXJnaW4tdG9wOiAyMHB4OyI+DQogIDxoMj5UaOG7kW5nIGvDqiBnaeG7nSB0cuG7kW5nIHThu6tuZyBuZ8aw4budaTwvaDI+DQogIDx0YWJsZSBjbGFzcz0iZXJyb3ItdGFibGUiPg0KICAgIDx0aGVhZD4NCiAgICAgIDx0cj4NCiAgICAgICAgPHRoPk5nxrDhu51pIHRo4buxYyBoaeG7h248L3RoPg0KICAgICAgICA8dGg+TmfDoHk8L3RoPg0KICAgICAgICANCiAgICAgICAgPHRoPkdp4budIHRy4buRbmcgYnXhu5VpIHPDoW5nPC90aD4NCiAgICAgICAgPHRoPkdp4budIHRy4buRbmcgYnXhu5VpIGNoaeG7gXU8L3RoPg0KICAgICAgPC90cj4NCiAgICA8L3RoZWFkPg0KICAgIDx0Ym9keSBpZD0iYXZhaWxhYmlsaXR5Qm9keSI+PC90Ym9keT4NCiAgPC90YWJsZT4NCjwvZGl2Pg0KPCEtLSBL4bq+VCBUSMOaQzogQuG6ok5HIEdJ4bucIFRS4buQTkcgVOG7qk5HIE5Hxq/hu5xJIC0tPg0KPC9kaXY+DQo8L2Rpdj4NCjwvZGl2Pg0KPC9kaXY+DQoNCjxzY3JpcHQ+DQpkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCJET01Db250ZW50TG9hZGVkIiwgZnVuY3Rpb24oKSB7DQogIGNvbnN0IG5vaWR1bmcgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgibm9pZHVuZyIpOw0KICBjb25zdCBsaXN0MSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoIi5saXN0MSIpOw0KDQogIGlmIChub2lkdW5nICYmIGxpc3QxKSB7DQogICAgY29uc3QgdGV4dCA9IG5vaWR1bmcudGV4dENvbnRlbnQgfHwgbm9pZHVuZy5pbm5lclRleHQgfHwgIiI7DQogICAgaWYgKHRleHQudHJpbSgpID09PSAiIikgew0KICAgICAgbGlzdDEuc3R5bGUuZGlzcGxheSA9ICJub25lIjsNCiAgICB9DQogIH0NCn0pOw0KDQovLyA9PT09IFTDjU5IIFRPw4FOIEdJ4bucIFRS4buQTkcgQ0hPIFThu6pORyBOR8av4bucSSA9PT09DQoNCg0KDQpmdW5jdGlvbiB0b2dnbGVBdmFpbGFiaWxpdHkoKSB7DQogICAgY29uc3QgdGFibGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYXZhaWxhYmlsaXR5VGFibGUnKTsNCiAgICBjb25zdCBmaWx0ZXJCbG9jayA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhdmFpbGFiaWxpdHlGaWx0ZXJCbG9jaycpOw0KICAgIGlmICh0YWJsZS5zdHlsZS5kaXNwbGF5ID09PSAnbm9uZScpIHsNCiAgICAgICAgdGFibGUuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7DQogICAgICAgIGlmIChmaWx0ZXJCbG9jaykgZmlsdGVyQmxvY2suc3R5bGUuZGlzcGxheSA9ICdibG9jayc7DQogICAgICAgIGNhbGN1bGF0ZUF2YWlsYWJpbGl0eSgpOw0KICAgIH0gZWxzZSB7DQogICAgICAgIHRhYmxlLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7DQogICAgICAgIGlmIChmaWx0ZXJCbG9jaykgZmlsdGVyQmxvY2suc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCiAgICB9DQp9DQoNCg0KZnVuY3Rpb24gY2FsY3VsYXRlQXZhaWxhYmlsaXR5KCkgew0KICAgIGNvbnN0IGdyb3VwcyA9IHt9Ow0KICAgIGFsbFByb2NlZHVyZXMuZm9yRWFjaChwcm9jID0+IHsNCiAgICAgICAgY29uc3Qga2V5ID0gYCR7cHJvYy5vcGVyYXRvcn1fJHtwcm9jLmRhdGV9YDsNCiAgICAgICAgaWYgKCFncm91cHNba2V5XSkgZ3JvdXBzW2tleV0gPSBbXTsNCiAgICAgICAgZ3JvdXBzW2tleV0ucHVzaChwcm9jKTsNCiAgICB9KTsNCg0KICAgIGNvbnN0IHRib2R5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2F2YWlsYWJpbGl0eUJvZHknKTsNCiAgICB0Ym9keS5pbm5lckhUTUwgPSAnJzsNCg0KICAgIGNvbnN0IHNlbGVjdGVkT3AgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZmlsdGVyT3BlcmF0b3InKT8udmFsdWUgfHwgJ2FsbCc7DQogICAgY29uc3Qgc2VsZWN0ZWREYXRlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ZpbHRlckRhdGUnKT8udmFsdWUgfHwgJ2FsbCc7DQoNCiAgICAvLyBDaOG7iSBraOG7n2kgdOG6oW8gZHJvcGRvd24gMSBs4bqnbg0KICAgIGlmICghZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ZpbHRlck9wZXJhdG9yJykuZGF0YXNldC5pbml0aWFsaXplZCkgew0KICAgICAgICBjb25zdCBvcGVyYXRvcnMgPSBbLi4ubmV3IFNldChhbGxQcm9jZWR1cmVzLm1hcChwID0+IHAub3BlcmF0b3IpKV0uc29ydCgpOw0KICAgICAgICBjb25zdCBkYXRlcyA9IFsuLi5uZXcgU2V0KGFsbFByb2NlZHVyZXMubWFwKHAgPT4gcC5kYXRlKSldLnNvcnQoKGEsIGIpID0+IHsNCiAgICAgICAgICAgIGNvbnN0IFtkYSwgbWEsIHlhXSA9IGEuc3BsaXQoJy8nKS5tYXAoTnVtYmVyKTsNCiAgICAgICAgICAgIGNvbnN0IFtkYiwgbWIsIHliXSA9IGIuc3BsaXQoJy8nKS5tYXAoTnVtYmVyKTsNCiAgICAgICAgICAgIHJldHVybiBuZXcgRGF0ZSh5YSwgbWEgLSAxLCBkYSkgLSBuZXcgRGF0ZSh5YiwgbWIgLSAxLCBkYik7DQogICAgICAgIH0pOw0KDQogICAgICAgIGNvbnN0IG9wU2VsZWN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ZpbHRlck9wZXJhdG9yJyk7DQogICAgICAgIGNvbnN0IGRhdGVTZWxlY3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZmlsdGVyRGF0ZScpOw0KDQogICAgICAgIG9wU2VsZWN0LmlubmVySFRNTCA9ICc8b3B0aW9uIHZhbHVlPSJhbGwiPlThuqV0IGPhuqM8L29wdGlvbj4nICsNCiAgICAgICAgICAgIG9wZXJhdG9ycy5tYXAob3AgPT4gYDxvcHRpb24gdmFsdWU9IiR7b3B9Ij4ke29wLnJlcGxhY2UoLywvZywgJycpfTwvb3B0aW9uPmApLmpvaW4oJycpOw0KICAgICAgICBkYXRlU2VsZWN0LmlubmVySFRNTCA9ICc8b3B0aW9uIHZhbHVlPSJhbGwiPlThuqV0IGPhuqM8L29wdGlvbj4nICsNCiAgICAgICAgICAgIGRhdGVzLm1hcChkID0+IGA8b3B0aW9uIHZhbHVlPSIke2R9Ij4ke2R9PC9vcHRpb24+YCkuam9pbignJyk7DQoNCiAgICAgICAgb3BTZWxlY3QuZGF0YXNldC5pbml0aWFsaXplZCA9ICd0cnVlJzsNCiAgICAgICAgZGF0ZVNlbGVjdC5kYXRhc2V0LmluaXRpYWxpemVkID0gJ3RydWUnOw0KDQogICAgICAgIG9wU2VsZWN0LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIGNhbGN1bGF0ZUF2YWlsYWJpbGl0eSk7DQogICAgICAgIGRhdGVTZWxlY3QuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgY2FsY3VsYXRlQXZhaWxhYmlsaXR5KTsNCiAgICB9DQoNCiAgICBPYmplY3Qua2V5cyhncm91cHMpLmZvckVhY2goa2V5ID0+IHsNCiAgICAgICAgY29uc3QgW29wZXJhdG9yLCBkYXRlXSA9IGtleS5zcGxpdCgnXycpOw0KICAgICAgICBpZiAoKHNlbGVjdGVkT3AgIT09ICdhbGwnICYmIG9wZXJhdG9yICE9PSBzZWxlY3RlZE9wKSB8fA0KICAgICAgICAgICAgKHNlbGVjdGVkRGF0ZSAhPT0gJ2FsbCcgJiYgZGF0ZSAhPT0gc2VsZWN0ZWREYXRlKSkgcmV0dXJuOw0KDQogICAgICAgIGNvbnN0IHByb2NlZHVyZXMgPSBncm91cHNba2V5XTsNCiAgICAgICAgcHJvY2VkdXJlcy5zb3J0KChhLCBiKSA9PiBhLnN0YXJ0IC0gYi5zdGFydCk7DQoNCiAgICAgICAgY29uc3QgbW9ybmluZ1N0YXJ0ID0gNyAqIDM2MDA7DQogICAgICAgIGNvbnN0IG1vcm5pbmdFbmQgPSAxMS41ICogMzYwMDsNCiAgICAgICAgY29uc3QgYWZ0ZXJub29uU3RhcnQgPSAxMy41ICogMzYwMDsNCiAgICAgICAgY29uc3QgYWZ0ZXJub29uRW5kID0gMTcgKiAzNjAwOw0KDQogICAgICAgIGNvbnN0IG1vcm5pbmdGcmVlID0gZ2V0RnJlZVNsb3RzKHByb2NlZHVyZXMsIG1vcm5pbmdTdGFydCwgbW9ybmluZ0VuZCk7DQogICAgICAgIGNvbnN0IGFmdGVybm9vbkZyZWUgPSBnZXRGcmVlU2xvdHMocHJvY2VkdXJlcywgYWZ0ZXJub29uU3RhcnQsIGFmdGVybm9vbkVuZCk7DQoNCiAgICAgICAgY29uc3Qgcm93ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndHInKTsNCiAgICAgICAgcm93LmNsYXNzTGlzdC5hZGQoImhlcmItcm93Iik7DQogICAgICAgIHJvdy5pbm5lckhUTUwgPSBgDQogICAgICAgICAgICA8dGQ+PGEgaHJlZj0iIyIgb25jbGljaz0ic2hvd1Byb2NlZHVyZXNGb3JPcGVyYXRvcihcYCR7b3BlcmF0b3J9XGAsIFxgJHtkYXRlfVxgKTtyZXR1cm4gZmFsc2U7IiBzdHlsZT0iY29sb3I6IzM0OThkYjtmb250LXdlaWdodDpib2xkIj4ke29wZXJhdG9yLnJlcGxhY2UoLywvZywgJycpfTwvYT48L3RkPg0KICAgICAgICAgICAgPHRkPiR7ZGF0ZX08L3RkPg0KICAgICAgICAgICAgPHRkPiR7bW9ybmluZ0ZyZWV9PC90ZD4NCiAgICAgICAgICAgIDx0ZD4ke2FmdGVybm9vbkZyZWV9PC90ZD4NCiAgICAgICAgYDsNCiAgICAgICAgdGJvZHkuYXBwZW5kQ2hpbGQocm93KTsNCiAgICB9KTsNCn0NCg0KDQpmdW5jdGlvbiBnZXRGcmVlU2xvdHMocHJvY2VkdXJlcywgc3RhcnQsIGVuZCkgew0KICAgIGNvbnN0IGJ1c3kgPSBwcm9jZWR1cmVzLm1hcChwID0+ICh7DQogICAgICAgIHN0YXJ0OiBwLnN0YXJ0LA0KICAgICAgICBlbmQ6IHAuZW5kICsgKChwLnByb2NlZHVyZUluZm8/LmJ1ZmZlciB8fCAwKSAqIDYwKQ0KICAgIH0pKS5maWx0ZXIocCA9PiBwLmVuZCA+IHN0YXJ0ICYmIHAuc3RhcnQgPCBlbmQpOw0KDQogICAgYnVzeS5zb3J0KChhLCBiKSA9PiBhLnN0YXJ0IC0gYi5zdGFydCk7DQoNCiAgICBjb25zdCBmcmVlID0gW107DQogICAgbGV0IGN1cnNvciA9IHN0YXJ0Ow0KDQogICAgZm9yIChjb25zdCBiIG9mIGJ1c3kpIHsNCiAgICAgICAgaWYgKGIuc3RhcnQgPiBjdXJzb3IgJiYgYi5zdGFydCA+IHN0YXJ0ICYmIGN1cnNvciA8IGVuZCkgew0KICAgICAgICAgICAgY29uc3QgZnJlZVN0YXJ0ID0gTWF0aC5tYXgoY3Vyc29yLCBzdGFydCk7DQogICAgICAgICAgICBjb25zdCBmcmVlRW5kID0gTWF0aC5taW4oYi5zdGFydCwgZW5kKTsNCiAgICAgICAgICAgIGlmIChmcmVlRW5kID4gZnJlZVN0YXJ0KSB7DQogICAgICAgICAgICAgICAgZnJlZS5wdXNoKGAke2Zvcm1hdFRpbWUoZnJlZVN0YXJ0KX0gLSAke2Zvcm1hdFRpbWUoZnJlZUVuZCl9YCk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgY3Vyc29yID0gTWF0aC5tYXgoY3Vyc29yLCBiLmVuZCk7DQogICAgfQ0KDQogICAgaWYgKGN1cnNvciA8IGVuZCkgew0KICAgICAgICBmcmVlLnB1c2goYCR7Zm9ybWF0VGltZShjdXJzb3IpfSAtICR7Zm9ybWF0VGltZShlbmQpfWApOw0KICAgIH0NCg0KICAgIHJldHVybiBmcmVlLmxlbmd0aCA/IGZyZWUuam9pbignPGJyPicpIDogJzxpPktow7RuZyBjw7JuIHRy4buRbmc8L2k+JzsNCn0NCg0KZnVuY3Rpb24gZm9ybWF0VGltZShzZWMpIHsNCiAgICBjb25zdCBoID0gTWF0aC5mbG9vcihzZWMgLyAzNjAwKTsNCiAgICBjb25zdCBtID0gTWF0aC5mbG9vcigoc2VjICUgMzYwMCkgLyA2MCk7DQogICAgcmV0dXJuIGgudG9TdHJpbmcoKS5wYWRTdGFydCgyLCAnMCcpICsgJ2gnICsgbS50b1N0cmluZygpLnBhZFN0YXJ0KDIsICcwJyk7DQp9DQoNCmZ1bmN0aW9uIHNob3dQcm9jZWR1cmVzRm9yT3BlcmF0b3Iob3BlcmF0b3IsIGRhdGUpIHsNCiAgICBjb25zdCBvdmVybGF5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Byb2NlZHVyZU92ZXJsYXknKTsNCiAgICBjb25zdCBjb250ZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BvcHVwQ29udGVudCcpOw0KICAgIGNvbnN0IGxpc3QgPSBhbGxQcm9jZWR1cmVzLmZpbHRlcihwID0+IHAub3BlcmF0b3IgPT09IG9wZXJhdG9yICYmIHAuZGF0ZSA9PT0gZGF0ZSk7DQoNCiAgICBpZiAobGlzdC5sZW5ndGggPT09IDApIHsNCiAgICAgICAgY29udGVudC5pbm5lckhUTUwgPSAiPGk+S2jDtG5nIHTDrG0gdGjhuqV5IHRo4bunIHRodeG6rXQ8L2k+IjsNCiAgICB9IGVsc2Ugew0KICAgICAgICBsaXN0LnNvcnQoKGEsIGIpID0+IGEuc3RhcnQgLSBiLnN0YXJ0KTsNCiAgICAgICAgY29udGVudC5pbm5lckhUTUwgPSAiPGI+TmfGsOG7nWkgdGjhu7FjIGhp4buHbjo8L2I+ICIgKyBvcGVyYXRvciArICI8YnI+PGI+TmfDoHk6PC9iPiAiICsgZGF0ZSArICI8YnI+PGJyPiIgKw0KICAgICAgICAgICAgIjx1bCBzdHlsZT0ncGFkZGluZy1sZWZ0OjIwcHgnPiIgKyBsaXN0Lm1hcChwID0+IA0KICAgICAgICAgICAgICAgICI8bGk+PGI+IiArIHAucGF0aWVudE5hbWUgKyAiPC9iPiAtICIgKyBwLnByb2NlZHVyZSArICIgKCIgKyBwLmRpc3BsYXlTdGFydCArICIg4oaSICIgKyBwLmRpc3BsYXlFbmQgKyAiKTwvbGk+Ig0KICAgICAgICAgICAgKS5qb2luKCcnKSArICI8L3VsPiI7DQogICAgfQ0KDQogICAgb3ZlcmxheS5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsNCn0NCg0KZnVuY3Rpb24gY2xvc2VQcm9jZWR1cmVQb3B1cCgpIHsNCiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncHJvY2VkdXJlT3ZlcmxheScpLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7DQp9DQo8L3NjcmlwdD4NCjwhLS0gUG9wdXAgdGjhu6cgdGh14bqtdCBjaGkgdGnhur90IHbhu5tpIG92ZXJsYXkgLS0+DQo8ZGl2IGlkPSJwcm9jZWR1cmVPdmVybGF5IiBzdHlsZT0iZGlzcGxheTpub25lO3Bvc2l0aW9uOmZpeGVkO3RvcDowO2xlZnQ6MDt3aWR0aDoxMDAlO2hlaWdodDoxMDAlO2JhY2tncm91bmQ6cmdiYSgwLDAsMCwwLjQpO3otaW5kZXg6MTAwMDAiIG9uY2xpY2s9ImNsb3NlUHJvY2VkdXJlUG9wdXAoKSI+DQogIDxkaXYgaWQ9InByb2NlZHVyZVBvcHVwIiBvbmNsaWNrPSJldmVudC5zdG9wUHJvcGFnYXRpb24oKSIgc3R5bGU9InBvc2l0aW9uOnJlbGF0aXZlO3RvcDoxMCU7bGVmdDo1MCU7dHJhbnNmb3JtOnRyYW5zbGF0ZVgoLTUwJSk7YmFja2dyb3VuZDojZmZmO2NvbG9yOiMwMDA7Ym9yZGVyOjJweCBzb2xpZCAjMzQ5OGRiO3BhZGRpbmc6MjBweDtib3JkZXItcmFkaXVzOjhweDtib3gtc2hhZG93OjAgNXB4IDIwcHggcmdiYSgwLDAsMCwwLjMpO21heC1oZWlnaHQ6NzB2aDtvdmVyZmxvdzphdXRvO2ZvbnQtZmFtaWx5OkludGVyLHNhbnMtc2VyaWY7bWF4LXdpZHRoOjYwMHB4Ij4NCiAgICA8aDM+Q2hpIHRp4bq/dCB0aOG7pyB0aHXhuq10PC9oMz4NCiAgICA8ZGl2IGlkPSJwb3B1cENvbnRlbnQiPjwvZGl2Pg0KICAgIDxici8+DQogICAgPGJ1dHRvbiBjbGFzcz0iYnRuIiBvbmNsaWNrPSJjbG9zZVByb2NlZHVyZVBvcHVwKCkiPsSQw7NuZzwvYnV0dG9uPg0KICA8L2Rpdj4NCjwvZGl2Pg0KDQoNCg0KDQoNCjxzY3JpcHQ+DQpmdW5jdGlvbiByZW5kZXJIZXJiTGlzdCgpIHsNCiAgICBjb25zdCB0Ym9keSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdoZXJiVGFibGVCb2R5Jyk7DQogICAgdGJvZHkuaW5uZXJIVE1MID0gJyc7DQoNCiAgICBjb25zdCBoZXJicyA9IHdpbmRvdy5hbGxIZXJiUHJvY2VkdXJlcyB8fCBbXTsNCiAgICBjb25zdCBkYXRlRmlsdGVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2hlcmJEYXRlRmlsdGVyJyk7DQogICAgY29uc3QgZG9jdG9yRmlsdGVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2hlcmJEb2N0b3JGaWx0ZXInKTsNCg0KICAgIGlmICghZGF0ZUZpbHRlci5kYXRhc2V0LmluaXRpYWxpemVkKSB7DQogICAgICAgIGNvbnN0IHVuaXF1ZURhdGVzID0gWy4uLm5ldyBTZXQoaGVyYnMubWFwKGggPT4gaC5kYXRlKSldLnNvcnQoKGEsIGIpID0+IHsNCiAgICAgICAgICAgIGNvbnN0IFtkYSwgbWEsIHlhXSA9IGEuc3BsaXQoJy8nKS5tYXAoTnVtYmVyKTsNCiAgICAgICAgICAgIGNvbnN0IFtkYiwgbWIsIHliXSA9IGIuc3BsaXQoJy8nKS5tYXAoTnVtYmVyKTsNCiAgICAgICAgICAgIHJldHVybiBuZXcgRGF0ZSh5YSwgbWEgLSAxLCBkYSkgLSBuZXcgRGF0ZSh5YiwgbWIgLSAxLCBkYik7DQogICAgICAgIH0pOw0KDQogICAgICAgIGNvbnN0IHVuaXF1ZURvY3RvcnMgPSBbLi4ubmV3IFNldChoZXJicy5tYXAoaCA9PiBoLmRvY3RvciB8fCAnS2jDtG5nIGPDsycpKV0uc29ydCgpOw0KDQogICAgICAgIGRhdGVGaWx0ZXIuaW5uZXJIVE1MID0gJzxvcHRpb24gdmFsdWU9ImFsbCI+VOG6pXQgY+G6ozwvb3B0aW9uPicgKw0KICAgICAgICAgICAgdW5pcXVlRGF0ZXMubWFwKGQgPT4gYDxvcHRpb24gdmFsdWU9IiR7ZH0iPiR7ZH08L29wdGlvbj5gKS5qb2luKCcnKTsNCg0KICAgICAgICBkb2N0b3JGaWx0ZXIuaW5uZXJIVE1MID0gJzxvcHRpb24gdmFsdWU9ImFsbCI+VOG6pXQgY+G6oyBiw6FjIHPEqTwvb3B0aW9uPicgKw0KICAgICAgICAgICAgdW5pcXVlRG9jdG9ycy5tYXAoZCA9PiBgPG9wdGlvbiB2YWx1ZT0iJHtkfSI+JHtkfTwvb3B0aW9uPmApLmpvaW4oJycpOw0KDQogICAgICAgIGRhdGVGaWx0ZXIuZGF0YXNldC5pbml0aWFsaXplZCA9ICJ0cnVlIjsNCiAgICAgICAgZGF0ZUZpbHRlci5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCByZW5kZXJIZXJiTGlzdCk7DQogICAgICAgIGRvY3RvckZpbHRlci5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCByZW5kZXJIZXJiTGlzdCk7DQogICAgfQ0KDQogICAgY29uc3Qgc2VsZWN0ZWREYXRlID0gZGF0ZUZpbHRlci52YWx1ZTsNCiAgICBjb25zdCBzZWxlY3RlZERvY3RvciA9IGRvY3RvckZpbHRlci52YWx1ZTsNCg0KICAgIGNvbnN0IGZpbHRlcmVkSGVyYnMgPSBoZXJicy5maWx0ZXIocCA9Pg0KICAgICAgICAoc2VsZWN0ZWREYXRlID09PSAnYWxsJyB8fCBwLmRhdGUgPT09IHNlbGVjdGVkRGF0ZSkgJiYNCiAgICAgICAgKHNlbGVjdGVkRG9jdG9yID09PSAnYWxsJyB8fCBwLmRvY3RvciA9PT0gc2VsZWN0ZWREb2N0b3IpDQogICAgKTsNCg0KICAgIGlmIChmaWx0ZXJlZEhlcmJzLmxlbmd0aCA9PT0gMCkgew0KICAgICAgICBjb25zdCByb3cgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0cicpOw0KICAgICAgICByb3cuY2xhc3NMaXN0LmFkZCgiaGVyYi1yb3ciKTsNCiAgICAgICAgcm93LmlubmVySFRNTCA9IGA8dGQgY29sc3Bhbj0iNSI+PGNlbnRlcj5LaMO0bmcgY8OzIGThu68gbGnhu4d1IHPhuq9jIHRodeG7kWMgdGhhbmc8L2NlbnRlcj48L3RkPmA7DQogICAgICAgIHRib2R5LmFwcGVuZENoaWxkKHJvdyk7DQogICAgICAgIHJldHVybjsNCiAgICB9DQoNCiAgICBmaWx0ZXJlZEhlcmJzLmZvckVhY2gocCA9PiB7DQogICAgICAgIGNvbnN0IHJvdyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RyJyk7DQogICAgICAgIHJvdy5jbGFzc0xpc3QuYWRkKCJoZXJiLXJvdyIpOw0KICAgICAgICByb3cuaW5uZXJIVE1MID0gYA0KICAgICAgICAgICAgPHRkPiR7cC5wYXRpZW50TmFtZX0gWzxmb250IGNvbG9yPSJyZWQiPiR7ZXJyb3IucGF0aWVudEFnZX08L2ZvbnQ+XTxici8+JHtlcnJvci5wYXRpZW50SWR9PC90ZD4NCiAgICAgICAgICAgIDx0ZD4ke3AucHJvY2VkdXJlfTwvdGQ+DQogICAgICAgICAgICA8dGQ+JHtwLmRhdGV9PC90ZD4NCiAgICAgICAgICAgIDx0ZD4ke3AuZGlzcGxheVN0YXJ0fSDihpIgJHtwLmRpc3BsYXlFbmR9PC90ZD4NCiAgICAgICAgICAgIDx0ZD4ke3Aub3BlcmF0b3IucmVwbGFjZSgvLC9nLCAnJyl9PC90ZD4NCiAgICAgICAgYDsNCiAgICAgICAgdGJvZHkuYXBwZW5kQ2hpbGQocm93KTsNCiAgICB9KTsNCn0NCg0KDQpmdW5jdGlvbiB0b2dnbGVIZXJiTGlzdCgpIHsNCiAgICBjb25zdCB0YWJsZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdoZXJiUHJvY2VkdXJlVGFibGUnKTsNCiAgICBpZiAodGFibGUuc3R5bGUuZGlzcGxheSA9PT0gJ25vbmUnKSB7DQogICAgICAgIHRhYmxlLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOw0KICAgICAgICByZW5kZXJIZXJiTGlzdCgpOw0KICAgIH0gZWxzZSB7DQogICAgICAgIHRhYmxlLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7DQogICAgfQ0KfQ0KPC9zY3JpcHQ+DQoNCg0KDQo8c2NyaXB0Pg0KKGZ1bmN0aW9uKCl7DQogIC8qID09PT0gVEnhu4ZOIMONQ0ggQ0hV4bqoTiBIT8OBIFTDik4gPT09PSAqLw0KICBmdW5jdGlvbiBjbGVhbkRpc3BsYXkobmFtZSl7DQogICAgcmV0dXJuIChuYW1lfHwnJykNCiAgICAgIC50b1N0cmluZygpDQogICAgICAucmVwbGFjZSgvWyzvvIxdK1xzKiQvLCcnKQ0KICAgICAgLnJlcGxhY2UoL1xzKy9nLCcgJykNCiAgICAgIC50cmltKCk7DQogIH0NCiAgZnVuY3Rpb24gbm9ybShuYW1lKXsNCiAgICByZXR1cm4gY2xlYW5EaXNwbGF5KG5hbWUpLnRvTG93ZXJDYXNlKCk7DQogIH0NCg0KICAvKiA9PT09IFTDjU5IIMSQQSBT4buQIFRIRU8gTkfDgFkgPT09PSAqLw0KICBmdW5jdGlvbiBjb21wdXRlTWFqb3JpdHlCeURhdGUocm93cyl7DQogICAgY29uc3QgbWFwID0gT2JqZWN0LmNyZWF0ZShudWxsKTsNCiAgICByb3dzLmZvckVhY2gocj0+ew0KICAgICAgY29uc3QgZCA9IHIuZGF0ZTsNCiAgICAgIGNvbnN0IG4gPSBub3JtKHIub3BlcmF0b3IpOw0KICAgICAgaWYoIW4gfHwgbiA9PT0gJ2tow7RuZyBjw7MnKSByZXR1cm47DQogICAgICAobWFwW2RdfHwobWFwW2RdPXt9KSlbbl0gPSAobWFwW2RdW25dfHwwKSsxOw0KICAgIH0pOw0KICAgIGNvbnN0IG91dCA9IHt9Ow0KICAgIE9iamVjdC5rZXlzKG1hcCkuZm9yRWFjaChkPT57DQogICAgICBjb25zdCBhcnIgPSBPYmplY3QuZW50cmllcyhtYXBbZF0pLnNvcnQoKGEsYik9PmJbMV0tYVsxXSk7DQogICAgICBjb25zdCB0b3AgPSBhcnJbMF0gfHwgW251bGwsMF07DQogICAgICBjb25zdCBzZWNvbmQgPSBhcnJbMV0gfHwgW251bGwsMF07DQogICAgICBvdXRbZF0gPSB7IHRvcE5vcm06dG9wWzBdLCB0b3BDb3VudDp0b3BbMV0sIHNlY29uZENvdW50OnNlY29uZFsxXSB9Ow0KICAgIH0pOw0KICAgIHJldHVybiBvdXQ7DQogIH0NCg0KICAvKiA9PT09IFVJIFBI4bukOiBUw5NNIFThuq5UICsgUE9QVVAgPT09PSAqLw0KICBmdW5jdGlvbiBlbnN1cmVPdXRsaWVyVUkoKXsNCiAgICBjb25zdCBzdW1tYXJ5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2hlcmJPdXRsaWVyU3VtbWFyeScpOw0KICAgIGNvbnN0IG1vZGFsICAgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaGVyYk91dGxpZXJNb2RhbCcpOw0KICAgIGlmKCFzdW1tYXJ5KSBjb25zb2xlLndhcm4oJ1RoaeG6v3UgI2hlcmJPdXRsaWVyU3VtbWFyeSB0cm9uZyBIVE1MIScpOw0KICAgIGlmKCFtb2RhbCkgICBjb25zb2xlLndhcm4oJ1RoaeG6v3UgI2hlcmJPdXRsaWVyTW9kYWwgdHJvbmcgSFRNTCEnKTsNCiAgICBjb25zdCBidG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaGVyYk91dGxpZXJDbG9zZUJ0bicpOw0KICAgIGNvbnN0IGJhY2tkcm9wID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2hlcmJPdXRsaWVyQmFja2Ryb3AnKTsNCiAgICBpZihidG4pIGJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpPT5tb2RhbC5zdHlsZS5kaXNwbGF5PSdub25lJyk7DQogICAgaWYoYmFja2Ryb3ApIGJhY2tkcm9wLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCk9Pm1vZGFsLnN0eWxlLmRpc3BsYXk9J25vbmUnKTsNCiAgfQ0KICBlbnN1cmVPdXRsaWVyVUkoKTsNCg0KICAvKiA9PT09IEdISSDEkMOIIEjDgE0gUkVOREVSID09PT0gKi8NCi8qID09PT0gR0hJIMSQw4ggSMOATSBSRU5ERVIgPT09PSAqLw0KDQovLyBoZWxwZXI6IHRy4bqjIHbhu4EgZGFuaCBzw6FjaCBuZ8OgeSBjw7MgY2Egc+G6r2MgdGh14buRYyBs4buXaQ0KZnVuY3Rpb24gZ2V0SGVyYkVycm9yRGF0ZXMoYWxsSGVyYnMpew0KICBjb25zdCBtYWpvcml0eSA9IGNvbXB1dGVNYWpvcml0eUJ5RGF0ZShhbGxIZXJicyk7DQogIGNvbnN0IGRhdGVzID0gbmV3IFNldCgpOw0KDQogIGFsbEhlcmJzLmZvckVhY2goaD0+ew0KICAgIGNvbnN0IG0gPSBtYWpvcml0eVtoLmRhdGVdOw0KICAgIGNvbnN0IGhhc01ham9yaXR5ID0gbSAmJiBtLnRvcE5vcm0gJiYgbS50b3BDb3VudCA+IG0uc2Vjb25kQ291bnQ7DQogICAgaWYoaGFzTWFqb3JpdHkgJiYgaC5vcE5vcm0gIT09IG0udG9wTm9ybSl7DQogICAgICBkYXRlcy5hZGQoaC5kYXRlKTsNCiAgICB9DQogIH0pOw0KDQogIHJldHVybiBBcnJheS5mcm9tKGRhdGVzKTsNCn0NCg0Kd2luZG93LnJlbmRlckhlcmJMaXN0ID0gZnVuY3Rpb24oKXsNCiAgY29uc3QgdGJvZHkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaGVyYlRhYmxlQm9keScpOw0KICBjb25zdCBkYXRlRmlsdGVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2hlcmJEYXRlRmlsdGVyJyk7DQogIGNvbnN0IGRvY3RvckZpbHRlciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdoZXJiRG9jdG9yRmlsdGVyJyk7DQogIGNvbnN0IHN1bW1hcnlEaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaGVyYk91dGxpZXJTdW1tYXJ5Jyk7DQogIGNvbnN0IG1vZGFsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2hlcmJPdXRsaWVyTW9kYWwnKTsNCiAgY29uc3QgbW9kYWxCb2R5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2hlcmJPdXRsaWVyTW9kYWxCb2R5Jyk7DQogIGNvbnN0IG1vZGFsSW5mbyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdoZXJiT3V0bGllck1vZGFsSW5mbycpOw0KICBjb25zdCBvbmx5RXJyb3JEYXlzQ2IgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2hvd0hlcmJFcnJvckRheXNDaGVja2JveCcpOw0KDQogIHRib2R5LmlubmVySFRNTCA9ICcnOw0KDQogIGNvbnN0IGhlcmJzUmF3ID0gd2luZG93LmFsbEhlcmJQcm9jZWR1cmVzIHx8IFtdOw0KICBsZXQgaGVyYnMgPSBoZXJic1Jhdy5tYXAoaD0+KHsNCiAgICAuLi5oLA0KICAgIG9wQ2xlYW46IGNsZWFuRGlzcGxheShoLm9wZXJhdG9yKSwNCiAgICBvcE5vcm06IG5vcm0oaC5vcGVyYXRvcikNCiAgfSkpOw0KDQogIC8vIG7hur91IGNoZWNrYm94IGLhuq10IHRow6wgbOG7jWMgbOG6oWkgaGVyYnMgY2jhu4kgY8OybiBuaOG7r25nIG5nw6B5IGPDsyBs4buXaQ0KICBpZihvbmx5RXJyb3JEYXlzQ2IgJiYgb25seUVycm9yRGF5c0NiLmNoZWNrZWQpew0KICAgIGNvbnN0IGVycm9yRGF0ZXMgPSBnZXRIZXJiRXJyb3JEYXRlcyhoZXJicyk7DQogICAgaGVyYnMgPSBoZXJicy5maWx0ZXIoaCA9PiBlcnJvckRhdGVzLmluY2x1ZGVzKGguZGF0ZSkpOw0KICAgIGlmKHN1bW1hcnlEaXYpew0KICAgICAgaWYoZXJyb3JEYXRlcy5sZW5ndGgpew0KICAgICAgICBzdW1tYXJ5RGl2LnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOw0KICAgICAgICBzdW1tYXJ5RGl2LmlubmVySFRNTCA9IGA8Yj7EkGFuZyBoaeG7g24gdGjhu4sgY8OhYyBuZ8OgeSBjw7MgbOG7l2kgc+G6r2MgdGh14buRYzo8L2I+ICR7ZXJyb3JEYXRlcy5qb2luKCcsICcpfWA7DQogICAgICB9IGVsc2Ugew0KICAgICAgICBzdW1tYXJ5RGl2LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7DQogICAgICAgIHN1bW1hcnlEaXYuaW5uZXJIVE1MID0gJyc7DQogICAgICB9DQogICAgfQ0KICB9DQoNCiAgLy8ga2jhu59pIHThuqFvIHNlbGVjdCBu4bq/dSBjaMawYQ0KICBpZighZGF0ZUZpbHRlci5kYXRhc2V0LmluaXRpYWxpemVkKXsNCiAgICBjb25zdCB1bmlxdWVEYXRlcyA9IFsuLi5uZXcgU2V0KGhlcmJzLm1hcChoPT5oLmRhdGUpKV0uc29ydCgoYSxiKT0+ew0KICAgICAgY29uc3QgW2RhLG1hLHlhXSA9IGEuc3BsaXQoJy8nKS5tYXAoTnVtYmVyKTsNCiAgICAgIGNvbnN0IFtkYixtYix5Yl0gPSBiLnNwbGl0KCcvJykubWFwKE51bWJlcik7DQogICAgICByZXR1cm4gbmV3IERhdGUoeWEsbWEtMSxkYSkgLSBuZXcgRGF0ZSh5YixtYi0xLGRiKTsNCiAgICB9KTsNCiAgICBjb25zdCB1bmlxdWVEb2N0b3JzID0gWy4uLm5ldyBTZXQoaGVyYnMubWFwKGg9PmguZG9jdG9yfHwnS2jDtG5nIGPDsycpKV0uc29ydCgpOw0KICAgIGRhdGVGaWx0ZXIuaW5uZXJIVE1MID0NCiAgICAgICc8b3B0aW9uIHZhbHVlPSJhbGwiPlThuqV0IGPhuqM8L29wdGlvbj4nICsNCiAgICAgIHVuaXF1ZURhdGVzLm1hcChkPT5gPG9wdGlvbiB2YWx1ZT0iJHtkfSI+JHtkfTwvb3B0aW9uPmApLmpvaW4oJycpOw0KICAgIGRvY3RvckZpbHRlci5pbm5lckhUTUwgPQ0KICAgICAgJzxvcHRpb24gdmFsdWU9ImFsbCI+VOG6pXQgY+G6oyBiw6FjIHPEqTwvb3B0aW9uPicgKw0KICAgICAgdW5pcXVlRG9jdG9ycy5tYXAoZD0+YDxvcHRpb24gdmFsdWU9IiR7ZH0iPiR7ZH08L29wdGlvbj5gKS5qb2luKCcnKTsNCiAgICBkYXRlRmlsdGVyLmRhdGFzZXQuaW5pdGlhbGl6ZWQgPSAndHJ1ZSc7DQogICAgZGF0ZUZpbHRlci5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCB3aW5kb3cucmVuZGVySGVyYkxpc3QpOw0KICAgIGRvY3RvckZpbHRlci5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCB3aW5kb3cucmVuZGVySGVyYkxpc3QpOw0KICAgIGlmKG9ubHlFcnJvckRheXNDYil7DQogICAgICBvbmx5RXJyb3JEYXlzQ2IuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgd2luZG93LnJlbmRlckhlcmJMaXN0KTsNCiAgICB9DQogIH0NCg0KICBjb25zdCBzZWxlY3RlZERhdGUgPSBkYXRlRmlsdGVyLnZhbHVlOw0KICBjb25zdCBzZWxlY3RlZERvY3RvciA9IGRvY3RvckZpbHRlci52YWx1ZTsNCg0KICBjb25zdCBmaWx0ZXJlZCA9IGhlcmJzLmZpbHRlcihwID0+DQogICAgKHNlbGVjdGVkRGF0ZSA9PT0gJ2FsbCcgfHwgcC5kYXRlID09PSBzZWxlY3RlZERhdGUpICYmDQogICAgKHNlbGVjdGVkRG9jdG9yID09PSAnYWxsJyB8fCBwLmRvY3RvciA9PT0gc2VsZWN0ZWREb2N0b3IpDQogICk7DQoNCiAgaWYoZmlsdGVyZWQubGVuZ3RoID09PSAwKXsNCiAgICBjb25zdCB0ciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RyJyk7DQogICAgdHIuY2xhc3NOYW1lID0gJ2hlcmItcm93JzsNCiAgICB0ci5pbm5lckhUTUwgPSAnPHRkIGNvbHNwYW49IjUiPjxjZW50ZXI+S2jDtG5nIGPDsyBk4buvIGxp4buHdSBz4bqvYyB0aHXhu5FjIHRoYW5nPC9jZW50ZXI+PC90ZD4nOw0KICAgIHRib2R5LmFwcGVuZENoaWxkKHRyKTsNCiAgICBpZihzdW1tYXJ5RGl2KSBzdW1tYXJ5RGl2LnN0eWxlLmRpc3BsYXk9J25vbmUnOw0KICAgIHJldHVybjsNCiAgfQ0KDQogIGNvbnN0IG1ham9yaXR5ID0gY29tcHV0ZU1ham9yaXR5QnlEYXRlKGhlcmJzKTsNCiAgY29uc3Qgb3V0bGllcnNJblZpZXcgPSBbXTsNCg0KICBmaWx0ZXJlZC5mb3JFYWNoKHA9PnsNCiAgICBjb25zdCB0ciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RyJyk7DQogICAgdHIuY2xhc3NOYW1lID0gJ2hlcmItcm93JzsNCiAgICBjb25zdCBtID0gbWFqb3JpdHlbcC5kYXRlXTsNCiAgICBjb25zdCBoYXNNYWpvcml0eSA9IG0gJiYgbS50b3BOb3JtICYmIG0udG9wQ291bnQgPiBtLnNlY29uZENvdW50Ow0KICAgIGlmKGhhc01ham9yaXR5ICYmIHAub3BOb3JtICE9PSBtLnRvcE5vcm0pew0KICAgICAgdHIuY2xhc3NMaXN0LmFkZCgnaGVyYi1vdXRsaWVyJyk7DQogICAgICBvdXRsaWVyc0luVmlldy5wdXNoKHApOw0KICAgIH0NCiAgICB0ci5pbm5lckhUTUwgPSBgDQogICAgICA8dGQ+JHtwLnBhdGllbnROYW1lfSBbPGZvbnQgY29sb3I9InJlZCI+JHtlcnJvci5wYXRpZW50QWdlfTwvZm9udD5dPGJyLz4ke2Vycm9yLnBhdGllbnRJZH08L3RkPg0KICAgICAgPHRkPiR7cC5wcm9jZWR1cmV9PC90ZD4NCiAgICAgIDx0ZD4ke3AuZGF0ZX08L3RkPg0KICAgICAgPHRkPiR7cC5kaXNwbGF5U3RhcnR9ICZyYXJyOyAke3AuZGlzcGxheUVuZH08L3RkPg0KICAgICAgPHRkPiR7cC5vcENsZWFufTwvdGQ+DQogICAgYDsNCiAgICB0Ym9keS5hcHBlbmRDaGlsZCh0cik7DQogIH0pOw0KDQogIGlmKHN1bW1hcnlEaXYgJiYgKCFvbmx5RXJyb3JEYXlzQ2IgfHwgIW9ubHlFcnJvckRheXNDYi5jaGVja2VkKSl7DQogICAgaWYob3V0bGllcnNJblZpZXcubGVuZ3RoKXsNCiAgICAgIHN1bW1hcnlEaXYuc3R5bGUuZGlzcGxheT0nYmxvY2snOw0KICAgICAgc3VtbWFyeURpdi5pbm5lckhUTUwgPQ0KICAgICAgICBgPGEgaHJlZj0iIyIgaWQ9ImhlcmJPdXRsaWVyQ291bnRMaW5rIj5Dw7MgJHtvdXRsaWVyc0luVmlldy5sZW5ndGh9IGNhIGPDsyB24bqlbiDEkeG7gSB0cm9uZyBkYW5oIHPDoWNoIG7DoHkuPC9hPmA7DQogICAgICBjb25zdCBsaW5rID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2hlcmJPdXRsaWVyQ291bnRMaW5rJyk7DQogICAgICBsaW5rLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oZXYpew0KICAgICAgICBldi5wcmV2ZW50RGVmYXVsdCgpOw0KICAgICAgICBpZihtb2RhbEJvZHkpew0KICAgICAgICAgIG1vZGFsQm9keS5pbm5lckhUTUwgPSAnJzsNCiAgICAgICAgICBvdXRsaWVyc0luVmlldy5mb3JFYWNoKHA9PnsNCiAgICAgICAgICAgIGNvbnN0IHRyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndHInKTsNCiAgICAgICAgICAgIHRyLmlubmVySFRNTCA9IGANCiAgICAgICAgICAgICAgPHRkPiR7cC5wYXRpZW50TmFtZX0gWzxmb250IGNvbG9yPSJyZWQiPiR7cC5wYXRpZW50QWdlfTwvZm9udD5dPGJyLz4ke3AucGF0aWVudElkfTwvdGQ+DQogICAgICAgICAgICAgIDx0ZD4ke3AucHJvY2VkdXJlfTwvdGQ+DQogICAgICAgICAgICAgIDx0ZD4ke3AuZGF0ZX08L3RkPg0KICAgICAgICAgICAgICA8dGQ+JHtwLmRpc3BsYXlTdGFydH0gJnJhcnI7ICR7cC5kaXNwbGF5RW5kfTwvdGQ+DQogICAgICAgICAgICAgIDx0ZD4ke3Aub3BDbGVhbn08L3RkPg0KICAgICAgICAgICAgYDsNCiAgICAgICAgICAgIG1vZGFsQm9keS5hcHBlbmRDaGlsZCh0cik7DQogICAgICAgICAgfSk7DQogICAgICAgIH0NCiAgICAgICAgaWYobW9kYWxJbmZvKXsNCiAgICAgICAgICBjb25zdCBub3RlRGF0ZSA9IChzZWxlY3RlZERhdGU9PT0nYWxsJykgPyAnbmhp4buBdSBuZ8OgeScgOiBzZWxlY3RlZERhdGU7DQogICAgICAgICAgbW9kYWxJbmZvLnRleHRDb250ZW50ID0gYFThu5VuZyAke291dGxpZXJzSW5WaWV3Lmxlbmd0aH0gY2Ega2jDoWMgxJFhIHPhu5EgKCR7bm90ZURhdGV9KS5gOw0KICAgICAgICB9DQogICAgICAgIGlmKG1vZGFsKSBtb2RhbC5zdHlsZS5kaXNwbGF5PSdibG9jayc7DQogICAgICB9LCB7b25jZTp0cnVlfSk7DQogICAgfSBlbHNlIHsNCiAgICAgIHN1bW1hcnlEaXYuc3R5bGUuZGlzcGxheT0nbm9uZSc7DQogICAgICBzdW1tYXJ5RGl2LmlubmVySFRNTD0nJzsNCiAgICB9DQogIH0NCn07DQoNCg0KICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgKCk9PnsNCiAgICBjb25zdCB0YWJsZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdoZXJiUHJvY2VkdXJlVGFibGUnKTsNCiAgICBpZih0YWJsZSAmJiB0YWJsZS5zdHlsZS5kaXNwbGF5ICE9PSAnbm9uZScpew0KICAgICAgd2luZG93LnJlbmRlckhlcmJMaXN0KCk7DQogICAgfQ0KICB9KTsNCn0pKCk7DQoNCg0KDQoNCjwvc2NyaXB0Pg0KPHNjcmlwdD4NCiAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigiRE9NQ29udGVudExvYWRlZCIsIGZ1bmN0aW9uICgpIHsNCiAgICBjb25zdCBmaWxlSW5wdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZmlsZUlucHV0Jyk7DQogICAgY29uc3QgYW5hbHl6ZUJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhbmFseXplQnRuJyk7DQogICAgaWYgKGZpbGVJbnB1dCAmJiBhbmFseXplQnRuKSB7DQogICAgICBmaWxlSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgZnVuY3Rpb24gKCkgew0KICAgICAgICBhbmFseXplQnRuLmNsaWNrKCk7DQogICAgICB9KTsNCiAgICB9DQogIH0pOw0KPC9zY3JpcHQ+DQoNCg0KPCEtLSBUSEVNRSBQSUNLRVIgU0NSSVBUIC0tPg0KPHNjcmlwdD4NCihmdW5jdGlvbigpew0KICBjb25zdCBUSEVNRV9LRVkgPSAndWlBY2NlbnRUaGVtZSc7DQogIGNvbnN0IGJvZHkgPSBkb2N1bWVudC5ib2R5Ow0KICBjb25zdCBwaWNrZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndGhlbWVQaWNrZXInKTsNCiAgaWYoIXBpY2tlcikgcmV0dXJuOw0KICBmdW5jdGlvbiBhcHBseVRoZW1lKHQpew0KICAgIGJvZHkuY2xhc3NMaXN0LnJlbW92ZSgndGhlbWUtZGVmYXVsdCcsJ3RoZW1lLW9yYW5nZScsJ3RoZW1lLXJlZCcsJ3RoZW1lLWdyZWVuJyk7DQogICAgaWYodCAmJiB0ICE9PSAnZGVmYXVsdCcpew0KICAgICAgYm9keS5jbGFzc0xpc3QuYWRkKCd0aGVtZS0nK3QpOw0KICAgIH0gZWxzZSB7DQogICAgICBib2R5LmNsYXNzTGlzdC5hZGQoJ3RoZW1lLWRlZmF1bHQnKTsgLy8gZXhwbGljaXQgxJHhu4MgYWN0aXZlIHJpbmcNCiAgICB9DQogICAgcGlja2VyLnF1ZXJ5U2VsZWN0b3JBbGwoJy50aGVtZS1zd2F0Y2gnKS5mb3JFYWNoKGJ0bj0+ew0KICAgICAgYnRuLmNsYXNzTGlzdC50b2dnbGUoJ2lzLWFjdGl2ZScsIGJ0bi5kYXRhc2V0LnRoZW1lPT09dCB8fCAodD09PScnICYmIGJ0bi5kYXRhc2V0LnRoZW1lPT09J2RlZmF1bHQnKSk7DQogICAgfSk7DQogICAgdHJ5eyBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShUSEVNRV9LRVksdHx8J2RlZmF1bHQnKTsgfWNhdGNoKGUpe30NCiAgfQ0KICBjb25zdCBzYXZlZCA9IChmdW5jdGlvbigpe3RyeXtyZXR1cm4gbG9jYWxTdG9yYWdlLmdldEl0ZW0oVEhFTUVfS0VZKSB8fCAnZGVmYXVsdCc7fWNhdGNoKGUpe3JldHVybiAnZGVmYXVsdCc7fX0pKCk7DQogIGFwcGx5VGhlbWUoc2F2ZWQpOw0KICBwaWNrZXIuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLGU9PnsNCiAgICBjb25zdCBidG4gPSBlLnRhcmdldC5jbG9zZXN0KCcudGhlbWUtc3dhdGNoJyk7DQogICAgaWYoIWJ0bikgcmV0dXJuOw0KICAgIGFwcGx5VGhlbWUoYnRuLmRhdGFzZXQudGhlbWUpOw0KICB9KTsNCn0pKCk7DQo8L3NjcmlwdD4NCg0KPHNjcmlwdD4NCmZ1bmN0aW9uIHVwZGF0ZUhlcmJCdXR0b25XaXRoT3V0bGllckNvdW50KCkgew0KICBjb25zdCBidG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaGVyYlRvZ2dsZUJ0bicpOw0KICBpZiAoIWJ0biB8fCAhd2luZG93LmFsbEhlcmJQcm9jZWR1cmVzKSByZXR1cm47DQoNCiAgY29uc3QgaGVyYnMgPSB3aW5kb3cuYWxsSGVyYlByb2NlZHVyZXM7DQogIGNvbnN0IGNvdW50cyA9IHt9Ow0KDQogIGhlcmJzLmZvckVhY2goaCA9PiB7DQogICAgY29uc3QgZGF0ZSA9IGguZGF0ZTsNCiAgICBjb25zdCBrZXkgPSBkYXRlOw0KICAgIGlmICghY291bnRzW2tleV0pIGNvdW50c1trZXldID0ge307DQogICAgY29uc3QgbmFtZSA9IChoLm9wZXJhdG9yIHx8ICdLaMO0bmcgY8OzJykudHJpbSgpLnRvTG93ZXJDYXNlKCk7DQogICAgY291bnRzW2tleV1bbmFtZV0gPSAoY291bnRzW2tleV1bbmFtZV0gfHwgMCkgKyAxOw0KICB9KTsNCg0KICBsZXQgb3V0bGllckNvdW50ID0gMDsNCg0KICBPYmplY3Qua2V5cyhjb3VudHMpLmZvckVhY2goZGF0ZSA9PiB7DQogICAgY29uc3Qgb3BzID0gY291bnRzW2RhdGVdOw0KICAgIGNvbnN0IGVudHJpZXMgPSBPYmplY3QuZW50cmllcyhvcHMpLnNvcnQoKGEsIGIpID0+IGJbMV0gLSBhWzFdKTsNCiAgICBjb25zdCB0b3AgPSBlbnRyaWVzWzBdOw0KICAgIGlmICghdG9wKSByZXR1cm47DQoNCiAgICBjb25zdCB0b3BOYW1lID0gdG9wWzBdOw0KICAgIGNvbnN0IHRvcENvdW50ID0gdG9wWzFdOw0KDQogICAgZm9yIChjb25zdCBbbmFtZSwgY291bnRdIG9mIGVudHJpZXMpIHsNCiAgICAgIGlmIChuYW1lICE9PSB0b3BOYW1lICYmIGNvdW50ID4gMCkgew0KICAgICAgICBvdXRsaWVyQ291bnQgKz0gY291bnQ7DQogICAgICB9DQogICAgfQ0KICB9KTsNCg0KYnRuLmlubmVySFRNTCA9IGBT4bqvYyB0aHXhu5FjIHRoYW5nIDxpIGNsYXNzPSJmYS1zb2xpZCBmYS10cmlhbmdsZS1leGNsYW1hdGlvbiIgc3R5bGU9ImNvbG9yOnllbGxvdyI+PC9pPiA8c3BhbiBzdHlsZT0iY29sb3I6eWVsbG93OyBmb250LXdlaWdodDpib2xkIj4oJHtvdXRsaWVyQ291bnR9KTwvc3Bhbj5gOw0KDQoNCn0NCjwvc2NyaXB0Pg0KPGRpdiBpZD0iZHJvcGJveFBhbmVsIiBzdHlsZT0iZGlzcGxheTpub25lOyBwb3NpdGlvbjpmaXhlZDsgaW5zZXQ6MDsgYmFja2dyb3VuZDpyZ2JhKDAsMCwwLDAuNSk7IHotaW5kZXg6OTk5OTsiPg0KICA8ZGl2IHN0eWxlPSJtYXJnaW46NSUgYXV0bzsgYmFja2dyb3VuZDojZmZmOyBwYWRkaW5nOjIwcHg7IG1heC13aWR0aDo5MCU7IGJvcmRlci1yYWRpdXM6MTBweDsgbWF4LWhlaWdodDo4MHZoOyBvdmVyZmxvdzphdXRvIj4NCiAgIDxkaXYgc3R5bGU9ImRpc3BsYXk6IGZsZXg7IGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjsgYWxpZ24taXRlbXM6IGNlbnRlcjsiPg0KICA8aDM+8J+TgiBEYW5oIHPDoWNoIEtob2EgxJHDoyBz4butIGThu6VuZyBwaOG6p24gbeG7gW08L2gzPg0KICA8YnV0dG9uIGNsYXNzPSJidG4ib25jbGljaz0iZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Ryb3Bib3hQYW5lbCcpLnN0eWxlLmRpc3BsYXk9J25vbmUnInN0eWxlPSJwYWRkaW5nOjhweCAxNHB4OyBmb250LXNpemU6MTNweDsgYm9yZGVyLXJhZGl1czo0cHg7Ij4NCiAgICDEkMOzbmcNCiAgPC9idXR0b24+DQo8L2Rpdj4NCjwhLS0gUGFnaW5hdGlvbiBjb250cm9scyAtLT4NCjxkaXYgaWQ9ImRyb3Bib3hQYWdlciIgc3R5bGU9ImRpc3BsYXk6ZmxleDthbGlnbi1pdGVtczpjZW50ZXI7Z2FwOjhweDtqdXN0aWZ5LWNvbnRlbnQ6c3BhY2UtYmV0d2VlbjttYXJnaW4tdG9wOjEycHgiPg0KICA8ZGl2Pg0KICAgIEhp4buDbiB0aOG7iw0KICAgIDxzZWxlY3QgaWQ9ImRyb3Bib3hQYWdlU2l6ZSIgc3R5bGU9InBhZGRpbmc6NnB4IDhweDtib3JkZXI6MXB4IHNvbGlkICNkZGQ7Ym9yZGVyLXJhZGl1czo2cHgiPg0KICAgICAgPG9wdGlvbiB2YWx1ZT0iMTAiIHNlbGVjdGVkPjEwPC9vcHRpb24+DQogICAgICA8b3B0aW9uIHZhbHVlPSIyMCI+MjA8L29wdGlvbj4NCiAgICAgIDxvcHRpb24gdmFsdWU9IjUwIj41MDwvb3B0aW9uPg0KICAgIDwvc2VsZWN0Pg0KICAgIGTDsm5nIC8gdHJhbmcNCiAgPC9kaXY+DQoNCiAgPGRpdiBpZD0iZHJvcGJveFBhZ2VCdXR0b25zIiBzdHlsZT0iZGlzcGxheTpmbGV4O2dhcDo2cHg7ZmxleC13cmFwOndyYXAiPjwvZGl2Pg0KDQogIDxkaXYgaWQ9ImRyb3Bib3hQYWdlSW5mbyIgc3R5bGU9Im1pbi13aWR0aDoxNzBweDt0ZXh0LWFsaWduOnJpZ2h0Ij48L2Rpdj4NCjwvZGl2Pg0KICAgIDx0YWJsZSBib3JkZXI9IjEiIGNlbGxwYWRkaW5nPSI4IiBzdHlsZT0id2lkdGg6MTAwJTsgYm9yZGVyLWNvbGxhcHNlOmNvbGxhcHNlOyBmb250LXNpemU6MTRweCI+DQogICAgICA8dGhlYWQ+DQogICAgICAgIDx0cj4NCiAgICAgICAgICA8dGg+U1RUPC90aD4NCiAgICAgICAgICA8dGg+VMOqbiBraG9hPC90aD4NCiAgICAgICAgICA8dGg+TmfDoHk8L3RoPg0KICAgICAgICAgIDx0aD5T4bqvYyB0aHXhu5FjPC90aD4NCiAgICAgICAgIDx0aD5TYWkgdGjhu51pIGdpYW48L3RoPg0KICAgICAgIDx0aD5UcsO5bmcgZ2nhu508L3RoPg0KICAgICAgIA0KICAgICAgICAgIDx0aD5UaOG7nWkgZ2lhbjwvdGg+DQoJCSAgPHRoPkxpbms8L3RoPg0KCQkgIDx0aD5Yb8OhPC90aD4NCiAgICAgICAgPC90cj4NCiAgICAgIDwvdGhlYWQ+DQogICAgICA8dGJvZHkgaWQ9ImRyb3Bib3hGaWxlTGlzdCI+PC90Ym9keT4NCiAgICA8L3RhYmxlPg0KICANCiAgPC9kaXY+DQo8L2Rpdj48c2NyaXB0Pg0KYXN5bmMgZnVuY3Rpb24gc2hvd0Ryb3Bib3hQYW5lbCgpIHsNCmF3YWl0IGVuc3VyZURyb3Bib3goKTsgLy8gxJHhuqNtIGLhuqNvIGPDsyBEcm9wYm94IFNESw0KDQogIGNvbnN0IGFjY2Vzc1Rva2VuID0gYXdhaXQgZ2V0QWNjZXNzVG9rZW4oKTsNCiAgY29uc3QgZGJ4ID0gbmV3IERyb3Bib3guRHJvcGJveCh7IGFjY2Vzc1Rva2VuIH0pOw0KICBjb25zdCB0Ym9keSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkcm9wYm94RmlsZUxpc3QnKTsNCg0KICAvLyBIaeG7h24gcG9wdXAgbmdheSBs4bqtcCB04bupYyB24bubaSB0cuG6oW5nIHRow6FpIGxvYWRpbmcNCiAgdGJvZHkuaW5uZXJIVE1MID0gYDx0cj48dGQgY29sc3Bhbj0iOSIgc3R5bGU9InRleHQtYWxpZ246Y2VudGVyOyBjb2xvcjpibHVlOyI+DQogICAgxJBhbmcgdOG6o2kgZOG7ryBsaeG7h3UuLi4NCiAgPC90ZD48L3RyPmA7DQogIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkcm9wYm94UGFuZWwnKS5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsNCg0KICB0cnkgew0KICAgIC8vIDEpIEtp4buDbSB0cmEgdOG7k24gdOG6oWkgbG9nLmpzb24NCiAgICBsZXQgaGFzTG9nID0gZmFsc2U7DQogICAgbGV0IHJlcyA9IGF3YWl0IGRieC5maWxlc0xpc3RGb2xkZXIoeyBwYXRoOiAnL3RodXRodWF0JyB9KTsNCiAgICB3aGlsZSAodHJ1ZSkgew0KICAgICAgaWYgKHJlcy5yZXN1bHQ/LmVudHJpZXM/LnNvbWUoZSA9PiBlWycudGFnJ10gPT09ICdmaWxlJyAmJiBlLm5hbWUgPT09ICdsb2cuanNvbicpKSB7DQogICAgICAgIGhhc0xvZyA9IHRydWU7DQogICAgICAgIGJyZWFrOw0KICAgICAgfQ0KICAgICAgaWYgKCFyZXMucmVzdWx0Py5oYXNfbW9yZSkgYnJlYWs7DQogICAgICByZXMgPSBhd2FpdCBkYnguZmlsZXNMaXN0Rm9sZGVyQ29udGludWUoeyBjdXJzb3I6IHJlcy5yZXN1bHQuY3Vyc29yIH0pOw0KICAgIH0NCg0KICAgIC8vIDIpIE7hur91IGtow7RuZyBjw7MgZmlsZSDihpIgY+G6rXAgbmjhuq10IG7hu5lpIGR1bmcNCiAgICBpZiAoIWhhc0xvZykgew0KICAgICAgdGJvZHkuaW5uZXJIVE1MID0gYDx0cj48dGQgY29sc3Bhbj0iNiIgc3R5bGU9InRleHQtYWxpZ246Y2VudGVyOyBjb2xvcjpyZWQ7Ij4NCiAgICAgICAgS2jDtG5nIGPDsyBkYW5oIHPDoWNoIG7DoG8gxJHGsOG7o2MgbMawdQ0KICAgICAgPC90ZD48L3RyPmA7DQogICAgICByZXR1cm47DQogICAgfQ0KDQogICAgLy8gMykgQ8OzIGZpbGUg4oaSIHThuqNpIHbDoCBoaeG7g24gdGjhu4sNCiAgICBjb25zdCBkbCA9IGF3YWl0IGRieC5maWxlc0Rvd25sb2FkKHsgcGF0aDogJy90aHV0aHVhdC9sb2cuanNvbicgfSk7DQogICAgY29uc3QgdGV4dCA9IGF3YWl0IGRsLnJlc3VsdC5maWxlQmxvYi50ZXh0KCk7DQogICAgbGV0IGxvZ3MgPSBbXTsNCiAgICB0cnkgeyBsb2dzID0gSlNPTi5wYXJzZSh0ZXh0KTsgfSBjYXRjaCB7IGxvZ3MgPSBbXTsgfQ0KDQogICAgaWYgKCFsb2dzLmxlbmd0aCkgew0KICAgICAgdGJvZHkuaW5uZXJIVE1MID0gYDx0cj48dGQgY29sc3Bhbj0iNiIgc3R5bGU9InRleHQtYWxpZ246Y2VudGVyOyBjb2xvcjpyZWQ7Ij4NCiAgICAgICAgS2jDtG5nIGPDsyBkYW5oIHPDoWNoIG7DoG8gxJHGsOG7o2MgbMawdQ0KICAgICAgPC90ZD48L3RyPmA7DQogICAgfSBlbHNlIHsNCiBjb25zdCBjdXJyZW50VXNlciA9IChzZXNzaW9uU3RvcmFnZS5nZXRJdGVtKCdtZWRVc2VyJykgfHwgJycpLnRvTG93ZXJDYXNlKCk7DQoNCi8vIFJlbmRlciBt4bubaSDigJMgZ2lhbyBjaG8gYuG7mSBwaMOibiB0cmFuZzoNCkRCX0xPR1MgPSBsb2dzOyAvLyBt4bqjbmcgZOG7ryBsaeG7h3UgxJHhuqd5IMSR4bunDQpEQl9QQUdFID0gMTsgICAgLy8gduG7gSB0cmFuZyAxIG3hu5dpIGtoaSBt4bufIHBhbmVsDQpEQl9DVVJSRU5UX1VTRVIgPSAoc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbSgnbWVkVXNlcicpIHx8ICcnKS50b0xvd2VyQ2FzZSgpOw0KDQphdHRhY2hQYWdlckV2ZW50c09uY2UoKTsgLy8gZ+G6r24gY2hhbmdlIGNobyBzZWxlY3QgcGFnZSBzaXplIChjaOG7iSAxIGzhuqduKQ0KcmVuZGVyRHJvcGJveFBhZ2UoKTsgICAgIC8vIHbhur0gdGJvZHkgKyBuw7p0IHRyYW5nIHThu6sgREJfTE9HUw0KICAgIH0NCiAgfSBjYXRjaCAoZXJyKSB7DQogICAgY29uc29sZS5lcnJvcignTOG7l2kga2hpIMSR4buNYyBkYW5oIHPDoWNoIHThu6sgRHJvcGJveDonLCBlcnIpOw0KICAgIHRib2R5LmlubmVySFRNTCA9IGA8dHI+PHRkIGNvbHNwYW49IjYiIHN0eWxlPSJ0ZXh0LWFsaWduOmNlbnRlcjsgY29sb3I6cmVkOyI+DQogICAgICBLaMO0bmcgdGjhu4MgdOG6o2kgZOG7ryBsaeG7h3UNCiAgICA8L3RkPjwvdHI+YDsNCiAgfQ0KfQ0KKGZ1bmN0aW9uKCl7DQogIGNvbnN0IHBhZ2VyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Ryb3Bib3hQYWdlcicpOw0KICBpZiAocGFnZXIgJiYgIXBhZ2VyLmRhdGFzZXQuYm91bmQpIHsNCiAgICBwYWdlci5kYXRhc2V0LmJvdW5kID0gJzEnOw0KICAgIHBhZ2VyLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZSA9PiBlLnN0b3BQcm9wYWdhdGlvbigpKTsNCiAgICBwYWdlci5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCBlID0+IGUuc3RvcFByb3BhZ2F0aW9uKCkpOw0KICB9DQp9KSgpOw0KDQo8L3NjcmlwdD4NCg0KDQoNCjxzY3JpcHQ+DQpmdW5jdGlvbiB2ZXJpZnlBbmRPcGVuTGluayh1cmwpIHsNCg0KDQogIC8vIE92ZXJsYXkgdOG7kWkgKGNsaWNrIHbDoG8gc+G6vSB04bqvdCkNCiAgY29uc3Qgb3ZlcmxheSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOw0KICBPYmplY3QuYXNzaWduKG92ZXJsYXkuc3R5bGUsIHsNCiAgICBwb3NpdGlvbjogJ2ZpeGVkJywgaW5zZXQ6ICcwJywgYmFja2dyb3VuZDogJ3JnYmEoMCwwLDAsMC41KScsDQogICAgZGlzcGxheTogJ2ZsZXgnLCBqdXN0aWZ5Q29udGVudDogJ2NlbnRlcicsIGFsaWduSXRlbXM6ICdjZW50ZXInLA0KICAgIHpJbmRleDogJzEwMDAwJw0KICB9KTsNCg0KICAvLyBLaHVuZyBwb3B1cA0KICBjb25zdCBib3ggPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsNCiAgT2JqZWN0LmFzc2lnbihib3guc3R5bGUsIHsNCiAgICBiYWNrZ3JvdW5kOiAnI2ZmZicsIHBhZGRpbmc6ICcyNHB4JywgYm9yZGVyUmFkaXVzOiAnMTBweCcsDQogICAgbWF4V2lkdGg6ICc0MjBweCcsIHdpZHRoOiAnOTAlJywgYm94U2hhZG93OiAnMCA0cHggMTBweCByZ2JhKDAsMCwwLDAuMyknLA0KICAgIGRpc3BsYXk6ICdmbGV4JywgZmxleERpcmVjdGlvbjogJ2NvbHVtbicsIGFsaWduSXRlbXM6ICdjZW50ZXInLCBnYXA6ICcxMnB4Jw0KICB9KTsNCg0KICAvLyBUacOqdSDEkeG7gSBuZ+G6r24gZ+G7jW4gKGtow7RuZyBjw7MgaWNvbi9n4butaSBk4buvIGxp4buHdSkNCiAgY29uc3QgdGl0bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsNCiAgdGl0bGUudGV4dENvbnRlbnQgPSAnTmjhuq1wIG3huq10IGto4bqpdSDEkeG7gyBt4bufIGxpbmsnOw0KICB0aXRsZS5zdHlsZS5mb250V2VpZ2h0ID0gJzYwMCc7DQoNCiAgLy8gw5Qgbmjhuq1wIG3huq10IGto4bqpdQ0KICBjb25zdCBpbnB1dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0Jyk7DQogIE9iamVjdC5hc3NpZ24oaW5wdXQsIHsgdHlwZTogJ3Bhc3N3b3JkJywgcGxhY2Vob2xkZXI6ICdN4bqtdCBraOG6qXUnIH0pOw0KICBPYmplY3QuYXNzaWduKGlucHV0LnN0eWxlLCB7DQogICAgcGFkZGluZzogJzEwcHgnLCB3aWR0aDogJzEwMCUnLCBib3JkZXI6ICcxcHggc29saWQgI2RkZCcsIGJvcmRlclJhZGl1czogJzZweCcNCiAgfSk7DQoNCiAgLy8gVGjDtG5nIGLDoW8gbOG7l2kgKOG6qW4gbeG6t2MgxJHhu4tuaCkNCiAgY29uc3QgZXJyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7DQogIGVyci50ZXh0Q29udGVudCA9ICfinYwgU2FpIG3huq10IGto4bqpdSEnOw0KICBPYmplY3QuYXNzaWduKGVyci5zdHlsZSwgeyBjb2xvcjogJ3JlZCcsIGZvbnRTaXplOiAnMTRweCcsIGRpc3BsYXk6ICdub25lJyB9KTsNCg0KICAvLyBOw7p0IHjDoWMgbmjhuq1uDQogIGNvbnN0IGJ0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpOw0KICBidG4udGV4dENvbnRlbnQgPSAnWMOhYyBuaOG6rW4nOw0KICBPYmplY3QuYXNzaWduKGJ0bi5zdHlsZSwgew0KICAgIHBhZGRpbmc6ICcxMHB4IDE2cHgnLCBiYWNrZ3JvdW5kOiAnIzM0OThkYicsIGNvbG9yOiAnI2ZmZicsDQogICAgYm9yZGVyOiAnbm9uZScsIGJvcmRlclJhZGl1czogJzZweCcsIGN1cnNvcjogJ3BvaW50ZXInDQogIH0pOw0KDQogIC8vIFByb2dyZXNzIGJhciAoxJHhurd0IETGr+G7mkkgQ8OZTkcpDQogIGNvbnN0IGJhcldyYXAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsNCiAgT2JqZWN0LmFzc2lnbihiYXJXcmFwLnN0eWxlLCB7DQogICAgd2lkdGg6ICcxMDAlJywgYmFja2dyb3VuZDogJyNkZGQnLCBoZWlnaHQ6ICc2cHgnLA0KICAgIGJvcmRlclJhZGl1czogJzNweCcsIG1hcmdpblRvcDogJzEycHgnDQogIH0pOw0KICBjb25zdCBiYXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsNCiAgT2JqZWN0LmFzc2lnbihiYXIuc3R5bGUsIHsgd2lkdGg6ICcwJScsIGhlaWdodDogJzEwMCUnLCBiYWNrZ3JvdW5kOiAnIzM0OThkYicgfSk7DQogIGJhcldyYXAuYXBwZW5kQ2hpbGQoYmFyKTsNCg0KICAvLyBH4bqvbiB2w6BvIERPTQ0KICBib3guYXBwZW5kQ2hpbGQodGl0bGUpOw0KICBib3guYXBwZW5kQ2hpbGQoaW5wdXQpOw0KICBib3guYXBwZW5kQ2hpbGQoZXJyKTsNCiAgYm94LmFwcGVuZENoaWxkKGJ0bik7DQogIGJveC5hcHBlbmRDaGlsZChiYXJXcmFwKTsNCiAgb3ZlcmxheS5hcHBlbmRDaGlsZChib3gpOw0KICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKG92ZXJsYXkpOw0KDQogIC8vIENo4bq3biBjbGljayBiw6puIHRyb25nIGtow7RuZyDEkcOzbmcNCiAgYm94LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZSA9PiBlLnN0b3BQcm9wYWdhdGlvbigpKTsNCiAgLy8gQ2xpY2sgcmEgbmdvw6BpIMSR4buDIHThuq90DQogIG92ZXJsYXkuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7DQogICAgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChvdmVybGF5KTsNCiAgfSk7DQoNCiAgLy8gWOG7rSBsw70geMOhYyBuaOG6rW4NCiAgYXN5bmMgZnVuY3Rpb24gc3VibWl0KCkgew0KICAgIC8vIMSQ4buVaSBt4bqtdCBraOG6qXUg4bufIMSRw6J5DQogICAgY29uc3QgT0sgPSBpbnB1dC52YWx1ZSA9PT0gJzEhJzsNCg0KICAgIGlmICghT0spIHsNCiAgICAgIGVyci5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsNCiAgICAgIHJldHVybjsNCiAgICB9DQogICAgZXJyLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7DQogICAgYnRuLmRpc2FibGVkID0gdHJ1ZTsNCiAgICBpbnB1dC5kaXNhYmxlZCA9IHRydWU7DQoNCiAgICAvLyBBbmltYXRlIHByb2dyZXNzIG5oYW5oIGzDqm4gMTAwJQ0KICAgIGJhci5zdHlsZS50cmFuc2l0aW9uID0gJ3dpZHRoIDAuNnMgZWFzZSc7DQogICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKCgpID0+IChiYXIuc3R5bGUud2lkdGggPSAnMTAwJScpKTsNCiAgICBzZXRUaW1lb3V0KCgpID0+IHsNCiAgICAgIHdpbmRvdy5vcGVuKHVybCwgJ19ibGFuaycpOw0KICAgICAgaWYgKG92ZXJsYXkucGFyZW50Tm9kZSkgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChvdmVybGF5KTsNCiAgICB9LCA2NTApOw0KICB9DQoNCiAgYnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgc3VibWl0KTsNCiAgaW5wdXQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIChlKSA9PiB7DQogICAgaWYgKGUua2V5ID09PSAnRW50ZXInKSBzdWJtaXQoKTsNCiAgfSk7DQoNCiAgLy8gRm9jdXMgbmdheSDDtCBt4bqtdCBraOG6qXUNCiAgc2V0VGltZW91dCgoKSA9PiBpbnB1dC5mb2N1cygpLCAwKTsNCn0NCg0KZnVuY3Rpb24gZXh0cmFjdEZpbGVuYW1lKGRyb3Bib3hQcmV2aWV3VXJsKSB7DQogIHRyeSB7DQogICAgY29uc3QgdSA9IG5ldyBVUkwoZHJvcGJveFByZXZpZXdVcmwpOw0KICAgIGNvbnN0IHAgPSB1LnNlYXJjaFBhcmFtcy5nZXQoJ3ByZXZpZXcnKTsNCiAgICByZXR1cm4gZGVjb2RlVVJJQ29tcG9uZW50KHAgfHwgJycpOw0KICB9IGNhdGNoIHsgcmV0dXJuICcnOyB9DQp9DQoNCi8vIEjhu5lwIHjDoWMgbmjhuq1uIHhvw6EgKHRy4bqjIHbhu4EgUHJvbWlzZTxib29sZWFuPikNCmZ1bmN0aW9uIGNvbmZpcm1EZWxldGVQb3B1cCh0ZXh0PSdC4bqhbiBjw7MgY2jhuq9jIG114buRbiB4b8OhPycsIG9uZUJ1dHRvbj1mYWxzZSkgew0KICByZXR1cm4gbmV3IFByb21pc2UocmVzb2x2ZSA9PiB7DQogICAgY29uc3Qgb3ZlcmxheSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOw0KICAgIE9iamVjdC5hc3NpZ24ob3ZlcmxheS5zdHlsZSwgew0KICAgICAgcG9zaXRpb246J2ZpeGVkJywgaW5zZXQ6JzAnLCBiYWNrZ3JvdW5kOidyZ2JhKDAsMCwwLDAuNSknLA0KICAgICAgZGlzcGxheTonZmxleCcsIGFsaWduSXRlbXM6J2NlbnRlcicsIGp1c3RpZnlDb250ZW50OidjZW50ZXInLCB6SW5kZXg6MTAwMDENCiAgICB9KTsNCg0KICAgIGNvbnN0IGJveCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOw0KICAgIE9iamVjdC5hc3NpZ24oYm94LnN0eWxlLCB7DQogICAgICBiYWNrZ3JvdW5kOicjZmZmJywgcGFkZGluZzonMjBweCcsIGJvcmRlclJhZGl1czonOHB4JywNCiAgICAgIG1heFdpZHRoOic0MjBweCcsIHdpZHRoOic5MCUnLCBib3hTaGFkb3c6JzAgNHB4IDEycHggcmdiYSgwLDAsMCwuMjUpJywNCiAgICAgIGZvbnRGYW1pbHk6J0ludGVyLCBzYW5zLXNlcmlmJw0KICAgIH0pOw0KDQogICAgYm94LmlubmVySFRNTCA9IGANCiAgICAgIDxkaXYgc3R5bGU9ImZvbnQtd2VpZ2h0OjYwMDsgbWFyZ2luLWJvdHRvbTo4cHgiPljDoWMgbmjhuq1uIHhvw6E8L2Rpdj4NCiAgICAgIDxkaXYgc3R5bGU9Im1hcmdpbi1ib3R0b206MTRweCI+JHt0ZXh0fTwvZGl2Pg0KICAgICAgPGRpdiBzdHlsZT0iZGlzcGxheTpmbGV4OyBnYXA6MTBweDsganVzdGlmeS1jb250ZW50OmZsZXgtZW5kIj4NCiAgICAgICAgPGJ1dHRvbiBpZD0iZGxnQ2FuY2VsIiBjbGFzcz0iYnRuIiBzdHlsZT0iYmFja2dyb3VuZDojN2Y4YzhkIj5IdeG7tzwvYnV0dG9uPg0KICAgICAgICAkeyFvbmVCdXR0b24gPyBgPGJ1dHRvbiBpZD0iZGxnWWVzIiBjbGFzcz0iYnRuIiBzdHlsZT0iYmFja2dyb3VuZDojZTc0YzNjIj5Yb8OhPC9idXR0b24+YCA6ICcnfQ0KICAgICAgPC9kaXY+DQogICAgYDsNCg0KICAgIG92ZXJsYXkuYXBwZW5kQ2hpbGQoYm94KTsNCiAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKG92ZXJsYXkpOw0KDQogICAgYm94LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZSA9PiBlLnN0b3BQcm9wYWdhdGlvbigpKTsNCiAgICBvdmVybGF5LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4geyBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKG92ZXJsYXkpOyByZXNvbHZlKGZhbHNlKTsgfSk7DQogICAgYm94LnF1ZXJ5U2VsZWN0b3IoJyNkbGdDYW5jZWwnKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChvdmVybGF5KTsgcmVzb2x2ZShmYWxzZSk7IH0pOw0KDQogICAgaWYgKCFvbmVCdXR0b24pIHsNCiAgICAgIGJveC5xdWVyeVNlbGVjdG9yKCcjZGxnWWVzJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7IGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQob3ZlcmxheSk7IHJlc29sdmUodHJ1ZSk7IH0pOw0KICAgIH0NCiAgfSk7DQp9DQoNCi8vIFhvw6EgMSBlbnRyeSBsb2cgKyBmaWxlIEV4Y2VsIHRyw6puIERyb3Bib3ggKHRoZW8gaW5kZXggdHJvbmcgbeG6o25nIGxvZ3MpDQphc3luYyBmdW5jdGlvbiBkZWxldGVMb2dBbmRGaWxlX0J5SW5kZXgoaWR4KSB7DQogIGNvbnN0IGFjY2Vzc1Rva2VuID0gYXdhaXQgZ2V0QWNjZXNzVG9rZW4oKTsNCiAgY29uc3QgZGJ4ID0gbmV3IERyb3Bib3guRHJvcGJveCh7IGFjY2Vzc1Rva2VuIH0pOw0KICBjb25zdCBsb2dQYXRoID0gJy90aHV0aHVhdC9sb2cuanNvbic7DQoNCiAgLy8gMSkgVOG6o2kgbG9nLmpzb24gaGnhu4duIHThuqFpDQogIGxldCBsb2dzID0gW107DQogIHRyeSB7DQogICAgY29uc3QgZGwgPSBhd2FpdCBkYnguZmlsZXNEb3dubG9hZCh7IHBhdGg6IGxvZ1BhdGggfSk7DQogICAgY29uc3QgdGV4dCA9IGF3YWl0IGRsLnJlc3VsdC5maWxlQmxvYi50ZXh0KCk7DQogICAgbG9ncyA9IEpTT04ucGFyc2UodGV4dCB8fCAnW10nKTsNCiAgfSBjYXRjaCAoZSkgew0KICAgIGFsZXJ0KCdLaMO0bmcgxJHhu41jIMSRxrDhu6NjIGxvZy5qc29uIHRyw6puIERyb3Bib3guJyk7IA0KICAgIHRocm93IGU7DQogIH0NCg0KICBjb25zdCBpdGVtID0gbG9nc1tpZHhdOw0KICBpZiAoIWl0ZW0pIHsgYWxlcnQoJ0tow7RuZyB0w6xtIHRo4bqleSBt4bulYyBj4bqnbiB4b8OhLicpOyByZXR1cm47IH0NCg0KICAvLyAyKSBM4bqleSBmaWxlTmFtZSAmIHhvw6EgZmlsZSBFeGNlbCAobuG6v3UgY8OzKQ0KICBjb25zdCBmaWxlTmFtZSA9IGV4dHJhY3RGaWxlbmFtZShpdGVtLmxpbmsgfHwgJycpOw0KICBjb25zdCBmaWxlUGF0aCA9IGZpbGVOYW1lID8gYC90aHV0aHVhdC8ke2ZpbGVOYW1lfWAgOiBudWxsOw0KDQogIHRyeSB7DQogICAgaWYgKGZpbGVQYXRoKSB7IGF3YWl0IGRieC5maWxlc0RlbGV0ZVYyKHsgcGF0aDogZmlsZVBhdGggfSk7IH0NCiAgfSBjYXRjaCAoZSkgew0KICAgIC8vIE7hur91IGZpbGUga2jDtG5nIHThu5NuIHThuqFpIHbhuqtuIHRp4bq/cCB04bulYyB4b8OhIGxvZw0KICAgIGNvbnNvbGUud2FybignWG/DoSBmaWxlIEV4Y2VsIGzhu5dpL2tow7RuZyB04buTbiB04bqhaSwgdGnhur9wIHThu6VjIHhvw6EgbG9nLi4uJywgZSk7DQogIH0NCg0KICAvLyAzKSBD4bqtcCBuaOG6rXQgbG9nOiBi4buPIHBo4bqnbiB04butIGlkeCB2w6AgZ2hpIMSRw6ggbOG6oWkNCiAgbG9ncy5zcGxpY2UoaWR4LCAxKTsNCiAgYXdhaXQgZGJ4LmZpbGVzVXBsb2FkKHsNCiAgICBwYXRoOiBsb2dQYXRoLA0KICAgIGNvbnRlbnRzOiBKU09OLnN0cmluZ2lmeShsb2dzLCBudWxsLCAyKSwNCiAgICBtb2RlOiB7ICcudGFnJzogJ292ZXJ3cml0ZScgfSwNCiAgICBhdXRvcmVuYW1lOiBmYWxzZQ0KICB9KTsNCn0NCg0KDQphc3luYyBmdW5jdGlvbiBvbkRlbGV0ZUxvZ1JvdyhpbmRleEluTG9ncywgY3VycmVudFVzZXIpIHsNCiAgLy8gTuG6v3Uga2jDtG5nIHBo4bqjaSBkb2N0b3Ig4oaSIHBvcHVwIGPhuqVtIHhvw6EsIGNo4buJIGPDsyAxIG7DunQgSHXhu7cNCiAgaWYgKGN1cnJlbnRVc2VyICE9PSAnZG9jdG9yJykgew0KICAgIGF3YWl0IGNvbmZpcm1EZWxldGVQb3B1cCgNCiAgICAgICfinYwgw4ogbMOgbSBjw6FpIGfDrCDEkeG6pXl5eXkgZW0gxqFpLiA8YnIvPkThu6tuZyBs4bqhaSBuZ2F5LCBxdcOhIG5ndXkgaGnhu4NtLicsDQogICAgICB0cnVlIC8vIDwtLSBjaOG6vyDEkeG7mSAxIG7DunQNCiAgICApOw0KICAgIHJldHVybjsNCiAgfQ0KDQogIC8vIE7hur91IGzDoCBkb2N0b3Ig4oaSIHBvcHVwIHjDoWMgbmjhuq1uIHhvw6EgKDIgbsO6dCkNCiAgY29uc3Qgb2sgPSBhd2FpdCBjb25maXJtRGVsZXRlUG9wdXAoDQogICAgJ0LhuqFuIGPDsyBjaOG6r2MgbXXhu5FuIHhvw6EgbeG7pWMgbsOgeT8nLA0KICAgIGZhbHNlDQogICk7DQogIGlmICghb2spIHJldHVybjsNCg0KICB0cnkgew0KICAgIGF3YWl0IGRlbGV0ZUxvZ0FuZEZpbGVfQnlJbmRleChpbmRleEluTG9ncyk7DQogICAgYXdhaXQgY29uZmlybURlbGV0ZVBvcHVwKCfinIUgxJDDoyB4b8OhIHRow6BuaCBjw7RuZyEnLCB0cnVlKTsNCiAgICBhd2FpdCBzaG93RHJvcGJveFBhbmVsKCk7DQogIH0gY2F0Y2ggKGUpIHsNCiAgICBjb25zb2xlLmVycm9yKGUpOw0KICAgIGF3YWl0IGNvbmZpcm1EZWxldGVQb3B1cCgn4pqg77iPIEPDsyBs4buXaSBraGkgeG/DoS4gVnVpIGzDsm5nIHRo4butIGzhuqFpLicsIHRydWUpOw0KICB9DQp9DQoNCi8vIMSQw7NuZyBwYW5lbCBraGkgYuG6pW0gRVNDIGhv4bq3YyBjbGljayByYSBuZ2/DoGkNCmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoImtleWRvd24iLCBmdW5jdGlvbihlKSB7DQogIGlmIChlLmtleSA9PT0gIkVzY2FwZSIpIHsNCiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiZHJvcGJveFBhbmVsIikuc3R5bGUuZGlzcGxheSA9ICJub25lIjsNCiAgfQ0KfSk7DQoNCmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIiwgZnVuY3Rpb24oZSkgew0KICBjb25zdCBwYW5lbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJkcm9wYm94UGFuZWwiKTsNCiAgaWYgKHBhbmVsLnN0eWxlLmRpc3BsYXkgPT09ICJibG9jayIgfHwgcGFuZWwuc3R5bGUuZGlzcGxheSA9PT0gImZsZXgiKSB7DQogICAgY29uc3QgY29udGVudCA9IHBhbmVsLnF1ZXJ5U2VsZWN0b3IoImRpdiIpOw0KICAgIC8vIE7hur91IGNsaWNrIG5nb8OgaSB2w7luZyBu4buZaSBkdW5nIHBhbmVsDQogICAgaWYgKCFjb250ZW50LmNvbnRhaW5zKGUudGFyZ2V0KSkgew0KICAgICAgcGFuZWwuc3R5bGUuZGlzcGxheSA9ICJub25lIjsNCiAgICB9DQogIH0NCn0pOw0KDQo8L3NjcmlwdD4NCjxzY3JpcHQ+DQovLyA9PT09PT0gUEjDgk4gVFJBTkcgQuG6ok5HIExPRyBUUk9ORyBQT1BVUCA9PT09PT0NCmxldCBEQl9MT0dTID0gW107ICAgICAgIC8vIHRvw6BuIGLhu5kgbG9ncyDEkcOjIHThuqNpDQpsZXQgREJfUEFHRSA9IDE7ICAgICAgICAvLyB0cmFuZyBoaeG7h24gdOG6oWkNCmxldCBEQl9QQUdFX1NJWkUgPSAxMDsgIC8vIHPhu5EgZMOybmcgLyB0cmFuZw0KbGV0IERCX0NVUlJFTlRfVVNFUiA9ICcnOyAvLyB1c2VyIMSRYW5nIMSRxINuZyBuaOG6rXAgKGxvd2VyY2FzZSkgxJHhu4MgcmVuZGVyIG7DunQgWG/DoQ0KDQpmdW5jdGlvbiBzZXRQYWdlU2l6ZShzaXplKXsNCiAgREJfUEFHRV9TSVpFID0gTnVtYmVyKHNpemUpIHx8IDEwOw0KICBEQl9QQUdFID0gMTsNCiAgcmVuZGVyRHJvcGJveFBhZ2UoKTsNCn0NCg0KZnVuY3Rpb24gZ29Ub1BhZ2UocCl7DQogIGNvbnN0IG1heCA9IE1hdGgubWF4KDEsIE1hdGguY2VpbChEQl9MT0dTLmxlbmd0aCAvIERCX1BBR0VfU0laRSkpOw0KICBEQl9QQUdFID0gTWF0aC5taW4oTWF0aC5tYXgoMSwgcCksIG1heCk7DQogIHJlbmRlckRyb3Bib3hQYWdlKCk7DQp9DQoNCmZ1bmN0aW9uIHJlbmRlckRyb3Bib3hQYWdlKCl7DQogIGNvbnN0IHRib2R5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Ryb3Bib3hGaWxlTGlzdCcpOw0KICBjb25zdCBwYWdlQnRucyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkcm9wYm94UGFnZUJ1dHRvbnMnKTsNCiAgY29uc3QgcGFnZUluZm8gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZHJvcGJveFBhZ2VJbmZvJyk7DQoNCiAgaWYoIXRib2R5KSByZXR1cm47DQoNCiAgLy8gcuG7l25nPw0KICBpZighQXJyYXkuaXNBcnJheShEQl9MT0dTKSB8fCBEQl9MT0dTLmxlbmd0aCA9PT0gMCl7DQogICAgdGJvZHkuaW5uZXJIVE1MID0gYDx0cj48dGQgY29sc3Bhbj0iNiIgc3R5bGU9InRleHQtYWxpZ246Y2VudGVyO2NvbG9yOnJlZCI+S2jDtG5nIGPDsyBkYW5oIHPDoWNoIG7DoG8gxJHGsOG7o2MgbMawdTwvdGQ+PC90cj5gOw0KICAgIGlmKHBhZ2VCdG5zKSBwYWdlQnRucy5pbm5lckhUTUwgPSAnJzsNCiAgICBpZihwYWdlSW5mbykgcGFnZUluZm8udGV4dENvbnRlbnQgPSAnJzsNCiAgICByZXR1cm47DQogIH0NCg0KICBjb25zdCB0b3RhbCA9IERCX0xPR1MubGVuZ3RoOw0KICBjb25zdCBtYXhQYWdlID0gTWF0aC5tYXgoMSwgTWF0aC5jZWlsKHRvdGFsIC8gREJfUEFHRV9TSVpFKSk7DQogIGlmKERCX1BBR0UgPiBtYXhQYWdlKSBEQl9QQUdFID0gbWF4UGFnZTsNCg0KICBjb25zdCBzdGFydElkeCA9IChEQl9QQUdFIC0gMSkgKiBEQl9QQUdFX1NJWkU7DQogIGNvbnN0IGVuZElkeCAgID0gTWF0aC5taW4oc3RhcnRJZHggKyBEQl9QQUdFX1NJWkUsIHRvdGFsKTsNCiAgY29uc3Qgc2xpY2UgICAgPSBEQl9MT0dTLnNsaWNlKHN0YXJ0SWR4LCBlbmRJZHgpOw0KDQogIC8vIFJlbmRlciBib2R5IHRoZW8gdHJhbmcNCiAgdGJvZHkuaW5uZXJIVE1MID0gc2xpY2UubWFwKChpdGVtLCBpKSA9PiBgDQogICAgPHRyPg0KICAgICAgPHRkPiR7c3RhcnRJZHggKyBpICsgMX08L3RkPg0KICAgICAgPHRkPiR7aXRlbS5raG9hIHx8ICcnfTwvdGQ+DQogICAgICA8dGQ+JHsoaXRlbS5uZ2F5IHx8ICcnKQ0KICAgICAgICAgICAucmVwbGFjZSgnMDA6MDA6MDAnLCcnKQ0KICAgICAgICAgICAucmVwbGFjZSgnMjM6NTk6NTknLCcnKQ0KICAgICAgICAgICAucmVwbGFjZSgnVOG7qycsJycpDQogICAgICAgICAgIC5yZXBsYWNlKCfEkeG6v24nLCcgLT4gJykNCiAgICAgICAgICAgLnJlcGxhY2UoL1xzKy9nLCcgJykNCiAgICAgICAgICAgLnRyaW0oKX08L3RkPg0KCQkgICANCgkJICAgPHRkPiR7TnVtYmVyKGl0ZW0uaGVyYl9lcnJvcnMgfHwgMCl9PC90ZD4NCiAgICAgPHRkPiR7TnVtYmVyKGl0ZW0udGltZV9lcnJvcnMgfHwgMCl9PC90ZD4NCiAgICA8dGQ+JHtOdW1iZXIoaXRlbS5jb25mbGljdF9lcnJvcnMgfHwgMCl9PC90ZD4NCgkJICAgDQogICAgICA8dGQ+JHsoaXRlbS50aW1lIHx8ICcnKQ0KICAgICAgICAgICAucmVwbGFjZSgnLCcsICcnKQ0KICAgICAgICAgICAucmVwbGFjZSgnICcsICcgLSAnKQ0KICAgICAgICAgICAucmVwbGFjZSgvXHMrL2csICcgJykNCiAgICAgICAgICAgLnRyaW0oKX08L3RkPg0KICAgICAgPHRkPjxhIGhyZWY9ImphdmFzY3JpcHQ6dm9pZCgwKSIgb25jbGljaz0idmVyaWZ5QW5kT3BlbkxpbmsoJyR7aXRlbS5saW5rfScpIj5YZW08L2E+PC90ZD4NCiAgICAgIDx0ZD4NCiAgICAgICAgPGJ1dHRvbiBjbGFzcz0iYnRuIiBzdHlsZT0iYmFja2dyb3VuZDojZTc0YzNjOyBwYWRkaW5nOjEwcHggMTRweDsgZm9udC1zaXplOjEycHg7Ig0KICAgICAgICAgIG9uY2xpY2s9Im9uRGVsZXRlTG9nUm93KCR7c3RhcnRJZHggKyBpfSwgJyR7REJfQ1VSUkVOVF9VU0VSfScpIj4NCiAgICAgICAgICA8aSBjbGFzcz0iZmEgZmEtdHJhc2giPjwvaT4gWG/DoQ0KICAgICAgICA8L2J1dHRvbj4NCiAgICAgIDwvdGQ+DQogICAgPC90cj4NCiAgYCkuam9pbignJyk7DQoNCiAgLy8gUmVuZGVyIG7DunQgdHJhbmcgKFByZXYg4oCmIE5leHQpIOKAlCBoaeG7g24gdGjhu4sgZOG6o2kgdOG7kWkgxJFhIDcgbsO6dCBz4buRDQogIGlmKHBhZ2VCdG5zKXsNCiAgICBjb25zdCBidG4gPSAobGFiZWwsIHRhcmdldCwgZGlzYWJsZWQ9ZmFsc2UsIHRpdGxlPScnKSA9Pg0KICAgICAgYDxidXR0b24gY2xhc3M9ImJ0biIgJHtkaXNhYmxlZD8nZGlzYWJsZWQnOicnfSB0aXRsZT0iJHt0aXRsZX0iDQogICAgICAgICAgICAgICBzdHlsZT0icGFkZGluZzo2cHggMTBweCR7ZGlzYWJsZWQ/JztvcGFjaXR5Oi42O2N1cnNvcjpub3QtYWxsb3dlZCc6Jyd9Ig0KICAgICAgICAgICAgICAgb25jbGljaz0iZ29Ub1BhZ2UoJHt0YXJnZXR9KSI+JHtsYWJlbH08L2J1dHRvbj5gOw0KDQogICAgY29uc3QgcmFuZ2UgPSAzOyAvLyBoYWkgYsOqbiB0cmFuZyBoaeG7h24gdOG6oWkNCiAgICBjb25zdCBmcm9tICA9IE1hdGgubWF4KDEsIERCX1BBR0UgLSByYW5nZSk7DQogICAgY29uc3QgdG8gICAgPSBNYXRoLm1pbihtYXhQYWdlLCBEQl9QQUdFICsgcmFuZ2UpOw0KDQogICAgbGV0IGh0bWwgPSAnJzsNCiAgICBodG1sICs9IGJ0bignwqsgxJDhuqd1JywgMSwgREJfUEFHRT09PTEsICdUcmFuZyDEkeG6p3UnKTsNCiAgICBodG1sICs9IGJ0bign4oC5IFRyxrDhu5tjJywgREJfUEFHRS0xLCBEQl9QQUdFPT09MSwgJ1RyYW5nIHRyxrDhu5tjJyk7DQogICAgZm9yKGxldCBwID0gZnJvbTsgcCA8PSB0bzsgcCsrKXsNCiAgICAgIGh0bWwgKz0gYDxidXR0b24gY2xhc3M9ImJ0biIgb25jbGljaz0iZ29Ub1BhZ2UoJHtwfSkiDQogICAgICAgICAgICAgICAgIHN0eWxlPSJwYWRkaW5nOjZweCAxMHB4OyR7cD09PURCX1BBR0U/J2JhY2tncm91bmQ6IzJlY2M3MSc6Jyd9Ij4NCiAgICAgICAgICAgICAgICAgJHtwfQ0KICAgICAgICAgICAgICAgPC9idXR0b24+YDsNCiAgICB9DQogICAgaHRtbCArPSBidG4oJ1NhdSDigLonLCBEQl9QQUdFKzEsIERCX1BBR0U9PT1tYXhQYWdlLCAnVHJhbmcgc2F1Jyk7DQogICAgaHRtbCArPSBidG4oJ0N14buRaSDCuycsIG1heFBhZ2UsIERCX1BBR0U9PT1tYXhQYWdlLCAnVHJhbmcgY3Xhu5FpJyk7DQoNCiAgICBwYWdlQnRucy5pbm5lckhUTUwgPSBodG1sOw0KICB9DQoNCiAgaWYocGFnZUluZm8pew0KICAgIHBhZ2VJbmZvLnRleHRDb250ZW50ID0gYFRyYW5nICR7REJfUEFHRX0vJHttYXhQYWdlfSDigKIgJHtzdGFydElkeCsxfS0ke2VuZElkeH0vJHt0b3RhbH1gOw0KICB9DQp9DQoNCi8vIEfhuq9uIHPhu7Ega2nhu4duIMSR4buVaSBwYWdlIHNpemUgKGNo4buJIGPhuqduIGfhu41pIDEgbOG6p24gc2F1IGtoaSBwb3B1cCBt4bufKQ0KZnVuY3Rpb24gYXR0YWNoUGFnZXJFdmVudHNPbmNlKCl7DQogIGNvbnN0IHNlbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkcm9wYm94UGFnZVNpemUnKTsNCiAgaWYoc2VsICYmICFzZWwuZGF0YXNldC5ib3VuZCl7DQogICAgc2VsLmRhdGFzZXQuYm91bmQgPSAnMSc7DQogICAgc2VsLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIGUgPT4gc2V0UGFnZVNpemUoZS50YXJnZXQudmFsdWUpKTsNCiAgfQ0KfQ0KPC9zY3JpcHQ+DQoNCg0KPCEtLSBQT1BVUCBUw5NNIFThuq5UIEzhu5ZJIC0tPg0KPGRpdiBpZD0ic3VtbWFyeU1vZGFsIiBzdHlsZT0iZGlzcGxheTpub25lO3Bvc2l0aW9uOmZpeGVkO2luc2V0OjA7ei1pbmRleDoxMTA1MCI+DQogIDxkaXYgaWQ9InN1bW1hcnlCYWNrZHJvcCIgc3R5bGU9InBvc2l0aW9uOmFic29sdXRlO2luc2V0OjA7YmFja2dyb3VuZDpyZ2JhKDAsMCwwLDAuNSkiPjwvZGl2Pg0KICA8ZGl2IHJvbGU9ImRpYWxvZyIgYXJpYS1tb2RhbD0idHJ1ZSINCiAgICAgICBzdHlsZT0icG9zaXRpb246YWJzb2x1dGU7dG9wOjYlO2xlZnQ6NTAlO3RyYW5zZm9ybTp0cmFuc2xhdGVYKC01MCUpOw0KICAgICAgICAgICAgICB3aWR0aDptaW4oOTAwcHgsOTJ2dyk7bWF4LWhlaWdodDo4NnZoO292ZXJmbG93OmF1dG87DQogICAgICAgICAgICAgIGJhY2tncm91bmQ6I2ZmZjtjb2xvcjojMDAwO2JvcmRlci1yYWRpdXM6MTBweDtib3JkZXI6MnB4IHNvbGlkICMzNDk4ZGI7DQogICAgICAgICAgICAgIGJveC1zaGFkb3c6MCA4cHggMjRweCByZ2JhKDAsMCwwLC4yNSk7Zm9udC1mYW1pbHk6SW50ZXIsc2Fucy1zZXJpZiI+DQogICAgPGRpdiBzdHlsZT0iZGlzcGxheTpmbGV4O2FsaWduLWl0ZW1zOmNlbnRlcjtqdXN0aWZ5LWNvbnRlbnQ6c3BhY2UtYmV0d2VlbjtwYWRkaW5nOjE0cHggMTZweDtib3JkZXItYm90dG9tOjFweCBzb2xpZCAjZTVlN2ViIj4NCiAgICAgIDxoMyBzdHlsZT0ibWFyZ2luOjA7Zm9udC1zaXplOjE4cHgiPlTDs20gVOG6r3QgTOG7l2k8L2gzPg0KICAgICAgPGJ1dHRvbiBjbGFzcz0iYnRuIiB0eXBlPSJidXR0b24iIGlkPSJzdW1tYXJ5Q2xvc2VCdG4iPsSQw7NuZzwvYnV0dG9uPg0KICAgIDwvZGl2Pg0KICAgIDxkaXYgaWQ9InN1bW1hcnlDb250ZW50IiBzdHlsZT0icGFkZGluZzoxNnB4IDE4cHg7Zm9udC1zaXplOjE0cHg7bGluZS1oZWlnaHQ6MS41Ij48L2Rpdj4NCiAgPC9kaXY+DQo8L2Rpdj4NCjxzY3JpcHQ+DQovLyA9PT09PSBUw5NNIFThuq5UIEzhu5ZJIChT4bqvYyB0aHXhu5FjIC8gU2FpIHRo4budaSBnaWFuIC8gVHLDuW5nIGdp4budKSA9PT09PQ0KKGZ1bmN0aW9uKCl7DQogIC8vIENodeG6qW4gaG/DoSB0w6puIGhp4buDbiB0aOG7iw0KICBmdW5jdGlvbiBjbGVhbihzKXsgcmV0dXJuIChzfHwnJykudG9TdHJpbmcoKS5yZXBsYWNlKC8sL2csJycpLnJlcGxhY2UoL1xzKy9nLCcgJykudHJpbSgpOyB9DQoNCiAgLy8gR29tIG5ow7NtOiB7IFtkb2N0b3JdOiB7IHRvdGFsOiBudW1iZXIsIGJ5T3BlcmF0b3I6IE1hcDxvcCwgY291bnQ+IH0gfQ0KICBmdW5jdGlvbiBtYWtlQnVja2V0KCl7IHJldHVybiB7IHRvdGFsOjAsIGJ5T3BlcmF0b3I6bmV3IE1hcCgpIH07IH0NCiBmdW5jdGlvbiBidW1wKGJ1Y2tldE1hcCwgZG9jdG9yLCBvcGVyYXRvcil7DQogIGNvbnN0IGQgPSAoZG9jdG9yfHwnJykudG9TdHJpbmcoKS5yZXBsYWNlKC8sL2csJycpLnRyaW0oKSB8fCAnS2jDtG5nIGPDsyc7DQogIGNvbnN0IG8gPSAob3BlcmF0b3J8fCcnKS50b1N0cmluZygpLnJlcGxhY2UoLywvZywnJykudHJpbSgpIHx8ICdLaMO0bmcgY8OzJzsNCiAgaWYoIWJ1Y2tldE1hcC5oYXMoZCkpIGJ1Y2tldE1hcC5zZXQoZCwgeyB0b3RhbDowLCBieU9wZXJhdG9yOm5ldyBNYXAoKSB9KTsNCiAgY29uc3QgYiA9IGJ1Y2tldE1hcC5nZXQoZCk7DQogIGIudG90YWwrKzsNCiAgYi5ieU9wZXJhdG9yLnNldChvLCAoYi5ieU9wZXJhdG9yLmdldChvKXx8MCkrMSk7DQp9DQoNCiAgLy8gMSkgxJDhur9tIFPhuq5DIFRIVeG7kEMgVEhBTkcNCmZ1bmN0aW9uIGNvdW50SGVyYigpew0KICBjb25zdCBoZXJicyA9IEFycmF5LmlzQXJyYXkod2luZG93LmFsbEhlcmJQcm9jZWR1cmVzKSA/IHdpbmRvdy5hbGxIZXJiUHJvY2VkdXJlcyA6IFtdOw0KICBjb25zdCBub3JtID0gcyA9PiAoc3x8JycpLnRvU3RyaW5nKCkucmVwbGFjZSgvWyzvvIxdK1xzKiQvLCcnKS5yZXBsYWNlKC9ccysvZywnICcpLnRyaW0oKS50b0xvd2VyQ2FzZSgpOw0KDQogIC8vIDEpIMSQ4bq/bSB04bqnbiBzdeG6pXQgbmfGsOG7nWkgdGjhu7FjIGhp4buHbiB0aGVvIHThu6tuZyBuZ8OgeQ0KICBjb25zdCBieURhdGUgPSBPYmplY3QuY3JlYXRlKG51bGwpOw0KICBoZXJicy5mb3JFYWNoKGg9PnsNCiAgICBjb25zdCBkID0gaC5kYXRlOw0KICAgIGNvbnN0IG9wID0gbm9ybShoLm9wZXJhdG9yKTsNCiAgICBpZighb3AgfHwgb3AgPT09ICdraMO0bmcgY8OzJykgcmV0dXJuOyAgICAgICAgICAgIC8vIGLhu48gdHLhu5FuZy9raMO0bmcgY8OzDQogICAgKGJ5RGF0ZVtkXXx8KGJ5RGF0ZVtkXT1PYmplY3QuY3JlYXRlKG51bGwpKSlbb3BdID0gKGJ5RGF0ZVtkXVtvcF18fDApICsgMTsNCiAgfSk7DQoNCiAgLy8gMikgVMOtbmggIsSRYSBz4buRIiAodG9wIHBo4bqjaSBs4bubbiBoxqFuIHNlY29uZCkNCiAgY29uc3QgbWFqb3JpdHkgPSBPYmplY3QuY3JlYXRlKG51bGwpOw0KICBPYmplY3Qua2V5cyhieURhdGUpLmZvckVhY2goZD0+ew0KICAgIGNvbnN0IGFyciA9IE9iamVjdC5lbnRyaWVzKGJ5RGF0ZVtkXSkuc29ydCgoYSxiKT0+YlsxXS1hWzFdKTsNCiAgICBjb25zdCB0b3AgICAgPSBhcnJbMF0gfHwgW251bGwsMF07DQogICAgY29uc3Qgc2Vjb25kID0gYXJyWzFdIHx8IFtudWxsLDBdOw0KICAgIG1ham9yaXR5W2RdID0geyB0b3A6IHRvcFswXSwgdG9wQ291bnQ6IHRvcFsxXSwgc2Vjb25kQ291bnQ6IHNlY29uZFsxXSB9Ow0KICB9KTsNCg0KICAvLyAzKSBDaOG7iSBj4buZbmcgbmjhu69uZyBjYSBLSMOBQyDEkEEgU+G7kCwgZ29tIHRoZW8gQsOhYyBzxKkgY2jhu4kgxJHhu4tuaCAoY8OieSBjaMOtbmgpDQogIGNvbnN0IG1hcCA9IG5ldyBNYXAoKTsgLy8geyBkb2N0b3IgPT4ge3RvdGFsLCBieU9wZXJhdG9yfSB9ICAoYnlPcGVyYXRvciBz4bq9IGtow7RuZyBoaeG7g24gdGjhu4spDQogIGhlcmJzLmZvckVhY2goaD0+ew0KICAgIGNvbnN0IGQgPSBoLmRhdGU7DQogICAgY29uc3Qgb3AgPSBub3JtKGgub3BlcmF0b3IpOw0KICAgIGlmKCFvcCB8fCBvcCA9PT0gJ2tow7RuZyBjw7MnKSByZXR1cm47DQogICAgY29uc3QgbSA9IG1ham9yaXR5W2RdOw0KICAgIGlmKCFtKSByZXR1cm47DQogICAgaWYobS50b3AgJiYgbS50b3BDb3VudCA+IG0uc2Vjb25kQ291bnQgJiYgb3AgIT09IG0udG9wKXsNCiAgICAgIC8vIGNo4buJIHTDrW5oIHRoZW8gYsOhYyBzxKkgY2jhu4kgxJHhu4tuaCAoY8OieSBjaMOtbmgpDQogICAgICBidW1wKG1hcCwgaC5kb2N0b3IsICcnKTsgIC8vICdieU9wZXJhdG9yJyBz4bq9IGLhu4sg4bqpbiDhu58gcGjhuqduIHJlbmRlcg0KICAgIH0NCiAgfSk7DQoNCiAgcmV0dXJuIG1hcDsNCn0NCg0KICAvLyAyKSDEkOG6v20gU0FJIFRI4bucSSBHSUFOICht4buNaSBs4buXaSB0cm9uZyBlcnJvckxvZyBjb2kgbMOgIGzhu5dpIHRo4budaSBnaWFuKQ0KIGZ1bmN0aW9uIGNvdW50VGltZUVycm9ycygpew0KICBjb25zdCBtYXAgPSBuZXcgTWFwKCk7DQoNCiAgLy8gTOG6pXkgdOG7qyBt4bqjbmcgZXJyb3JMb2cgKGtp4buDdSBsZXQgdG/DoG4gY+G7pWMpDQogIGNvbnN0IGxpc3QgPQ0KICAgICh0eXBlb2YgZXJyb3JMb2cgIT09ICd1bmRlZmluZWQnICYmIEFycmF5LmlzQXJyYXkoZXJyb3JMb2cpKSA/IGVycm9yTG9nIDoNCiAgICAoQXJyYXkuaXNBcnJheSh3aW5kb3cuZXJyb3JMb2cpID8gd2luZG93LmVycm9yTG9nIDogW10pOw0KDQogIC8vIENo4buJIGzhuqV5IGzhu5dpIGzhu4djaCB0aOG7nWkgbMaw4bujbmcgKGPDsyBleHBlY3RlZC9hY3R1YWwpDQogIGxpc3QuZm9yRWFjaChlID0+IHsNCiAgICBjb25zdCBkID0gZSAmJiBlLmRldGFpbHM7DQogICAgaWYgKCFkKSByZXR1cm47DQogICAgaWYgKHR5cGVvZiBkLmV4cGVjdGVkID09PSAnbnVtYmVyJyAmJiB0eXBlb2YgZC5hY3R1YWwgPT09ICdudW1iZXInKSB7DQogICAgICBidW1wKG1hcCwgZC5kb2N0b3IsIGQub3BlcmF0b3IpOw0KICAgIH0NCiAgfSk7DQoNCiAgLy8gRmFsbGJhY2s6IMSR4buNYyB0cuG7sWMgdGnhur9wIHThu6sgYuG6o25nIGzhu5dpIHRo4budaSBnaWFuIG7hur91IHbDrCBsw70gZG8gbsOgbyDEkcOzIG3huqNuZyBy4buXbmcNCiAgaWYgKG1hcC5zaXplID09PSAwKSB7DQogICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnI2Vycm9yTG9nIHRyLmVycm9yLXJvdycpLmZvckVhY2godHIgPT4gew0KICAgICAgY29uc3QgdGRzID0gdHIucXVlcnlTZWxlY3RvckFsbCgndGQnKTsNCiAgICAgIC8vIELhuqNuZyBjw7MgY+G7mXQ6IFTDqm4gQk4gfCBUaOG7pyB0aHXhuq10IHwgQsOhYyBz4bu5IGNo4buJIMSR4buLbmggfCBOZ8aw4budaSB0aOG7sWMgaGnhu4duIHwgVGjhu51pIGdpYW4gfCBM4buXaQ0KICAgICAgY29uc3QgZG9jdG9yICAgPSB0ZHNbMl0/LnRleHRDb250ZW50Py50cmltKCk7DQogICAgICBjb25zdCBvcGVyYXRvciA9IHRkc1szXT8udGV4dENvbnRlbnQ/LnRyaW0oKTsNCiAgICAgIGlmIChkb2N0b3IgfHwgb3BlcmF0b3IpIGJ1bXAobWFwLCBkb2N0b3IsIG9wZXJhdG9yKTsNCiAgICB9KTsNCiAgfQ0KDQogIHJldHVybiBtYXA7DQp9DQoNCiAgLy8gMykgxJDhur9tIFRSw5lORyBHSeG7nCAodOG7qyBhbGxQcm9jZWR1cmVzLmNvbmZsaWN0PXRydWUpDQpmdW5jdGlvbiBjb3VudENvbmZsaWN0cygpew0KICBjb25zdCBsaXN0ID0NCiAgICAodHlwZW9mIGFsbFByb2NlZHVyZXMgIT09ICd1bmRlZmluZWQnICYmIEFycmF5LmlzQXJyYXkoYWxsUHJvY2VkdXJlcykpID8gYWxsUHJvY2VkdXJlcyA6DQogICAgKEFycmF5LmlzQXJyYXkod2luZG93LmFsbFByb2NlZHVyZXMpID8gd2luZG93LmFsbFByb2NlZHVyZXMgOiBbXSk7DQogIGNvbnN0IG1hcCA9IG5ldyBNYXAoKTsNCiAgbGlzdC5mb3JFYWNoKHAgPT4gew0KICAgIGlmIChwICYmIHAuY29uZmxpY3QpIGJ1bXAobWFwLCBwLmRvY3RvciwgcC5vcGVyYXRvcik7DQogIH0pOw0KICByZXR1cm4gbWFwOw0KfQ0KZnVuY3Rpb24gYnVpbGREb2N0b3JSYW5raW5nKGhlcmJNYXAsIHRpbWVNYXAsIGNvbmZNYXApew0KICBjb25zdCB0b3RhbE1hcCA9IG5ldyBNYXAoKTsNCg0KICAvLyBn4buZcCBz4buRIHThu6sgMyBtYXANCiAgY29uc3QgbWVyZ2UgPSAoc3JjKSA9PiB7DQogICAgc3JjLmZvckVhY2goKGluZm8sIGRvYyk9PnsNCiAgICAgIGlmKCF0b3RhbE1hcC5oYXMoZG9jKSkgdG90YWxNYXAuc2V0KGRvYyx7dG90YWw6MH0pOw0KICAgICAgdG90YWxNYXAuZ2V0KGRvYykudG90YWwgKz0gaW5mby50b3RhbDsNCiAgICB9KTsNCiAgfTsNCiAgbWVyZ2UoaGVyYk1hcCk7IG1lcmdlKHRpbWVNYXApOyBtZXJnZShjb25mTWFwKTsNCg0KICAvLyBzb3J0IGdp4bqjbSBk4bqnbg0KICBjb25zdCBhcnIgPSBBcnJheS5mcm9tKHRvdGFsTWFwLmVudHJpZXMoKSkuc29ydCgoYSxiKT0+YlsxXS50b3RhbCAtIGFbMV0udG90YWwpOw0KDQogIGxldCBodG1sID0gYDxkaXYgY2xhc3M9InNlY3Rpb24iPjxkaXYgY2xhc3M9ImlubmVyIj5gOw0KICBpZihhcnIubGVuZ3RoPT09MCl7DQogICAgaHRtbCArPSBgPGRpdiBjbGFzcz0ibm90ZS1lbXB0eSI+Q2jGsGEgY8OzIGThu68gbGnhu4d1PC9kaXY+YDsNCiAgfSBlbHNlIHsNCiAgICBodG1sICs9IGA8dGFibGUgY2xhc3M9InRhYmxlLWNsZWFuIj48dGhlYWQ+PHRyPg0KICAgICAgICAgICAgICA8dGg+SOG6oW5nPC90aD48dGg+QsOhYyBzxKk8L3RoPg0KICAgICAgICAgICAgICA8dGggY2xhc3M9InJpZ2h0Ij5U4buVbmcgbOG7l2k8L3RoPg0KICAgICAgICAgICAgPC90cj48L3RoZWFkPjx0Ym9keT5gOw0KICAgIGFyci5mb3JFYWNoKChbZG9jLGluZm9dLGkpPT57DQogICAgICBodG1sICs9IGA8dHI+DQogICAgICAgIDx0ZD4ke2krMX08L3RkPg0KICAgICAgICA8dGQ+PGI+JHtkb2N9PC9iPjwvdGQ+DQogICAgICAgIDx0ZCBjbGFzcz0icmlnaHQiPiR7aW5mby50b3RhbH08L3RkPg0KICAgICAgPC90cj5gOw0KICAgIH0pOw0KICAgIGh0bWwgKz0gYDwvdGJvZHk+PC90YWJsZT5gOw0KICB9DQogIGh0bWwgKz0gYDwvZGl2PjwvZGl2PmA7DQogIHJldHVybiBodG1sOw0KfQ0KICAvLyBSZW5kZXIgMSBzZWN0aW9uDQpmdW5jdGlvbiByZW5kZXJTZWN0aW9uKHRpdGxlLCBtYXAsIHNob3dPcGVyYXRvcnMgPSB0cnVlKXsNCiAgaWYoIW1hcCB8fCBtYXAuc2l6ZT09PTApew0KICAgIHJldHVybiBgPGg0IHN0eWxlPSJtYXJnaW46MTBweCAwIDZweCI+JHt0aXRsZX08L2g0PjxkaXY+PGk+Q2jGsGEgY8OzIGThu68gbGnhu4d1PC9pPjwvZGl2PmA7DQogIH0NCiAgY29uc3QgZG9jdG9ycyA9IEFycmF5LmZyb20obWFwLmVudHJpZXMoKSkuc29ydCgoYSxiKT0+YlsxXS50b3RhbCAtIGFbMV0udG90YWwpOw0KDQogIGxldCBodG1sID0gYDxoNCBzdHlsZT0ibWFyZ2luOjEwcHggMCA2cHgiPiR7dGl0bGV9PC9oND48ZGl2IHN0eWxlPSJib3JkZXI6MXB4IHNvbGlkICNlZWU7Ym9yZGVyLXJhZGl1czo4cHg7cGFkZGluZzoxMnB4Ij5gOw0KICBkb2N0b3JzLmZvckVhY2goKFtkb2N0b3IsIGluZm9dKT0+ew0KICAgIGh0bWwgKz0gYDxkaXYgc3R5bGU9Im1hcmdpbi1ib3R0b206MTBweCI+DQogICAgICA8ZGl2PkLDoWMgc8SpIDxiPiR7ZG9jdG9yfTo8L2I+ICR7aW5mby50b3RhbH08L2Rpdj5gOw0KICAgIGlmIChzaG93T3BlcmF0b3JzKXsNCiAgICAgIGNvbnN0IG9wcyA9IEFycmF5LmZyb20oaW5mby5ieU9wZXJhdG9yLmVudHJpZXMoKSkuc29ydCgoYSxiKT0+YlsxXS1hWzFdKTsNCiAgICAgIGlmKG9wcy5sZW5ndGgpew0KICAgICAgICBodG1sICs9IGA8ZGl2IHN0eWxlPSJtYXJnaW4tbGVmdDoxMnB4O21hcmdpbi10b3A6NHB4Ij5gICsNCiAgICAgICAgICAgICAgICBvcHMubWFwKChbb3AsY10pID0+IGAtICR7b3B9OiAke2N9YCkuam9pbignPGJyPicpICsNCiAgICAgICAgICAgICAgICBgPC9kaXY+YDsNCiAgICAgIH0NCiAgICB9DQogICAgaHRtbCArPSBgPC9kaXY+YDsNCiAgfSk7DQogIGh0bWwgKz0gYDwvZGl2PmA7DQogIHJldHVybiBodG1sOw0KfQ0KDQogIGZ1bmN0aW9uIGJ1aWxkU3VtbWFyeUhUTUwoKXsNCiAgICBjb25zdCBoZXJiTWFwID0gY291bnRIZXJiKCk7DQogICAgY29uc3QgdGltZU1hcCA9IGNvdW50VGltZUVycm9ycygpOw0KICAgIGNvbnN0IGNvbmZNYXAgPSBjb3VudENvbmZsaWN0cygpOw0KDQogICAgLy8gVOG7lW5nIG5oYW5oIChkw7JuZyDEkeG6p3UpDQogICAgY29uc3QgaGVyYlRvdGFsID0gQXJyYXkuZnJvbShoZXJiTWFwLnZhbHVlcygpKS5yZWR1Y2UoKHMsYik9PnMrYi50b3RhbCwwKTsNCiAgICBjb25zdCB0aW1lVG90YWwgPSBBcnJheS5mcm9tKHRpbWVNYXAudmFsdWVzKCkpLnJlZHVjZSgocyxiKT0+cytiLnRvdGFsLDApOw0KICAgIGNvbnN0IGNvbmZUb3RhbCA9IEFycmF5LmZyb20oY29uZk1hcC52YWx1ZXMoKSkucmVkdWNlKChzLGIpPT5zK2IudG90YWwsMCk7DQoNCiAgICBsZXQgdG9wID0gYCA8ZGl2IGNsYXNzPSJzdW1tYXJ5LXdyYXAiPg0KICAgICAgPGRpdiBjbGFzcz0ia3BpLWdyaWQiPg0KICAgICAgICA8ZGl2IGNsYXNzPSJrcGktY2FyZCBrcGktYmx1ZSI+DQogICAgICAgICAgPGRpdiBjbGFzcz0ia3BpLXRpdGxlIj48aSBjbGFzcz0iZmEtc29saWQgZmEtbW9ydGFyLXBlc3RsZSI+PC9pPiBT4bqvYyB0aHXhu5FjIHRoYW5nPC9kaXY+DQogICAgICAgICAgPGRpdiBjbGFzcz0ia3BpLXZhbHVlIj4ke2hlcmJUb3RhbH08L2Rpdj4NCiAgICAgICAgPC9kaXY+DQogICAgICAgIDxkaXYgY2xhc3M9ImtwaS1jYXJkIGtwaS1hbWJlciI+DQogICAgICAgICAgPGRpdiBjbGFzcz0ia3BpLXRpdGxlIj48aSBjbGFzcz0iZmEtcmVndWxhciBmYS1jbG9jayI+PC9pPiBTYWkgdGjhu51pIGdpYW48L2Rpdj4NCiAgICAgICAgICA8ZGl2IGNsYXNzPSJrcGktdmFsdWUiPiR7dGltZVRvdGFsfTwvZGl2Pg0KICAgICAgICA8L2Rpdj4NCiAgICAgICAgPGRpdiBjbGFzcz0ia3BpLWNhcmQga3BpLXJlZCI+DQogICAgICAgICAgPGRpdiBjbGFzcz0ia3BpLXRpdGxlIj48aSBjbGFzcz0iZmEtc29saWQgZmEtdHJpYW5nbGUtZXhjbGFtYXRpb24iPjwvaT4gVHLDuW5nIGdp4budPC9kaXY+DQogICAgICAgICAgPGRpdiBjbGFzcz0ia3BpLXZhbHVlIj4ke2NvbmZUb3RhbH08L2Rpdj4NCiAgICAgICAgPC9kaXY+DQogICAgICA8L2Rpdj5gOw0KDQogICAgcmV0dXJuIHRvcA0KICAgICAgKyByZW5kZXJTZWN0aW9uKCdT4bqvYyB0aHXhu5FjIHRoYW5nJywgaGVyYk1hcCwgLypzaG93T3BlcmF0b3JzKi8gZmFsc2UpIA0KICAgICAgKyAnPGJyLz4nDQogICAgICArIHJlbmRlclNlY3Rpb24oJ1NhaSB0aOG7nWkgZ2lhbicsIHRpbWVNYXApDQogICAgICArICc8YnIvPicNCiAgICAgICsgcmVuZGVyU2VjdGlvbignVHLDuW5nIGdp4budJywgY29uZk1hcCk7DQogIH0NCg0KICAvLyBN4bufL8SRw7NuZyBtb2RhbA0KICB3aW5kb3cub3BlbkVycm9yU3VtbWFyeSA9IGZ1bmN0aW9uKCl7DQogICAgY29uc3QgbW9kYWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc3VtbWFyeU1vZGFsJyk7DQogICAgY29uc3QgY29udGVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzdW1tYXJ5Q29udGVudCcpOw0KICAgIGlmKCFtb2RhbCB8fCAhY29udGVudCkgcmV0dXJuOw0KLy8gbOG6pXkgMyBtYXAgxJHhu4MgdHJ1eeG7gW4gY2hvIGLhuqNuZyB44bq/cCBo4bqhbmcNCmNvbnN0IGhlcmJNYXAgPSBjb3VudEhlcmIoKTsNCmNvbnN0IHRpbWVNYXAgPSBjb3VudFRpbWVFcnJvcnMoKTsNCmNvbnN0IGNvbmZNYXAgPSBjb3VudENvbmZsaWN0cygpOw0KDQovLyBu4buZaSBkdW5nIHBvcHVwID0gcGjhuqduIHTDs20gdOG6r3QgY8WpICsgYuG6o25nIHjhur9wIGjhuqFuZyBiw6FjIHPEqQ0KY29udGVudC5pbm5lckhUTUwgPSBidWlsZFN1bW1hcnlIVE1MKCkNCiAgKyBidWlsZERvY3RvclJhbmtpbmcoaGVyYk1hcCwgdGltZU1hcCwgY29uZk1hcCk7DQogICAgbW9kYWwuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7DQogIH07DQogIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzdW1tYXJ5Q2xvc2VCdG4nKT8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKT0+IHsNCiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc3VtbWFyeU1vZGFsJykuc3R5bGUuZGlzcGxheT0nbm9uZSc7DQogIH0pOw0KICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc3VtbWFyeUJhY2tkcm9wJyk/LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCk9PiB7DQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3N1bW1hcnlNb2RhbCcpLnN0eWxlLmRpc3BsYXk9J25vbmUnOw0KICB9KTsNCg0KICAvLyBTYXUga2hpIOKAnEtp4buDbSBUcmHigJ0geG9uZywgaGnhu4duIG7DunQgVMOzbSBU4bqvdCBM4buXaSAodGhlbyBjw7luZyBjxqEgY2jhur8gbmjGsCAyIG7DunQga2lhKQ0KICAvLyAoxJDDoyBjw7MgbG9naWMgaGnhu4duIG7DunQgdHJvbmcgc2V0VGltZW91dCBzYXUgYW5hbHl6ZSDigJQgdGEgY2jhu4kgxJHhuqNtIGLhuqNvIG7DunQgbsOgeSBjxaluZyBoaeG7h24pDQogIGNvbnN0IG9yaWcgPSBzZXRUaW1lb3V0Ow0KICAvLyBLaMO0bmcgY+G6p24gaG9vaywgdsOsIGNvZGUgY8OzIMSRb+G6oW46DQogIC8vIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ2J1dHRvbi5idG4nKS5mb3JFYWNoKGJ0biA9PiB7DQogIC8vICAgaWYgKGJ0bi50ZXh0Q29udGVudC5pbmNsdWRlcygnR2nhu50gdHLhu5FuZycpIHx8IGJ0bi50ZXh0Q29udGVudC5pbmNsdWRlcygnU+G6r2MgdGh14buRYyB0aGFuZycpKSB7IGJ0bi5zdHlsZS5kaXNwbGF5PSdpbmxpbmUtYmxvY2snO30NCiAgLy8gfSk7DQogIC8vIC0+IFRhIHRow6ptIGTDsm5nIGTGsOG7m2kgxJHhu4MgbsO6dCBt4bubaSBjxaluZyDEkcaw4bujYyBi4bqtdDoNCiAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsICgpID0+IHsNCiAgICAvLyBLaGkgcG9wdXAgbG9hZGluZyB04bqvdCBzYXUgYW5hbHl6ZSwgdGEgYuG6rXQgdGjhu6cgY8O0bmcgbuG6v3UgxJHDoyBjw7MgZOG7ryBsaeG7h3U6DQogICAgLy8gKGFuIHRvw6BuIG7hur91IGfhu41pIG5oaeG7gXUgbOG6p24pDQogICAgY29uc3Qgc2hvd0lmRGF0YSA9ICgpID0+IHsNCiAgICAgIGlmIChBcnJheS5pc0FycmF5KHdpbmRvdy5hbGxQcm9jZWR1cmVzKSAmJiB3aW5kb3cuYWxsUHJvY2VkdXJlcy5sZW5ndGgpew0KICAgICAgICBjb25zdCBiID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Vycm9yU3VtbWFyeUJ0bicpOw0KICAgICAgICBpZiAoYikgYi5zdHlsZS5kaXNwbGF5ID0gJ2lubGluZS1ibG9jayc7DQogICAgICB9DQogICAgfTsNCiAgICAvLyBjaOG6oXkgbmdheSB2w6Agc2F1IG3hu5dpIGzhuqduIGzhu41jL3JlbmRlcg0KICAgIHNob3dJZkRhdGEoKTsNCiAgICAvLyBn4bqvbiB2w6BvIGPDoWMgxJFp4buDbSDEkcOjIGPDszoNCiAgICBjb25zdCByYiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN1bHRCb2R5Jyk7DQogICAgY29uc3QgZWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZXJyb3JMb2cnKTsNCiAgICBjb25zdCBvYnMgPSBuZXcgTXV0YXRpb25PYnNlcnZlcihzaG93SWZEYXRhKTsNCiAgICBpZiAocmIpIG9icy5vYnNlcnZlKHJiLCB7Y2hpbGRMaXN0OnRydWUsc3VidHJlZTp0cnVlfSk7DQogICAgaWYgKGVsKSBvYnMub2JzZXJ2ZShlbCwge2NoaWxkTGlzdDp0cnVlLHN1YnRyZWU6dHJ1ZX0pOw0KICB9KTsNCn0pKCk7DQo8L3NjcmlwdD4NCg0KPHNjcmlwdD4NCmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCAoKSA9PiB7DQogIGNvbnN0IGJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdlcnJvclN1bW1hcnlCdG4nKTsNCiAgY29uc3QgaGVyYkJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdoZXJiVG9nZ2xlQnRuJyk7DQogIGNvbnN0IGF2YWlsQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignYnV0dG9uLmJ0bltvbmNsaWNrPSJ0b2dnbGVBdmFpbGFiaWxpdHkoKSJdJyk7DQoNCiAgZnVuY3Rpb24gc3luY1Nob3coKXsNCiAgICBpZiAoIWJ0bikgcmV0dXJuOw0KICAgIGNvbnN0IGhlcmJTaG93biAgPSBoZXJiQnRuICYmIGdldENvbXB1dGVkU3R5bGUoaGVyYkJ0bikuZGlzcGxheSAhPT0gJ25vbmUnOw0KICAgIGNvbnN0IGF2YWlsU2hvd24gPSBhdmFpbEJ0biAmJiBnZXRDb21wdXRlZFN0eWxlKGF2YWlsQnRuKS5kaXNwbGF5ICE9PSAnbm9uZSc7DQogICAgaWYgKGhlcmJTaG93biB8fCBhdmFpbFNob3duKSBidG4uc3R5bGUuZGlzcGxheSA9ICdpbmxpbmUtYmxvY2snOw0KICB9DQoNCiAgLy8gY2jhuqF5IG5nYXkgdsOgIGtoaSBjw7MgdGhheSDEkeG7lWkgaGnhu4NuIHRo4buLDQogIHN5bmNTaG93KCk7DQogIG5ldyBNdXRhdGlvbk9ic2VydmVyKHN5bmNTaG93KS5vYnNlcnZlKGRvY3VtZW50LmJvZHksIHsNCiAgICBhdHRyaWJ1dGVzOiB0cnVlLCBzdWJ0cmVlOiB0cnVlLCBhdHRyaWJ1dGVGaWx0ZXI6IFsnc3R5bGUnLCdjbGFzcyddDQogIH0pOw0KfSk7DQoNCg0KPC9zY3JpcHQ+DQo8IS0tIE1vZGFsIEZyYW1lOiBU4bqhbyBnaeG7nSB0aOG7pyB0aHXhuq10IC0tPg0KPGRpdiBpZD0icHJvY2VkdXJlRnJhbWVNb2RhbCIgc3R5bGU9ImRpc3BsYXk6bm9uZTtwb3NpdGlvbjpmaXhlZDtpbnNldDowO3otaW5kZXg6MTEwNzA7Ij4NCiAgPGRpdiBzdHlsZT0icG9zaXRpb246YWJzb2x1dGU7aW5zZXQ6MDtiYWNrZ3JvdW5kOnJnYmEoMCwwLDAsMC41KSIgb25jbGljaz0iY2xvc2VQcm9jZWR1cmVTY2hlZHVsZXIoKSI+PC9kaXY+DQogIDxkaXYgc3R5bGU9Ig0KICAgICAgcG9zaXRpb246YWJzb2x1dGU7dG9wOjQlO2xlZnQ6NTAlO3RyYW5zZm9ybTp0cmFuc2xhdGVYKC01MCUpOw0KICAgICAgd2lkdGg6bWluKDEyMDBweCw5NnZ3KTtoZWlnaHQ6OTB2aDsNCiAgICAgIGJhY2tncm91bmQ6I2ZmZjtjb2xvcjojMDAwO2JvcmRlci1yYWRpdXM6MTBweDtib3JkZXI6MnB4IHNvbGlkICMzNDk4ZGI7DQogICAgICBib3gtc2hhZG93OjAgOHB4IDI0cHggcmdiYSgwLDAsMCwuMjUpO2Rpc3BsYXk6ZmxleDtmbGV4LWRpcmVjdGlvbjpjb2x1bW4iPg0KICAgIDxkaXYgc3R5bGU9ImRpc3BsYXk6ZmxleDthbGlnbi1pdGVtczpjZW50ZXI7anVzdGlmeS1jb250ZW50OnNwYWNlLWJldHdlZW47cGFkZGluZzoxMHB4IDEycHg7Ym9yZGVyLWJvdHRvbToxcHggc29saWQgI2U1ZTdlYiI+DQogICAgICA8c3Ryb25nPlThuqFvIGdp4budIHRo4bunIHRodeG6rXQ8L3N0cm9uZz4NCiAgICAgIDxkaXYgc3R5bGU9ImRpc3BsYXk6ZmxleDtnYXA6NnB4Ij4NCiAgICAgICAgPGJ1dHRvbiBjbGFzcz0iYnRuIiBvbmNsaWNrPSJyZWxvYWRQcm9jZWR1cmVTY2hlZHVsZXIoKSJzdHlsZT0icGFkZGluZzo4cHggMTRweDtmb250LXNpemU6MTNweDtib3JkZXItcmFkaXVzOjRweDsiPkzDoG0gbeG7m2k8L2J1dHRvbj4NCiAgICAgICAgPGJ1dHRvbiBjbGFzcz0iYnRuIiBvbmNsaWNrPSJjbG9zZVByb2NlZHVyZVNjaGVkdWxlcigpInN0eWxlPSJwYWRkaW5nOjhweCAxNHB4O2ZvbnQtc2l6ZToxM3B4O2JvcmRlci1yYWRpdXM6NHB4OyI+xJDDs25nPC9idXR0b24+DQogICAgICA8L2Rpdj4NCiAgICA8L2Rpdj4NCiAgICA8aWZyYW1lIGlkPSJwcm9jZWR1cmVGcmFtZSIgc3JjPSJhYm91dDpibGFuayIgc3R5bGU9ImZsZXg6MTt3aWR0aDoxMDAlO2JvcmRlcjowIiBhbGxvd2Z1bGxzY3JlZW4+PC9pZnJhbWU+DQogIDwvZGl2Pg0KPC9kaXY+PHNjcmlwdD4NCiAgZnVuY3Rpb24gb3BlblByb2NlZHVyZVNjaGVkdWxlcigpIHsNCiAgICBjb25zdCBtb2RhbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwcm9jZWR1cmVGcmFtZU1vZGFsJyk7DQogICAgY29uc3QgZnJhbWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncHJvY2VkdXJlRnJhbWUnKTsNCiAgICBmcmFtZS5zcmMgPSAnaHR0cHM6Ly9jaGF1aHV5bmgwMTA0LmdpdGh1Yi5pby9neW0vbHR0Lmh0bWwnOw0KICAgIG1vZGFsLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOw0KICB9DQogIGZ1bmN0aW9uIHJlbG9hZFByb2NlZHVyZVNjaGVkdWxlcigpIHsNCiAgICBjb25zdCBmcmFtZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwcm9jZWR1cmVGcmFtZScpOw0KICAgIGlmIChmcmFtZSAmJiBmcmFtZS5jb250ZW50V2luZG93KSB7DQogICAgICB0cnkgeyBmcmFtZS5jb250ZW50V2luZG93LmxvY2F0aW9uLnJlbG9hZCgpOyB9DQogICAgICBjYXRjaCAoXykgeyBmcmFtZS5zcmMgPSBmcmFtZS5zcmM7IH0NCiAgICB9DQogIH0NCiAgZnVuY3Rpb24gY2xvc2VQcm9jZWR1cmVTY2hlZHVsZXIoKSB7DQogICAgY29uc3QgbW9kYWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncHJvY2VkdXJlRnJhbWVNb2RhbCcpOw0KICAgIGNvbnN0IGZyYW1lID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Byb2NlZHVyZUZyYW1lJyk7DQogICAgZnJhbWUuc3JjID0gJ2Fib3V0OmJsYW5rJzsNCiAgICBtb2RhbC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOw0KICB9DQo8L3NjcmlwdD4NCg0KPCEtLSBQT1BVUCBUVeG7siBCSeG6vk4gVEjhu6YgVEhV4bqsVCAtLT4NCjxkaXYgaWQ9ImN1c3RvbWl6ZU1vZGFsIiBzdHlsZT0iZGlzcGxheTpub25lO3Bvc2l0aW9uOmZpeGVkO2luc2V0OjA7ei1pbmRleDoxMTA2MDsiPg0KICA8ZGl2IHN0eWxlPSJwb3NpdGlvbjphYnNvbHV0ZTtpbnNldDowO2JhY2tncm91bmQ6cmdiYSgwLDAsMCwwLjUpIiBvbmNsaWNrPSJjbG9zZUN1c3RvbWl6ZVBhbmVsKCkiPjwvZGl2Pg0KICA8ZGl2IHN0eWxlPSINCiAgICAgIHBvc2l0aW9uOmFic29sdXRlO3RvcDo4JTtsZWZ0OjUwJTt0cmFuc2Zvcm06dHJhbnNsYXRlWCgtNTAlKTsNCiAgICAgIHdpZHRoOm1pbig4MjBweCw5MnZ3KTttYXgtaGVpZ2h0Ojg0dmg7b3ZlcmZsb3c6YXV0bzsNCiAgICAgIGJhY2tncm91bmQ6I2ZmZjtjb2xvcjojMDAwO2JvcmRlci1yYWRpdXM6MTBweDtib3JkZXI6MnB4IHNvbGlkICMzNDk4ZGI7DQogICAgICBib3gtc2hhZG93OjAgOHB4IDI0cHggcmdiYSgwLDAsMCwuMjUpO2ZvbnQtZmFtaWx5OkludGVyLHNhbnMtc2VyaWYiPg0KICA8ZGl2IHN0eWxlPSJkaXNwbGF5OmZsZXg7YWxpZ24taXRlbXM6Y2VudGVyO2p1c3RpZnktY29udGVudDpzcGFjZS1iZXR3ZWVuOw0KICAgICAgICAgICAgcGFkZGluZzoxNHB4IDE2cHg7Ym9yZGVyLWJvdHRvbToxcHggc29saWQgI2U1ZTdlYiI+DQogIDxoMyBzdHlsZT0ibWFyZ2luOjA7Zm9udC1zaXplOjE4cHgiPkLhuqNuZyBUdeG7syBiaeG6v24gVGjhu6cgdGh14bqtdDwvaDM+DQogIDxkaXYgc3R5bGU9ImRpc3BsYXk6ZmxleDthbGlnbi1pdGVtczpjZW50ZXI7anVzdGlmeS1jb250ZW50OmZsZXgtZW5kO2dhcDo2cHg7Ij4NCiAgPGJ1dHRvbiBjbGFzcz0iYnRuIiBvbmNsaWNrPSJzaG93Tm9QZXJtaXNzaW9uKCkiDQogICAgICAgICAgc3R5bGU9InBhZGRpbmc6OHB4IDE0cHg7Zm9udC1zaXplOjEzcHg7Ym9yZGVyLXJhZGl1czo0cHg7Ij4NCiAgICBUaMOqbQ0KICA8L2J1dHRvbj4NCiAgPGJ1dHRvbiBjbGFzcz0iYnRuIiBvbmNsaWNrPSJjbG9zZUN1c3RvbWl6ZVBhbmVsKCkiDQogICAgICAgICAgc3R5bGU9InBhZGRpbmc6OHB4IDE0cHg7Zm9udC1zaXplOjEzcHg7Ym9yZGVyLXJhZGl1czo0cHg7Ij4NCiAgICDEkMOzbmcNCiAgPC9idXR0b24+DQo8L2Rpdj4NCjwvZGl2Pg0KICAgIDxkaXYgc3R5bGU9InBhZGRpbmc6MHB4IDE2cHgiPg0KICAgIA0KICAgICAgPHRhYmxlIGNsYXNzPSJlcnJvci10YWJsZSIgc3R5bGU9IndpZHRoOjEwMCUiPg0KICAgICAgICA8dGhlYWQ+DQogICAgICAgICAgPHRyPg0KICAgICAgICAgICAgPHRoIHN0eWxlPSJ3aWR0aDo2MHB4Ij5TVFQ8L3RoPg0KICAgICAgICAgICAgPHRoPlRo4bunIFRodeG6rXQ8L3RoPg0KICAgICAgICAgICAgPHRoIHN0eWxlPSJ3aWR0aDoxMzBweCI+VGjhu51pIGdpYW48L3RoPg0KICAgICAgICAgICAgPHRoIHN0eWxlPSJ3aWR0aDoxMTBweCI+Q2h14bqpbiBi4buLPC90aD4NCiAgICAgICAgICA8L3RyPg0KICAgICAgICA8L3RoZWFkPg0KICAgICAgICA8dGJvZHkgaWQ9ImN1c3RvbWl6ZUJvZHkiPjwvdGJvZHk+DQogICAgICA8L3RhYmxlPg0KICANCiAgPC9kaXY+DQo8L2Rpdj4NCjxzY3JpcHQ+DQogIGNvbnN0IFRIVVRIVUFUX1VSTCA9ICdodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vY2hhdWh1eW5oMDEwNC9jaGF1aHV5bmgwMTA0LnR4dC9yZWZzL2hlYWRzL21haW4vY2hhdV90aHV0aHVhdC50eHQnOw0KDQogIGFzeW5jIGZ1bmN0aW9uIG9wZW5DdXN0b21pemVQYW5lbCgpIHsNCiAgICB0cnkgew0KICAgICAgaWYgKCF3aW5kb3cuUFJPQ0VEVVJFUyB8fCBPYmplY3Qua2V5cyh3aW5kb3cuUFJPQ0VEVVJFUykubGVuZ3RoID09PSAwKSB7DQogICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IGZldGNoKFRIVVRIVUFUX1VSTCk7DQogICAgICAgIGNvbnN0IHRleHQgPSBhd2FpdCByZXMudGV4dCgpOw0KICAgICAgICB3aW5kb3cuUFJPQ0VEVVJFUyA9IEpTT04ucGFyc2UodGV4dCk7DQogICAgICB9DQogICAgfSBjYXRjaCAoZSkgew0KICAgICAgYWxlcnQoJ0tow7RuZyB0aOG7gyB04bqjaSBkYW5oIHPDoWNoIHRo4bunIHRodeG6rXQgdOG7qyBtw6F5IGNo4bunLicpOw0KICAgICAgcmV0dXJuOw0KICAgIH0NCg0KICAgIGNvbnN0IHJvd3MgPSBbXTsNCiAgICBPYmplY3QuZW50cmllcyhQUk9DRURVUkVTKS5mb3JFYWNoKChbbmFtZSwgY2ZnXSkgPT4gew0KICAgICAgaWYgKCFuYW1lIHx8ICFjZmcpIHJldHVybjsNCg0KICAgLy8gdHLGsOG7m2MgxJHDszoNCmxldCBkdXJhdGlvbiA9ICh0eXBlb2YgY2ZnLmR1cmF0aW9uID09PSAnbnVtYmVyJykgPyBjZmcuZHVyYXRpb24gOiAnJzsNCi8vIE7hur91IGPDsyBwcmVwIHRow6wgbOG6pXkgcHJlcCwgbuG6v3Uga2jDtG5nIGPDsyB0aMOsIGfDoW4gPSBkdXJhdGlvbg0KbGV0IHByZXAgPSAodHlwZW9mIGNmZy5wcmVwID09PSAnbnVtYmVyJykgPyBjZmcucHJlcCA6IGR1cmF0aW9uOw0KDQovLyDDqXAgcmnDqm5nIGNobyAiU+G6r2MgdGh14buRYyB0aGFuZyINCmlmIChuYW1lLnRyaW0oKS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCdz4bqvYyB0aHXhu5FjIHRoYW5nJykpIHsNCiAgZHVyYXRpb24gPSAxMjA7DQogIHByZXAgPSAxMjA7DQp9DQoNCg0KICAgICAgaWYgKGR1cmF0aW9uICE9PSAnJykgew0KICAgICAgICByb3dzLnB1c2goeyBuYW1lLCBkdXJhdGlvbiwgcHJlcCB9KTsNCiAgICAgIH0NCiAgICB9KTsNCg0KICAgIHJvd3Muc29ydCgoYSxiKSA9PiBhLm5hbWUubG9jYWxlQ29tcGFyZShiLm5hbWUsICd2aScpKTsNCg0KICAgIGNvbnN0IHRib2R5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2N1c3RvbWl6ZUJvZHknKTsNCiAgICB0Ym9keS5pbm5lckhUTUwgPSByb3dzLm1hcCgociwgaWR4KSA9PiBgDQogICAgICA8dHI+DQogICAgICAgIDx0ZCBzdHlsZT0idGV4dC1hbGlnbjpjZW50ZXIiPiR7aWR4ICsgMX08L3RkPg0KICAgICAgICA8dGQ+JHtyLm5hbWV9PC90ZD4NCiAgICAgICAgPHRkIHN0eWxlPSJ0ZXh0LWFsaWduOmNlbnRlciI+JHtyLmR1cmF0aW9ufTwvdGQ+DQogICAgICAgIDx0ZCBzdHlsZT0idGV4dC1hbGlnbjpjZW50ZXIiPiR7ci5wcmVwfTwvdGQ+DQogICAgICA8L3RyPg0KICAgIGApLmpvaW4oJycpOw0KDQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2N1c3RvbWl6ZU1vZGFsJykuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7DQogIH0NCg0KICBmdW5jdGlvbiBjbG9zZUN1c3RvbWl6ZVBhbmVsKCkgew0KICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjdXN0b21pemVNb2RhbCcpLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7DQogIH0NCjwvc2NyaXB0Pg0KPHNjcmlwdD4NCmZ1bmN0aW9uIHNob3dOb1Blcm1pc3Npb24oKSB7DQogIC8vIE92ZXJsYXkNCiAgY29uc3Qgb3ZlcmxheSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOw0KICBvdmVybGF5LnN0eWxlLmNzc1RleHQgPSBgDQogICAgcG9zaXRpb246Zml4ZWQ7aW5zZXQ6MDtiYWNrZ3JvdW5kOnJnYmEoMCwwLDAsMC41KTsNCiAgICBkaXNwbGF5OmZsZXg7anVzdGlmeS1jb250ZW50OmNlbnRlcjthbGlnbi1pdGVtczpjZW50ZXI7ei1pbmRleDoxMjAwMDsNCiAgYDsNCg0KICAvLyBCb3gNCiAgY29uc3QgYm94ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7DQogIGJveC5zdHlsZS5jc3NUZXh0ID0gYA0KICAgIGJhY2tncm91bmQ6I2ZmZjtwYWRkaW5nOjIwcHggMzBweDtib3JkZXItcmFkaXVzOjEwcHg7DQogICAgdGV4dC1hbGlnbjpjZW50ZXI7bWF4LXdpZHRoOjMyMHB4O2JveC1zaGFkb3c6MCA0cHggMTVweCByZ2JhKDAsMCwwLDAuMyk7DQogICAgZm9udC1mYW1pbHk6SW50ZXIsc2Fucy1zZXJpZjsNCiAgYDsNCiAgYm94LmlubmVySFRNTCA9IGANCiAgICA8ZGl2IHN0eWxlPSJmb250LXNpemU6MThweDtmb250LXdlaWdodDo2MDA7Y29sb3I6I2U3NGMzYzttYXJnaW4tYm90dG9tOjEwcHg7Ij4NCiAgICAgIPCfmqsgQuG6oW4ga2jDtG5nIGPDsyBxdXnhu4FuIHRow6ptIHRo4bunIHRodeG6rXQNCiAgICA8L2Rpdj4NCiAgICA8YnV0dG9uIGNsYXNzPSJidG4iIG9uY2xpY2s9ImRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQodGhpcy5jbG9zZXN0KCcubm9QZXJtT3ZlcmxheScpKSI+DQogICAgICDEkMOzbmcNCiAgICA8L2J1dHRvbj4NCiAgYDsNCiAgb3ZlcmxheS5jbGFzc0xpc3QuYWRkKCJub1Blcm1PdmVybGF5Iik7DQogIG92ZXJsYXkuYXBwZW5kQ2hpbGQoYm94KTsNCiAgb3ZlcmxheS5hZGRFdmVudExpc3RlbmVyKCJjbGljayIsIGUgPT4gew0KICAgIGlmIChlLnRhcmdldCA9PT0gb3ZlcmxheSkgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChvdmVybGF5KTsNCiAgfSk7DQogIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQob3ZlcmxheSk7DQp9DQoNCg0KDQo8L3NjcmlwdD4NCg0KDQoNCg0KDQoNCg0KDQoNCg0KPHNjcmlwdD4NCmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIiwgZnVuY3Rpb24oZSkgew0KICBpZiAoZS50YXJnZXQgJiYgZS50YXJnZXQuaWQgPT09ICJidXkiKSB7DQogICAgZS5wcmV2ZW50RGVmYXVsdCgpOw0KICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJidXlQb3B1cCIpLnN0eWxlLmRpc3BsYXkgPSAiZmxleCI7DQogIH0NCn0pOw0KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigiY2xpY2siLCBmdW5jdGlvbihlKSB7DQogIC8vIE3hu58gcG9wdXAgYuG6o25nIGdpw6EgbuG6v3UgY2xpY2sgdsOgbyBuw7p0IGlkPWJ1eQ0KICBpZiAoZS50YXJnZXQgJiYgZS50YXJnZXQuaWQgPT09ICJidXkiKSB7DQogICAgZS5wcmV2ZW50RGVmYXVsdCgpOw0KICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJidXlQb3B1cCIpLnN0eWxlLmRpc3BsYXkgPSAiZmxleCI7DQogICAgcmV0dXJuOw0KICB9DQoNCiAgLy8gxJDDs25nIHBvcHVwIGtoaSBjbGljayByYSBuZ2/DoGkgcGjhuqduIG7hu5lpIGR1bmcNCiAgY29uc3QgcG9wdXBzID0gWyJidXlQb3B1cCIsICJwYXltZW50UG9wdXAiLCAiY29uZmlybVBvcHVwIl07DQogIHBvcHVwcy5mb3JFYWNoKGlkID0+IHsNCiAgICBjb25zdCBwb3B1cCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKTsNCiAgICBpZiAocG9wdXAgJiYgcG9wdXAuc3R5bGUuZGlzcGxheSA9PT0gImZsZXgiICYmIGUudGFyZ2V0ID09PSBwb3B1cCkgew0KICAgICAgcG9wdXAuc3R5bGUuZGlzcGxheSA9ICJub25lIjsNCiAgICB9DQogIH0pOw0KfSk7DQoNCi8vIMSQaeG7gXUgaMaw4bubbmcgbmhhbmggYuG6sW5nIHBow61tIHPhu5ENCmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBmdW5jdGlvbihlKSB7DQoNCiAgICAvLyA9PT09IE1BUCBDw4FDIELhuqJORyA9PT09DQogICAgY29uc3Qgc2VjdGlvbk1hcCA9IHsNCiAgICAgICAgIkYxIjogImVycm9yU2VjdGlvbiIsDQogICAgICAgICJGMiI6ICJyZXN1bHRTZWN0aW9uIiwNCiAgICAgICAgIkYzIjogIm1hY2hpbmVFcnJvclNlY3Rpb24iLA0KICAgICAgICAiRjQiOiAibWFjaGluZUNvbmZsaWN0U2VjdGlvbiIsDQogICAgICAgICJGNSI6ICJtaXNzaW5nTWFjaGluZVNlY3Rpb24iDQogICAgfTsNCg0KICAgIC8vID09PT0gU3BhY2Ug4oaSIFJlbG9hZCB0cmFuZyA9PT09DQogICAgaWYgKGUuY29kZSA9PT0gIlNwYWNlIikgew0KICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7DQogICAgICAgIGxvY2F0aW9uLnJlbG9hZCgpOw0KICAgICAgICByZXR1cm47DQogICAgfQ0KDQogICAgLy8gPT09PSBDdHJsICsgMS8yLzMg4oaSIEzhu41jIHRoZW8gdMOqbiA9PT09DQogICAgY29uc3QgZmlsdGVyTWFwID0gew0KICAgICAgICAiMSI6ICJIdeG7s25oIE5n4buNYyBDaMOidSIsDQogICAgICAgICIyIjogIk5ndXnhu4VuIFRo4buLIFBoxrDGoW5nIiwNCiAgICAgICAgIjMiOiAiTmd1eeG7hW4gSG/DoGkgUGjGsMahbmciDQogICAgfTsNCg0KICAgIGlmIChlLmN0cmxLZXkgJiYgZmlsdGVyTWFwW2Uua2V5XSkgew0KICAgICAgICBjb25zdCBuYW1lID0gZmlsdGVyTWFwW2Uua2V5XTsNCiAgICAgICAgY29uc3Qgc2VsZWN0cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoInNlbGVjdCIpOw0KDQogICAgICAgIHNlbGVjdHMuZm9yRWFjaChzZWwgPT4gew0KICAgICAgICAgICAgZm9yIChsZXQgb3B0aW9uIG9mIHNlbC5vcHRpb25zKSB7DQogICAgICAgICAgICAgICAgaWYgKG9wdGlvbi50ZXh0LnRyaW0oKSA9PT0gbmFtZSkgew0KICAgICAgICAgICAgICAgICAgICBzZWwudmFsdWUgPSBvcHRpb24udmFsdWU7DQogICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgfSk7DQoNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCg0KICAgIC8vID09PT0gQ3RybCArIE8g4oaSIE3hu58gZmlsZSA9PT09DQogICAgaWYgKGUuY3RybEtleSAmJiAhZS5zaGlmdEtleSAmJiBlLmtleS50b0xvd2VyQ2FzZSgpID09PSAibyIpIHsNCiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOw0KICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgidHJpZ2dlckJ1dHRvbiIpPy5jbGljaygpOw0KICAgICAgICByZXR1cm47DQogICAgfQ0KDQogICAgLy8gPT09PSBDdHJsICsgU2hpZnQgKyBPIOKGkiBN4bufIHRoxrAgbeG7pWMgPT09PQ0KICAgIGlmIChlLmN0cmxLZXkgJiYgZS5zaGlmdEtleSAmJiBlLmtleS50b0xvd2VyQ2FzZSgpID09PSAibyIpIHsNCiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOw0KICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiZm9sZGVyQnRuIik/LmNsaWNrKCk7DQogICAgICAgIHJldHVybjsNCiAgICB9DQoNCiAgICAvLyA9PT09IE7hur91IGtow7RuZyBwaOG6o2kgRjHigJNGNSB0aMOsIGLhu48gcXVhID09PT0NCiAgICBpZiAoIVsiRjEiLCJGMiIsIkYzIiwiRjQiLCJGNSJdLmluY2x1ZGVzKGUua2V5KSkgcmV0dXJuOw0KDQogICAgY29uc3QgdGFyZ2V0SWQgPSBzZWN0aW9uTWFwW2Uua2V5XTsNCiAgICBjb25zdCB0YXJnZXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0YXJnZXRJZCk7DQogICAgaWYgKCF0YXJnZXQpIHJldHVybjsNCg0KICAgIC8vIOKchSBO4bq/dSBDYXBzTG9jayBi4bqtdCDihpIg4bqobiBo4bq/dCAmIGNo4buJIGhp4buHbiAxIGLhuqNuZw0KICAgIGlmIChlLmdldE1vZGlmaWVyU3RhdGUoIkNhcHNMb2NrIikpIHsNCiAgICAgICAgT2JqZWN0LnZhbHVlcyhzZWN0aW9uTWFwKS5mb3JFYWNoKHNlYyA9PiB7DQogICAgICAgICAgICBjb25zdCBlbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHNlYyk7DQogICAgICAgICAgICBpZiAoZWwpIGVsLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7DQogICAgICAgIH0pOw0KICAgICAgICB0YXJnZXQuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7DQogICAgfQ0KDQogICAgLy8g4pyFIEx1w7RuIHNjcm9sbCB04bubaSBi4bqjbmcNCiAgICB0YXJnZXQuc2Nyb2xsSW50b1ZpZXcoeyBiZWhhdmlvcjogJ3Ntb290aCcsIGJsb2NrOiAnc3RhcnQnIH0pOw0KDQp9KTsNCg0KDQoNCg0KPC9zY3JpcHQ+DQo8L2h0bWw+";
  const binary = atob(base64);
  const bytes = new Uint8Array([...binary].map(c => c.charCodeAt(0)));
  const decoded = new TextDecoder("utf-8").decode(bytes);
  document.write(decoded);
</script>
</body>
</html>
