<!-- 

///////////////////////////////////////////////
/////Code được viết bởi Chauhuynh0104/////////
////http://fb.com/chauhuynh0104//////////////
/////////////079.567.9350///////////////////
///Vui lòng tôn trọng bản quyền tác giả////
/////////Không xoá dòng này //////////////
/////////////////////////////////////////

!-->
<!DOCTYPE html>
<html lang="vi">
<head><meta charset="UTF-8"><title>Thủ Thuật</title></head>
<body>
<script>
  const base64 = "PCEtLSANCi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8NCi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLw0KLy8vLy8vLy8vLy8vLy9Db2RlIMSRxrDhu6NjIHZp4bq/dCBi4bufaSBDaGF1aHV5bmgwMTA0Ly8vLy8vLy8vLy8vLy8vLw0KLy8vLy8vLy8vLy8vL2h0dHA6Ly9mYi5jb20vY2hhdWh1eW5oMDEwNC8vLy8vLy8vLy8vLy8vLy8vLy8vLw0KLy8vLy8vLy8vLy8vLy8vLy8vLy8vLzA3OS41NjcuOTM1MC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vDQovLy8vLy8vLy8vLy9WdWkgbMOybmcgdMO0biB0cuG7jW5nIGLhuqNuIHF1eeG7gW4gdMOhYyBnaeG6oy8vLy8vLy8vLy8vDQovLy8vLy8vLy8vLy8vLy8vLy9LaMO0bmcgeG/DoSBkw7JuZyBuw6B5IC8vLy8vLy8vLy8vLy8vLy8vLy8vLw0KLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vDQovLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLw0KIS0tPg0KPCFET0NUWVBFIGh0bWw+DQoNCjxodG1sIGxhbmc9InZpIj4NCjxoZWFkPg0KPGxpbmsgaHJlZj0iaHR0cHM6Ly9mb250cy5nb29nbGVhcGlzLmNvbS9jc3MyP2ZhbWlseT1JbnRlcjp3Z2h0QDQwMDs2MDA7NzAwJmFtcDtkaXNwbGF5PXN3YXAiIHJlbD0ic3R5bGVzaGVldCIvPg0KPGxpbmsgaHJlZj0iaHR0cHM6Ly9jZG5qcy5jbG91ZGZsYXJlLmNvbS9hamF4L2xpYnMvZm9udC1hd2Vzb21lLzYuNC4wL2Nzcy9hbGwubWluLmNzcyIgcmVsPSJzdHlsZXNoZWV0Ii8+DQo8bWV0YSBjaGFyc2V0PSJ1dGYtOCIvPg0KPG1ldGEgY29udGVudD0id2lkdGg9ZGV2aWNlLXdpZHRoLCBpbml0aWFsLXNjYWxlPTEuMCIgbmFtZT0idmlld3BvcnQiLz4NCjx0aXRsZT5LaeG7g20gVHJhIFRo4bunIFRodeG6rXQgWSBU4bq/PC90aXRsZT4NCjxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iaHR0cHM6Ly9jaGF1aHV5bmgwMTA0LmdpdGh1Yi5pby9neW0vZ2lhb2RpZW4uY3NzIj4NCjxzY3JpcHQ+DQogICAgYXN5bmMgZnVuY3Rpb24gY2hlY2tBY2Nlc3MoKSB7DQogICAgICAgIGNvbnN0IGpzb25VcmwgPSAnaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL2NoYXVodXluaDAxMDQvY2hhdWh1eW5oMDEwNC50eHQvcmVmcy9oZWFkcy9tYWluL2RyY2hhdS5qc29uJzsNCiAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IGZldGNoKGpzb25VcmwpOw0KICAgICAgICAgICAgaWYgKCFyZXMub2spIHRocm93IG5ldyBFcnJvcignS2jDtG5nIHRo4buDIHThuqNpIGZpbGUgSlNPTicpOw0KICAgICAgICAgICAgY29uc3QgY29uZmlnID0gYXdhaXQgcmVzLmpzb24oKTsNCg0KICAgICAgICAgICAgaWYgKCFjb25maWcuQUNDRVNTX0FMTE9XRUQpIHsNCiAgICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5LmlubmVySFRNTCA9IGA8ZGl2IHN0eWxlPSJwYWRkaW5nOjUwcHg7dGV4dC1hbGlnbjpjZW50ZXI7Y29sb3I6cmVkO2ZvbnQtc2l6ZToyMHB4Ij4NCiAgICAgICAgICAgICAgICAgICAgPGgyPkLhuqJPIFRSw4wgSOG7hiBUSOG7kE5HPC9oMj4NCiAgICAgICAgICAgICAgICAgICAgPHA+JHtjb25maWcuTUVTU0FHRX08L3A+DQogICAgICAgICAgICAgICAgICAgICR7Y29uZmlnLlJFRElSRUNUX1VSTCA/IGA8cD5T4bq9IGNodXnhu4NuIGjGsOG7m25nIHNhdSA8c3BhbiBpZD0nY291bnRkb3duJz41PC9zcGFuPiBnacOieS4uLjwvcD5gIDogJyd9DQogICAgICAgICAgICAgICAgPC9kaXY+YDsNCiAgICAgICAgICAgICAgICBpZiAoY29uZmlnLlJFRElSRUNUX1VSTCkgew0KICAgICAgICAgICAgICAgICAgICBsZXQgc2Vjb25kcyA9IDU7DQogICAgICAgICAgICAgICAgICAgIGNvbnN0IHRpbWVyID0gc2V0SW50ZXJ2YWwoKCkgPT4gew0KICAgICAgICAgICAgICAgICAgICAgICAgc2Vjb25kcy0tOw0KICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NvdW50ZG93bicpLmlubmVyVGV4dCA9IHNlY29uZHM7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2Vjb25kcyA8PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xlYXJJbnRlcnZhbCh0aW1lcik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBjb25maWcuUkVESVJFQ1RfVVJMOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9LCAxMDAwKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgIH0gY2F0Y2ggKGVycikgew0KICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5pbm5lckhUTUwgPSBgPGRpdiBzdHlsZT0ncGFkZGluZzo1MHB4O3RleHQtYWxpZ246Y2VudGVyO2NvbG9yOnJlZCc+DQogICAgICAgICAgICAgICAgPGgyPktIw5RORyBU4bqiSSDEkMav4buiQyBD4bqkVSBIw4xOSDwvaDI+PHA+TOG7l2kgdHJ1eSBj4bqtcCBraGkga+G6v3QgbuG7kWkgbeG6oW5nLjxici8+IFZ1aSBsw7JuZyBraeG7g20gdHJhIGzhuqFpIMSRxrDhu51uZyB0cnV54buBbiBpbnRlcm5ldC48L3A+DQogICAgICAgICAgICA8L2Rpdj5gOw0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgYXN5bmMgZnVuY3Rpb24gbG9hZEFjY291bnRzRnJvbVRYVCgpIHsNCiAgICAgICAgY29uc3QgdHh0VXJsID0gJ2h0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9jaGF1aHV5bmgwMTA0L2NoYXVodXluaDAxMDQudHh0L3JlZnMvaGVhZHMvbWFpbi90a2sudHh0JzsNCiAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgZmV0Y2godHh0VXJsKTsNCiAgICAgICAgY29uc3QgdGV4dCA9IGF3YWl0IHJlcy50ZXh0KCk7DQogICAgICAgIGNvbnN0IGFjY291bnRzID0ge307DQogICAgICAgIHRleHQuc3BsaXQoJ1xuJykuZm9yRWFjaChsaW5lID0+IHsNCiAgICAgICAgICAgIGNvbnN0IFt1LCBwXSA9IGxpbmUudHJpbSgpLnNwbGl0KCc6Jyk7DQogICAgICAgICAgICBpZiAodSAmJiBwKSBhY2NvdW50c1t1XSA9IHA7DQogICAgICAgIH0pOw0KICAgICAgICByZXR1cm4gYWNjb3VudHM7DQogICAgfQ0KDQogICAgYXN5bmMgZnVuY3Rpb24gZW5hYmxlTG9naW4oYWNjb3VudHMpIHsNCiAgICAgICAgY29uc3QgYnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvZ2luQnRuJyk7DQogICAgICAgIGNvbnN0IHVzZXJJbnB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd1c2VybmFtZUlucHV0Jyk7DQogICAgICAgIGNvbnN0IHBhc3NJbnB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwYXNzd29yZElucHV0Jyk7DQogICAgICAgIGNvbnN0IGVycm9yRGl2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvZ2luRXJyb3InKTsNCg0KICAgICAgICBidG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7DQogICAgICAgICAgICBjb25zdCB1c2VyID0gdXNlcklucHV0LnZhbHVlLnRyaW0oKTsNCiAgICAgICAgICAgIGNvbnN0IHBhc3MgPSBwYXNzSW5wdXQudmFsdWUudHJpbSgpOw0KICAgICAgICAgICAgaWYgKGFjY291bnRzW3VzZXJdICYmIGFjY291bnRzW3VzZXJdID09PSBwYXNzKSB7DQogICAgICAgICAgICAgICAgc2Vzc2lvblN0b3JhZ2Uuc2V0SXRlbSgnbWVkVXNlcicsIHVzZXIpOw0KICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LnJlbW92ZSgnbG9naW4tcGFnZScpOw0KICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2dpblNlY3Rpb24nKS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOw0KICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYWluQ29udGVudCcpLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOw0KICAgICAgICAgICAgICAgIGVycm9yRGl2LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIGVycm9yRGl2LnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9KTsNCiAgICB9DQpkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgZnVuY3Rpb24oKSB7DQpkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2hvd01vcmVTdWdnZXN0aW9uc0NoZWNrYm94JykuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgZnVuY3Rpb24oKSB7DQogICAgaWYgKGFsbFByb2NlZHVyZXMubGVuZ3RoID4gMCkgew0KICAgICAgICBnZW5lcmF0ZVRpbWVTdWdnZXN0aW9ucyhhbGxQcm9jZWR1cmVzKTsNCiAgICAgICAgZmlsdGVyQnlPcGVyYXRvcigpOw0KICAgIH0NCn0pOw0KfSk7DQoNCiB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGFzeW5jICgpID0+IHsNCiAgY29uc3QgYWxsb3cgPSBhd2FpdCBjaGVja0FjY2VzcygpOw0KICBpZiAoIWFsbG93KSByZXR1cm47DQogIC8vIENo4buJIGtp4buDbSB0cmEgxJHEg25nIG5o4bqtcCDEkcOjIGzGsHU7IEtIw5RORyB04bqjaSBydWxlL3Byb2NlZHVyZXMg4bufIMSRw6J5DQogIGNoZWNrU2F2ZWRMb2dpbigpOw0KfSk7DQoNCjwvc2NyaXB0Pg0KDQoNCg0KDQo8L2hlYWQ+DQo8Ym9keT4NCjwhLS0gVEhFTUUgUElDS0VSIC0tPg0KPGRpdiBpZD0idGhlbWVQaWNrZXIiIGNsYXNzPSJ0aGVtZS1waWNrZXIiIHRpdGxlPSJDaOG7jW4gbcOgdSBjaOG7pyDEkeG7gSBnaWFvIGRp4buHbiI+DQogDQogDQogIDxidXR0b24gdHlwZT0iYnV0dG9uIiBjbGFzcz0idGhlbWUtc3dhdGNoIiBkYXRhLXRoZW1lPSJkZWZhdWx0IiBzdHlsZT0iLS1zd2F0Y2g6IzM0OThkYiIgYXJpYS1sYWJlbD0iTeG6t2MgxJHhu4tuaCAoWGFuaCBkxrDGoW5nKSI+PC9idXR0b24+DQogIDxidXR0b24gdHlwZT0iYnV0dG9uIiBjbGFzcz0idGhlbWUtc3dhdGNoIiBkYXRhLXRoZW1lPSJvcmFuZ2UiICBzdHlsZT0iLS1zd2F0Y2g6I0ZGNjYwMCIgYXJpYS1sYWJlbD0iTcOgdSBjYW0iPjwvYnV0dG9uPg0KICA8YnV0dG9uIHR5cGU9ImJ1dHRvbiIgY2xhc3M9InRoZW1lLXN3YXRjaCIgZGF0YS10aGVtZT0icmVkIiAgICAgc3R5bGU9Ii0tc3dhdGNoOiNGRjAwMDAiIGFyaWEtbGFiZWw9Ik3DoHUgxJHhu48iPjwvYnV0dG9uPg0KICA8YnV0dG9uIHR5cGU9ImJ1dHRvbiIgY2xhc3M9InRoZW1lLXN3YXRjaCIgZGF0YS10aGVtZT0iZ3JlZW4iICAgc3R5bGU9Ii0tc3dhdGNoOiMwMEFBMDAiIGFyaWEtbGFiZWw9Ik3DoHUgeGFuaCBsw6EiPjwvYnV0dG9uPg0KICAgPGJ1dHRvbiB0eXBlPSJidXR0b24iIGlkPSJkYXJrVG9nZ2xlIiBjbGFzcz0idGhlbWUtZGFyay10b2dnbGUiIG9uY2xpY2s9InRvZ2dsZURhcmtNb2RlKCkiIGFyaWEtbGFiZWw9IkLhuq10L1Thuq90IGNo4bq/IMSR4buZIHThu5FpIj4NCiAgICA8c3BhbiBpZD0iZGFya0ljb24iPjxzbWFsbD7wn4yZPC9zbWFsbD48L3NwYW4+IDxzcGFuIGlkPSJkYXJrVGV4dCI+VOG7kWk8L3NwYW4+DQogIDwvYnV0dG9uPg0KICANCjwvZGl2Pg0KDQoNCg0KDQo8c2NyaXB0Pg0KICAgICAgZnVuY3Rpb24gdG9nZ2xlRGFya01vZGUoKSB7DQogICAgICAgIGNvbnN0IGJvZHkgPSBkb2N1bWVudC5ib2R5Ow0KICAgICAgICBjb25zdCBpY29uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImRhcmtJY29uIik7DQogICAgICAgIGNvbnN0IHRleHQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiZGFya1RleHQiKTsNCiAgICAgICAgYm9keS5jbGFzc0xpc3QudG9nZ2xlKCJkYXJrLW1vZGUiKTsNCiAgICAgICAgY29uc3QgaXNEYXJrID0gYm9keS5jbGFzc0xpc3QuY29udGFpbnMoImRhcmstbW9kZSIpOw0KICAgICAgICBpY29uLnRleHRDb250ZW50ID0gaXNEYXJrID8gIuKYgO+4jyIgOiAi8J+MmSI7DQogICAgICAgIHRleHQudGV4dENvbnRlbnQgPSBpc0RhcmsgPyAiU8OhbmciIDogIlThu5FpIjsNCiAgICAgIH0NCiAgICA8L3NjcmlwdD4NCjxzY3JpcHQ+DQpkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgKCkgPT4gew0KLy8gTOG6pXkgY8OhYyBwaOG6p24gdOG7rQ0KICAgICAgICAgICAgY29uc3QgdHJpZ2dlckJ1dHRvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0cmlnZ2VyQnV0dG9uJyk7DQogICAgICAgICAgICBjb25zdCBmaWxlSW5wdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZmlsZUlucHV0Jyk7DQoNCiAgICAgICAgICAgIC8vIEtp4buDbSB0cmEgeGVtIHBo4bqnbiB04butIGPDsyB04buTbiB04bqhaSBraMO0bmcNCiAgICAgICAgICAgIGlmICghdHJpZ2dlckJ1dHRvbiB8fCAhZmlsZUlucHV0KSB7DQogICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignTOG7l2k6IEtow7RuZyB0w6xtIHRo4bqleSB0cmlnZ2VyQnV0dG9uIGhv4bq3YyBmaWxlSW5wdXQnKTsNCiAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIC8vIFRow6ptIHPhu7Ega2nhu4duIGNsaWNrIGNobyBidXR0b24NCiAgICAgICAgICAgIHRyaWdnZXJCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7DQogICAgICAgICAgICAgICAgZmlsZUlucHV0LmNsaWNrKCk7IC8vIEvDrWNoIGhv4bqhdCBpbnB1dCBmaWxlDQogICAgICAgICAgICB9KTsNCg0KICAgICAgICB9KTsNCg0KPC9zY3JpcHQ+DQoNCjxkaXYgY2xhc3M9ImNvbnRhaW5lciI+DQo8ZGl2IGNsYXNzPSJsb2dpbi1zZWN0aW9uIiBpZD0ibG9naW5TZWN0aW9uIj4NCjxoMiBjbGFzcz0ibG9naW4tdGl0bGUiPsSQxIJORyBOSOG6rFAgSOG7hiBUSOG7kE5HPC9oMj4NCjxpbnB1dCBjbGFzcz0ibG9naW4taW5wdXQiIGlkPSJ1c2VybmFtZUlucHV0IiBwbGFjZWhvbGRlcj0iVMOqbiDEkcSDbmcgbmjhuq1wIiB0eXBlPSJ0ZXh0Ii8+DQo8aW5wdXQgY2xhc3M9ImxvZ2luLWlucHV0IiBpZD0icGFzc3dvcmRJbnB1dCIgcGxhY2Vob2xkZXI9Ik3huq10IGto4bqpdSIgdHlwZT0icGFzc3dvcmQiLz4NCjxici8+PGJ1dHRvbiBjbGFzcz0iYnRuIiBpZD0ibG9naW5CdG4iPsSQxINuZyBuaOG6rXA8L2J1dHRvbj4NCjxkaXYgY2xhc3M9ImxvZ2luLWVycm9yIiBpZD0ibG9naW5FcnJvciI+VMOqbiDEkcSDbmcgbmjhuq1wIGhv4bq3YyBt4bqtdCBraOG6qXUga2jDtG5nIMSRw7puZzwvZGl2Pg0KPC9kaXY+DQo8ZGl2IGNsYXNzPSJtYWluLWNvbnRlbnQiIGlkPSJtYWluQ29udGVudCI+DQo8ZGl2IGNsYXNzPSJ0b3AtYnV0dG9uLWdyb3VwIj4NCjxidXR0b24gb25jbGljaz0ic2hvd0Ryb3Bib3hQYW5lbCgpIiBjbGFzcz0iYnRuIj5QYW5lbDwvYnV0dG9uPg0KDQogIDxidXR0b24gb25jbGljaz0id2luZG93LmxvY2F0aW9uLnJlbG9hZCgpOyIgY2xhc3M9ImJ0biI+WG/DoSBDYWNoZTwvYnV0dG9uPg0KICA8YnV0dG9uIGNsYXNzPSJidG4iaWQ9ImxvZ291dEJ0biI+xJDEg25nIHh14bqldDwvYnV0dG9uPg0KPC9kaXY+DQoNCg0KPGgxPiA8YSBocmVmPSJodHRwczovL2ZiLmNvbS9jaGF1aHV5bmgwMTA0IiBzdHlsZT0iYWxsOiB1bnNldDsgY3Vyc29yOiBwb2ludGVyOyIgdGFyZ2V0PSJfYmxhbmsiPktp4buDbSBUcmEgVGjhu6cgVGh14bqtdCBZIFThur88L2E+PC9oMT4NCjxkaXYgY2xhc3M9Imxpc3QxIiBzdHlsZT0iZGlzcGxheTogZmxleDsgYWxpZ24taXRlbXM6IGNlbnRlcjsgZ2FwOiA4cHg7Ij4NCjxpIGNsYXNzPSJmYSBmYS1idWxsaG9ybiI+PC9pPg0KPGI+PGZvbnQgY29sb3I9InJlZCI+VGjDtG5nIGLDoW86PC9mb250PjwvYj4NCjxkaXYgY2xhc3M9InNjcm9sbGluZy10ZXh0IiBzdHlsZT0iZmxleDogMTsgb3ZlcmZsb3c6IGhpZGRlbjsiPg0KPGRpdiBjbGFzcz0ic2Nyb2xsaW5nLWNvbnRlbnQiIGlkPSJub2lkdW5nIj4NCg0KPC9kaXY+DQo8L2Rpdj4NCjwvZGl2Pg0KPHNjcmlwdD4NCg0KDQpmZXRjaCgnaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL2NoYXVodXluaDAxMDQvY2hhdWh1eW5oMDEwNC50eHQvcmVmcy9oZWFkcy9tYWluL3Rob25nYmFvLnR4dCcpDQogIC50aGVuKHJlc3BvbnNlID0+IHJlc3BvbnNlLnRleHQoKSkNCiAgLnRoZW4oZGF0YSA9PiB7DQogICAgY29uc3QgZWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbm9pZHVuZycpOw0KICAgIGVsLmlubmVySFRNTCA9IGRhdGE7DQoNCiAgICAvLyBUxINuZyDEkeG7mSBkw6BpIG7hu5lpIGR1bmcgxJHhu4MgxJHhuqNtIGLhuqNvIGN14buZbg0KICAgIGVsLnN0eWxlLmRpc3BsYXkgPSAnaW5saW5lLWJsb2NrJzsNCiAgICBlbC5zdHlsZS5taW5XaWR0aCA9ICcxMDAlJzsNCg0KICAgIC8vIFJlc2V0IGFuaW1hdGlvbiB0byBmb3JjZSByZWZsb3cNCiAgICBlbC5zdHlsZS5hbmltYXRpb24gPSAnbm9uZSc7DQogICAgdm9pZCBlbC5vZmZzZXRXaWR0aDsNCiAgICBlbC5zdHlsZS5hbmltYXRpb24gPSAnc2Nyb2xsLWxlZnQgMTBzIGxpbmVhciBpbmZpbml0ZSc7DQogIH0pDQogIC5jYXRjaChlcnJvciA9PiB7DQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25vaWR1bmcnKS50ZXh0Q29udGVudCA9ICdLaMO0bmcgdGjhu4MgdOG6o2kgbuG7mWkgZHVuZy4nOw0KICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpOw0KICB9KTsNCg0KDQo8L3NjcmlwdD4NCjxkaXYgY2xhc3M9InVwbG9hZC1zZWN0aW9uIj48ZGl2IGNsYXNzPSJtYWluYmxvayI+DQoNCjxpbnB1dCBhY2NlcHQ9Ii54bHN4LCAueGxzLCAuY3N2IiBpZD0iZmlsZUlucHV0IiBzdHlsZT0iZGlzcGxheTpub25lIiB0eXBlPSJmaWxlIi8+DQo8YnV0dG9uIGNsYXNzPSJidG4iIGlkPSJ0cmlnZ2VyQnV0dG9uIj48aSBjbGFzcz0iZmFzIGZhLWZpbGUtdXBsb2FkIj48L2k+IENo4buNbiBmaWxlIHRo4bunIGPDtG5nPC9idXR0b24+DQo8YnIvPjxici8+DQo8aW5wdXQgZGlyZWN0b3J5PSIiIGlkPSJmb2xkZXJJbnB1dCIgbXVsdGlwbGU9IiIgc3R5bGU9ImRpc3BsYXk6bm9uZSIgdHlwZT0iZmlsZSIgd2Via2l0ZGlyZWN0b3J5PSIiLz4NCjxidXR0b24gY2xhc3M9ImJ0biIgaWQ9ImZvbGRlckJ0biI+PGkgY2xhc3M9ImZhcyBmYS1mb2xkZXItb3BlbiI+PC9pPiBDaOG7jW4gdGjGsCBt4bulYyAoVOG7sSDEkeG7mW5nIHTDrG0gZmlsZSk8L2J1dHRvbj4NCjxkaXYgaWQ9InNjYW5TdGF0dXMiIHN0eWxlPSJtYXJnaW4tdG9wOjEwcHg7Y29sb3I6IzM0OThkYjtmb250LXdlaWdodDpib2xkIj48L2Rpdj4NCg0KDQo8bGFiZWw+DQo8aW5wdXQgbmFtZT0idGltZU9wdGlvbiIgdHlwZT0icmFkaW8iIHZhbHVlPSI3OjAwIi8+IA0KICAgICAgICAgICAgICAgICAgICAgICAgR+G7o2kgw70gdOG7qyAwNzowMA0KICAgICAgICAgICAgICAgICAgICA8L2xhYmVsPg0KPGxhYmVsPg0KPGlucHV0IGNoZWNrZWQ9IiIgbmFtZT0idGltZU9wdGlvbiIgdHlwZT0icmFkaW8iIHZhbHVlPSI3OjMwIi8+IA0KICAgICAgICAgICAgICAgICAgICAgICAgR+G7o2kgw70gdOG7qyAwNzozMA0KICAgICAgICAgICAgICAgICAgICA8L2xhYmVsPg0KPGJyLz48YnIvPg0KDQogIDxsYWJlbCBzdHlsZT0ibWFyZ2luLXJpZ2h0OiAxMHB4OyI+DQo8aW5wdXQgY2hlY2tlZD0iMSIgaWQ9Imlnbm9yZUFkamFjZW50Q2hlY2tib3giIHR5cGU9ImNoZWNrYm94Ii8+DQo8c3BhbiBjbGFzcz0iY2h1LXRoaWNoIj5C4buPIHF1YSB0aOG7pyB0aHXhuq10IGxp4buBbiBr4buBPHNwYW4gY2xhc3M9Im5vaS1kdW5nIj5WRDogOGgwMC04aDMwIHhvYSBiw7NwLiAwOGgzMC0wOGg1MCDEkWnhu4duIGNow6JtLiBsacOqbiB0aeG6v3AgbcOgIGtvIGPDoWNoIDEgcGjDunQgPC9zcGFuPjwvc3Bhbj4NCjwvbGFiZWw+DQoNCiAgPGxhYmVsIHN0eWxlPSJtYXJnaW4tcmlnaHQ6IDEwcHg7Ij4NCjxpbnB1dCBpZD0ic2hvd01vcmVTdWdnZXN0aW9uc0NoZWNrYm94IiB0eXBlPSJjaGVja2JveCIvPiANCiAgICAgICAgSGnhu4NuIHRo4buLIDYga2h1bmcgZ2nhu50gZ+G7o2kgw70gICAgICAgICANCiAgICA8L2xhYmVsPg0KDQo8bGFiZWw+DQo8aW5wdXQgaWQ9InNob3dEb2N0b3JDaGVja2JveCIgdHlwZT0iY2hlY2tib3giLz4gDQogICAgICAgIEhp4buDbiB0aOG7iyBCw6FjIHPEqSBjaOG7iSDEkeG7i25oDQogICAgPC9sYWJlbD4NCjxici8+PGJyLz4NCjxidXR0b24gY2xhc3M9ImJ0biIgaWQ9ImFuYWx5emVCdG4iPktp4buDbSBUcmE8L2J1dHRvbj4NCg0KDQoNCg0KDQoNCg0KDQoNCjxzY3JpcHQ+DQpkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZmlsZUlucHV0JykuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgZnVuY3Rpb24gKCkgew0KICAgIGNvbnN0IGZpbGUgPSB0aGlzLmZpbGVzWzBdOw0KICAgIGlmIChmaWxlKSB7DQogICAgICAgIGNvbnN0IHN0YXR1cyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzY2FuU3RhdHVzJyk7DQogICAgICAgIHN0YXR1cy5pbm5lckhUTUwgPSBgPGkgY2xhc3M9ImZhcyBmYS1maWxlIj48L2k+xJDDoyBjaOG7jW4gZmlsZTogPGI+JHtmaWxlLm5hbWV9PC9iPmA7DQogICAgICAgIHN0YXR1cy5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsNCiAgICAgICAgc3RhdHVzLnN0eWxlLmNvbG9yID0gJyMyYzNlNTAnOw0KICAgIH0NCn0pOw0KDQo8L3NjcmlwdD4NCjxkaXYgaWQ9InNjYW5TdGF0dXMiIHN0eWxlPSJtYXJnaW4tdG9wOjEwcHg7IGNvbG9yOiMyYzNlNTA7IGZvbnQtd2VpZ2h0OmJvbGQ7IGRpc3BsYXk6IG5vbmU7Ij48L2Rpdj4NCjxkaXYgaWQ9Im9wZXJhdG9yRmlsdGVyIiBzdHlsZT0ibWFyZ2luLXRvcDogMTVweDsgZGlzcGxheTogbm9uZTsiPg0KPGxhYmVsIGZvcj0ib3BlcmF0b3JTZWxlY3QiPkzhu41jIHRoZW8gbmfGsOG7nWkgdGjhu7FjIGhp4buHbjo8L2xhYmVsPg0KPHNlbGVjdCBjbGFzcz0ibG9naW4taW5wdXQiIGlkPSJvcGVyYXRvclNlbGVjdCI+DQo8b3B0aW9uIHZhbHVlPSJhbGwiPlThuqV0IGPhuqM8L29wdGlvbj4NCjwvc2VsZWN0Pg0KPC9kaXY+PGJyLz4NCjxzcGFuIHN0eWxlPSJmb250LXNpemU6IDEycHg7Ij48aT5QaOG6p24gbeG7gW0gxJHDtGkga2hpIGPDsyB0aOG7gyBt4bqvYyBs4buXaS4gWGluIGjDo3kga2nhu4NtIHRyYSBjw6FjIHRow7RuZyB0aW4gcXVhbiB0cuG7jW5nLjwvaT48L3NwYW4+DQo8ZGl2IGlkPSJmaWxlUmVxdWlyZW1lbnRzIj48L2Rpdj4NCjwvZGl2PjwvZGl2Pg0KDQoNCjwhLS0gQuG6rlQgxJDhuqZVOiBC4bqiTkcgR0nhu5wgVFLhu5BORyBU4buqTkcgTkfGr+G7nEkgLS0+DQogIDxidXR0b24gaWQ9ImhlcmJUb2dnbGVCdG4iIGNsYXNzPSJidG4iIG9uY2xpY2s9InRvZ2dsZUhlcmJMaXN0KCkic3R5bGU9ImRpc3BsYXk6bm9uZSI+U+G6r2MgdGh14buRYyB0aGFuZzwvYnV0dG9uPg0KICA8YnV0dG9uIGNsYXNzPSJidG4iIG9uY2xpY2s9InRvZ2dsZUF2YWlsYWJpbGl0eSgpIiBzdHlsZT0iZGlzcGxheTpub25lIj5HaeG7nSB0cuG7kW5nPC9idXR0b24+DQoNCjxkaXYgaWQ9ImF2YWlsYWJpbGl0eVRhYmxlIiBzdHlsZT0iZGlzcGxheTogbm9uZTsgbWFyZ2luLWJvdHRvbTogMjBweDsiPg0KIDxkaXYgY2xhc3M9Im1haW5ibG9rIiBzdHlsZT0ibWFyZ2luLWJvdHRvbTogMTBweDsgZGlzcGxheTpub25lOyIgaWQ9ImF2YWlsYWJpbGl0eUZpbHRlckJsb2NrIj4NCiAgPGxhYmVsIGZvcj0iZmlsdGVyT3BlcmF0b3IiPk5nxrDhu51pIHRo4buxYyBoaeG7h246PC9sYWJlbD4NCiAgPHNlbGVjdCBpZD0iZmlsdGVyT3BlcmF0b3IiIGNsYXNzPSJsb2dpbi1pbnB1dCIgc3R5bGU9IndpZHRoOmF1dG87bWFyZ2luLXJpZ2h0OjIwcHg7Ij48L3NlbGVjdD4NCg0KICA8bGFiZWwgZm9yPSJmaWx0ZXJEYXRlIj5OZ8OgeTo8L2xhYmVsPg0KICA8c2VsZWN0IGlkPSJmaWx0ZXJEYXRlIiBjbGFzcz0ibG9naW4taW5wdXQiIHN0eWxlPSJ3aWR0aDphdXRvOyI+PC9zZWxlY3Q+DQo8L2Rpdj4NCg0KICA8dGFibGUgY2xhc3M9ImVycm9yLXRhYmxlIGhlcmItdGFibGUiPg0KICAgIDx0aGVhZD4NCiAgICAgIDx0cj4NCiAgICAgICAgPHRoPk5nxrDhu51pIHRo4buxYyBoaeG7h248L3RoPg0KICAgICAgICA8dGg+TmfDoHk8L3RoPg0KICAgICAgICANCiAgICAgICAgPHRoPktodW5nIGdp4budIHRy4buRbmcgYnXhu5VpIHPDoW5nPC90aD4NCiAgICAgICAgPHRoPktodW5nIGdp4budIHRy4buRbmcgYnXhu5VpIGNoaeG7gXU8L3RoPg0KICAgICAgPC90cj4NCiAgICA8L3RoZWFkPg0KICAgIDx0Ym9keSBpZD0iYXZhaWxhYmlsaXR5Qm9keSI+PC90Ym9keT4NCiAgPC90YWJsZT4NCjwvZGl2Pg0KPCEtLSBL4bq+VCBUSMOaQzogQuG6ok5HIEdJ4bucIFRS4buQTkcgVOG7qk5HIE5Hxq/hu5xJIC0tPg0KDQoNCg0KDQo8IS0tIE7DmlQgSEnhu4JOIFRI4buKIFRI4bumIFRIVeG6rFQgU+G6rkMgVEhV4buQQyAtLT4NCg0KDQogIA0KPCEtLSBC4bqiTkcgVEjhu6YgVEhV4bqsVCBT4bquQyBUSFXhu5BDIFRIQU5HIC0tPg0KPGRpdiBpZD0iaGVyYlByb2NlZHVyZVRhYmxlIiBzdHlsZT0iZGlzcGxheTogbm9uZTsgbWFyZ2luLXRvcDogMjBweDsiPg0KICA8ZGl2IGNsYXNzPSJtYWluYmxvayJzdHlsZT0ibWFyZ2luLWJvdHRvbTogMTBweDsiPg0KICAgIDxkaXY+DQogICAgPHNlbGVjdCBpZD0iaGVyYkRvY3RvckZpbHRlciIgY2xhc3M9ImxvZ2luLWlucHV0IiBzdHlsZT0id2lkdGg6YXV0bzsgbWFyZ2luLWxlZnQ6IDIwcHg7Ij4NCiAgICAgIDxvcHRpb24gdmFsdWU9ImFsbCI+VOG6pXQgY+G6oyBiw6FjIHPEqTwvb3B0aW9uPg0KICAgIDwvc2VsZWN0Pg0KICAgIDxzZWxlY3QgaWQ9ImhlcmJEYXRlRmlsdGVyIiBjbGFzcz0ibG9naW4taW5wdXQiIHN0eWxlPSJ3aWR0aDphdXRvOyI+PC9zZWxlY3Q+DQogIDwvZGl2PjwvZGl2Pg0KDQo8IS0tIFTDk00gVOG6rlQgT1VUTElFUiAtLT4NCjxkaXYgaWQ9ImhlcmJPdXRsaWVyU3VtbWFyeSIgc3R5bGU9ImRpc3BsYXk6bm9uZTttYXJnaW46OHB4IDIwcHg7Zm9udC1zaXplOjE0cHgiPg0KICA8IS0tIG7hu5lpIGR1bmcgc+G6vSDEkcaw4bujYyBKUyBj4bqtcCBuaOG6rXQgLS0+DQo8L2Rpdj4NCiAgPHRhYmxlIGNsYXNzPSJlcnJvci10YWJsZSI+DQogICAgPHRoZWFkPg0KICAgICAgPHRyPg0KICAgICAgICA8dGg+SOG7jSB0w6puIGLhu4duaCBuaMOibjwvdGg+DQogICAgICAgIDx0aD5UaOG7pyB0aHXhuq10PC90aD4NCiAgICAgICAgPHRoPk5nw6B5PC90aD4NCiAgICAgICAgPHRoPlRo4budaSBnaWFuPC90aD4NCiAgICAgICAgPHRoPk5nxrDhu51pIHRo4buxYyBoaeG7h248L3RoPg0KICAgICAgPC90cj4NCiAgICA8L3RoZWFkPg0KICAgIDx0Ym9keSBpZD0iaGVyYlRhYmxlQm9keSI+PC90Ym9keT4NCiAgPC90YWJsZT4NCjwvZGl2Pg0KDQoNCjwhLS0gUE9QVVAgREFOSCBTw4FDSCBPVVRMSUVSIFPhuq5DIFRIVeG7kEMgVEhBTkcgLS0+DQo8ZGl2IGlkPSJoZXJiT3V0bGllck1vZGFsIiBzdHlsZT0iZGlzcGxheTpub25lO3Bvc2l0aW9uOmZpeGVkO2luc2V0OjA7ei1pbmRleDoxMTAwMCI+DQogIDxkaXYgaWQ9ImhlcmJPdXRsaWVyQmFja2Ryb3AiIHN0eWxlPSJwb3NpdGlvbjphYnNvbHV0ZTtpbnNldDowO2JhY2tncm91bmQ6cmdiYSgwLDAsMCwwLjUpIj48L2Rpdj4NCiAgPGRpdiByb2xlPSJkaWFsb2ciIGFyaWEtbW9kYWw9InRydWUiDQogICAgICAgc3R5bGU9InBvc2l0aW9uOmFic29sdXRlO3RvcDoxMCU7bGVmdDo1MCU7dHJhbnNmb3JtOnRyYW5zbGF0ZVgoLTUwJSk7DQogICAgICAgICAgICAgIG1heC13aWR0aDo3MDBweDttYXgtaGVpZ2h0Ojgwdmg7b3ZlcmZsb3c6YXV0bzsNCiAgICAgICAgICAgICAgYmFja2dyb3VuZDojZmZmO2NvbG9yOiMwMDA7cGFkZGluZzoyMHB4O2JvcmRlci1yYWRpdXM6OHB4Ow0KICAgICAgICAgICAgICBib3JkZXI6MnB4IHNvbGlkICNkMzJmMmY7Ym94LXNoYWRvdzowIDVweCAyMHB4IHJnYmEoMCwwLDAsMC4zKTtmb250LWZhbWlseTpJbnRlcixzYW5zLXNlcmlmIj4NCiAgICA8aDM+RGFuaCBzw6FjaCBjYSBraMOhYyDEkWEgc+G7kTwvaDM+DQogICAgPGRpdiBzdHlsZT0ibWFyZ2luOjEwcHggMDtmb250LXNpemU6MTNweCIgaWQ9ImhlcmJPdXRsaWVyTW9kYWxJbmZvIj48L2Rpdj4NCiAgICA8dGFibGUgY2xhc3M9ImVycm9yLXRhYmxlIiBzdHlsZT0ibWFyZ2luLXRvcDoxMHB4Ij4NCiAgICAgIDx0aGVhZD4NCiAgICAgICAgPHRyPg0KICAgICAgICAgIDx0aD5I4buNIHTDqm4gYuG7h25oIG5ow6JuPC90aD4NCiAgICAgICAgICA8dGg+VGjhu6cgdGh14bqtdDwvdGg+DQogICAgICAgICAgPHRoPk5nw6B5PC90aD4NCiAgICAgICAgICA8dGg+VGjhu51pIGdpYW48L3RoPg0KICAgICAgICAgIDx0aD5OZ8aw4budaSB0aOG7sWMgaGnhu4duPC90aD4NCiAgICAgICAgPC90cj4NCiAgICAgIDwvdGhlYWQ+DQogICAgICA8dGJvZHkgaWQ9ImhlcmJPdXRsaWVyTW9kYWxCb2R5Ij48L3Rib2R5Pg0KICAgIDwvdGFibGU+DQogICAgPGJyLz4NCiAgICA8YnV0dG9uIGNsYXNzPSJidG4iIHR5cGU9ImJ1dHRvbiIgaWQ9ImhlcmJPdXRsaWVyQ2xvc2VCdG4iPsSQw7NuZzwvYnV0dG9uPg0KICA8L2Rpdj4NCjwvZGl2Pg0KDQoNCg0KDQoNCg0KPGJyLz4NCjxici8+PGRpdiBpZD0iZXJyb3JTZWN0aW9uIiBzdHlsZT0iZGlzcGxheTogbm9uZTsiPg0KPGJyLz4NCjxoMyBpZD0iZXJyb3JTZWN0aW9uVGl0bGUiPkzhu5dpIE5o4bqtcCBTYWkgVGjhu51pIEdpYW48L2gyPg0KPGRpdiBpZD0ib3BlcmF0b3JGaWx0ZXJFcnJvciIgc3R5bGU9Im1hcmdpbi10b3A6IDE1cHg7IGRpc3BsYXk6IG5vbmU7Ij4NCjxsYWJlbCBmb3I9Im9wZXJhdG9yU2VsZWN0RXJyb3IiPkzhu41jIHRoZW8gbmfGsOG7nWkgdGjhu7FjIGhp4buHbjo8L2xhYmVsPg0KPHNlbGVjdCBjbGFzcz0ibG9naW4taW5wdXQiIGlkPSJvcGVyYXRvclNlbGVjdEVycm9yIj4NCjxvcHRpb24gdmFsdWU9ImFsbCI+VOG6pXQgY+G6ozwvb3B0aW9uPg0KPC9zZWxlY3Q+DQo8L2Rpdj4NCjxkaXYgaWQ9ImVycm9yTG9nIj48L2Rpdj4NCjwvZGl2Pg0KPGJyLz4NCjxkaXYgY2xhc3M9ImRhc2hib2FyZCIgaWQ9ImRhc2hib2FyZCIgc3R5bGU9ImRpc3BsYXk6bm9uZSI+DQo8ZGl2IGNsYXNzPSJjYXJkIiBpZD0iY2FyZFRvdGFsIj5U4buVbmc6IDA8L2Rpdj4NCjxkaXYgY2xhc3M9ImNhcmQiIGlkPSJjYXJkRXJyb3JzIj5M4buXaTogMDwvZGl2Pg0KPGRpdiBjbGFzcz0iY2FyZCIgaWQ9ImNhcmRDb25mbGljdHMiPlh1bmcgxJHhu5l0OiAwPC9kaXY+DQo8L2Rpdj4NCjxkaXYgaWQ9InJlc3VsdFNlY3Rpb24iIHN0eWxlPSJkaXNwbGF5OiBub25lOyI+DQo8aDIgaWQ9InJlc3VsdFNlY3Rpb25UaXRsZSI+S+G6v3QgUXXhuqMgS2nhu4NtIFRyYTwvaDI+IDxici8+DQo8ZGl2IGlkPSJzdW1tYXJ5Ij48L2Rpdj4NCjx0YWJsZSBpZD0icmVzdWx0VGFibGUiPg0KPHRoZWFkPg0KPHRyPg0KPHRoPjxpIGNsYXNzPSJmYXMgZmEtdXNlciBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gVMOqbiBCTjwvdGg+DQo8dGg+PGkgY2xhc3M9ImZhcyBmYS1wcm9jZWR1cmVzIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBUaOG7pyB0aHXhuq10PC90aD4NCjx0aD48aSBjbGFzcz0iZmFyIGZhLWNhbGVuZGFyLWFsdCBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gTmfDoHk8L3RoPg0KPHRoIGNsYXNzPSJkb2N0b3ItY29sdW1uIj48aSBjbGFzcz0iZmFzIGZhLXVzZXItbWQgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IELDoWMgc+G7uSBjaOG7iSDEkeG7i25oPC90aD4NCjx0aD48aSBjbGFzcz0iZmFzIGZhLXVzZXItbnVyc2UgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IE5nxrDhu51pIHRo4buxYyBoaeG7h248L3RoPg0KPHRoPjxpIGNsYXNzPSJmYXIgZmEtY2xvY2sgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IEfhu6NpIMO9IGdp4budPC90aD4NCjwvdHI+DQo8L3RoZWFkPg0KPHRib2R5IGlkPSJyZXN1bHRCb2R5Ij48L3Rib2R5Pg0KPC90YWJsZT4NCg0KDQo8L2Rpdj4NCjwvZGl2Pg0KPC9kaXY+DQo8c2NyaXB0Pg0KLy8gVOG6o2kgWExTWCBjaOG7iSBraGkgY+G6p24NCmFzeW5jIGZ1bmN0aW9uIGVuc3VyZVhMU1goKSB7DQogIGlmICghd2luZG93LlhMU1gpIHsNCiAgICBhd2FpdCBpbXBvcnQoJ2h0dHBzOi8vY2RuanMuY2xvdWRmbGFyZS5jb20vYWpheC9saWJzL3hsc3gvMC4xOC41L3hsc3guZnVsbC5taW4uanMnKTsNCiAgfQ0KfQ0KDQovLyBU4bqjaSBEcm9wYm94IFNESyBjaOG7iSBraGkgY+G6p24NCmFzeW5jIGZ1bmN0aW9uIGVuc3VyZURyb3Bib3goKSB7DQogIGlmICghd2luZG93LkRyb3Bib3gpIHsNCiAgICBhd2FpdCBpbXBvcnQoJ2h0dHBzOi8vdW5wa2cuY29tL2Ryb3Bib3gvZGlzdC9Ecm9wYm94LXNkay5taW4uanMnKTsNCiAgfQ0KfQ0KDQoNCiAgICAgICAgLy8gRGFuaCBzw6FjaCB0aOG7pyB0aHXhuq10DQogICAgICAgbGV0IFBST0NFRFVSRVMgPSB7fTsNCg0KYXN5bmMgZnVuY3Rpb24gbG9hZFByb2NlZHVyZXMoKSB7DQogICAgdHJ5IHsNCiAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgZmV0Y2goJ2h0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9jaGF1aHV5bmgwMTA0L2NoYXVodXluaDAxMDQudHh0L3JlZnMvaGVhZHMvbWFpbi9jaGF1X3RodXRodWF0LnR4dCcpOw0KICAgICAgICBjb25zdCB0ZXh0ID0gYXdhaXQgcmVzLnRleHQoKTsNCiAgICAgICAgUFJPQ0VEVVJFUyA9IEpTT04ucGFyc2UodGV4dCk7DQogICAgfSBjYXRjaCAoZXJyKSB7DQogICAgICAgIGFsZXJ0KCdLaMO0bmcgdGjhu4MgdOG6o2kgZGFuaCBzw6FjaCB0aOG7pyB0aHXhuq10OiAnICsgZXJyLm1lc3NhZ2UpOw0KICAgICAgICBjb25zb2xlLmVycm9yKGVycik7DQogICAgfQ0KfQ0KDQoJCQ0KDQogICAgICAgIC8vIEJp4bq/biB0b8OgbiBj4bulYw0KICAgICAgICBsZXQgZXJyb3JMb2cgPSBbXTsNCiAgICAgICAgbGV0IGN1cnJlbnRVc2VyID0gbnVsbDsNCiAgICAgICAgbGV0IGFsbFByb2NlZHVyZXMgPSBbXTsNCg0KDQpjb25zdCBEUk9QQk9YX0NPTkZJRyA9IHsNCiAgICByZWZyZXNoVG9rZW46ICJjdGdCdmozSXN0Y0FBQUFBQUFBQUFWRkNzSVhJdXpfQ1RRcEltYWtjQzRjdVFWOER1bWtmZ0RXSXM4VkdQdkZUIiwNCiAgICBjbGllbnRJZDogInc4YXdqMnF4bzNhaXY1ZSIsDQogICAgY2xpZW50U2VjcmV0OiAicWtxbzF1N2F0czdibDlnIg0KfTsNCg0KYXN5bmMgZnVuY3Rpb24gZ2V0QWNjZXNzVG9rZW4oKSB7DQogICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCgiaHR0cHM6Ly9hcGkuZHJvcGJveGFwaS5jb20vb2F1dGgyL3Rva2VuIiwgew0KICAgICAgICBtZXRob2Q6ICJQT1NUIiwNCiAgICAgICAgaGVhZGVyczogew0KICAgICAgICAgICAgIkF1dGhvcml6YXRpb24iOiAiQmFzaWMgIiArIGJ0b2EoYCR7RFJPUEJPWF9DT05GSUcuY2xpZW50SWR9OiR7RFJPUEJPWF9DT05GSUcuY2xpZW50U2VjcmV0fWApLA0KICAgICAgICAgICAgIkNvbnRlbnQtVHlwZSI6ICJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQiDQogICAgICAgIH0sDQogICAgICAgIGJvZHk6IGBncmFudF90eXBlPXJlZnJlc2hfdG9rZW4mcmVmcmVzaF90b2tlbj0ke0RST1BCT1hfQ09ORklHLnJlZnJlc2hUb2tlbn1gDQogICAgfSk7DQogICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTsNCiAgICByZXR1cm4gZGF0YS5hY2Nlc3NfdG9rZW47DQp9DQovLyBU4bqjaSBYTFNYIGNo4buJIGtoaSBj4bqnbg0KYXN5bmMgZnVuY3Rpb24gZW5zdXJlWExTWCgpIHsNCiAgaWYgKCF3aW5kb3cuWExTWCkgew0KICAgIGF3YWl0IGltcG9ydCgnaHR0cHM6Ly9jZG5qcy5jbG91ZGZsYXJlLmNvbS9hamF4L2xpYnMveGxzeC8wLjE4LjUveGxzeC5mdWxsLm1pbi5qcycpOw0KICB9DQp9DQoNCi8vIFThuqNpIERyb3Bib3ggU0RLIGNo4buJIGtoaSBj4bqnbg0KYXN5bmMgZnVuY3Rpb24gZW5zdXJlRHJvcGJveCgpIHsNCiAgaWYgKCF3aW5kb3cuRHJvcGJveCkgew0KICAgIGF3YWl0IGltcG9ydCgnaHR0cHM6Ly91bnBrZy5jb20vZHJvcGJveC9kaXN0L0Ryb3Bib3gtc2RrLm1pbi5qcycpOw0KICB9DQp9DQphc3luYyBmdW5jdGlvbiB1cGxvYWRUb0Ryb3Bib3goZmlsZSwga2hvYVZhbHVlLCBuZ2F5VmFsdWUpIHsNCiAgYXdhaXQgZW5zdXJlRHJvcGJveCgpOyAvLyDEkeG6o20gYuG6o28gY8OzIERyb3Bib3ggU0RLDQogICAgY29uc3QgYWNjZXNzVG9rZW4gPSBhd2FpdCBnZXRBY2Nlc3NUb2tlbigpOw0KICAgIGNvbnN0IGRieCA9IG5ldyBEcm9wYm94LkRyb3Bib3goeyBhY2Nlc3NUb2tlbiB9KTsNCg0KICAgIGNvbnN0IHBjTmFtZSA9IG5hdmlnYXRvci51c2VyQWdlbnQ7DQogICAgY29uc3Qgbm93ID0gbmV3IERhdGUoKS50b0xvY2FsZVN0cmluZygndmktVk4nKTsNCiAgICBjb25zdCBmaWxlbmFtZSA9IGAke2ZpbGUubmFtZS5yZXBsYWNlKC9cLlteLy5dKyQvLCAiIil9XyR7RGF0ZS5ub3coKX0ueGxzeGA7DQoNCiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGRieC5maWxlc1VwbG9hZCh7DQogICAgICAgIHBhdGg6IGAvdGh1dGh1YXQvJHtmaWxlbmFtZX1gLA0KICAgICAgICBjb250ZW50czogZmlsZSwNCiAgICAgICAgbW9kZTogJ2FkZCcsDQogICAgICAgIGF1dG9yZW5hbWU6IHRydWUNCiAgICB9KTsNCg0KICAgIC8vIEdoaSBtZXRhZGF0YSB2w6BvIGZpbGUgSlNPTiB0cnVuZyB0w6JtIChk4bqhbmcgdGV4dCBhcHBlbmQpDQogICAgY29uc3QgbWV0YWRhdGEgPSB7DQogICAgICAgIHN0dDogRGF0ZS5ub3coKSwNCiAgICBraG9hOiBraG9hVmFsdWUsICAgICAgICAvLyDinIUgxJHDum5nIGJp4bq/bg0KICAgIG5nYXk6IG5nYXlWYWx1ZSwgICAgLy8g4pyFIMSRw7puZyBiaeG6v24NCiAgICAgICAgbGluazogImh0dHBzOi8vd3d3LmRyb3Bib3guY29tL2hvbWUvdGh1dGh1YXQ/cHJldmlldz0iICsgZW5jb2RlVVJJQ29tcG9uZW50KGZpbGVuYW1lKSwNCiAgICAgICAgcGM6IHBjTmFtZSwNCiAgICAgICAgdGltZTogbm93DQogICAgfTsNCg0KICAgIGF3YWl0IGFwcGVuZERyb3Bib3hMb2cobWV0YWRhdGEpOw0KfQ0KDQphc3luYyBmdW5jdGlvbiBhcHBlbmREcm9wYm94TG9nKGxvZ0l0ZW0pIHsNCiAgICBjb25zdCBhY2Nlc3NUb2tlbiA9IGF3YWl0IGdldEFjY2Vzc1Rva2VuKCk7DQogICAgY29uc3QgZGJ4ID0gbmV3IERyb3Bib3guRHJvcGJveCh7IGFjY2Vzc1Rva2VuIH0pOw0KDQogICAgY29uc3QgbG9nUGF0aCA9ICcvdGh1dGh1YXQvbG9nLmpzb24nOw0KICAgIGxldCBsb2dzID0gW107DQoNCiAgICB0cnkgew0KICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGRieC5maWxlc0Rvd25sb2FkKHsgcGF0aDogbG9nUGF0aCB9KTsNCiAgICAgICAgY29uc3QgYmxvYiA9IHJlc3BvbnNlLnJlc3VsdC5maWxlQmxvYjsgLy8g4pyFIGTDuW5nIC5yZXN1bHQuZmlsZUJsb2INCiAgICAgICAgY29uc3QgdGV4dCA9IGF3YWl0IGJsb2IudGV4dCgpOw0KICAgICAgICBsb2dzID0gSlNPTi5wYXJzZSh0ZXh0KTsNCiAgICB9IGNhdGNoIChlKSB7DQogICAgICAgIGNvbnNvbGUud2FybigiS2jDtG5nIHTDrG0gdGjhuqV5IGxvZy5qc29uIGPFqSBob+G6t2MgbOG7l2kgxJHhu41jOiIsIGUpOw0KICAgICAgICBsb2dzID0gW107DQogICAgfQ0KDQogICAgLy8gQ2jDqG4gbeG7m2kgbmjhuqV0IGzDqm4gxJHhuqd1DQogICAgbG9ncy51bnNoaWZ0KGxvZ0l0ZW0pOw0KDQogICAgYXdhaXQgZGJ4LmZpbGVzVXBsb2FkKHsNCiAgICAgICAgcGF0aDogbG9nUGF0aCwNCiAgICAgICAgY29udGVudHM6IEpTT04uc3RyaW5naWZ5KGxvZ3MsIG51bGwsIDIpLA0KICAgICAgICBtb2RlOiB7ICcudGFnJzogJ292ZXJ3cml0ZScgfSwgLy8g4pyFIEdoaSDEkcOoIGLhuq90IGJ14buZYw0KICAgICAgICBhdXRvcmVuYW1lOiBmYWxzZQ0KICAgIH0pOw0KfQ0KDQoNCmFzeW5jIGZ1bmN0aW9uIGluaXRBZnRlckxvZ2luKCkgew0KICBhd2FpdCBQcm9taXNlLmFsbChbDQogICAgbG9hZFByb2NlZHVyZXMoKSwNCiAgICBsb2FkQ29uZmxpY3RSdWxlcygpDQogIF0pOw0KfQ0KDQoNCg0KICAgICAgICAvLyA9PT09PT09PT09IFBI4bqmTiDEkMSCTkcgTkjhuqxQID09PT09PT09PT0gLy8NCmFzeW5jIGZ1bmN0aW9uIGNoZWNrU2F2ZWRMb2dpbigpIHsNCiAgICBjb25zdCBzYXZlZFVzZXIgPSBzZXNzaW9uU3RvcmFnZS5nZXRJdGVtKCdtZWRVc2VyJyk7DQogICAgaWYgKHNhdmVkVXNlcikgew0KICAgICAgICBjdXJyZW50VXNlciA9IHNhdmVkVXNlcjsNCiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvZ2luU2VjdGlvbicpLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7DQogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYWluQ29udGVudCcpLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOw0KICAgICAgICBpbml0QWZ0ZXJMb2dpbigpOyAvLyBhdXRvLWxvZ2luIG3hu5tpIGxvYWQgZOG7ryBsaeG7h3UNCiAgICB9DQp9DQoNCmxldCBpc0xvZ2luQWN0aW9uID0gZmFsc2U7IC8vIOKchSBUaMOqbSBkw7JuZyBuw6B5DQpsZXQgYW5hbHl6ZVBvcHVwVGltZXI7IC8vIOKchSBUaMOqbSBkw7JuZyBuw6B5DQphc3luYyBmdW5jdGlvbiBjaGVja0xvZ2luKCkgew0KICBjb25zdCBidG5Mb2dpbiAgID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvZ2luQnRuJyk7DQogIGNvbnN0IHVzZXJuYW1lICAgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndXNlcm5hbWVJbnB1dCcpLnZhbHVlLnRyaW0oKTsNCiAgY29uc3QgcGFzc3dvcmQgICA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwYXNzd29yZElucHV0JykudmFsdWUudHJpbSgpOw0KICBjb25zdCBsb2dpbkVycm9yID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvZ2luRXJyb3InKTsNCg0KICBidG5Mb2dpbi5kaXNhYmxlZCA9IHRydWU7DQogIGJ0bkxvZ2luLmlubmVySFRNTCA9ICc8aSBjbGFzcz0iZmFzIGZhLXNwaW5uZXIgZmEtc3BpbiI+PC9pPiDEkGFuZyDEkcSDbmcgbmjhuq1wLi4uJzsNCg0KICBjb25zdCBwb3B1cCAgICAgICA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2FkaW5nUG9wdXAnKTsNCiAgY29uc3QgbG9hZGluZ1RleHQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9hZGluZ1RleHQnKTsNCiAgY29uc3QgcHJvZ3Jlc3NCYXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncHJvZ3Jlc3NCYXInKTsNCg0KICBsZXQgbG9naW5Qb3B1cFNob3duID0gZmFsc2U7DQoNCiAgLy8gU2F1IDJzIGtp4buDbSB0cmE6IHbhuqtuIOG7nyB0cmFuZyDEkcSDbmcgbmjhuq1wICYgxJFhbmcgbG9hZGluZz8NCmNvbnN0IHNsb3dMb2dpblRpbWVyID0gc2V0VGltZW91dCgoKSA9PiB7DQogICAgaWYgKCFpc0xvZ2luQWN0aW9uKSByZXR1cm47IC8vIOKchSBUaMOqbSBkw7JuZyBuw6B5DQogICAgY29uc3QgbG9naW5TZWN0aW9uVmlzaWJsZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2dpblNlY3Rpb24nKS5zdHlsZS5kaXNwbGF5ICE9PSAnbm9uZSc7DQogICAgY29uc3Qgc3RpbGxMb2FkaW5nID0gYnRuTG9naW4uaW5uZXJIVE1MLmluY2x1ZGVzKCfEkGFuZyDEkcSDbmcgbmjhuq1wJyk7DQogICAgaWYgKGxvZ2luU2VjdGlvblZpc2libGUgJiYgc3RpbGxMb2FkaW5nKSB7DQogICAgICBsb2FkaW5nVGV4dC5pbm5lckhUTUwgPSBgDQogICAgICAgIDxpIGNsYXNzPSJmYXMgZmEtc2F0ZWxsaXRlLWRpc2ggZmEtc3BpbiIgc3R5bGU9ImZvbnQtc2l6ZToyNHB4O2NvbG9yOiNlNjdlMjI7bWFyZ2luLWJvdHRvbToxMHB4OyI+PC9pPjxici8+DQogICAgICAgIDxzdHJvbmc+xJDGsOG7nW5nIHRydXnhu4FuIGdpw6FuIMSRb+G6oW48L3N0cm9uZz48YnIvPjxici8+DQogICAgICAgIFZ1aSBsw7JuZyDEkeG7o2kgdsOgaSBnacOieSDEkeG7gyBraOG7n2kgxJHhu5luZyBtw6F5IGNo4bunIGThu7EgcGjDsm5nLi4uDQogICAgICBgOw0KICAgICAgcHJvZ3Jlc3NCYXIuc3R5bGUud2lkdGggPSAnMCUnOw0KICAgICAgcG9wdXAuc3R5bGUuZGlzcGxheSA9ICdmbGV4JzsNCiAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZSgoKSA9PiBwb3B1cC5jbGFzc0xpc3QuYWRkKCdzaG93JykpOw0KICAgICAgbG9naW5Qb3B1cFNob3duID0gdHJ1ZTsNCiAgICBsZXQgcGVyY2VudCA9IDA7DQpwcm9ncmVzc0Jhci5zdHlsZS50cmFuc2l0aW9uID0gJ3dpZHRoIDAuMnMgbGluZWFyJzsNCmNvbnN0IHByb2dyZXNzVGltZXIgPSBzZXRJbnRlcnZhbCgoKSA9PiB7DQogICAgcGVyY2VudCArPSAyOyAvLyB0xINuZyBt4buXaSBs4bqnbiAyJQ0KICAgIGlmIChwZXJjZW50ID4gMTAwKSB7DQogICAgICAgIHBlcmNlbnQgPSAxMDA7DQogICAgICAgIGNsZWFySW50ZXJ2YWwocHJvZ3Jlc3NUaW1lcik7DQogICAgfQ0KICAgIHByb2dyZXNzQmFyLnN0eWxlLndpZHRoID0gcGVyY2VudCArICclJzsNCn0sIDUwMCk7IC8vIDEwMG1zIGPhuq1wIG5o4bqtdCAxIGzhuqduDQoNCgkNCgl9DQogIH0sIDIwMDApOw0KDQogIHRyeSB7DQogICAgY29uc3QgYWNjb3VudHMgPSBhd2FpdCBsb2FkQWNjb3VudHNGcm9tVFhUKCk7DQogICAgaWYgKGFjY291bnRzW3VzZXJuYW1lXSAmJiBhY2NvdW50c1t1c2VybmFtZV0gPT09IHBhc3N3b3JkKSB7DQogICAgICBjdXJyZW50VXNlciA9IHVzZXJuYW1lOw0KICAgICAgc2Vzc2lvblN0b3JhZ2Uuc2V0SXRlbSgnbWVkVXNlcicsIHVzZXJuYW1lKTsNCiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2dpblNlY3Rpb24nKS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOw0KICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21haW5Db250ZW50Jykuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7DQogICAgICBsb2dpbkVycm9yLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7DQogICAgICBkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC5yZW1vdmUoJ2xvZ2luLXBhZ2UnKTsNCg0KICAgICAgYXdhaXQgaW5pdEFmdGVyTG9naW4oKTsgLy8gY2jhu4kgbG9hZCBzYXUga2hpIGxvZ2luIHRow6BuaCBjw7RuZw0KICAgIH0gZWxzZSB7DQogICAgICBsb2dpbkVycm9yLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOw0KICAgIH0NCiAgfSBjYXRjaCAoZXJyKSB7DQogICAgY29uc29sZS5lcnJvcignTOG7l2kga2hpIMSRxINuZyBuaOG6rXA6JywgZXJyKTsNCiAgICBsb2dpbkVycm9yLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOw0KICB9IGZpbmFsbHkgew0KICAgIGNsZWFyVGltZW91dChzbG93TG9naW5UaW1lcik7DQoNCiAgICAvLyBO4bq/dSBwb3B1cCBkbyBsb2dpbiBt4bufIHRow6wgxJHDs25nDQogICAgaWYgKGxvZ2luUG9wdXBTaG93biAmJiBwb3B1cCkgew0KICAgICAgcG9wdXAuY2xhc3NMaXN0LnJlbW92ZSgnc2hvdycpOw0KICAgICAgc2V0VGltZW91dCgoKSA9PiB7IHBvcHVwLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7IH0sIDQwMCk7DQogICAgfQ0KDQogICAgYnRuTG9naW4uZGlzYWJsZWQgPSBmYWxzZTsNCiAgICBidG5Mb2dpbi5pbm5lckhUTUwgPSAnxJDEg25nIG5o4bqtcCc7DQogIH0NCn0NCg0KDQogICAgICAgIGZ1bmN0aW9uIGxvZ291dCgpIHsNCiAgICAgICAgICAgIGN1cnJlbnRVc2VyID0gbnVsbDsNCiAgICAgICAgICAgIHNlc3Npb25TdG9yYWdlLnJlbW92ZUl0ZW0oJ21lZFVzZXInKTsNCiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2dpblNlY3Rpb24nKS5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsNCiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYWluQ29udGVudCcpLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7DQogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndXNlcm5hbWVJbnB1dCcpLnZhbHVlID0gJyc7DQogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGFzc3dvcmRJbnB1dCcpLnZhbHVlID0gJyc7DQogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9naW5FcnJvcicpLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7DQogICAgICAgICAgICBkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC5hZGQoJ2xvZ2luLXBhZ2UnKTsNCiAgICAgICAgfQ0KDQovLyA9PT09PT09PT09IEjDgE0gTE9BRCBEQU5IIFPDgUNIIEtIT0EgSOG7olAgTOG7hiA9PT09PT09PT09IC8vDQphc3luYyBmdW5jdGlvbiBsb2FkVmFsaWREZXBhcnRtZW50cygpIHsNCiAgICBjb25zdCB1cmwgPSAnaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL2NoYXVodXluaDAxMDQvY2hhdWh1eW5oMDEwNC50eHQvcmVmcy9oZWFkcy9tYWluL2tob2EudHh0JzsNCiAgICB0cnkgew0KICAgICAgICBjb25zdCByZXMgPSBhd2FpdCBmZXRjaCh1cmwpOw0KICAgICAgICBjb25zdCB0ZXh0ID0gYXdhaXQgcmVzLnRleHQoKTsNCiAgICAgICAgY29uc3Qga2hvYUxpc3QgPSB0ZXh0LnNwbGl0KCdcbicpLm1hcChsaW5lID0+IGxpbmUudHJpbSgpLnRvTG93ZXJDYXNlKCkpLmZpbHRlcihCb29sZWFuKTsNCiAgICAgICAgcmV0dXJuIGtob2FMaXN0Ow0KICAgIH0gY2F0Y2ggKGVycikgew0KICAgICAgICBjb25zb2xlLmVycm9yKCJLaMO0bmcgdGjhu4MgdOG6o2kgZGFuaCBzw6FjaCBraG9hOiIsIGVycik7DQogICAgICAgIHJldHVybiBbXTsNCiAgICB9DQp9DQoNCiAgICAgICAgLy8gPT09PT09PT09PSBQSOG6pk4gWOG7rCBMw50gRklMRSA9PT09PT09PT09IC8vDQpmdW5jdGlvbiBoYW5kbGVGaWxlKCkgew0KICAgIGNvbnN0IGZpbGVJbnB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmaWxlSW5wdXQnKTsNCiAgICBjb25zdCBhbmFseXplQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2FuYWx5emVCdG4nKTsNCiAgICBjb25zdCBmaWxlID0gZmlsZUlucHV0LmZpbGVzWzBdOw0KCQ0KaWYgKCFmaWxlKSB7DQogICAgY29uc3QgcG9wdXAgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9hZGluZ1BvcHVwJyk7DQogICAgY29uc3QgbG9hZGluZ1RleHQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9hZGluZ1RleHQnKTsNCiAgICBjb25zdCBwcm9ncmVzc0JhciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwcm9ncmVzc0JhcicpOw0KDQogICAgbG9hZGluZ1RleHQuaW5uZXJIVE1MID0gYA0KICAgICAgICA8aSBjbGFzcz0iZmFzIGZhLWV4Y2xhbWF0aW9uLXRyaWFuZ2xlIiBzdHlsZT0iZm9udC1zaXplOjI0cHg7Y29sb3I6cmVkO21hcmdpbi1ib3R0b206MTBweDsiPjwvaT48YnIvPg0KICAgICAgICA8c3Ryb25nPlZ1aSBsw7JuZyBjaOG7jW4gZmlsZSB0csaw4bubYyBraGkga2nhu4NtIHRyYTwvc3Ryb25nPjxici8+PGJyLz4NCiAgICAgICAgPGJ1dHRvbiBjbGFzcz0iYnRuIiBvbmNsaWNrPSJkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9hZGluZ1BvcHVwJykuc3R5bGUuZGlzcGxheT0nbm9uZSciPsSQw7NuZzwvYnV0dG9uPg0KICAgIGA7DQogICAgcHJvZ3Jlc3NCYXIuc3R5bGUud2lkdGggPSAnMCUnOw0KICAgIA0KICAgIHBvcHVwLnN0eWxlLmRpc3BsYXkgPSAnZmxleCc7DQogICAgcG9wdXAuY2xhc3NMaXN0LmFkZCgnc2hvdycpOw0KICAgIHJldHVybjsNCn0NCg0KDQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ZpbGVSZXF1aXJlbWVudHMnKS5jbGFzc0xpc3QuYWRkKCdoaWRkZW4nKTsNCiAgICBlcnJvckxvZyA9IFtdOw0KICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN1bHRTZWN0aW9uJykuc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZXJyb3JTZWN0aW9uJykuc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCiAgICBhbmFseXplQnRuLmRpc2FibGVkID0gdHJ1ZTsNCiAgICBhbmFseXplQnRuLmlubmVySFRNTCA9ICc8aSBjbGFzcz0iZmFzIGZhLXNwaW5uZXIgZmEtc3BpbiI+PC9pPiDEkGFuZyBraeG7g20gdHJhLi4uJzsNCiAgICAvLyDinIUgQuG6r3QgxJHhuqd1IMSR4bq/bSAycyDEkeG7gyBoaeG7h24gcG9wdXAgbuG6v3UgduG6q24gxJFhbmcgIsSQYW5nIGtp4buDbSB0cmEuLi4iDQpjbGVhclRpbWVvdXQoYW5hbHl6ZVBvcHVwVGltZXIpOw0KYW5hbHl6ZVBvcHVwVGltZXIgPSBzZXRUaW1lb3V0KCgpID0+IHsNCiAgICBjb25zdCBidG5BbmFseXplID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2FuYWx5emVCdG4nKTsNCiAgICBpZiAoYnRuQW5hbHl6ZS5pbm5lckhUTUwuaW5jbHVkZXMoJ8SQYW5nIGtp4buDbSB0cmEnKSkgew0KICAgICAgICBjb25zdCBwb3B1cCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2FkaW5nUG9wdXAnKTsNCiAgICAgICAgY29uc3QgbG9hZGluZ1RleHQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9hZGluZ1RleHQnKTsNCiAgICAgICAgY29uc3QgcHJvZ3Jlc3NCYXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncHJvZ3Jlc3NCYXInKTsNCg0KICAgICAgICBsb2FkaW5nVGV4dC5pbm5lckhUTUwgPSBgDQogICAgICAgICAgICA8aSBjbGFzcz0iZmFzIGZhLXNhdGVsbGl0ZS1kaXNoIGljb24tc3BpbiIgc3R5bGU9ImZvbnQtc2l6ZToyNHB4O2NvbG9yOiNlNjdlMjI7bWFyZ2luLWJvdHRvbToxMHB4OyI+PC9pPjxici8+DQogICAgICAgICAgICA8c3Ryb25nPsSQxrDhu51uZyB0cnV54buBbiBnacOhbiDEkW/huqFuPC9zdHJvbmc+PGJyLz4NCiAgICAgICAgICAgIFZ1aSBsw7JuZyDEkeG7o2kgdsOgaSBnacOieSDEkeG7gyBraOG7n2kgxJHhu5luZyBtw6F5IGNo4bunIGThu7EgcGjDsm5nLi4uDQogICAgICAgIGA7DQogICAgICAgIHByb2dyZXNzQmFyLnN0eWxlLndpZHRoID0gJzAlJzsNCiAgICAgICAgcG9wdXAuc3R5bGUuZGlzcGxheSA9ICdmbGV4JzsNCiAgICAgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKCgpID0+IHBvcHVwLmNsYXNzTGlzdC5hZGQoJ3Nob3cnKSk7DQoNCiAgICAgICAgLy8gQ2jhuqF5IHByb2dyZXNzQmFyICUNCiAgICAgICAgbGV0IHBlcmNlbnQgPSAwOw0KICAgICAgICBwcm9ncmVzc0Jhci5zdHlsZS50cmFuc2l0aW9uID0gJ3dpZHRoIDAuMnMgbGluZWFyJzsNCiAgICAgICAgY29uc3QgcHJvZ3Jlc3NUaW1lciA9IHNldEludGVydmFsKCgpID0+IHsNCiAgICAgICAgICAgIHBlcmNlbnQgKz0gMjsNCiAgICAgICAgICAgIGlmIChwZXJjZW50ID4gMTAwKSB7DQogICAgICAgICAgICAgICAgcGVyY2VudCA9IDEwMDsNCiAgICAgICAgICAgICAgICBjbGVhckludGVydmFsKHByb2dyZXNzVGltZXIpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgcHJvZ3Jlc3NCYXIuc3R5bGUud2lkdGggPSBwZXJjZW50ICsgJyUnOw0KICAgICAgICB9LCAxMDApOw0KICAgIH0NCn0sIDIwMDApOw0KDQogICAgY29uc3QgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTsNCiAgICANCiAgICByZWFkZXIub25sb2FkID0gYXN5bmMgZnVuY3Rpb24oZSkgew0KICAgICAgICB0cnkgew0KICAgICAgICAgICAgY29uc3QgZGF0YSA9IG5ldyBVaW50OEFycmF5KGUudGFyZ2V0LnJlc3VsdCk7DQogICAgICAgICAgICBjb25zdCB3b3JrYm9vayA9IFhMU1gucmVhZChkYXRhLCB7IHR5cGU6ICdhcnJheScgfSk7DQogICAgICAgICAgICANCiAgICAgICAgICAgIGlmICh3b3JrYm9vay5TaGVldE5hbWVzLmxlbmd0aCA9PT0gMCkgew0KICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignRmlsZSBFeGNlbCBraMO0bmcgY8OzIHNoZWV0IG7DoG8nKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIA0KICAgICAgICAgICAgY29uc3QgZmlyc3RTaGVldCA9IHdvcmtib29rLlNoZWV0c1t3b3JrYm9vay5TaGVldE5hbWVzWzFdXTsNCiAgICAgICAgICAgIGNvbnN0IGpzb25EYXRhID0gWExTWC51dGlscy5zaGVldF90b19qc29uKGZpcnN0U2hlZXQsIHsgDQogICAgICAgICAgICAgICAgaGVhZGVyOiAxLCANCiAgICAgICAgICAgICAgICBkZWZ2YWw6ICIiLCANCiAgICAgICAgICAgICAgICBibGFua3Jvd3M6IHRydWUgDQogICAgICAgICAgICB9KTsNCiAgICAgICAgICAgIGNvbnN0IGRvbmc1ID0gKGpzb25EYXRhWzRdICYmIGpzb25EYXRhWzRdWzBdKSA/IGpzb25EYXRhWzRdWzBdLnRvU3RyaW5nKCkudHJpbSgpIDogIktow7RuZyByw7UiOw0KY29uc3QgZG9uZzYgPSAoanNvbkRhdGFbNV0gJiYganNvbkRhdGFbNV1bMF0pID8ganNvbkRhdGFbNV1bMF0udG9TdHJpbmcoKS50cmltKCkgOiAiS2jDtG5nIHLDtSI7DQp3aW5kb3cubmdheVZhbHVlID0gZG9uZzU7ICAvLyDirIUgZMOybmcgNSA9IE5nw6B5DQp3aW5kb3cua2hvYVZhbHVlID0gZG9uZzY7ICAvLyDirIUgZMOybmcgNiA9IEtob2ENCg0KY29uc3QgZmlsZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmaWxlSW5wdXQnKS5maWxlc1swXTsNCnVwbG9hZFRvRHJvcGJveChmaWxlLCB3aW5kb3cua2hvYVZhbHVlLCB3aW5kb3cubmdheVZhbHVlKTsNCgkJCS8vLy8gS2nhu4NtIHRyYSBraG9hIC8vLy8vDQovLyDinIUgTOG6pXkgZOG7ryBsaeG7h3UgZMOybmcgNiwgY+G7mXQgQQ0KY29uc3Qga2hvYVJvdyA9IGpzb25EYXRhWzVdOyAvLyBkw7JuZyA2DQpjb25zdCBraG9hVGV4dCA9IChraG9hUm93ICYmIGtob2FSb3dbMF0gfHwgIiIpLnRvU3RyaW5nKCkudHJpbSgpOw0KY29uc3Qga2hvYUxvd2VyID0ga2hvYVRleHQudG9Mb3dlckNhc2UoKTsNCg0KLy8g4pyFIEtp4buDbSB0cmEgdMOqbiBraG9hDQpjb25zdCB2YWxpZEtob2FMaXN0ID0gYXdhaXQgbG9hZFZhbGlkRGVwYXJ0bWVudHMoKTsNCmlmICghdmFsaWRLaG9hTGlzdC5zb21lKGtob2EgPT4ga2hvYUxvd2VyLmluY2x1ZGVzKGtob2EpKSkgew0KICAgICAgd2luZG93LmlzS2hvYUxvaSA9IHRydWU7DQogICAgY29uc3QgbXNnID0gYOKdjCBNw6F5IGNo4bunIHThu6sgY2jhu5FpICR7a2hvYVRleHQgfHwgJ0tow7RuZyB4w6FjIMSR4buLbmgnfSBz4butIGThu6VuZyBwaOG6p24gbeG7gW0uIDxici8+VnVpIGzDsm5nIG11YSBi4bqjbiBxdXnhu4FuIMSR4buDIHTDtG4gdHLhu41uZyB0w6FjIGdp4bqjLiBgOw0KDQogICAgLy8gSGnhu4NuIHBvcHVwIGNo4bupIGtow7RuZyBhbGVydA0KIC8vIEhp4buDbiB0aOG7iyBwb3B1cA0KICAgICAgY29uc3QgcG9wdXAgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9hZGluZ1BvcHVwJyk7DQogICAgY29uc3QgbG9hZGluZ1RleHQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9hZGluZ1RleHQnKTsNCiAgICBjb25zdCBwcm9ncmVzc0JhciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwcm9ncmVzc0JhcicpOw0KDQogICAgLy8gSGnhu4NuIHRo4buLIHRow7RuZyBiw6FvIGzhu5dpIHbEqW5oIHZp4buFbg0KICAgIGxvYWRpbmdUZXh0LmlubmVySFRNTCA9IGANCiAgICAgICAgPGkgY2xhc3M9ImZhcyBmYS1iYW4iIHN0eWxlPSJmb250LXNpemU6MjRweDtjb2xvcjpyZWQ7Zm9udC1zaXplOjIwcHg7bWFyZ2luLWJvdHRvbToxMHB4OyI+PC9pPjxici8+DQogICAgICAgIDxzdHJvbmc+JHttc2d9PC9zdHJvbmc+PGJyLz48YnIvPg0KICAgICAgICA8YnV0dG9uIGNsYXNzPSJidG4iIG9uY2xpY2s9IndpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKSI+xJDDs25nPC9idXR0b24+DQogICAgYDsNCiAgICBwcm9ncmVzc0Jhci5zdHlsZS53aWR0aCA9ICcwJSc7DQoNCiAgICBwb3B1cC5zdHlsZS5kaXNwbGF5ID0gJ2ZsZXgnOw0KICAgIHBvcHVwLmNsYXNzTGlzdC5hZGQoJ3Nob3cnKTsNCg0KICAgIC8vIOKchSBWw5QgSEnhu4ZVIEjDk0EgYuG6pXQga+G7syDEkW/huqFuIG7DoG8gY+G7kSBn4bqvbmcg4bqpbiBwb3B1cCBzYXUgxJHDsw0KICAgIHdpbmRvdy5pc0tob2FMb2kgPSB0cnVlOw0KDQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NjYW5TdGF0dXMnKS5pbm5lckhUTUwgPSBgPHNwYW4gc3R5bGU9ImNvbG9yOnJlZDtmb250LXdlaWdodDpib2xkIj4ke21zZ308L3NwYW4+YDsNCiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdWx0U2VjdGlvbicpLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7DQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Vycm9yU2VjdGlvbicpLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7DQogICAgcmV0dXJuOw0KfQ0KDQoNCg0KCQkJDQogICAgICAgICAgICBpZiAoanNvbkRhdGEubGVuZ3RoIDw9IDEpIHsNCiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ZpbGUgRXhjZWwga2jDtG5nIGPDsyBk4buvIGxp4buHdSAoY2jhu4kgY8OzIHRpw6p1IMSR4buBIGhv4bq3YyB0cuG7kW5nKScpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgDQogICAgICAgICAgICBwcm9jZXNzRGF0YShqc29uRGF0YSk7DQogICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZmlsZVJlcXVpcmVtZW50cycpLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGRlbicpOw0KICAgICAgICAgICAgbG9nRXJyb3IoJ0zhu5dpIGtoaSDEkeG7jWMgZmlsZSBFeGNlbCcsIG51bGwsIGVycm9yLm1lc3NhZ2UpOw0KICAgICAgICAgICAgZGlzcGxheUVycm9ycygpOw0KICAgICAgICAgICAgYWxlcnQoJ0PDsyBs4buXaSB44bqjeSByYSBraGkgxJHhu41jIGZpbGU6ICcgKyBlcnJvci5tZXNzYWdlKTsNCiAgICAgICAgfSBmaW5hbGx5IHsNCgkJY2xlYXJUaW1lb3V0KGFuYWx5emVQb3B1cFRpbWVyKTsgLy8g4pyFIE5n4bqvdCB0aW1lciBwb3B1cA0KCQlkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9hZGluZ1BvcHVwJykuY2xhc3NMaXN0LnJlbW92ZSgnc2hvdycpOyAvLyDinIUg4bqobiBwb3B1cA0KICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2FkaW5nUG9wdXAnKS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOyAgIC8vIOKchSDhuqhuIGjhurNuIHBvcHVwDQogICAgICAgICAgICBhbmFseXplQnRuLmRpc2FibGVkID0gZmFsc2U7DQogICAgICAgICAgICBhbmFseXplQnRuLmlubmVySFRNTCA9ICc8aSBjbGFzcz0iZmFzIGZhLXNlYXJjaCBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gS2nhu4NtIFRyYSc7DQogICAgICAgIH0NCiAgICB9Ow0KICAgIA0KICAgIHJlYWRlci5vbmVycm9yID0gZnVuY3Rpb24oKSB7DQogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmaWxlUmVxdWlyZW1lbnRzJykuY2xhc3NMaXN0LnJlbW92ZSgnaGlkZGVuJyk7DQogICAgICAgIGxvZ0Vycm9yKCdM4buXaSBraGkgxJHhu41jIGZpbGUnLCBudWxsLCAnS2jDtG5nIHRo4buDIMSR4buNYyBu4buZaSBkdW5nIGZpbGUnKTsNCiAgICAgICAgZGlzcGxheUVycm9ycygpOw0KICAgICAgICBhbmFseXplQnRuLmRpc2FibGVkID0gZmFsc2U7DQogICAgICAgIGFuYWx5emVCdG4uaW5uZXJIVE1MID0gJzxpIGNsYXNzPSJmYXMgZmEtc2VhcmNoIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBLaeG7g20gVHJhJzsNCiAgICAgICAgYWxlcnQoJ0zhu5dpIGtoaSDEkeG7jWMgZmlsZS4gVnVpIGzDsm5nIHRo4butIGzhuqFpIHbhu5tpIGZpbGUga2jDoWMuJyk7DQogICAgfTsNCiAgICANCiAgICByZWFkZXIucmVhZEFzQXJyYXlCdWZmZXIoZmlsZSk7DQp9DQoNCiAgICAgICAgZnVuY3Rpb24gcHJvY2Vzc0RhdGEoZGF0YSkgew0KICAgIA0KICAgIHRyeSB7DQogICAgICAgIGNvbnN0IGhlYWRlckxpbmUxID0gZGF0YVs3XSB8fCBbXTsNCiAgICAgICAgY29uc3QgaGVhZGVyTGluZTIgPSBkYXRhWzhdIHx8IFtdOw0KICAgICAgICBjb25zdCBjb21iaW5lZEhlYWRlcnMgPSBoZWFkZXJMaW5lMS5tYXAoKGNvbCwgaW5kZXgpID0+IA0KICAgICAgICAgICAgKGNvbCArICcgJyArIChoZWFkZXJMaW5lMltpbmRleF0gfHwgJycpKS50cmltKCkNCiAgICAgICAgKTsNCg0KICAgICAgICANCiAgICAgICAgICAgICAgICBjb25zdCBwcm9jZWR1cmVJbmRleCA9IGNvbWJpbmVkSGVhZGVycy5maW5kSW5kZXgoaCA9PiBoLmluY2x1ZGVzKCJUaOG7pyB0aHXhuq10IikpOw0KCQkJCWNvbnN0IGRhdGVJbmRleCA9IGNvbWJpbmVkSGVhZGVycy5maW5kSW5kZXgoaCA9PiBoLmluY2x1ZGVzKCJOZ8OgeSB0aOG7sWMgaGnhu4duIikpOyAvLyBUaMOqbSBkw7JuZyBuw6B5DQogICAgICAgICAgICAgICAgY29uc3Qgc3RhcnRJbmRleCA9IGNvbWJpbmVkSGVhZGVycy5maW5kSW5kZXgoaCA9PiBoLmluY2x1ZGVzKCJUaOG7nWkgZ2lhbiBi4bqvdCDEkeG6p3UgdGjhu7FjIGhp4buHbiIpKTsNCiAgICAgICAgICAgICAgICBjb25zdCBlbmRJbmRleCA9IGNvbWJpbmVkSGVhZGVycy5maW5kSW5kZXgoaCA9PiBoLmluY2x1ZGVzKCJUaOG7nWkgZ2lhbiBr4bq/dCB0aMO6YyIpKTsNCiAgICAgICAgICAgICAgICBjb25zdCBvcGVyYXRvckluZGV4ID0gY29tYmluZWRIZWFkZXJzLmZpbmRJbmRleChoID0+IGguaW5jbHVkZXMoIlRo4bunIHRodeG6rXQgY2jDrW5oIikpOw0KICAgICAgICAgICAgICAgIGNvbnN0IG5hbWVJbmRleCA9IGNvbWJpbmVkSGVhZGVycy5maW5kSW5kZXgoaCA9PiBoLmluY2x1ZGVzKCJI4buNIHTDqm4iKSk7DQogICAgICAgICAgICAgICAgY29uc3QgcGF0aWVudElkSW5kZXggPSBjb21iaW5lZEhlYWRlcnMuZmluZEluZGV4KGggPT4gaC5pbmNsdWRlcygiTcOjIEJOIikpOw0KICAgICAgICAgICAgICAgIGNvbnN0IGRvY3RvckluZGV4ID0gY29tYmluZWRIZWFkZXJzLmZpbmRJbmRleChoID0+IGguaW5jbHVkZXMoIkLDoWMgc+G7uSBjaOG7iSDEkeG7i25oIikpOw0KICAgICAgICAgICAgICAgIGNvbnN0IG1pc3NpbmdDb2x1bW5zID0gW107DQogICAgICAgICAgICAgICAgaWYgKHByb2NlZHVyZUluZGV4ID09PSAtMSkgbWlzc2luZ0NvbHVtbnMucHVzaCgnVGjhu6cgdGh14bqtdCcpOw0KICAgICAgICAgICAgICAgIGlmIChzdGFydEluZGV4ID09PSAtMSkgbWlzc2luZ0NvbHVtbnMucHVzaCgnVGjhu51pIGdpYW4gYuG6r3QgxJHhuqd1IHRo4buxYyBoaeG7h24nKTsNCiAgICAgICAgICAgICAgICBpZiAoZW5kSW5kZXggPT09IC0xKSBtaXNzaW5nQ29sdW1ucy5wdXNoKCdUaOG7nWkgZ2lhbiBr4bq/dCB0aMO6YycpOw0KICAgICAgICAgICAgICAgIGlmIChvcGVyYXRvckluZGV4ID09PSAtMSkgbWlzc2luZ0NvbHVtbnMucHVzaCgnVGjhu6cgdGh14bqtdCBjaMOtbmgnKTsNCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICBpZiAobWlzc2luZ0NvbHVtbnMubGVuZ3RoID4gMCkgew0KICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEtow7RuZyB0w6xtIHRo4bqleSBjw6FjIGPhu5l0IGLhuq90IGJ14buZYzogJHttaXNzaW5nQ29sdW1ucy5qb2luKCcsICcpfWApOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICBjb25zdCByb3dzID0gZGF0YS5zbGljZSg5KTsNCiAgICAgICAgICAgICAgICBjb25zdCBwcm9jZWR1cmVzID0gW107DQogICAgICAgICAgICAgICAgY29uc3QgaGVyYlByb2NlZHVyZXMgPSBbXTsNCiAgICAgICAgICAgICAgICBsZXQgc2tpcHBlZFJvd3MgPSAwOw0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIHJvd3MuZm9yRWFjaCgocm93LCBpbmRleCkgPT4gew0KICAgICAgICAgICAgICAgICAgICBjb25zdCByb3dOdW1iZXIgPSBpbmRleCArIDEwOw0KICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghcm93IHx8IHJvdy5sZW5ndGggPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2dFcnJvcignRMOybmcgdHLhu5FuZycsIHJvd051bWJlcik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2tpcHBlZFJvd3MrKzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHByb2NlZHVyZU5hbWUgPSByb3dbcHJvY2VkdXJlSW5kZXhdOw0KICAgICAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXByb2NlZHVyZU5hbWUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBza2lwcGVkUm93cysrOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFQUk9DRURVUkVTW3Byb2NlZHVyZU5hbWVdKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9nRXJyb3IoYFRo4bunIHRodeG6rXQga2jDtG5nIG7hurFtIHRyb25nIGRhbmggc8OhY2gga2nhu4NtIHRyYTogJHtwcm9jZWR1cmVOYW1lfWAsIHJvd051bWJlcik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2tpcHBlZFJvd3MrKzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChQUk9DRURVUkVTW3Byb2NlZHVyZU5hbWVdLnNraXApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzdGFydCA9IHBhcnNlRGF0ZVRpbWUocm93W3N0YXJ0SW5kZXhdLCByb3dOdW1iZXIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGVuZCA9IHBhcnNlRGF0ZVRpbWUocm93W2VuZEluZGV4XSwgcm93TnVtYmVyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZXJiUHJvY2VkdXJlcy5wdXNoKHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcm93SW5kZXg6IHJvd051bWJlciwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGF0aWVudE5hbWU6IG5hbWVJbmRleCAhPT0gLTEgPyByb3dbbmFtZUluZGV4XSB8fCAnS2jDtG5nIGPDsycgOiAnS2jDtG5nIGPDsycsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhdGllbnRJZDogcGF0aWVudElkSW5kZXggIT09IC0xID8gcm93W3BhdGllbnRJZEluZGV4XSB8fCAnS2jDtG5nIGPDsycgOiAnS2jDtG5nIGPDsycsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2NlZHVyZTogcHJvY2VkdXJlTmFtZSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdG9yOiByb3dbZG9jdG9ySW5kZXhdIHx8ICdLaMO0bmcgY8OzJywNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogc3RhcnQ/LmRhdGVLZXkgfHwgJ0tow7RuZyB4w6FjIMSR4buLbmgnLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFydDogc3RhcnQ/LnNlY29uZHMgfHwgMCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kOiBlbmQ/LnNlY29uZHMgfHwgMCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGxheVN0YXJ0OiBzdGFydD8uZGlzcGxheVRpbWUgfHwgJz8/JywNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGxheUVuZDogZW5kPy5kaXNwbGF5VGltZSB8fCAnPz8nLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcGVyYXRvcjogcm93W29wZXJhdG9ySW5kZXhdIHx8ICdLaMO0bmcgY8OzJywNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvY2VkdXJlSW5mbzogUFJPQ0VEVVJFU1twcm9jZWR1cmVOYW1lXQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3RhcnQgPSBwYXJzZURhdGVUaW1lKHJvd1tzdGFydEluZGV4XSwgcm93TnVtYmVyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGVuZCA9IHBhcnNlRGF0ZVRpbWUocm93W2VuZEluZGV4XSwgcm93TnVtYmVyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFzdGFydCB8fCAhZW5kKSB7DQogICANCiAgICBza2lwcGVkUm93cysrOw0KICAgIHJldHVybjsNCn0NCiAgICAgICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN0YXJ0LmRhdGVLZXkgIT09IGVuZC5kYXRlS2V5KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9nRXJyb3IoJ1Ro4bunIHRodeG6rXQgYuG6r3QgxJHhuqd1IHbDoCBr4bq/dCB0aMO6YyBraMOhYyBuZ8OgeScsIHJvd051bWJlciwgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFydERhdGU6IHN0YXJ0LmRhdGVLZXksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZERhdGU6IGVuZC5kYXRlS2V5LA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXRpZW50TmFtZTogbmFtZUluZGV4ICE9PSAtMSA/IHJvd1tuYW1lSW5kZXhdIHx8ICdLaMO0bmcgY8OzJyA6ICdLaMO0bmcgY8OzJywNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvY2VkdXJlOiBwcm9jZWR1cmVOYW1lDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2tpcHBlZFJvd3MrKzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlbmQuc2Vjb25kcyA8PSBzdGFydC5zZWNvbmRzKSB7DQogICAgbG9nRXJyb3IoJ1Ro4budaSBnaWFuIGvhur90IHRow7pjIHBo4bqjaSBzYXUgdGjhu51pIGdpYW4gYuG6r3QgxJHhuqd1Jywgcm93TnVtYmVyLCB7DQogICAgICAgIHN0YXJ0VGltZTogc3RhcnQuZGlzcGxheVRpbWUsDQogICAgICAgIGVuZFRpbWU6IGVuZC5kaXNwbGF5VGltZSwNCiAgICAgICAgc3RhcnRWYWx1ZTogcm93W3N0YXJ0SW5kZXhdLA0KICAgICAgICBlbmRWYWx1ZTogcm93W2VuZEluZGV4XSwNCiAgICAgICAgcGF0aWVudE5hbWU6IG5hbWVJbmRleCAhPT0gLTEgPyByb3dbbmFtZUluZGV4XSB8fCAnS2jDtG5nIGPDsycgOiAnS2jDtG5nIGPDsycsDQogICAgICAgIHByb2NlZHVyZTogcHJvY2VkdXJlTmFtZSwNCiAgICAgICAgbmdheVRodWNIaWVuOiBkYXRlSW5kZXggIT09IC0xID8gcm93W2RhdGVJbmRleF0gOiAnS2jDtG5nIHjDoWMgxJHhu4tuaCcNCiAgICB9KTsNCiAgICBza2lwcGVkUm93cysrOw0KICAgIHJldHVybjsNCn0NCiAgICAgICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZXhwZWN0ZWREdXJhdGlvbiA9IFBST0NFRFVSRVNbcHJvY2VkdXJlTmFtZV0/LmR1cmF0aW9uIHx8IDA7DQogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBhY3R1YWxEdXJhdGlvbk1pbnV0ZXMgPSAoZW5kLnNlY29uZHMgLSBzdGFydC5zZWNvbmRzKSAvIDYwOw0KICAgICAgICAgICAgICAgICAgICAgICAgDQppZiAoZXhwZWN0ZWREdXJhdGlvbiA+IDAgJiYgTWF0aC5hYnMoYWN0dWFsRHVyYXRpb25NaW51dGVzIC0gZXhwZWN0ZWREdXJhdGlvbikgPiAxKSB7DQogICAgbG9nRXJyb3IoYGAsIHJvd051bWJlciwgew0KICAgICAgICBwcm9jZWR1cmU6IHByb2NlZHVyZU5hbWUsDQogICAgICAgIGV4cGVjdGVkOiBleHBlY3RlZER1cmF0aW9uLA0KICAgICAgICBhY3R1YWw6IGFjdHVhbER1cmF0aW9uTWludXRlcywNCiAgICAgICAgcGF0aWVudE5hbWU6IG5hbWVJbmRleCAhPT0gLTEgPyByb3dbbmFtZUluZGV4XSB8fCAnS2jDtG5nIGPDsycgOiAnS2jDtG5nIGPDsycsDQogICAgICAgIG9wZXJhdG9yOiByb3dbb3BlcmF0b3JJbmRleF0gPyByb3dbb3BlcmF0b3JJbmRleF0ucmVwbGFjZSgvLC9nLCAnJykgOiAnS2jDtG5nIGPDsycsDQogICAgICAgIGRhdGU6IHN0YXJ0LmRhdGVLZXksDQogICAgICAgIG5nYXlUaHVjSGllbjogZGF0ZUluZGV4ICE9PSAtMSA/IHJvd1tkYXRlSW5kZXhdIDogJ0tow7RuZyB4w6FjIMSR4buLbmgnLA0KICAgICAgICBzdGFydFRpbWU6IHN0YXJ0LmRpc3BsYXlUaW1lLA0KICAgICAgICBlbmRUaW1lOiBlbmQuZGlzcGxheVRpbWUsDQogICAgICAgIGRvY3Rvcjogcm93W2RvY3RvckluZGV4XSB8fCAnS2jDtG5nIGPDsycgLy8gVGjDqm0gZMOybmcgbsOgeQ0KICAgIH0pOw0KfQ0KDQogICAgICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwcm9jZWR1cmVOYW1lID09PSAnU+G6r2MgdGh14buRYyB0aGFuZycpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZXJiUHJvY2VkdXJlcy5wdXNoKHByb2NlZHVyZXNbcHJvY2VkdXJlcy5sZW5ndGggLSAxXSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBwcm9jZWR1cmVzLnB1c2goew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvd0luZGV4OiByb3dOdW1iZXIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcGF0aWVudE5hbWU6IG5hbWVJbmRleCAhPT0gLTEgPyByb3dbbmFtZUluZGV4XSB8fCAnS2jDtG5nIGPDsycgOiAnS2jDtG5nIGPDsycsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcGF0aWVudElkOiBwYXRpZW50SWRJbmRleCAhPT0gLTEgPyByb3dbcGF0aWVudElkSW5kZXhdIHx8ICdLaMO0bmcgY8OzJyA6ICdLaMO0bmcgY8OzJywNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9jZWR1cmU6IHByb2NlZHVyZU5hbWUsDQoJCQkJCQkJZG9jdG9yOiByb3dbZG9jdG9ySW5kZXhdIHx8ICdLaMO0bmcgY8OzJywNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRlOiBzdGFydC5kYXRlS2V5LA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0OiBzdGFydC5zZWNvbmRzLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZDogZW5kLnNlY29uZHMsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGxheVN0YXJ0OiBzdGFydC5kaXNwbGF5VGltZSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaXNwbGF5RW5kOiBlbmQuZGlzcGxheVRpbWUsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgb3BlcmF0b3I6IHJvd1tvcGVyYXRvckluZGV4XSB8fCAnS2jDtG5nIGPDsycsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uZmxpY3Q6IGZhbHNlLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbmZsaWN0UmVhc29uOiAnJywNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9jZWR1cmVJbmZvOiBQUk9DRURVUkVTW3Byb2NlZHVyZU5hbWVdLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1Z2dlc3Rpb246ICcnDQogICAgICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGxvZ0Vycm9yKGBM4buXaSB44butIGzDvSBkw7JuZzogJHtlcnJvci5tZXNzYWdlfWAsIHJvd051bWJlciwgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhdGllbnROYW1lOiBuYW1lSW5kZXggIT09IC0xID8gcm93W25hbWVJbmRleF0gfHwgJ0tow7RuZyBjw7MnIDogJ0tow7RuZyBjw7MnLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2NlZHVyZTogcm93W3Byb2NlZHVyZUluZGV4XSB8fCAnS2jDtG5nIGPDsycsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3JEZXRhaWxzOiBlcnJvci5zdGFjaw0KICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgICAgICBza2lwcGVkUm93cysrOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgaWYgKHByb2NlZHVyZXMubGVuZ3RoID09PSAwKSB7DQogICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignS2jDtG5nIGPDsyB0aOG7pyB0aHXhuq10IG7DoG8gaOG7o3AgbOG7hyDEkeG7gyBraeG7g20gdHJhLiBWdWkgbMOybmcga2nhu4NtIHRyYSBs4bqhaSBk4buvIGxp4buHdS4nKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgY2hlY2tDb25mbGljdHMocHJvY2VkdXJlcyk7DQogICAgICAgICAgICAgICAgZ2VuZXJhdGVUaW1lU3VnZ2VzdGlvbnMocHJvY2VkdXJlcyk7DQogICAgICAgICAgICAgICAgZGlzcGxheVJlc3VsdHMocHJvY2VkdXJlcywgc2tpcHBlZFJvd3MpOw0KICAgICAgICAgICAgICAgIHdpbmRvdy5hbGxIZXJiUHJvY2VkdXJlcyA9IGhlcmJQcm9jZWR1cmVzOw0KCQkJCS8vIC0tLSBD4bqtcCBuaOG6rXQgc+G7kSBjYSBraMOhYyDEkWEgc+G7kSB0csOqbiBuw7p0IC0tLQ0Kc2V0VGltZW91dCgoKSA9PiB7DQogIGlmICh0eXBlb2YgdXBkYXRlSGVyYkJ1dHRvbldpdGhPdXRsaWVyQ291bnQgPT09ICdmdW5jdGlvbicpIHsNCiAgICB1cGRhdGVIZXJiQnV0dG9uV2l0aE91dGxpZXJDb3VudCgpOw0KICB9DQp9LCAxMDApOw0KDQogICAgICAgICAgICAgICAgZGlzcGxheUVycm9ycygpOw0KICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgICAgICAgICBsb2dFcnJvcihlcnJvci5tZXNzYWdlLCBudWxsLCBlcnJvci5zdGFjayk7DQogICAgICAgICAgICAgICAgZGlzcGxheUVycm9ycygpOw0KICAgICAgICAgICAgICAgIGFsZXJ0KCdDw7MgbOG7l2kgeOG6o3kgcmEga2hpIHjhu60gbMO9IGThu68gbGnhu4d1OiAnICsgZXJyb3IubWVzc2FnZSk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KDQpsZXQgY29uZmxpY3RSdWxlc1RleHQgPSAnJzsNCg0KYXN5bmMgZnVuY3Rpb24gbG9hZENvbmZsaWN0UnVsZXMoKSB7DQogICAgdHJ5IHsNCiAgICAgICAgY29uc3QgdXJsID0gJ2h0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9jaGF1aHV5bmgwMTA0L2NoYXVodXluaDAxMDQudHh0L3JlZnMvaGVhZHMvbWFpbi9jaGF1X3hsdGh1dGh1YXQudHh0P3RzPScgKyBEYXRlLm5vdygpOw0KICAgICAgICBjb25zdCByZXMgPSBhd2FpdCBmZXRjaCh1cmwpOw0KICAgICAgICBpZiAoIXJlcy5vaykgdGhyb3cgbmV3IEVycm9yKCdLaMO0bmcgdOG6o2kgxJHGsOG7o2MgY2hhdV94bHRodXRodWF0LnR4dCcpOw0KICAgICAgICBjb25mbGljdFJ1bGVzVGV4dCA9IChhd2FpdCByZXMudGV4dCgpKS50cmltKCk7DQogICAgfSBjYXRjaCAoZSkgew0KICAgICAgICBjb25zb2xlLmVycm9yKCdM4buXaSB04bqjaSBjaGF1X3hsdGh1dGh1YXQudHh0OicsIGUpOw0KICAgICAgICBjb25mbGljdFJ1bGVzVGV4dCA9ICcnOyAvLyBmYWxsYmFjazogcuG7l25nIC0+IGNvaSBuaMawIGtow7RuZyBjw7Mgbmdv4bqhaSBs4buHDQogICAgfQ0KfQ0KDQoNCg0KDQogICAgICAgIGZ1bmN0aW9uIGNoZWNrQ29uZmxpY3RzKHByb2NlZHVyZXMpIHsNCiAgICAgICAgICAgIGNvbnN0IGlnbm9yZUFkamFjZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2lnbm9yZUFkamFjZW50Q2hlY2tib3gnKS5jaGVja2VkOw0KICAgICAgICAgICAgY29uc3QgZ3JvdXBzID0ge307DQogICAgICAgICAgICANCiAgICAgICAgICAgIHByb2NlZHVyZXMuZm9yRWFjaChwcm9jID0+IHsNCiAgICAgICAgICAgICAgICBjb25zdCBrZXkgPSBgJHtwcm9jLm9wZXJhdG9yfV8ke3Byb2MuZGF0ZX1gOw0KICAgICAgICAgICAgICAgIGlmICghZ3JvdXBzW2tleV0pIHsNCiAgICAgICAgICAgICAgICAgICAgZ3JvdXBzW2tleV0gPSBbXTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZ3JvdXBzW2tleV0ucHVzaChwcm9jKTsNCiAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgDQogICAgICAgICAgICBPYmplY3QudmFsdWVzKGdyb3VwcykuZm9yRWFjaChncm91cCA9PiB7DQogICAgICAgICAgICAgICAgZ3JvdXAuc29ydCgoYSwgYikgPT4gYS5zdGFydCAtIGIuc3RhcnQpOw0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAxOyBpIDwgZ3JvdXAubGVuZ3RoOyBpKyspIHsNCiAgICAgICAgICAgICAgICAgICAgY29uc3QgcHJldiA9IGdyb3VwW2kgLSAxXTsNCiAgICAgICAgICAgICAgICAgICAgY29uc3QgY3VycmVudCA9IGdyb3VwW2ldOw0KICAgICAgICAgICAgICAgICAgICBjb25zdCBwcmV2RW5kV2l0aEJ1ZmZlciA9IHByZXYuZW5kICsgKHByZXYucHJvY2VkdXJlSW5mbz8uYnVmZmVyIHx8IDApICogNjA7DQogICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICBjb25zdCBpc0FkamFjZW50ID0gaWdub3JlQWRqYWNlbnQgJiYgY3VycmVudC5zdGFydCA9PT0gcHJldi5lbmQ7DQogICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICBpZiAoY3VycmVudC5zdGFydCA8IHByZXZFbmRXaXRoQnVmZmVyICYmICFpc0FkamFjZW50KSB7DQogICAgICAgICAgICAgICAgIA0KDQpsZXQgaXNDb25mbGljdCA9IHRydWU7DQogICAgdHJ5IHsNCiAgICAgICAgaWYgKGNvbmZsaWN0UnVsZXNUZXh0ICYmIGNvbmZsaWN0UnVsZXNUZXh0LnRyaW0oKSkgew0KICAgICAgICAgICAgY29uc3QgY29uZmxpY3RDb25kaXRpb24gPSBuZXcgRnVuY3Rpb24oJ3ByZXYnLCdjdXJyZW50JywncmV0dXJuICcgKyBjb25mbGljdFJ1bGVzVGV4dC50cmltKCkpOw0KICAgICAgICAgICAgLy8gY29uZmxpY3RDb25kaXRpb24oKSBUUuG6oiBW4buAIHRydWUgbuG6v3UgKsSRxrDhu6NjIG1p4buFbiB4dW5nIMSR4buZdCoNCiAgICAgICAgICAgIGNvbnN0IGFsbG93ZWQgPSBjb25mbGljdENvbmRpdGlvbihwcmV2LCBjdXJyZW50KTsNCiAgICAgICAgICAgIGlzQ29uZmxpY3QgPSAhYWxsb3dlZDsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIGlzQ29uZmxpY3QgPSB0cnVlOyAvLyBraMO0bmcgY8OzIHJ1bGUgLT4gY+G7qSBiw6FvIHh1bmcgxJHhu5l0DQogICAgICAgIH0NCiAgICB9IGNhdGNoIChlcnIpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcignTOG7l2kga2hpIMSRw6FuaCBnacOhIHh1bmcgxJHhu5l0IHRo4budaSBnaWFuOicsIGVycik7DQogICAgICAgIGlzQ29uZmxpY3QgPSB0cnVlOw0KICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlzQ29uZmxpY3QpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50LmNvbmZsaWN0ID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50LmNvbmZsaWN0UmVhc29uID0gYCR7cHJldi5wcm9jZWR1cmV9PGJyPuKAoiBC4buHbmggbmjDom46ICR7cHJldi5wYXRpZW50TmFtZX08YnI+4oCiIE5nw6B5OiAke3ByZXYuZGF0ZX08YnI+4oCiIFRo4budaSBnaWFuOiAke3ByZXYuZGlzcGxheVN0YXJ0fS0ke3ByZXYuZGlzcGxheUVuZH1gOw0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJldi5jb25mbGljdCA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFwcmV2LmNvbmZsaWN0UmVhc29uLmluY2x1ZGVzKGN1cnJlbnQucHJvY2VkdXJlKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmV2LmNvbmZsaWN0UmVhc29uICs9IChwcmV2LmNvbmZsaWN0UmVhc29uID8gJzxicj48YnI+JyA6ICcnKSArIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYCAke2N1cnJlbnQucHJvY2VkdXJlfTxicj7igKIgQuG7h25oIG5ow6JuOiAke2N1cnJlbnQucGF0aWVudE5hbWV9PGJyPuKAoiBOZ8OgeTogJHtjdXJyZW50LmRhdGV9PGJyPuKAoiBUaOG7nWkgZ2lhbjogJHtjdXJyZW50LmRpc3BsYXlTdGFydH0tJHtjdXJyZW50LmRpc3BsYXlFbmR9YDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9KTsNCiAgICAgICAgfQ0KDQpmdW5jdGlvbiBnZW5lcmF0ZVRpbWVTdWdnZXN0aW9ucyhwcm9jZWR1cmVzKSB7DQogICAgY29uc3QgdGltZU9wdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2lucHV0W25hbWU9InRpbWVPcHRpb24iXTpjaGVja2VkJykudmFsdWU7DQogICAgY29uc3Qgc3RhcnRIb3VyID0gdGltZU9wdGlvbiA9PT0gJzc6MzAnID8gNy41IDogNzsNCiAgICBjb25zdCBpZ25vcmVBZGphY2VudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdpZ25vcmVBZGphY2VudENoZWNrYm94JykuY2hlY2tlZDsNCiAgICBjb25zdCBidWZmZXJNaW51dGVzID0gaWdub3JlQWRqYWNlbnQgPyAwIDogMTsNCiAgICBjb25zdCBzaG93TW9yZVN1Z2dlc3Rpb25zID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Nob3dNb3JlU3VnZ2VzdGlvbnNDaGVja2JveCcpLmNoZWNrZWQ7DQogICAgDQogICAgLy8gU+G7kSBraHVuZyBnaeG7nSB04buRaSDEkWEgbeG7l2kgYnXhu5VpIChu4bq/dSBjaOG7jW4gNiBraHVuZyB0aMOsIDMgc8OhbmcgKyAzIGNoaeG7gXUpDQogICAgY29uc3QgbWF4TW9ybmluZyA9IHNob3dNb3JlU3VnZ2VzdGlvbnMgPyAzIDogMjsNCiAgICBjb25zdCBtYXhBZnRlcm5vb24gPSBzaG93TW9yZVN1Z2dlc3Rpb25zID8gMyA6IDE7DQoNCiAgICBwcm9jZWR1cmVzLmZvckVhY2gocHJvYyA9PiB7DQogICAgICAgIGlmICghcHJvYy5jb25mbGljdCkgcmV0dXJuOw0KDQogICAgICAgIGNvbnN0IHNhbWVEYXlQcm9jZWR1cmVzID0gcHJvY2VkdXJlcy5maWx0ZXIocCA9PiANCiAgICAgICAgICAgIHAuZGF0ZSA9PT0gcHJvYy5kYXRlICYmIA0KICAgICAgICAgICAgcC5vcGVyYXRvciA9PT0gcHJvYy5vcGVyYXRvciAmJg0KICAgICAgICAgICAgcC5yb3dJbmRleCAhPT0gcHJvYy5yb3dJbmRleA0KICAgICAgICApOw0KDQogICAgICAgIGNvbnN0IGR1cmF0aW9uU2Vjb25kcyA9IHByb2MuZW5kIC0gcHJvYy5zdGFydCArIChidWZmZXJNaW51dGVzICogNjApOw0KICAgICAgICANCiAgICAgICAgLy8gVMOsbSBraHVuZyBnaeG7nSBideG7lWkgc8OhbmcNCiAgICAgICAgY29uc3QgbW9ybmluZ1Nsb3RzID0gZmluZEF2YWlsYWJsZVNsb3RzKA0KICAgICAgICAgICAgc3RhcnRIb3VyICogMzYwMCwgDQogICAgICAgICAgICAxMS41ICogMzYwMCwgDQogICAgICAgICAgICBkdXJhdGlvblNlY29uZHMsIA0KICAgICAgICAgICAgc2FtZURheVByb2NlZHVyZXMsIA0KICAgICAgICAgICAgbWF4TW9ybmluZw0KICAgICAgICApOw0KICAgICAgICANCiAgICAgICAgLy8gVMOsbSBraHVuZyBnaeG7nSBideG7lWkgY2hp4buBdQ0KICAgICAgICBjb25zdCBhZnRlcm5vb25TbG90cyA9IGZpbmRBdmFpbGFibGVTbG90cygNCiAgICAgICAgICAgIDEzLjUgKiAzNjAwLCANCiAgICAgICAgICAgIDE3ICogMzYwMCwgDQogICAgICAgICAgICBkdXJhdGlvblNlY29uZHMsIA0KICAgICAgICAgICAgc2FtZURheVByb2NlZHVyZXMsIA0KICAgICAgICAgICAgbWF4QWZ0ZXJub29uDQogICAgICAgICk7DQoNCiAgICAgICAgLy8gRm9ybWF0IGvhur90IHF14bqjDQogICAgICAgIGxldCBzdWdnZXN0aW9ucyA9IFtdOw0KICAgICAgICBpZiAobW9ybmluZ1Nsb3RzLmxlbmd0aCA+IDApIHsNCiAgICAgICAgICAgIHN1Z2dlc3Rpb25zLnB1c2goJzxzdHJvbmc+U8Ohbmc6PC9zdHJvbmc+PGJyPicgKyANCiAgICAgICAgICAgICAgICBtb3JuaW5nU2xvdHMubWFwKHNsb3QgPT4gYCR7c2xvdC5zdGFydH0gLSAke3Nsb3QuZW5kfWApLmpvaW4oJzxicj4nKSk7DQogICAgICAgIH0NCiAgICAgICAgaWYgKGFmdGVybm9vblNsb3RzLmxlbmd0aCA+IDApIHsNCiAgICAgICAgICAgIHN1Z2dlc3Rpb25zLnB1c2goJzxzdHJvbmc+Q2hp4buBdTo8L3N0cm9uZz48YnI+JyArIA0KICAgICAgICAgICAgICAgIGFmdGVybm9vblNsb3RzLm1hcChzbG90ID0+IGAke3Nsb3Quc3RhcnR9IC0gJHtzbG90LmVuZH1gKS5qb2luKCc8YnI+JykpOw0KICAgICAgICB9DQoNCiAgICAgICAgDQppZiAobW9ybmluZ1Nsb3RzLmxlbmd0aCArIGFmdGVybm9vblNsb3RzLmxlbmd0aCA+IDApIHsNCiAgICBjb25zdCBmaXJzdFNsb3QgPSBtb3JuaW5nU2xvdHNbMF0gfHwgYWZ0ZXJub29uU2xvdHNbMF07DQogICAgY29uc3Qgc21hcnRIaW50ID0gYDxicj48ZGl2IHN0eWxlPSJtYXJnaW4tdG9wOjZweDtjb2xvcjojMDA3OTZiO2ZvbnQtd2VpZ2h0OjYwMCI+DQogICAg8J+RiSBH4bujaSDDvTogROG7nWkgdOG7qyA8dT4ke3Byb2MuZGlzcGxheVN0YXJ0fTwvdT4g4oaSIDx1PiR7Zmlyc3RTbG90LnN0YXJ0fTwvdT4NCiAgICA8L2Rpdj5gOw0KDQogICAgcHJvYy5zdWdnZXN0aW9uID0gc3VnZ2VzdGlvbnMuam9pbignPGJyPicpICsgc21hcnRIaW50Ow0KfSBlbHNlIHsNCiAgICBwcm9jLnN1Z2dlc3Rpb24gPSAnPHNwYW4gY2xhc3M9Im5vLXN1Z2dlc3Rpb24iPktow7RuZyBjw7Mga2h1bmcgZ2nhu50gdHLhu5FuZzwvc3Bhbj4nOw0KfQ0KDQogICAgfSk7DQp9DQovLyBIw6BtIGtp4buDbSB0cmEgeHVuZyDEkeG7mXQgdGjhu51pIGdpYW4NCmZ1bmN0aW9uIGhhc1RpbWVDb25mbGljdChzdGFydFRpbWUsIGR1cmF0aW9uLCBwcm9jZWR1cmVzKSB7DQogICAgY29uc3QgZW5kVGltZSA9IHN0YXJ0VGltZSArIGR1cmF0aW9uOw0KICAgIA0KICAgIGZvciAoY29uc3QgcHJvYyBvZiBwcm9jZWR1cmVzKSB7DQogICAgICAgIGNvbnN0IHByb2NTdGFydCA9IHByb2Muc3RhcnQ7DQogICAgICAgIGNvbnN0IHByb2NFbmQgPSBwcm9jLmVuZCArIChwcm9jLnByb2NlZHVyZUluZm8/LmJ1ZmZlciB8fCAwKSAqIDYwOw0KICAgICAgICANCiAgICAgICAgaWYgKChzdGFydFRpbWUgPj0gcHJvY1N0YXJ0ICYmIHN0YXJ0VGltZSA8IHByb2NFbmQpIHx8IA0KICAgICAgICAgICAgKGVuZFRpbWUgPiBwcm9jU3RhcnQgJiYgZW5kVGltZSA8PSBwcm9jRW5kKSB8fA0KICAgICAgICAgICAgKHN0YXJ0VGltZSA8PSBwcm9jU3RhcnQgJiYgZW5kVGltZSA+PSBwcm9jRW5kKSkgew0KICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgIH0NCiAgICB9DQogICAgDQogICAgcmV0dXJuIGZhbHNlOw0KfQ0KLy8gSMOgbSB0w6xtIGtodW5nIGdp4budIHRy4buRbmcNCmZ1bmN0aW9uIGZpbmRBdmFpbGFibGVTbG90cyhzdGFydFRpbWUsIGVuZFRpbWUsIGR1cmF0aW9uLCBwcm9jZWR1cmVzLCBtYXhTbG90cykgew0KICAgIGNvbnN0IHNsb3RzID0gW107DQogICAgbGV0IGN1cnJlbnRUaW1lID0gc3RhcnRUaW1lOw0KICAgIGNvbnN0IGlnbm9yZUFkamFjZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2lnbm9yZUFkamFjZW50Q2hlY2tib3gnKS5jaGVja2VkOw0KICAgIGNvbnN0IGJ1ZmZlck1pbnV0ZXMgPSBpZ25vcmVBZGphY2VudCA/IDAgOiAxOw0KICAgIA0KICAgIHdoaWxlIChjdXJyZW50VGltZSArIGR1cmF0aW9uIDw9IGVuZFRpbWUgJiYgc2xvdHMubGVuZ3RoIDwgbWF4U2xvdHMpIHsNCiAgICAgICAgaWYgKCFoYXNUaW1lQ29uZmxpY3QoY3VycmVudFRpbWUsIGR1cmF0aW9uLCBwcm9jZWR1cmVzKSkgew0KICAgICAgICAgICAgc2xvdHMucHVzaCh7DQogICAgICAgICAgICAgICAgc3RhcnQ6IHNlY29uZHNUb1RpbWVTdHIoY3VycmVudFRpbWUpLA0KICAgICAgICAgICAgICAgIGVuZDogc2Vjb25kc1RvVGltZVN0cihjdXJyZW50VGltZSArIChkdXJhdGlvbiAtIChidWZmZXJNaW51dGVzICogNjApKSkgLy8gVHLhu6sgYnVmZmVyIMSR4buDIGhp4buDbiB0aOG7iw0KICAgICAgICAgICAgfSk7DQogICAgICAgIH0NCiAgICAgICAgY3VycmVudFRpbWUgKz0gMTUgKiA2MDsgLy8gS2nhu4NtIHRyYSBt4buXaSAxNSBwaMO6dA0KICAgIH0NCiAgICANCiAgICByZXR1cm4gc2xvdHM7DQp9DQoNCiAgICAgICAgZnVuY3Rpb24gc2Vjb25kc1RvVGltZVN0cihzZWNvbmRzKSB7DQogICAgICAgICAgICBjb25zdCBob3VycyA9IE1hdGguZmxvb3Ioc2Vjb25kcyAvIDM2MDApOw0KICAgICAgICAgICAgY29uc3QgbWludXRlcyA9IE1hdGguZmxvb3IoKHNlY29uZHMgJSAzNjAwKSAvIDYwKTsNCiAgICAgICAgICAgIHJldHVybiBgJHtob3Vycy50b1N0cmluZygpLnBhZFN0YXJ0KDIsICcwJyl9OiR7bWludXRlcy50b1N0cmluZygpLnBhZFN0YXJ0KDIsICcwJyl9YDsNCiAgICAgICAgfQ0KDQogICAgICAgZnVuY3Rpb24gZGlzcGxheVJlc3VsdHMocHJvY2VkdXJlcywgc2tpcHBlZFJvd3MgPSAwKSB7DQogICAgYWxsUHJvY2VkdXJlcyA9IHByb2NlZHVyZXM7DQogICAgDQogICAgY29uc3Qgb3BlcmF0b3JzID0gWy4uLm5ldyBTZXQocHJvY2VkdXJlcy5tYXAocCA9PiBwLm9wZXJhdG9yKSldOw0KICAgIGNvbnN0IG9wZXJhdG9yU2VsZWN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ29wZXJhdG9yU2VsZWN0Jyk7DQogICAgY29uc3Qgb3BlcmF0b3JTZWxlY3RFcnJvciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdvcGVyYXRvclNlbGVjdEVycm9yJyk7DQogICAgDQogICAgb3BlcmF0b3JTZWxlY3QuaW5uZXJIVE1MID0gJzxvcHRpb24gdmFsdWU9ImFsbCI+VOG6pXQgY+G6ozwvb3B0aW9uPicgKyANCiAgICAgICAgb3BlcmF0b3JzLm1hcChvcCA9PiBgPG9wdGlvbiB2YWx1ZT0iJHtvcH0iPiR7b3AucmVwbGFjZSgvLC9nLCAnJyl9PC9vcHRpb24+YCkuam9pbignJyk7DQogICAgDQogICAgb3BlcmF0b3JTZWxlY3RFcnJvci5pbm5lckhUTUwgPSBvcGVyYXRvclNlbGVjdC5pbm5lckhUTUw7IC8vIMSQ4buTbmcgYuG7mSBu4buZaSBkdW5nDQogICAgDQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ29wZXJhdG9yRmlsdGVyJykuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7DQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ29wZXJhdG9yRmlsdGVyRXJyb3InKS5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgY29uc3QgY29uZmxpY3RQcm9jZWR1cmVzID0gcHJvY2VkdXJlcy5maWx0ZXIocCA9PiBwLmNvbmZsaWN0KTsNCiAgICAgICAgICAgIGNvbnN0IGNvbmZsaWN0Q291bnQgPSBjb25mbGljdFByb2NlZHVyZXMubGVuZ3RoOw0KICAgICAgICAgICAgDQogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc3VtbWFyeScpLmlubmVySFRNTCA9IGANCiAgICAgICAgICAgICAgICA8cD5U4buVbmcgc+G7kSBkw7JuZyDEkcOjIHjhu60gbMO9OiA8c3Ryb25nPiR7cHJvY2VkdXJlcy5sZW5ndGggKyBza2lwcGVkUm93c308L3N0cm9uZz4gDQogICAgICAgICAgICAgICAgICB8fCBT4buRIGTDsm5nIGPDsyB4dW5nIMSR4buZdDogPHN0cm9uZz4ke2NvbmZsaWN0Q291bnR9PC9zdHJvbmc+PC9wPiA8YnIvPg0KICAgICAgICAgICAgICAgDQogICAgICAgICAgICBgOw0KICAgICAgICAgICAgDQogICAgICAgICAgICBmaWx0ZXJCeU9wZXJhdG9yKCk7DQogICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlc3VsdFNlY3Rpb24nKS5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsNCiAgICANCiAgICAvLyBO4bq/dSBraMO0bmcgY8OzIGzhu5dpLCBjdeG7mW4geHXhu5FuZyBwaOG6p24ga+G6v3QgcXXhuqMNCiAgICBpZiAoZXJyb3JMb2cubGVuZ3RoID09PSAwKSB7DQogICAgICAgIHNldFRpbWVvdXQoKCkgPT4gew0KICAgICAgICAgICAgY29uc3QgcmVzdWx0U2VjdGlvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN1bHRTZWN0aW9uJyk7DQogICAgICAgICAgICBpZiAocmVzdWx0U2VjdGlvbikgew0KICAgICAgICAgICAgICAgIHNtb290aFNjcm9sbFRvKHJlc3VsdFNlY3Rpb24sIC00MCk7DQogICAgICAgICAgICB9DQogICAgICAgIH0sIDMwMCk7DQogICAgfQ0KfQ0KDQpmdW5jdGlvbiBmaWx0ZXJCeU9wZXJhdG9yKCkgew0KICAgIGNvbnN0IG9wZXJhdG9yID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ29wZXJhdG9yU2VsZWN0JykudmFsdWU7DQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ29wZXJhdG9yU2VsZWN0RXJyb3InKS52YWx1ZSA9IG9wZXJhdG9yOyAvLyDEkOG7k25nIGLhu5kgZ2nDoSB0cuG7iyBkcm9wZG93biBs4buXaQ0KIGNvbnN0IHNob3dEb2N0b3IgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2hvd0RvY3RvckNoZWNrYm94JykuY2hlY2tlZDsNCiAgICBkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC50b2dnbGUoJ3Nob3ctZG9jdG9yJywgc2hvd0RvY3Rvcik7DQogICAgLy8gPT09PT0gMS4gTOG7jEMgVsOAIEhJ4buCTiBUSOG7iiBC4bqiTkcgS+G6vlQgUVXhuqIgS0nhu4JNIFRSQSBYVU5HIMSQ4buYVCA9PT09PQ0KICAgIGNvbnN0IGZpbHRlcmVkUHJvY2VkdXJlcyA9IG9wZXJhdG9yID09PSAnYWxsJyANCiAgICAgICAgPyBhbGxQcm9jZWR1cmVzLmZpbHRlcihwID0+IHAuY29uZmxpY3QpIA0KICAgICAgICA6IGFsbFByb2NlZHVyZXMuZmlsdGVyKHAgPT4gcC5vcGVyYXRvci5yZXBsYWNlKC8sL2csICcnKSA9PT0gb3BlcmF0b3IucmVwbGFjZSgvLC9nLCAnJykgJiYgcC5jb25mbGljdCk7DQoNCiAgICBjb25zdCByZXN1bHRCb2R5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlc3VsdEJvZHknKTsNCiAgICByZXN1bHRCb2R5LmlubmVySFRNTCA9ICcnOw0KDQogICAgLy8gTmjDs20gY8OhYyB0aOG7pyB0aHXhuq10IHh1bmcgxJHhu5l0IHbhu5tpIG5oYXUNCiAgICBjb25zdCBjb25mbGljdEdyb3VwcyA9IFtdOw0KICAgIGNvbnN0IHByb2Nlc3NlZFJvd3MgPSBuZXcgU2V0KCk7DQoNCiAgICBmaWx0ZXJlZFByb2NlZHVyZXMuZm9yRWFjaChwcm9jID0+IHsNCiAgICAgICAgaWYgKCFwcm9jZXNzZWRSb3dzLmhhcyhwcm9jLnJvd0luZGV4KSkgew0KICAgICAgICAgICAgY29uc3QgZ3JvdXAgPSBbcHJvY107DQogICAgICAgICAgICBwcm9jZXNzZWRSb3dzLmFkZChwcm9jLnJvd0luZGV4KTsNCg0KICAgICAgICAgICAgLy8gVMOsbSB0aOG7pyB0aHXhuq10IGxpw6puIHF1YW4gdHJvbmcgeHVuZyDEkeG7mXQNCiAgICAgICAgICAgIGlmIChwcm9jLmNvbmZsaWN0UmVhc29uKSB7DQogICAgICAgICAgICAgICAgY29uc3QgY29uZmxpY3RNYXRjaGVzID0gcHJvYy5jb25mbGljdFJlYXNvbi5tYXRjaCgvQuG7h25oIG5ow6JuOiAoLio/KTxicj7igKIgTmfDoHk6ICguKj8pPGJyPuKAoiBUaOG7nWkgZ2lhbjogKC4qPyktL2cpOw0KICAgICAgICAgICAgICAgIGlmIChjb25mbGljdE1hdGNoZXMpIHsNCiAgICAgICAgICAgICAgICAgICAgY29uZmxpY3RNYXRjaGVzLmZvckVhY2gobWF0Y2ggPT4gew0KICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcGF0aWVudE5hbWUgPSBtYXRjaC5tYXRjaCgvQuG7h25oIG5ow6JuOiAoLio/KTxicj4vKVsxXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGRhdGUgPSBtYXRjaC5tYXRjaCgvTmfDoHk6ICguKj8pPGJyPi8pWzFdOw0KICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdGltZSA9IG1hdGNoLm1hdGNoKC9UaOG7nWkgZ2lhbjogKC4qPyktLylbMV07DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNvbmZsaWN0UHJvYyA9IGZpbHRlcmVkUHJvY2VkdXJlcy5maW5kKHAgPT4gDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcC5wYXRpZW50TmFtZSA9PT0gcGF0aWVudE5hbWUgJiYgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcC5kYXRlID09PSBkYXRlICYmIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHAuZGlzcGxheVN0YXJ0ID09PSB0aW1lICYmDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgIXByb2Nlc3NlZFJvd3MuaGFzKHAucm93SW5kZXgpDQogICAgICAgICAgICAgICAgICAgICAgICApOw0KDQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoY29uZmxpY3RQcm9jKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZ3JvdXAucHVzaChjb25mbGljdFByb2MpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2Nlc3NlZFJvd3MuYWRkKGNvbmZsaWN0UHJvYy5yb3dJbmRleCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGNvbmZsaWN0R3JvdXBzLnB1c2goZ3JvdXApOw0KICAgICAgICB9DQogICAgfSk7DQoNCiAgICAvLyBIaeG7g24gdGjhu4sga+G6v3QgcXXhuqMNCiAgICBjb25mbGljdEdyb3Vwcy5mb3JFYWNoKGdyb3VwID0+IHsNCiAgICAgICAgZ3JvdXAuZm9yRWFjaChwcm9jID0+IHsNCiAgICAgICAgICAgIGNvbnN0IHJvdyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RyJyk7DQogICAgICAgIHJvdy5jbGFzc0xpc3QuYWRkKCJoZXJiLXJvdyIpOw0KICAgICAgICAgICAgcm93LmNsYXNzTGlzdC5hZGQoJ2NvbmZsaWN0LXJvdycpOw0KICAgICAgICAgICAgcm93LmlubmVySFRNTCA9IGANCiAgICAgICAgICAgICAgICA8dGQ+JHtwcm9jLnBhdGllbnROYW1lfSA8YnIvPiAke3Byb2MucGF0aWVudElkfTwvdGQ+DQogICAgICAgICAgICAgICAgPHRkPiR7cHJvYy5wcm9jZWR1cmV9PC90ZD4NCiAgICAgICAgICAgICAgICA8dGQ+PGNlbnRlcj4ke3Byb2MuZGF0ZX08YnIvPiR7cHJvYy5kaXNwbGF5U3RhcnR9IC0gJHtwcm9jLmRpc3BsYXlFbmR9PC9jZW50ZXI+PC90ZD4NCgkJCQkgIDx0ZCBjbGFzcz0iZG9jdG9yLWNvbHVtbiI+JHtwcm9jLmRvY3Rvcn08L3RkPg0KICAgICAgICAgICAgICAgIDx0ZD4ke3Byb2Mub3BlcmF0b3IucmVwbGFjZSgvLC9nLCAnJyl9PC90ZD4NCiAgICAgICAgICAgICAgICA8dGQgY2xhc3M9InRpbWUtc3VnZ2VzdGlvbiI+JHtwcm9jLnN1Z2dlc3Rpb24gfHwgJ0tow7RuZyBjw7MgeHVuZyDEkeG7mXQnfTwvdGQ+DQogICAgICAgICAgICBgOw0KICAgICAgICAgICAgcmVzdWx0Qm9keS5hcHBlbmRDaGlsZChyb3cpOw0KICAgICAgICB9KTsNCg0KICAgICAgICAvLyBUaMOqbSBkw7JuZyBwaMOibiBjw6FjaA0KICAgICAgICBpZiAoZ3JvdXAubGVuZ3RoID4gMCkgew0KICAgICAgICAgICAgY29uc3Qgc2VwYXJhdG9yID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndHInKTsNCiAgICAgICAgICAgIHNlcGFyYXRvci5pbm5lckhUTUwgPSAnPHRkIGNvbHNwYW49IjgiIGNsYXNzPSJncm91cC1zZXBhcmF0b3IiPjwvdGQ+JzsNCiAgICAgICAgICAgIHJlc3VsdEJvZHkuYXBwZW5kQ2hpbGQoc2VwYXJhdG9yKTsNCiAgICAgICAgfQ0KICAgIH0pOw0KDQogICAgLy8gPT09PT0gMi4gTOG7jEMgVsOAIEhJ4buCTiBUSOG7iiBC4bqiTkcgTOG7lkkgPT09PT0NCiAgICBjb25zdCBmaWx0ZXJlZEVycm9ycyA9IG9wZXJhdG9yID09PSAnYWxsJyANCiAgICAgICAgPyBlcnJvckxvZyANCiAgICAgICAgOiBlcnJvckxvZy5maWx0ZXIoZXJyb3IgPT4gDQogICAgICAgICAgICBlcnJvci5kZXRhaWxzICYmIA0KICAgICAgICAgICAgZXJyb3IuZGV0YWlscy5vcGVyYXRvciAmJiANCiAgICAgICAgICAgIGVycm9yLmRldGFpbHMub3BlcmF0b3IucmVwbGFjZSgvLC9nLCAnJykgPT09IG9wZXJhdG9yLnJlcGxhY2UoLywvZywgJycpDQogICAgICAgICk7DQoNCiAgICAvLyBIaeG7g24gdGjhu4sgbOG7l2kgxJHDoyBs4buNYw0KICAgIGNvbnN0IGVycm9yTG9nRGl2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Vycm9yTG9nJyk7DQogICAgaWYgKGZpbHRlcmVkRXJyb3JzLmxlbmd0aCA9PT0gMCkgew0KICAgICAgICBlcnJvckxvZ0Rpdi5pbm5lckhUTUwgPSAnPHA+S2jDtG5nIGPDsyBs4buXaSBuw6BvIMSRxrDhu6NjIGdoaSBuaOG6rW48L3A+JzsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCg0KICAgIGxldCBodG1sID0gYA0KICAgIDx0YWJsZSBjbGFzcz0iZXJyb3ItdGFibGUiPg0KICAgICAgICA8dGhlYWQ+DQogICAgICAgICAgICA8dHI+DQogICAgICAgICAgICAgIDx0aD48aSBjbGFzcz0iZmFzIGZhLXVzZXIgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IFTDqm4gQk48L3RoPg0KICAgICAgICAgICAgPHRoPjxpIGNsYXNzPSJmYXMgZmEtcHJvY2VkdXJlcyBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gVGjhu6cgdGh14bqtdDwvdGg+DQogICAgICAgICAgICA8dGggY2xhc3M9ImRvY3Rvci1jb2x1bW4iPjxpIGNsYXNzPSJmYXMgZmEtdXNlci1tZCBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gQsOhYyBz4bu5IGNo4buJIMSR4buLbmg8L3RoPg0KICAgICAgICAgICAgPHRoPjxpIGNsYXNzPSJmYXMgZmEtdXNlci1udXJzZSBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gTmfGsOG7nWkgdGjhu7FjIGhp4buHbjwvdGg+DQogICAgICAgICAgICA8dGg+PGkgY2xhc3M9ImZhciBmYS1jbG9jayBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gVGjhu51pIGdpYW48L3RoPg0KICAgICAgICAgICAgPHRoPjxpIGNsYXNzPSJmYXMgZmEtZXhjbGFtYXRpb24tdHJpYW5nbGUgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IEzhu5dpPC90aD4NCiAgICAgICAgICAgIDwvdHI+DQogICAgICAgIDwvdGhlYWQ+DQogICAgICAgIDx0Ym9keT5gOw0KDQogICAgZmlsdGVyZWRFcnJvcnMuZm9yRWFjaChlcnJvciA9PiB7DQogICAgICAgIGlmIChlcnJvci5kZXRhaWxzKSB7DQogICAgICAgICAgICBodG1sICs9IGANCiAgICAgICAgICAgIDx0ciBjbGFzcz0iZXJyb3Itcm93Ij4NCiAgICAgICAgICAgICAgICA8dGQ+JHtlcnJvci5kZXRhaWxzLnBhdGllbnROYW1lIHx8ICdLaMO0bmcgY8OzJ308L3RkPg0KICAgICAgICAgICAgICAgIDx0ZD4ke2Vycm9yLmRldGFpbHMucHJvY2VkdXJlIHx8ICdLaMO0bmcgY8OzJ308L3RkPg0KCQkJCTx0ZCBjbGFzcz0iZG9jdG9yLWNvbHVtbiI+JHtlcnJvci5kZXRhaWxzLmRvY3RvciB8fCAnS2jDtG5nIGPDsyd9PC90ZD4NCiAgICAgICAgICAgICAgICA8dGQ+JHtlcnJvci5kZXRhaWxzLm9wZXJhdG9yID8gZXJyb3IuZGV0YWlscy5vcGVyYXRvci5yZXBsYWNlKC8sL2csICcnKSA6ICdLaMO0bmcgY8OzJ308L3RkPg0KICAgICAgICAgICAgICAgIDx0ZD48Y2VudGVyPiR7ZXJyb3IuZGV0YWlscy5uZ2F5VGh1Y0hpZW4gfHwgKGVycm9yLmRldGFpbHMuZGF0ZSB8fCAnS2jDtG5nIGPDsycpfSA8YnIvPiR7DQogICAgICAgICAgICAgICAgICAgIGVycm9yLmRldGFpbHMuc3RhcnRUaW1lID8gYCR7ZXJyb3IuZGV0YWlscy5zdGFydFRpbWV9IC0gJHtlcnJvci5kZXRhaWxzLmVuZFRpbWV9YCA6ICdLaMO0bmcgY8OzJw0KICAgICAgICAgICAgICAgIH08L2NlbnRlcj48L3RkPg0KICAgICAgICAgICAgICAgIDx0ZCBjbGFzcz0iZXJyb3ItZGV0YWlsIj4NCiAgICAgICAgICAgICAgICAgICAgJHtlcnJvci5tZXNzYWdlfQ0KICAgICAgICAgICAgICAgICAgICAke2Vycm9yLmRldGFpbHMuZXhwZWN0ZWQgPyBgJHtlcnJvci5kZXRhaWxzLmFjdHVhbH0gcGjDunQgKFF1eSDEkeG7i25oOiAke2Vycm9yLmRldGFpbHMuZXhwZWN0ZWR9IHBow7p0KWAgOiAnJ30NCiAgICAgICAgICAgICAgICA8L3RkPg0KICAgICAgICAgICAgPC90cj5gOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgaHRtbCArPSBgDQogICAgICAgICAgICA8dHIgY2xhc3M9ImVycm9yLXJvdyI+DQogICAgICAgICAgICAgICAgPHRkIGNvbHNwYW49IjUiIGNsYXNzPSJlcnJvci1kZXRhaWwiPg0KICAgICAgICAgICAgICAgICAgICAke2Vycm9yLm1lc3NhZ2V9ICR7ZXJyb3Iucm93ID8gJyhEw7JuZyAnICsgZXJyb3Iucm93ICsgJyknIDogJyd9DQogICAgICAgICAgICAgICAgPC90ZD4NCiAgICAgICAgICAgIDwvdHI+YDsNCiAgICAgICAgfQ0KICAgIH0pOw0KDQogICAgaHRtbCArPSBgPC90Ym9keT48L3RhYmxlPmA7DQogICAgZXJyb3JMb2dEaXYuaW5uZXJIVE1MID0gaHRtbDsNCn0NCg0KZnVuY3Rpb24gZGlzcGxheUZpbHRlcmVkRXJyb3JzKGZpbHRlcmVkRXJyb3JzKSB7DQogICAgY29uc3QgZXJyb3JMb2dEaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZXJyb3JMb2cnKTsNCiAgICANCiAgICBpZiAoZmlsdGVyZWRFcnJvcnMubGVuZ3RoID09PSAwKSB7DQogICAgICAgIGVycm9yTG9nRGl2LmlubmVySFRNTCA9ICc8cD5LaMO0bmcgY8OzIGzhu5dpIG7DoG8gxJHGsOG7o2MgZ2hpIG5o4bqtbjwvcD4nOw0KICAgICAgICByZXR1cm47DQogICAgfQ0KICAgIA0KICAgIGxldCBodG1sID0gYA0KICAgIDx0YWJsZSBjbGFzcz0iZXJyb3ItdGFibGUiPg0KICAgICAgICA8dGhlYWQ+DQogICAgICAgICAgICA8dHI+DQogICAgICAgICAgICAgICA8dGg+PGkgY2xhc3M9ImZhcyBmYS11c2VyIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBUw6puIEJOPC90aD4NCiAgICAgICAgICAgIDx0aD48aSBjbGFzcz0iZmFzIGZhLXByb2NlZHVyZXMgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IFRo4bunIHRodeG6rXQ8L3RoPg0KICAgICAgICAgICAgPHRoIGNsYXNzPSJkb2N0b3ItY29sdW1uIj48aSBjbGFzcz0iZmFzIGZhLXVzZXItbWQgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IELDoWMgc+G7uSBjaOG7iSDEkeG7i25oPC90aD4NCiAgICAgICAgICAgIDx0aD48aSBjbGFzcz0iZmFzIGZhLXVzZXItbnVyc2UgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IE5nxrDhu51pIHRo4buxYyBoaeG7h248L3RoPg0KICAgICAgICAgICAgPHRoPjxpIGNsYXNzPSJmYXIgZmEtY2xvY2sgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IFRo4budaSBnaWFuPC90aD4NCiAgICAgICAgICAgIDx0aD48aSBjbGFzcz0iZmFzIGZhLWV4Y2xhbWF0aW9uLXRyaWFuZ2xlIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBM4buXaTwvdGg+DQogICAgICAgICAgICA8L3RyPg0KICAgICAgICA8L3RoZWFkPg0KICAgICAgICA8dGJvZHk+YDsNCiAgICANCiAgICBmaWx0ZXJlZEVycm9ycy5mb3JFYWNoKGVycm9yID0+IHsNCiAgICAgICAgaWYgKGVycm9yLmRldGFpbHMpIHsNCiAgICAgICAgICAgIGh0bWwgKz0gYA0KICAgICAgICAgICAgPHRyIGNsYXNzPSJlcnJvci1yb3ciPg0KICAgICAgICAgICAgICAgIDx0ZD4ke2Vycm9yLmRldGFpbHMucGF0aWVudE5hbWUgfHwgJ0tow7RuZyBjw7MnfTwvdGQ+DQogICAgICAgICAgICAgICAgPHRkPiR7ZXJyb3IuZGV0YWlscy5wcm9jZWR1cmUgfHwgJ0tow7RuZyBjw7MnfTwvdGQ+DQogICAgICAgICAgICAgICAgPHRkPiR7ZXJyb3IuZGV0YWlscy5vcGVyYXRvciA/IGVycm9yLmRldGFpbHMub3BlcmF0b3IucmVwbGFjZSgvLC9nLCAnJykgOiAnS2jDtG5nIGPDsyd9PC90ZD4NCiAgICAgICAgICAgICAgICA8dGQ+PGNlbnRlcj4ke2Vycm9yLmRldGFpbHMubmdheVRodWNIaWVuIHx8IChlcnJvci5kZXRhaWxzLmRhdGUgfHwgJ0tow7RuZyBjw7MnKX0gPGJyLz4ke2Vycm9yLmRldGFpbHMuc3RhcnRUaW1lID8gYCR7ZXJyb3IuZGV0YWlscy5zdGFydFRpbWV9IC0gJHtlcnJvci5kZXRhaWxzLmVuZFRpbWV9YCA6ICdLaMO0bmcgY8OzJ308L2NlbnRlcj48L3RkPg0KICAgICAgICAgICAgICAgIDx0ZCBjbGFzcz0iZXJyb3ItZGV0YWlsIj4NCiAgICAgICAgICAgICAgICAgICAgJHtlcnJvci5tZXNzYWdlfQ0KICAgICAgICAgICAgICAgICAgICAke2Vycm9yLmRldGFpbHMuZXhwZWN0ZWQgPyBgJHtlcnJvci5kZXRhaWxzLmFjdHVhbH0gcGjDunQgICAoUXV5IMSR4buLbmg6ICR7ZXJyb3IuZGV0YWlscy5leHBlY3RlZH0gcGjDunQpYCA6ICcnfQ0KICAgICAgICAgICAgICAgIDwvdGQ+DQogICAgICAgICAgICA8L3RyPmA7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICBodG1sICs9IGANCiAgICAgICAgICAgIDx0ciBjbGFzcz0iZXJyb3Itcm93Ij4NCiAgICAgICAgICAgICAgICA8dGQgY29sc3Bhbj0iNiIgY2xhc3M9ImVycm9yLWRldGFpbCI+DQogICAgICAgICAgICAgICAgICAgICR7ZXJyb3IubWVzc2FnZX0gJHtlcnJvci5yb3cgPyAnKETDsm5nICcgKyBlcnJvci5yb3cgKyAnKScgOiAnJ30NCiAgICAgICAgICAgICAgICA8L3RkPg0KICAgICAgICAgICAgPC90cj5gOw0KICAgICAgICB9DQogICAgfSk7DQogICAgDQogICAgaHRtbCArPSBgPC90Ym9keT48L3RhYmxlPmA7DQogICAgZXJyb3JMb2dEaXYuaW5uZXJIVE1MID0gaHRtbDsNCn0NCg0KICAgICAgICBmdW5jdGlvbiBsb2dFcnJvcihtZXNzYWdlLCByb3cgPSBudWxsLCBkZXRhaWxzID0gbnVsbCkgew0KICAgICAgICAgICAgZXJyb3JMb2cucHVzaCh7DQogICAgICAgICAgICAgICAgbWVzc2FnZSwNCiAgICAgICAgICAgICAgICByb3csDQogICAgICAgICAgICAgICAgZGV0YWlscywNCiAgICAgICAgICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9Mb2NhbGVUaW1lU3RyaW5nKCksDQogICAgICAgICAgICAgICAgdXNlcjogY3VycmVudFVzZXINCiAgICAgICAgICAgIH0pOw0KICAgICAgICB9DQoNCmZ1bmN0aW9uIGRpc3BsYXlFcnJvcnMoKSB7DQogICAgY29uc3QgZXJyb3JMb2dEaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZXJyb3JMb2cnKTsNCiAgICANCiAgICBpZiAoZXJyb3JMb2cubGVuZ3RoID09PSAwKSB7DQogICAgICAgIGVycm9yTG9nRGl2LmlubmVySFRNTCA9ICc8cD5LaMO0bmcgY8OzIGzhu5dpIG7DoG8gxJHGsOG7o2MgZ2hpIG5o4bqtbjwvcD4nOw0KICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZXJyb3JTZWN0aW9uJykuc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCiAgICAgICAgDQogICAgICAgIC8vIE7hur91IGtow7RuZyBjw7MgbOG7l2ksIGN14buZbiB4deG7kW5nIHBo4bqnbiBL4bq/dCBRdeG6oyBLaeG7g20gVHJhDQogICAgICAgIHNldFRpbWVvdXQoKCkgPT4gew0KICAgICAgICAgICAgY29uc3QgcmVzdWx0U2VjdGlvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN1bHRTZWN0aW9uJyk7DQogICAgICAgICAgICBpZiAocmVzdWx0U2VjdGlvbiAmJiByZXN1bHRTZWN0aW9uLnN0eWxlLmRpc3BsYXkgIT09ICdub25lJykgew0KICAgICAgICAgICAgICAgIHNtb290aFNjcm9sbFRvKHJlc3VsdFNlY3Rpb24sIC00MCk7DQogICAgICAgICAgICB9DQogICAgICAgIH0sIDMwMCk7DQogICAgICAgIHJldHVybjsNCiAgICB9DQogICAgDQogICAgbGV0IGh0bWwgPSBgDQogICAgPHRhYmxlIGNsYXNzPSJlcnJvci10YWJsZSI+DQogICAgICAgIDx0aGVhZD4NCiAgICAgICAgICAgIDx0cj4NCiAgICAgICAgICAgICA8dGg+PGkgY2xhc3M9ImZhcyBmYS11c2VyIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBUw6puIEJOPC90aD4NCiAgICAgICAgICAgIDx0aD48aSBjbGFzcz0iZmFzIGZhLXByb2NlZHVyZXMgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IFRo4bunIHRodeG6rXQ8L3RoPg0KICAgICAgICAgICAgPHRoIGNsYXNzPSJkb2N0b3ItY29sdW1uIj48aSBjbGFzcz0iZmFzIGZhLXVzZXItbWQgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IELDoWMgc+G7uSBjaOG7iSDEkeG7i25oPC90aD4NCiAgICAgICAgICAgIDx0aD48aSBjbGFzcz0iZmFzIGZhLXVzZXItbnVyc2UgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IE5nxrDhu51pIHRo4buxYyBoaeG7h248L3RoPg0KICAgICAgICAgICAgPHRoPjxpIGNsYXNzPSJmYXIgZmEtY2xvY2sgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IFRo4budaSBnaWFuPC90aD4NCiAgICAgICAgICAgIDx0aD48aSBjbGFzcz0iZmFzIGZhLWV4Y2xhbWF0aW9uLXRyaWFuZ2xlIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBM4buXaTwvdGg+DQogICAgICAgICAgICA8L3RyPg0KICAgICAgICA8L3RoZWFkPg0KICAgICAgICA8dGJvZHk+YDsNCiAgICANCiAgICAvLyBIaeG7g24gdGjhu4sgdOG7q25nIGzhu5dpDQogICAgZXJyb3JMb2cuZm9yRWFjaChlcnJvciA9PiB7DQogICAgICAgIGlmIChlcnJvci5kZXRhaWxzKSB7DQogICAgICAgICAgICBodG1sICs9IGANCiAgICAgICAgICAgIDx0ciBjbGFzcz0iZXJyb3Itcm93Ij4NCiAgICAgICAgICAgICAgICA8dGQ+JHtlcnJvci5kZXRhaWxzLnBhdGllbnROYW1lIHx8ICdLaMO0bmcgY8OzJ308L3RkPg0KICAgICAgICAgICAgICAgIDx0ZD4ke2Vycm9yLmRldGFpbHMucHJvY2VkdXJlIHx8ICdLaMO0bmcgY8OzJ308L3RkPg0KICAgICAgICAgICAgICAgIDx0ZCBjbGFzcz0iZG9jdG9yLWNvbHVtbiI+JHtlcnJvci5kZXRhaWxzLmRvY3RvciB8fCAnS2jDtG5nIGPDsyd9PC90ZD4NCiAgICAgICAgICAgICAgICA8dGQ+JHtlcnJvci5kZXRhaWxzLm9wZXJhdG9yID8gZXJyb3IuZGV0YWlscy5vcGVyYXRvci5yZXBsYWNlKC8sL2csICcnKSA6ICdLaMO0bmcgY8OzJ308L3RkPg0KICAgICAgICAgICAgICAgIDx0ZD48Y2VudGVyPiR7ZXJyb3IuZGV0YWlscy5uZ2F5VGh1Y0hpZW4gfHwgKGVycm9yLmRldGFpbHMuZGF0ZSB8fCAnS2jDtG5nIGPDsycpfSA8YnIvPiR7ZXJyb3IuZGV0YWlscy5zdGFydFRpbWUgPyBgJHtlcnJvci5kZXRhaWxzLnN0YXJ0VGltZX0gLSAke2Vycm9yLmRldGFpbHMuZW5kVGltZX1gIDogJ0tow7RuZyBjw7MnfTwvY2VudGVyPjwvdGQ+DQogICAgICAgICAgICAgICAgPHRkIGNsYXNzPSJlcnJvci1kZXRhaWwiPg0KICAgICAgICAgICAgICAgICAgICAke2Vycm9yLm1lc3NhZ2V9DQogICAgICAgICAgICAgICAgICAgICR7ZXJyb3IuZGV0YWlscy5leHBlY3RlZCA/IGAke2Vycm9yLmRldGFpbHMuYWN0dWFsfSBwaMO6dCAgIChRdXkgxJHhu4tuaDogJHtlcnJvci5kZXRhaWxzLmV4cGVjdGVkfSBwaMO6dClgIDogJyd9DQogICAgICAgICAgICAgICAgPC90ZD4NCiAgICAgICAgICAgIDwvdHI+YDsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIGh0bWwgKz0gYA0KICAgICAgICAgICAgPHRyIGNsYXNzPSJlcnJvci1yb3ciPg0KICAgICAgICAgICAgICAgIDx0ZCBjb2xzcGFuPSI2IiBjbGFzcz0iZXJyb3ItZGV0YWlsIj4NCiAgICAgICAgICAgICAgICAgICAgJHtlcnJvci5tZXNzYWdlfSAke2Vycm9yLnJvdyA/ICcoRMOybmcgJyArIGVycm9yLnJvdyArICcpJyA6ICcnfQ0KICAgICAgICAgICAgICAgIDwvdGQ+DQogICAgICAgICAgICA8L3RyPmA7DQogICAgICAgIH0NCiAgICB9KTsNCiAgICANCiAgICBodG1sICs9IGA8L3Rib2R5PjwvdGFibGU+YDsNCiAgICANCiAgICBlcnJvckxvZ0Rpdi5pbm5lckhUTUwgPSBodG1sOw0KICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Vycm9yU2VjdGlvbicpLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOw0KICAgIA0KICAgIC8vIEN14buZbiB4deG7kW5nIHBo4bqnbiBs4buXaSBu4bq/dSBjw7MNCiAgICBzZXRUaW1lb3V0KCgpID0+IHsNCiAgICAgICAgY29uc3QgZXJyb3JTZWN0aW9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Vycm9yU2VjdGlvbicpOw0KICAgICAgICBpZiAoZXJyb3JTZWN0aW9uKSB7DQogICAgICAgICAgICBzbW9vdGhTY3JvbGxUbyhlcnJvclNlY3Rpb24sIC0xMzApOw0KICAgICAgICB9DQogICAgfSwgMzAwKTsNCn0NCg0KLy8gSMOgbSBjdeG7mW4gbcaw4bujdCB04buVbmcgcXXDoXQNCmZ1bmN0aW9uIHNtb290aFNjcm9sbFRvKGVsZW1lbnQsIG9mZnNldCA9IDApIHsNCiAgICBlbGVtZW50LmNsYXNzTGlzdC5hZGQoJ2hpZ2hsaWdodC1lcnJvci1zZWN0aW9uJyk7DQogICAgDQogICAgY29uc3QgZWxlbWVudFBvc2l0aW9uID0gZWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS50b3A7DQogICAgY29uc3Qgb2Zmc2V0UG9zaXRpb24gPSBlbGVtZW50UG9zaXRpb24gKyB3aW5kb3cucGFnZVlPZmZzZXQgLSBvZmZzZXQ7DQogICAgDQogICAgY29uc3QgZHVyYXRpb24gPSAxNTAwOw0KICAgIGNvbnN0IHN0YXJ0ID0gd2luZG93LnBhZ2VZT2Zmc2V0Ow0KICAgIGNvbnN0IHN0YXJ0VGltZSA9IHBlcmZvcm1hbmNlLm5vdygpOw0KICAgIA0KICAgIGZ1bmN0aW9uIHNjcm9sbFN0ZXAodGltZXN0YW1wKSB7DQogICAgICAgIGNvbnN0IGVsYXBzZWQgPSB0aW1lc3RhbXAgLSBzdGFydFRpbWU7DQogICAgICAgIGNvbnN0IHByb2dyZXNzID0gTWF0aC5taW4oZWxhcHNlZCAvIGR1cmF0aW9uLCAxKTsNCiAgICAgICAgY29uc3QgZWFzaW5nID0gZWFzZUluT3V0Q3ViaWMocHJvZ3Jlc3MpOw0KICAgICAgICB3aW5kb3cuc2Nyb2xsVG8oMCwgc3RhcnQgKyAob2Zmc2V0UG9zaXRpb24gLSBzdGFydCkgKiBlYXNpbmcpOw0KICAgICAgICANCiAgICAgICAgaWYgKHByb2dyZXNzIDwgMSkgew0KICAgICAgICAgICAgd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZShzY3JvbGxTdGVwKTsNCiAgICAgICAgfQ0KICAgIH0NCiAgICANCiAgICBmdW5jdGlvbiBlYXNlSW5PdXRDdWJpYyh0KSB7DQogICAgICAgIHJldHVybiB0IDwgMC41ID8gNCAqIHQgKiB0ICogdCA6IDEgLSBNYXRoLnBvdygtMiAqIHQgKyAyLCAzKSAvIDI7DQogICAgfQ0KICAgIA0KICAgIHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUoc2Nyb2xsU3RlcCk7DQogICAgDQogICAgc2V0VGltZW91dCgoKSA9PiB7DQogICAgICAgIGVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgnaGlnaGxpZ2h0LWVycm9yLXNlY3Rpb24nKTsNCiAgICB9LCAyMDAwKTsNCn0NCg0KDQogDQoNCiAgICAgICAgZnVuY3Rpb24gcGFyc2VEYXRlVGltZShkYXRldGltZVN0ciwgcm93SW5kZXgpIHsNCiAgICAgICAgICAgIHRyeSB7DQogICAgICAgICAgICAgICAgaWYgKCFkYXRldGltZVN0cikgew0KICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGRhdGV0aW1lU3RyID09PSAnbnVtYmVyJykgew0KICAgICAgICAgICAgICAgICAgICBjb25zdCBleGNlbERhdGUgPSBuZXcgRGF0ZShNYXRoLnJvdW5kKChkYXRldGltZVN0ciAtIDI1NTY5KSAqIDg2NDAwICogMTAwMCkpOw0KICAgICAgICAgICAgICAgICAgICBjb25zdCBkYXkgPSBleGNlbERhdGUuZ2V0RGF0ZSgpOw0KICAgICAgICAgICAgICAgICAgICBjb25zdCBtb250aCA9IGV4Y2VsRGF0ZS5nZXRNb250aCgpICsgMTsNCiAgICAgICAgICAgICAgICAgICAgY29uc3QgeWVhciA9IGV4Y2VsRGF0ZS5nZXRGdWxsWWVhcigpOw0KICAgICAgICAgICAgICAgICAgICBjb25zdCBob3VycyA9IGV4Y2VsRGF0ZS5nZXRIb3VycygpOw0KICAgICAgICAgICAgICAgICAgICBjb25zdCBtaW51dGVzID0gZXhjZWxEYXRlLmdldE1pbnV0ZXMoKTsNCiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2Vjb25kcyA9IGV4Y2VsRGF0ZS5nZXRTZWNvbmRzKCk7DQogICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gew0KICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZU9iajogZXhjZWxEYXRlLA0KICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZUtleTogYCR7ZGF5fS8ke21vbnRofS8ke3llYXJ9YCwNCiAgICAgICAgICAgICAgICAgICAgICAgIG1pbnV0ZXM6IGhvdXJzICogNjAgKyBtaW51dGVzLA0KICAgICAgICAgICAgICAgICAgICAgICAgc2Vjb25kczogaG91cnMgKiAzNjAwICsgbWludXRlcyAqIDYwICsgc2Vjb25kcywNCiAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BsYXlUaW1lOiBgJHtob3Vycy50b1N0cmluZygpLnBhZFN0YXJ0KDIsICcwJyl9OiR7bWludXRlcy50b1N0cmluZygpLnBhZFN0YXJ0KDIsICcwJyl9OiR7c2Vjb25kcy50b1N0cmluZygpLnBhZFN0YXJ0KDIsICcwJyl9YA0KICAgICAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgICAgIH0gDQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBkYXRldGltZVN0ciA9PT0gJ3N0cmluZycpIHsNCiAgICAgICAgICAgICAgICAgICAgbGV0IGRhdGVQYXJ0LCB0aW1lUGFydCA9ICcwMDowMDowMCc7DQogICAgICAgICAgICAgICAgICAgIGlmIChkYXRldGltZVN0ci5pbmNsdWRlcygnICcpKSBbZGF0ZVBhcnQsIHRpbWVQYXJ0XSA9IGRhdGV0aW1lU3RyLnNwbGl0KCcgJyk7DQogICAgICAgICAgICAgICAgICAgIGVsc2UgZGF0ZVBhcnQgPSBkYXRldGltZVN0cjsNCiAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgIGxldCBkYXksIG1vbnRoLCB5ZWFyOw0KICAgICAgICAgICAgICAgICAgICBpZiAoZGF0ZVBhcnQuaW5jbHVkZXMoJy8nKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcGFydHMgPSBkYXRlUGFydC5zcGxpdCgnLycpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBhcnRzLmxlbmd0aCA9PT0gMykgW2RheSwgbW9udGgsIHllYXJdID0gcGFydHMubWFwKE51bWJlcik7DQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChwYXJ0cy5sZW5ndGggPT09IDIpIFtkYXksIG1vbnRoXSA9IHBhcnRzLm1hcChOdW1iZXIpLCB5ZWFyID0gbmV3IERhdGUoKS5nZXRGdWxsWWVhcigpOw0KICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGRhdGVQYXJ0LmluY2x1ZGVzKCctJykpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHBhcnRzID0gZGF0ZVBhcnQuc3BsaXQoJy0nKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwYXJ0cy5sZW5ndGggPT09IDMpIFt5ZWFyLCBtb250aCwgZGF5XSA9IHBhcnRzLm1hcChOdW1iZXIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAocGFydHMubGVuZ3RoID09PSAyKSBbbW9udGgsIGRheV0gPSBwYXJ0cy5tYXAoTnVtYmVyKSwgeWVhciA9IG5ldyBEYXRlKCkuZ2V0RnVsbFllYXIoKTsNCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHRocm93IG5ldyBFcnJvcignxJDhu4tuaCBk4bqhbmcgbmfDoHkga2jDtG5nIMSRxrDhu6NjIGjhu5cgdHLhu6MnKTsNCiAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgIGlmIChpc05hTihkYXkpIHx8IGlzTmFOKG1vbnRoKSB8fCBpc05hTih5ZWFyKSB8fCBkYXkgPCAxIHx8IGRheSA+IDMxIHx8IG1vbnRoIDwgMSB8fCBtb250aCA+IDEyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0dpw6EgdHLhu4sgbmfDoHkga2jDtG5nIGjhu6NwIGzhu4cnKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgbGV0IGhvdXJzID0gMCwgbWludXRlcyA9IDAsIHNlY29uZHMgPSAwOw0KICAgICAgICAgICAgICAgICAgICBpZiAodGltZVBhcnQuaW5jbHVkZXMoJzonKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdGltZVBhcnRzID0gdGltZVBhcnQuc3BsaXQoJzonKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGhvdXJzID0gcGFyc2VJbnQodGltZVBhcnRzWzBdKSB8fCAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgbWludXRlcyA9IHBhcnNlSW50KHRpbWVQYXJ0c1sxXSkgfHwgMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHNlY29uZHMgPSBwYXJzZUludCh0aW1lUGFydHNbMl0pIHx8IDA7DQogICAgICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc05hTihob3VycykgfHwgaXNOYU4obWludXRlcykgfHwgaXNOYU4oc2Vjb25kcykgfHwgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaG91cnMgPCAwIHx8IGhvdXJzID4gMjMgfHwgbWludXRlcyA8IDAgfHwgbWludXRlcyA+IDU5IHx8IHNlY29uZHMgPCAwIHx8IHNlY29uZHMgPiA1OSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvZ0Vycm9yKCdHacOhIHRy4buLIHRo4budaSBnaWFuIGtow7RuZyBo4bujcCBs4buHJywgcm93SW5kZXgsIHsgdGltZTogdGltZVBhcnQgfSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaG91cnMgPSAwOyBtaW51dGVzID0gMDsgc2Vjb25kcyA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgIGNvbnN0IGRhdGVPYmogPSBuZXcgRGF0ZSh5ZWFyLCBtb250aCAtIDEsIGRheSwgaG91cnMsIG1pbnV0ZXMsIHNlY29uZHMpOw0KICAgICAgICAgICAgICAgICAgICBpZiAoaXNOYU4oZGF0ZU9iai5nZXRUaW1lKCkpKSB0aHJvdyBuZXcgRXJyb3IoJ05nw6B5IGtow7RuZyBo4bujcCBs4buHJyk7DQogICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICBjb25zdCBzZWNvbmRzSW5EYXkgPSBob3VycyAqIDM2MDAgKyBtaW51dGVzICogNjAgKyBzZWNvbmRzOw0KICAgICAgICAgICAgICAgICAgICBjb25zdCBtaW51dGVzSW5EYXkgPSBob3VycyAqIDYwICsgbWludXRlczsNCiAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgIHJldHVybiB7DQogICAgICAgICAgICAgICAgICAgICAgICBkYXRlT2JqLA0KICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZUtleTogYCR7ZGF5fS8ke21vbnRofS8ke3llYXJ9YCwNCiAgICAgICAgICAgICAgICAgICAgICAgIG1pbnV0ZXM6IG1pbnV0ZXNJbkRheSwNCiAgICAgICAgICAgICAgICAgICAgICAgIHNlY29uZHM6IHNlY29uZHNJbkRheSwNCiAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BsYXlUaW1lOiBgJHtob3Vycy50b1N0cmluZygpLnBhZFN0YXJ0KDIsICcwJyl9OiR7bWludXRlcy50b1N0cmluZygpLnBhZFN0YXJ0KDIsICcwJyl9OiR7c2Vjb25kcy50b1N0cmluZygpLnBhZFN0YXJ0KDIsICcwJyl9YA0KICAgICAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ8SQ4buLbmggZOG6oW5nIHRo4budaSBnaWFuIGtow7RuZyDEkcaw4bujYyBo4buXIHRy4bujJyk7DQogICAgICAgICAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICAgICAgICAgIGxvZ0Vycm9yKGBM4buXaSBwaMOibiB0w61jaCB0aOG7nWkgZ2lhbjogJHtlcnJvci5tZXNzYWdlfWAsIHJvd0luZGV4LCB7IA0KICAgICAgICAgICAgICAgICAgICB2YWx1ZTogZGF0ZXRpbWVTdHIsDQogICAgICAgICAgICAgICAgICAgIGVycm9yRGV0YWlsczogZXJyb3Iuc3RhY2sgDQogICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICAvLyA9PT09PT09PT09IEtI4bueSSBU4bqgTyBT4buwIEtJ4buGTiA9PT09PT09PT09IC8vDQogICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBmdW5jdGlvbigpIHsNCgkJZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3VzZXJuYW1lSW5wdXQnKS5mb2N1cygpOw0KICAgICAgICAgICAgLy8gS2hpIHRyYW5nIGxvYWQNCiAgICAgICAgICAgIGlmICghc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbSgnbWVkVXNlcicpKSB7DQogICAgICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QuYWRkKCdsb2dpbi1wYWdlJyk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIEtp4buDbSB0cmEgxJHEg25nIG5o4bqtcCBraGkgdHJhbmcgdOG6o2kNCgkJDQoJCQkNCiAgICAgICAgICAgIGNoZWNrU2F2ZWRMb2dpbigpOw0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyBHw6FuIHPhu7Ega2nhu4duIGNobyBuw7p0IMSRxINuZyBuaOG6rXANCiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2dpbkJ0bicpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gew0KICAgIGlzTG9naW5BY3Rpb24gPSB0cnVlOyAvLyDinIUgVGjDqm0gZMOybmcgbsOgeQ0KICAgIGNoZWNrTG9naW4oKTsNCn0pOw0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyBHw6FuIHPhu7Ega2nhu4duIGNobyBuw7p0IMSRxINuZyB4deG6pXQNCiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2dvdXRCdG4nKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsNCiAgICBpc0xvZ2luQWN0aW9uID0gZmFsc2U7IC8vIOKchSBUaMOqbSBkw7JuZyBuw6B5DQogICAgbG9nb3V0KCk7DQp9KTsNCg0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyDEkMSDbmcgbmjhuq1wIGLhurFuZyBwaMOtbSBFbnRlcg0KICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Bhc3N3b3JkSW5wdXQnKS5hZGRFdmVudExpc3RlbmVyKCdrZXl1cCcsIGZ1bmN0aW9uKGV2ZW50KSB7DQogICAgICAgICAgICAgICAgaWYgKGV2ZW50LmtleSA9PT0gJ0VudGVyJykgew0KICAgICAgICAgICAgICAgICAgICBjaGVja0xvZ2luKCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSk7DQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIEfDoW4gc+G7sSBraeG7h24gY2hvIG7DunQgcGjDom4gdMOtY2ggZmlsZQ0KICAgICAgICAgICAgDQpkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYW5hbHl6ZUJ0bicpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgYXN5bmMgKCkgPT4gew0KICBhd2FpdCBlbnN1cmVYTFNYKCk7IC8vIG7huqFwIFhMU1ggxJHDum5nIGzDumMgZMO5bmcNCiAgICBjb25zdCBmaWxlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ZpbGVJbnB1dCcpLmZpbGVzWzBdOw0KaWYgKCFmaWxlKSB7DQogICAgY29uc3QgcG9wdXAgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9hZGluZ1BvcHVwJyk7DQogICAgY29uc3QgbG9hZGluZ1RleHQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9hZGluZ1RleHQnKTsNCiAgICBjb25zdCBwcm9ncmVzc0JhciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwcm9ncmVzc0JhcicpOw0KDQogICAgbG9hZGluZ1RleHQuaW5uZXJIVE1MID0gYA0KICAgICAgICA8aSBjbGFzcz0iZmFzIGZhLWV4Y2xhbWF0aW9uLXRyaWFuZ2xlIiBzdHlsZT0iZm9udC1zaXplOjI0cHg7Y29sb3I6cmVkO21hcmdpbi1ib3R0b206MTBweDsiPjwvaT48YnIvPg0KICAgICAgICA8c3Ryb25nPlZ1aSBsw7JuZyBjaOG7jW4gZmlsZSB0csaw4bubYyBraGkga2nhu4NtIHRyYTwvc3Ryb25nPjxici8+PGJyLz4NCiAgICAgICAgPGJ1dHRvbiBjbGFzcz0iYnRuIiBvbmNsaWNrPSJkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9hZGluZ1BvcHVwJykuc3R5bGUuZGlzcGxheT0nbm9uZSciPsSQw7NuZzwvYnV0dG9uPg0KICAgIGA7DQogICAgcHJvZ3Jlc3NCYXIuc3R5bGUud2lkdGggPSAnMCUnOw0KICAgIA0KICAgIHBvcHVwLnN0eWxlLmRpc3BsYXkgPSAnZmxleCc7DQogICAgcG9wdXAuY2xhc3NMaXN0LmFkZCgnc2hvdycpOw0KICAgIHJldHVybjsNCn0NCg0KDQogICAgY29uc3QgcG9wdXAgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9hZGluZ1BvcHVwJyk7DQogICAgY29uc3QgbG9hZGluZ1RleHQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9hZGluZ1RleHQnKTsNCiAgICBjb25zdCBwcm9ncmVzc0JhciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwcm9ncmVzc0JhcicpOw0KDQogICAgcG9wdXAuc3R5bGUuZGlzcGxheSA9ICdmbGV4JzsNCiAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKCkgPT4gcG9wdXAuY2xhc3NMaXN0LmFkZCgnc2hvdycpKTsNCg0KICAgIGxvYWRpbmdUZXh0LmlubmVySFRNTCA9ICc8aSBjbGFzcz0iZmFzIGZhLXBhcGVyLXBsYW5lIiBzdHlsZT0iZm9udC1zaXplOjI0cHg7Y29sb3I6IzM0OThkYjttYXJnaW4tYm90dG9tOjEwcHg7Ij48L2k+PGJyLz7EkGFuZyBn4butaSBk4buvIGxp4buHdSB24buBIG3DoXkgY2jhu6cuLi4nOw0KICAgIHByb2dyZXNzQmFyLnN0eWxlLndpZHRoID0gJzMzJSc7DQoJDQoJDQoJDQoJY29uc3QgcHJvZ3Jlc3NCYXJDb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncHJvZ3Jlc3NCYXJDb250YWluZXInKTsNCg0KLy8gQ2jhu4kgdOG6oW8gMSBs4bqnbg0KaWYgKCFkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY3JlZGl0TGluZUJlbG93JykpIHsNCiAgY29uc3QgY3JlZGl0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7DQogIGNyZWRpdC5pZCA9ICdjcmVkaXRMaW5lQmVsb3cnOw0KICBjcmVkaXQuaW5uZXJUZXh0ID0gJ8KpIFRoaeG6v3Qga+G6vyAmIHBow6F0IHRyaeG7g24gYuG7n2kgQ2jDonUgSHXhu7NuaCc7DQogIGNyZWRpdC5zdHlsZS5tYXJnaW5Ub3AgPSAnMTBweCc7DQogIGNyZWRpdC5zdHlsZS5mb250U2l6ZSA9ICcxNnB4JzsNCiAgY3JlZGl0LnN0eWxlLmNvbG9yID0gJyNGRjAwMDAnOw0KICBjcmVkaXQuc3R5bGUudGV4dEFsaWduID0gJ2NlbnRlcic7DQoNCiAgcHJvZ3Jlc3NCYXJDb250YWluZXIucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoY3JlZGl0LCBwcm9ncmVzc0JhckNvbnRhaW5lci5uZXh0U2libGluZyk7DQp9DQoJDQoJDQoJDQoJDQogICAgYXdhaXQgbmV3IFByb21pc2UocmVzb2x2ZSA9PiByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKCkgPT4gc2V0VGltZW91dChyZXNvbHZlLCA1MCkpKTsNCiAgICBhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgNzAwKSk7DQoNCiAgICBwcm9ncmVzc0Jhci5zdHlsZS53aWR0aCA9ICc2NiUnOw0KDQogICAgbGV0IHRvdGFsID0gMDsNCiAgICB0cnkgew0KICAgICAgICBjb25zdCBmaWxlUmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTsNCiAgICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHsNCiAgICAgICAgICAgIGZpbGVSZWFkZXIub25sb2FkID0gZSA9PiByZXNvbHZlKG5ldyBVaW50OEFycmF5KGUudGFyZ2V0LnJlc3VsdCkpOw0KICAgICAgICAgICAgZmlsZVJlYWRlci5vbmVycm9yID0gKCkgPT4gcmVqZWN0KG5ldyBFcnJvcigiTOG7l2kgxJHhu41jIGZpbGUiKSk7DQogICAgICAgICAgICBmaWxlUmVhZGVyLnJlYWRBc0FycmF5QnVmZmVyKGZpbGUpOw0KICAgICAgICB9KTsNCg0KICAgICAgICBjb25zdCB3b3JrYm9vayA9IFhMU1gucmVhZChkYXRhLCB7IHR5cGU6ICdhcnJheScgfSk7DQogICAgICAgIGNvbnN0IGZpcnN0U2hlZXQgPSB3b3JrYm9vay5TaGVldHNbd29ya2Jvb2suU2hlZXROYW1lc1sxXV07DQogICAgICAgIGNvbnN0IGpzb25EYXRhID0gWExTWC51dGlscy5zaGVldF90b19qc29uKGZpcnN0U2hlZXQsIHsNCiAgICAgICAgICAgIGhlYWRlcjogMSwNCiAgICAgICAgICAgIGRlZnZhbDogIiIsDQogICAgICAgICAgICBibGFua3Jvd3M6IHRydWUNCiAgICAgICAgfSk7DQoNCiAgICAgICAgY29uc3Qgcm93cyA9IGpzb25EYXRhLnNsaWNlKDkpOw0KICAgICAgICB0b3RhbCA9IHJvd3MubGVuZ3RoOw0KICAgIH0gY2F0Y2ggew0KICAgICAgICB0b3RhbCA9IDEwMDA7DQogICAgfQ0KDQogICAgY29uc3Qgc3RlcCA9IDEwMDsNCiAgICBjb25zdCBzdGVwcyA9IE1hdGguY2VpbCh0b3RhbCAvIHN0ZXApOw0KICAgIGNvbnN0IGludGVydmFsID0gMjYwMCAvIHN0ZXBzOw0KDQogICAgZm9yIChsZXQgaSA9IDE7IGkgPD0gc3RlcHM7IGkrKykgew0KICAgICAgICBjb25zdCBjdXJyZW50ID0gTWF0aC5taW4oaSAqIHN0ZXAsIHRvdGFsKTsNCiAgICAgICAgbG9hZGluZ1RleHQuaW5uZXJIVE1MID0gJzxpIGNsYXNzPSJmYXMgZmEtdXNlci1tZCIgc3R5bGU9ImZvbnQtc2l6ZToyNHB4O2NvbG9yOiMyOTgwYjk7bWFyZ2luLWJvdHRvbToxMHB4OyI+PC9pPjxici8+xJBhbmcgcGjDom4gdMOtY2ggZOG7ryBsaeG7h3UgdOG7q25nIGLhu4duaCBuaMOibi4uLjxicj4nICsgY3VycmVudCArICcgLyAnICsgdG90YWw7DQogICAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHIgPT4gc2V0VGltZW91dChyLCBpbnRlcnZhbCkpOw0KICAgIH0NCg0KICAgIGxvYWRpbmdUZXh0LmlubmVySFRNTCA9ICc8aSBjbGFzcz0iZmFzIGZhLWNoZWNrLWNpcmNsZSIgc3R5bGU9ImZvbnQtc2l6ZToyNHB4O2NvbG9yOmdyZWVuO21hcmdpbi1ib3R0b206MTBweDsiPjwvaT48YnIvPsSQw6Mga2nhu4NtIHRyYSB4b25nLi4uJzsNCiAgICBwcm9ncmVzc0Jhci5zdHlsZS53aWR0aCA9ICcxMDAlJzsNCiAgICBhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgMTAwMCkpOw0KDQppZiAoIXdpbmRvdy5pc0tob2FMb2kpIHsNCiAgICBwb3B1cC5jbGFzc0xpc3QucmVtb3ZlKCdzaG93Jyk7DQogICAgc2V0VGltZW91dCgoKSA9PiB7IHBvcHVwLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7IH0sIDUwMCk7DQoNCg0KfQ0KDQoNCg0KIGVsc2Ugew0KICAgIC8vIE7hur91IMSRYW5nIGzhu5dpIEtob2EsIEtIw5RORyDEkcaw4bujYyDhuqluIHBvcHVwDQogICAgcG9wdXAuY2xhc3NMaXN0LmFkZCgnc2hvdycpOw0KICAgIHBvcHVwLnN0eWxlLmRpc3BsYXkgPSAnZmxleCc7DQp9DQogICAgaGFuZGxlRmlsZSgpOw0KCQ0KCQ0KCQ0KCQ0Kc2V0VGltZW91dCgoKSA9PiB7DQogICAgLy8g4p2MIE7hur91IMSRYW5nIGzhu5dpIHTDqm4ga2hvYSB0aMOsIGdp4buvIG5ndXnDqm4gcG9wdXAsIEtIw5RORyDEkcaw4bujYyDhuqluLCBLSMOUTkcgaGnhu4duIG7DunQNCiAgICBpZiAod2luZG93LmlzS2hvYUxvaSkgew0KICAgICAgICBwb3B1cC5zdHlsZS5kaXNwbGF5ID0gJ2ZsZXgnOw0KICAgICAgICBwb3B1cC5jbGFzc0xpc3QuYWRkKCdzaG93Jyk7DQogICAgICAgIHJldHVybjsNCiAgICB9DQoNCiAgICAvLyDinIUgTuG6v3Uga2jDtG5nIGzhu5dpLCB0aMOsIOG6qW4gcG9wdXAgdsOgIGhp4buHbiBuw7p0IGNo4bupYyBuxINuZw0KICAgIHBvcHVwLmNsYXNzTGlzdC5yZW1vdmUoJ3Nob3cnKTsNCiAgICBwb3B1cC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOw0KDQogICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnYnV0dG9uLmJ0bicpLmZvckVhY2goYnRuID0+IHsNCiAgICAgICAgaWYgKGJ0bi50ZXh0Q29udGVudC5pbmNsdWRlcygnR2nhu50gdHLhu5FuZycpIHx8IGJ0bi50ZXh0Q29udGVudC5pbmNsdWRlcygnU+G6r2MgdGh14buRYyB0aGFuZycpKSB7DQogICAgICAgICAgICBidG4uc3R5bGUuZGlzcGxheSA9ICdpbmxpbmUtYmxvY2snOw0KICAgICAgICB9DQogICAgfSk7DQp9LCA1MDApOw0KDQoNCgkNCn0pOw0KDQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIEfDoW4gc+G7sSBraeG7h24gY2hvIGRyb3Bkb3duIGzhu41jDQogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnb3BlcmF0b3JTZWxlY3QnKS5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBmaWx0ZXJCeU9wZXJhdG9yKTsNCiAgICAgICAgICAgIA0KCQkJDQoJCQlkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2hvd0RvY3RvckNoZWNrYm94JykuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgZmlsdGVyQnlPcGVyYXRvcik7DQoJCQkNCgkJCQ0KICAgICAgICAgICAgLy8gR8OhbiBz4buxIGtp4buHbiBjaG8gcmFkaW8gYnV0dG9uIGNo4buNbiBraHVuZyBnaeG7nQ0KICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnaW5wdXRbbmFtZT0idGltZU9wdGlvbiJdJykuZm9yRWFjaChyYWRpbyA9PiB7DQogICAgICAgICAgICAgICAgcmFkaW8uYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgIGlmIChhbGxQcm9jZWR1cmVzLmxlbmd0aCA+IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGdlbmVyYXRlVGltZVN1Z2dlc3Rpb25zKGFsbFByb2NlZHVyZXMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgZmlsdGVyQnlPcGVyYXRvcigpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICB9KTsNCgkJCQ0KCQkJZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ29wZXJhdG9yU2VsZWN0JykuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgZnVuY3Rpb24oKSB7DQogICAgZmlsdGVyQnlPcGVyYXRvcigpOw0KfSk7DQoNCmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdvcGVyYXRvclNlbGVjdEVycm9yJykuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgZnVuY3Rpb24oKSB7DQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ29wZXJhdG9yU2VsZWN0JykudmFsdWUgPSB0aGlzLnZhbHVlOw0KICAgIGZpbHRlckJ5T3BlcmF0b3IoKTsNCn0pOw0KCQkJDQogICAgICAgIH0pOw0KICAgIDwvc2NyaXB0Pg0KPGRpdiBjbGFzcz0icHJvY2VkdXJlLWluZm8iPjxjZW50ZXI+IA0KRGVzaWduIEJ5IDxhIGhyZWY9Imh0dHA6Ly9mYi5jb20vY2hhdWh1eW5oMDEwNCIgdGFyZ2V0PSJfYmxhbmsiPiBEci5DaMOidTwvYT48YnIvPg0KICAgICAgICAgICAgICAgIE7hur91IEPDsyBC4bqldCBL4buzIFbGsOG7m25nIE3huq9jIEfDrCBWdWkgTMOybmcgTEggOiA8YnIvPg0KICAgICAgICAgICAgICAgIEVtYWlsOiBjaGF1aHV5bmgwMTA0QGdtYWlsLmNvbTxici8+DQogICAgICAgICAgICAgICAgU0RUOiAwNzkuNTY3LjkzNTA8L2NlbnRlcj4NCjwvZGl2Pg0KPHNjcmlwdD4NCiAgLy8gSOG7lyB0cuG7oyBuaOG6pW4gRW50ZXIgdOG7qyDDtCB1c2VybmFtZSBob+G6t2MgcGFzc3dvcmQNCiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3VzZXJuYW1lSW5wdXQnKS5hZGRFdmVudExpc3RlbmVyKCdrZXl1cCcsIGZ1bmN0aW9uKGV2ZW50KSB7DQogICAgaWYgKGV2ZW50LmtleSA9PT0gJ0VudGVyJykgew0KICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Bhc3N3b3JkSW5wdXQnKS5mb2N1cygpOw0KICAgIH0NCiAgfSk7DQoNCiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Bhc3N3b3JkSW5wdXQnKS5hZGRFdmVudExpc3RlbmVyKCdrZXl1cCcsIGZ1bmN0aW9uKGV2ZW50KSB7DQogICAgaWYgKGV2ZW50LmtleSA9PT0gJ0VudGVyJykgew0KICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvZ2luQnRuJykuY2xpY2soKTsNCiAgICB9DQogIH0pOw0KDQovLyA9PT09PT0gVOG7sCDEkOG7mE5HIFFVw4lUIFRIxq8gTeG7pEMgJiBDSOG7jE4gRklMRSBN4buaSSBOSOG6pFQgPT09PT09DQoNCmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmb2xkZXJCdG4nKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsNCiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZm9sZGVySW5wdXQnKS5jbGljaygpOw0KfSk7DQoNCmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmb2xkZXJJbnB1dCcpLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIGFzeW5jIChlKSA9PiB7DQogYXdhaXQgZW5zdXJlWExTWCgpOyAvLyBu4bqhcCBYTFNYIHRyxrDhu5tjIGtoaSDEkeG7jWMgd29ya2Jvb2sNCiAgICBjb25zdCBmaWxlcyA9IEFycmF5LmZyb20oZS50YXJnZXQuZmlsZXMpLmZpbHRlcihmID0+IC9cLih4bHN4fHhsc3xjc3YpJC9pLnRlc3QoZi5uYW1lKSk7DQogICAgY29uc3Qgc3RhdHVzRGl2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NjYW5TdGF0dXMnKTsNCiAgICBjb25zdCBmaWxlSW5wdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZmlsZUlucHV0Jyk7DQoNCiAgICBpZiAoZmlsZXMubGVuZ3RoID09PSAwKSB7DQogICAgICAgIHN0YXR1c0Rpdi5zdHlsZS5jb2xvciA9ICdyZWQnOw0KICAgICAgICBzdGF0dXNEaXYuaW5uZXJIVE1MID0gJ0tow7RuZyB0w6xtIHRo4bqleSBmaWxlIEV4Y2VsIGjhu6NwIGzhu4cgdHJvbmcgdGjGsCBt4bulYy4nOw0KICAgICAgICByZXR1cm47DQogICAgfQ0KDQogICAgbGV0IHZhbGlkRmlsZSA9IG51bGw7DQoNCiAgICBmb3IgKGNvbnN0IGZpbGUgb2YgZmlsZXMuc29ydCgoYSwgYikgPT4gYi5sYXN0TW9kaWZpZWQgLSBhLmxhc3RNb2RpZmllZCkpIHsNCiAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCBmaWxlLmFycmF5QnVmZmVyKCk7DQogICAgICAgICAgICBjb25zdCB3b3JrYm9vayA9IFhMU1gucmVhZChkYXRhLCB7IHR5cGU6ICdhcnJheScgfSk7DQoNCiAgICAgICAgICAgIGlmICghd29ya2Jvb2suU2hlZXROYW1lc1sxXSkgY29udGludWU7IC8vIGPhuqduIFNoZWV0IHRo4bupIDINCg0KICAgICAgICAgICAgY29uc3Qgc2hlZXQgPSB3b3JrYm9vay5TaGVldHNbd29ya2Jvb2suU2hlZXROYW1lc1sxXV07DQogICAgICAgICAgICBjb25zdCBqc29uRGF0YSA9IFhMU1gudXRpbHMuc2hlZXRfdG9fanNvbihzaGVldCwgeyBoZWFkZXI6IDEsIGRlZnZhbDogIiIsIGJsYW5rcm93czogdHJ1ZSB9KTsNCg0KICAgICAgICAgICAgaWYgKGpzb25EYXRhLmxlbmd0aCA+PSAxMCkgeyAvLyDDrXQgbmjhuqV0IDIgZMOybmcgaGVhZGVyIHbDoCBjw7MgZOG7ryBsaeG7h3UgZMOybmcgMTANCiAgICAgICAgICAgICAgICB2YWxpZEZpbGUgPSBmaWxlOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9IGNhdGNoIChlcnIpIHsNCiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYEzhu5dpIMSR4buNYyBmaWxlICR7ZmlsZS5uYW1lfTpgLCBlcnIpOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgaWYgKHZhbGlkRmlsZSkgew0KICAgICAgICBjb25zdCBkdCA9IG5ldyBEYXRhVHJhbnNmZXIoKTsNCiAgICAgICAgZHQuaXRlbXMuYWRkKHZhbGlkRmlsZSk7DQogICAgICAgIGZpbGVJbnB1dC5maWxlcyA9IGR0LmZpbGVzOw0KDQogICAgICAgIC8vIGPhuq1wIG5o4bqtdCB0cuG6oW5nIHRow6FpDQogICAgICAgIHN0YXR1c0Rpdi5pbm5lckhUTUwgPSBgPGkgY2xhc3M9ImZhcyBmYS1mb2xkZXItb3BlbiI+PC9pPiDEkMOjIGNo4buNbiBmaWxlOiA8Yj4ke3ZhbGlkRmlsZS5uYW1lfTwvYj5gOw0KICAgICAgICBzdGF0dXNEaXYuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7DQogICAgICAgIHN0YXR1c0Rpdi5zdHlsZS5jb2xvciA9ICcjMmMzZTUwJzsNCg0KICAgICAgICAvLyBH4buNaSBraeG7g20gdHJhDQogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhbmFseXplQnRuJykuY2xpY2soKTsNCiAgICB9IGVsc2Ugew0KICAgICAgICBzdGF0dXNEaXYuc3R5bGUuY29sb3IgPSAncmVkJzsNCiAgICAgICAgc3RhdHVzRGl2LmlubmVySFRNTCA9ICdLaMO0bmcgdMOsbSDEkcaw4bujYyBmaWxlIGPDsyBj4bqldSB0csO6YyBo4bujcCBs4buHLiBWdWkgbMOybmcga2nhu4NtIHRyYSBs4bqhaS4nOw0KICAgIH0NCn0pOw0KDQoNCjwvc2NyaXB0Pg0KPGRpdiBjbGFzcz0idG9hc3QiIGlkPSJ0b2FzdCI+PC9kaXY+DQo8IS0tIFBvcHVwIGxvYWRpbmcgLS0+DQo8ZGl2IGlkPSJsb2FkaW5nUG9wdXAiIHN0eWxlPSJkaXNwbGF5Om5vbmU7cG9zaXRpb246Zml4ZWQ7dG9wOjA7bGVmdDowO3dpZHRoOjEwMCU7aGVpZ2h0OjEwMCU7YmFja2dyb3VuZDpyZ2JhKDAsMCwwLDAuNSk7ei1pbmRleDo5OTk5O2p1c3RpZnktY29udGVudDpjZW50ZXI7YWxpZ24taXRlbXM6Y2VudGVyO2ZvbnQtZmFtaWx5OidJbnRlcicsc2Fucy1zZXJpZiI+DQo8ZGl2IHN0eWxlPSJiYWNrZ3JvdW5kOiNmZmY7cGFkZGluZzozMHB4IDQwcHg7Ym9yZGVyLXJhZGl1czoxMHB4O3RleHQtYWxpZ246Y2VudGVyO2JveC1zaGFkb3c6MCAwIDE1cHggcmdiYSgwLDAsMCwwLjMpO21heC13aWR0aDo5MCU7Zm9udC1zaXplOjE4cHgiPg0KPGRpdiBpZD0ibG9hZGluZ1RleHQiPg0KPGkgY2xhc3M9ImZhcyBmYS1zcGlubmVyIGZhLXNwaW4iIHN0eWxlPSJmb250LXNpemU6MjRweDtjb2xvcjojMzQ5OGRiO21hcmdpbi1ib3R0b206MTBweDsiPjwvaT48YnIvPg0KICAgICAgxJBhbmcgZ+G7rWkgZOG7ryBsaeG7h3UgduG7gSBtw6F5IGNo4bunLi4uDQogICAgPC9kaXY+DQo8ZGl2IGlkPSJwcm9ncmVzc0JhckNvbnRhaW5lciI+DQo8ZGl2IGlkPSJwcm9ncmVzc0JhciI+PC9kaXY+DQo8ZGl2IGlkPSJhdmFpbGFiaWxpdHlUYWJsZSIgc3R5bGU9ImRpc3BsYXk6IG5vbmU7IG1hcmdpbi10b3A6IDIwcHg7Ij4NCiAgPGgyPlRo4buRbmcga8OqIGdp4budIHRy4buRbmcgdOG7q25nIG5nxrDhu51pPC9oMj4NCiAgPHRhYmxlIGNsYXNzPSJlcnJvci10YWJsZSI+DQogICAgPHRoZWFkPg0KICAgICAgPHRyPg0KICAgICAgICA8dGg+TmfGsOG7nWkgdGjhu7FjIGhp4buHbjwvdGg+DQogICAgICAgIDx0aD5OZ8OgeTwvdGg+DQogICAgICAgIA0KICAgICAgICA8dGg+R2nhu50gdHLhu5FuZyBideG7lWkgc8Ohbmc8L3RoPg0KICAgICAgICA8dGg+R2nhu50gdHLhu5FuZyBideG7lWkgY2hp4buBdTwvdGg+DQogICAgICA8L3RyPg0KICAgIDwvdGhlYWQ+DQogICAgPHRib2R5IGlkPSJhdmFpbGFiaWxpdHlCb2R5Ij48L3Rib2R5Pg0KICA8L3RhYmxlPg0KPC9kaXY+DQo8IS0tIEvhur5UIFRIw5pDOiBC4bqiTkcgR0nhu5wgVFLhu5BORyBU4buqTkcgTkfGr+G7nEkgLS0+DQo8L2Rpdj4NCjwvZGl2Pg0KPC9kaXY+DQo8L2Rpdj4NCg0KPHNjcmlwdD4NCmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoIkRPTUNvbnRlbnRMb2FkZWQiLCBmdW5jdGlvbigpIHsNCiAgY29uc3Qgbm9pZHVuZyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJub2lkdW5nIik7DQogIGNvbnN0IGxpc3QxID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcigiLmxpc3QxIik7DQoNCiAgaWYgKG5vaWR1bmcgJiYgbGlzdDEpIHsNCiAgICBjb25zdCB0ZXh0ID0gbm9pZHVuZy50ZXh0Q29udGVudCB8fCBub2lkdW5nLmlubmVyVGV4dCB8fCAiIjsNCiAgICBpZiAodGV4dC50cmltKCkgPT09ICIiKSB7DQogICAgICBsaXN0MS5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOw0KICAgIH0NCiAgfQ0KfSk7DQoNCi8vID09PT0gVMONTkggVE/DgU4gR0nhu5wgVFLhu5BORyBDSE8gVOG7qk5HIE5Hxq/hu5xJID09PT0NCg0KDQoNCmZ1bmN0aW9uIHRvZ2dsZUF2YWlsYWJpbGl0eSgpIHsNCiAgICBjb25zdCB0YWJsZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhdmFpbGFiaWxpdHlUYWJsZScpOw0KICAgIGNvbnN0IGZpbHRlckJsb2NrID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2F2YWlsYWJpbGl0eUZpbHRlckJsb2NrJyk7DQogICAgaWYgKHRhYmxlLnN0eWxlLmRpc3BsYXkgPT09ICdub25lJykgew0KICAgICAgICB0YWJsZS5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsNCiAgICAgICAgaWYgKGZpbHRlckJsb2NrKSBmaWx0ZXJCbG9jay5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsNCiAgICAgICAgY2FsY3VsYXRlQXZhaWxhYmlsaXR5KCk7DQogICAgfSBlbHNlIHsNCiAgICAgICAgdGFibGUuc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCiAgICAgICAgaWYgKGZpbHRlckJsb2NrKSBmaWx0ZXJCbG9jay5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOw0KICAgIH0NCn0NCg0KDQpmdW5jdGlvbiBjYWxjdWxhdGVBdmFpbGFiaWxpdHkoKSB7DQogICAgY29uc3QgZ3JvdXBzID0ge307DQogICAgYWxsUHJvY2VkdXJlcy5mb3JFYWNoKHByb2MgPT4gew0KICAgICAgICBjb25zdCBrZXkgPSBgJHtwcm9jLm9wZXJhdG9yfV8ke3Byb2MuZGF0ZX1gOw0KICAgICAgICBpZiAoIWdyb3Vwc1trZXldKSBncm91cHNba2V5XSA9IFtdOw0KICAgICAgICBncm91cHNba2V5XS5wdXNoKHByb2MpOw0KICAgIH0pOw0KDQogICAgY29uc3QgdGJvZHkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYXZhaWxhYmlsaXR5Qm9keScpOw0KICAgIHRib2R5LmlubmVySFRNTCA9ICcnOw0KDQogICAgY29uc3Qgc2VsZWN0ZWRPcCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmaWx0ZXJPcGVyYXRvcicpPy52YWx1ZSB8fCAnYWxsJzsNCiAgICBjb25zdCBzZWxlY3RlZERhdGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZmlsdGVyRGF0ZScpPy52YWx1ZSB8fCAnYWxsJzsNCg0KICAgIC8vIENo4buJIGto4bufaSB04bqhbyBkcm9wZG93biAxIGzhuqduDQogICAgaWYgKCFkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZmlsdGVyT3BlcmF0b3InKS5kYXRhc2V0LmluaXRpYWxpemVkKSB7DQogICAgICAgIGNvbnN0IG9wZXJhdG9ycyA9IFsuLi5uZXcgU2V0KGFsbFByb2NlZHVyZXMubWFwKHAgPT4gcC5vcGVyYXRvcikpXS5zb3J0KCk7DQogICAgICAgIGNvbnN0IGRhdGVzID0gWy4uLm5ldyBTZXQoYWxsUHJvY2VkdXJlcy5tYXAocCA9PiBwLmRhdGUpKV0uc29ydCgoYSwgYikgPT4gew0KICAgICAgICAgICAgY29uc3QgW2RhLCBtYSwgeWFdID0gYS5zcGxpdCgnLycpLm1hcChOdW1iZXIpOw0KICAgICAgICAgICAgY29uc3QgW2RiLCBtYiwgeWJdID0gYi5zcGxpdCgnLycpLm1hcChOdW1iZXIpOw0KICAgICAgICAgICAgcmV0dXJuIG5ldyBEYXRlKHlhLCBtYSAtIDEsIGRhKSAtIG5ldyBEYXRlKHliLCBtYiAtIDEsIGRiKTsNCiAgICAgICAgfSk7DQoNCiAgICAgICAgY29uc3Qgb3BTZWxlY3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZmlsdGVyT3BlcmF0b3InKTsNCiAgICAgICAgY29uc3QgZGF0ZVNlbGVjdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmaWx0ZXJEYXRlJyk7DQoNCiAgICAgICAgb3BTZWxlY3QuaW5uZXJIVE1MID0gJzxvcHRpb24gdmFsdWU9ImFsbCI+VOG6pXQgY+G6ozwvb3B0aW9uPicgKw0KICAgICAgICAgICAgb3BlcmF0b3JzLm1hcChvcCA9PiBgPG9wdGlvbiB2YWx1ZT0iJHtvcH0iPiR7b3AucmVwbGFjZSgvLC9nLCAnJyl9PC9vcHRpb24+YCkuam9pbignJyk7DQogICAgICAgIGRhdGVTZWxlY3QuaW5uZXJIVE1MID0gJzxvcHRpb24gdmFsdWU9ImFsbCI+VOG6pXQgY+G6ozwvb3B0aW9uPicgKw0KICAgICAgICAgICAgZGF0ZXMubWFwKGQgPT4gYDxvcHRpb24gdmFsdWU9IiR7ZH0iPiR7ZH08L29wdGlvbj5gKS5qb2luKCcnKTsNCg0KICAgICAgICBvcFNlbGVjdC5kYXRhc2V0LmluaXRpYWxpemVkID0gJ3RydWUnOw0KICAgICAgICBkYXRlU2VsZWN0LmRhdGFzZXQuaW5pdGlhbGl6ZWQgPSAndHJ1ZSc7DQoNCiAgICAgICAgb3BTZWxlY3QuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgY2FsY3VsYXRlQXZhaWxhYmlsaXR5KTsNCiAgICAgICAgZGF0ZVNlbGVjdC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBjYWxjdWxhdGVBdmFpbGFiaWxpdHkpOw0KICAgIH0NCg0KICAgIE9iamVjdC5rZXlzKGdyb3VwcykuZm9yRWFjaChrZXkgPT4gew0KICAgICAgICBjb25zdCBbb3BlcmF0b3IsIGRhdGVdID0ga2V5LnNwbGl0KCdfJyk7DQogICAgICAgIGlmICgoc2VsZWN0ZWRPcCAhPT0gJ2FsbCcgJiYgb3BlcmF0b3IgIT09IHNlbGVjdGVkT3ApIHx8DQogICAgICAgICAgICAoc2VsZWN0ZWREYXRlICE9PSAnYWxsJyAmJiBkYXRlICE9PSBzZWxlY3RlZERhdGUpKSByZXR1cm47DQoNCiAgICAgICAgY29uc3QgcHJvY2VkdXJlcyA9IGdyb3Vwc1trZXldOw0KICAgICAgICBwcm9jZWR1cmVzLnNvcnQoKGEsIGIpID0+IGEuc3RhcnQgLSBiLnN0YXJ0KTsNCg0KICAgICAgICBjb25zdCBtb3JuaW5nU3RhcnQgPSA3ICogMzYwMDsNCiAgICAgICAgY29uc3QgbW9ybmluZ0VuZCA9IDExLjUgKiAzNjAwOw0KICAgICAgICBjb25zdCBhZnRlcm5vb25TdGFydCA9IDEzLjUgKiAzNjAwOw0KICAgICAgICBjb25zdCBhZnRlcm5vb25FbmQgPSAxNyAqIDM2MDA7DQoNCiAgICAgICAgY29uc3QgbW9ybmluZ0ZyZWUgPSBnZXRGcmVlU2xvdHMocHJvY2VkdXJlcywgbW9ybmluZ1N0YXJ0LCBtb3JuaW5nRW5kKTsNCiAgICAgICAgY29uc3QgYWZ0ZXJub29uRnJlZSA9IGdldEZyZWVTbG90cyhwcm9jZWR1cmVzLCBhZnRlcm5vb25TdGFydCwgYWZ0ZXJub29uRW5kKTsNCg0KICAgICAgICBjb25zdCByb3cgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0cicpOw0KICAgICAgICByb3cuY2xhc3NMaXN0LmFkZCgiaGVyYi1yb3ciKTsNCiAgICAgICAgcm93LmlubmVySFRNTCA9IGANCiAgICAgICAgICAgIDx0ZD48YSBocmVmPSIjIiBvbmNsaWNrPSJzaG93UHJvY2VkdXJlc0Zvck9wZXJhdG9yKFxgJHtvcGVyYXRvcn1cYCwgXGAke2RhdGV9XGApO3JldHVybiBmYWxzZTsiIHN0eWxlPSJjb2xvcjojMzQ5OGRiO2ZvbnQtd2VpZ2h0OmJvbGQiPiR7b3BlcmF0b3IucmVwbGFjZSgvLC9nLCAnJyl9PC9hPjwvdGQ+DQogICAgICAgICAgICA8dGQ+JHtkYXRlfTwvdGQ+DQogICAgICAgICAgICA8dGQ+JHttb3JuaW5nRnJlZX08L3RkPg0KICAgICAgICAgICAgPHRkPiR7YWZ0ZXJub29uRnJlZX08L3RkPg0KICAgICAgICBgOw0KICAgICAgICB0Ym9keS5hcHBlbmRDaGlsZChyb3cpOw0KICAgIH0pOw0KfQ0KDQoNCmZ1bmN0aW9uIGdldEZyZWVTbG90cyhwcm9jZWR1cmVzLCBzdGFydCwgZW5kKSB7DQogICAgY29uc3QgYnVzeSA9IHByb2NlZHVyZXMubWFwKHAgPT4gKHsNCiAgICAgICAgc3RhcnQ6IHAuc3RhcnQsDQogICAgICAgIGVuZDogcC5lbmQgKyAoKHAucHJvY2VkdXJlSW5mbz8uYnVmZmVyIHx8IDApICogNjApDQogICAgfSkpLmZpbHRlcihwID0+IHAuZW5kID4gc3RhcnQgJiYgcC5zdGFydCA8IGVuZCk7DQoNCiAgICBidXN5LnNvcnQoKGEsIGIpID0+IGEuc3RhcnQgLSBiLnN0YXJ0KTsNCg0KICAgIGNvbnN0IGZyZWUgPSBbXTsNCiAgICBsZXQgY3Vyc29yID0gc3RhcnQ7DQoNCiAgICBmb3IgKGNvbnN0IGIgb2YgYnVzeSkgew0KICAgICAgICBpZiAoYi5zdGFydCA+IGN1cnNvciAmJiBiLnN0YXJ0ID4gc3RhcnQgJiYgY3Vyc29yIDwgZW5kKSB7DQogICAgICAgICAgICBjb25zdCBmcmVlU3RhcnQgPSBNYXRoLm1heChjdXJzb3IsIHN0YXJ0KTsNCiAgICAgICAgICAgIGNvbnN0IGZyZWVFbmQgPSBNYXRoLm1pbihiLnN0YXJ0LCBlbmQpOw0KICAgICAgICAgICAgaWYgKGZyZWVFbmQgPiBmcmVlU3RhcnQpIHsNCiAgICAgICAgICAgICAgICBmcmVlLnB1c2goYCR7Zm9ybWF0VGltZShmcmVlU3RhcnQpfSAtICR7Zm9ybWF0VGltZShmcmVlRW5kKX1gKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICBjdXJzb3IgPSBNYXRoLm1heChjdXJzb3IsIGIuZW5kKTsNCiAgICB9DQoNCiAgICBpZiAoY3Vyc29yIDwgZW5kKSB7DQogICAgICAgIGZyZWUucHVzaChgJHtmb3JtYXRUaW1lKGN1cnNvcil9IC0gJHtmb3JtYXRUaW1lKGVuZCl9YCk7DQogICAgfQ0KDQogICAgcmV0dXJuIGZyZWUubGVuZ3RoID8gZnJlZS5qb2luKCc8YnI+JykgOiAnPGk+S2jDtG5nIGPDsm4gdHLhu5FuZzwvaT4nOw0KfQ0KDQpmdW5jdGlvbiBmb3JtYXRUaW1lKHNlYykgew0KICAgIGNvbnN0IGggPSBNYXRoLmZsb29yKHNlYyAvIDM2MDApOw0KICAgIGNvbnN0IG0gPSBNYXRoLmZsb29yKChzZWMgJSAzNjAwKSAvIDYwKTsNCiAgICByZXR1cm4gaC50b1N0cmluZygpLnBhZFN0YXJ0KDIsICcwJykgKyAnaCcgKyBtLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgJzAnKTsNCn0NCg0KZnVuY3Rpb24gc2hvd1Byb2NlZHVyZXNGb3JPcGVyYXRvcihvcGVyYXRvciwgZGF0ZSkgew0KICAgIGNvbnN0IG92ZXJsYXkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncHJvY2VkdXJlT3ZlcmxheScpOw0KICAgIGNvbnN0IGNvbnRlbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncG9wdXBDb250ZW50Jyk7DQogICAgY29uc3QgbGlzdCA9IGFsbFByb2NlZHVyZXMuZmlsdGVyKHAgPT4gcC5vcGVyYXRvciA9PT0gb3BlcmF0b3IgJiYgcC5kYXRlID09PSBkYXRlKTsNCg0KICAgIGlmIChsaXN0Lmxlbmd0aCA9PT0gMCkgew0KICAgICAgICBjb250ZW50LmlubmVySFRNTCA9ICI8aT5LaMO0bmcgdMOsbSB0aOG6pXkgdGjhu6cgdGh14bqtdDwvaT4iOw0KICAgIH0gZWxzZSB7DQogICAgICAgIGxpc3Quc29ydCgoYSwgYikgPT4gYS5zdGFydCAtIGIuc3RhcnQpOw0KICAgICAgICBjb250ZW50LmlubmVySFRNTCA9ICI8Yj5OZ8aw4budaSB0aOG7sWMgaGnhu4duOjwvYj4gIiArIG9wZXJhdG9yICsgIjxicj48Yj5OZ8OgeTo8L2I+ICIgKyBkYXRlICsgIjxicj48YnI+IiArDQogICAgICAgICAgICAiPHVsIHN0eWxlPSdwYWRkaW5nLWxlZnQ6MjBweCc+IiArIGxpc3QubWFwKHAgPT4gDQogICAgICAgICAgICAgICAgIjxsaT48Yj4iICsgcC5wYXRpZW50TmFtZSArICI8L2I+IC0gIiArIHAucHJvY2VkdXJlICsgIiAoIiArIHAuZGlzcGxheVN0YXJ0ICsgIiDihpIgIiArIHAuZGlzcGxheUVuZCArICIpPC9saT4iDQogICAgICAgICAgICApLmpvaW4oJycpICsgIjwvdWw+IjsNCiAgICB9DQoNCiAgICBvdmVybGF5LnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOw0KfQ0KDQpmdW5jdGlvbiBjbG9zZVByb2NlZHVyZVBvcHVwKCkgew0KICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwcm9jZWR1cmVPdmVybGF5Jykuc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCn0NCjwvc2NyaXB0Pg0KPCEtLSBQb3B1cCB0aOG7pyB0aHXhuq10IGNoaSB0aeG6v3QgduG7m2kgb3ZlcmxheSAtLT4NCjxkaXYgaWQ9InByb2NlZHVyZU92ZXJsYXkiIHN0eWxlPSJkaXNwbGF5Om5vbmU7cG9zaXRpb246Zml4ZWQ7dG9wOjA7bGVmdDowO3dpZHRoOjEwMCU7aGVpZ2h0OjEwMCU7YmFja2dyb3VuZDpyZ2JhKDAsMCwwLDAuNCk7ei1pbmRleDoxMDAwMCIgb25jbGljaz0iY2xvc2VQcm9jZWR1cmVQb3B1cCgpIj4NCiAgPGRpdiBpZD0icHJvY2VkdXJlUG9wdXAiIG9uY2xpY2s9ImV2ZW50LnN0b3BQcm9wYWdhdGlvbigpIiBzdHlsZT0icG9zaXRpb246cmVsYXRpdmU7dG9wOjEwJTtsZWZ0OjUwJTt0cmFuc2Zvcm06dHJhbnNsYXRlWCgtNTAlKTtiYWNrZ3JvdW5kOiNmZmY7Y29sb3I6IzAwMDtib3JkZXI6MnB4IHNvbGlkICMzNDk4ZGI7cGFkZGluZzoyMHB4O2JvcmRlci1yYWRpdXM6OHB4O2JveC1zaGFkb3c6MCA1cHggMjBweCByZ2JhKDAsMCwwLDAuMyk7bWF4LWhlaWdodDo3MHZoO292ZXJmbG93OmF1dG87Zm9udC1mYW1pbHk6SW50ZXIsc2Fucy1zZXJpZjttYXgtd2lkdGg6NjAwcHgiPg0KICAgIDxoMz5DaGkgdGnhur90IHRo4bunIHRodeG6rXQ8L2gzPg0KICAgIDxkaXYgaWQ9InBvcHVwQ29udGVudCI+PC9kaXY+DQogICAgPGJyLz4NCiAgICA8YnV0dG9uIGNsYXNzPSJidG4iIG9uY2xpY2s9ImNsb3NlUHJvY2VkdXJlUG9wdXAoKSI+xJDDs25nPC9idXR0b24+DQogIDwvZGl2Pg0KPC9kaXY+DQoNCg0KDQoNCg0KPHNjcmlwdD4NCmZ1bmN0aW9uIHJlbmRlckhlcmJMaXN0KCkgew0KICAgIGNvbnN0IHRib2R5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2hlcmJUYWJsZUJvZHknKTsNCiAgICB0Ym9keS5pbm5lckhUTUwgPSAnJzsNCg0KICAgIGNvbnN0IGhlcmJzID0gd2luZG93LmFsbEhlcmJQcm9jZWR1cmVzIHx8IFtdOw0KICAgIGNvbnN0IGRhdGVGaWx0ZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaGVyYkRhdGVGaWx0ZXInKTsNCiAgICBjb25zdCBkb2N0b3JGaWx0ZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaGVyYkRvY3RvckZpbHRlcicpOw0KDQogICAgaWYgKCFkYXRlRmlsdGVyLmRhdGFzZXQuaW5pdGlhbGl6ZWQpIHsNCiAgICAgICAgY29uc3QgdW5pcXVlRGF0ZXMgPSBbLi4ubmV3IFNldChoZXJicy5tYXAoaCA9PiBoLmRhdGUpKV0uc29ydCgoYSwgYikgPT4gew0KICAgICAgICAgICAgY29uc3QgW2RhLCBtYSwgeWFdID0gYS5zcGxpdCgnLycpLm1hcChOdW1iZXIpOw0KICAgICAgICAgICAgY29uc3QgW2RiLCBtYiwgeWJdID0gYi5zcGxpdCgnLycpLm1hcChOdW1iZXIpOw0KICAgICAgICAgICAgcmV0dXJuIG5ldyBEYXRlKHlhLCBtYSAtIDEsIGRhKSAtIG5ldyBEYXRlKHliLCBtYiAtIDEsIGRiKTsNCiAgICAgICAgfSk7DQoNCiAgICAgICAgY29uc3QgdW5pcXVlRG9jdG9ycyA9IFsuLi5uZXcgU2V0KGhlcmJzLm1hcChoID0+IGguZG9jdG9yIHx8ICdLaMO0bmcgY8OzJykpXS5zb3J0KCk7DQoNCiAgICAgICAgZGF0ZUZpbHRlci5pbm5lckhUTUwgPSAnPG9wdGlvbiB2YWx1ZT0iYWxsIj5U4bqldCBj4bqjPC9vcHRpb24+JyArDQogICAgICAgICAgICB1bmlxdWVEYXRlcy5tYXAoZCA9PiBgPG9wdGlvbiB2YWx1ZT0iJHtkfSI+JHtkfTwvb3B0aW9uPmApLmpvaW4oJycpOw0KDQogICAgICAgIGRvY3RvckZpbHRlci5pbm5lckhUTUwgPSAnPG9wdGlvbiB2YWx1ZT0iYWxsIj5U4bqldCBj4bqjIGLDoWMgc8SpPC9vcHRpb24+JyArDQogICAgICAgICAgICB1bmlxdWVEb2N0b3JzLm1hcChkID0+IGA8b3B0aW9uIHZhbHVlPSIke2R9Ij4ke2R9PC9vcHRpb24+YCkuam9pbignJyk7DQoNCiAgICAgICAgZGF0ZUZpbHRlci5kYXRhc2V0LmluaXRpYWxpemVkID0gInRydWUiOw0KICAgICAgICBkYXRlRmlsdGVyLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIHJlbmRlckhlcmJMaXN0KTsNCiAgICAgICAgZG9jdG9yRmlsdGVyLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIHJlbmRlckhlcmJMaXN0KTsNCiAgICB9DQoNCiAgICBjb25zdCBzZWxlY3RlZERhdGUgPSBkYXRlRmlsdGVyLnZhbHVlOw0KICAgIGNvbnN0IHNlbGVjdGVkRG9jdG9yID0gZG9jdG9yRmlsdGVyLnZhbHVlOw0KDQogICAgY29uc3QgZmlsdGVyZWRIZXJicyA9IGhlcmJzLmZpbHRlcihwID0+DQogICAgICAgIChzZWxlY3RlZERhdGUgPT09ICdhbGwnIHx8IHAuZGF0ZSA9PT0gc2VsZWN0ZWREYXRlKSAmJg0KICAgICAgICAoc2VsZWN0ZWREb2N0b3IgPT09ICdhbGwnIHx8IHAuZG9jdG9yID09PSBzZWxlY3RlZERvY3RvcikNCiAgICApOw0KDQogICAgaWYgKGZpbHRlcmVkSGVyYnMubGVuZ3RoID09PSAwKSB7DQogICAgICAgIGNvbnN0IHJvdyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RyJyk7DQogICAgICAgIHJvdy5jbGFzc0xpc3QuYWRkKCJoZXJiLXJvdyIpOw0KICAgICAgICByb3cuaW5uZXJIVE1MID0gYDx0ZCBjb2xzcGFuPSI1Ij48Y2VudGVyPktow7RuZyBjw7MgZOG7ryBsaeG7h3Ugc+G6r2MgdGh14buRYyB0aGFuZzwvY2VudGVyPjwvdGQ+YDsNCiAgICAgICAgdGJvZHkuYXBwZW5kQ2hpbGQocm93KTsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCg0KICAgIGZpbHRlcmVkSGVyYnMuZm9yRWFjaChwID0+IHsNCiAgICAgICAgY29uc3Qgcm93ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndHInKTsNCiAgICAgICAgcm93LmNsYXNzTGlzdC5hZGQoImhlcmItcm93Iik7DQogICAgICAgIHJvdy5pbm5lckhUTUwgPSBgDQogICAgICAgICAgICA8dGQ+JHtwLnBhdGllbnROYW1lfTwvdGQ+DQogICAgICAgICAgICA8dGQ+JHtwLnByb2NlZHVyZX08L3RkPg0KICAgICAgICAgICAgPHRkPiR7cC5kYXRlfTwvdGQ+DQogICAgICAgICAgICA8dGQ+JHtwLmRpc3BsYXlTdGFydH0g4oaSICR7cC5kaXNwbGF5RW5kfTwvdGQ+DQogICAgICAgICAgICA8dGQ+JHtwLm9wZXJhdG9yLnJlcGxhY2UoLywvZywgJycpfTwvdGQ+DQogICAgICAgIGA7DQogICAgICAgIHRib2R5LmFwcGVuZENoaWxkKHJvdyk7DQogICAgfSk7DQp9DQoNCg0KZnVuY3Rpb24gdG9nZ2xlSGVyYkxpc3QoKSB7DQogICAgY29uc3QgdGFibGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaGVyYlByb2NlZHVyZVRhYmxlJyk7DQogICAgaWYgKHRhYmxlLnN0eWxlLmRpc3BsYXkgPT09ICdub25lJykgew0KICAgICAgICB0YWJsZS5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsNCiAgICAgICAgcmVuZGVySGVyYkxpc3QoKTsNCiAgICB9IGVsc2Ugew0KICAgICAgICB0YWJsZS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOw0KICAgIH0NCn0NCjwvc2NyaXB0Pg0KDQoNCg0KPHNjcmlwdD4NCihmdW5jdGlvbigpew0KICAvKiA9PT09IFRJ4buGTiDDjUNIIENIVeG6qE4gSE/DgSBUw4pOID09PT0gKi8NCiAgZnVuY3Rpb24gY2xlYW5EaXNwbGF5KG5hbWUpew0KICAgIHJldHVybiAobmFtZXx8JycpDQogICAgICAudG9TdHJpbmcoKQ0KICAgICAgLnJlcGxhY2UoL1ss77yMXStccyokLywnJykNCiAgICAgIC5yZXBsYWNlKC9ccysvZywnICcpDQogICAgICAudHJpbSgpOw0KICB9DQogIGZ1bmN0aW9uIG5vcm0obmFtZSl7DQogICAgcmV0dXJuIGNsZWFuRGlzcGxheShuYW1lKS50b0xvd2VyQ2FzZSgpOw0KICB9DQoNCiAgLyogPT09PSBUw41OSCDEkEEgU+G7kCBUSEVPIE5Hw4BZID09PT0gKi8NCiAgZnVuY3Rpb24gY29tcHV0ZU1ham9yaXR5QnlEYXRlKHJvd3Mpew0KICAgIGNvbnN0IG1hcCA9IE9iamVjdC5jcmVhdGUobnVsbCk7DQogICAgcm93cy5mb3JFYWNoKHI9PnsNCiAgICAgIGNvbnN0IGQgPSByLmRhdGU7DQogICAgICBjb25zdCBuID0gbm9ybShyLm9wZXJhdG9yKTsNCiAgICAgIGlmKCFuIHx8IG4gPT09ICdraMO0bmcgY8OzJykgcmV0dXJuOw0KICAgICAgKG1hcFtkXXx8KG1hcFtkXT17fSkpW25dID0gKG1hcFtkXVtuXXx8MCkrMTsNCiAgICB9KTsNCiAgICBjb25zdCBvdXQgPSB7fTsNCiAgICBPYmplY3Qua2V5cyhtYXApLmZvckVhY2goZD0+ew0KICAgICAgY29uc3QgYXJyID0gT2JqZWN0LmVudHJpZXMobWFwW2RdKS5zb3J0KChhLGIpPT5iWzFdLWFbMV0pOw0KICAgICAgY29uc3QgdG9wID0gYXJyWzBdIHx8IFtudWxsLDBdOw0KICAgICAgY29uc3Qgc2Vjb25kID0gYXJyWzFdIHx8IFtudWxsLDBdOw0KICAgICAgb3V0W2RdID0geyB0b3BOb3JtOnRvcFswXSwgdG9wQ291bnQ6dG9wWzFdLCBzZWNvbmRDb3VudDpzZWNvbmRbMV0gfTsNCiAgICB9KTsNCiAgICByZXR1cm4gb3V0Ow0KICB9DQoNCiAgLyogPT09PSBVSSBQSOG7pDogVMOTTSBU4bquVCArIFBPUFVQID09PT0gKi8NCiAgZnVuY3Rpb24gZW5zdXJlT3V0bGllclVJKCl7DQogICAgY29uc3Qgc3VtbWFyeSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdoZXJiT3V0bGllclN1bW1hcnknKTsNCiAgICBjb25zdCBtb2RhbCAgID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2hlcmJPdXRsaWVyTW9kYWwnKTsNCiAgICBpZighc3VtbWFyeSkgY29uc29sZS53YXJuKCdUaGnhur91ICNoZXJiT3V0bGllclN1bW1hcnkgdHJvbmcgSFRNTCEnKTsNCiAgICBpZighbW9kYWwpICAgY29uc29sZS53YXJuKCdUaGnhur91ICNoZXJiT3V0bGllck1vZGFsIHRyb25nIEhUTUwhJyk7DQogICAgY29uc3QgYnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2hlcmJPdXRsaWVyQ2xvc2VCdG4nKTsNCiAgICBjb25zdCBiYWNrZHJvcCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdoZXJiT3V0bGllckJhY2tkcm9wJyk7DQogICAgaWYoYnRuKSBidG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKT0+bW9kYWwuc3R5bGUuZGlzcGxheT0nbm9uZScpOw0KICAgIGlmKGJhY2tkcm9wKSBiYWNrZHJvcC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpPT5tb2RhbC5zdHlsZS5kaXNwbGF5PSdub25lJyk7DQogIH0NCiAgZW5zdXJlT3V0bGllclVJKCk7DQoNCiAgLyogPT09PSBHSEkgxJDDiCBIw4BNIFJFTkRFUiA9PT09ICovDQogIHdpbmRvdy5yZW5kZXJIZXJiTGlzdCA9IGZ1bmN0aW9uKCl7DQogICAgY29uc3QgdGJvZHkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaGVyYlRhYmxlQm9keScpOw0KICAgIGNvbnN0IGRhdGVGaWx0ZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaGVyYkRhdGVGaWx0ZXInKTsNCiAgICBjb25zdCBkb2N0b3JGaWx0ZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaGVyYkRvY3RvckZpbHRlcicpOw0KICAgIGNvbnN0IHN1bW1hcnlEaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaGVyYk91dGxpZXJTdW1tYXJ5Jyk7DQogICAgY29uc3QgbW9kYWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaGVyYk91dGxpZXJNb2RhbCcpOw0KICAgIGNvbnN0IG1vZGFsQm9keSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdoZXJiT3V0bGllck1vZGFsQm9keScpOw0KICAgIGNvbnN0IG1vZGFsSW5mbyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdoZXJiT3V0bGllck1vZGFsSW5mbycpOw0KDQogICAgdGJvZHkuaW5uZXJIVE1MID0gJyc7DQoNCiAgICBjb25zdCBoZXJic1JhdyA9IHdpbmRvdy5hbGxIZXJiUHJvY2VkdXJlcyB8fCBbXTsNCiAgICBjb25zdCBoZXJicyA9IGhlcmJzUmF3Lm1hcChoPT4oew0KICAgICAgLi4uaCwNCiAgICAgIG9wQ2xlYW46IGNsZWFuRGlzcGxheShoLm9wZXJhdG9yKSwNCiAgICAgIG9wTm9ybTogbm9ybShoLm9wZXJhdG9yKQ0KICAgIH0pKTsNCg0KICAgIGlmKCFkYXRlRmlsdGVyLmRhdGFzZXQuaW5pdGlhbGl6ZWQpew0KICAgICAgY29uc3QgdW5pcXVlRGF0ZXMgPSBbLi4ubmV3IFNldChoZXJicy5tYXAoaD0+aC5kYXRlKSldLnNvcnQoKGEsYik9PnsNCiAgICAgICAgY29uc3QgW2RhLG1hLHlhXSA9IGEuc3BsaXQoJy8nKS5tYXAoTnVtYmVyKTsNCiAgICAgICAgY29uc3QgW2RiLG1iLHliXSA9IGIuc3BsaXQoJy8nKS5tYXAoTnVtYmVyKTsNCiAgICAgICAgcmV0dXJuIG5ldyBEYXRlKHlhLG1hLTEsZGEpIC0gbmV3IERhdGUoeWIsbWItMSxkYik7DQogICAgICB9KTsNCiAgICAgIGNvbnN0IHVuaXF1ZURvY3RvcnMgPSBbLi4ubmV3IFNldChoZXJicy5tYXAoaD0+aC5kb2N0b3J8fCdLaMO0bmcgY8OzJykpXS5zb3J0KCk7DQogICAgICBkYXRlRmlsdGVyLmlubmVySFRNTCA9DQogICAgICAgICc8b3B0aW9uIHZhbHVlPSJhbGwiPlThuqV0IGPhuqM8L29wdGlvbj4nICsNCiAgICAgICAgdW5pcXVlRGF0ZXMubWFwKGQ9PmA8b3B0aW9uIHZhbHVlPSIke2R9Ij4ke2R9PC9vcHRpb24+YCkuam9pbignJyk7DQogICAgICBkb2N0b3JGaWx0ZXIuaW5uZXJIVE1MID0NCiAgICAgICAgJzxvcHRpb24gdmFsdWU9ImFsbCI+VOG6pXQgY+G6oyBiw6FjIHPEqTwvb3B0aW9uPicgKw0KICAgICAgICB1bmlxdWVEb2N0b3JzLm1hcChkPT5gPG9wdGlvbiB2YWx1ZT0iJHtkfSI+JHtkfTwvb3B0aW9uPmApLmpvaW4oJycpOw0KICAgICAgZGF0ZUZpbHRlci5kYXRhc2V0LmluaXRpYWxpemVkID0gJ3RydWUnOw0KICAgICAgZGF0ZUZpbHRlci5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCB3aW5kb3cucmVuZGVySGVyYkxpc3QpOw0KICAgICAgZG9jdG9yRmlsdGVyLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIHdpbmRvdy5yZW5kZXJIZXJiTGlzdCk7DQogICAgfQ0KDQogICAgY29uc3Qgc2VsZWN0ZWREYXRlID0gZGF0ZUZpbHRlci52YWx1ZTsNCiAgICBjb25zdCBzZWxlY3RlZERvY3RvciA9IGRvY3RvckZpbHRlci52YWx1ZTsNCg0KICAgIGNvbnN0IGZpbHRlcmVkID0gaGVyYnMuZmlsdGVyKHAgPT4NCiAgICAgIChzZWxlY3RlZERhdGUgPT09ICdhbGwnIHx8IHAuZGF0ZSA9PT0gc2VsZWN0ZWREYXRlKSAmJg0KICAgICAgKHNlbGVjdGVkRG9jdG9yID09PSAnYWxsJyB8fCBwLmRvY3RvciA9PT0gc2VsZWN0ZWREb2N0b3IpDQogICAgKTsNCg0KICAgIGlmKGZpbHRlcmVkLmxlbmd0aCA9PT0gMCl7DQogICAgICBjb25zdCB0ciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RyJyk7DQogICAgICB0ci5jbGFzc05hbWUgPSAnaGVyYi1yb3cnOw0KICAgICAgdHIuaW5uZXJIVE1MID0gJzx0ZCBjb2xzcGFuPSI1Ij48Y2VudGVyPktow7RuZyBjw7MgZOG7ryBsaeG7h3Ugc+G6r2MgdGh14buRYyB0aGFuZzwvY2VudGVyPjwvdGQ+JzsNCiAgICAgIHRib2R5LmFwcGVuZENoaWxkKHRyKTsNCiAgICAgIGlmKHN1bW1hcnlEaXYpIHN1bW1hcnlEaXYuc3R5bGUuZGlzcGxheT0nbm9uZSc7DQogICAgICByZXR1cm47DQogICAgfQ0KDQogICAgY29uc3QgbWFqb3JpdHkgPSBjb21wdXRlTWFqb3JpdHlCeURhdGUoaGVyYnMpOw0KICAgIGNvbnN0IG91dGxpZXJzSW5WaWV3ID0gW107DQoNCiAgICBmaWx0ZXJlZC5mb3JFYWNoKHA9PnsNCiAgICAgIGNvbnN0IHRyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndHInKTsNCiAgICAgIHRyLmNsYXNzTmFtZSA9ICdoZXJiLXJvdyc7DQogICAgICBjb25zdCBtID0gbWFqb3JpdHlbcC5kYXRlXTsNCiAgICAgIGNvbnN0IGhhc01ham9yaXR5ID0gbSAmJiBtLnRvcE5vcm0gJiYgbS50b3BDb3VudCA+IG0uc2Vjb25kQ291bnQ7DQogICAgICBpZihoYXNNYWpvcml0eSAmJiBwLm9wTm9ybSAhPT0gbS50b3BOb3JtKXsNCiAgICAgICAgdHIuY2xhc3NMaXN0LmFkZCgnaGVyYi1vdXRsaWVyJyk7DQogICAgICAgIG91dGxpZXJzSW5WaWV3LnB1c2gocCk7DQogICAgICB9DQogICAgICB0ci5pbm5lckhUTUwgPSBgDQogICAgICAgIDx0ZD4ke3AucGF0aWVudE5hbWV9PC90ZD4NCiAgICAgICAgPHRkPiR7cC5wcm9jZWR1cmV9PC90ZD4NCiAgICAgICAgPHRkPiR7cC5kYXRlfTwvdGQ+DQogICAgICAgIDx0ZD4ke3AuZGlzcGxheVN0YXJ0fSAmcmFycjsgJHtwLmRpc3BsYXlFbmR9PC90ZD4NCiAgICAgICAgPHRkPiR7cC5vcENsZWFufTwvdGQ+DQogICAgICBgOw0KICAgICAgdGJvZHkuYXBwZW5kQ2hpbGQodHIpOw0KICAgIH0pOw0KDQogICAgaWYoc3VtbWFyeURpdil7DQogICAgICBpZihvdXRsaWVyc0luVmlldy5sZW5ndGgpew0KICAgICAgICBzdW1tYXJ5RGl2LnN0eWxlLmRpc3BsYXk9J2Jsb2NrJzsNCiAgICAgICAgc3VtbWFyeURpdi5pbm5lckhUTUwgPQ0KICAgICAgICAgIGA8YSBocmVmPSIjIiBpZD0iaGVyYk91dGxpZXJDb3VudExpbmsiPkPDsyAke291dGxpZXJzSW5WaWV3Lmxlbmd0aH0gY2EgY8OzIHbhuqVuIMSR4buBIHRyb25nIGRhbmggc8OhY2ggbsOgeS48L2E+YDsNCiAgICAgICAgY29uc3QgbGluayA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdoZXJiT3V0bGllckNvdW50TGluaycpOw0KICAgICAgICBsaW5rLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oZXYpew0KICAgICAgICAgIGV2LnByZXZlbnREZWZhdWx0KCk7DQogICAgICAgICAgaWYobW9kYWxCb2R5KXsNCiAgICAgICAgICAgIG1vZGFsQm9keS5pbm5lckhUTUwgPSAnJzsNCiAgICAgICAgICAgIG91dGxpZXJzSW5WaWV3LmZvckVhY2gocD0+ew0KICAgICAgICAgICAgICBjb25zdCB0ciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RyJyk7DQogICAgICAgICAgICAgIHRyLmlubmVySFRNTCA9IGANCiAgICAgICAgICAgICAgICA8dGQ+JHtwLnBhdGllbnROYW1lfTwvdGQ+DQogICAgICAgICAgICAgICAgPHRkPiR7cC5wcm9jZWR1cmV9PC90ZD4NCiAgICAgICAgICAgICAgICA8dGQ+JHtwLmRhdGV9PC90ZD4NCiAgICAgICAgICAgICAgICA8dGQ+JHtwLmRpc3BsYXlTdGFydH0gJnJhcnI7ICR7cC5kaXNwbGF5RW5kfTwvdGQ+DQogICAgICAgICAgICAgICAgPHRkPiR7cC5vcENsZWFufTwvdGQ+DQogICAgICAgICAgICAgIGA7DQogICAgICAgICAgICAgIG1vZGFsQm9keS5hcHBlbmRDaGlsZCh0cik7DQogICAgICAgICAgICB9KTsNCiAgICAgICAgICB9DQogICAgICAgICAgaWYobW9kYWxJbmZvKXsNCiAgICAgICAgICAgIGNvbnN0IG5vdGVEYXRlID0gKHNlbGVjdGVkRGF0ZT09PSdhbGwnKSA/ICduaGnhu4F1IG5nw6B5JyA6IHNlbGVjdGVkRGF0ZTsNCiAgICAgICAgICAgIG1vZGFsSW5mby50ZXh0Q29udGVudCA9IGBU4buVbmcgJHtvdXRsaWVyc0luVmlldy5sZW5ndGh9IGNhIGtow6FjIMSRYSBz4buRICgke25vdGVEYXRlfSkuYDsNCiAgICAgICAgICB9DQogICAgICAgICAgaWYobW9kYWwpIG1vZGFsLnN0eWxlLmRpc3BsYXk9J2Jsb2NrJzsNCiAgICAgICAgfSwge29uY2U6dHJ1ZX0pOw0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgc3VtbWFyeURpdi5zdHlsZS5kaXNwbGF5PSdub25lJzsNCiAgICAgICAgc3VtbWFyeURpdi5pbm5lckhUTUw9Jyc7DQogICAgICB9DQogICAgfQ0KICB9Ow0KDQogIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCAoKT0+ew0KICAgIGNvbnN0IHRhYmxlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2hlcmJQcm9jZWR1cmVUYWJsZScpOw0KICAgIGlmKHRhYmxlICYmIHRhYmxlLnN0eWxlLmRpc3BsYXkgIT09ICdub25lJyl7DQogICAgICB3aW5kb3cucmVuZGVySGVyYkxpc3QoKTsNCiAgICB9DQogIH0pOw0KfSkoKTsNCg0KDQoNCg0KPC9zY3JpcHQ+DQo8c2NyaXB0Pg0KICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCJET01Db250ZW50TG9hZGVkIiwgZnVuY3Rpb24gKCkgew0KICAgIGNvbnN0IGZpbGVJbnB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmaWxlSW5wdXQnKTsNCiAgICBjb25zdCBhbmFseXplQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2FuYWx5emVCdG4nKTsNCiAgICBpZiAoZmlsZUlucHV0ICYmIGFuYWx5emVCdG4pIHsNCiAgICAgIGZpbGVJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBmdW5jdGlvbiAoKSB7DQogICAgICAgIGFuYWx5emVCdG4uY2xpY2soKTsNCiAgICAgIH0pOw0KICAgIH0NCiAgfSk7DQo8L3NjcmlwdD4NCg0KDQo8IS0tIFRIRU1FIFBJQ0tFUiBTQ1JJUFQgLS0+DQo8c2NyaXB0Pg0KKGZ1bmN0aW9uKCl7DQogIGNvbnN0IFRIRU1FX0tFWSA9ICd1aUFjY2VudFRoZW1lJzsNCiAgY29uc3QgYm9keSA9IGRvY3VtZW50LmJvZHk7DQogIGNvbnN0IHBpY2tlciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0aGVtZVBpY2tlcicpOw0KICBpZighcGlja2VyKSByZXR1cm47DQogIGZ1bmN0aW9uIGFwcGx5VGhlbWUodCl7DQogICAgYm9keS5jbGFzc0xpc3QucmVtb3ZlKCd0aGVtZS1kZWZhdWx0JywndGhlbWUtb3JhbmdlJywndGhlbWUtcmVkJywndGhlbWUtZ3JlZW4nKTsNCiAgICBpZih0ICYmIHQgIT09ICdkZWZhdWx0Jyl7DQogICAgICBib2R5LmNsYXNzTGlzdC5hZGQoJ3RoZW1lLScrdCk7DQogICAgfSBlbHNlIHsNCiAgICAgIGJvZHkuY2xhc3NMaXN0LmFkZCgndGhlbWUtZGVmYXVsdCcpOyAvLyBleHBsaWNpdCDEkeG7gyBhY3RpdmUgcmluZw0KICAgIH0NCiAgICBwaWNrZXIucXVlcnlTZWxlY3RvckFsbCgnLnRoZW1lLXN3YXRjaCcpLmZvckVhY2goYnRuPT57DQogICAgICBidG4uY2xhc3NMaXN0LnRvZ2dsZSgnaXMtYWN0aXZlJywgYnRuLmRhdGFzZXQudGhlbWU9PT10IHx8ICh0PT09JycgJiYgYnRuLmRhdGFzZXQudGhlbWU9PT0nZGVmYXVsdCcpKTsNCiAgICB9KTsNCiAgICB0cnl7IGxvY2FsU3RvcmFnZS5zZXRJdGVtKFRIRU1FX0tFWSx0fHwnZGVmYXVsdCcpOyB9Y2F0Y2goZSl7fQ0KICB9DQogIGNvbnN0IHNhdmVkID0gKGZ1bmN0aW9uKCl7dHJ5e3JldHVybiBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShUSEVNRV9LRVkpIHx8ICdkZWZhdWx0Jzt9Y2F0Y2goZSl7cmV0dXJuICdkZWZhdWx0Jzt9fSkoKTsNCiAgYXBwbHlUaGVtZShzYXZlZCk7DQogIHBpY2tlci5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsZT0+ew0KICAgIGNvbnN0IGJ0biA9IGUudGFyZ2V0LmNsb3Nlc3QoJy50aGVtZS1zd2F0Y2gnKTsNCiAgICBpZighYnRuKSByZXR1cm47DQogICAgYXBwbHlUaGVtZShidG4uZGF0YXNldC50aGVtZSk7DQogIH0pOw0KfSkoKTsNCjwvc2NyaXB0Pg0KDQo8c2NyaXB0Pg0KZnVuY3Rpb24gdXBkYXRlSGVyYkJ1dHRvbldpdGhPdXRsaWVyQ291bnQoKSB7DQogIGNvbnN0IGJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdoZXJiVG9nZ2xlQnRuJyk7DQogIGlmICghYnRuIHx8ICF3aW5kb3cuYWxsSGVyYlByb2NlZHVyZXMpIHJldHVybjsNCg0KICBjb25zdCBoZXJicyA9IHdpbmRvdy5hbGxIZXJiUHJvY2VkdXJlczsNCiAgY29uc3QgY291bnRzID0ge307DQoNCiAgaGVyYnMuZm9yRWFjaChoID0+IHsNCiAgICBjb25zdCBkYXRlID0gaC5kYXRlOw0KICAgIGNvbnN0IGtleSA9IGRhdGU7DQogICAgaWYgKCFjb3VudHNba2V5XSkgY291bnRzW2tleV0gPSB7fTsNCiAgICBjb25zdCBuYW1lID0gKGgub3BlcmF0b3IgfHwgJ0tow7RuZyBjw7MnKS50cmltKCkudG9Mb3dlckNhc2UoKTsNCiAgICBjb3VudHNba2V5XVtuYW1lXSA9IChjb3VudHNba2V5XVtuYW1lXSB8fCAwKSArIDE7DQogIH0pOw0KDQogIGxldCBvdXRsaWVyQ291bnQgPSAwOw0KDQogIE9iamVjdC5rZXlzKGNvdW50cykuZm9yRWFjaChkYXRlID0+IHsNCiAgICBjb25zdCBvcHMgPSBjb3VudHNbZGF0ZV07DQogICAgY29uc3QgZW50cmllcyA9IE9iamVjdC5lbnRyaWVzKG9wcykuc29ydCgoYSwgYikgPT4gYlsxXSAtIGFbMV0pOw0KICAgIGNvbnN0IHRvcCA9IGVudHJpZXNbMF07DQogICAgaWYgKCF0b3ApIHJldHVybjsNCg0KICAgIGNvbnN0IHRvcE5hbWUgPSB0b3BbMF07DQogICAgY29uc3QgdG9wQ291bnQgPSB0b3BbMV07DQoNCiAgICBmb3IgKGNvbnN0IFtuYW1lLCBjb3VudF0gb2YgZW50cmllcykgew0KICAgICAgaWYgKG5hbWUgIT09IHRvcE5hbWUgJiYgY291bnQgPiAwKSB7DQogICAgICAgIG91dGxpZXJDb3VudCArPSBjb3VudDsNCiAgICAgIH0NCiAgICB9DQogIH0pOw0KDQpidG4uaW5uZXJIVE1MID0gYFPhuq9jIHRodeG7kWMgdGhhbmcgPGkgY2xhc3M9ImZhLXNvbGlkIGZhLXRyaWFuZ2xlLWV4Y2xhbWF0aW9uIiBzdHlsZT0iY29sb3I6eWVsbG93Ij48L2k+IDxzcGFuIHN0eWxlPSJjb2xvcjp5ZWxsb3c7IGZvbnQtd2VpZ2h0OmJvbGQiPigke291dGxpZXJDb3VudH0pPC9zcGFuPmA7DQoNCg0KfQ0KPC9zY3JpcHQ+DQo8ZGl2IGlkPSJkcm9wYm94UGFuZWwiIHN0eWxlPSJkaXNwbGF5Om5vbmU7IHBvc2l0aW9uOmZpeGVkOyBpbnNldDowOyBiYWNrZ3JvdW5kOnJnYmEoMCwwLDAsMC41KTsgei1pbmRleDo5OTk5OyI+DQogIDxkaXYgc3R5bGU9Im1hcmdpbjo1JSBhdXRvOyBiYWNrZ3JvdW5kOiNmZmY7IHBhZGRpbmc6MjBweDsgbWF4LXdpZHRoOjkwJTsgYm9yZGVyLXJhZGl1czoxMHB4OyBtYXgtaGVpZ2h0Ojgwdmg7IG92ZXJmbG93OmF1dG8iPg0KICAgPGRpdiBzdHlsZT0iZGlzcGxheTogZmxleDsganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuOyBhbGlnbi1pdGVtczogY2VudGVyOyI+DQogIDxoMz7wn5OCIERhbmggc8OhY2ggS2hvYSDEkcOjIHPhu60gZOG7pW5nIHBo4bqnbiBt4buBbTwvaDM+DQogIDxidXR0b24gY2xhc3M9ImJ0biIgb25jbGljaz0iZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Ryb3Bib3hQYW5lbCcpLnN0eWxlLmRpc3BsYXk9J25vbmUnIj4NCiAgICDEkMOzbmcNCiAgPC9idXR0b24+DQo8L2Rpdj4NCjwhLS0gUGFnaW5hdGlvbiBjb250cm9scyAtLT4NCjxkaXYgaWQ9ImRyb3Bib3hQYWdlciIgc3R5bGU9ImRpc3BsYXk6ZmxleDthbGlnbi1pdGVtczpjZW50ZXI7Z2FwOjhweDtqdXN0aWZ5LWNvbnRlbnQ6c3BhY2UtYmV0d2VlbjttYXJnaW4tdG9wOjEycHgiPg0KICA8ZGl2Pg0KICAgIEhp4buDbiB0aOG7iw0KICAgIDxzZWxlY3QgaWQ9ImRyb3Bib3hQYWdlU2l6ZSIgc3R5bGU9InBhZGRpbmc6NnB4IDhweDtib3JkZXI6MXB4IHNvbGlkICNkZGQ7Ym9yZGVyLXJhZGl1czo2cHgiPg0KICAgICAgPG9wdGlvbiB2YWx1ZT0iMTAiIHNlbGVjdGVkPjEwPC9vcHRpb24+DQogICAgICA8b3B0aW9uIHZhbHVlPSIyMCI+MjA8L29wdGlvbj4NCiAgICAgIDxvcHRpb24gdmFsdWU9IjUwIj41MDwvb3B0aW9uPg0KICAgIDwvc2VsZWN0Pg0KICAgIGTDsm5nIC8gdHJhbmcNCiAgPC9kaXY+DQoNCiAgPGRpdiBpZD0iZHJvcGJveFBhZ2VCdXR0b25zIiBzdHlsZT0iZGlzcGxheTpmbGV4O2dhcDo2cHg7ZmxleC13cmFwOndyYXAiPjwvZGl2Pg0KDQogIDxkaXYgaWQ9ImRyb3Bib3hQYWdlSW5mbyIgc3R5bGU9Im1pbi13aWR0aDoxNzBweDt0ZXh0LWFsaWduOnJpZ2h0Ij48L2Rpdj4NCjwvZGl2Pg0KICAgIDx0YWJsZSBib3JkZXI9IjEiIGNlbGxwYWRkaW5nPSI4IiBzdHlsZT0id2lkdGg6MTAwJTsgYm9yZGVyLWNvbGxhcHNlOmNvbGxhcHNlOyBmb250LXNpemU6MTRweCI+DQogICAgICA8dGhlYWQ+DQogICAgICAgIDx0cj4NCiAgICAgICAgICA8dGg+U1RUPC90aD4NCiAgICAgICAgICA8dGg+VMOqbiBraG9hPC90aD4NCiAgICAgICAgICA8dGg+TmfDoHk8L3RoPg0KICAgICAgICAgIA0KICAgICAgIA0KICAgICAgICAgIDx0aD5UaOG7nWkgZ2lhbiB1cGxvYWQ8L3RoPg0KCQkgIDx0aD5MaW5rPC90aD4NCgkJICA8dGg+SMOgbmggxJHhu5luZzwvdGg+DQogICAgICAgIDwvdHI+DQogICAgICA8L3RoZWFkPg0KICAgICAgPHRib2R5IGlkPSJkcm9wYm94RmlsZUxpc3QiPjwvdGJvZHk+DQogICAgPC90YWJsZT4NCiAgDQogIDwvZGl2Pg0KPC9kaXY+PHNjcmlwdD4NCmFzeW5jIGZ1bmN0aW9uIHNob3dEcm9wYm94UGFuZWwoKSB7DQphd2FpdCBlbnN1cmVEcm9wYm94KCk7IC8vIMSR4bqjbSBi4bqjbyBjw7MgRHJvcGJveCBTREsNCg0KICBjb25zdCBhY2Nlc3NUb2tlbiA9IGF3YWl0IGdldEFjY2Vzc1Rva2VuKCk7DQogIGNvbnN0IGRieCA9IG5ldyBEcm9wYm94LkRyb3Bib3goeyBhY2Nlc3NUb2tlbiB9KTsNCiAgY29uc3QgdGJvZHkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZHJvcGJveEZpbGVMaXN0Jyk7DQoNCiAgLy8gSGnhu4duIHBvcHVwIG5nYXkgbOG6rXAgdOG7qWMgduG7m2kgdHLhuqFuZyB0aMOhaSBsb2FkaW5nDQogIHRib2R5LmlubmVySFRNTCA9IGA8dHI+PHRkIGNvbHNwYW49IjYiIHN0eWxlPSJ0ZXh0LWFsaWduOmNlbnRlcjsgY29sb3I6Ymx1ZTsiPg0KICAgIMSQYW5nIHThuqNpIGThu68gbGnhu4d1Li4uDQogIDwvdGQ+PC90cj5gOw0KICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZHJvcGJveFBhbmVsJykuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7DQoNCiAgdHJ5IHsNCiAgICAvLyAxKSBLaeG7g20gdHJhIHThu5NuIHThuqFpIGxvZy5qc29uDQogICAgbGV0IGhhc0xvZyA9IGZhbHNlOw0KICAgIGxldCByZXMgPSBhd2FpdCBkYnguZmlsZXNMaXN0Rm9sZGVyKHsgcGF0aDogJy90aHV0aHVhdCcgfSk7DQogICAgd2hpbGUgKHRydWUpIHsNCiAgICAgIGlmIChyZXMucmVzdWx0Py5lbnRyaWVzPy5zb21lKGUgPT4gZVsnLnRhZyddID09PSAnZmlsZScgJiYgZS5uYW1lID09PSAnbG9nLmpzb24nKSkgew0KICAgICAgICBoYXNMb2cgPSB0cnVlOw0KICAgICAgICBicmVhazsNCiAgICAgIH0NCiAgICAgIGlmICghcmVzLnJlc3VsdD8uaGFzX21vcmUpIGJyZWFrOw0KICAgICAgcmVzID0gYXdhaXQgZGJ4LmZpbGVzTGlzdEZvbGRlckNvbnRpbnVlKHsgY3Vyc29yOiByZXMucmVzdWx0LmN1cnNvciB9KTsNCiAgICB9DQoNCiAgICAvLyAyKSBO4bq/dSBraMO0bmcgY8OzIGZpbGUg4oaSIGPhuq1wIG5o4bqtdCBu4buZaSBkdW5nDQogICAgaWYgKCFoYXNMb2cpIHsNCiAgICAgIHRib2R5LmlubmVySFRNTCA9IGA8dHI+PHRkIGNvbHNwYW49IjYiIHN0eWxlPSJ0ZXh0LWFsaWduOmNlbnRlcjsgY29sb3I6cmVkOyI+DQogICAgICAgIEtow7RuZyBjw7MgZGFuaCBzw6FjaCBuw6BvIMSRxrDhu6NjIGzGsHUNCiAgICAgIDwvdGQ+PC90cj5gOw0KICAgICAgcmV0dXJuOw0KICAgIH0NCg0KICAgIC8vIDMpIEPDsyBmaWxlIOKGkiB04bqjaSB2w6AgaGnhu4NuIHRo4buLDQogICAgY29uc3QgZGwgPSBhd2FpdCBkYnguZmlsZXNEb3dubG9hZCh7IHBhdGg6ICcvdGh1dGh1YXQvbG9nLmpzb24nIH0pOw0KICAgIGNvbnN0IHRleHQgPSBhd2FpdCBkbC5yZXN1bHQuZmlsZUJsb2IudGV4dCgpOw0KICAgIGxldCBsb2dzID0gW107DQogICAgdHJ5IHsgbG9ncyA9IEpTT04ucGFyc2UodGV4dCk7IH0gY2F0Y2ggeyBsb2dzID0gW107IH0NCg0KICAgIGlmICghbG9ncy5sZW5ndGgpIHsNCiAgICAgIHRib2R5LmlubmVySFRNTCA9IGA8dHI+PHRkIGNvbHNwYW49IjYiIHN0eWxlPSJ0ZXh0LWFsaWduOmNlbnRlcjsgY29sb3I6cmVkOyI+DQogICAgICAgIEtow7RuZyBjw7MgZGFuaCBzw6FjaCBuw6BvIMSRxrDhu6NjIGzGsHUNCiAgICAgIDwvdGQ+PC90cj5gOw0KICAgIH0gZWxzZSB7DQogY29uc3QgY3VycmVudFVzZXIgPSAoc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbSgnbWVkVXNlcicpIHx8ICcnKS50b0xvd2VyQ2FzZSgpOw0KDQovLyBSZW5kZXIgbeG7m2kg4oCTIGdpYW8gY2hvIGLhu5kgcGjDom4gdHJhbmc6DQpEQl9MT0dTID0gbG9nczsgLy8gbeG6o25nIGThu68gbGnhu4d1IMSR4bqneSDEkeG7pw0KREJfUEFHRSA9IDE7ICAgIC8vIHbhu4EgdHJhbmcgMSBt4buXaSBraGkgbeG7nyBwYW5lbA0KREJfQ1VSUkVOVF9VU0VSID0gKHNlc3Npb25TdG9yYWdlLmdldEl0ZW0oJ21lZFVzZXInKSB8fCAnJykudG9Mb3dlckNhc2UoKTsNCg0KYXR0YWNoUGFnZXJFdmVudHNPbmNlKCk7IC8vIGfhuq9uIGNoYW5nZSBjaG8gc2VsZWN0IHBhZ2Ugc2l6ZSAoY2jhu4kgMSBs4bqnbikNCnJlbmRlckRyb3Bib3hQYWdlKCk7ICAgICAvLyB24bq9IHRib2R5ICsgbsO6dCB0cmFuZyB04burIERCX0xPR1MNCiAgICB9DQogIH0gY2F0Y2ggKGVycikgew0KICAgIGNvbnNvbGUuZXJyb3IoJ0zhu5dpIGtoaSDEkeG7jWMgZGFuaCBzw6FjaCB04burIERyb3Bib3g6JywgZXJyKTsNCiAgICB0Ym9keS5pbm5lckhUTUwgPSBgPHRyPjx0ZCBjb2xzcGFuPSI2IiBzdHlsZT0idGV4dC1hbGlnbjpjZW50ZXI7IGNvbG9yOnJlZDsiPg0KICAgICAgS2jDtG5nIHRo4buDIHThuqNpIGThu68gbGnhu4d1DQogICAgPC90ZD48L3RyPmA7DQogIH0NCn0NCihmdW5jdGlvbigpew0KICBjb25zdCBwYWdlciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkcm9wYm94UGFnZXInKTsNCiAgaWYgKHBhZ2VyICYmICFwYWdlci5kYXRhc2V0LmJvdW5kKSB7DQogICAgcGFnZXIuZGF0YXNldC5ib3VuZCA9ICcxJzsNCiAgICBwYWdlci5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGUgPT4gZS5zdG9wUHJvcGFnYXRpb24oKSk7DQogICAgcGFnZXIuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgZSA9PiBlLnN0b3BQcm9wYWdhdGlvbigpKTsNCiAgfQ0KfSkoKTsNCg0KPC9zY3JpcHQ+DQo8c2NyaXB0Pg0KZnVuY3Rpb24gdmVyaWZ5QW5kT3BlbkxpbmsodXJsKSB7DQoNCg0KICAvLyBPdmVybGF5IHThu5FpIChjbGljayB2w6BvIHPhur0gdOG6r3QpDQogIGNvbnN0IG92ZXJsYXkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsNCiAgT2JqZWN0LmFzc2lnbihvdmVybGF5LnN0eWxlLCB7DQogICAgcG9zaXRpb246ICdmaXhlZCcsIGluc2V0OiAnMCcsIGJhY2tncm91bmQ6ICdyZ2JhKDAsMCwwLDAuNSknLA0KICAgIGRpc3BsYXk6ICdmbGV4JywganVzdGlmeUNvbnRlbnQ6ICdjZW50ZXInLCBhbGlnbkl0ZW1zOiAnY2VudGVyJywNCiAgICB6SW5kZXg6ICcxMDAwMCcNCiAgfSk7DQoNCiAgLy8gS2h1bmcgcG9wdXANCiAgY29uc3QgYm94ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7DQogIE9iamVjdC5hc3NpZ24oYm94LnN0eWxlLCB7DQogICAgYmFja2dyb3VuZDogJyNmZmYnLCBwYWRkaW5nOiAnMjRweCcsIGJvcmRlclJhZGl1czogJzEwcHgnLA0KICAgIG1heFdpZHRoOiAnNDIwcHgnLCB3aWR0aDogJzkwJScsIGJveFNoYWRvdzogJzAgNHB4IDEwcHggcmdiYSgwLDAsMCwwLjMpJywNCiAgICBkaXNwbGF5OiAnZmxleCcsIGZsZXhEaXJlY3Rpb246ICdjb2x1bW4nLCBhbGlnbkl0ZW1zOiAnY2VudGVyJywgZ2FwOiAnMTJweCcNCiAgfSk7DQoNCiAgLy8gVGnDqnUgxJHhu4Egbmfhuq9uIGfhu41uIChraMO0bmcgY8OzIGljb24vZ+G7rWkgZOG7ryBsaeG7h3UpDQogIGNvbnN0IHRpdGxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7DQogIHRpdGxlLnRleHRDb250ZW50ID0gJ05o4bqtcCBt4bqtdCBraOG6qXUgxJHhu4MgbeG7nyBsaW5rJzsNCiAgdGl0bGUuc3R5bGUuZm9udFdlaWdodCA9ICc2MDAnOw0KDQogIC8vIMOUIG5o4bqtcCBt4bqtdCBraOG6qXUNCiAgY29uc3QgaW5wdXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpOw0KICBPYmplY3QuYXNzaWduKGlucHV0LCB7IHR5cGU6ICdwYXNzd29yZCcsIHBsYWNlaG9sZGVyOiAnTeG6rXQga2jhuql1JyB9KTsNCiAgT2JqZWN0LmFzc2lnbihpbnB1dC5zdHlsZSwgew0KICAgIHBhZGRpbmc6ICcxMHB4Jywgd2lkdGg6ICcxMDAlJywgYm9yZGVyOiAnMXB4IHNvbGlkICNkZGQnLCBib3JkZXJSYWRpdXM6ICc2cHgnDQogIH0pOw0KDQogIC8vIFRow7RuZyBiw6FvIGzhu5dpICjhuqluIG3hurdjIMSR4buLbmgpDQogIGNvbnN0IGVyciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOw0KICBlcnIudGV4dENvbnRlbnQgPSAn4p2MIFNhaSBt4bqtdCBraOG6qXUhJzsNCiAgT2JqZWN0LmFzc2lnbihlcnIuc3R5bGUsIHsgY29sb3I6ICdyZWQnLCBmb250U2l6ZTogJzE0cHgnLCBkaXNwbGF5OiAnbm9uZScgfSk7DQoNCiAgLy8gTsO6dCB4w6FjIG5o4bqtbg0KICBjb25zdCBidG4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTsNCiAgYnRuLnRleHRDb250ZW50ID0gJ1jDoWMgbmjhuq1uJzsNCiAgT2JqZWN0LmFzc2lnbihidG4uc3R5bGUsIHsNCiAgICBwYWRkaW5nOiAnMTBweCAxNnB4JywgYmFja2dyb3VuZDogJyMzNDk4ZGInLCBjb2xvcjogJyNmZmYnLA0KICAgIGJvcmRlcjogJ25vbmUnLCBib3JkZXJSYWRpdXM6ICc2cHgnLCBjdXJzb3I6ICdwb2ludGVyJw0KICB9KTsNCg0KICAvLyBQcm9ncmVzcyBiYXIgKMSR4bq3dCBExq/hu5pJIEPDmU5HKQ0KICBjb25zdCBiYXJXcmFwID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7DQogIE9iamVjdC5hc3NpZ24oYmFyV3JhcC5zdHlsZSwgew0KICAgIHdpZHRoOiAnMTAwJScsIGJhY2tncm91bmQ6ICcjZGRkJywgaGVpZ2h0OiAnNnB4JywNCiAgICBib3JkZXJSYWRpdXM6ICczcHgnLCBtYXJnaW5Ub3A6ICcxMnB4Jw0KICB9KTsNCiAgY29uc3QgYmFyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7DQogIE9iamVjdC5hc3NpZ24oYmFyLnN0eWxlLCB7IHdpZHRoOiAnMCUnLCBoZWlnaHQ6ICcxMDAlJywgYmFja2dyb3VuZDogJyMzNDk4ZGInIH0pOw0KICBiYXJXcmFwLmFwcGVuZENoaWxkKGJhcik7DQoNCiAgLy8gR+G6r24gdsOgbyBET00NCiAgYm94LmFwcGVuZENoaWxkKHRpdGxlKTsNCiAgYm94LmFwcGVuZENoaWxkKGlucHV0KTsNCiAgYm94LmFwcGVuZENoaWxkKGVycik7DQogIGJveC5hcHBlbmRDaGlsZChidG4pOw0KICBib3guYXBwZW5kQ2hpbGQoYmFyV3JhcCk7DQogIG92ZXJsYXkuYXBwZW5kQ2hpbGQoYm94KTsNCiAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChvdmVybGF5KTsNCg0KICAvLyBDaOG6t24gY2xpY2sgYsOqbiB0cm9uZyBraMO0bmcgxJHDs25nDQogIGJveC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGUgPT4gZS5zdG9wUHJvcGFnYXRpb24oKSk7DQogIC8vIENsaWNrIHJhIG5nb8OgaSDEkeG7gyB04bqvdA0KICBvdmVybGF5LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gew0KICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQob3ZlcmxheSk7DQogIH0pOw0KDQogIC8vIFjhu60gbMO9IHjDoWMgbmjhuq1uDQogIGFzeW5jIGZ1bmN0aW9uIHN1Ym1pdCgpIHsNCiAgICAvLyDEkOG7lWkgbeG6rXQga2jhuql1IOG7nyDEkcOieQ0KICAgIGNvbnN0IE9LID0gaW5wdXQudmFsdWUgPT09ICcxISc7DQoNCiAgICBpZiAoIU9LKSB7DQogICAgICBlcnIuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7DQogICAgICByZXR1cm47DQogICAgfQ0KICAgIGVyci5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOw0KICAgIGJ0bi5kaXNhYmxlZCA9IHRydWU7DQogICAgaW5wdXQuZGlzYWJsZWQgPSB0cnVlOw0KDQogICAgLy8gQW5pbWF0ZSBwcm9ncmVzcyBuaGFuaCBsw6puIDEwMCUNCiAgICBiYXIuc3R5bGUudHJhbnNpdGlvbiA9ICd3aWR0aCAwLjZzIGVhc2UnOw0KICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZSgoKSA9PiAoYmFyLnN0eWxlLndpZHRoID0gJzEwMCUnKSk7DQogICAgc2V0VGltZW91dCgoKSA9PiB7DQogICAgICB3aW5kb3cub3Blbih1cmwsICdfYmxhbmsnKTsNCiAgICAgIGlmIChvdmVybGF5LnBhcmVudE5vZGUpIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQob3ZlcmxheSk7DQogICAgfSwgNjUwKTsNCiAgfQ0KDQogIGJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHN1Ym1pdCk7DQogIGlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCAoZSkgPT4gew0KICAgIGlmIChlLmtleSA9PT0gJ0VudGVyJykgc3VibWl0KCk7DQogIH0pOw0KDQogIC8vIEZvY3VzIG5nYXkgw7QgbeG6rXQga2jhuql1DQogIHNldFRpbWVvdXQoKCkgPT4gaW5wdXQuZm9jdXMoKSwgMCk7DQp9DQoNCmZ1bmN0aW9uIGV4dHJhY3RGaWxlbmFtZShkcm9wYm94UHJldmlld1VybCkgew0KICB0cnkgew0KICAgIGNvbnN0IHUgPSBuZXcgVVJMKGRyb3Bib3hQcmV2aWV3VXJsKTsNCiAgICBjb25zdCBwID0gdS5zZWFyY2hQYXJhbXMuZ2V0KCdwcmV2aWV3Jyk7DQogICAgcmV0dXJuIGRlY29kZVVSSUNvbXBvbmVudChwIHx8ICcnKTsNCiAgfSBjYXRjaCB7IHJldHVybiAnJzsgfQ0KfQ0KDQovLyBI4buZcCB4w6FjIG5o4bqtbiB4b8OhICh0cuG6oyB24buBIFByb21pc2U8Ym9vbGVhbj4pDQpmdW5jdGlvbiBjb25maXJtRGVsZXRlUG9wdXAodGV4dD0nQuG6oW4gY8OzIGNo4bqvYyBtdeG7kW4geG/DoT8nLCBvbmVCdXR0b249ZmFsc2UpIHsNCiAgcmV0dXJuIG5ldyBQcm9taXNlKHJlc29sdmUgPT4gew0KICAgIGNvbnN0IG92ZXJsYXkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsNCiAgICBPYmplY3QuYXNzaWduKG92ZXJsYXkuc3R5bGUsIHsNCiAgICAgIHBvc2l0aW9uOidmaXhlZCcsIGluc2V0OicwJywgYmFja2dyb3VuZDoncmdiYSgwLDAsMCwwLjUpJywNCiAgICAgIGRpc3BsYXk6J2ZsZXgnLCBhbGlnbkl0ZW1zOidjZW50ZXInLCBqdXN0aWZ5Q29udGVudDonY2VudGVyJywgekluZGV4OjEwMDAxDQogICAgfSk7DQoNCiAgICBjb25zdCBib3ggPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsNCiAgICBPYmplY3QuYXNzaWduKGJveC5zdHlsZSwgew0KICAgICAgYmFja2dyb3VuZDonI2ZmZicsIHBhZGRpbmc6JzIwcHgnLCBib3JkZXJSYWRpdXM6JzhweCcsDQogICAgICBtYXhXaWR0aDonNDIwcHgnLCB3aWR0aDonOTAlJywgYm94U2hhZG93OicwIDRweCAxMnB4IHJnYmEoMCwwLDAsLjI1KScsDQogICAgICBmb250RmFtaWx5OidJbnRlciwgc2Fucy1zZXJpZicNCiAgICB9KTsNCg0KICAgIGJveC5pbm5lckhUTUwgPSBgDQogICAgICA8ZGl2IHN0eWxlPSJmb250LXdlaWdodDo2MDA7IG1hcmdpbi1ib3R0b206OHB4Ij5Yw6FjIG5o4bqtbiB4b8OhPC9kaXY+DQogICAgICA8ZGl2IHN0eWxlPSJtYXJnaW4tYm90dG9tOjE0cHgiPiR7dGV4dH08L2Rpdj4NCiAgICAgIDxkaXYgc3R5bGU9ImRpc3BsYXk6ZmxleDsgZ2FwOjEwcHg7IGp1c3RpZnktY29udGVudDpmbGV4LWVuZCI+DQogICAgICAgIDxidXR0b24gaWQ9ImRsZ0NhbmNlbCIgY2xhc3M9ImJ0biIgc3R5bGU9ImJhY2tncm91bmQ6IzdmOGM4ZCI+SHXhu7c8L2J1dHRvbj4NCiAgICAgICAgJHshb25lQnV0dG9uID8gYDxidXR0b24gaWQ9ImRsZ1llcyIgY2xhc3M9ImJ0biIgc3R5bGU9ImJhY2tncm91bmQ6I2U3NGMzYyI+WG/DoTwvYnV0dG9uPmAgOiAnJ30NCiAgICAgIDwvZGl2Pg0KICAgIGA7DQoNCiAgICBvdmVybGF5LmFwcGVuZENoaWxkKGJveCk7DQogICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChvdmVybGF5KTsNCg0KICAgIGJveC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGUgPT4gZS5zdG9wUHJvcGFnYXRpb24oKSk7DQogICAgb3ZlcmxheS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChvdmVybGF5KTsgcmVzb2x2ZShmYWxzZSk7IH0pOw0KICAgIGJveC5xdWVyeVNlbGVjdG9yKCcjZGxnQ2FuY2VsJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7IGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQob3ZlcmxheSk7IHJlc29sdmUoZmFsc2UpOyB9KTsNCg0KICAgIGlmICghb25lQnV0dG9uKSB7DQogICAgICBib3gucXVlcnlTZWxlY3RvcignI2RsZ1llcycpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4geyBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKG92ZXJsYXkpOyByZXNvbHZlKHRydWUpOyB9KTsNCiAgICB9DQogIH0pOw0KfQ0KDQovLyBYb8OhIDEgZW50cnkgbG9nICsgZmlsZSBFeGNlbCB0csOqbiBEcm9wYm94ICh0aGVvIGluZGV4IHRyb25nIG3huqNuZyBsb2dzKQ0KYXN5bmMgZnVuY3Rpb24gZGVsZXRlTG9nQW5kRmlsZV9CeUluZGV4KGlkeCkgew0KICBjb25zdCBhY2Nlc3NUb2tlbiA9IGF3YWl0IGdldEFjY2Vzc1Rva2VuKCk7DQogIGNvbnN0IGRieCA9IG5ldyBEcm9wYm94LkRyb3Bib3goeyBhY2Nlc3NUb2tlbiB9KTsNCiAgY29uc3QgbG9nUGF0aCA9ICcvdGh1dGh1YXQvbG9nLmpzb24nOw0KDQogIC8vIDEpIFThuqNpIGxvZy5qc29uIGhp4buHbiB04bqhaQ0KICBsZXQgbG9ncyA9IFtdOw0KICB0cnkgew0KICAgIGNvbnN0IGRsID0gYXdhaXQgZGJ4LmZpbGVzRG93bmxvYWQoeyBwYXRoOiBsb2dQYXRoIH0pOw0KICAgIGNvbnN0IHRleHQgPSBhd2FpdCBkbC5yZXN1bHQuZmlsZUJsb2IudGV4dCgpOw0KICAgIGxvZ3MgPSBKU09OLnBhcnNlKHRleHQgfHwgJ1tdJyk7DQogIH0gY2F0Y2ggKGUpIHsNCiAgICBhbGVydCgnS2jDtG5nIMSR4buNYyDEkcaw4bujYyBsb2cuanNvbiB0csOqbiBEcm9wYm94LicpOyANCiAgICB0aHJvdyBlOw0KICB9DQoNCiAgY29uc3QgaXRlbSA9IGxvZ3NbaWR4XTsNCiAgaWYgKCFpdGVtKSB7IGFsZXJ0KCdLaMO0bmcgdMOsbSB0aOG6pXkgbeG7pWMgY+G6p24geG/DoS4nKTsgcmV0dXJuOyB9DQoNCiAgLy8gMikgTOG6pXkgZmlsZU5hbWUgJiB4b8OhIGZpbGUgRXhjZWwgKG7hur91IGPDsykNCiAgY29uc3QgZmlsZU5hbWUgPSBleHRyYWN0RmlsZW5hbWUoaXRlbS5saW5rIHx8ICcnKTsNCiAgY29uc3QgZmlsZVBhdGggPSBmaWxlTmFtZSA/IGAvdGh1dGh1YXQvJHtmaWxlTmFtZX1gIDogbnVsbDsNCg0KICB0cnkgew0KICAgIGlmIChmaWxlUGF0aCkgeyBhd2FpdCBkYnguZmlsZXNEZWxldGVWMih7IHBhdGg6IGZpbGVQYXRoIH0pOyB9DQogIH0gY2F0Y2ggKGUpIHsNCiAgICAvLyBO4bq/dSBmaWxlIGtow7RuZyB04buTbiB04bqhaSB24bqrbiB0aeG6v3AgdOG7pWMgeG/DoSBsb2cNCiAgICBjb25zb2xlLndhcm4oJ1hvw6EgZmlsZSBFeGNlbCBs4buXaS9raMO0bmcgdOG7k24gdOG6oWksIHRp4bq/cCB04bulYyB4b8OhIGxvZy4uLicsIGUpOw0KICB9DQoNCiAgLy8gMykgQ+G6rXAgbmjhuq10IGxvZzogYuG7jyBwaOG6p24gdOG7rSBpZHggdsOgIGdoaSDEkcOoIGzhuqFpDQogIGxvZ3Muc3BsaWNlKGlkeCwgMSk7DQogIGF3YWl0IGRieC5maWxlc1VwbG9hZCh7DQogICAgcGF0aDogbG9nUGF0aCwNCiAgICBjb250ZW50czogSlNPTi5zdHJpbmdpZnkobG9ncywgbnVsbCwgMiksDQogICAgbW9kZTogeyAnLnRhZyc6ICdvdmVyd3JpdGUnIH0sDQogICAgYXV0b3JlbmFtZTogZmFsc2UNCiAgfSk7DQp9DQoNCg0KYXN5bmMgZnVuY3Rpb24gb25EZWxldGVMb2dSb3coaW5kZXhJbkxvZ3MsIGN1cnJlbnRVc2VyKSB7DQogIC8vIE7hur91IGtow7RuZyBwaOG6o2kgZG9jdG9yIOKGkiBwb3B1cCBj4bqlbSB4b8OhLCBjaOG7iSBjw7MgMSBuw7p0IEh14bu3DQogIGlmIChjdXJyZW50VXNlciAhPT0gJ2RvY3RvcicpIHsNCiAgICBhd2FpdCBjb25maXJtRGVsZXRlUG9wdXAoDQogICAgICAn4p2MIMOKIGzDoG0gY8OhaSBnw6wgxJHhuqV5eXl5IGVtIMahaS4gPGJyLz5E4burbmcgbOG6oWkgbmdheSwgcXXDoSBuZ3V5IGhp4buDbS4nLA0KICAgICAgdHJ1ZSAvLyA8LS0gY2jhur8gxJHhu5kgMSBuw7p0DQogICAgKTsNCiAgICByZXR1cm47DQogIH0NCg0KICAvLyBO4bq/dSBsw6AgZG9jdG9yIOKGkiBwb3B1cCB4w6FjIG5o4bqtbiB4b8OhICgyIG7DunQpDQogIGNvbnN0IG9rID0gYXdhaXQgY29uZmlybURlbGV0ZVBvcHVwKA0KICAgICdC4bqhbiBjw7MgY2jhuq9jIG114buRbiB4b8OhIG3hu6VjIG7DoHk/JywNCiAgICBmYWxzZQ0KICApOw0KICBpZiAoIW9rKSByZXR1cm47DQoNCiAgdHJ5IHsNCiAgICBhd2FpdCBkZWxldGVMb2dBbmRGaWxlX0J5SW5kZXgoaW5kZXhJbkxvZ3MpOw0KICAgIGF3YWl0IGNvbmZpcm1EZWxldGVQb3B1cCgn4pyFIMSQw6MgeG/DoSB0aMOgbmggY8O0bmchJywgdHJ1ZSk7DQogICAgYXdhaXQgc2hvd0Ryb3Bib3hQYW5lbCgpOw0KICB9IGNhdGNoIChlKSB7DQogICAgY29uc29sZS5lcnJvcihlKTsNCiAgICBhd2FpdCBjb25maXJtRGVsZXRlUG9wdXAoJ+KaoO+4jyBDw7MgbOG7l2kga2hpIHhvw6EuIFZ1aSBsw7JuZyB0aOG7rSBs4bqhaS4nLCB0cnVlKTsNCiAgfQ0KfQ0KDQovLyDEkMOzbmcgcGFuZWwga2hpIGLhuqVtIEVTQyBob+G6t2MgY2xpY2sgcmEgbmdvw6BpDQpkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCJrZXlkb3duIiwgZnVuY3Rpb24oZSkgew0KICBpZiAoZS5rZXkgPT09ICJFc2NhcGUiKSB7DQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImRyb3Bib3hQYW5lbCIpLnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7DQogIH0NCn0pOw0KDQpkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCJjbGljayIsIGZ1bmN0aW9uKGUpIHsNCiAgY29uc3QgcGFuZWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiZHJvcGJveFBhbmVsIik7DQogIGlmIChwYW5lbC5zdHlsZS5kaXNwbGF5ID09PSAiYmxvY2siIHx8IHBhbmVsLnN0eWxlLmRpc3BsYXkgPT09ICJmbGV4Iikgew0KICAgIGNvbnN0IGNvbnRlbnQgPSBwYW5lbC5xdWVyeVNlbGVjdG9yKCJkaXYiKTsNCiAgICAvLyBO4bq/dSBjbGljayBuZ2/DoGkgdsO5bmcgbuG7mWkgZHVuZyBwYW5lbA0KICAgIGlmICghY29udGVudC5jb250YWlucyhlLnRhcmdldCkpIHsNCiAgICAgIHBhbmVsLnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7DQogICAgfQ0KICB9DQp9KTsNCg0KPC9zY3JpcHQ+DQo8c2NyaXB0Pg0KLy8gPT09PT09IFBIw4JOIFRSQU5HIELhuqJORyBMT0cgVFJPTkcgUE9QVVAgPT09PT09DQpsZXQgREJfTE9HUyA9IFtdOyAgICAgICAvLyB0b8OgbiBi4buZIGxvZ3MgxJHDoyB04bqjaQ0KbGV0IERCX1BBR0UgPSAxOyAgICAgICAgLy8gdHJhbmcgaGnhu4duIHThuqFpDQpsZXQgREJfUEFHRV9TSVpFID0gMTA7ICAvLyBz4buRIGTDsm5nIC8gdHJhbmcNCmxldCBEQl9DVVJSRU5UX1VTRVIgPSAnJzsgLy8gdXNlciDEkWFuZyDEkcSDbmcgbmjhuq1wIChsb3dlcmNhc2UpIMSR4buDIHJlbmRlciBuw7p0IFhvw6ENCg0KZnVuY3Rpb24gc2V0UGFnZVNpemUoc2l6ZSl7DQogIERCX1BBR0VfU0laRSA9IE51bWJlcihzaXplKSB8fCAxMDsNCiAgREJfUEFHRSA9IDE7DQogIHJlbmRlckRyb3Bib3hQYWdlKCk7DQp9DQoNCmZ1bmN0aW9uIGdvVG9QYWdlKHApew0KICBjb25zdCBtYXggPSBNYXRoLm1heCgxLCBNYXRoLmNlaWwoREJfTE9HUy5sZW5ndGggLyBEQl9QQUdFX1NJWkUpKTsNCiAgREJfUEFHRSA9IE1hdGgubWluKE1hdGgubWF4KDEsIHApLCBtYXgpOw0KICByZW5kZXJEcm9wYm94UGFnZSgpOw0KfQ0KDQpmdW5jdGlvbiByZW5kZXJEcm9wYm94UGFnZSgpew0KICBjb25zdCB0Ym9keSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkcm9wYm94RmlsZUxpc3QnKTsNCiAgY29uc3QgcGFnZUJ0bnMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZHJvcGJveFBhZ2VCdXR0b25zJyk7DQogIGNvbnN0IHBhZ2VJbmZvID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Ryb3Bib3hQYWdlSW5mbycpOw0KDQogIGlmKCF0Ym9keSkgcmV0dXJuOw0KDQogIC8vIHLhu5duZz8NCiAgaWYoIUFycmF5LmlzQXJyYXkoREJfTE9HUykgfHwgREJfTE9HUy5sZW5ndGggPT09IDApew0KICAgIHRib2R5LmlubmVySFRNTCA9IGA8dHI+PHRkIGNvbHNwYW49IjYiIHN0eWxlPSJ0ZXh0LWFsaWduOmNlbnRlcjtjb2xvcjpyZWQiPktow7RuZyBjw7MgZGFuaCBzw6FjaCBuw6BvIMSRxrDhu6NjIGzGsHU8L3RkPjwvdHI+YDsNCiAgICBpZihwYWdlQnRucykgcGFnZUJ0bnMuaW5uZXJIVE1MID0gJyc7DQogICAgaWYocGFnZUluZm8pIHBhZ2VJbmZvLnRleHRDb250ZW50ID0gJyc7DQogICAgcmV0dXJuOw0KICB9DQoNCiAgY29uc3QgdG90YWwgPSBEQl9MT0dTLmxlbmd0aDsNCiAgY29uc3QgbWF4UGFnZSA9IE1hdGgubWF4KDEsIE1hdGguY2VpbCh0b3RhbCAvIERCX1BBR0VfU0laRSkpOw0KICBpZihEQl9QQUdFID4gbWF4UGFnZSkgREJfUEFHRSA9IG1heFBhZ2U7DQoNCiAgY29uc3Qgc3RhcnRJZHggPSAoREJfUEFHRSAtIDEpICogREJfUEFHRV9TSVpFOw0KICBjb25zdCBlbmRJZHggICA9IE1hdGgubWluKHN0YXJ0SWR4ICsgREJfUEFHRV9TSVpFLCB0b3RhbCk7DQogIGNvbnN0IHNsaWNlICAgID0gREJfTE9HUy5zbGljZShzdGFydElkeCwgZW5kSWR4KTsNCg0KICAvLyBSZW5kZXIgYm9keSB0aGVvIHRyYW5nDQogIHRib2R5LmlubmVySFRNTCA9IHNsaWNlLm1hcCgoaXRlbSwgaSkgPT4gYA0KICAgIDx0cj4NCiAgICAgIDx0ZD4ke3N0YXJ0SWR4ICsgaSArIDF9PC90ZD4NCiAgICAgIDx0ZD4ke2l0ZW0ua2hvYSB8fCAnJ308L3RkPg0KICAgICAgPHRkPiR7KGl0ZW0ubmdheSB8fCAnJykNCiAgICAgICAgICAgLnJlcGxhY2UoJzAwOjAwOjAwJywnJykNCiAgICAgICAgICAgLnJlcGxhY2UoJzIzOjU5OjU5JywnJykNCiAgICAgICAgICAgLnJlcGxhY2UoJ1Thu6snLCcnKQ0KICAgICAgICAgICAucmVwbGFjZSgnxJHhur9uJywnIC0+ICcpDQogICAgICAgICAgIC5yZXBsYWNlKC9ccysvZywnICcpDQogICAgICAgICAgIC50cmltKCl9PC90ZD4NCiAgICAgIDx0ZD4keyhpdGVtLnRpbWUgfHwgJycpDQogICAgICAgICAgIC5yZXBsYWNlKCcsJywgJycpDQogICAgICAgICAgIC5yZXBsYWNlKCcgJywgJyAtICcpDQogICAgICAgICAgIC5yZXBsYWNlKC9ccysvZywgJyAnKQ0KICAgICAgICAgICAudHJpbSgpfTwvdGQ+DQogICAgICA8dGQ+PGEgaHJlZj0iamF2YXNjcmlwdDp2b2lkKDApIiBvbmNsaWNrPSJ2ZXJpZnlBbmRPcGVuTGluaygnJHtpdGVtLmxpbmt9JykiPlhlbTwvYT48L3RkPg0KICAgICAgPHRkPg0KICAgICAgICA8YnV0dG9uIGNsYXNzPSJidG4iIHN0eWxlPSJiYWNrZ3JvdW5kOiNlNzRjM2MiDQogICAgICAgICAgb25jbGljaz0ib25EZWxldGVMb2dSb3coJHtzdGFydElkeCArIGl9LCAnJHtEQl9DVVJSRU5UX1VTRVJ9JykiPg0KICAgICAgICAgIDxpIGNsYXNzPSJmYSBmYS10cmFzaCI+PC9pPiBYb8OhDQogICAgICAgIDwvYnV0dG9uPg0KICAgICAgPC90ZD4NCiAgICA8L3RyPg0KICBgKS5qb2luKCcnKTsNCg0KICAvLyBSZW5kZXIgbsO6dCB0cmFuZyAoUHJldiDigKYgTmV4dCkg4oCUIGhp4buDbiB0aOG7iyBk4bqjaSB04buRaSDEkWEgNyBuw7p0IHPhu5ENCiAgaWYocGFnZUJ0bnMpew0KICAgIGNvbnN0IGJ0biA9IChsYWJlbCwgdGFyZ2V0LCBkaXNhYmxlZD1mYWxzZSwgdGl0bGU9JycpID0+DQogICAgICBgPGJ1dHRvbiBjbGFzcz0iYnRuIiAke2Rpc2FibGVkPydkaXNhYmxlZCc6Jyd9IHRpdGxlPSIke3RpdGxlfSINCiAgICAgICAgICAgICAgIHN0eWxlPSJwYWRkaW5nOjZweCAxMHB4JHtkaXNhYmxlZD8nO29wYWNpdHk6LjY7Y3Vyc29yOm5vdC1hbGxvd2VkJzonJ30iDQogICAgICAgICAgICAgICBvbmNsaWNrPSJnb1RvUGFnZSgke3RhcmdldH0pIj4ke2xhYmVsfTwvYnV0dG9uPmA7DQoNCiAgICBjb25zdCByYW5nZSA9IDM7IC8vIGhhaSBiw6puIHRyYW5nIGhp4buHbiB04bqhaQ0KICAgIGNvbnN0IGZyb20gID0gTWF0aC5tYXgoMSwgREJfUEFHRSAtIHJhbmdlKTsNCiAgICBjb25zdCB0byAgICA9IE1hdGgubWluKG1heFBhZ2UsIERCX1BBR0UgKyByYW5nZSk7DQoNCiAgICBsZXQgaHRtbCA9ICcnOw0KICAgIGh0bWwgKz0gYnRuKCfCqyDEkOG6p3UnLCAxLCBEQl9QQUdFPT09MSwgJ1RyYW5nIMSR4bqndScpOw0KICAgIGh0bWwgKz0gYnRuKCfigLkgVHLGsOG7m2MnLCBEQl9QQUdFLTEsIERCX1BBR0U9PT0xLCAnVHJhbmcgdHLGsOG7m2MnKTsNCiAgICBmb3IobGV0IHAgPSBmcm9tOyBwIDw9IHRvOyBwKyspew0KICAgICAgaHRtbCArPSBgPGJ1dHRvbiBjbGFzcz0iYnRuIiBvbmNsaWNrPSJnb1RvUGFnZSgke3B9KSINCiAgICAgICAgICAgICAgICAgc3R5bGU9InBhZGRpbmc6NnB4IDEwcHg7JHtwPT09REJfUEFHRT8nYmFja2dyb3VuZDojMmVjYzcxJzonJ30iPg0KICAgICAgICAgICAgICAgICAke3B9DQogICAgICAgICAgICAgICA8L2J1dHRvbj5gOw0KICAgIH0NCiAgICBodG1sICs9IGJ0bignU2F1IOKAuicsIERCX1BBR0UrMSwgREJfUEFHRT09PW1heFBhZ2UsICdUcmFuZyBzYXUnKTsNCiAgICBodG1sICs9IGJ0bignQ3Xhu5FpIMK7JywgbWF4UGFnZSwgREJfUEFHRT09PW1heFBhZ2UsICdUcmFuZyBjdeG7kWknKTsNCg0KICAgIHBhZ2VCdG5zLmlubmVySFRNTCA9IGh0bWw7DQogIH0NCg0KICBpZihwYWdlSW5mbyl7DQogICAgcGFnZUluZm8udGV4dENvbnRlbnQgPSBgVHJhbmcgJHtEQl9QQUdFfS8ke21heFBhZ2V9IOKAoiAke3N0YXJ0SWR4KzF9LSR7ZW5kSWR4fS8ke3RvdGFsfWA7DQogIH0NCn0NCg0KLy8gR+G6r24gc+G7sSBraeG7h24gxJHhu5VpIHBhZ2Ugc2l6ZSAoY2jhu4kgY+G6p24gZ+G7jWkgMSBs4bqnbiBzYXUga2hpIHBvcHVwIG3hu58pDQpmdW5jdGlvbiBhdHRhY2hQYWdlckV2ZW50c09uY2UoKXsNCiAgY29uc3Qgc2VsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Ryb3Bib3hQYWdlU2l6ZScpOw0KICBpZihzZWwgJiYgIXNlbC5kYXRhc2V0LmJvdW5kKXsNCiAgICBzZWwuZGF0YXNldC5ib3VuZCA9ICcxJzsNCiAgICBzZWwuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgZSA9PiBzZXRQYWdlU2l6ZShlLnRhcmdldC52YWx1ZSkpOw0KICB9DQp9DQo8L3NjcmlwdD4NCjwvYm9keT4NCg0KPC9odG1sPg==";
  const binary = atob(base64);
  const bytes = new Uint8Array([...binary].map(c => c.charCodeAt(0)));
  const decoded = new TextDecoder("utf-8").decode(bytes);
  document.write(decoded);
</script>


</body>
</html>
